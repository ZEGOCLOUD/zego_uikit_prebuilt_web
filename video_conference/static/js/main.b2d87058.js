/*! For license information please see main.b2d87058.js.LICENSE.txt */
(function(){var __webpack_modules__={7228:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},2858:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3884:function(e){e.exports=function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(c){a=!0,i=c}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}},e.exports.__esModule=!0,e.exports.default=e.exports},521:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},3038:function(e,t,r){var n=r(2858),i=r(3884),o=r(379),s=r(521);e.exports=function(e,t){return n(e)||i(e,t)||o(e,t)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},379:function(e,t,r){var n=r(7228);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},7214:function(e){"use strict";e.exports=function(e,t){var r=new Array(arguments.length-1),n=0,i=2,o=!0;for(;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(a){o&&(o=!1,s(a))}}))}},734:function(e,t){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),i=new Array(123),o=0;o<64;)i[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,r){for(var i,o=null,s=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:s[a++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:s[a++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:s[a++]=n[i|u>>6],s[a++]=n[63&u],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=n[i],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";r.decode=function(e,t,r){for(var n,o=r,a=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&a>1)break;if(void 0===(u=i[u]))throw Error(s);switch(a){case 0:n=u,a=1;break;case 1:t[r++]=n<<2|(48&u)>>4,n=u,a=2;break;case 2:t[r++]=(15&n)<<4|(60&u)>>2,n=u,a=3;break;case 3:t[r++]=(3&n)<<6|u,a=0}}if(1===a)throw Error(s);return r-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},7875:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},249:function(e){"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function s(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=s.bind(null,i),e.readFloatBE=s.bind(null,o)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,i,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function s(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+o;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=s.bind(null,i,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},6858:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},7423:function(e){"use strict";e.exports=function(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}},248:function(e,t){"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296===(64512&r)&&56320===(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296===(64512&n)&&56320===(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}},4418:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(6644),r(9142),r(7804),r(7149),function(){var e=o,t=e.lib.BlockCipher,r=e.algo,n=[],i=[],s=[],a=[],c=[],u=[],l=[],d=[],h=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,o=0;for(t=0;t<256;t++){var f=o^o<<1^o<<2^o<<3^o<<4;f=f>>>8^255&f^99,n[r]=f,i[f]=r;var g=e[r],m=e[g],_=e[m],v=257*e[f]^16843008*f;s[r]=v<<24|v>>>8,a[r]=v<<16|v>>>16,c[r]=v<<8|v>>>24,u[r]=v,v=16843009*_^65537*m^257*g^16843008*r,l[f]=v<<24|v>>>8,d[f]=v<<16|v>>>16,h[f]=v<<8|v>>>24,p[f]=v,r?(r=g^e[e[e[_^g]]],o^=e[e[o]]):r=o=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],g=r.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,i=4*((this._nRounds=r+6)+1),o=this._keySchedule=[],s=0;s<i;s++)s<r?o[s]=t[s]:(u=o[s-1],s%r?r>6&&s%r==4&&(u=n[u>>>24]<<24|n[u>>>16&255]<<16|n[u>>>8&255]<<8|n[255&u]):(u=n[(u=u<<8|u>>>24)>>>24]<<24|n[u>>>16&255]<<16|n[u>>>8&255]<<8|n[255&u],u^=f[s/r|0]<<24),o[s]=o[s-r]^u);for(var a=this._invKeySchedule=[],c=0;c<i;c++){if(s=i-c,c%4)var u=o[s];else u=o[s-4];a[c]=c<4||s<=4?u:l[n[u>>>24]]^d[n[u>>>16&255]]^h[n[u>>>8&255]]^p[n[255&u]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,u,n)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,l,d,h,p,i),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,o,s,a){for(var c=this._nRounds,u=e[t]^r[0],l=e[t+1]^r[1],d=e[t+2]^r[2],h=e[t+3]^r[3],p=4,f=1;f<c;f++){var g=n[u>>>24]^i[l>>>16&255]^o[d>>>8&255]^s[255&h]^r[p++],m=n[l>>>24]^i[d>>>16&255]^o[h>>>8&255]^s[255&u]^r[p++],_=n[d>>>24]^i[h>>>16&255]^o[u>>>8&255]^s[255&l]^r[p++],v=n[h>>>24]^i[u>>>16&255]^o[l>>>8&255]^s[255&d]^r[p++];u=g,l=m,d=_,h=v}g=(a[u>>>24]<<24|a[l>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^r[p++],m=(a[l>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&u])^r[p++],_=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[u>>>8&255]<<8|a[255&l])^r[p++],v=(a[h>>>24]<<24|a[u>>>16&255]<<16|a[l>>>8&255]<<8|a[255&d])^r[p++],e[t]=g,e[t+1]=m,e[t+2]=_,e[t+3]=v},keySize:8});e.AES=t._createHelper(g)}(),o.AES)}()},7149:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7804),void(o.lib.Cipher||function(e){var t=o,r=t.lib,n=r.Base,i=r.WordArray,s=r.BufferedBlockAlgorithm,a=t.enc,c=(a.Utf8,a.Base64),u=t.algo.EvpKDF,l=r.Cipher=s.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?y:_}return function(t){return{encrypt:function(r,n,i){return e(n).encrypt(t,r,n,i)},decrypt:function(r,n,i){return e(n).decrypt(t,r,n,i)}}}}()}),d=(r.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),h=r.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),p=d.CBC=function(){var t=h.extend();function r(t,r,n){var i,o=this._iv;o?(i=o,this._iv=e):i=this._prevBlock;for(var s=0;s<n;s++)t[r+s]^=i[s]}return t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize;r.call(this,e,t,i),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),t.Decryptor=t.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=e.slice(t,t+i);n.decryptBlock(e,t),r.call(this,e,t,i),this._prevBlock=o}}),t}(),f=(t.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,o=n<<24|n<<16|n<<8|n,s=[],a=0;a<n;a+=4)s.push(o);var c=i.create(s,n);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(r.BlockCipher=l.extend({cfg:l.cfg.extend({mode:p,padding:f}),reset:function(){var e;l.reset.call(this);var t=this.cfg,r=t.iv,n=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=n.createEncryptor:(e=n.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,r&&r.words):(this._mode=e.call(n,this,r&&r.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),r.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),m=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;return(r?i.create([1398893684,1701076831]).concat(r).concat(t):t).toString(c)},parse:function(e){var t,r=c.parse(e),n=r.words;return 1398893684==n[0]&&1701076831==n[1]&&(t=i.create(n.slice(2,4)),n.splice(0,4),r.sigBytes-=16),g.create({ciphertext:r,salt:t})}},_=r.SerializableCipher=n.extend({cfg:n.extend({format:m}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n),o=i.finalize(t),s=i.cfg;return g.create({ciphertext:o,key:r,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),v=(t.kdf={}).OpenSSL={execute:function(e,t,r,n){n||(n=i.random(8));var o=u.create({keySize:t+r}).compute(e,n),s=i.create(o.words.slice(t),4*r);return o.sigBytes=4*t,g.create({key:o,iv:s,salt:n})}},y=r.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:v}),encrypt:function(e,t,r,n){var i=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize);n.iv=i.iv;var o=_.encrypt.call(this,e,t,i.key,n);return o.mixIn(i),o},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var i=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);return n.iv=i.iv,_.decrypt.call(this,e,t,i.key,n)}})}()))}()},169:function(e,t,r){e.exports=function(){var e=e||function(e,t){var n;if("undefined"!==typeof window&&window.crypto&&(n=window.crypto),"undefined"!==typeof self&&self.crypto&&(n=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!==typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!==typeof r.g&&r.g.crypto&&(n=r.g.crypto),!n)try{n=r(2480)}catch(m){}var i=function(){if(n){if("function"===typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(m){}if("function"===typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(m){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=c.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(var a=0;a<i;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(i());return new u.init(t,e)}}),l=s.enc={},d=l.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(r,t/2)}},h=l.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(r,t)}},p=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},f=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,i=n.words,o=n.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,l=e.min(4*c,o);if(c){for(var d=0;d<c;d+=s)this._doProcessBlock(i,d);r=i.splice(0,c),n.sigBytes-=l}return new u.init(r,l)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),g=(a.Hasher=f.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new g.HMAC.init(e,r).finalize(t)}}}),s.algo={});return s}(Math);return e}()},6644:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(){var e=i,t=e.lib.WordArray;function r(e,r,n){for(var i=[],o=0,s=0;s<r;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2|n[e.charCodeAt(s)]>>>6-s%4*2;i[o>>>2]|=a<<24-o%4*8,o++}return t.create(i,o)}e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var i=[],o=0;o<r;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<r;a++)i.push(n.charAt(s>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<n.length;o++)i[n.charCodeAt(o)]=o}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return r(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),i.enc.Base64)}()},6326:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(){var e=i,t=e.lib.WordArray;function r(e,r,n){for(var i=[],o=0,s=0;s<r;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2|n[e.charCodeAt(s)]>>>6-s%4*2;i[o>>>2]|=a<<24-o%4*8,o++}return t.create(i,o)}e.enc.Base64url={stringify:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.words,n=e.sigBytes,i=t?this._safe_map:this._map;e.clamp();for(var o=[],s=0;s<n;s+=3)for(var a=(r[s>>>2]>>>24-s%4*8&255)<<16|(r[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|r[s+2>>>2]>>>24-(s+2)%4*8&255,c=0;c<4&&s+.75*c<n;c++)o.push(i.charAt(a>>>6*(3-c)&63));var u=i.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.length,i=t?this._safe_map:this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var s=0;s<i.length;s++)o[i.charCodeAt(s)]=s}var a=i.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(n=c)}return r(e,n,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),i.enc.Base64url)}()},6246:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(){var e=i,t=e.lib.WordArray,r=e.enc;function n(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i+=2){var o=t[i>>>2]>>>16-i%4*8&65535;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var r=e.length,n=[],i=0;i<r;i++)n[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return t.create(n,2*r)}},r.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],o=0;o<r;o+=2){var s=n(t[o>>>2]>>>16-o%4*8&65535);i.push(String.fromCharCode(s))}return i.join("")},parse:function(e){for(var r=e.length,i=[],o=0;o<r;o++)i[o>>>1]|=n(e.charCodeAt(o)<<16-o%2*16);return t.create(i,2*r)}}}(),i.enc.Utf16)}()},7804:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(336),r(2503),function(){var e=o,t=e.lib,r=t.Base,n=t.WordArray,i=e.algo,s=i.MD5,a=i.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r,i=this.cfg,o=i.hasher.create(),s=n.create(),a=s.words,c=i.keySize,u=i.iterations;a.length<c;){r&&o.update(r),r=o.update(e).finalize(t),o.reset();for(var l=1;l<u;l++)r=o.finalize(r),o.reset();s.concat(r)}return s.sigBytes=4*c,s}});e.EvpKDF=function(e,t,r){return a.create(r).compute(e,t)}}(),o.EvpKDF)}()},2501:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),function(e){var t=o,r=t.lib.CipherParams,n=t.enc.Hex;t.format.Hex={stringify:function(e){return e.ciphertext.toString(n)},parse:function(e){var t=n.parse(e);return r.create({ciphertext:t})}}}(),o.format.Hex)}()},2503:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),void function(){var e=i,t=e.lib.Base,r=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),a=o.words,c=s.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})}())}()},6686:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(8230),r(362),r(6246),r(6644),r(6326),r(9142),r(336),r(5990),r(9524),r(9308),r(9111),r(5562),r(8088),r(2503),r(1778),r(7804),r(7149),r(7655),r(818),r(5081),r(2139),r(6749),r(4852),r(7202),r(2721),r(6277),r(1459),r(2501),r(4418),r(543),r(7419),r(3936),r(7476),o)}()},362:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(){if("function"==typeof ArrayBuffer){var e=i.lib.WordArray,t=e.init,r=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!==typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,n=[],i=0;i<r;i++)n[i>>>2]|=e[i]<<24-i%4*8;t.call(this,n,r)}else t.apply(this,arguments)};r.prototype=e}}(),i.lib.WordArray)}()},9142:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(e){var t=i,r=t.lib,n=r.WordArray,o=r.Hasher,s=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=s.MD5=o.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,s=e[t+0],c=e[t+1],p=e[t+2],f=e[t+3],g=e[t+4],m=e[t+5],_=e[t+6],v=e[t+7],y=e[t+8],E=e[t+9],S=e[t+10],b=e[t+11],T=e[t+12],C=e[t+13],R=e[t+14],O=e[t+15],k=o[0],I=o[1],L=o[2],w=o[3];k=u(k,I,L,w,s,7,a[0]),w=u(w,k,I,L,c,12,a[1]),L=u(L,w,k,I,p,17,a[2]),I=u(I,L,w,k,f,22,a[3]),k=u(k,I,L,w,g,7,a[4]),w=u(w,k,I,L,m,12,a[5]),L=u(L,w,k,I,_,17,a[6]),I=u(I,L,w,k,v,22,a[7]),k=u(k,I,L,w,y,7,a[8]),w=u(w,k,I,L,E,12,a[9]),L=u(L,w,k,I,S,17,a[10]),I=u(I,L,w,k,b,22,a[11]),k=u(k,I,L,w,T,7,a[12]),w=u(w,k,I,L,C,12,a[13]),L=u(L,w,k,I,R,17,a[14]),k=l(k,I=u(I,L,w,k,O,22,a[15]),L,w,c,5,a[16]),w=l(w,k,I,L,_,9,a[17]),L=l(L,w,k,I,b,14,a[18]),I=l(I,L,w,k,s,20,a[19]),k=l(k,I,L,w,m,5,a[20]),w=l(w,k,I,L,S,9,a[21]),L=l(L,w,k,I,O,14,a[22]),I=l(I,L,w,k,g,20,a[23]),k=l(k,I,L,w,E,5,a[24]),w=l(w,k,I,L,R,9,a[25]),L=l(L,w,k,I,f,14,a[26]),I=l(I,L,w,k,y,20,a[27]),k=l(k,I,L,w,C,5,a[28]),w=l(w,k,I,L,p,9,a[29]),L=l(L,w,k,I,v,14,a[30]),k=d(k,I=l(I,L,w,k,T,20,a[31]),L,w,m,4,a[32]),w=d(w,k,I,L,y,11,a[33]),L=d(L,w,k,I,b,16,a[34]),I=d(I,L,w,k,R,23,a[35]),k=d(k,I,L,w,c,4,a[36]),w=d(w,k,I,L,g,11,a[37]),L=d(L,w,k,I,v,16,a[38]),I=d(I,L,w,k,S,23,a[39]),k=d(k,I,L,w,C,4,a[40]),w=d(w,k,I,L,s,11,a[41]),L=d(L,w,k,I,f,16,a[42]),I=d(I,L,w,k,_,23,a[43]),k=d(k,I,L,w,E,4,a[44]),w=d(w,k,I,L,T,11,a[45]),L=d(L,w,k,I,O,16,a[46]),k=h(k,I=d(I,L,w,k,p,23,a[47]),L,w,s,6,a[48]),w=h(w,k,I,L,v,10,a[49]),L=h(L,w,k,I,R,15,a[50]),I=h(I,L,w,k,m,21,a[51]),k=h(k,I,L,w,T,6,a[52]),w=h(w,k,I,L,f,10,a[53]),L=h(L,w,k,I,S,15,a[54]),I=h(I,L,w,k,c,21,a[55]),k=h(k,I,L,w,y,6,a[56]),w=h(w,k,I,L,O,10,a[57]),L=h(L,w,k,I,_,15,a[58]),I=h(I,L,w,k,C,21,a[59]),k=h(k,I,L,w,g,6,a[60]),w=h(w,k,I,L,b,10,a[61]),L=h(L,w,k,I,p,15,a[62]),I=h(I,L,w,k,E,21,a[63]),o[0]=o[0]+k|0,o[1]=o[1]+I|0,o[2]=o[2]+L|0,o[3]=o[3]+w|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;r[i>>>5]|=128<<24-i%32;var o=e.floor(n/4294967296),s=n;r[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(r.length+1),this._process();for(var a=this._hash,c=a.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,r,n,i,o,s){var a=e+(t&r|~t&n)+i+s;return(a<<o|a>>>32-o)+t}function l(e,t,r,n,i,o,s){var a=e+(t&n|r&~n)+i+s;return(a<<o|a>>>32-o)+t}function d(e,t,r,n,i,o,s){var a=e+(t^r^n)+i+s;return(a<<o|a>>>32-o)+t}function h(e,t,r,n,i,o,s){var a=e+(r^(t|~n))+i+s;return(a<<o|a>>>32-o)+t}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),i.MD5)}()},7655:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.mode.CFB=function(){var e=o.lib.BlockCipherMode.extend();function t(e,t,r,n){var i,o=this._iv;o?(i=o.slice(0),this._iv=void 0):i=this._prevBlock,n.encryptBlock(i,0);for(var s=0;s<r;s++)e[t+s]^=i[s]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize;t.call(this,e,r,i,n),this._prevBlock=e.slice(r,r+i)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize,o=e.slice(r,r+i);t.call(this,e,r,i,n),this._prevBlock=o}}),e}(),o.mode.CFB)}()},5081:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.mode.CTRGladman=function(){var e=o.lib.BlockCipherMode.extend();function t(e){if(255===(e>>24&255)){var t=e>>16&255,r=e>>8&255,n=255&e;255===t?(t=0,255===r?(r=0,255===n?n=0:++n):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=n}else e+=1<<24;return e}function r(e){return 0===(e[0]=t(e[0]))&&(e[1]=t(e[1])),e}var n=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,s=this._counter;o&&(s=this._counter=o.slice(0),this._iv=void 0),r(s);var a=s.slice(0);n.encryptBlock(a,0);for(var c=0;c<i;c++)e[t+c]^=a[c]}});return e.Decryptor=n,e}(),o.mode.CTRGladman)}()},818:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.mode.CTR=function(){var e=o.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0);var s=o.slice(0);r.encryptBlock(s,0),o[n-1]=o[n-1]+1|0;for(var a=0;a<n;a++)e[t+a]^=s[a]}});return e.Decryptor=t,e}(),o.mode.CTR)}()},6749:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.mode.ECB=function(){var e=o.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),o.mode.ECB)}()},2139:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.mode.OFB=function(){var e=o.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=this._iv,o=this._keystream;i&&(o=this._keystream=i.slice(0),this._iv=void 0),r.encryptBlock(o,0);for(var s=0;s<n;s++)e[t+s]^=o[s]}});return e.Decryptor=t,e}(),o.mode.OFB)}()},4852:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,n=4*t,i=n-r%n,o=r+i-1;e.clamp(),e.words[o>>>2]|=i<<24-o%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},o.pad.Ansix923)}()},7202:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.pad.Iso10126={pad:function(e,t){var r=4*t,n=r-e.sigBytes%r;e.concat(o.lib.WordArray.random(n-1)).concat(o.lib.WordArray.create([n<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},o.pad.Iso10126)}()},2721:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.pad.Iso97971={pad:function(e,t){e.concat(o.lib.WordArray.create([2147483648],1)),o.pad.ZeroPadding.pad(e,t)},unpad:function(e){o.pad.ZeroPadding.unpad(e),e.sigBytes--}},o.pad.Iso97971)}()},1459:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.pad.NoPadding={pad:function(){},unpad:function(){}},o.pad.NoPadding)}()},6277:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(7149),o.pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){var t=e.words,r=e.sigBytes-1;for(r=e.sigBytes-1;r>=0;r--)if(t[r>>>2]>>>24-r%4*8&255){e.sigBytes=r+1;break}}},o.pad.ZeroPadding)}()},1778:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(336),r(2503),function(){var e=o,t=e.lib,r=t.Base,n=t.WordArray,i=e.algo,s=i.SHA1,a=i.HMAC,c=i.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,i=a.create(r.hasher,e),o=n.create(),s=n.create([1]),c=o.words,u=s.words,l=r.keySize,d=r.iterations;c.length<l;){var h=i.update(t).finalize(s);i.reset();for(var p=h.words,f=p.length,g=h,m=1;m<d;m++){g=i.finalize(g),i.reset();for(var _=g.words,v=0;v<f;v++)p[v]^=_[v]}o.concat(h),u[0]++}return o.sigBytes=4*l,o}});e.PBKDF2=function(e,t,r){return c.create(r).compute(e,t)}}(),o.PBKDF2)}()},7476:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(6644),r(9142),r(7804),r(7149),function(){var e=o,t=e.lib.StreamCipher,r=e.algo,n=[],i=[],s=[],a=r.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;i<4;i++)c.call(this);for(i=0;i<8;i++)n[i]^=r[i+4&7];if(t){var o=t.words,s=o[0],a=o[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=u>>>16|4294901760&l,h=l<<16|65535&u;for(n[0]^=u,n[1]^=d,n[2]^=l,n[3]^=h,n[4]^=u,n[5]^=d,n[6]^=l,n[7]^=h,i=0;i<4;i++)c.call(this)}},_doProcessBlock:function(e,t){var r=this._X;c.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),e[t+i]^=n[i]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,r=0;r<8;r++)i[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,a=n>>>16,c=((o*o>>>17)+o*a>>>15)+a*a,u=((4294901760&n)*n|0)+((65535&n)*n|0);s[r]=c^u}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.RabbitLegacy=t._createHelper(a)}(),o.RabbitLegacy)}()},3936:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(6644),r(9142),r(7804),r(7149),function(){var e=o,t=e.lib.StreamCipher,r=e.algo,n=[],i=[],s=[],a=r.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,r=0;r<4;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,r=0;r<4;r++)c.call(this);for(r=0;r<8;r++)i[r]^=n[r+4&7];if(t){var o=t.words,s=o[0],a=o[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=u>>>16|4294901760&l,h=l<<16|65535&u;for(i[0]^=u,i[1]^=d,i[2]^=l,i[3]^=h,i[4]^=u,i[5]^=d,i[6]^=l,i[7]^=h,r=0;r<4;r++)c.call(this)}},_doProcessBlock:function(e,t){var r=this._X;c.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),e[t+i]^=n[i]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,r=0;r<8;r++)i[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,a=n>>>16,c=((o*o>>>17)+o*a>>>15)+a*a,u=((4294901760&n)*n|0)+((65535&n)*n|0);s[r]=c^u}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.Rabbit=t._createHelper(a)}(),o.Rabbit)}()},7419:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(6644),r(9142),r(7804),r(7149),function(){var e=o,t=e.lib.StreamCipher,r=e.algo,n=r.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes,n=this._S=[],i=0;i<256;i++)n[i]=i;i=0;for(var o=0;i<256;i++){var s=i%r,a=t[s>>>2]>>>24-s%4*8&255;o=(o+n[i]+a)%256;var c=n[i];n[i]=n[o],n[o]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,r=this._j,n=0,i=0;i<4;i++){r=(r+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[r],e[r]=o,n|=e[(e[t]+e[r])%256]<<24-8*i}return this._i=t,this._j=r,n}e.RC4=t._createHelper(n);var s=r.RC4Drop=n.extend({cfg:n.cfg.extend({drop:192}),_doReset:function(){n._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(s)}(),o.RC4)}()},8088:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(e){var t=i,r=t.lib,n=r.WordArray,o=r.Hasher,s=t.algo,a=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=n.create([0,1518500249,1859775393,2400959708,2840853838]),h=n.create([1352829926,1548603684,1836072691,2053994217,0]),p=s.RIPEMD160=o.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o,s,p,E,S,b,T,C,R,O,k,I=this._hash.words,L=d.words,w=h.words,A=a.words,N=c.words,P=u.words,M=l.words;for(b=o=I[0],T=s=I[1],C=p=I[2],R=E=I[3],O=S=I[4],r=0;r<80;r+=1)k=o+e[t+A[r]]|0,k+=r<16?f(s,p,E)+L[0]:r<32?g(s,p,E)+L[1]:r<48?m(s,p,E)+L[2]:r<64?_(s,p,E)+L[3]:v(s,p,E)+L[4],k=(k=y(k|=0,P[r]))+S|0,o=S,S=E,E=y(p,10),p=s,s=k,k=b+e[t+N[r]]|0,k+=r<16?v(T,C,R)+w[0]:r<32?_(T,C,R)+w[1]:r<48?m(T,C,R)+w[2]:r<64?g(T,C,R)+w[3]:f(T,C,R)+w[4],k=(k=y(k|=0,M[r]))+O|0,b=O,O=R,R=y(C,10),C=T,T=k;k=I[1]+p+R|0,I[1]=I[2]+E+O|0,I[2]=I[3]+S+b|0,I[3]=I[4]+o+T|0,I[4]=I[0]+s+C|0,I[0]=k},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,o=i.words,s=0;s<5;s++){var a=o[s];o[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return i},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function f(e,t,r){return e^t^r}function g(e,t,r){return e&t|~e&r}function m(e,t,r){return(e|~t)^r}function _(e,t,r){return e&r|t&~r}function v(e,t,r){return e^(t|~r)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=o._createHelper(p),t.HmacRIPEMD160=o._createHmacHelper(p)}(Math),i.RIPEMD160)}()},336:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(){var e=i,t=e.lib,r=t.WordArray,n=t.Hasher,o=e.algo,s=[],a=o.SHA1=n.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],c=r[4],u=0;u<80;u++){if(u<16)s[u]=0|e[t+u];else{var l=s[u-3]^s[u-8]^s[u-14]^s[u-16];s[u]=l<<1|l>>>31}var d=(n<<5|n>>>27)+c+s[u];d+=u<20?1518500249+(i&o|~i&a):u<40?1859775393+(i^o^a):u<60?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,c=a,a=o,o=i<<30|i>>>2,i=n,n=d}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=n._createHelper(a),e.HmacSHA1=n._createHmacHelper(a)}(),i.SHA1)}()},9524:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(5990),function(){var e=o,t=e.lib.WordArray,r=e.algo,n=r.SHA256,i=r.SHA224=n.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=n._createHelper(i),e.HmacSHA224=n._createHmacHelper(i)}(),o.SHA224)}()},5990:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(e){var t=i,r=t.lib,n=r.WordArray,o=r.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(a[i]=r(e.pow(n,.5))),c[i]=r(e.pow(n,1/3)),i++),n++}();var u=[],l=s.SHA256=o.extend({_doReset:function(){this._hash=new n.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],d=r[6],h=r[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var f=u[p-15],g=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,m=u[p-2],_=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;u[p]=g+u[p-7]+_+u[p-16]}var v=n&i^n&o^i&o,y=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),E=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&d)+c[p]+u[p];h=d,d=l,l=a,a=s+E|0,s=o,o=i,i=n,n=E+(y+v)|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+l|0,r[6]=r[6]+d|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),i.SHA256)}()},5562:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(8230),function(e){var t=o,r=t.lib,n=r.WordArray,i=r.Hasher,s=t.x64.Word,a=t.algo,c=[],u=[],l=[];!function(){for(var e=1,t=0,r=0;r<24;r++){c[e+5*t]=(r+1)*(r+2)/2%64;var n=(2*e+3*t)%5;e=t%5,t=n}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,o=0;o<24;o++){for(var a=0,d=0,h=0;h<7;h++){if(1&i){var p=(1<<h)-1;p<32?d^=1<<p:a^=1<<p-32}128&i?i=i<<1^113:i<<=1}l[o]=s.create(a,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=s.create()}();var h=a.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var r=this._state,n=this.blockSize/2,i=0;i<n;i++){var o=e[t+2*i],s=e[t+2*i+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),(I=r[i]).high^=s,I.low^=o}for(var a=0;a<24;a++){for(var h=0;h<5;h++){for(var p=0,f=0,g=0;g<5;g++)p^=(I=r[h+5*g]).high,f^=I.low;var m=d[h];m.high=p,m.low=f}for(h=0;h<5;h++){var _=d[(h+4)%5],v=d[(h+1)%5],y=v.high,E=v.low;for(p=_.high^(y<<1|E>>>31),f=_.low^(E<<1|y>>>31),g=0;g<5;g++)(I=r[h+5*g]).high^=p,I.low^=f}for(var S=1;S<25;S++){var b=(I=r[S]).high,T=I.low,C=c[S];C<32?(p=b<<C|T>>>32-C,f=T<<C|b>>>32-C):(p=T<<C-32|b>>>64-C,f=b<<C-32|T>>>64-C);var R=d[u[S]];R.high=p,R.low=f}var O=d[0],k=r[0];for(O.high=k.high,O.low=k.low,h=0;h<5;h++)for(g=0;g<5;g++){var I=r[S=h+5*g],L=d[S],w=d[(h+1)%5+5*g],A=d[(h+2)%5+5*g];I.high=L.high^~w.high&A.high,I.low=L.low^~w.low&A.low}I=r[0];var N=l[a];I.high^=N.high,I.low^=N.low}},_doFinalize:function(){var t=this._data,r=t.words,i=(this._nDataBytes,8*t.sigBytes),o=32*this.blockSize;r[i>>>5]|=1<<24-i%32,r[(e.ceil((i+1)/o)*o>>>5)-1]|=128,t.sigBytes=4*r.length,this._process();for(var s=this._state,a=this.cfg.outputLength/8,c=a/8,u=[],l=0;l<c;l++){var d=s[l],h=d.high,p=d.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),u.push(p),u.push(h)}return new n.init(u,a)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});t.SHA3=i._createHelper(h),t.HmacSHA3=i._createHmacHelper(h)}(Math),o.SHA3)}()},9111:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(8230),r(9308),function(){var e=o,t=e.x64,r=t.Word,n=t.WordArray,i=e.algo,s=i.SHA512,a=i.SHA384=s.extend({_doReset:function(){this._hash=new n.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=s._createHelper(a),e.HmacSHA384=s._createHmacHelper(a)}(),o.SHA384)}()},9308:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(8230),function(){var e=o,t=e.lib.Hasher,r=e.x64,n=r.Word,i=r.WordArray,s=e.algo;function a(){return n.create.apply(n,arguments)}var c=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=a()}();var l=s.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],d=r[6],h=r[7],p=n.high,f=n.low,g=i.high,m=i.low,_=o.high,v=o.low,y=s.high,E=s.low,S=a.high,b=a.low,T=l.high,C=l.low,R=d.high,O=d.low,k=h.high,I=h.low,L=p,w=f,A=g,N=m,P=_,M=v,D=y,U=E,x=S,B=b,j=T,H=C,G=R,z=O,q=k,V=I,F=0;F<80;F++){var Z,W,Y=u[F];if(F<16)W=Y.high=0|e[t+2*F],Z=Y.low=0|e[t+2*F+1];else{var Q=u[F-15],K=Q.high,J=Q.low,X=(K>>>1|J<<31)^(K>>>8|J<<24)^K>>>7,$=(J>>>1|K<<31)^(J>>>8|K<<24)^(J>>>7|K<<25),ee=u[F-2],te=ee.high,re=ee.low,ne=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,ie=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),oe=u[F-7],se=oe.high,ae=oe.low,ce=u[F-16],ue=ce.high,le=ce.low;W=(W=(W=X+se+((Z=$+ae)>>>0<$>>>0?1:0))+ne+((Z+=ie)>>>0<ie>>>0?1:0))+ue+((Z+=le)>>>0<le>>>0?1:0),Y.high=W,Y.low=Z}var de,he=x&j^~x&G,pe=B&H^~B&z,fe=L&A^L&P^A&P,ge=w&N^w&M^N&M,me=(L>>>28|w<<4)^(L<<30|w>>>2)^(L<<25|w>>>7),_e=(w>>>28|L<<4)^(w<<30|L>>>2)^(w<<25|L>>>7),ve=(x>>>14|B<<18)^(x>>>18|B<<14)^(x<<23|B>>>9),ye=(B>>>14|x<<18)^(B>>>18|x<<14)^(B<<23|x>>>9),Ee=c[F],Se=Ee.high,be=Ee.low,Te=q+ve+((de=V+ye)>>>0<V>>>0?1:0),Ce=_e+ge;q=G,V=z,G=j,z=H,j=x,H=B,x=D+(Te=(Te=(Te=Te+he+((de+=pe)>>>0<pe>>>0?1:0))+Se+((de+=be)>>>0<be>>>0?1:0))+W+((de+=Z)>>>0<Z>>>0?1:0))+((B=U+de|0)>>>0<U>>>0?1:0)|0,D=P,U=M,P=A,M=N,A=L,N=w,L=Te+(me+fe+(Ce>>>0<_e>>>0?1:0))+((w=de+Ce|0)>>>0<de>>>0?1:0)|0}f=n.low=f+w,n.high=p+L+(f>>>0<w>>>0?1:0),m=i.low=m+N,i.high=g+A+(m>>>0<N>>>0?1:0),v=o.low=v+M,o.high=_+P+(v>>>0<M>>>0?1:0),E=s.low=E+U,s.high=y+D+(E>>>0<U>>>0?1:0),b=a.low=b+B,a.high=S+x+(b>>>0<B>>>0?1:0),C=l.low=C+H,l.high=T+j+(C>>>0<H>>>0?1:0),O=d.low=O+z,d.high=R+G+(O>>>0<z>>>0?1:0),I=h.low=I+V,h.high=k+q+(I>>>0<V>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),o.SHA512)}()},543:function(e,t,r){!function(t,n,i){var o;e.exports=(o=r(169),r(6644),r(9142),r(7804),r(7149),function(){var e=o,t=e.lib,r=t.WordArray,n=t.BlockCipher,i=e.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=n.extend({_doReset:function(){for(var e=this._key.words,t=[],r=0;r<56;r++){var n=s[r]-1;t[r]=e[n>>>5]>>>31-n%32&1}for(var i=this._subKeys=[],o=0;o<16;o++){var u=i[o]=[],l=c[o];for(r=0;r<24;r++)u[r/6|0]|=t[(a[r]-1+l)%28]<<31-r%6,u[4+(r/6|0)]|=t[28+(a[r+24]-1+l)%28]<<31-r%6;for(u[0]=u[0]<<1|u[0]>>>31,r=1;r<7;r++)u[r]=u[r]>>>4*(r-1)+3;u[7]=u[7]<<5|u[7]>>>27}var d=this._invSubKeys=[];for(r=0;r<16;r++)d[r]=i[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,r){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),h.call(this,1,1431655765);for(var n=0;n<16;n++){for(var i=r[n],o=this._lBlock,s=this._rBlock,a=0,c=0;c<8;c++)a|=u[c][((s^i[c])&l[c])>>>0];this._lBlock=s,this._rBlock=o^a}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,h.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function p(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}e.DES=n._createHelper(d);var f=i.TripleDES=n.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),i=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=d.createEncryptor(r.create(t)),this._des2=d.createEncryptor(r.create(n)),this._des3=d.createEncryptor(r.create(i))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=n._createHelper(f)}(),o.TripleDES)}()},8230:function(e,t,r){!function(t,n){var i;e.exports=(i=r(169),function(e){var t=i,r=t.lib,n=r.Base,o=r.WordArray,s=t.x64={};s.Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=n.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=r!=e?r:8*t.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var i=e[n];r.push(i.high),r.push(i.low)}return o.create(r,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),r=t.length,i=0;i<r;i++)t[i]=t[i].clone();return e}})}(),i)}()},9518:function(e){var t;self,t=function(){return function(){var e={"./node_modules/es6-promise/dist/es6-promise.js":function(e,t,r){e.exports=function(){"use strict";function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"===typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,o=void 0,s=void 0,a=function(e,t){E[i]=e,E[i+1]=t,2===(i+=2)&&(s?s(S):T())};function c(e){s=e}function u(e){a=e}var l="undefined"!==typeof window?window:void 0,d=l||{},h=d.MutationObserver||d.WebKitMutationObserver,p="undefined"===typeof self&&"undefined"!==typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel;function g(){return function(){return process.nextTick(S)}}function m(){return"undefined"!==typeof o?function(){o(S)}:y()}function _(){var e=0,t=new h(S),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function v(){var e=new MessageChannel;return e.port1.onmessage=S,function(){return e.port2.postMessage(0)}}function y(){var e=setTimeout;return function(){return e(S,1)}}var E=new Array(1e3);function S(){for(var e=0;e<i;e+=2)(0,E[e])(E[e+1]),E[e]=void 0,E[e+1]=void 0;i=0}function b(){try{var e=Function("return this")().require("vertx");return o=e.runOnLoop||e.runOnContext,m()}catch(t){return y()}}var T=void 0;function C(e,t){var r=this,n=new this.constructor(k);void 0===n[O]&&W(n);var i=r._state;if(i){var o=arguments[i-1];a((function(){return q(i,n,o,r._result)}))}else G(r,n,e,t);return n}function R(e){var t=this;if(e&&"object"===typeof e&&e.constructor===t)return e;var r=new t(k);return x(r,e),r}T=p?g():h?_():f?v():void 0===l?b():y();var O=Math.random().toString(36).substring(2);function k(){}var I=void 0,L=1,w=2;function A(){return new TypeError("You cannot resolve a promise with itself")}function N(){return new TypeError("A promises callback cannot return that same promise.")}function P(e,t,r,n){try{e.call(t,r,n)}catch(i){return i}}function M(e,t,r){a((function(e){var n=!1,i=P(r,t,(function(r){n||(n=!0,t!==r?x(e,r):j(e,r))}),(function(t){n||(n=!0,H(e,t))}),"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,H(e,i))}),e)}function D(e,t){t._state===L?j(e,t._result):t._state===w?H(e,t._result):G(t,void 0,(function(t){return x(e,t)}),(function(t){return H(e,t)}))}function U(e,r,n){r.constructor===e.constructor&&n===C&&r.constructor.resolve===R?D(e,r):void 0===n?j(e,r):t(n)?M(e,r,n):j(e,r)}function x(t,r){if(t===r)H(t,A());else if(e(r)){var n=void 0;try{n=r.then}catch(error){return void H(t,error)}U(t,r,n)}else j(t,r)}function B(e){e._onerror&&e._onerror(e._result),z(e)}function j(e,t){e._state===I&&(e._result=t,e._state=L,0!==e._subscribers.length&&a(z,e))}function H(e,t){e._state===I&&(e._state=w,e._result=t,a(B,e))}function G(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+L]=r,i[o+w]=n,0===o&&e._state&&a(z,e)}function z(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?q(r,n,i,o):i(o);e._subscribers.length=0}}function q(e,r,n,i){var o=t(n),s=void 0,a=void 0,c=!0;if(o){try{s=n(i)}catch(u){c=!1,a=u}if(r===s)return void H(r,N())}else s=i;r._state!==I||(o&&c?x(r,s):!1===c?H(r,a):e===L?j(r,s):e===w&&H(r,s))}function V(e,t){try{t((function(t){x(e,t)}),(function(t){H(e,t)}))}catch(r){H(e,r)}}var F=0;function Z(){return F++}function W(e){e[O]=F++,e._state=void 0,e._result=void 0,e._subscribers=[]}function Y(){return new Error("Array Methods must be provided an Array")}var Q=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(k),this.promise[O]||W(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&j(this.promise,this._result))):H(this.promise,Y())}return e.prototype._enumerate=function(e){for(var t=0;this._state===I&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===R){var i=void 0,o=void 0,s=!1;try{i=e.then}catch(c){s=!0,o=c}if(i===C&&e._state!==I)this._settledAt(e._state,t,e._result);else if("function"!==typeof i)this._remaining--,this._result[t]=e;else if(r===te){var a=new r(k);s?H(a,o):U(a,e,i),this._willSettleAt(a,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===I&&(this._remaining--,e===w?H(n,r):this._result[t]=r),0===this._remaining&&j(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;G(e,void 0,(function(e){return r._settledAt(L,t,e)}),(function(e){return r._settledAt(w,t,e)}))},e}();function K(e){return new Q(this,e).promise}function J(e){var t=this;return n(e)?new t((function(r,n){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))}function X(e){var t=new this(k);return H(t,e),t}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ee(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var te=function(){function e(t){this[O]=Z(),this._result=this._state=void 0,this._subscribers=[],k!==t&&("function"!==typeof t&&$(),this instanceof e?V(this,t):ee())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var r=this,n=r.constructor;return t(e)?r.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):r.then(e,e)},e}();function re(){var e=void 0;if("undefined"!==typeof r.g)e=r.g;else if("undefined"!==typeof self)e=self;else try{e=Function("return this")()}catch(i){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(i){}if("[object Promise]"===n&&!t.cast)return}e.Promise=te}return te.prototype.then=C,te.all=K,te.race=J,te.resolve=R,te.reject=X,te._setScheduler=c,te._setAsap=u,te._asap=a,te.polyfill=re,te.Promise=te,te}()},"./node_modules/events/events.js":function(e){"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&g(e,"error",t,r)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,s,u;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"===typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var u=c.length,l=f(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function n(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,n){var a={};a[n]=[];var c=t.toString(),u=c.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return a;for(var l,d=u[1],h=new RegExp("(\\\\n|\\W)"+s(d)+o,"g");l=h.exec(c);)"dll-reference"!==l[3]&&a[n].push(l[3]);for(h=new RegExp("\\("+s(d)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+o,"g");l=h.exec(c);)e[l[2]]||(a[n].push(l[1]),e[l[2]]=r(l[1]).m),a[l[2]]=a[l[2]]||[],a[l[2]].push(l[4]);for(var p,f=Object.keys(a),g=0;g<f.length;g++)for(var m=0;m<a[f[g]].length;m++)p=a[f[g]][m],isNaN(1*p)||(a[f[g]][m]=1*a[f[g]][m]);return a}function c(e){return Object.keys(e).reduce((function(t,r){return t||e[r].length>0}),!1)}e.exports=function(e,t){t=t||{};var i={main:r.m},o=t.all?{main:Object.keys(i.main)}:function(e,t){for(var r={main:[t]},n={main:[]},i={main:{}};c(r);)for(var o=Object.keys(r),s=0;s<o.length;s++){var u=o[s],l=r[u].pop();if(i[u]=i[u]||{},!i[u][l]&&e[u][l]){i[u][l]=!0,n[u]=n[u]||[],n[u].push(l);for(var d=a(e,e[u][l],u),h=Object.keys(d),p=0;p<h.length;p++)r[h[p]]=r[h[p]]||[],r[h[p]]=r[h[p]].concat(d[h[p]])}}return n}(i,e),s="";Object.keys(o).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;o[e][t];)t++;o[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map((function(t){return JSON.stringify(t)+": "+i[e][t].toString()})).join(",")+"});\n"})),s=s+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map((function(e){return JSON.stringify(e)+": "+i.main[e].toString()})).join(",")+"}))(self);";var u=new window.Blob([s],{type:"text/javascript"});if(t.bare)return u;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),d=new window.Worker(l);return d.objectURL=l,d}},"./src/config.js":function(e,t,r){"use strict";r.r(t),r.d(t,{defaultConfig:function(){return n},createDefaultConfig:function(){return i}});var n={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function i(){return Object.assign({},n)}},"./src/core/features.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/io/io-controller.js"),i=r("./src/config.js"),o=function(){function e(){}return e.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},e.supportNetworkStreamIO=function(){var e=new n.default({},(0,i.createDefaultConfig)()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t},e.getNetworkLoaderTypeName=function(){var e=new n.default({},(0,i.createDefaultConfig)()),t=e.loaderType;return e.destroy(),t},e.supportNativeMediaPlayback=function(t){void 0==e.videoElement&&(e.videoElement=window.document.createElement("video"));var r=e.videoElement.canPlayType(t);return"probably"===r||"maybe"==r},e.getFeatureList=function(){var t={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.mseFlvPlayback=e.supportMSEH264Playback(),t.networkStreamIO=e.supportNetworkStreamIO(),t.networkLoaderName=e.getNetworkLoaderTypeName(),t.mseLiveFlvPlayback=t.mseFlvPlayback&&t.networkStreamIO,t.nativeMP4H264Playback=e.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeWebmVP8Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t},e}();t.default=o},"./src/core/media-info.js":function(e,t,r){"use strict";r.r(t);var n=function(){function e(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return e.prototype.isComplete=function(){var e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&null!=this.duration&&null!=this.metadata&&null!=this.hasKeyframesIndex&&e&&t},e.prototype.isSeekable=function(){return!0===this.hasKeyframesIndex},e.prototype.getNearestKeyframe=function(e){if(null==this.keyframesIndex)return null;var t=this.keyframesIndex,r=this._search(t.times,e);return{index:r,milliseconds:t.times[r],fileposition:t.filepositions[r]}},e.prototype._search=function(e,t){var r=0,n=e.length-1,i=0,o=0,s=n;for(t<e[0]&&(r=0,o=s+1);o<=s;){if((i=o+Math.floor((s-o)/2))===n||t>=e[i]&&t<e[i+1]){r=i;break}e[i]<t?o=i+1:s=i-1}return r},e}();t.default=n},"./src/core/media-segment-info.js":function(e,t,r){"use strict";r.r(t),r.d(t,{SampleInfo:function(){return n},MediaSegmentInfo:function(){return i},IDRSampleList:function(){return o},MediaSegmentInfoList:function(){return s}});var n=function(e,t,r,n,i){this.dts=e,this.pts=t,this.duration=r,this.originalDts=n,this.isSyncPoint=i,this.fileposition=null},i=function(){function e(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return e.prototype.appendSyncPoint=function(e){e.isSyncPoint=!0,this.syncPoints.push(e)},e}(),o=function(){function e(){this._list=[]}return e.prototype.clear=function(){this._list=[]},e.prototype.appendArray=function(e){var t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))},e.prototype.getLastSyncPointBeforeDts=function(e){if(0==this._list.length)return null;var t=this._list,r=0,n=t.length-1,i=0,o=0,s=n;for(e<t[0].dts&&(r=0,o=s+1);o<=s;){if((i=o+Math.floor((s-o)/2))===n||e>=t[i].dts&&e<t[i+1].dts){r=i;break}t[i].dts<e?o=i+1:s=i-1}return this._list[r]},e}(),s=function(){function e(e){this._type=e,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._list.length},e.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},e.prototype._searchNearestSegmentBefore=function(e){var t=this._list;if(0===t.length)return-2;var r=t.length-1,n=0,i=0,o=r,s=0;if(e<t[0].originalBeginDts)return s=-1;for(;i<=o;){if((n=i+Math.floor((o-i)/2))===r||e>t[n].lastSample.originalDts&&e<t[n+1].originalBeginDts){s=n;break}t[n].originalBeginDts<e?i=n+1:o=n-1}return s},e.prototype._searchNearestSegmentAfter=function(e){return this._searchNearestSegmentBefore(e)+1},e.prototype.append=function(e){var t=this._list,r=e,n=this._lastAppendLocation,i=0;-1!==n&&n<t.length&&r.originalBeginDts>=t[n].lastSample.originalDts&&(n===t.length-1||n<t.length-1&&r.originalBeginDts<t[n+1].originalBeginDts)?i=n+1:t.length>0&&(i=this._searchNearestSegmentBefore(r.originalBeginDts)+1),this._lastAppendLocation=i,this._list.splice(i,0,r)},e.prototype.getLastSegmentBefore=function(e){var t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null},e.prototype.getLastSampleBefore=function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null},e.prototype.getLastSyncPointBefore=function(e){for(var t=this._searchNearestSegmentBefore(e),r=this._list[t].syncPoints;0===r.length&&t>0;)t--,r=this._list[t].syncPoints;return r.length>0?r[r.length-1]:null},e}()},"./src/core/mse-controller.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/events/events.js"),i=r.n(n),o=r("./src/utils/logger.js"),s=r("./src/utils/browser.js"),a=r("./src/core/mse-events.js"),c=r("./src/core/media-segment-info.js"),u=r("./src/utils/exception.js"),l=function(){function e(e){this.TAG="MSEController",this._config=e,this._emitter=new(i()),this._config.isLive&&void 0==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new c.IDRSampleList}return e.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaSource)throw new u.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL},e.prototype.detachMediaElement=function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var r=this._pendingSegments[t];r.splice(0,r.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var n=this._sourceBuffers[t];if(n){if("closed"!==e.readyState){try{e.removeSourceBuffer(n)}catch(error){o.default.e(this.TAG,error.message)}n.removeEventListener("error",this.e.onSourceBufferError),n.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(error){o.default.e(this.TAG,error.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},e.prototype.appendInitSegment=function(e,t){if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);var r=e,n=""+r.container;r.codec&&r.codec.length>0&&(n+=";codecs="+r.codec);var i=!1;if(o.default.v(this.TAG,"Received Initialization Segment, mimeType: "+n),this._lastInitSegments[r.type]=r,n!==this._mimeTypes[r.type]){if(this._mimeTypes[r.type])o.default.v(this.TAG,"Notice: "+r.type+" mimeType changed, origin: "+this._mimeTypes[r.type]+", target: "+n);else{i=!0;try{var c=this._sourceBuffers[r.type]=this._mediaSource.addSourceBuffer(n);c.addEventListener("error",this.e.onSourceBufferError),c.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(error){return o.default.e(this.TAG,error.message),void this._emitter.emit(a.default.ERROR,{code:error.code,msg:error.message})}}this._mimeTypes[r.type]=n}t||this._pendingSegments[r.type].push(r),i||this._sourceBuffers[r.type]&&!this._sourceBuffers[r.type].updating&&this._doAppendSegments(),s.default.safari&&"audio/mpeg"===r.container&&r.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=r.mediaDuration/1e3,this._updateMediaSourceDuration())},e.prototype.appendMediaSegment=function(e){var t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var r=this._sourceBuffers[t.type];!r||r.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},e.prototype.seek=function(e){for(var t in this._sourceBuffers)if(this._sourceBuffers[t]){var r=this._sourceBuffers[t];if("open"===this._mediaSource.readyState)try{r.abort()}catch(error){o.default.e(this.TAG,error.message)}this._idrList.clear();var n=this._pendingSegments[t];if(n.splice(0,n.length),"closed"!==this._mediaSource.readyState){for(var i=0;i<r.buffered.length;i++){var a=r.buffered.start(i),c=r.buffered.end(i);this._pendingRemoveRanges[t].push({start:a,end:c})}if(r.updating||this._doRemoveRanges(),s.default.safari){var u=this._lastInitSegments[t];u&&(this._pendingSegments[t].push(u),r.updating||this._doAppendSegments())}}}},e.prototype.endOfStream=function(){var e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},e.prototype.getNearestKeyframe=function(e){return this._idrList.getLastSyncPointBeforeDts(e)},e.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var r=this._sourceBuffers[t];if(r){var n=r.buffered;if(n.length>=1&&e-n.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},e.prototype._doCleanupSourceBuffer=function(){var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var r=this._sourceBuffers[t];if(r){for(var n=r.buffered,i=!1,o=0;o<n.length;o++){var s=n.start(o),a=n.end(o);if(s<=e&&e<a+3){if(e-s>=this._config.autoCleanupMaxBackwardDuration){i=!0;var c=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:s,end:c})}}else a<e&&(i=!0,this._pendingRemoveRanges[t].push({start:s,end:a}))}i&&!r.updating&&this._doRemoveRanges()}}},e.prototype._updateMediaSourceDuration=function(){var e=this._sourceBuffers;if(0!==this._mediaElement.readyState&&"open"===this._mediaSource.readyState&&!(e.video&&e.video.updating||e.audio&&e.audio.updating)){var t=this._mediaSource.duration,r=this._pendingMediaDuration;r>0&&(isNaN(t)||r>t)&&(o.default.v(this.TAG,"Update MediaSource duration from "+t+" to "+r),this._mediaSource.duration=r),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},e.prototype._doRemoveRanges=function(){for(var e in this._pendingRemoveRanges)if(this._sourceBuffers[e]&&!this._sourceBuffers[e].updating)for(var t=this._sourceBuffers[e],r=this._pendingRemoveRanges[e];r.length&&!t.updating;){var n=r.shift();t.remove(n.start,n.end)}},e.prototype._doAppendSegments=function(){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){var r=e[t].shift();if(r.timestampOffset){var n=this._sourceBuffers[t].timestampOffset,i=r.timestampOffset/1e3;Math.abs(n-i)>.1&&(o.default.v(this.TAG,"Update MPEG audio timestampOffset from "+n+" to "+i),this._sourceBuffers[t].timestampOffset=i),delete r.timestampOffset}if(!r.data||0===r.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(r.data),this._isBufferFull=!1,"video"===t&&r.hasOwnProperty("info")&&this._idrList.appendArray(r.info.syncPoints)}catch(error){this._pendingSegments[t].unshift(r),22===error.code?(this._isBufferFull||this._emitter.emit(a.default.BUFFER_FULL),this._isBufferFull=!0):(o.default.e(this.TAG,error.message),this._emitter.emit(a.default.ERROR,{code:error.code,msg:error.message}))}}},e.prototype._onSourceOpen=function(){if(o.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(a.default.SOURCE_OPEN)},e.prototype._onSourceEnded=function(){o.default.v(this.TAG,"MediaSource onSourceEnded")},e.prototype._onSourceClose=function(){o.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},e.prototype._hasPendingSegments=function(){var e=this._pendingSegments;return e.video.length>0||e.audio.length>0},e.prototype._hasPendingRemoveRanges=function(){var e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0},e.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(a.default.UPDATE_END)},e.prototype._onSourceBufferError=function(e){o.default.e(this.TAG,"SourceBuffer Error: "+e)},e}();t.default=l},"./src/core/mse-events.js":function(e,t,r){"use strict";r.r(t),t.default={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"}},"./src/core/transmuxer.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/events/events.js"),i=r.n(n),o=r("./node_modules/webworkify-webpack/index.js"),s=r.n(o),a=r("./src/utils/logger.js"),c=r("./src/utils/logging-control.js"),u=r("./src/core/transmuxing-controller.js"),l=r("./src/core/transmuxing-events.js"),d=r("./src/core/media-info.js"),h=function(){function e(e,t){if(this.TAG="Transmuxer",this._emitter=new(i()),t.enableWorker&&"undefined"!==typeof Worker)try{this._worker=s()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},c.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:c.default.getConfig()})}catch(error){a.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new u.default(e,t)}else this._controller=new u.default(e,t);if(this._controller){var r=this._controller;r.on(l.default.IO_ERROR,this._onIOError.bind(this)),r.on(l.default.DEMUX_ERROR,this._onDemuxError.bind(this)),r.on(l.default.INIT_SEGMENT,this._onInitSegment.bind(this)),r.on(l.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),r.on(l.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),r.on(l.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),r.on(l.default.MEDIA_INFO,this._onMediaInfo.bind(this)),r.on(l.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),r.on(l.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),r.on(l.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),r.on(l.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return e.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),c.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.hasWorker=function(){return null!=this._worker},e.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},e.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},e.prototype.seek=function(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)},e.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},e.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},e.prototype._onInitSegment=function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.INIT_SEGMENT,e,t)}))},e.prototype._onMediaSegment=function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.MEDIA_SEGMENT,e,t)}))},e.prototype._onLoadingComplete=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(l.default.LOADING_COMPLETE)}))},e.prototype._onRecoveredEarlyEof=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(l.default.RECOVERED_EARLY_EOF)}))},e.prototype._onMediaInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.MEDIA_INFO,e)}))},e.prototype._onMetaDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.METADATA_ARRIVED,e)}))},e.prototype._onScriptDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.SCRIPTDATA_ARRIVED,e)}))},e.prototype._onStatisticsInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.STATISTICS_INFO,e)}))},e.prototype._onIOError=function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.IO_ERROR,e,t)}))},e.prototype._onDemuxError=function(e,t){var r=this;Promise.resolve().then((function(){r._emitter.emit(l.default.DEMUX_ERROR,e,t)}))},e.prototype._onRecommendSeekpoint=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(l.default.RECOMMEND_SEEKPOINT,e)}))},e.prototype._onLoggingConfigChanged=function(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})},e.prototype._onWorkerMessage=function(e){var t=e.data,r=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case l.default.INIT_SEGMENT:case l.default.MEDIA_SEGMENT:this._emitter.emit(t.msg,r.type,r.data);break;case l.default.LOADING_COMPLETE:case l.default.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case l.default.MEDIA_INFO:Object.setPrototypeOf(r,d.default.prototype),this._emitter.emit(t.msg,r);break;case l.default.METADATA_ARRIVED:case l.default.SCRIPTDATA_ARRIVED:case l.default.STATISTICS_INFO:this._emitter.emit(t.msg,r);break;case l.default.IO_ERROR:case l.default.DEMUX_ERROR:this._emitter.emit(t.msg,r.type,r.info);break;case l.default.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,r);break;case"logcat_callback":a.default.emitter.emit("log",r.type,r.logcat)}},e}();t.default=h},"./src/core/transmuxing-controller.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/events/events.js"),i=r.n(n),o=r("./src/utils/logger.js"),s=r("./src/utils/browser.js"),a=r("./src/core/media-info.js"),c=r("./src/demux/flv-demuxer.js"),u=r("./src/remux/mp4-remuxer.js"),l=r("./src/demux/demux-errors.js"),d=r("./src/io/io-controller.js"),h=r("./src/core/transmuxing-events.js"),p=function(){function e(e,t){this.TAG="TransmuxingController",this._emitter=new(i()),this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!==typeof e.cors&&(e.cors=!0),"boolean"!==typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var r=0;this._mediaDataSource.segments.forEach((function(n){n.timestampBase=r,r+=n.duration,n.cors=e.cors,n.withCredentials=e.withCredentials,t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy)})),isNaN(r)||this._mediaDataSource.duration===r||(this._mediaDataSource.duration=r),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return e.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},e.prototype._loadSegment=function(e,t){this._currentSegmentIndex=e;var r=this._mediaDataSource.segments[e],n=this._ioctl=new d.default(r,this._config,e);n.onError=this._onIOException.bind(this),n.onSeeked=this._onIOSeeked.bind(this),n.onComplete=this._onIOComplete.bind(this),n.onRedirect=this._onIORedirect.bind(this),n.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):n.onDataArrival=this._onInitChunkArrival.bind(this),n.open(t)},e.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},e.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},e.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},e.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},e.prototype.seek=function(e){if(null!=this._mediaInfo&&this._mediaInfo.isSeekable()){var t=this._searchSegmentIndexContains(e);if(t===this._currentSegmentIndex){var r=this._mediaInfo.segments[t];if(void 0==r)this._pendingSeekTime=e;else{var n=r.getNearestKeyframe(e);this._remuxer.seek(n.milliseconds),this._ioctl.seek(n.fileposition),this._pendingResolveSeekPoint=n.milliseconds}}else{var i=this._mediaInfo.segments[t];void 0==i?(this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t)):(n=i.getNearestKeyframe(e),this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,n.fileposition),this._pendingResolveSeekPoint=n.milliseconds,this._reportSegmentMediaInfo(t))}this._enableStatisticsReporter()}},e.prototype._searchSegmentIndexContains=function(e){for(var t=this._mediaDataSource.segments,r=t.length-1,n=0;n<t.length;n++)if(e<t[n].timestampBase){r=n-1;break}return r},e.prototype._onInitChunkArrival=function(e,t){var r=this,n=null,i=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,i=this._demuxer.parseChunks(e,t);else if((n=c.default.probe(e)).match){this._demuxer=new c.default(n,this._config),this._remuxer||(this._remuxer=new u.default(this._config));var s=this._mediaDataSource;void 0==s.duration||isNaN(s.duration)||(this._demuxer.overridedDuration=s.duration),"boolean"===typeof s.hasAudio&&(this._demuxer.overridedHasAudio=s.hasAudio),"boolean"===typeof s.hasVideo&&(this._demuxer.overridedHasVideo=s.hasVideo),this._demuxer.timestampBase=s.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),i=this._demuxer.parseChunks(e,t)}else n=null,o.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then((function(){r._internalAbort()})),this._emitter.emit(h.default.DEMUX_ERROR,l.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),i=0;return i},e.prototype._onMediaInfo=function(e){var t=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,a.default.prototype));var r=Object.assign({},e);Object.setPrototypeOf(r,a.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=r,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then((function(){var e=t._pendingSeekTime;t._pendingSeekTime=null,t.seek(e)}))},e.prototype._onMetaDataArrived=function(e){this._emitter.emit(h.default.METADATA_ARRIVED,e)},e.prototype._onScriptDataArrived=function(e){this._emitter.emit(h.default.SCRIPTDATA_ARRIVED,e)},e.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},e.prototype._onIOComplete=function(e){var t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer.flushStashedSamples(),this._emitter.emit(h.default.LOADING_COMPLETE),this._disableStatisticsReporter())},e.prototype._onIORedirect=function(e){var t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e},e.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(h.default.RECOVERED_EARLY_EOF)},e.prototype._onIOException=function(e,t){o.default.e(this.TAG,"IOException: type = "+e+", code = "+t.code+", msg = "+t.msg),this._emitter.emit(h.default.IO_ERROR,e,t),this._disableStatisticsReporter()},e.prototype._onDemuxException=function(e,t){o.default.e(this.TAG,"DemuxException: type = "+e+", info = "+t),this._emitter.emit(h.default.DEMUX_ERROR,e,t)},e.prototype._onRemuxerInitSegmentArrival=function(e,t){this._emitter.emit(h.default.INIT_SEGMENT,e,t)},e.prototype._onRemuxerMediaSegmentArrival=function(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(h.default.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){var r=t.info.syncPoints,n=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,s.default.safari&&r.length>0&&r[0].originalDts===n&&(n=r[0].pts),this._emitter.emit(h.default.RECOMMEND_SEEKPOINT,n)}},e.prototype._enableStatisticsReporter=function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},e.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype._reportSegmentMediaInfo=function(e){var t=this._mediaInfo.segments[e],r=Object.assign({},t);r.duration=this._mediaInfo.duration,r.segmentCount=this._mediaInfo.segmentCount,delete r.segments,delete r.keyframesIndex,this._emitter.emit(h.default.MEDIA_INFO,r)},e.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(h.default.STATISTICS_INFO,e)},e}();t.default=p},"./src/core/transmuxing-events.js":function(e,t,r){"use strict";r.r(t),t.default={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},"./src/core/transmuxing-worker.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/logging-control.js"),i=r("./src/utils/polyfill.js"),o=r("./src/core/transmuxing-controller.js"),s=r("./src/core/transmuxing-events.js");t.default=function(e){var t=null,r=function(t,r){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:r}})}.bind(this);function a(t,r){var n={msg:s.default.INIT_SEGMENT,data:{type:t,data:r}};e.postMessage(n,[r.data])}function c(t,r){var n={msg:s.default.MEDIA_SEGMENT,data:{type:t,data:r}};e.postMessage(n,[r.data])}function u(){var t={msg:s.default.LOADING_COMPLETE};e.postMessage(t)}function l(){var t={msg:s.default.RECOVERED_EARLY_EOF};e.postMessage(t)}function d(t){var r={msg:s.default.MEDIA_INFO,data:t};e.postMessage(r)}function h(t){var r={msg:s.default.METADATA_ARRIVED,data:t};e.postMessage(r)}function p(t){var r={msg:s.default.SCRIPTDATA_ARRIVED,data:t};e.postMessage(r)}function f(t){var r={msg:s.default.STATISTICS_INFO,data:t};e.postMessage(r)}function g(t,r){e.postMessage({msg:s.default.IO_ERROR,data:{type:t,info:r}})}function m(t,r){e.postMessage({msg:s.default.DEMUX_ERROR,data:{type:t,info:r}})}function _(t){e.postMessage({msg:s.default.RECOMMEND_SEEKPOINT,data:t})}i.default.install(),e.addEventListener("message",(function(i){switch(i.data.cmd){case"init":(t=new o.default(i.data.param[0],i.data.param[1])).on(s.default.IO_ERROR,g.bind(this)),t.on(s.default.DEMUX_ERROR,m.bind(this)),t.on(s.default.INIT_SEGMENT,a.bind(this)),t.on(s.default.MEDIA_SEGMENT,c.bind(this)),t.on(s.default.LOADING_COMPLETE,u.bind(this)),t.on(s.default.RECOVERED_EARLY_EOF,l.bind(this)),t.on(s.default.MEDIA_INFO,d.bind(this)),t.on(s.default.METADATA_ARRIVED,h.bind(this)),t.on(s.default.SCRIPTDATA_ARRIVED,p.bind(this)),t.on(s.default.STATISTICS_INFO,f.bind(this)),t.on(s.default.RECOMMEND_SEEKPOINT,_.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(i.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":var v=i.data.param;n.default.applyConfig(v),!0===v.enableCallback?n.default.addLogListener(r):n.default.removeLogListener(r)}}))}},"./src/demux/amf-parser.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/logger.js"),i=r("./src/utils/utf8-conv.js"),o=r("./src/utils/exception.js"),s=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}(),a=function(){function e(){}return e.parseScriptData=function(t,r,i){var o={};try{var s=e.parseValue(t,r,i),a=e.parseValue(t,r+s.size,i-s.size);o[s.data]=a.data}catch(c){n.default.e("AMF",c.toString())}return o},e.parseObject=function(t,r,n){if(n<3)throw new o.IllegalStateException("Data not enough when parse ScriptDataObject");var i=e.parseString(t,r,n),s=e.parseValue(t,r+i.size,n-i.size),a=s.objectEnd;return{data:{name:i.data,value:s.data},size:i.size+s.size,objectEnd:a}},e.parseVariable=function(t,r,n){return e.parseObject(t,r,n)},e.parseString=function(e,t,r){if(r<2)throw new o.IllegalStateException("Data not enough when parse String");var n=new DataView(e,t,r).getUint16(0,!s);return{data:n>0?(0,i.default)(new Uint8Array(e,t+2,n)):"",size:2+n}},e.parseLongString=function(e,t,r){if(r<4)throw new o.IllegalStateException("Data not enough when parse LongString");var n=new DataView(e,t,r).getUint32(0,!s);return{data:n>0?(0,i.default)(new Uint8Array(e,t+4,n)):"",size:4+n}},e.parseDate=function(e,t,r){if(r<10)throw new o.IllegalStateException("Data size invalid when parse Date");var n=new DataView(e,t,r),i=n.getFloat64(0,!s),a=n.getInt16(8,!s);return{data:new Date(i+=60*a*1e3),size:10}},e.parseValue=function(t,r,i){if(i<1)throw new o.IllegalStateException("Data not enough when parse Value");var a,c=new DataView(t,r,i),u=1,l=c.getUint8(0),d=!1;try{switch(l){case 0:a=c.getFloat64(1,!s),u+=8;break;case 1:a=!!c.getUint8(1),u+=1;break;case 2:var h=e.parseString(t,r+1,i-1);a=h.data,u+=h.size;break;case 3:a={};var p=0;for(9===(16777215&c.getUint32(i-4,!s))&&(p=3);u<i-4;){var f=e.parseObject(t,r+u,i-u-p);if(f.objectEnd)break;a[f.data.name]=f.data.value,u+=f.size}u<=i-3&&9===(16777215&c.getUint32(u-1,!s))&&(u+=3);break;case 8:for(a={},u+=4,p=0,9===(16777215&c.getUint32(i-4,!s))&&(p=3);u<i-8;){var g=e.parseVariable(t,r+u,i-u-p);if(g.objectEnd)break;a[g.data.name]=g.data.value,u+=g.size}u<=i-3&&9===(16777215&c.getUint32(u-1,!s))&&(u+=3);break;case 9:a=void 0,u=1,d=!0;break;case 10:a=[];var m=c.getUint32(1,!s);u+=4;for(var _=0;_<m;_++){var v=e.parseValue(t,r+u,i-u);a.push(v.data),u+=v.size}break;case 11:var y=e.parseDate(t,r+1,i-1);a=y.data,u+=y.size;break;case 12:var E=e.parseString(t,r+1,i-1);a=E.data,u+=E.size;break;default:u=i,n.default.w("AMF","Unsupported AMF value type "+l)}}catch(S){n.default.e("AMF",S.toString())}return{data:a,size:u,objectEnd:d}},e}();t.default=a},"./src/demux/demux-errors.js":function(e,t,r){"use strict";r.r(t),t.default={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},"./src/demux/exp-golomb.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/exception.js"),i=function(){function e(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}return e.prototype.destroy=function(){this._buffer=null},e.prototype._fillCurrentWord=function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new n.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var t=Math.min(4,e),r=new Uint8Array(4);r.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(r.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t},e.prototype.readBits=function(e){if(e>32)throw new n.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var r=this._current_word_bits_left?this._current_word:0;r>>>=32-this._current_word_bits_left;var i=e-this._current_word_bits_left;this._fillCurrentWord();var o=Math.min(i,this._current_word_bits_left),s=this._current_word>>>32-o;return this._current_word<<=o,this._current_word_bits_left-=o,r=r<<o|s},e.prototype.readBool=function(){return 1===this.readBits(1)},e.prototype.readByte=function(){return this.readBits(8)},e.prototype._skipLeadingZero=function(){var e;for(e=0;e<this._current_word_bits_left;e++)if(0!==(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()},e.prototype.readUEG=function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1},e.prototype.readSEG=function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)},e}();t.default=i},"./src/demux/flv-demuxer.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/logger.js"),i=r("./src/demux/amf-parser.js"),o=r("./src/demux/sps-parser.js"),s=r("./src/demux/demux-errors.js"),a=r("./src/core/media-info.js"),c=r("./src/utils/exception.js"),u=function(){function e(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new a.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}return e.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},e.probe=function(e){var t=new Uint8Array(e),r={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return r;var n,i,o=(4&t[4])>>>2!==0,s=0!==(1&t[4]),a=(n=t)[i=5]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3];return a<9?r:{match:!0,consumed:a,dataOffset:a,hasAudioTrack:o,hasVideoTrack:s}},e.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(e.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(e){this._timestampBase=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedDuration",{get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasAudio",{set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasVideo",{set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e},enumerable:!1,configurable:!0}),e.prototype.resetMediaInfo=function(){this._mediaInfo=new a.default},e.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},e.prototype.parseChunks=function(t,r){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new c.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=0,o=this._littleEndian;if(0===r){if(!(t.byteLength>13))return 0;i=e.probe(t).dataOffset}for(this._firstParse&&(this._firstParse=!1,r+i!==this._dataOffset&&n.default.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==(s=new DataView(t,i)).getUint32(0,!o)&&n.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),i+=4);i<t.byteLength;){this._dispatch=!0;var s=new DataView(t,i);if(i+11+4>t.byteLength)break;var a=s.getUint8(0),u=16777215&s.getUint32(0,!o);if(i+11+u+4>t.byteLength)break;if(8===a||9===a||18===a){var l=s.getUint8(4),d=s.getUint8(5),h=s.getUint8(6)|d<<8|l<<16|s.getUint8(7)<<24;0!==(16777215&s.getUint32(7,!o))&&n.default.w(this.TAG,"Meet tag which has StreamID != 0!");var p=i+11;switch(a){case 8:this._parseAudioData(t,p,u,h);break;case 9:this._parseVideoData(t,p,u,h,r+i);break;case 18:this._parseScriptData(t,p,u)}var f=s.getUint32(11+u,!o);f!==11+u&&n.default.w(this.TAG,"Invalid PrevTagSize "+f),i+=11+u+4}else n.default.w(this.TAG,"Unsupported tag type "+a+", skipped"),i+=11+u+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),i},e.prototype._parseScriptData=function(e,t,r){var o=i.default.parseScriptData(e,t,r);if(o.hasOwnProperty("onMetaData")){if(null==o.onMetaData||"object"!==typeof o.onMetaData)return void n.default.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&n.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=o;var s=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},s)),"boolean"===typeof s.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=s.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"===typeof s.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=s.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"===typeof s.audiodatarate&&(this._mediaInfo.audioDataRate=s.audiodatarate),"number"===typeof s.videodatarate&&(this._mediaInfo.videoDataRate=s.videodatarate),"number"===typeof s.width&&(this._mediaInfo.width=s.width),"number"===typeof s.height&&(this._mediaInfo.height=s.height),"number"===typeof s.duration){if(!this._durationOverrided){var a=Math.floor(s.duration*this._timescale);this._duration=a,this._mediaInfo.duration=a}}else this._mediaInfo.duration=0;if("number"===typeof s.framerate){var c=Math.floor(1e3*s.framerate);if(c>0){var u=c/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=u,this._referenceFrameRate.fps_num=c,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=u}}if("object"===typeof s.keyframes){this._mediaInfo.hasKeyframesIndex=!0;var l=s.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(l),s.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=s,n.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(o).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},o))},e.prototype._parseKeyframesIndex=function(e){for(var t=[],r=[],n=1;n<e.times.length;n++){var i=this._timestampBase+Math.floor(1e3*e.times[n]);t.push(i),r.push(e.filepositions[n])}return{times:t,filepositions:r}},e.prototype._parseAudioData=function(e,t,r,i){if(r<=1)n.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){this._littleEndian;var o=new DataView(e,t,r).getUint8(0),a=o>>>4;if(2===a||10===a){var c=0,u=(12&o)>>>2;if(u>=0&&u<=4){c=this._flvSoundRateTable[u];var l=1&o,d=this._audioMetadata,h=this._audioTrack;if(d||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(d=this._audioMetadata={}).type="audio",d.id=h.id,d.timescale=this._timescale,d.duration=this._duration,d.audioSampleRate=c,d.channelCount=0===l?1:2),10===a){var p=this._parseAACAudioData(e,t+1,r-1);if(void 0==p)return;if(0===p.packetType){d.config&&n.default.w(this.TAG,"Found another AudioSpecificConfig!");var f=p.data;d.audioSampleRate=f.samplingRate,d.channelCount=f.channelCount,d.codec=f.codec,d.originalCodec=f.originalCodec,d.config=f.config,d.refSampleDuration=1024/d.audioSampleRate*d.timescale,n.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",d),(_=this._mediaInfo).audioCodec=d.originalCodec,_.audioSampleRate=d.audioSampleRate,_.audioChannelCount=d.channelCount,_.hasVideo?null!=_.videoCodec&&(_.mimeType='video/x-flv; codecs="'+_.videoCodec+","+_.audioCodec+'"'):_.mimeType='video/x-flv; codecs="'+_.audioCodec+'"',_.isComplete()&&this._onMediaInfo(_)}else if(1===p.packetType){var g=this._timestampBase+i,m={unit:p.data,length:p.data.byteLength,dts:g,pts:g};h.samples.push(m),h.length+=p.data.length}else n.default.e(this.TAG,"Flv: Unsupported AAC data type "+p.packetType)}else if(2===a){if(!d.codec){var _;if(void 0==(f=this._parseMP3AudioData(e,t+1,r-1,!0)))return;d.audioSampleRate=f.samplingRate,d.channelCount=f.channelCount,d.codec=f.codec,d.originalCodec=f.originalCodec,d.refSampleDuration=1152/d.audioSampleRate*d.timescale,n.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",d),(_=this._mediaInfo).audioCodec=d.codec,_.audioSampleRate=d.audioSampleRate,_.audioChannelCount=d.channelCount,_.audioDataRate=f.bitRate,_.hasVideo?null!=_.videoCodec&&(_.mimeType='video/x-flv; codecs="'+_.videoCodec+","+_.audioCodec+'"'):_.mimeType='video/x-flv; codecs="'+_.audioCodec+'"',_.isComplete()&&this._onMediaInfo(_)}var v=this._parseMP3AudioData(e,t+1,r-1,!1);if(void 0==v)return;g=this._timestampBase+i;var y={unit:v,length:v.byteLength,dts:g,pts:g};h.samples.push(y),h.length+=v.length}}else this._onError(s.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+u)}else this._onError(s.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+a)}},e.prototype._parseAACAudioData=function(e,t,r){if(!(r<=1)){var i={},o=new Uint8Array(e,t,r);return i.packetType=o[0],0===o[0]?i.data=this._parseAACAudioSpecificConfig(e,t+1,r-1):i.data=o.subarray(1),i}n.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},e.prototype._parseAACAudioSpecificConfig=function(e,t,r){var n,i,o=new Uint8Array(e,t,r),a=null,c=0,u=null;if(c=n=o[0]>>>3,(i=(7&o[0])<<1|o[1]>>>7)<0||i>=this._mpegSamplingRates.length)this._onError(s.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var l=this._mpegSamplingRates[i],d=(120&o[1])>>>3;if(!(d<0||d>=8)){5===c&&(u=(7&o[1])<<1|o[2]>>>7,o[2]);var h=self.navigator.userAgent.toLowerCase();return-1!==h.indexOf("firefox")?i>=6?(c=5,a=new Array(4),u=i-3):(c=2,a=new Array(2),u=i):-1!==h.indexOf("android")?(c=2,a=new Array(2),u=i):(c=5,u=i,a=new Array(4),i>=6?u=i-3:1===d&&(c=2,a=new Array(2),u=i)),a[0]=c<<3,a[0]|=(15&i)>>>1,a[1]=(15&i)<<7,a[1]|=(15&d)<<3,5===c&&(a[1]|=(15&u)>>>1,a[2]=(1&u)<<7,a[2]|=8,a[3]=0),{config:a,samplingRate:l,channelCount:d,codec:"mp4a.40."+c,originalCodec:"mp4a.40."+n}}this._onError(s.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},e.prototype._parseMP3AudioData=function(e,t,r,i){if(!(r<4)){this._littleEndian;var o=new Uint8Array(e,t,r),s=null;if(i){if(255!==o[0])return;var a=o[1]>>>3&3,c=(6&o[1])>>1,u=(240&o[2])>>>4,l=(12&o[2])>>>2,d=3!==(o[3]>>>6&3)?2:1,h=0,p=0;switch(a){case 0:h=this._mpegAudioV25SampleRateTable[l];break;case 2:h=this._mpegAudioV20SampleRateTable[l];break;case 3:h=this._mpegAudioV10SampleRateTable[l]}switch(c){case 1:u<this._mpegAudioL3BitRateTable.length&&(p=this._mpegAudioL3BitRateTable[u]);break;case 2:u<this._mpegAudioL2BitRateTable.length&&(p=this._mpegAudioL2BitRateTable[u]);break;case 3:u<this._mpegAudioL1BitRateTable.length&&(p=this._mpegAudioL1BitRateTable[u])}s={bitRate:p,samplingRate:h,channelCount:d,codec:"mp3",originalCodec:"mp3"}}else s=o;return s}n.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},e.prototype._parseVideoData=function(e,t,r,i,o){if(r<=1)n.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var a=new Uint8Array(e,t,r)[0],c=(240&a)>>>4,u=15&a;7===u?this._parseAVCVideoPacket(e,t+1,r-1,i,o,c):this._onError(s.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+u)}},e.prototype._parseAVCVideoPacket=function(e,t,r,i,o,a){if(r<4)n.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var c=this._littleEndian,u=new DataView(e,t,r),l=u.getUint8(0),d=(16777215&u.getUint32(0,!c))<<8>>8;if(0===l)this._parseAVCDecoderConfigurationRecord(e,t+4,r-4);else if(1===l)this._parseAVCVideoData(e,t+4,r-4,i,o,a,d);else if(2!==l)return void this._onError(s.default.FORMAT_ERROR,"Flv: Invalid video packet type "+l)}},e.prototype._parseAVCDecoderConfigurationRecord=function(e,t,r){if(r<7)n.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var i=this._videoMetadata,a=this._videoTrack,c=this._littleEndian,u=new DataView(e,t,r);i?"undefined"!==typeof i.avcc&&n.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(i=this._videoMetadata={}).type="video",i.id=a.id,i.timescale=this._timescale,i.duration=this._duration);var l=u.getUint8(0),d=u.getUint8(1);if(u.getUint8(2),u.getUint8(3),1===l&&0!==d)if(this._naluLengthSize=1+(3&u.getUint8(4)),3===this._naluLengthSize||4===this._naluLengthSize){var h=31&u.getUint8(5);if(0!==h){h>1&&n.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+h);for(var p=6,f=0;f<h;f++){var g=u.getUint16(p,!c);if(p+=2,0!==g){var m=new Uint8Array(e,t+p,g);p+=g;var _=o.default.parseSPS(m);if(0===f){i.codecWidth=_.codec_size.width,i.codecHeight=_.codec_size.height,i.presentWidth=_.present_size.width,i.presentHeight=_.present_size.height,i.profile=_.profile_string,i.level=_.level_string,i.bitDepth=_.bit_depth,i.chromaFormat=_.chroma_format,i.sarRatio=_.sar_ratio,i.frameRate=_.frame_rate,!1!==_.frame_rate.fixed&&0!==_.frame_rate.fps_num&&0!==_.frame_rate.fps_den||(i.frameRate=this._referenceFrameRate);var v=i.frameRate.fps_den,y=i.frameRate.fps_num;i.refSampleDuration=i.timescale*(v/y);for(var E=m.subarray(1,4),S="avc1.",b=0;b<3;b++){var T=E[b].toString(16);T.length<2&&(T="0"+T),S+=T}i.codec=S;var C=this._mediaInfo;C.width=i.codecWidth,C.height=i.codecHeight,C.fps=i.frameRate.fps,C.profile=i.profile,C.level=i.level,C.refFrames=_.ref_frames,C.chromaFormat=_.chroma_format_string,C.sarNum=i.sarRatio.width,C.sarDen=i.sarRatio.height,C.videoCodec=S,C.hasAudio?null!=C.audioCodec&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.videoCodec+'"',C.isComplete()&&this._onMediaInfo(C)}}}var R=u.getUint8(p);if(0!==R){for(R>1&&n.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+R),p++,f=0;f<R;f++)g=u.getUint16(p,!c),p+=2,0!==g&&(p+=g);i.avcc=new Uint8Array(r),i.avcc.set(new Uint8Array(e,t,r),0),n.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",i)}else this._onError(s.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(s.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(s.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(s.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},e.prototype._parseAVCVideoData=function(e,t,r,i,o,s,a){for(var c=this._littleEndian,u=new DataView(e,t,r),l=[],d=0,h=0,p=this._naluLengthSize,f=this._timestampBase+i,g=1===s;h<r;){if(h+4>=r){n.default.w(this.TAG,"Malformed Nalu near timestamp "+f+", offset = "+h+", dataSize = "+r);break}var m=u.getUint32(h,!c);if(3===p&&(m>>>=8),m>r-p)return void n.default.w(this.TAG,"Malformed Nalus near timestamp "+f+", NaluSize > DataSize!");var _=31&u.getUint8(h+p);5===_&&(g=!0);var v=new Uint8Array(e,t+h,p+m),y={type:_,data:v};l.push(y),d+=v.byteLength,h+=p+m}if(l.length){var E=this._videoTrack,S={units:l,length:d,isKeyframe:g,dts:f,cts:a,pts:f+a};g&&(S.fileposition=o),E.samples.push(S),E.length+=d}},e}();t.default=u},"./src/demux/sps-parser.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/demux/exp-golomb.js"),i=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,r=t.byteLength,n=new Uint8Array(r),i=0,o=0;o<r;o++)o>=2&&3===t[o]&&0===t[o-1]&&0===t[o-2]||(n[i]=t[o],i++);return new Uint8Array(n.buffer,0,i)},e.parseSPS=function(t){var r=e._ebsp2rbsp(t),i=new n.default(r);i.readByte();var o=i.readByte();i.readByte();var s=i.readByte();i.readUEG();var a=e.getProfileString(o),c=e.getLevelString(s),u=1,l=420,d=8;if((100===o||110===o||122===o||244===o||44===o||83===o||86===o||118===o||128===o||138===o||144===o)&&(3===(u=i.readUEG())&&i.readBits(1),u<=3&&(l=[0,420,422,444][u]),d=i.readUEG()+8,i.readUEG(),i.readBits(1),i.readBool()))for(var h=3!==u?8:12,p=0;p<h;p++)i.readBool()&&(p<6?e._skipScalingList(i,16):e._skipScalingList(i,64));i.readUEG();var f=i.readUEG();if(0===f)i.readUEG();else if(1===f){i.readBits(1),i.readSEG(),i.readSEG();var g=i.readUEG();for(p=0;p<g;p++)i.readSEG()}var m=i.readUEG();i.readBits(1);var _=i.readUEG(),v=i.readUEG(),y=i.readBits(1);0===y&&i.readBits(1),i.readBits(1);var E=0,S=0,b=0,T=0;i.readBool()&&(E=i.readUEG(),S=i.readUEG(),b=i.readUEG(),T=i.readUEG());var C=1,R=1,O=0,k=!0,I=0,L=0;if(i.readBool()){if(i.readBool()){var w=i.readByte();w>0&&w<16?(C=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][w-1],R=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][w-1]):255===w&&(C=i.readByte()<<8|i.readByte(),R=i.readByte()<<8|i.readByte())}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(4),i.readBool()&&i.readBits(24)),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool()){var A=i.readBits(32),N=i.readBits(32);k=i.readBool(),O=(I=N)/(L=2*A)}}var P=1;1===C&&1===R||(P=C/R);var M=0,D=0;0===u?(M=1,D=2-y):(M=3===u?1:2,D=(1===u?2:1)*(2-y));var U=16*(_+1),x=16*(v+1)*(2-y);U-=(E+S)*M,x-=(b+T)*D;var B=Math.ceil(U*P);return i.destroy(),i=null,{profile_string:a,level_string:c,bit_depth:d,ref_frames:m,chroma_format:l,chroma_format_string:e.getChromaFormatString(l),frame_rate:{fixed:k,fps:O,fps_den:L,fps_num:I},sar_ratio:{width:C,height:R},codec_size:{width:U,height:x},present_size:{width:B,height:x}}},e._skipScalingList=function(e,t){for(var r=8,n=8,i=0;i<t;i++)0!==n&&(n=(r+e.readSEG()+256)%256),r=0===n?r:n},e.getProfileString=function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},e.getLevelString=function(e){return(e/10).toFixed(1)},e.getChromaFormatString=function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},e}();t.default=i},"./src/flv.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/polyfill.js"),i=r("./src/core/features.js"),o=r("./src/io/loader.js"),s=r("./src/player/flv-player.js"),a=r("./src/player/native-player.js"),c=r("./src/player/player-events.js"),u=r("./src/player/player-errors.js"),l=r("./src/utils/logging-control.js"),d=r("./src/utils/exception.js");n.default.install();var h={createPlayer:function(e,t){var r=e;if(null==r||"object"!==typeof r)throw new d.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!r.hasOwnProperty("type"))throw new d.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");return"flv"===r.type?new s.default(r,t):new a.default(r,t)},isSupported:function(){return i.default.supportMSEH264Playback()},getFeatureList:function(){return i.default.getFeatureList()}};h.BaseLoader=o.BaseLoader,h.LoaderStatus=o.LoaderStatus,h.LoaderErrors=o.LoaderErrors,h.Events=c.default,h.ErrorTypes=u.ErrorTypes,h.ErrorDetails=u.ErrorDetails,h.FlvPlayer=s.default,h.NativePlayer=a.default,h.LoggingControl=l.default,Object.defineProperty(h,"version",{enumerable:!0,get:function(){return"1.6.2"}}),t.default=h},"./src/index.js":function(e,t,r){e.exports=r("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/browser.js"),i=r("./src/io/loader.js"),o=r("./src/utils/exception.js"),s=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),a=function(e){function t(t,r){var n=e.call(this,"fetch-stream-loader")||this;return n.TAG="FetchStreamLoader",n._seekHandler=t,n._config=r,n._needStash=!0,n._requestAbort=!1,n._contentLength=null,n._receivedLength=0,n}return s(t,e),t.isSupported=function(){try{var e=n.default.msedge&&n.default.version.minor>=15048,t=!n.default.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(r){return!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){var r=this;this._dataSource=e,this._range=t;var n=e.url;this._config.reuseRedirectedURL&&void 0!=e.redirectedURL&&(n=e.redirectedURL);var s=this._seekHandler.getConfig(n,t),a=new self.Headers;if("object"===typeof s.headers){var c=s.headers;for(var u in c)c.hasOwnProperty(u)&&a.append(u,c[u])}var l={method:"GET",headers:a,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"===typeof this._config.headers)for(var u in this._config.headers)a.append(u,this._config.headers[u]);!1===e.cors&&(l.mode="same-origin"),e.withCredentials&&(l.credentials="include"),e.referrerPolicy&&(l.referrerPolicy=e.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,l.signal=this._abortController.signal),this._status=i.LoaderStatus.kConnecting,self.fetch(s.url,l).then((function(e){if(r._requestAbort)return r._status=i.LoaderStatus.kIdle,void e.body.cancel();if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==s.url&&r._onURLRedirect){var t=r._seekHandler.removeURLParameters(e.url);r._onURLRedirect(t)}var n=e.headers.get("Content-Length");return null!=n&&(r._contentLength=parseInt(n),0!==r._contentLength&&r._onContentLengthKnown&&r._onContentLengthKnown(r._contentLength)),r._pump.call(r,e.body.getReader())}if(r._status=i.LoaderStatus.kError,!r._onError)throw new o.RuntimeException("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);r._onError(i.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})})).catch((function(e){if(!r._abortController||!r._abortController.signal.aborted){if(r._status=i.LoaderStatus.kError,!r._onError)throw e;r._onError(i.LoaderErrors.EXCEPTION,{code:-1,msg:e.message})}}))},t.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==i.LoaderStatus.kBuffering||!n.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(e){}},t.prototype._pump=function(e){var t=this;return e.read().then((function(r){if(r.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=i.LoaderStatus.kError;var n=i.LoaderErrors.EARLY_EOF,s={code:-1,msg:"Fetch stream meet Early-EOF"};if(!t._onError)throw new o.RuntimeException(s.msg);t._onError(n,s)}else t._status=i.LoaderStatus.kComplete,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(t._abortController&&t._abortController.signal.aborted)return void(t._status=i.LoaderStatus.kComplete);if(!0===t._requestAbort)return t._status=i.LoaderStatus.kComplete,e.cancel();t._status=i.LoaderStatus.kBuffering;var a=r.value.buffer,c=t._range.from+t._receivedLength;t._receivedLength+=a.byteLength,t._onDataArrival&&t._onDataArrival(a,c,t._receivedLength),t._pump(e)}})).catch((function(e){if(t._abortController&&t._abortController.signal.aborted)t._status=i.LoaderStatus.kComplete;else if(11!==e.code||!n.default.msedge){t._status=i.LoaderStatus.kError;var r=0,s=null;if(19!==e.code&&"network error"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(r=i.LoaderErrors.EXCEPTION,s={code:e.code,msg:e.message}):(r=i.LoaderErrors.EARLY_EOF,s={code:e.code,msg:"Fetch stream meet Early-EOF"}),!t._onError)throw new o.RuntimeException(s.msg);t._onError(r,s)}}))},t}(i.BaseLoader);t.default=a},"./src/io/io-controller.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/logger.js"),i=r("./src/io/speed-sampler.js"),o=r("./src/io/loader.js"),s=r("./src/io/fetch-stream-loader.js"),a=r("./src/io/xhr-moz-chunked-loader.js"),c=r("./src/io/xhr-range-loader.js"),u=r("./src/io/websocket-loader.js"),l=r("./src/io/range-seek-handler.js"),d=r("./src/io/param-seek-handler.js"),h=r("./src/utils/exception.js"),p=function(){function e(e,t,r){this.TAG="IOController",this._config=t,this._extraData=r,this._stashInitialSize=393216,void 0!=t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new i.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return e.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},e.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},e.prototype.isPaused=function(){return this._paused},Object.defineProperty(e.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRedirect",{get:function(){return null!=this._redirectedURL||void 0!=this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSpeed",{get:function(){return this._loaderClass===c.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),e.prototype._selectSeekHandler=function(){var e=this._config;if("range"===e.seekType)this._seekHandler=new l.default(this._config.rangeLoadZeroStart);else if("param"===e.seekType){var t=e.seekParamStart||"bstart",r=e.seekParamEnd||"bend";this._seekHandler=new d.default(t,r)}else{if("custom"!==e.seekType)throw new h.InvalidArgumentException("Invalid seekType in config: "+e.seekType);if("function"!==typeof e.customSeekHandler)throw new h.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}},e.prototype._selectLoader=function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=u.default;else if(s.default.isSupported())this._loaderClass=s.default;else if(a.default.isSupported())this._loaderClass=a.default;else{if(!c.default.isSupported())throw new h.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=c.default}},e.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},e.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},e.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},e.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},e.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},e.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},e.prototype._internalSeek=function(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;var r={from:e,to:-1};this._currentRange={from:r.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,r),this._onSeeked&&this._onSeeked()},e.prototype.updateUrl=function(e){if(!e||"string"!==typeof e||0===e.length)throw new h.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=e},e.prototype._expandBuffer=function(e){for(var t=this._stashSize;t+1048576<e;)t*=2;if((t+=1048576)!==this._bufferSize){var r=new ArrayBuffer(t);if(this._stashUsed>0){var n=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(r,0,t).set(n,0)}this._stashBuffer=r,this._bufferSize=t}},e.prototype._normalizeSpeed=function(e){var t=this._speedNormalizeList,r=t.length-1,n=0,i=0,o=r;if(e<t[0])return t[0];for(;i<=o;){if((n=i+Math.floor((o-i)/2))===r||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:o=n-1}},e.prototype._adjustStashSize=function(e){var t=0;(t=this._config.isLive||e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e)>8192&&(t=8192);var r=1024*t+1048576;this._bufferSize<r&&this._expandBuffer(r),this._stashSize=1024*t},e.prototype._dispatchChunks=function(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)},e.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},e.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},e.prototype._onLoaderChunkArrival=function(e,t,r){if(!this._onDataArrival)throw new h.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var n=this._speedSampler.lastSecondKBps;if(0!==n){var i=this._normalizeSpeed(n);this._speedNormalized!==i&&(this._speedNormalized=i,this._adjustStashSize(i))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize)(a=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;else if(a=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var o=this._stashBuffer.slice(0,this._stashUsed);(c=this._dispatchChunks(o,this._stashByteStart))<o.byteLength?c>0&&(u=new Uint8Array(o,c),a.set(u,0),this._stashUsed=u.byteLength,this._stashByteStart+=c):(this._stashUsed=0,this._stashByteStart+=c),this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),a=new Uint8Array(this._stashBuffer,0,this._bufferSize)),a.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else(c=this._dispatchChunks(e,t))<e.byteLength&&((s=e.byteLength-c)>this._bufferSize&&(this._expandBuffer(s),a=new Uint8Array(this._stashBuffer,0,this._bufferSize)),a.set(new Uint8Array(e,c),0),this._stashUsed+=s,this._stashByteStart=t+c);else if(0===this._stashUsed){var s;(c=this._dispatchChunks(e,t))<e.byteLength&&((s=e.byteLength-c)>this._bufferSize&&this._expandBuffer(s),(a=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e,c),0),this._stashUsed+=s,this._stashByteStart=t+c)}else{var a,c;if(this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength),(a=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength,(c=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&c>0){var u=new Uint8Array(this._stashBuffer,c);a.set(u,0)}this._stashUsed-=c,this._stashByteStart+=c}}},e.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var t=this._stashBuffer.slice(0,this._stashUsed),r=this._dispatchChunks(t,this._stashByteStart),i=t.byteLength-r;if(r<t.byteLength){if(!e){if(r>0){var o=new Uint8Array(this._stashBuffer,0,this._bufferSize),s=new Uint8Array(t,r);o.set(s,0),this._stashUsed=s.byteLength,this._stashByteStart+=r}return 0}n.default.w(this.TAG,i+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,i}return 0},e.prototype._onLoaderComplete=function(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},e.prototype._onLoaderError=function(e,t){switch(n.default.e(this.TAG,"Loader error, code = "+t.code+", msg = "+t.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=o.LoaderErrors.UNRECOVERABLE_EARLY_EOF),e){case o.LoaderErrors.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var r=this._currentRange.to+1;return void(r<this._totalLength&&(n.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(r,!1)))}e=o.LoaderErrors.UNRECOVERABLE_EARLY_EOF;case o.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case o.LoaderErrors.CONNECTING_TIMEOUT:case o.LoaderErrors.HTTP_STATUS_CODE_INVALID:case o.LoaderErrors.EXCEPTION:}if(!this._onError)throw new h.RuntimeException("IOException: "+t.msg);this._onError(e,t)},e}();t.default=p},"./src/io/loader.js":function(e,t,r){"use strict";r.r(t),r.d(t,{LoaderStatus:function(){return i},LoaderErrors:function(){return o},BaseLoader:function(){return s}});var n=r("./src/utils/exception.js"),i={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},o={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},s=function(){function e(e){this._type=e||"undefined",this._status=i.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return e.prototype.destroy=function(){this._status=i.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},e.prototype.isWorking=function(){return this._status===i.kConnecting||this._status===i.kBuffering},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),e.prototype.open=function(e,t){throw new n.NotImplementedException("Unimplemented abstract function!")},e.prototype.abort=function(){throw new n.NotImplementedException("Unimplemented abstract function!")},e}()},"./src/io/param-seek-handler.js":function(e,t,r){"use strict";r.r(t);var n=function(){function e(e,t){this._startName=e,this._endName=t}return e.prototype.getConfig=function(e,t){var r=e;if(0!==t.from||-1!==t.to){var n=!0;-1===r.indexOf("?")&&(r+="?",n=!1),n&&(r+="&"),r+=this._startName+"="+t.from.toString(),-1!==t.to&&(r+="&"+this._endName+"="+t.to.toString())}return{url:r,headers:{}}},e.prototype.removeURLParameters=function(e){var t=e.split("?")[0],r=void 0,n=e.indexOf("?");-1!==n&&(r=e.substring(n+1));var i="";if(void 0!=r&&r.length>0)for(var o=r.split("&"),s=0;s<o.length;s++){var a=o[s].split("="),c=s>0;a[0]!==this._startName&&a[0]!==this._endName&&(c&&(i+="&"),i+=o[s])}return 0===i.length?t:t+"?"+i},e}();t.default=n},"./src/io/range-seek-handler.js":function(e,t,r){"use strict";r.r(t);var n=function(){function e(e){this._zeroStart=e||!1}return e.prototype.getConfig=function(e,t){var r={};if(0!==t.from||-1!==t.to){var n=void 0;n=-1!==t.to?"bytes="+t.from.toString()+"-"+t.to.toString():"bytes="+t.from.toString()+"-",r.Range=n}else this._zeroStart&&(r.Range="bytes=0-");return{url:e,headers:r}},e.prototype.removeURLParameters=function(e){return e},e}();t.default=n},"./src/io/speed-sampler.js":function(e,t,r){"use strict";r.r(t);var n=function(){function e(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return e.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},e.prototype.addBytes=function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())},Object.defineProperty(e.prototype,"currentKBps",{get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageKBps",{get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024},enumerable:!1,configurable:!0}),e}();t.default=n},"./src/io/websocket-loader.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/io/loader.js"),i=r("./src/utils/exception.js"),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(e){function t(){var t=e.call(this,"websocket-loader")||this;return t.TAG="WebSocketLoader",t._needStash=!0,t._ws=null,t._requestAbort=!1,t._receivedLength=0,t}return o(t,e),t.isSupported=function(){try{return"undefined"!==typeof self.WebSocket}catch(e){return!1}},t.prototype.destroy=function(){this._ws&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e){try{var t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=n.LoaderStatus.kConnecting}catch(o){this._status=n.LoaderStatus.kError;var r={code:o.code,msg:o.message};if(!this._onError)throw new i.RuntimeException(r.msg);this._onError(n.LoaderErrors.EXCEPTION,r)}},t.prototype.abort=function(){var e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=n.LoaderStatus.kComplete},t.prototype._onWebSocketOpen=function(e){this._status=n.LoaderStatus.kBuffering},t.prototype._onWebSocketClose=function(e){!0!==this._requestAbort?(this._status=n.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},t.prototype._onWebSocketMessage=function(e){var t=this;if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){var r=new FileReader;r.onload=function(){t._dispatchArrayBuffer(r.result)},r.readAsArrayBuffer(e.data)}else{this._status=n.LoaderStatus.kError;var o={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new i.RuntimeException(o.msg);this._onError(n.LoaderErrors.EXCEPTION,o)}},t.prototype._dispatchArrayBuffer=function(e){var t=e,r=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength)},t.prototype._onWebSocketError=function(e){this._status=n.LoaderStatus.kError;var t={code:e.code,msg:e.message};if(!this._onError)throw new i.RuntimeException(t.msg);this._onError(n.LoaderErrors.EXCEPTION,t)},t}(n.BaseLoader);t.default=s},"./src/io/xhr-moz-chunked-loader.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/logger.js"),i=r("./src/io/loader.js"),o=r("./src/utils/exception.js"),s=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),a=function(e){function t(t,r){var n=e.call(this,"xhr-moz-chunked-loader")||this;return n.TAG="MozChunkedLoader",n._seekHandler=t,n._config=r,n._needStash=!0,n._xhr=null,n._requestAbort=!1,n._contentLength=null,n._receivedLength=0,n}return s(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(t){return n.default.w("MozChunkedLoader",t.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){this._dataSource=e,this._range=t;var r=e.url;this._config.reuseRedirectedURL&&void 0!=e.redirectedURL&&(r=e.redirectedURL);var n=this._seekHandler.getConfig(r,t);this._requestURL=n.url;var o=this._xhr=new XMLHttpRequest;if(o.open("GET",n.url,!0),o.responseType="moz-chunked-arraybuffer",o.onreadystatechange=this._onReadyStateChange.bind(this),o.onprogress=this._onProgress.bind(this),o.onloadend=this._onLoadEnd.bind(this),o.onerror=this._onXhrError.bind(this),e.withCredentials&&(o.withCredentials=!0),"object"===typeof n.headers){var s=n.headers;for(var a in s)s.hasOwnProperty(a)&&o.setRequestHeader(a,s[a])}if("object"===typeof this._config.headers)for(var a in s=this._config.headers)s.hasOwnProperty(a)&&o.setRequestHeader(a,s[a]);this._status=i.LoaderStatus.kConnecting,o.send()},t.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=i.LoaderStatus.kComplete},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(void 0!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){var r=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(r)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=i.LoaderStatus.kError,!this._onError)throw new o.RuntimeException("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(i.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=i.LoaderStatus.kBuffering}},t.prototype._onProgress=function(e){if(this._status!==i.LoaderStatus.kError){null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var t=e.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength)}},t.prototype._onLoadEnd=function(e){!0!==this._requestAbort?this._status!==i.LoaderStatus.kError&&(this._status=i.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},t.prototype._onXhrError=function(e){this._status=i.LoaderStatus.kError;var t=0,r=null;if(this._contentLength&&e.loaded<this._contentLength?(t=i.LoaderErrors.EARLY_EOF,r={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=i.LoaderErrors.EXCEPTION,r={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new o.RuntimeException(r.msg);this._onError(t,r)},t}(i.BaseLoader);t.default=a},"./src/io/xhr-range-loader.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/logger.js"),i=r("./src/io/speed-sampler.js"),o=r("./src/io/loader.js"),s=r("./src/utils/exception.js"),a=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=function(e){function t(t,r){var n=e.call(this,"xhr-range-loader")||this;return n.TAG="RangeLoader",n._seekHandler=t,n._config=r,n._needStash=!1,n._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],n._currentChunkSizeKB=384,n._currentSpeedNormalized=0,n._zeroSpeedChunkCount=0,n._xhr=null,n._speedSampler=new i.default,n._requestAbort=!1,n._waitForTotalLength=!1,n._totalLengthReceived=!1,n._currentRequestURL=null,n._currentRedirectedURL=null,n._currentRequestRange=null,n._totalLength=null,n._contentLength=null,n._receivedLength=0,n._lastTimeLoaded=0,n}return a(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(t){return n.default.w("RangeLoader",t.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},Object.defineProperty(t.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),t.prototype.open=function(e,t){this._dataSource=e,this._range=t,this._status=o.LoaderStatus.kConnecting;var r=!1;void 0!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(r=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||r?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},t.prototype._openSubRange=function(){var e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,r=t+e;null!=this._contentLength&&r-this._range.from>=this._contentLength&&(r=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:r},this._internalOpen(this._dataSource,this._currentRequestRange)},t.prototype._internalOpen=function(e,t){this._lastTimeLoaded=0;var r=e.url;this._config.reuseRedirectedURL&&(void 0!=this._currentRedirectedURL?r=this._currentRedirectedURL:void 0!=e.redirectedURL&&(r=e.redirectedURL));var n=this._seekHandler.getConfig(r,t);this._currentRequestURL=n.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onload=this._onLoad.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),"object"===typeof n.headers){var o=n.headers;for(var s in o)o.hasOwnProperty(s)&&i.setRequestHeader(s,o[s])}if("object"===typeof this._config.headers)for(var s in o=this._config.headers)o.hasOwnProperty(s)&&i.setRequestHeader(s,o[s]);i.send()},t.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=o.LoaderStatus.kComplete},t.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(void 0!=t.responseURL){var r=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&r!==this._currentRedirectedURL&&(this._currentRedirectedURL=r,this._onURLRedirect&&this._onURLRedirect(r))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=o.LoaderStatus.kBuffering}else{if(this._status=o.LoaderStatus.kError,!this._onError)throw new s.RuntimeException("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}},t.prototype._onProgress=function(e){if(this._status!==o.LoaderStatus.kError){if(null===this._contentLength){var t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;var r=e.total;this._internalAbort(),null!=r&0!==r&&(this._totalLength=r)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var n=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(n)}},t.prototype._normalizeSpeed=function(e){var t=this._chunkSizeKBList,r=t.length-1,n=0,i=0,o=r;if(e<t[0])return t[0];for(;i<=o;){if((n=i+Math.floor((o-i)/2))===r||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:o=n-1}},t.prototype._onLoad=function(e){if(this._status!==o.LoaderStatus.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){var r=this._normalizeSpeed(t);this._currentSpeedNormalized!==r&&(this._currentSpeedNormalized=r,this._currentChunkSizeKB=r)}var n=e.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=n.byteLength;var s=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():s=!0,this._onDataArrival&&this._onDataArrival(n,i,this._receivedLength),s&&(this._status=o.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},t.prototype._onXhrError=function(e){this._status=o.LoaderStatus.kError;var t=0,r=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=o.LoaderErrors.EARLY_EOF,r={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=o.LoaderErrors.EXCEPTION,r={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new s.RuntimeException(r.msg);this._onError(t,r)},t}(o.BaseLoader);t.default=c},"./src/player/flv-player.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/events/events.js"),i=r.n(n),o=r("./src/utils/logger.js"),s=r("./src/utils/browser.js"),a=r("./src/player/player-events.js"),c=r("./src/core/transmuxer.js"),u=r("./src/core/transmuxing-events.js"),l=r("./src/core/mse-controller.js"),d=r("./src/core/mse-events.js"),h=r("./src/player/player-errors.js"),p=r("./src/config.js"),f=r("./src/utils/exception.js"),g=function(){function e(e,t){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(i()),this._config=(0,p.createDefaultConfig)(),"object"===typeof t&&Object.assign(this._config,t),"flv"!==e.type.toLowerCase())throw new f.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");!0===e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var r=s.default.chrome&&(s.default.version.major<50||50===s.default.version.major&&s.default.version.build<2661);this._alwaysSeekKeyframe=!!(r||s.default.msedge||s.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return e.prototype.destroy=function(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var r=this;e===a.default.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then((function(){r._emitter.emit(a.default.MEDIA_INFO,r.mediaInfo)})):e===a.default.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then((function(){r._emitter.emit(a.default.STATISTICS_INFO,r.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){var t=this;if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new l.default(this._config),this._msectl.on(d.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(d.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(d.default.SOURCE_OPEN,(function(){t._mseSourceOpened=!0,t._hasPendingLoad&&(t._hasPendingLoad=!1,t.load())})),this._msectl.on(d.default.ERROR,(function(e){t._emitter.emit(a.default.ERROR,h.ErrorTypes.MEDIA_ERROR,h.ErrorDetails.MEDIA_MSE_ERROR,e)})),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(r){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},e.prototype.load=function(){var e=this;if(!this._mediaElement)throw new f.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new f.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new c.default(this._mediaDataSource,this._config),this._transmuxer.on(u.default.INIT_SEGMENT,(function(t,r){e._msectl.appendInitSegment(r)})),this._transmuxer.on(u.default.MEDIA_SEGMENT,(function(t,r){if(e._msectl.appendMediaSegment(r),e._config.lazyLoad&&!e._config.isLive){var n=e._mediaElement.currentTime;r.info.endDts>=1e3*(n+e._config.lazyLoadMaxDuration)&&null==e._progressChecker&&(o.default.v(e.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),e._suspendTransmuxer())}})),this._transmuxer.on(u.default.LOADING_COMPLETE,(function(){e._msectl.endOfStream(),e._emitter.emit(a.default.LOADING_COMPLETE)})),this._transmuxer.on(u.default.RECOVERED_EARLY_EOF,(function(){e._emitter.emit(a.default.RECOVERED_EARLY_EOF)})),this._transmuxer.on(u.default.IO_ERROR,(function(t,r){e._emitter.emit(a.default.ERROR,h.ErrorTypes.NETWORK_ERROR,t,r)})),this._transmuxer.on(u.default.DEMUX_ERROR,(function(t,r){e._emitter.emit(a.default.ERROR,h.ErrorTypes.MEDIA_ERROR,t,{code:-1,msg:r})})),this._transmuxer.on(u.default.MEDIA_INFO,(function(t){e._mediaInfo=t,e._emitter.emit(a.default.MEDIA_INFO,Object.assign({},t))})),this._transmuxer.on(u.default.METADATA_ARRIVED,(function(t){e._emitter.emit(a.default.METADATA_ARRIVED,t)})),this._transmuxer.on(u.default.SCRIPTDATA_ARRIVED,(function(t){e._emitter.emit(a.default.SCRIPTDATA_ARRIVED,t)})),this._transmuxer.on(u.default.STATISTICS_INFO,(function(t){e._statisticsInfo=e._fillStatisticsInfo(t),e._emitter.emit(a.default.STATISTICS_INFO,Object.assign({},e._statisticsInfo))})),this._transmuxer.on(u.default.RECOMMEND_SEEKPOINT,(function(t){e._mediaElement&&!e._config.accurateSeek&&(e._requestSetTime=!0,e._mediaElement.currentTime=t/1e3)})),this._transmuxer.open()))},e.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),e.prototype._fillStatisticsInfo=function(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,r=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();r=i.totalVideoFrames,n=i.droppedVideoFrames}else void 0!=this._mediaElement.webkitDecodedFrameCount?(r=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=r,e.droppedFrames=n),e},e.prototype._onmseUpdateEnd=function(){if(this._config.lazyLoad&&!this._config.isLive){for(var e=this._mediaElement.buffered,t=this._mediaElement.currentTime,r=0,n=0;n<e.length;n++){var i=e.start(n),s=e.end(n);if(i<=t&&t<s){r=s;break}}r>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(o.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},e.prototype._onmseBufferFull=function(){o.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()},e.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},e.prototype._checkProgressAndResume=function(){for(var e=this._mediaElement.currentTime,t=this._mediaElement.buffered,r=!1,n=0;n<t.length;n++){var i=t.start(n),s=t.end(n);if(e>=i&&e<s){e>=s-this._config.lazyLoadRecoverDuration&&(r=!0);break}}r&&(window.clearInterval(this._progressChecker),this._progressChecker=null,r&&(o.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},e.prototype._isTimepointBuffered=function(e){for(var t=this._mediaElement.buffered,r=0;r<t.length;r++){var n=t.start(r),i=t.end(r);if(e>=n&&e<i)return!0}return!1},e.prototype._internalSeek=function(e){var t=this._isTimepointBuffered(e),r=!1,n=0;if(e<1&&this._mediaElement.buffered.length>0){var i=this._mediaElement.buffered.start(0);(i<1&&e<i||s.default.safari)&&(r=!0,n=s.default.safari?.1:i)}if(r)this._requestSetTime=!0,this._mediaElement.currentTime=n;else if(t){if(this._alwaysSeekKeyframe){var o=this._msectl.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement.currentTime=null!=o?o.dts/1e3:e}else this._requestSetTime=!0,this._mediaElement.currentTime=e;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e)},e.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var e=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},e.prototype._checkAndResumeStuckPlayback=function(e){var t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){var r=t.buffered;r.length>0&&t.currentTime<r.start(0)&&(o.default.w(this.TAG,"Playback seems stuck at "+t.currentTime+", seek to "+r.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=r.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},e.prototype._onvSeeking=function(e){var t=this._mediaElement.currentTime,r=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&r.length>0){var n=r.start(0);if(n<1&&t<n||s.default.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=s.default.safari?.1:n)}if(this._isTimepointBuffered(t)){if(this._alwaysSeekKeyframe){var i=this._msectl.getNearestKeyframe(Math.floor(1e3*t));null!=i&&(this._requestSetTime=!0,this._mediaElement.currentTime=i.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},e.prototype._onvCanPlay=function(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},e.prototype._onvStalled=function(e){this._checkAndResumeStuckPlayback(!0)},e.prototype._onvProgress=function(e){this._checkAndResumeStuckPlayback()},e}();t.default=g},"./src/player/native-player.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/events/events.js"),i=r.n(n),o=r("./src/player/player-events.js"),s=r("./src/config.js"),a=r("./src/utils/exception.js"),c=function(){function e(e,t){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(i()),this._config=(0,s.createDefaultConfig)(),"object"===typeof t&&Object.assign(this._config,t),"flv"===e.type.toLowerCase())throw new a.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new a.InvalidArgumentException("NativePlayer("+e.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}return e.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var r=this;e===o.default.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){r._emitter.emit(o.default.MEDIA_INFO,r.mediaInfo)})):e===o.default.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){r._emitter.emit(o.default.STATISTICS_INFO,r.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(t){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.load=function(){if(!this._mediaElement)throw new a.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},e.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,r=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();r=i.totalVideoFrames,n=i.droppedVideoFrames}else void 0!=this._mediaElement.webkitDecodedFrameCount?(r=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=r,e.droppedFrames=n),e},enumerable:!1,configurable:!0}),e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(o.default.MEDIA_INFO,this.mediaInfo)},e.prototype._reportStatisticsInfo=function(){this._emitter.emit(o.default.STATISTICS_INFO,this.statisticsInfo)},e}();t.default=c},"./src/player/player-errors.js":function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorTypes:function(){return o},ErrorDetails:function(){return s}});var n=r("./src/io/loader.js"),i=r("./src/demux/demux-errors.js"),o={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},s={NETWORK_EXCEPTION:n.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:n.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:n.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:n.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:i.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:i.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:i.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(e,t,r){"use strict";r.r(t),t.default={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"}},"./src/remux/aac-silent.js":function(e,t,r){"use strict";r.r(t);var n=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}();t.default=n},"./src/remux/mp4-generator.js":function(e,t,r){"use strict";r.r(t);var n=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=e.constants={};r.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),r.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),r.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),r.STSC=r.STCO=r.STTS,r.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),r.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),r.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),r.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(e){for(var t=8,r=null,n=Array.prototype.slice.call(arguments,1),i=n.length,o=0;o<i;o++)t+=n[o].byteLength;(r=new Uint8Array(t))[0]=t>>>24&255,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r.set(e,4);var s=8;for(o=0;o<i;o++)r.set(n[o],s),s+=n[o].byteLength;return r},e.generateInitSegment=function(t){var r=e.box(e.types.ftyp,e.constants.FTYP),n=e.moov(t),i=new Uint8Array(r.byteLength+n.byteLength);return i.set(r,0),i.set(n,r.byteLength),i},e.moov=function(t){var r=e.mvhd(t.timescale,t.duration),n=e.trak(t),i=e.mvex(t);return e.box(e.types.moov,r,n,i)},e.mvhd=function(t,r){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var r=t.id,n=t.duration,i=t.presentWidth,o=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>>8&255,255&i,0,0,o>>>8&255,255&o,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var r=t.timescale,n=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,85,196,0,0]))},e.hdlr=function(t){var r=null;return r="audio"===t.type?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,r)},e.minf=function(t){var r=null;return r="audio"===t.type?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,r,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))},e.mp3=function(t){var r=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types[".mp3"],i)},e.mp4a=function(t){var r=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types.mp4a,i,e.esds(t))},e.esds=function(t){var r=t.config||[],n=r.length,i=new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(r).concat([6,1,2]));return e.box(e.types.esds,i)},e.avc1=function(t){var r=t.avcc,n=t.codecWidth,i=t.codecHeight,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,i>>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,o,e.box(e.types.avcC,r))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var r=t.id,n=new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,n)},e.moof=function(t,r){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,r))},e.mfhd=function(t){var r=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,r)},e.traf=function(t,r){var n=t.id,i=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n])),o=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r])),s=e.sdtp(t),a=e.trun(t,s.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,i,o,a,s)},e.sdtp=function(t){for(var r=t.samples||[],n=r.length,i=new Uint8Array(4+n),o=0;o<n;o++){var s=r[o].flags;i[o+4]=s.isLeading<<6|s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy}return e.box(e.types.sdtp,i)},e.trun=function(t,r){var n=t.samples||[],i=n.length,o=12+16*i,s=new Uint8Array(o);r+=8+o,s.set([0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0);for(var a=0;a<i;a++){var c=n[a].duration,u=n[a].size,l=n[a].flags,d=n[a].cts;s.set([c>>>24&255,c>>>16&255,c>>>8&255,255&c,u>>>24&255,u>>>16&255,u>>>8&255,255&u,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.isNonSync,0,0,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*a)}return e.box(e.types.trun,s)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();n.init(),t.default=n},"./src/remux/mp4-remuxer.js":function(e,t,r){"use strict";r.r(t);var n=r("./src/utils/logger.js"),i=r("./src/remux/mp4-generator.js"),o=r("./src/remux/aac-silent.js"),s=r("./src/utils/browser.js"),a=r("./src/core/media-segment-info.js"),c=r("./src/utils/exception.js"),u=function(){function e(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new a.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new a.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!s.default.chrome||!(s.default.version.major<50||50===s.default.version.major&&s.default.version.build<2661)),this._fillSilentAfterSeek=s.default.msedge||s.default.msie,this._mp3UseMpegAudio=!s.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return e.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},e.prototype.bindDataSource=function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(e.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e},enumerable:!1,configurable:!0}),e.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},e.prototype.seek=function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},e.prototype.remux=function(e,t){if(!this._onMediaSegment)throw new c.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),this._remuxVideo(t),this._remuxAudio(e)},e.prototype._onTrackMetadataReceived=function(e,t){var r=null,n="mp4",o=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(n="mpeg",o="",r=new Uint8Array):r=i.default.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,r=i.default.generateInitSegment(t)}if(!this._onInitSegment)throw new c.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:r.buffer,codec:o,container:e+"/"+n,mediaDuration:t.duration})},e.prototype._calculateDtsBase=function(e,t){this._dtsBaseInited||(e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},e.prototype.flushStashedSamples=function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,r={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(r.samples.push(e),r.length=e.length);var n={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(n.samples.push(t),n.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(r,!0),this._remuxAudio(n,!0)},e.prototype._remuxAudio=function(e,t){if(null!=this._audioMeta){var r,c=e,u=c.samples,l=void 0,d=-1,h=this._audioMeta.refSampleDuration,p="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,f=this._dtsBaseInited&&void 0===this._audioNextDts,g=!1;if(u&&0!==u.length&&(1!==u.length||t)){var m=0,_=null,v=0;p?(m=0,v=c.length):(m=8,v=8+c.length);var y=null;if(u.length>1&&(v-=(y=u.pop()).length),null!=this._audioStashedLastSample){var E=this._audioStashedLastSample;this._audioStashedLastSample=null,u.unshift(E),v+=E.length}null!=y&&(this._audioStashedLastSample=y);var S=u[0].dts-this._dtsBase;if(this._audioNextDts)l=S-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())l=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(g=!0);else{var b=this._audioSegmentInfoList.getLastSampleBefore(S);if(null!=b){var T=S-(b.originalDts+b.duration);T<=3&&(T=0),l=S-(b.dts+b.duration+T)}else l=0}if(g){var C=S-l,R=this._videoSegmentInfoList.getLastSegmentBefore(S);if(null!=R&&R.beginDts<C){if(U=o.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var O=R.beginDts,k=C-R.beginDts;n.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+O+", duration: "+k),u.unshift({unit:U,dts:O,pts:O}),v+=U.byteLength}}else g=!1}for(var I=[],L=0;L<u.length;L++){var w=(E=u[L]).unit,A=E.dts-this._dtsBase,N=(O=A,!1),P=null,M=0;if(!(A<-.001)){if("mp3"!==this._audioMeta.codec){var D=A;if(this._audioNextDts&&(D=this._audioNextDts),(l=A-D)<=-3*h){n.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+A+" ms ,curRefDts: "+D+" ms)  due to dtsCorrection: "+l+" ms overlap.");continue}if(l>=3*h&&this._fillAudioTimestampGap&&!s.default.safari){N=!0;var U,x=Math.floor(l/h);n.default.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\noriginalDts: "+A+" ms, curRefDts: "+D+" ms, dtsCorrection: "+Math.round(l)+" ms, generate: "+x+" frames"),O=Math.floor(D),M=Math.floor(D+h)-O,null==(U=o.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))&&(n.default.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),U=w),P=[];for(var B=0;B<x;B++){D+=h;var j=Math.floor(D),H=Math.floor(D+h)-j,G={dts:j,pts:j,cts:0,unit:U,size:U.byteLength,duration:H,originalDts:A,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};P.push(G),v+=G.size}this._audioNextDts=D+h}else O=Math.floor(D),M=Math.floor(D+h)-O,this._audioNextDts=D+h}else O=A-l,M=L!==u.length-1?u[L+1].dts-this._dtsBase-l-O:null!=y?y.dts-this._dtsBase-l-O:I.length>=1?I[I.length-1].duration:Math.floor(h),this._audioNextDts=O+M;-1===d&&(d=O),I.push({dts:O,pts:O,cts:0,unit:E.unit,size:E.unit.byteLength,duration:M,originalDts:A,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),N&&I.push.apply(I,P)}}if(0===I.length)return c.samples=[],void(c.length=0);for(p?_=new Uint8Array(v):((_=new Uint8Array(v))[0]=v>>>24&255,_[1]=v>>>16&255,_[2]=v>>>8&255,_[3]=255&v,_.set(i.default.types.mdat,4)),L=0;L<I.length;L++)w=I[L].unit,_.set(w,m),m+=w.byteLength;var z=I[I.length-1];r=z.dts+z.duration;var q=new a.MediaSegmentInfo;q.beginDts=d,q.endDts=r,q.beginPts=d,q.endPts=r,q.originalBeginDts=I[0].originalDts,q.originalEndDts=z.originalDts+z.duration,q.firstSample=new a.SampleInfo(I[0].dts,I[0].pts,I[0].duration,I[0].originalDts,!1),q.lastSample=new a.SampleInfo(z.dts,z.pts,z.duration,z.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(q),c.samples=I,c.sequenceNumber++;var V=null;V=p?new Uint8Array:i.default.moof(c,d),c.samples=[],c.length=0;var F={type:"audio",data:this._mergeBoxes(V,_).buffer,sampleCount:I.length,info:q};p&&f&&(F.timestampOffset=d),this._onMediaSegment("audio",F)}}},e.prototype._remuxVideo=function(e,t){if(null!=this._videoMeta){var r,n,o=e,s=o.samples,c=void 0,u=-1,l=-1;if(s&&0!==s.length&&(1!==s.length||t)){var d=8,h=null,p=8+e.length,f=null;if(s.length>1&&(p-=(f=s.pop()).length),null!=this._videoStashedLastSample){var g=this._videoStashedLastSample;this._videoStashedLastSample=null,s.unshift(g),p+=g.length}null!=f&&(this._videoStashedLastSample=f);var m=s[0].dts-this._dtsBase;if(this._videoNextDts)c=m-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())c=0;else{var _=this._videoSegmentInfoList.getLastSampleBefore(m);if(null!=_){var v=m-(_.originalDts+_.duration);v<=3&&(v=0),c=m-(_.dts+_.duration+v)}else c=0}for(var y=new a.MediaSegmentInfo,E=[],S=0;S<s.length;S++){var b=(g=s[S]).dts-this._dtsBase,T=g.isKeyframe,C=b-c,R=g.cts,O=C+R;-1===u&&(u=C,l=O);var k=0;if(k=S!==s.length-1?s[S+1].dts-this._dtsBase-c-C:null!=f?f.dts-this._dtsBase-c-C:E.length>=1?E[E.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),T){var I=new a.SampleInfo(C,O,k,g.dts,!0);I.fileposition=g.fileposition,y.appendSyncPoint(I)}E.push({dts:C,pts:O,cts:R,units:g.units,size:g.length,isKeyframe:T,duration:k,originalDts:b,flags:{isLeading:0,dependsOn:T?2:1,isDependedOn:T?1:0,hasRedundancy:0,isNonSync:T?0:1}})}for((h=new Uint8Array(p))[0]=p>>>24&255,h[1]=p>>>16&255,h[2]=p>>>8&255,h[3]=255&p,h.set(i.default.types.mdat,4),S=0;S<E.length;S++)for(var L=E[S].units;L.length;){var w=L.shift().data;h.set(w,d),d+=w.byteLength}var A=E[E.length-1];if(r=A.dts+A.duration,n=A.pts+A.duration,this._videoNextDts=r,y.beginDts=u,y.endDts=r,y.beginPts=l,y.endPts=n,y.originalBeginDts=E[0].originalDts,y.originalEndDts=A.originalDts+A.duration,y.firstSample=new a.SampleInfo(E[0].dts,E[0].pts,E[0].duration,E[0].originalDts,E[0].isKeyframe),y.lastSample=new a.SampleInfo(A.dts,A.pts,A.duration,A.originalDts,A.isKeyframe),this._isLive||this._videoSegmentInfoList.append(y),o.samples=E,o.sequenceNumber++,this._forceFirstIDR){var N=E[0].flags;N.dependsOn=2,N.isNonSync=0}var P=i.default.moof(o,u);o.samples=[],o.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(P,h).buffer,sampleCount:E.length,info:y})}}},e.prototype._mergeBoxes=function(e,t){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(e,0),r.set(t,e.byteLength),r},e}();t.default=u},"./src/utils/browser.js":function(e,t,r){"use strict";r.r(t);var n={};!function(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],r=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],i={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:r[0]||""},o={};if(i.browser){o[i.browser]=!0;var s=i.majorVersion.split(".");o.version={major:parseInt(i.majorVersion,10),string:i.version},s.length>1&&(o.version.minor=parseInt(s[1],10)),s.length>2&&(o.version.build=parseInt(s[2],10))}if(i.platform&&(o[i.platform]=!0),(o.chrome||o.opr||o.safari)&&(o.webkit=!0),o.rv||o.iemobile){o.rv&&delete o.rv;var a="msie";i.browser=a,o.msie=!0}if(o.edge){delete o.edge;var c="msedge";i.browser=c,o.msedge=!0}if(o.opr){var u="opera";i.browser=u,o.opera=!0}if(o.safari&&o.android){var l="android";i.browser=l,o.android=!0}for(var d in o.name=i.browser,o.platform=i.platform,n)n.hasOwnProperty(d)&&delete n[d];Object.assign(n,o)}(),t.default=n},"./src/utils/exception.js":function(e,t,r){"use strict";r.r(t),r.d(t,{RuntimeException:function(){return i},IllegalStateException:function(){return o},InvalidArgumentException:function(){return s},NotImplementedException:function(){return a}});var n=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(){function e(e){this._message=e}return Object.defineProperty(e.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.name+": "+this.message},e}(),o=function(e){function t(t){return e.call(this,t)||this}return n(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),t}(i),s=function(e){function t(t){return e.call(this,t)||this}return n(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),t}(i),a=function(e){function t(t){return e.call(this,t)||this}return n(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),t}(i)},"./src/utils/logger.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/events/events.js"),i=r.n(n),o=function(){function e(){}return e.e=function(t,r){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+r;e.ENABLE_CALLBACK&&e.emitter.emit("log","error",n),e.ENABLE_ERROR&&(console.error?console.error(n):console.warn?console.warn(n):console.log(n))},e.i=function(t,r){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+r;e.ENABLE_CALLBACK&&e.emitter.emit("log","info",n),e.ENABLE_INFO&&(console.info?console.info(n):console.log(n))},e.w=function(t,r){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+r;e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",n),e.ENABLE_WARN&&(console.warn?console.warn(n):console.log(n))},e.d=function(t,r){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+r;e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",n),e.ENABLE_DEBUG&&(console.debug?console.debug(n):console.log(n))},e.v=function(t,r){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+r;e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",n),e.ENABLE_VERBOSE&&console.log(n)},e}();o.GLOBAL_TAG="flv.js",o.FORCE_GLOBAL_TAG=!1,o.ENABLE_ERROR=!0,o.ENABLE_INFO=!0,o.ENABLE_WARN=!0,o.ENABLE_DEBUG=!0,o.ENABLE_VERBOSE=!0,o.ENABLE_CALLBACK=!1,o.emitter=new(i()),t.default=o},"./src/utils/logging-control.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/events/events.js"),i=r.n(n),o=r("./src/utils/logger.js"),s=function(){function e(){}return Object.defineProperty(e,"forceGlobalTag",{get:function(){return o.default.FORCE_GLOBAL_TAG},set:function(t){o.default.FORCE_GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalTag",{get:function(){return o.default.GLOBAL_TAG},set:function(t){o.default.GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableAll",{get:function(){return o.default.ENABLE_VERBOSE&&o.default.ENABLE_DEBUG&&o.default.ENABLE_INFO&&o.default.ENABLE_WARN&&o.default.ENABLE_ERROR},set:function(t){o.default.ENABLE_VERBOSE=t,o.default.ENABLE_DEBUG=t,o.default.ENABLE_INFO=t,o.default.ENABLE_WARN=t,o.default.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableDebug",{get:function(){return o.default.ENABLE_DEBUG},set:function(t){o.default.ENABLE_DEBUG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableVerbose",{get:function(){return o.default.ENABLE_VERBOSE},set:function(t){o.default.ENABLE_VERBOSE=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableInfo",{get:function(){return o.default.ENABLE_INFO},set:function(t){o.default.ENABLE_INFO=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableWarn",{get:function(){return o.default.ENABLE_WARN},set:function(t){o.default.ENABLE_WARN=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableError",{get:function(){return o.default.ENABLE_ERROR},set:function(t){o.default.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),e.getConfig=function(){return{globalTag:o.default.GLOBAL_TAG,forceGlobalTag:o.default.FORCE_GLOBAL_TAG,enableVerbose:o.default.ENABLE_VERBOSE,enableDebug:o.default.ENABLE_DEBUG,enableInfo:o.default.ENABLE_INFO,enableWarn:o.default.ENABLE_WARN,enableError:o.default.ENABLE_ERROR,enableCallback:o.default.ENABLE_CALLBACK}},e.applyConfig=function(e){o.default.GLOBAL_TAG=e.globalTag,o.default.FORCE_GLOBAL_TAG=e.forceGlobalTag,o.default.ENABLE_VERBOSE=e.enableVerbose,o.default.ENABLE_DEBUG=e.enableDebug,o.default.ENABLE_INFO=e.enableInfo,o.default.ENABLE_WARN=e.enableWarn,o.default.ENABLE_ERROR=e.enableError,o.default.ENABLE_CALLBACK=e.enableCallback},e._notifyChange=function(){var t=e.emitter;if(t.listenerCount("change")>0){var r=e.getConfig();t.emit("change",r)}},e.registerListener=function(t){e.emitter.addListener("change",t)},e.removeListener=function(t){e.emitter.removeListener("change",t)},e.addLogListener=function(t){o.default.emitter.addListener("log",t),o.default.emitter.listenerCount("log")>0&&(o.default.ENABLE_CALLBACK=!0,e._notifyChange())},e.removeLogListener=function(t){o.default.emitter.removeListener("log",t),0===o.default.emitter.listenerCount("log")&&(o.default.ENABLE_CALLBACK=!1,e._notifyChange())},e}();s.emitter=new(i()),t.default=s},"./src/utils/polyfill.js":function(e,t,r){"use strict";r.r(t);var n=function(){function e(){}return e.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(void 0!==n&&null!==n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t},"function"!==typeof self.Promise&&r("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},e}();n.install(),t.default=n},"./src/utils/utf8-conv.js":function(e,t,r){"use strict";function n(e,t,r){var n=e;if(t+r<n.length){for(;r--;)if(128!==(192&n[++t]))return!1;return!0}return!1}r.r(t),t.default=function(e){for(var t=[],r=e,i=0,o=e.length;i<o;)if(r[i]<128)t.push(String.fromCharCode(r[i])),++i;else{if(r[i]<192);else if(r[i]<224){if(n(r,i,1)&&(s=(31&r[i])<<6|63&r[i+1])>=128){t.push(String.fromCharCode(65535&s)),i+=2;continue}}else if(r[i]<240){if(n(r,i,2)&&(s=(15&r[i])<<12|(63&r[i+1])<<6|63&r[i+2])>=2048&&55296!==(63488&s)){t.push(String.fromCharCode(65535&s)),i+=3;continue}}else if(r[i]<248){var s;if(n(r,i,3)&&(s=(7&r[i])<<18|(63&r[i+1])<<12|(63&r[i+2])<<6|63&r[i+3])>65536&&s<1114112){s-=65536,t.push(String.fromCharCode(s>>>10|55296)),t.push(String.fromCharCode(1023&s|56320)),i+=4;continue}}t.push(String.fromCharCode(65533)),++i}return t.join("")}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}return r.m=e,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r("./src/index.js")}()},e.exports=t()},9053:function(e,t,r){"use strict";var n=r(91),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(e){return n.isMemo(e)?s:a[e.$$typeof]||i}a[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[n.Memo]=s;var u=Object.defineProperty,l=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,r,n){if("string"!==typeof r){if(f){var i=p(r);i&&i!==f&&e(t,i,n)}var s=l(r);d&&(s=s.concat(d(r)));for(var a=c(t),g=c(r),m=0;m<s.length;++m){var _=s[m];if(!o[_]&&(!n||!n[_])&&(!g||!g[_])&&(!a||!a[_])){var v=h(r,_);try{u(t,_,v)}catch(y){}}}}return t}},3248:function(e,t,r){var n=r(3038).default;Object.fromEntries||Object.defineProperty(Object,"fromEntries",{value:function(e){if(!e||!e[Symbol.iterator])throw new Error("Object.fromEntries() requires a single iterable argument");var t={};return Object.keys(e).forEach((function(r){var i=n(e[r],2),o=i[0],s=i[1];t[o]=s})),t}})},9772:function(e,t,r){"use strict";var n=r(9867),i=r(2882);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function c(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(e,t,r,n,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var _=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,r,n){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(_,v);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(_,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(_,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var E=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),b=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),k=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var U,x=Object.assign;function B(e){if(void 0===U)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||""}return"\n"+U+e}var j=!1;function H(e,t){if(!e||j)return"";j=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),o=n.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var c="\n"+i[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=a);break}}}finally{j=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?B(e):""}function G(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case b:return"Portal";case R:return"Profiler";case C:return"StrictMode";case L:return"Suspense";case w:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case O:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return z(e(t))}catch(r){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function F(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Z(e){e._valueTracker||(e._valueTracker=function(e){var t=F(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=F(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var r=t.checked;return x({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function K(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=V(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function X(e,t){J(e,t);var r=V(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&Y(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+V(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return x({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(o(92));if(te(r)){if(1<r.length)throw Error(o(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:V(r)}}function oe(e,t){var r=V(t.value),n=V(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,le,de=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function he(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=ge(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var _e=x({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(_e[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ee=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,Te=null,Ce=null;function Re(e){if(e=yi(e)){if("function"!==typeof be)throw Error(o(280));var t=e.stateNode;t&&(t=Si(t),be(e.stateNode,e.type,t))}}function Oe(e){Te?Ce?Ce.push(e):Ce=[e]:Te=e}function ke(){if(Te){var e=Te,t=Ce;if(Ce=Te=null,Re(e),t)for(e=0;e<t.length;e++)Re(t[e])}}function Ie(e,t){return e(t)}function Le(){}var we=!1;function Ae(e,t,r){if(we)return e(t,r);we=!0;try{return Ie(e,t,r)}finally{we=!1,(null!==Te||null!==Ce)&&(Le(),ke())}}function Ne(e,t){var r=e.stateNode;if(null===r)return null;var n=Si(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(o(231,t,typeof r));return r}var Pe=!1;if(l)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(le){Pe=!1}function De(e,t,r,n,i,o,s,a,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(l){this.onError(l)}}var Ue=!1,xe=null,Be=!1,je=null,He={onError:function(e){Ue=!0,xe=e}};function Ge(e,t,r,n,i,o,s,a,c){Ue=!1,xe=null,De.apply(He,arguments)}function ze(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(ze(e)!==e)throw Error(o(188))}function Fe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ve(i),e;if(s===n)return Ve(i),t;s=s.sibling}throw Error(o(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,c=i.child;c;){if(c===r){a=!0,r=i,n=s;break}if(c===n){a=!0,n=i,r=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===r){a=!0,r=s,n=i;break}if(c===n){a=!0,n=s,r=i;break}c=c.sibling}if(!a)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}(e))?Ze(e):null}function Ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ze(e);if(null!==t)return t;e=e.sibling}return null}var We=i.unstable_scheduleCallback,Ye=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ke=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(at(e)/ct|0)|0},at=Math.log,ct=Math.LN2;var ut=64,lt=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&r;if(0!==s){var a=s&~i;0!==a?n=dt(a):0!==(o&=s)&&(n=dt(o))}else 0!==(s=r&~i)?n=dt(s):0!==o&&(n=dt(o));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-st(t)),n|=e[r],t&=~i;return n}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function mt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function _t(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=r}function vt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-st(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var yt=0;function Et(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,bt,Tt,Ct,Rt,Ot=!1,kt=[],It=null,Lt=null,wt=null,At=new Map,Nt=new Map,Pt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Lt=null;break;case"mouseover":case"mouseout":wt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Ut(e,t,r,n,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&bt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function xt(e){var t=vi(e.target);if(null!==t){var r=ze(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=qe(r)))return e.blockedOn=t,void Rt(e.priority,(function(){Tt(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=yi(r))&&bt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);Ee=n,r.target.dispatchEvent(n),Ee=null,t.shift()}return!0}function jt(e,t,r){Bt(e)&&r.delete(t)}function Ht(){Ot=!1,null!==It&&Bt(It)&&(It=null),null!==Lt&&Bt(Lt)&&(Lt=null),null!==wt&&Bt(wt)&&(wt=null),At.forEach(jt),Nt.forEach(jt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ot||(Ot=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ht)))}function zt(e){function t(t){return Gt(t,e)}if(0<kt.length){Gt(kt[0],e);for(var r=1;r<kt.length;r++){var n=kt[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==It&&Gt(It,e),null!==Lt&&Gt(Lt,e),null!==wt&&Gt(wt,e),At.forEach(t),Nt.forEach(t),r=0;r<Pt.length;r++)(n=Pt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Pt.length&&null===(r=Pt[0]).blockedOn;)xt(r),null===r.blockedOn&&Pt.shift()}var qt=E.ReactCurrentBatchConfig,Vt=!0;function Ft(e,t,r,n){var i=yt,o=qt.transition;qt.transition=null;try{yt=1,Wt(e,t,r,n)}finally{yt=i,qt.transition=o}}function Zt(e,t,r,n){var i=yt,o=qt.transition;qt.transition=null;try{yt=4,Wt(e,t,r,n)}finally{yt=i,qt.transition=o}}function Wt(e,t,r,n){if(Vt){var i=Qt(e,t,r,n);if(null===i)Vn(e,t,n,Yt,r),Dt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return It=Ut(It,e,t,r,n,i),!0;case"dragenter":return Lt=Ut(Lt,e,t,r,n,i),!0;case"mouseover":return wt=Ut(wt,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return At.set(o,Ut(At.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,Nt.set(o,Ut(Nt.get(o)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<Mt.indexOf(e)){for(;null!==i;){var o=yi(i);if(null!==o&&St(o),null===(o=Qt(e,t,r,n))&&Vn(e,t,n,Yt,r),o===i)break;i=o}null!==i&&n.stopPropagation()}else Vn(e,t,n,null,r)}}var Yt=null;function Qt(e,t,r,n){if(Yt=null,null!==(e=vi(e=Se(n))))if(null===(t=ze(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case $e:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,$t=null;function er(){if($t)return $t;var e,t,r=Xt,n=r.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<n&&r[e]===i[e];e++);var s=n-e;for(t=1;t<=s&&r[n-t]===i[o-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,o){for(var s in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var or,sr,ar,cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ur=ir(cr),lr=x({},cr,{view:0,detail:0}),dr=ir(lr),hr=x({},lr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ar&&(ar&&"mousemove"===e.type?(or=e.screenX-ar.screenX,sr=e.screenY-ar.screenY):sr=or=0,ar=e),or)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),pr=ir(hr),fr=ir(x({},hr,{dataTransfer:0})),gr=ir(x({},lr,{relatedTarget:0})),mr=ir(x({},cr,{animationName:0,elapsedTime:0,pseudoElement:0})),_r=x({},cr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vr=ir(_r),yr=ir(x({},cr,{data:0})),Er={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},br={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=br[e])&&!!t[e]}function Cr(){return Tr}var Rr=x({},lr,{key:function(e){if(e.key){var t=Er[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Or=ir(Rr),kr=ir(x({},hr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ir=ir(x({},lr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cr})),Lr=ir(x({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0})),wr=x({},hr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ar=ir(wr),Nr=[9,13,27,32],Pr=l&&"CompositionEvent"in window,Mr=null;l&&"documentMode"in document&&(Mr=document.documentMode);var Dr=l&&"TextEvent"in window&&!Mr,Ur=l&&(!Pr||Mr&&8<Mr&&11>=Mr),xr=String.fromCharCode(32),Br=!1;function jr(e,t){switch(e){case"keyup":return-1!==Nr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Gr=!1;var zr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zr[e.type]:"textarea"===t}function Vr(e,t,r,n){Oe(n),0<(t=Zn(t,"onChange")).length&&(r=new ur("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Fr=null,Zr=null;function Wr(e){Bn(e,0)}function Yr(e){if(W(Ei(e)))return e}function Qr(e,t){if("change"===e)return t}var Kr=!1;if(l){var Jr;if(l){var Xr="oninput"in document;if(!Xr){var $r=document.createElement("div");$r.setAttribute("oninput","return;"),Xr="function"===typeof $r.oninput}Jr=Xr}else Jr=!1;Kr=Jr&&(!document.documentMode||9<document.documentMode)}function en(){Fr&&(Fr.detachEvent("onpropertychange",tn),Zr=Fr=null)}function tn(e){if("value"===e.propertyName&&Yr(Zr)){var t=[];Vr(t,Zr,e,Se(e)),Ae(Wr,t)}}function rn(e,t,r){"focusin"===e?(en(),Zr=r,(Fr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yr(Zr)}function on(e,t){if("click"===e)return Yr(t)}function sn(e,t){if("input"===e||"change"===e)return Yr(t)}var an="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(an(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!d.call(t,i)||!an(e[i],t[i]))return!1}return!0}function un(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ln(e,t){var r,n=un(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=un(n)}}function dn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hn(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=Y((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fn(e){var t=hn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&dn(r.ownerDocument.documentElement,r)){if(null!==n&&pn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=void 0===n.end?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=ln(r,o);var s=ln(r,n);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=l&&"documentMode"in document&&11>=document.documentMode,mn=null,_n=null,vn=null,yn=!1;function En(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;yn||null==mn||mn!==Y(n)||("selectionStart"in(n=mn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&cn(vn,n)||(vn=n,0<(n=Zn(_n,"onSelect")).length&&(t=new ur("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=mn)))}function Sn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var bn={animationend:Sn("Animation","AnimationEnd"),animationiteration:Sn("Animation","AnimationIteration"),animationstart:Sn("Animation","AnimationStart"),transitionend:Sn("Transition","TransitionEnd")},Tn={},Cn={};function Rn(e){if(Tn[e])return Tn[e];if(!bn[e])return e;var t,r=bn[e];for(t in r)if(r.hasOwnProperty(t)&&t in Cn)return Tn[e]=r[t];return e}l&&(Cn=document.createElement("div").style,"AnimationEvent"in window||(delete bn.animationend.animation,delete bn.animationiteration.animation,delete bn.animationstart.animation),"TransitionEvent"in window||delete bn.transitionend.transition);var On=Rn("animationend"),kn=Rn("animationiteration"),In=Rn("animationstart"),Ln=Rn("transitionend"),wn=new Map,An="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nn(e,t){wn.set(e,t),c(t,[e])}for(var Pn=0;Pn<An.length;Pn++){var Mn=An[Pn];Nn(Mn.toLowerCase(),"on"+(Mn[0].toUpperCase()+Mn.slice(1)))}Nn(On,"onAnimationEnd"),Nn(kn,"onAnimationIteration"),Nn(In,"onAnimationStart"),Nn("dblclick","onDoubleClick"),Nn("focusin","onFocus"),Nn("focusout","onBlur"),Nn(Ln,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Un=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function xn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,s,a,c,u){if(Ge.apply(this,arguments),Ue){if(!Ue)throw Error(o(198));var l=xe;Ue=!1,xe=null,Be||(Be=!0,je=l)}}(n,t,void 0,e),e.currentTarget=null}function Bn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;xn(i,a,u),o=c}else for(s=0;s<n.length;s++){if(c=(a=n[s]).instance,u=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;xn(i,a,u),o=c}}}if(Be)throw e=je,Be=!1,je=null,e}function jn(e,t){var r=t[gi];void 0===r&&(r=t[gi]=new Set);var n=e+"__bubble";r.has(n)||(qn(t,e,2,!1),r.add(n))}function Hn(e,t,r){var n=0;t&&(n|=4),qn(r,e,n,t)}var Gn="_reactListening"+Math.random().toString(36).slice(2);function zn(e){if(!e[Gn]){e[Gn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Un.has(t)||Hn(t,!1,e),Hn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Gn]||(t[Gn]=!0,Hn("selectionchange",!1,t))}}function qn(e,t,r,n){switch(Kt(t)){case 1:var i=Ft;break;case 4:i=Zt;break;default:i=Wt}r=i.bind(null,t,r,e),i=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Vn(e,t,r,n,i){var o=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var a=n.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=n.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=vi(a)))return;if(5===(c=s.tag)||6===c){n=o=s;continue e}a=a.parentNode}}n=n.return}Ae((function(){var n=o,i=Se(r),s=[];e:{var a=wn.get(e);if(void 0!==a){var c=ur,u=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":c=Or;break;case"focusin":u="focus",c=gr;break;case"focusout":u="blur",c=gr;break;case"beforeblur":case"afterblur":c=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=pr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=fr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Ir;break;case On:case kn:case In:c=mr;break;case Ln:c=Lr;break;case"scroll":c=dr;break;case"wheel":c=Ar;break;case"copy":case"cut":case"paste":c=vr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=kr}var l=0!==(4&t),d=!l&&"scroll"===e,h=l?null!==a?a+"Capture":null:a;l=[];for(var p,f=n;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==h&&(null!=(g=Ne(f,h))&&l.push(Fn(f,g,p)))),d)break;f=f.return}0<l.length&&(a=new c(a,u,null,r,i),s.push({event:a,listeners:l}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||r===Ee||!(u=r.relatedTarget||r.fromElement)||!vi(u)&&!u[fi])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=n,null!==(u=(u=r.relatedTarget||r.toElement)?vi(u):null)&&(u!==(d=ze(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(c=null,u=n),c!==u)){if(l=pr,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(l=kr,g="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==c?a:Ei(c),p=null==u?a:Ei(u),(a=new l(g,f+"leave",c,r,i)).target=d,a.relatedTarget=p,g=null,vi(i)===n&&((l=new l(h,f+"enter",u,r,i)).target=p,l.relatedTarget=d,g=l),d=g,c&&u)e:{for(h=u,f=0,p=l=c;p;p=Wn(p))f++;for(p=0,g=h;g;g=Wn(g))p++;for(;0<f-p;)l=Wn(l),f--;for(;0<p-f;)h=Wn(h),p--;for(;f--;){if(l===h||null!==h&&l===h.alternate)break e;l=Wn(l),h=Wn(h)}l=null}else l=null;null!==c&&Yn(s,a,c,l,!1),null!==u&&null!==d&&Yn(s,d,u,l,!0)}if("select"===(c=(a=n?Ei(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var m=Qr;else if(qr(a))if(Kr)m=sn;else{m=nn;var _=rn}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=on);switch(m&&(m=m(e,n))?Vr(s,m,r,i):(_&&_(e,a,n),"focusout"===e&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&ee(a,"number",a.value)),_=n?Ei(n):window,e){case"focusin":(qr(_)||"true"===_.contentEditable)&&(mn=_,_n=n,vn=null);break;case"focusout":vn=_n=mn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,En(s,r,i);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":En(s,r,i)}var v;if(Pr)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Gr?jr(e,r)&&(y="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(y="onCompositionStart");y&&(Ur&&"ko"!==r.locale&&(Gr||"onCompositionStart"!==y?"onCompositionEnd"===y&&Gr&&(v=er()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,Gr=!0)),0<(_=Zn(n,y)).length&&(y=new yr(y,e,null,r,i),s.push({event:y,listeners:_}),v?y.data=v:null!==(v=Hr(r))&&(y.data=v))),(v=Dr?function(e,t){switch(e){case"compositionend":return Hr(t);case"keypress":return 32!==t.which?null:(Br=!0,xr);case"textInput":return(e=t.data)===xr&&Br?null:e;default:return null}}(e,r):function(e,t){if(Gr)return"compositionend"===e||!Pr&&jr(e,t)?(e=er(),$t=Xt=Jt=null,Gr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ur&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Zn(n,"onBeforeInput")).length&&(i=new yr("onBeforeInput","beforeinput",null,r,i),s.push({event:i,listeners:n}),i.data=v))}Bn(s,t)}))}function Fn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Zn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ne(e,r))&&n.unshift(Fn(e,o,i)),null!=(o=Ne(e,t))&&n.push(Fn(e,o,i))),e=e.return}return n}function Wn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yn(e,t,r,n,i){for(var o=t._reactName,s=[];null!==r&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(null!==c&&c===n)break;5===a.tag&&null!==u&&(a=u,i?null!=(c=Ne(r,o))&&s.unshift(Fn(r,c,a)):i||null!=(c=Ne(r,o))&&s.push(Fn(r,c,a))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var Qn=/\r\n?/g,Kn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace(Qn,"\n").replace(Kn,"")}function Xn(e,t,r){if(t=Jn(t),Jn(e)!==t&&r)throw Error(o(425))}function $n(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(ai)}:ni;function ai(e){setTimeout((function(){throw e}))}function ci(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void zt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);zt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,pi="__reactProps$"+di,fi="__reactContainer$"+di,gi="__reactEvents$"+di,mi="__reactListeners$"+di,_i="__reactHandles$"+di;function vi(e){var t=e[hi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fi]||r[hi]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=li(e);null!==e;){if(r=e[hi])return r;e=li(e)}return t}r=(e=r).parentNode}return null}function yi(e){return!(e=e[hi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ei(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Si(e){return e[pi]||null}var bi=[],Ti=-1;function Ci(e){return{current:e}}function Ri(e){0>Ti||(e.current=bi[Ti],bi[Ti]=null,Ti--)}function Oi(e,t){Ti++,bi[Ti]=e.current,e.current=t}var ki={},Ii=Ci(ki),Li=Ci(!1),wi=ki;function Ai(e,t){var r=e.type.contextTypes;if(!r)return ki;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in r)o[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ni(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pi(){Ri(Li),Ri(Ii)}function Mi(e,t,r){if(Ii.current!==ki)throw Error(o(168));Oi(Ii,t),Oi(Li,r)}function Di(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(o(108,q(e)||"Unknown",i));return x({},r,n)}function Ui(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,wi=Ii.current,Oi(Ii,e),Oi(Li,Li.current),!0}function xi(e,t,r){var n=e.stateNode;if(!n)throw Error(o(169));r?(e=Di(e,t,wi),n.__reactInternalMemoizedMergedChildContext=e,Ri(Li),Ri(Ii),Oi(Ii,e)):Ri(Li),Oi(Li,r)}var Bi=null,ji=!1,Hi=!1;function Gi(e){null===Bi?Bi=[e]:Bi.push(e)}function zi(){if(!Hi&&null!==Bi){Hi=!0;var e=0,t=yt;try{var r=Bi;for(yt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Bi=null,ji=!1}catch(i){throw null!==Bi&&(Bi=Bi.slice(e+1)),We($e,zi),i}finally{yt=t,Hi=!1}}return null}var qi=[],Vi=0,Fi=null,Zi=0,Wi=[],Yi=0,Qi=null,Ki=1,Ji="";function Xi(e,t){qi[Vi++]=Zi,qi[Vi++]=Fi,Fi=e,Zi=t}function $i(e,t,r){Wi[Yi++]=Ki,Wi[Yi++]=Ji,Wi[Yi++]=Qi,Qi=e;var n=Ki;e=Ji;var i=32-st(n)-1;n&=~(1<<i),r+=1;var o=32-st(t)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Ki=1<<32-st(t)+i|r<<i|n,Ji=o+e}else Ki=1<<o|r<<i|n,Ji=e}function eo(e){null!==e.return&&(Xi(e,1),$i(e,1,0))}function to(e){for(;e===Fi;)Fi=qi[--Vi],qi[Vi]=null,Zi=qi[--Vi],qi[Vi]=null;for(;e===Qi;)Qi=Wi[--Yi],Wi[Yi]=null,Ji=Wi[--Yi],Wi[Yi]=null,Ki=Wi[--Yi],Wi[Yi]=null}var ro=null,no=null,io=!1,oo=null;function so(e,t){var r=Au(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function ao(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ro=e,no=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ro=e,no=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Qi?{id:Ki,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Au(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ro=e,no=null,!0);default:return!1}}function co(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function uo(e){if(io){var t=no;if(t){var r=t;if(!ao(e,t)){if(co(e))throw Error(o(418));t=ui(r.nextSibling);var n=ro;t&&ao(e,t)?so(n,r):(e.flags=-4097&e.flags|2,io=!1,ro=e)}}else{if(co(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,ro=e}}}function lo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ro=e}function ho(e){if(e!==ro)return!1;if(!io)return lo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=no)){if(co(e))throw po(),Error(o(418));for(;t;)so(e,t),t=ui(t.nextSibling)}if(lo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){no=ui(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}no=null}}else no=ro?ui(e.stateNode.nextSibling):null;return!0}function po(){for(var e=no;e;)e=ui(e.nextSibling)}function fo(){no=ro=null,io=!1}function go(e){null===oo?oo=[e]:oo.push(e)}var mo=E.ReactCurrentBatchConfig;function _o(e,t){if(e&&e.defaultProps){for(var r in t=x({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var vo=Ci(null),yo=null,Eo=null,So=null;function bo(){So=Eo=yo=null}function To(e){var t=vo.current;Ri(vo),e._currentValue=t}function Co(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ro(e,t){yo=e,So=Eo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ea=!0),e.firstContext=null)}function Oo(e){var t=e._currentValue;if(So!==e)if(e={context:e,memoizedValue:t,next:null},null===Eo){if(null===yo)throw Error(o(308));Eo=e,yo.dependencies={lanes:0,firstContext:e}}else Eo=Eo.next=e;return t}var ko=null;function Io(e){null===ko?ko=[e]:ko.push(e)}function Lo(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,Io(t)):(r.next=i.next,i.next=r),t.interleaved=r,wo(e,n)}function wo(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Ao=!1;function No(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Po(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Do(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Ic)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,wo(e,r)}return null===(i=n.interleaved)?(t.next=t,Io(n)):(t.next=i.next,i.next=t),n.interleaved=t,wo(e,r)}function Uo(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}function xo(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,o=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===o?i=o=s:o=o.next=s,r=r.next}while(null!==r);null===o?i=o=t:o=o.next=t}else i=o=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Bo(e,t,r,n){var i=e.updateQueue;Ao=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var c=a,u=c.next;c.next=null,null===s?o=u:s.next=u,s=c;var l=e.alternate;null!==l&&((a=(l=l.updateQueue).lastBaseUpdate)!==s&&(null===a?l.firstBaseUpdate=u:a.next=u,l.lastBaseUpdate=c))}if(null!==o){var d=i.baseState;for(s=0,l=u=c=null,a=o;;){var h=a.lane,p=a.eventTime;if((n&h)===h){null!==l&&(l=l.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(h=t,p=r,g.tag){case 1:if("function"===typeof(f=g.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=g.payload)?f.call(p,d,h):f)||void 0===h)break e;d=x({},d,h);break e;case 2:Ao=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===l?(u=l=p,c=d):l=l.next=p,s|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===l&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Uc|=s,e.lanes=s,e.memoizedState=d}}function jo(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(o(191,i));i.call(n)}}}var Ho=(new n.Component).refs;function Go(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:x({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var zo={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=eu(),i=tu(e),o=Mo(n,i);o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Do(e,o,i))&&(ru(t,e,i,n),Uo(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=eu(),i=tu(e),o=Mo(n,i);o.tag=1,o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Do(e,o,i))&&(ru(t,e,i,n),Uo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=eu(),n=tu(e),i=Mo(r,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Do(e,i,n))&&(ru(t,e,n,r),Uo(t,e,n))}};function qo(e,t,r,n,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!cn(r,n)||!cn(i,o))}function Vo(e,t,r){var n=!1,i=ki,o=t.contextType;return"object"===typeof o&&null!==o?o=Oo(o):(i=Ni(t)?wi:Ii.current,o=(n=null!==(n=t.contextTypes)&&void 0!==n)?Ai(e,i):ki),t=new t(r,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=zo,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Fo(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&zo.enqueueReplaceState(t,t.state,null)}function Zo(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=Ho,No(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Oo(o):(o=Ni(t)?wi:Ii.current,i.context=Ai(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Go(e,t,o,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&zo.enqueueReplaceState(i,i.state,null),Bo(e,r,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Wo(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(o(309));var n=r.stateNode}if(!n)throw Error(o(147,e));var i=n,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===Ho&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!r._owner)throw Error(o(290,e))}return e}function Yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qo(e){return(0,e._init)(e._payload)}function Ko(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pu(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,r,n){return null===t||6!==t.tag?((t=xu(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function u(e,t,r,n){var o=r.type;return o===T?d(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===N&&Qo(o)===t.type)?((n=i(t,r.props)).ref=Wo(e,t,r),n.return=e,n):((n=Mu(r.type,r.key,r.props,null,e.mode,n)).ref=Wo(e,t,r),n.return=e,n)}function l(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Bu(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function d(e,t,r,n,o){return null===t||7!==t.tag?((t=Du(r,e.mode,n,o)).return=e,t):((t=i(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=xu(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(r=Mu(t.type,t.key,t.props,null,e.mode,r)).ref=Wo(e,null,t),r.return=e,r;case b:return(t=Bu(t,e.mode,r)).return=e,t;case N:return h(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Du(t,e.mode,r,null)).return=e,t;Yo(e,t)}return null}function p(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==i?null:c(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case S:return r.key===i?u(e,t,r,n):null;case b:return r.key===i?l(e,t,r,n):null;case N:return p(e,t,(i=r._init)(r._payload),n)}if(te(r)||D(r))return null!==i?null:d(e,t,r,n,null);Yo(e,r)}return null}function f(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n)return c(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i);case b:return l(t,e=e.get(null===n.key?r:n.key)||null,n,i);case N:return f(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||D(n))return d(t,e=e.get(r)||null,n,i,null);Yo(t,n)}return null}function g(i,o,a,c){for(var u=null,l=null,d=o,g=o=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var _=p(i,d,a[g],c);if(null===_){null===d&&(d=m);break}e&&d&&null===_.alternate&&t(i,d),o=s(_,o,g),null===l?u=_:l.sibling=_,l=_,d=m}if(g===a.length)return r(i,d),io&&Xi(i,g),u;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],c))&&(o=s(d,o,g),null===l?u=d:l.sibling=d,l=d);return io&&Xi(i,g),u}for(d=n(i,d);g<a.length;g++)null!==(m=f(d,i,g,a[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),o=s(m,o,g),null===l?u=m:l.sibling=m,l=m);return e&&d.forEach((function(e){return t(i,e)})),io&&Xi(i,g),u}function m(i,a,c,u){var l=D(c);if("function"!==typeof l)throw Error(o(150));if(null==(c=l.call(c)))throw Error(o(151));for(var d=l=null,g=a,m=a=0,_=null,v=c.next();null!==g&&!v.done;m++,v=c.next()){g.index>m?(_=g,g=null):_=g.sibling;var y=p(i,g,v.value,u);if(null===y){null===g&&(g=_);break}e&&g&&null===y.alternate&&t(i,g),a=s(y,a,m),null===d?l=y:d.sibling=y,d=y,g=_}if(v.done)return r(i,g),io&&Xi(i,m),l;if(null===g){for(;!v.done;m++,v=c.next())null!==(v=h(i,v.value,u))&&(a=s(v,a,m),null===d?l=v:d.sibling=v,d=v);return io&&Xi(i,m),l}for(g=n(i,g);!v.done;m++,v=c.next())null!==(v=f(g,i,m,v.value,u))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=s(v,a,m),null===d?l=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(i,e)})),io&&Xi(i,m),l}return function e(n,o,s,c){if("object"===typeof s&&null!==s&&s.type===T&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case S:e:{for(var u=s.key,l=o;null!==l;){if(l.key===u){if((u=s.type)===T){if(7===l.tag){r(n,l.sibling),(o=i(l,s.props.children)).return=n,n=o;break e}}else if(l.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===N&&Qo(u)===l.type){r(n,l.sibling),(o=i(l,s.props)).ref=Wo(n,l,s),o.return=n,n=o;break e}r(n,l);break}t(n,l),l=l.sibling}s.type===T?((o=Du(s.props.children,n.mode,c,s.key)).return=n,n=o):((c=Mu(s.type,s.key,s.props,null,n.mode,c)).ref=Wo(n,o,s),c.return=n,n=c)}return a(n);case b:e:{for(l=s.key;null!==o;){if(o.key===l){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){r(n,o.sibling),(o=i(o,s.children||[])).return=n,n=o;break e}r(n,o);break}t(n,o),o=o.sibling}(o=Bu(s,n.mode,c)).return=n,n=o}return a(n);case N:return e(n,o,(l=s._init)(s._payload),c)}if(te(s))return g(n,o,s,c);if(D(s))return m(n,o,s,c);Yo(n,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(r(n,o.sibling),(o=i(o,s)).return=n,n=o):(r(n,o),(o=xu(s,n.mode,c)).return=n,n=o),a(n)):r(n,o)}}var Jo=Ko(!0),Xo=Ko(!1),$o={},es=Ci($o),ts=Ci($o),rs=Ci($o);function ns(e){if(e===$o)throw Error(o(174));return e}function is(e,t){switch(Oi(rs,t),Oi(ts,e),Oi(es,$o),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ri(es),Oi(es,t)}function os(){Ri(es),Ri(ts),Ri(rs)}function ss(e){ns(rs.current);var t=ns(es.current),r=ce(t,e.type);t!==r&&(Oi(ts,e),Oi(es,r))}function as(e){ts.current===e&&(Ri(es),Ri(ts))}var cs=Ci(0);function us(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ls=[];function ds(){for(var e=0;e<ls.length;e++)ls[e]._workInProgressVersionPrimary=null;ls.length=0}var hs=E.ReactCurrentDispatcher,ps=E.ReactCurrentBatchConfig,fs=0,gs=null,ms=null,_s=null,vs=!1,ys=!1,Es=0,Ss=0;function bs(){throw Error(o(321))}function Ts(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!an(e[r],t[r]))return!1;return!0}function Cs(e,t,r,n,i,s){if(fs=s,gs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?aa:ca,e=r(n,i),ys){s=0;do{if(ys=!1,Es=0,25<=s)throw Error(o(301));s+=1,_s=ms=null,t.updateQueue=null,hs.current=ua,e=r(n,i)}while(ys)}if(hs.current=sa,t=null!==ms&&null!==ms.next,fs=0,_s=ms=gs=null,vs=!1,t)throw Error(o(300));return e}function Rs(){var e=0!==Es;return Es=0,e}function Os(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===_s?gs.memoizedState=_s=e:_s=_s.next=e,_s}function ks(){if(null===ms){var e=gs.alternate;e=null!==e?e.memoizedState:null}else e=ms.next;var t=null===_s?gs.memoizedState:_s.next;if(null!==t)_s=t,ms=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ms=e).memoizedState,baseState:ms.baseState,baseQueue:ms.baseQueue,queue:ms.queue,next:null},null===_s?gs.memoizedState=_s=e:_s=_s.next=e}return _s}function Is(e,t){return"function"===typeof t?t(e):t}function Ls(e){var t=ks(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=ms,i=n.baseQueue,s=r.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(null!==i){s=i.next,n=n.baseState;var c=a=null,u=null,l=s;do{var d=l.lane;if((fs&d)===d)null!==u&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var h={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===u?(c=u=h,a=n):u=u.next=h,gs.lanes|=d,Uc|=d}l=l.next}while(null!==l&&l!==s);null===u?a=n:u.next=c,an(n,t.memoizedState)||(Ea=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=u,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{s=i.lane,gs.lanes|=s,Uc|=s,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ws(e){var t=ks(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);an(s,t.memoizedState)||(Ea=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function As(){}function Ns(e,t){var r=gs,n=ks(),i=t(),s=!an(n.memoizedState,i);if(s&&(n.memoizedState=i,Ea=!0),n=n.queue,Vs(Ds.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||null!==_s&&1&_s.memoizedState.tag){if(r.flags|=2048,js(9,Ms.bind(null,r,n,i,t),void 0,null),null===Lc)throw Error(o(349));0!==(30&fs)||Ps(r,t,i)}return i}function Ps(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ms(e,t,r,n){t.value=r,t.getSnapshot=n,Us(t)&&xs(e)}function Ds(e,t,r){return r((function(){Us(t)&&xs(e)}))}function Us(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!an(e,r)}catch(n){return!0}}function xs(e){var t=wo(e,1);null!==t&&ru(t,e,1,-1)}function Bs(e){var t=Os();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:e},t.queue=e,e=e.dispatch=ra.bind(null,gs,e),[t.memoizedState,e]}function js(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Hs(){return ks().memoizedState}function Gs(e,t,r,n){var i=Os();gs.flags|=e,i.memoizedState=js(1|t,r,void 0,void 0===n?null:n)}function zs(e,t,r,n){var i=ks();n=void 0===n?null:n;var o=void 0;if(null!==ms){var s=ms.memoizedState;if(o=s.destroy,null!==n&&Ts(n,s.deps))return void(i.memoizedState=js(t,r,o,n))}gs.flags|=e,i.memoizedState=js(1|t,r,o,n)}function qs(e,t){return Gs(8390656,8,e,t)}function Vs(e,t){return zs(2048,8,e,t)}function Fs(e,t){return zs(4,2,e,t)}function Zs(e,t){return zs(4,4,e,t)}function Ws(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ys(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,zs(4,4,Ws.bind(null,t,e),r)}function Qs(){}function Ks(e,t){var r=ks();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Ts(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Js(e,t){var r=ks();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Ts(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Xs(e,t,r){return 0===(21&fs)?(e.baseState&&(e.baseState=!1,Ea=!0),e.memoizedState=r):(an(r,t)||(r=gt(),gs.lanes|=r,Uc|=r,e.baseState=!0),t)}function $s(e,t){var r=yt;yt=0!==r&&4>r?r:4,e(!0);var n=ps.transition;ps.transition={};try{e(!1),t()}finally{yt=r,ps.transition=n}}function ea(){return ks().memoizedState}function ta(e,t,r){var n=tu(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},na(e))ia(t,r);else if(null!==(r=Lo(e,t,r,n))){ru(r,e,n,eu()),oa(r,t,n)}}function ra(e,t,r){var n=tu(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(na(e))ia(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,r);if(i.hasEagerState=!0,i.eagerState=a,an(a,s)){var c=t.interleaved;return null===c?(i.next=i,Io(t)):(i.next=c.next,c.next=i),void(t.interleaved=i)}}catch(u){}null!==(r=Lo(e,t,i,n))&&(ru(r,e,n,i=eu()),oa(r,t,n))}}function na(e){var t=e.alternate;return e===gs||null!==t&&t===gs}function ia(e,t){ys=vs=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function oa(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}var sa={readContext:Oo,useCallback:bs,useContext:bs,useEffect:bs,useImperativeHandle:bs,useInsertionEffect:bs,useLayoutEffect:bs,useMemo:bs,useReducer:bs,useRef:bs,useState:bs,useDebugValue:bs,useDeferredValue:bs,useTransition:bs,useMutableSource:bs,useSyncExternalStore:bs,useId:bs,unstable_isNewReconciler:!1},aa={readContext:Oo,useCallback:function(e,t){return Os().memoizedState=[e,void 0===t?null:t],e},useContext:Oo,useEffect:qs,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Gs(4194308,4,Ws.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Gs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gs(4,2,e,t)},useMemo:function(e,t){var r=Os();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Os();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ta.bind(null,gs,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Os().memoizedState=e},useState:Bs,useDebugValue:Qs,useDeferredValue:function(e){return Os().memoizedState=e},useTransition:function(){var e=Bs(!1),t=e[0];return e=$s.bind(null,e[1]),Os().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gs,i=Os();if(io){if(void 0===r)throw Error(o(407));r=r()}else{if(r=t(),null===Lc)throw Error(o(349));0!==(30&fs)||Ps(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,qs(Ds.bind(null,n,s,e),[e]),n.flags|=2048,js(9,Ms.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Os(),t=Lc.identifierPrefix;if(io){var r=Ji;t=":"+t+"R"+(r=(Ki&~(1<<32-st(Ki)-1)).toString(32)+r),0<(r=Es++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=Ss++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ca={readContext:Oo,useCallback:Ks,useContext:Oo,useEffect:Vs,useImperativeHandle:Ys,useInsertionEffect:Fs,useLayoutEffect:Zs,useMemo:Js,useReducer:Ls,useRef:Hs,useState:function(){return Ls(Is)},useDebugValue:Qs,useDeferredValue:function(e){return Xs(ks(),ms.memoizedState,e)},useTransition:function(){return[Ls(Is)[0],ks().memoizedState]},useMutableSource:As,useSyncExternalStore:Ns,useId:ea,unstable_isNewReconciler:!1},ua={readContext:Oo,useCallback:Ks,useContext:Oo,useEffect:Vs,useImperativeHandle:Ys,useInsertionEffect:Fs,useLayoutEffect:Zs,useMemo:Js,useReducer:ws,useRef:Hs,useState:function(){return ws(Is)},useDebugValue:Qs,useDeferredValue:function(e){var t=ks();return null===ms?t.memoizedState=e:Xs(t,ms.memoizedState,e)},useTransition:function(){return[ws(Is)[0],ks().memoizedState]},useMutableSource:As,useSyncExternalStore:Ns,useId:ea,unstable_isNewReconciler:!1};function la(e,t){try{var r="",n=t;do{r+=G(n),n=n.return}while(n);var i=r}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function da(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var pa="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,r){(r=Mo(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Vc||(Vc=!0,Fc=n),ha(0,t)},r}function ga(e,t,r){(r=Mo(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){ha(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(r.callback=function(){ha(0,t),"function"!==typeof n&&(null===Zc?Zc=new Set([this]):Zc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function ma(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new pa;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Ru.bind(null,e,t,r),t.then(e,e))}function _a(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,r,n,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Mo(-1,1)).tag=2,Do(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ya=E.ReactCurrentOwner,Ea=!1;function Sa(e,t,r,n){t.child=null===e?Xo(t,null,r,n):Jo(t,e.child,r,n)}function ba(e,t,r,n,i){r=r.render;var o=t.ref;return Ro(t,i),n=Cs(e,t,r,n,o,i),r=Rs(),null===e||Ea?(io&&r&&eo(t),t.flags|=1,Sa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Va(e,t,i))}function Ta(e,t,r,n,i){if(null===e){var o=r.type;return"function"!==typeof o||Nu(o)||void 0!==o.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Mu(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ca(e,t,o,n,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((r=null!==(r=r.compare)?r:cn)(s,n)&&e.ref===t.ref)return Va(e,t,i)}return t.flags|=1,(e=Pu(o,n)).ref=t.ref,e.return=t,t.child=e}function Ca(e,t,r,n,i){if(null!==e){var o=e.memoizedProps;if(cn(o,n)&&e.ref===t.ref){if(Ea=!1,t.pendingProps=n=o,0===(e.lanes&i))return t.lanes=e.lanes,Va(e,t,i);0!==(131072&e.flags)&&(Ea=!0)}}return ka(e,t,r,n,i)}function Ra(e,t,r){var n=t.pendingProps,i=n.children,o=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oi(Pc,Nc),Nc|=r;else{if(0===(1073741824&r))return e=null!==o?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Oi(Pc,Nc),Nc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:r,Oi(Pc,Nc),Nc|=n}else null!==o?(n=o.baseLanes|r,t.memoizedState=null):n=r,Oi(Pc,Nc),Nc|=n;return Sa(e,t,i,r),t.child}function Oa(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ka(e,t,r,n,i){var o=Ni(r)?wi:Ii.current;return o=Ai(t,o),Ro(t,i),r=Cs(e,t,r,n,o,i),n=Rs(),null===e||Ea?(io&&n&&eo(t),t.flags|=1,Sa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Va(e,t,i))}function Ia(e,t,r,n,i){if(Ni(r)){var o=!0;Ui(t)}else o=!1;if(Ro(t,i),null===t.stateNode)qa(e,t),Vo(t,r,n),Zo(t,r,n,i),n=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,u=r.contextType;"object"===typeof u&&null!==u?u=Oo(u):u=Ai(t,u=Ni(r)?wi:Ii.current);var l=r.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==n||c!==u)&&Fo(t,s,n,u),Ao=!1;var h=t.memoizedState;s.state=h,Bo(t,n,s,i),c=t.memoizedState,a!==n||h!==c||Li.current||Ao?("function"===typeof l&&(Go(t,r,l,n),c=t.memoizedState),(a=Ao||qo(t,r,a,n,h,c,u))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Po(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:_o(t.type,a),s.props=u,d=t.pendingProps,h=s.context,"object"===typeof(c=r.contextType)&&null!==c?c=Oo(c):c=Ai(t,c=Ni(r)?wi:Ii.current);var p=r.getDerivedStateFromProps;(l="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==d||h!==c)&&Fo(t,s,n,c),Ao=!1,h=t.memoizedState,s.state=h,Bo(t,n,s,i);var f=t.memoizedState;a!==d||h!==f||Li.current||Ao?("function"===typeof p&&(Go(t,r,p,n),f=t.memoizedState),(u=Ao||qo(t,r,u,n,h,f,c)||!1)?(l||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,f,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,f,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),s.props=n,s.state=f,s.context=c,n=u):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return La(e,t,r,n,o,i)}function La(e,t,r,n,i,o){Oa(e,t);var s=0!==(128&t.flags);if(!n&&!s)return i&&xi(t,r,!1),Va(e,t,o);n=t.stateNode,ya.current=t;var a=s&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Jo(t,e.child,null,o),t.child=Jo(t,null,a,o)):Sa(e,t,a,o),t.memoizedState=n.state,i&&xi(t,r,!0),t.child}function wa(e){var t=e.stateNode;t.pendingContext?Mi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mi(0,t.context,!1),is(e,t.containerInfo)}function Aa(e,t,r,n,i){return fo(),go(i),t.flags|=256,Sa(e,t,r,n),t.child}var Na,Pa,Ma,Da={dehydrated:null,treeContext:null,retryLane:0};function Ua(e){return{baseLanes:e,cachePool:null,transitions:null}}function xa(e,t,r){var n,i=t.pendingProps,s=cs.current,a=!1,c=0!==(128&t.flags);if((n=c)||(n=(null===e||null!==e.memoizedState)&&0!==(2&s)),n?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Oi(cs,1&s),null===e)return uo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=i.children,e=i.fallback,a?(i=t.mode,a=t.child,c={mode:"hidden",children:c},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Uu(c,i,0,null),e=Du(e,i,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ua(r),t.memoizedState=Da,e):Ba(t,c));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,r,n,i,s,a){if(r)return 256&t.flags?(t.flags&=-257,ja(e,t,a,n=da(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Uu({mode:"visible",children:n.children},i,0,null),(s=Du(s,i,a,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!==(1&t.mode)&&Jo(t,e.child,null,a),t.child.memoizedState=Ua(a),t.memoizedState=Da,s);if(0===(1&t.mode))return ja(e,t,a,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var c=n.dgst;return n=c,ja(e,t,a,n=da(s=Error(o(419)),n,void 0))}if(c=0!==(a&e.childLanes),Ea||c){if(null!==(n=Lc)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|a))?0:i)&&i!==s.retryLane&&(s.retryLane=i,wo(e,i),ru(n,e,i,-1))}return gu(),ja(e,t,a,n=da(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=ku.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,no=ui(i.nextSibling),ro=t,io=!0,oo=null,null!==e&&(Wi[Yi++]=Ki,Wi[Yi++]=Ji,Wi[Yi++]=Qi,Ki=e.id,Ji=e.overflow,Qi=t),(t=Ba(t,n.children)).flags|=4096,t)}(e,t,c,i,n,s,r);if(a){a=i.fallback,c=t.mode,n=(s=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&c)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=Pu(s,u)).subtreeFlags=14680064&s.subtreeFlags,null!==n?a=Pu(n,a):(a=Du(a,c,r,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,c=null===(c=e.child.memoizedState)?Ua(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~r,t.memoizedState=Da,i}return e=(a=e.child).sibling,i=Pu(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function Ba(e,t){return(t=Uu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ja(e,t,r,n){return null!==n&&go(n),Jo(t,e.child,null,r),(e=Ba(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ha(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Co(e.return,t,r)}function Ga(e,t,r,n,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function za(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(Sa(e,t,n.children,r),0!==(2&(n=cs.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ha(e,r,t);else if(19===e.tag)Ha(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Oi(cs,n),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===us(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Ga(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===us(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Ga(t,!0,r,null,o);break;case"together":Ga(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Va(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Uc|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(r=Pu(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Pu(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Fa(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Za(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Wa(e,t,r){var n=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Za(t),null;case 1:case 17:return Ni(t.type)&&Pi(),Za(t),null;case 3:return n=t.stateNode,os(),Ri(Li),Ri(Ii),ds(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(su(oo),oo=null))),Za(t),null;case 5:as(t);var i=ns(rs.current);if(r=t.type,null!==e&&null!=t.stateNode)Pa(e,t,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(o(166));return Za(t),null}if(e=ns(es.current),ho(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[hi]=t,n[pi]=s,e=0!==(1&t.mode),r){case"dialog":jn("cancel",n),jn("close",n);break;case"iframe":case"object":case"embed":jn("load",n);break;case"video":case"audio":for(i=0;i<Dn.length;i++)jn(Dn[i],n);break;case"source":jn("error",n);break;case"img":case"image":case"link":jn("error",n),jn("load",n);break;case"details":jn("toggle",n);break;case"input":K(n,s),jn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},jn("invalid",n);break;case"textarea":ie(n,s),jn("invalid",n)}for(var c in ve(r,s),i=null,s)if(s.hasOwnProperty(c)){var u=s[c];"children"===c?"string"===typeof u?n.textContent!==u&&(!0!==s.suppressHydrationWarning&&Xn(n.textContent,u,e),i=["children",u]):"number"===typeof u&&n.textContent!==""+u&&(!0!==s.suppressHydrationWarning&&Xn(n.textContent,u,e),i=["children",""+u]):a.hasOwnProperty(c)&&null!=u&&"onScroll"===c&&jn("scroll",n)}switch(r){case"input":Z(n),$(n,s,!0);break;case"textarea":Z(n),se(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=$n)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{c=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=c.createElement(r,{is:n.is}):(e=c.createElement(r),"select"===r&&(c=e,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):e=c.createElementNS(e,r),e[hi]=t,e[pi]=n,Na(e,t),t.stateNode=e;e:{switch(c=ye(r,n),r){case"dialog":jn("cancel",e),jn("close",e),i=n;break;case"iframe":case"object":case"embed":jn("load",e),i=n;break;case"video":case"audio":for(i=0;i<Dn.length;i++)jn(Dn[i],e);i=n;break;case"source":jn("error",e),i=n;break;case"img":case"image":case"link":jn("error",e),jn("load",e),i=n;break;case"details":jn("toggle",e),i=n;break;case"input":K(e,n),i=Q(e,n),jn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=x({},n,{value:void 0}),jn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),jn("invalid",e)}for(s in ve(r,i),u=i)if(u.hasOwnProperty(s)){var l=u[s];"style"===s?me(e,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&de(e,l):"children"===s?"string"===typeof l?("textarea"!==r||""!==l)&&he(e,l):"number"===typeof l&&he(e,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=l&&"onScroll"===s&&jn("scroll",e):null!=l&&y(e,s,l,c))}switch(r){case"input":Z(e),$(e,n,!1);break;case"textarea":Z(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+V(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?re(e,!!n.multiple,s,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$n)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Za(t),null;case 6:if(e&&null!=t.stateNode)Ma(0,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));if(r=ns(rs.current),ns(es.current),ho(t)){if(n=t.stateNode,r=t.memoizedProps,n[hi]=t,(s=n.nodeValue!==r)&&null!==(e=ro))switch(e.tag){case 3:Xn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xn(n.nodeValue,r,0!==(1&e.mode))}s&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[hi]=t,t.stateNode=n}return Za(t),null;case 13:if(Ri(cs),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==no&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,s=!1;else if(s=ho(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[hi]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Za(t),s=!1}else null!==oo&&(su(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&cs.current)?0===Mc&&(Mc=3):gu())),null!==t.updateQueue&&(t.flags|=4),Za(t),null);case 4:return os(),null===e&&zn(t.stateNode.containerInfo),Za(t),null;case 10:return To(t.type._context),Za(t),null;case 19:if(Ri(cs),null===(s=t.memoizedState))return Za(t),null;if(n=0!==(128&t.flags),null===(c=s.rendering))if(n)Fa(s,!1);else{if(0!==Mc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=us(e))){for(t.flags|=128,Fa(s,!1),null!==(n=c.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Oi(cs,1&cs.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>zc&&(t.flags|=128,n=!0,Fa(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=us(c))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Fa(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!io)return Za(t),null}else 2*Je()-s.renderingStartTime>zc&&1073741824!==r&&(t.flags|=128,n=!0,Fa(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(r=s.last)?r.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,r=cs.current,Oi(cs,n?1&r|2:1&r),t):(Za(t),null);case 22:case 23:return du(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Nc)&&(Za(t),6&t.subtreeFlags&&(t.flags|=8192)):Za(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ya(e,t){switch(to(t),t.tag){case 1:return Ni(t.type)&&Pi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return os(),Ri(Li),Ri(Ii),ds(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return as(t),null;case 13:if(Ri(cs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ri(cs),null;case 4:return os(),null;case 10:return To(t.type._context),null;case 22:case 23:return du(),null;default:return null}}Na=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Pa=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ns(es.current);var o,s=null;switch(r){case"input":i=Q(e,i),n=Q(e,n),s=[];break;case"select":i=x({},i,{value:void 0}),n=x({},n,{value:void 0}),s=[];break;case"textarea":i=ne(e,i),n=ne(e,n),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof n.onClick&&(e.onclick=$n)}for(l in ve(r,n),r=null,i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var c=i[l];for(o in c)c.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(a.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var u=n[l];if(c=null!=i?i[l]:void 0,n.hasOwnProperty(l)&&u!==c&&(null!=u||null!=c))if("style"===l)if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(s||(s=[]),s.push(l,r)),r=u;else"dangerouslySetInnerHTML"===l?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(s=s||[]).push(l,u)):"children"===l?"string"!==typeof u&&"number"!==typeof u||(s=s||[]).push(l,""+u):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(a.hasOwnProperty(l)?(null!=u&&"onScroll"===l&&jn("scroll",e),s||c===u||(s=[])):(s=s||[]).push(l,u))}r&&(s=s||[]).push("style",r);var l=s;(t.updateQueue=l)&&(t.flags|=4)}},Ma=function(e,t,r,n){r!==n&&(t.flags|=4)};var Qa=!1,Ka=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Xa=null;function $a(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Cu(e,t,n)}else r.current=null}function ec(e,t,r){try{r()}catch(n){Cu(e,t,n)}}var tc=!1;function rc(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&ec(t,r,o)}i=i.next}while(i!==n)}}function nc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ic(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function oc(e){var t=e.alternate;null!==t&&(e.alternate=null,oc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[gi],delete t[mi],delete t[_i])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sc(e){return 5===e.tag||3===e.tag||4===e.tag}function ac(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=$n));else if(4!==n&&null!==(e=e.child))for(cc(e,t,r),e=e.sibling;null!==e;)cc(e,t,r),e=e.sibling}function uc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(uc(e,t,r),e=e.sibling;null!==e;)uc(e,t,r),e=e.sibling}var lc=null,dc=!1;function hc(e,t,r){for(r=r.child;null!==r;)pc(e,t,r),r=r.sibling}function pc(e,t,r){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,r)}catch(a){}switch(r.tag){case 5:Ka||$a(r,t);case 6:var n=lc,i=dc;lc=null,hc(e,t,r),dc=i,null!==(lc=n)&&(dc?(e=lc,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):lc.removeChild(r.stateNode));break;case 18:null!==lc&&(dc?(e=lc,r=r.stateNode,8===e.nodeType?ci(e.parentNode,r):1===e.nodeType&&ci(e,r),zt(e)):ci(lc,r.stateNode));break;case 4:n=lc,i=dc,lc=r.stateNode.containerInfo,dc=!0,hc(e,t,r),lc=n,dc=i;break;case 0:case 11:case 14:case 15:if(!Ka&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&ec(r,t,s),i=i.next}while(i!==n)}hc(e,t,r);break;case 1:if(!Ka&&($a(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Cu(r,t,a)}hc(e,t,r);break;case 21:hc(e,t,r);break;case 22:1&r.mode?(Ka=(n=Ka)||null!==r.memoizedState,hc(e,t,r),Ka=n):hc(e,t,r);break;default:hc(e,t,r)}}function fc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Ja),t.forEach((function(t){var n=Iu.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function gc(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:lc=c.stateNode,dc=!1;break e;case 3:case 4:lc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===lc)throw Error(o(160));pc(s,a,i),lc=null,dc=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(l){Cu(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mc(t,e),t=t.sibling}function mc(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),_c(e),4&n){try{rc(3,e,e.return),nc(3,e)}catch(m){Cu(e,e.return,m)}try{rc(5,e,e.return)}catch(m){Cu(e,e.return,m)}}break;case 1:gc(t,e),_c(e),512&n&&null!==r&&$a(r,r.return);break;case 5:if(gc(t,e),_c(e),512&n&&null!==r&&$a(r,r.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(m){Cu(e,e.return,m)}}if(4&n&&null!=(i=e.stateNode)){var s=e.memoizedProps,a=null!==r?r.memoizedProps:s,c=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===c&&"radio"===s.type&&null!=s.name&&J(i,s),ye(c,a);var l=ye(c,s);for(a=0;a<u.length;a+=2){var d=u[a],h=u[a+1];"style"===d?me(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):y(i,d,h,l)}switch(c){case"input":X(i,s);break;case"textarea":oe(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?re(i,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?re(i,!!s.multiple,s.defaultValue,!0):re(i,!!s.multiple,s.multiple?[]:"",!1))}i[pi]=s}catch(m){Cu(e,e.return,m)}}break;case 6:if(gc(t,e),_c(e),4&n){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Cu(e,e.return,m)}}break;case 3:if(gc(t,e),_c(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(m){Cu(e,e.return,m)}break;case 4:default:gc(t,e),_c(e);break;case 13:gc(t,e),_c(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Gc=Je())),4&n&&fc(e);break;case 22:if(d=null!==r&&null!==r.memoizedState,1&e.mode?(Ka=(l=Ka)||d,gc(t,e),Ka=l):gc(t,e),_c(e),8192&n){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!d&&0!==(1&e.mode))for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(f=(p=Xa).child,p.tag){case 0:case 11:case 14:case 15:rc(4,p,p.return);break;case 1:$a(p,p.return);var g=p.stateNode;if("function"===typeof g.componentWillUnmount){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Cu(n,r,m)}}break;case 5:$a(p,p.return);break;case 22:if(null!==p.memoizedState){Sc(h);continue}}null!==f?(f.return=p,Xa=f):Sc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,l?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=h.stateNode,a=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,c.style.display=ge("display",a))}catch(m){Cu(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(m){Cu(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gc(t,e),_c(e),4&n&&fc(e);case 21:}}function _c(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(sc(r)){var n=r;break e}r=r.return}throw Error(o(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(he(i,""),n.flags&=-33),uc(e,ac(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;cc(e,ac(e),s);break;default:throw Error(o(161))}}catch(a){Cu(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vc(e,t,r){Xa=e,yc(e,t,r)}function yc(e,t,r){for(var n=0!==(1&e.mode);null!==Xa;){var i=Xa,o=i.child;if(22===i.tag&&n){var s=null!==i.memoizedState||Qa;if(!s){var a=i.alternate,c=null!==a&&null!==a.memoizedState||Ka;a=Qa;var u=Ka;if(Qa=s,(Ka=c)&&!u)for(Xa=i;null!==Xa;)c=(s=Xa).child,22===s.tag&&null!==s.memoizedState?bc(i):null!==c?(c.return=s,Xa=c):bc(i);for(;null!==o;)Xa=o,yc(o,t,r),o=o.sibling;Xa=i,Qa=a,Ka=u}Ec(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Xa=o):Ec(e)}}function Ec(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ka||nc(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ka)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:_o(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&jo(t,s,n);break;case 3:var a=t.updateQueue;if(null!==a){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}jo(t,a,r)}break;case 5:var c=t.stateNode;if(null===r&&4&t.flags){r=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var d=l.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(o(163))}Ka||512&t.flags&&ic(t)}catch(p){Cu(t,t.return,p)}}if(t===e){Xa=null;break}if(null!==(r=t.sibling)){r.return=t.return,Xa=r;break}Xa=t.return}}function Sc(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Xa=r;break}Xa=t.return}}function bc(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nc(4,t)}catch(c){Cu(t,r,c)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(c){Cu(t,i,c)}}var o=t.return;try{ic(t)}catch(c){Cu(t,o,c)}break;case 5:var s=t.return;try{ic(t)}catch(c){Cu(t,s,c)}}}catch(c){Cu(t,t.return,c)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var Tc,Cc=Math.ceil,Rc=E.ReactCurrentDispatcher,Oc=E.ReactCurrentOwner,kc=E.ReactCurrentBatchConfig,Ic=0,Lc=null,wc=null,Ac=0,Nc=0,Pc=Ci(0),Mc=0,Dc=null,Uc=0,xc=0,Bc=0,jc=null,Hc=null,Gc=0,zc=1/0,qc=null,Vc=!1,Fc=null,Zc=null,Wc=!1,Yc=null,Qc=0,Kc=0,Jc=null,Xc=-1,$c=0;function eu(){return 0!==(6&Ic)?Je():-1!==Xc?Xc:Xc=Je()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Ic)&&0!==Ac?Ac&-Ac:null!==mo.transition?(0===$c&&($c=gt()),$c):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function ru(e,t,r,n){if(50<Kc)throw Kc=0,Jc=null,Error(o(185));_t(e,r,n),0!==(2&Ic)&&e===Lc||(e===Lc&&(0===(2&Ic)&&(xc|=r),4===Mc&&au(e,Ac)),nu(e,n),1===r&&0===Ic&&0===(1&t.mode)&&(zc=Je()+500,ji&&zi()))}function nu(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,c=i[s];-1===c?0!==(a&r)&&0===(a&n)||(i[s]=pt(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var n=ht(e,e===Lc?Ac:0);if(0===n)null!==r&&Ye(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ye(r),1===t)0===e.tag?function(e){ji=!0,Gi(e)}(cu.bind(null,e)):Gi(cu.bind(null,e)),si((function(){0===(6&Ic)&&zi()})),r=null;else{switch(Et(n)){case 1:r=$e;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Lu(r,iu.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function iu(e,t){if(Xc=-1,$c=0,0!==(6&Ic))throw Error(o(327));var r=e.callbackNode;if(bu()&&e.callbackNode!==r)return null;var n=ht(e,e===Lc?Ac:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=mu(e,n);else{t=n;var i=Ic;Ic|=2;var s=fu();for(Lc===e&&Ac===t||(qc=null,zc=Je()+500,hu(e,t));;)try{vu();break}catch(c){pu(e,c)}bo(),Rc.current=s,Ic=i,null!==wc?t=0:(Lc=null,Ac=0,t=Mc)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(n=i,t=ou(e,i))),1===t)throw r=Dc,hu(e,0),au(e,n),nu(e,Je()),r;if(6===t)au(e,n);else{if(i=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!an(o(),i))return!1}catch(a){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mu(e,n))&&(0!==(s=ft(e))&&(n=s,t=ou(e,s))),1===t))throw r=Dc,hu(e,0),au(e,n),nu(e,Je()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(o(345));case 2:case 5:Su(e,Hc,qc);break;case 3:if(au(e,n),(130023424&n)===n&&10<(t=Gc+500-Je())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&n)!==n){eu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(Su.bind(null,e,Hc,qc),t);break}Su(e,Hc,qc);break;case 4:if(au(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-st(n);s=1<<a,(a=t[a])>i&&(i=a),n&=~s}if(n=i,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Cc(n/1960))-n)){e.timeoutHandle=ni(Su.bind(null,e,Hc,qc),n);break}Su(e,Hc,qc);break;default:throw Error(o(329))}}}return nu(e,Je()),e.callbackNode===r?iu.bind(null,e):null}function ou(e,t){var r=jc;return e.current.memoizedState.isDehydrated&&(hu(e,t).flags|=256),2!==(e=mu(e,t))&&(t=Hc,Hc=r,null!==t&&su(t)),e}function su(e){null===Hc?Hc=e:Hc.push.apply(Hc,e)}function au(e,t){for(t&=~Bc,t&=~xc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-st(t),n=1<<r;e[r]=-1,t&=~n}}function cu(e){if(0!==(6&Ic))throw Error(o(327));bu();var t=ht(e,0);if(0===(1&t))return nu(e,Je()),null;var r=mu(e,t);if(0!==e.tag&&2===r){var n=ft(e);0!==n&&(t=n,r=ou(e,n))}if(1===r)throw r=Dc,hu(e,0),au(e,t),nu(e,Je()),r;if(6===r)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Su(e,Hc,qc),nu(e,Je()),null}function uu(e,t){var r=Ic;Ic|=1;try{return e(t)}finally{0===(Ic=r)&&(zc=Je()+500,ji&&zi())}}function lu(e){null!==Yc&&0===Yc.tag&&0===(6&Ic)&&bu();var t=Ic;Ic|=1;var r=kc.transition,n=yt;try{if(kc.transition=null,yt=1,e)return e()}finally{yt=n,kc.transition=r,0===(6&(Ic=t))&&zi()}}function du(){Nc=Pc.current,Ri(Pc)}function hu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==wc)for(r=wc.return;null!==r;){var n=r;switch(to(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Pi();break;case 3:os(),Ri(Li),Ri(Ii),ds();break;case 5:as(n);break;case 4:os();break;case 13:case 19:Ri(cs);break;case 10:To(n.type._context);break;case 22:case 23:du()}r=r.return}if(Lc=e,wc=e=Pu(e.current,null),Ac=Nc=t,Mc=0,Dc=null,Bc=xc=Uc=0,Hc=jc=null,null!==ko){for(t=0;t<ko.length;t++)if(null!==(n=(r=ko[t]).interleaved)){r.interleaved=null;var i=n.next,o=r.pending;if(null!==o){var s=o.next;o.next=i,n.next=s}r.pending=n}ko=null}return e}function pu(e,t){for(;;){var r=wc;try{if(bo(),hs.current=sa,vs){for(var n=gs.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}vs=!1}if(fs=0,_s=ms=gs=null,ys=!1,Es=0,Oc.current=null,null===r||null===r.return){Mc=1,Dc=t,wc=null;break}e:{var s=e,a=r.return,c=r,u=t;if(t=Ac,c.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var l=u,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=_a(a);if(null!==f){f.flags&=-257,va(f,a,c,0,t),1&f.mode&&ma(s,l,t),u=l;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(u),t.updateQueue=m}else g.add(u);break e}if(0===(1&t)){ma(s,l,t),gu();break e}u=Error(o(426))}else if(io&&1&c.mode){var _=_a(a);if(null!==_){0===(65536&_.flags)&&(_.flags|=256),va(_,a,c,0,t),go(la(u,c));break e}}s=u=la(u,c),4!==Mc&&(Mc=2),null===jc?jc=[s]:jc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,xo(s,fa(0,u,t));break e;case 1:c=u;var v=s.type,y=s.stateNode;if(0===(128&s.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Zc||!Zc.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t,xo(s,ga(s,c,t));break e}}s=s.return}while(null!==s)}Eu(r)}catch(E){t=E,wc===r&&null!==r&&(wc=r=r.return);continue}break}}function fu(){var e=Rc.current;return Rc.current=sa,null===e?sa:e}function gu(){0!==Mc&&3!==Mc&&2!==Mc||(Mc=4),null===Lc||0===(268435455&Uc)&&0===(268435455&xc)||au(Lc,Ac)}function mu(e,t){var r=Ic;Ic|=2;var n=fu();for(Lc===e&&Ac===t||(qc=null,hu(e,t));;)try{_u();break}catch(i){pu(e,i)}if(bo(),Ic=r,Rc.current=n,null!==wc)throw Error(o(261));return Lc=null,Ac=0,Mc}function _u(){for(;null!==wc;)yu(wc)}function vu(){for(;null!==wc&&!Qe();)yu(wc)}function yu(e){var t=Tc(e.alternate,e,Nc);e.memoizedProps=e.pendingProps,null===t?Eu(e):wc=t,Oc.current=null}function Eu(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Wa(r,t,Nc)))return void(wc=r)}else{if(null!==(r=Ya(r,t)))return r.flags&=32767,void(wc=r);if(null===e)return Mc=6,void(wc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(wc=t);wc=t=e}while(null!==t);0===Mc&&(Mc=5)}function Su(e,t,r){var n=yt,i=kc.transition;try{kc.transition=null,yt=1,function(e,t,r,n){do{bu()}while(null!==Yc);if(0!==(6&Ic))throw Error(o(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-st(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}(e,s),e===Lc&&(wc=Lc=null,Ac=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Wc||(Wc=!0,Lu(tt,(function(){return bu(),null}))),s=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||s){s=kc.transition,kc.transition=null;var a=yt;yt=1;var c=Ic;Ic|=4,Oc.current=null,function(e,t){if(ei=Vt,pn(e=hn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(S){r=null;break e}var a=0,c=-1,u=-1,l=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==r||0!==i&&3!==h.nodeType||(c=a+i),h!==s||0!==n&&3!==h.nodeType||(u=a+n),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===r&&++l===i&&(c=a),p===s&&++d===n&&(u=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}r=-1===c||-1===u?null:{start:c,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},Vt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,_=g.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:_o(t.type,m),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var E=t.stateNode.containerInfo;1===E.nodeType?E.textContent="":9===E.nodeType&&E.documentElement&&E.removeChild(E.documentElement);break;default:throw Error(o(163))}}catch(S){Cu(t,t.return,S)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}g=tc,tc=!1}(e,r),mc(r,e),fn(ti),Vt=!!ei,ti=ei=null,e.current=r,vc(r,e,i),Ke(),Ic=c,yt=a,kc.transition=s}else e.current=r;if(Wc&&(Wc=!1,Yc=e,Qc=i),0===(s=e.pendingLanes)&&(Zc=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nu(e,Je()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n((i=t[r]).value,{componentStack:i.stack,digest:i.digest});if(Vc)throw Vc=!1,e=Fc,Fc=null,e;0!==(1&Qc)&&0!==e.tag&&bu(),0!==(1&(s=e.pendingLanes))?e===Jc?Kc++:(Kc=0,Jc=e):Kc=0,zi()}(e,t,r,n)}finally{kc.transition=i,yt=n}return null}function bu(){if(null!==Yc){var e=Et(Qc),t=kc.transition,r=yt;try{if(kc.transition=null,yt=16>e?16:e,null===Yc)var n=!1;else{if(e=Yc,Yc=null,Qc=0,0!==(6&Ic))throw Error(o(331));var i=Ic;for(Ic|=4,Xa=e.current;null!==Xa;){var s=Xa,a=s.child;if(0!==(16&Xa.flags)){var c=s.deletions;if(null!==c){for(var u=0;u<c.length;u++){var l=c[u];for(Xa=l;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:rc(8,d,s)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var p=(d=Xa).sibling,f=d.return;if(oc(d),d===l){Xa=null;break}if(null!==p){p.return=f,Xa=p;break}Xa=f}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(null!==m)}}Xa=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(s=Xa).flags))switch(s.tag){case 0:case 11:case 15:rc(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Xa=v;break e}Xa=s.return}}var y=e.current;for(Xa=y;null!==Xa;){var E=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==E)E.return=a,Xa=E;else e:for(a=y;null!==Xa;){if(0!==(2048&(c=Xa).flags))try{switch(c.tag){case 0:case 11:case 15:nc(9,c)}}catch(b){Cu(c,c.return,b)}if(c===a){Xa=null;break e}var S=c.sibling;if(null!==S){S.return=c.return,Xa=S;break e}Xa=c.return}}if(Ic=i,zi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(b){}n=!0}return n}finally{yt=r,kc.transition=t}}return!1}function Tu(e,t,r){e=Do(e,t=fa(0,t=la(r,t),1),1),t=eu(),null!==e&&(_t(e,1,t),nu(e,t))}function Cu(e,t,r){if(3===e.tag)Tu(e,e,r);else for(;null!==t;){if(3===t.tag){Tu(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Zc||!Zc.has(n))){t=Do(t,e=ga(t,e=la(r,e),1),1),e=eu(),null!==t&&(_t(t,1,e),nu(t,e));break}}t=t.return}}function Ru(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&r,Lc===e&&(Ac&r)===r&&(4===Mc||3===Mc&&(130023424&Ac)===Ac&&500>Je()-Gc?hu(e,0):Bc|=r),nu(e,t)}function Ou(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var r=eu();null!==(e=wo(e,t))&&(_t(e,t,r),nu(e,r))}function ku(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ou(e,r)}function Iu(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(o(314))}null!==n&&n.delete(t),Ou(e,r)}function Lu(e,t){return We(e,t)}function wu(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Au(e,t,r,n){return new wu(e,t,r,n)}function Nu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pu(e,t){var r=e.alternate;return null===r?((r=Au(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Mu(e,t,r,n,i,s){var a=2;if(n=e,"function"===typeof e)Nu(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case T:return Du(r.children,i,s,t);case C:a=8,i|=8;break;case R:return(e=Au(12,r,t,2|i)).elementType=R,e.lanes=s,e;case L:return(e=Au(13,r,t,i)).elementType=L,e.lanes=s,e;case w:return(e=Au(19,r,t,i)).elementType=w,e.lanes=s,e;case P:return Uu(r,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case O:a=10;break e;case k:a=9;break e;case I:a=11;break e;case A:a=14;break e;case N:a=16,n=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Au(a,r,t,i)).elementType=e,t.type=n,t.lanes=s,t}function Du(e,t,r,n){return(e=Au(7,e,n,t)).lanes=r,e}function Uu(e,t,r,n){return(e=Au(22,e,n,t)).elementType=P,e.lanes=r,e.stateNode={isHidden:!1},e}function xu(e,t,r){return(e=Au(6,e,null,t)).lanes=r,e}function Bu(e,t,r){return(t=Au(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ju(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Hu(e,t,r,n,i,o,s,a,c){return e=new ju(e,t,r,a,c),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Au(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},No(o),e}function Gu(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}function zu(e){if(!e)return ki;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ni(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var r=e.type;if(Ni(r))return Di(e,r,t)}return t}function qu(e,t,r,n,i,o,s,a,c){return(e=Hu(r,n,!0,e,0,o,0,a,c)).context=zu(null),r=e.current,(o=Mo(n=eu(),i=tu(r))).callback=void 0!==t&&null!==t?t:null,Do(r,o,i),e.current.lanes=i,_t(e,i,n),nu(e,n),e}function Vu(e,t,r,n){var i=t.current,o=eu(),s=tu(i);return r=zu(r),null===t.context?t.context=r:t.pendingContext=r,(t=Mo(o,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Do(i,t,s))&&(ru(e,i,s,o),Uo(e,i,s)),s}function Fu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Zu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Wu(e,t){Zu(e,t),(e=e.alternate)&&Zu(e,t)}Tc=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Li.current)Ea=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return Ea=!1,function(e,t,r){switch(t.tag){case 3:wa(t),fo();break;case 5:ss(t);break;case 1:Ni(t.type)&&Ui(t);break;case 4:is(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Oi(vo,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Oi(cs,1&cs.current),t.flags|=128,null):0!==(r&t.child.childLanes)?xa(e,t,r):(Oi(cs,1&cs.current),null!==(e=Va(e,t,r))?e.sibling:null);Oi(cs,1&cs.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return za(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Oi(cs,cs.current),n)break;return null;case 22:case 23:return t.lanes=0,Ra(e,t,r)}return Va(e,t,r)}(e,t,r);Ea=0!==(131072&e.flags)}else Ea=!1,io&&0!==(1048576&t.flags)&&$i(t,Zi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;qa(e,t),e=t.pendingProps;var i=Ai(t,Ii.current);Ro(t,r),i=Cs(null,t,n,e,i,r);var s=Rs();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ni(n)?(s=!0,Ui(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,No(t),i.updater=zo,t.stateNode=i,i._reactInternals=t,Zo(t,n,e,r),t=La(null,t,n,!0,s,r)):(t.tag=0,io&&s&&eo(t),Sa(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(qa(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"===typeof e)return Nu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===A)return 14}return 2}(n),e=_o(n,e),i){case 0:t=ka(null,t,n,e,r);break e;case 1:t=Ia(null,t,n,e,r);break e;case 11:t=ba(null,t,n,e,r);break e;case 14:t=Ta(null,t,n,_o(n.type,e),r);break e}throw Error(o(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,ka(e,t,n,i=t.elementType===n?i:_o(n,i),r);case 1:return n=t.type,i=t.pendingProps,Ia(e,t,n,i=t.elementType===n?i:_o(n,i),r);case 3:e:{if(wa(t),null===e)throw Error(o(387));n=t.pendingProps,i=(s=t.memoizedState).element,Po(e,t),Bo(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Aa(e,t,n,r,i=la(Error(o(423)),t));break e}if(n!==i){t=Aa(e,t,n,r,i=la(Error(o(424)),t));break e}for(no=ui(t.stateNode.containerInfo.firstChild),ro=t,io=!0,oo=null,r=Xo(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fo(),n===i){t=Va(e,t,r);break e}Sa(e,t,n,r)}t=t.child}return t;case 5:return ss(t),null===e&&uo(t),n=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,a=i.children,ri(n,i)?a=null:null!==s&&ri(n,s)&&(t.flags|=32),Oa(e,t),Sa(e,t,a,r),t.child;case 6:return null===e&&uo(t),null;case 13:return xa(e,t,r);case 4:return is(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Jo(t,null,n,r):Sa(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,ba(e,t,n,i=t.elementType===n?i:_o(n,i),r);case 7:return Sa(e,t,t.pendingProps,r),t.child;case 8:case 12:return Sa(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Oi(vo,n._currentValue),n._currentValue=a,null!==s)if(an(s.value,a)){if(s.children===i.children&&!Li.current){t=Va(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){a=s.child;for(var u=c.firstContext;null!==u;){if(u.context===n){if(1===s.tag){(u=Mo(-1,r&-r)).tag=2;var l=s.updateQueue;if(null!==l){var d=(l=l.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),l.pending=u}}s.lanes|=r,null!==(u=s.alternate)&&(u.lanes|=r),Co(s.return,r,t),c.lanes|=r;break}u=u.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=r,null!==(c=a.alternate)&&(c.lanes|=r),Co(a,r,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}Sa(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ro(t,r),n=n(i=Oo(i)),t.flags|=1,Sa(e,t,n,r),t.child;case 14:return i=_o(n=t.type,t.pendingProps),Ta(e,t,n,i=_o(n.type,i),r);case 15:return Ca(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:_o(n,i),qa(e,t),t.tag=1,Ni(n)?(e=!0,Ui(t)):e=!1,Ro(t,r),Vo(t,n,i),Zo(t,n,i,r),La(null,t,n,!0,e,r);case 19:return za(e,t,r);case 22:return Ra(e,t,r)}throw Error(o(156,t.tag))};var Yu="function"===typeof reportError?reportError:function(e){console.error(e)};function Qu(e){this._internalRoot=e}function Ku(e){this._internalRoot=e}function Ju(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $u(){}function el(e,t,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if("function"===typeof i){var a=i;i=function(){var e=Fu(s);a.call(e)}}Vu(t,s,e,i)}else s=function(e,t,r,n,i){if(i){if("function"===typeof n){var o=n;n=function(){var e=Fu(s);o.call(e)}}var s=qu(t,n,e,0,null,!1,0,"",$u);return e._reactRootContainer=s,e[fi]=s.current,zn(8===e.nodeType?e.parentNode:e),lu(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof n){var a=n;n=function(){var e=Fu(c);a.call(e)}}var c=Hu(e,0,!1,null,0,!1,0,"",$u);return e._reactRootContainer=c,e[fi]=c.current,zn(8===e.nodeType?e.parentNode:e),lu((function(){Vu(t,c,r,n)})),c}(r,t,e,i,n);return Fu(s)}Ku.prototype.render=Qu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Vu(e,t,null,null)},Ku.prototype.unmount=Qu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;lu((function(){Vu(null,e,null,null)})),t[fi]=null}},Ku.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pt.length&&0!==t&&t<Pt[r].priority;r++);Pt.splice(r,0,e),0===r&&xt(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=dt(t.pendingLanes);0!==r&&(vt(t,1|r),nu(t,Je()),0===(6&Ic)&&(zc=Je()+500,zi()))}break;case 13:lu((function(){var t=wo(e,1);if(null!==t){var r=eu();ru(t,e,1,r)}})),Wu(e,1)}},bt=function(e){if(13===e.tag){var t=wo(e,134217728);if(null!==t)ru(t,e,134217728,eu());Wu(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tu(e),r=wo(e,t);if(null!==r)ru(r,e,t,eu());Wu(e,t)}},Ct=function(){return yt},Rt=function(e,t){var r=yt;try{return yt=e,t()}finally{yt=r}},be=function(e,t,r){switch(t){case"input":if(X(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Si(n);if(!i)throw Error(o(90));W(n),X(n,i)}}}break;case"textarea":oe(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ie=uu,Le=lu;var tl={usingClientEntryPoint:!1,Events:[yi,Ei,Si,Oe,ke,uu]},rl={findFiberByHostInstance:vi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nl={bundleType:rl.bundleType,version:rl.version,rendererPackageName:rl.rendererPackageName,rendererConfig:rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Fe(e))?null:e.stateNode},findFiberByHostInstance:rl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{it=il.inject(nl),ot=il}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ju(t))throw Error(o(200));return Gu(e,t,null,r)},t.createRoot=function(e,t){if(!Ju(e))throw Error(o(299));var r=!1,n="",i=Yu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Hu(e,1,!1,null,0,r,0,n,i),e[fi]=t.current,zn(8===e.nodeType?e.parentNode:e),new Qu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Fe(t))?null:e.stateNode},t.flushSync=function(e){return lu(e)},t.hydrate=function(e,t,r){if(!Xu(t))throw Error(o(200));return el(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Ju(e))throw Error(o(405));var n=null!=r&&r.hydratedSources||null,i=!1,s="",a=Yu;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(a=r.onRecoverableError)),t=qu(t,null,e,1,null!=r?r:null,i,0,s,a),e[fi]=t.current,zn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Ku(t)},t.render=function(e,t,r){if(!Xu(t))throw Error(o(200));return el(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Xu(e))throw Error(o(40));return!!e._reactRootContainer&&(lu((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xu(r))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return el(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},8192:function(e,t,r){"use strict";var n=r(8544);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},8544:function(e,t,r){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(9772)},1424:function(e,t){"use strict";var r="function"===typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,a=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,l=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,_=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,y=r?Symbol.for("react.responder"):60118,E=r?Symbol.for("react.scope"):60119;function S(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case l:case d:case o:case a:case s:case p:return e;default:switch(e=e&&e.$$typeof){case u:case h:case m:case g:case c:return e;default:return t}}case i:return t}}}function b(e){return S(e)===d}t.AsyncMode=l,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=c,t.Element=n,t.ForwardRef=h,t.Fragment=o,t.Lazy=m,t.Memo=g,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return b(e)||S(e)===l},t.isConcurrentMode=b,t.isContextConsumer=function(e){return S(e)===u},t.isContextProvider=function(e){return S(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return S(e)===h},t.isFragment=function(e){return S(e)===o},t.isLazy=function(e){return S(e)===m},t.isMemo=function(e){return S(e)===g},t.isPortal=function(e){return S(e)===i},t.isProfiler=function(e){return S(e)===a},t.isStrictMode=function(e){return S(e)===s},t.isSuspense=function(e){return S(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===d||e===a||e===s||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===c||e.$$typeof===u||e.$$typeof===h||e.$$typeof===v||e.$$typeof===y||e.$$typeof===E||e.$$typeof===_)},t.typeOf=S},91:function(e,t,r){"use strict";e.exports=r(1424)},6482:function(e,t,r){"use strict";var n=r(9867),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,r){var n,o={},u=null,l=null;for(n in void 0!==r&&(u=""+r),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:i,type:e,key:u,ref:l,props:o,_owner:a.current}}t.Fragment=o,t.jsx=u,t.jsxs=u},3285:function(e,t){"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function _(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||f}function v(){}function y(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||f}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=_.prototype;var E=y.prototype=new v;E.constructor=y,g(E,_.prototype),E.isPureReactComponent=!0;var S=Array.isArray,b=Object.prototype.hasOwnProperty,T={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function R(e,t,n){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)b.call(t,i)&&!C.hasOwnProperty(i)&&(o[i]=t[i]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(i in c=e.defaultProps)void 0===o[i]&&(o[i]=c[i]);return{$$typeof:r,type:e,key:s,ref:a,props:o,_owner:T.current}}function O(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var k=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function L(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return s=s(c=e),e=""===o?"."+I(c,0):o,S(s)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),L(s,t,i,"",(function(e){return e}))):null!=s&&(O(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(c=0,o=""===o?".":o+":",S(e))for(var u=0;u<e.length;u++){var l=o+I(a=e[u],u);c+=L(a,t,i,l,s)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),u=0;!(a=e.next()).done;)c+=L(a=a.value,t,i,l=o+I(a,u++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function w(e,t,r){if(null==e)return e;var n=[],i=0;return L(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},P={transition:null},M={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:P,ReactCurrentOwner:T};t.Children={map:w,forEach:function(e,t,r){w(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return w(e,(function(){t++})),t},toArray:function(e){return w(e,(function(e){return e}))||[]},only:function(e){if(!O(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=i,t.Profiler=s,t.PureComponent=y,t.StrictMode=o,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=T.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)b.call(t,u)&&!C.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){c=Array(u);for(var l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}return{$$typeof:r,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=R,t.createFactory=function(e){var t=R.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=O,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,r){return N.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,r){return N.current.useReducer(e,t,r)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return N.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return N.current.useTransition()},t.version="18.2.0"},9867:function(e,t,r){"use strict";e.exports=r(3285)},2834:function(e,t,r){"use strict";e.exports=r(6482)},6073:function(e,t){"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<o(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,s=i>>>1;n<s;){var a=2*(n+1)-1,c=e[a],u=a+1,l=e[u];if(0>o(c,r))u<i&&0>o(l,c)?(e[n]=l,e[u]=r,n=u):(e[n]=c,e[a]=r,n=a);else{if(!(u<i&&0>o(l,r)))break e;e[n]=l,e[u]=r,n=u}}}return t}function o(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],l=[],d=1,h=null,p=3,f=!1,g=!1,m=!1,_="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function E(e){for(var t=n(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,r(u,t)}t=n(l)}}function S(e){if(m=!1,E(e),!g)if(null!==n(u))g=!0,P(b);else{var t=n(l);null!==t&&M(S,t.startTime-e)}}function b(e,r){g=!1,m&&(m=!1,v(O),O=-1),f=!0;var o=p;try{for(E(r),h=n(u);null!==h&&(!(h.expirationTime>r)||e&&!L());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var a=s(h.expirationTime<=r);r=t.unstable_now(),"function"===typeof a?h.callback=a:h===n(u)&&i(u),E(r)}else i(u);h=n(u)}if(null!==h)var c=!0;else{var d=n(l);null!==d&&M(S,d.startTime-r),c=!1}return c}finally{h=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,C=!1,R=null,O=-1,k=5,I=-1;function L(){return!(t.unstable_now()-I<k)}function w(){if(null!==R){var e=t.unstable_now();I=e;var r=!0;try{r=R(!0,e)}finally{r?T():(C=!1,R=null)}}else C=!1}if("function"===typeof y)T=function(){y(w)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,N=A.port2;A.port1.onmessage=w,T=function(){N.postMessage(null)}}else T=function(){_(w,0)};function P(e){R=e,C||(C=!0,T())}function M(e,r){O=_((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,P(b))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,r(l,e),null===n(u)&&e===n(l)&&(m?(v(O),O=-1):m=!0,M(S,o-s))):(e.sortIndex=a,r(u,e),g||f||(g=!0,P(b))),e},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},2882:function(e,t,r){"use strict";e.exports=r(6073)},1998:function(module,__unused_webpack_exports,__webpack_require__){var t;"undefined"!=typeof self&&self,t=function(__WEBPACK_EXTERNAL_MODULE__4119__){return function(){var __webpack_modules__={4537:function(e){"use strict";e.exports=function(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}}))}},7419:function(e,t){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),i=new Array(123),o=0;o<64;)i[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,r){for(var i,o=null,s=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:s[a++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:s[a++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:s[a++]=n[i|u>>6],s[a++]=n[63&u],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=n[i],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";r.decode=function(e,t,r){for(var n,o=r,a=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&a>1)break;if(void 0===(u=i[u]))throw Error(s);switch(a){case 0:n=u,a=1;break;case 1:t[r++]=n<<2|(48&u)>>4,n=u,a=2;break;case 2:t[r++]=(15&n)<<4|(60&u)>>2,n=u,a=3;break;case 3:t[r++]=(3&n)<<6|u,a=0}}if(1===a)throw Error(s);return r-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},9211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},945:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function s(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=s.bind(null,i),e.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,i,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function s(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+o;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=s.bind(null,i,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:function _(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},6662:function(e){"use strict";e.exports=function(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}},4997:function(e,t){"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(s+1)))?(++s,t[r++]=(n=65536+((1023&n)<<10)+(1023&i))>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}},3720:function(e){e.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var i={},o={};function s(e,t){var r,n,s;return t?(s=0<=(e>>>=0)&&e<256)&&(n=o[e])?n:(r=c(e,(0|e)<0?-1:0,!0),s&&(o[e]=r),r):(s=-128<=(e|=0)&&e<128)&&(n=i[e])?n:(r=c(e,e<0?-1:0,!1),s&&(i[e]=r),r)}function a(e,t){if(isNaN(e))return t?_:m;if(t){if(e<0)return _;if(e>=p)return b}else{if(e<=-f)return T;if(e+1>=f)return S}return e<0?a(-e,t).neg():c(e%h|0,e/h|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=s,r.fromNumber=a,r.fromBits=c;var u=Math.pow;function l(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return l(e.substring(1),t,r).neg();for(var i=a(u(r,8)),o=m,s=0;s<e.length;s+=8){var c=Math.min(8,e.length-s),d=parseInt(e.substring(s,s+c),r);if(c<8){var h=a(u(r,c));o=o.mul(h).add(a(d))}else o=(o=o.mul(i)).add(a(d))}return o.unsigned=t,o}function d(e,t){return"number"==typeof e?a(e,t):"string"==typeof e?l(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=l,r.fromValue=d;var h=4294967296,p=h*h,f=p/2,g=s(1<<24),m=s(0);r.ZERO=m;var _=s(0,!0);r.UZERO=_;var v=s(1);r.ONE=v;var y=s(1,!0);r.UONE=y;var E=s(-1);r.NEG_ONE=E;var S=c(-1,2147483647,!1);r.MAX_VALUE=S;var b=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=b;var T=c(0,-2147483648,!1);r.MIN_VALUE=T;var C=r.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var t=a(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=a(u(e,6),this.unsigned),o=this,s="";;){var c=o.div(i),l=(o.sub(c.mul(i)).toInt()>>>0).toString(e);if((o=c).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(e){return n(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(n(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(v)},C.neg=C.negate,C.add=function(e){n(e)||(e=d(e));var t=0,r=0,i=0,o=0;return i+=(o+=(65535&this.low)+(65535&e.low))>>>16,r+=(i+=(this.low>>>16)+(e.low>>>16))>>>16,t+=(r+=(65535&this.high)+(65535&e.high))>>>16,t+=(this.high>>>16)+(e.high>>>16),c((i&=65535)<<16|(o&=65535),(t&=65535)<<16|(r&=65535),this.unsigned)},C.subtract=function(e){return n(e)||(e=d(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return m;if(n(e)||(e=d(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(T))return e.isOdd()?T:m;if(e.eq(T))return this.isOdd()?T:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return a(this.toNumber()*e.toNumber(),this.unsigned);var r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=65535&e.high,u=e.low>>>16,l=65535&e.low,h=0,p=0,f=0,_=0;return f+=(_+=o*l)>>>16,p+=(f+=i*l)>>>16,f&=65535,p+=(f+=o*u)>>>16,h+=(p+=r*l)>>>16,p&=65535,h+=(p+=i*u)>>>16,p&=65535,h+=(p+=o*s)>>>16,h+=(this.high>>>16)*l+r*u+i*s+o*(e.high>>>16),c((f&=65535)<<16|(_&=65535),(h&=65535)<<16|(p&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(n(e)||(e=d(e)),e.isZero())throw Error("division by zero");var r,i,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?_:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return _;if(e.gt(this.shru(1)))return y;o=_}else{if(this.eq(T))return e.eq(v)||e.eq(E)?T:e.eq(T)?v:(r=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?v:E:(i=this.sub(e.mul(r)),o=r.add(i.div(e)));if(e.eq(T))return this.unsigned?_:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=m}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),l=s<=48?1:u(2,s-48),h=a(r),p=h.mul(e);p.isNegative()||p.gt(i);)p=(h=a(r-=l,this.unsigned)).mul(e);h.isZero()&&(h=v),o=o.add(h),i=i.sub(p)}return o},C.div=C.divide,C.modulo=function(e){return n(e)||(e=d(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return c(~this.low,~this.high,this.unsigned)},C.and=function(e){return n(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return n(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return n(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},2100:function(e,t,r){"use strict";e.exports=r(9482)},9482:function(e,t,r){"use strict";var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(1173),n.BufferWriter=r(3155),n.Reader=r(1408),n.BufferReader=r(593),n.util=r(9693),n.rpc=r(5994),n.roots=r(5054),n.configure=i,i()},1408:function(e,t,r){"use strict";e.exports=c;var n,i=r(9693),o=i.LongBits,s=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=d(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},593:function(e,t,r){"use strict";e.exports=o;var n=r(1408);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9693);function o(e){n.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},5054:function(e){"use strict";e.exports={}},5994:function(e,t,r){"use strict";t.Service=r(7948)},7948:function(e,t,r){"use strict";e.exports=i;var n=r(9693);function i(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return n.asPromise(e,a,t,r,i,o);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(e,t,r){"use strict";e.exports=i;var n=r(9693);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?o:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},9693:function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=r(4537),n.base64=r(7419),n.EventEmitter=r(9211),n.float=r(945),n.inquire=r(7199),n.utf8=r(4997),n.pool=r(6662),n.LongBits=r(1945),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&null!=this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},1173:function(e,t,r){"use strict";e.exports=d;var n,i=r(9693),o=i.LongBits,s=i.base64,a=i.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var h=function(){return i.Buffer?function(){return(d.create=function(){return new n})()}:function(){return new d}};function p(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}d.create=h(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},(f.prototype=Object.create(c.prototype)).fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.int64=d.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},d.prototype.bool=function(e){return this._push(p,1,e?1:0)},d.prototype.sfixed32=d.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},d.prototype.sfixed64=d.prototype.fixed64=function(e){var t=o.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var _=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(i.isString(e)){var r=d.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(_,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},d.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){n=e,d.create=h(),n._configure()}},3155:function(e,t,r){"use strict";e.exports=o;var n=r(1173);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9693);function o(){n.call(this)}function s(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},4095:function(e,t){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoAudioEffectPlayer=void 0;var n=function(){function e(e,t){this.zegoWebRTC=e,this.stream=t}return e.prototype.start=function(e,t,n,i){this.zegoWebRTC.playEffect(r({stream:this.stream,effectID:e},t||{}),n,i)},e.prototype.stop=function(e){return this.zegoWebRTC.stopEffect(this.stream,e)},e.prototype.pause=function(e){return this.zegoWebRTC.pauseEffect(this.stream,e)},e.prototype.resume=function(e){return this.zegoWebRTC.resumeEffect(this.stream,e)},e.prototype.setVolume=function(e,t){return this.zegoWebRTC.setEffectVolume(this.stream,t,e)},e.prototype.getTotalDuration=function(e){return this.zegoWebRTC.getEffectDuration(e)},e.prototype.getCurrentProgress=function(e){return this.zegoWebRTC.getEffectCurrentProgress(this.stream,e)},e.prototype.seekTo=function(e,t){return this.zegoWebRTC.seekAudioEffect(this.stream,e,t)},e}();t.ZegoAudioEffectPlayer=n},8835:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRealTimeSequentialDataManager=void 0;var n=r(3504),i=function(){function e(e,t){this.dataChannelManager=new n.DataChannelListener(e,t)}return e.prototype.startBroadcasting=function(e){return this.dataChannelManager.startBroadcasting(e)},e.prototype.stopBroadcasting=function(e){return this.dataChannelManager.stopBroadcasting(e)},e.prototype.sendRealTimeSequentialData=function(e,t){return this.dataChannelManager.sendRealTimeSequentialData(e,t)},e.prototype.startSubscribing=function(e){return this.dataChannelManager.startSubscribing(e)},e.prototype.stopSubscribing=function(e){return this.dataChannelManager.stopSubscribing(e)},e.prototype.on=function(e,t){this.dataChannelManager.on(e,t)},e.prototype.off=function(e,t){this.dataChannelManager.off(e,t)},e}();t.ZegoRealTimeSequentialDataManager=i},1297:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSEIType=t.ZegoRangeAudioMode=t.ZegoRangeAudioMicrophoneState=t.ZegoMixStreamRenderMode=t.ZegoLowlightEnhancementMode=void 0,function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(t.ZegoLowlightEnhancementMode||(t.ZegoLowlightEnhancementMode={})),function(e){e[e.AspectFill=0]="AspectFill",e[e.AspectFit=1]="AspectFit"}(t.ZegoMixStreamRenderMode||(t.ZegoMixStreamRenderMode={})),function(e){e[e.Off=0]="Off",e[e.TurningOn=1]="TurningOn",e[e.On=2]="On"}(t.ZegoRangeAudioMicrophoneState||(t.ZegoRangeAudioMicrophoneState={})),function(e){e[e.World=0]="World",e[e.Team=1]="Team"}(t.ZegoRangeAudioMode||(t.ZegoRangeAudioMode={})),function(e){e[e.ZegoDefined=0]="ZegoDefined",e[e.UserUnregister=1]="UserUnregister"}(t.ZegoSEIType||(t.ZegoSEIType={}))},3116:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressRangeAudio=void 0;var s=o(r(2760)),a=function(){function e(e,t){this.zegoAudioListener=s.default.getInstance(e,t)}return e.getInstance=function(t,r){if(!e.instance){if(!t)throw Error("create instance failed.");e.instance=new e(t,r)}return e.instance},e.prototype.on=function(e,t){return this.zegoAudioListener.on(e,t)},e.prototype.off=function(e,t){return this.zegoAudioListener.off(e,t)},e.prototype.setAudioReceiveRange=function(e){this.zegoAudioListener.setAudioReceiveRange(e)},e.prototype.updateSelfPosition=function(e,t,r,n){this.zegoAudioListener.updateSelfPosition(e,t,r,n)},e.prototype.updateAudioSource=function(e,t){this.zegoAudioListener.updateAudioSource(e,t)},e.prototype.enableSpatializer=function(e){return this.zegoAudioListener.enableSpatializer(e)},e.prototype.enableMicrophone=function(e){return this.zegoAudioListener.enableMicrophone(e)},e.prototype.selectMicrophone=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.zegoAudioListener.selectMic(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.selectSpeaker=function(e){return this.zegoAudioListener.selectSpeaker(e)},e.prototype.enableSpeaker=function(e){return this.zegoAudioListener.enableSpeaker(e)},e.prototype.setRangeAudioMode=function(e){this.zegoAudioListener.setRangeAudioMode(e)},e.prototype.setTeamID=function(e){this.zegoAudioListener.setRangeAudioTeamID(e)},e.prototype.setPositionUpdateFrequency=function(e){return this.zegoAudioListener.setPositionUpdateFrequency(e)},e.prototype.setRangeAudioVolume=function(e){return this.zegoAudioListener.setAudioVolume(e)},e.prototype.isAudioContextRunning=function(){return"running"===this.zegoAudioListener.getAudioContextState()},e.prototype.resumeAudioContext=function(){return this.zegoAudioListener.resumeAudioContext()},e}();t.ZegoExpressRangeAudio=a},5028:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoStreamView=void 0;var r=function(){function e(e){this.v=e}return e.prototype.takeStreamSnapshot=function(e){return this.v.takeStreamSnapshot(e)},e.prototype.play=function(e,t){return this.v.play(e,t)},e.prototype.stop=function(){return this.v.stop()},e.prototype.resume=function(){this.v.resume()},e.prototype.setAudioMuted=function(e){return this.v.setAudioMuted(e)},e.prototype.setVideoMuted=function(e){return this.v.setVideoMuted(e)},e.prototype.useAudioOutputDevice=function(e){return this.v.useAudioOut(e)},e.prototype.setVolume=function(e){return this.v.setVolume(e)},e.prototype.on=function(e,t){return this.v.on(e,t)},e.prototype.off=function(e,t){return this.v.off(e,t)},e}();t.ZegoStreamView=r},4780:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressEngine=t.WebRTCUtil=void 0;var s=r(9880),a=o(r(3126)),c=o(r(9869)),u=o(r(3824)),l=o(r(6012)),d=o(r(7526)),h=o(r(577)),p=r(2777),f=r(4897),g=r(957);s.ZegoExpressEngine.use(a.default),s.ZegoExpressEngine.use(c.default),s.ZegoExpressEngine.use(u.default),s.ZegoExpressEngine.use(l.default),s.ZegoExpressEngine.use(d.default),s.ZegoExpressEngine.use(h.default),s.ZegoExpressEngine.use(p.RangeAudio),s.ZegoExpressEngine.use(f.DataChannel),s.ZegoExpressEngine.use(g.BeautyEffect);var m=r(9880);Object.defineProperty(t,"WebRTCUtil",{enumerable:!0,get:function(){return m.WebRTCUtil}});var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(s.ZegoExpressEngine);t.ZegoExpressEngine=_},9880:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.WebRTCUtil=t.ZegoExpressEngine=void 0;var o=r(4119),s=r(5321),a=r(4095),c=function(e){function t(t,r){var n=this;return o.ZegoExpressWebRTMEngine.version="2.20.2",(n=e.call(this,t,r,0,arguments[2])||this).zegoWebRTC=new s.ZegoWebRTC(n.logger,n.dataReport,n.zegoWebRTM),n}return i(t,e),t.prototype.setSEIConfig=function(e){this.zegoWebRTC.setSEIConfig(e)},t.use=function(e){o.ZegoExpressWebRTMEngine.use(e),s.ZegoWebRTC.use(e)},t.prototype.checkSystemRequirements=function(e,t){return void 0===t&&(t=0),this.zegoWebRTC.checkSystemRequirements(t,e)},t.prototype.off=function(e,t){return this.zegoWebRTM.stateCenter.listenerList[e]?this.zegoWebRTM.off(e,t):!!this.zegoWebRTC.stateCenter.listenerList[e]&&this.zegoWebRTC.off(e,t)},t.prototype.on=function(e,t){return this.zegoWebRTM.stateCenter.listenerList[e]?this.zegoWebRTM.on(e,t):!!this.zegoWebRTC.stateCenter.listenerList[e]&&this.zegoWebRTC.on(e,t)},t.prototype.createStream=function(e){return this.zegoWebRTC.createStream(e)},t.prototype.enableAutoSwitchDevice=function(e){return this.zegoWebRTC.enableAutoSwitchDevice(e)},t.prototype.getPublishingStreamQuality=function(e){return this.zegoWebRTC.getPublishingStreamQuality(e)},t.prototype.getElectronScreenSources=function(){return this.zegoWebRTC.getElectronScreenSources()},t.prototype.enableAiDenoise=function(e,t){return this.zegoWebRTC.enableAiDenoise(e,t)},t.prototype.destroyStream=function(e){return this.zegoWebRTC.destroyStream(e)},t.prototype.startPublishingStream=function(e,t,r){return this.zegoWebRTC.startPublishingStream(e,t,r)},t.prototype.stopPublishingStream=function(e){return this.zegoWebRTC.stopPublishingStream(e)},t.prototype.sendSEI=function(e,t){return this.zegoWebRTC.sendSEI(e,t)},t.prototype.setVideoConfig=function(e,t){return this.zegoWebRTC.setVideoConfig(e,t)},t.prototype.setAudioConfig=function(e,t){return this.zegoWebRTC.setAudioConfig(e,t)},t.prototype.replaceTrack=function(e,t){return this.zegoWebRTC.replaceTrack(e,t)},t.prototype.setCaptureVolume=function(e,t){return this.zegoWebRTC.setCaptureVolume(e,t)},t.prototype.setDummyCaptureImagePath=function(e,t){return this.zegoWebRTC.setDummyCaptureImagePath(e,t)},t.prototype.setStreamExtraInfo=function(e,t){return this.zegoWebRTC.setStreamExtraInfo(e,t)},t.prototype.enableVideoCaptureDevice=function(e,t){return this.zegoWebRTC.enableCameraCapturing(e,t)},t.prototype.addPublishCdnUrl=function(e,t){return 3===arguments.length?this.zegoWebRTC.addPublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.addPublishCdnUrl(e,t)},t.prototype.removePublishCdnUrl=function(e,t){return 3===arguments.length?this.zegoWebRTC.removePublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.removePublishCdnUrl(e,t)},t.prototype.mutePublishStreamVideo=function(e,t,r){return this.zegoWebRTC.mutePublishStreamVideo(e,t,r)},t.prototype.mutePublishStreamAudio=function(e,t){return this.zegoWebRTC.mutePublishStreamAudio(e,t)},t.prototype.setEffectsBeauty=function(e,t,r){return this.zegoWebRTC.setBeautyEffect(e,t,r)},t.prototype.setLowlightEnhancement=function(e,t){return this.zegoWebRTC.setLowlightEnhance(e,t)},t.prototype.enableDualStream=function(e){return this.zegoWebRTC.enableDualStream(e)},t.prototype.setLowStreamParameter=function(e,t){return this.zegoWebRTC.setLowStreamParameter(e,t)},t.prototype.enableHardwareEncoder=function(e){this.zegoWebRTC.enableVideoHardwareEncoder(e)},t.prototype.startPlayingStream=function(e,t){return this.zegoWebRTC.startPlayingStream(e,t)},t.prototype.stopPlayingStream=function(e){return this.zegoWebRTC.stopPlayingStream(e)},t.prototype.mutePlayStreamVideo=function(e,t){return this.zegoWebRTC.mutePlayStreamVideo(e,t)},t.prototype.mutePlayStreamAudio=function(e,t){return this.zegoWebRTC.mutePlayStreamAudio(e,t)},t.prototype.getPlayingStreamQuality=function(e){return this.zegoWebRTC.getPlayingStreamQuality(e)},t.prototype.createLocalStreamView=function(e){return this.zegoWebRTC.createLocalViewer(e)},t.prototype.createRemoteStreamView=function(e){return this.zegoWebRTC.createRemoteViewer(e)},t.prototype.startMixerTask=function(e){return this.zegoWebRTC.startMixerTask(e)},t.prototype.stopMixerTask=function(e){return this.zegoWebRTC.stopMixerTask(e)},t.prototype.setMixerTaskConfig=function(e){return this.zegoWebRTC.setMixerTaskConfig(e)},t.prototype.startMixingAudio=function(e,t){return this.zegoWebRTC.startMixingAudio(e,t)},t.prototype.stopMixingAudio=function(e,t){return this.zegoWebRTC.stopMixingAudio(e,t)},t.prototype.setMixingAudioVolume=function(e,t,r){return this.zegoWebRTC.setMixingAudioVolume(e,t,r)},t.prototype.createAudioEffectPlayer=function(e){if(e instanceof MediaStream)return new a.ZegoAudioEffectPlayer(this.zegoWebRTC,e);throw Error("Param localStream is not instance of MediaStream.")},t.prototype.loadAudioEffect=function(e,t){var r=this;return new Promise((function(n,i){r.zegoWebRTC.preloadEffect(e,t,(function(t){t&&i(t),n(e)}))}))},t.prototype.unloadAudioEffect=function(e){return this.zegoWebRTC.unloadEffect(e)},t.prototype.enumDevices=function(){return this.zegoWebRTC.enumDevices()},t.prototype.getCameras=function(){return this.zegoWebRTC.getCameras()},t.prototype.getMicrophones=function(){return this.zegoWebRTC.getMicrophones()},t.prototype.getSpeakers=function(){return this.zegoWebRTC.getSpeakers()},t.prototype.useVideoDevice=function(e,t){return this.zegoWebRTC.useVideoDevice(e,t)},t.prototype.useAudioDevice=function(e,t){return this.zegoWebRTC.useAudioDevice(e,t)},t.prototype.useAudioOutputDevice=function(e,t){return this.zegoWebRTC.setAudioOutputDevice(e,t)},t.prototype.setSoundLevelDelegate=function(e,t,r){return this.zegoWebRTC.setSoundLevelDelegate(e,t,null==r?void 0:r.enableInBackground)},t.prototype.isMicrophoneMuted=function(){return this.zegoWebRTC.isMicrophoneMuted()},t.prototype.muteMicrophone=function(e){return this.zegoWebRTC.muteMicrophone(e)},t.prototype.createRangeAudioInstance=function(){return this.zegoWebRTC.createRangeAudioInstance()},t.prototype.createRealTimeSequentialDataManager=function(e){return this.zegoWebRTC.createRealTimeSequentialDataManager(e)},t.prototype.destroyRealTimeSequentialDataManager=function(e){this.zegoWebRTC.destroyRealTimeSequentialDataManager(e)},t}(o.ZegoExpressWebRTMEngine);t.ZegoExpressEngine=c;var u=r(1358);Object.defineProperty(t,"WebRTCUtil",{enumerable:!0,get:function(){return u.WebRTCUtil}})},1089:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WEBRTC_ACTION=void 0,function(e){e.CONSTRUCTOR="zc.0",e.CHECK_SUPPORT="zc.csr",e.CREATE_STREAM="zc.cs",e.DESTROY_STREAM="zc.ds",e.START_PUBLISHING_STREAM="zc.sps.0",e.START_PLAYING_STREAM="zc.sps.1",e.STOP_PUBLISHING_STREAM="zc.sps.0.0",e.STOP_PLAYING_STREAM="zc.sps.1.0",e.SET_MEDIA_SIDE_FLAGS="zc.smsg.0",e.SEND_MEDIA_SIDE_INFO="zc.smsi.0",e.ON_STREAM="zc.os",e.ON_PUSH_STREAM_UPDATE="zc.opsu",e.BIND_WINDOW_LISTENER="zc.wl",e.SET_AUDIO_OUTPUT="zc.sao",e.SET_CUSTOM_SIGNAL_URL="zc.scsu",e.SET_TURN_OVER_TCP_ONLY="zc.stoto",e.RDH_ACTIVE="zc.rdh.a",e.RDH_MAX_TIME="zc.rdh.m",e.RDH_WEBRTC_URL_RSP="zc.rdh.hfwur",e.PUBLISH_STATE_HANDLE="zc.psh.0",e.PLAY_STATE_HANDLE="zc.psh.1",e.RETRYSTREAMHANDLER_RETRY_NEW_GW_NODE="zc.tsh.rngn.0",e.RETRYSTREAMHANDLER_RETRY_NEXT_GW_NODE="zc.tsh.rngn.1",e.STATECENTER_ACTION_LISTENER="zc.sc.al",e.STATECENTER_SET_SETTING="zc.sc.ss",e.SIGNAL_SET_SESSION_INFO="zc.s.ssi",e.SIGNAL_RESET_CONNECT_TIMER="zc.s.rct",e.SIGNAL_RESET_LOGIN_TIMER="zc.s.rlt",e.SIGNAL_BIND_WEBSOCKET_HANDLE="zc.s.bwh",e.SIGNAL_RESET_CHECK_MESSAGE="zc.s.rcm",e.SIGNAL_UPDATE_TOKEN="zc.s.ut",e.SIGNAL_DISCONNECTCALLBACK="zc.s.dcb",e.SIGNAL_SEND_MESSAGE_WITH_CALLBACK="zc.s.smwc",e.SIGNAL_CONNECT_SERVER="zc.s.cs.0",e.SIGNAL_START_CONNECT_TIMER="zc.s.sct",e.SIGNAL_DISCONNECT_SERVER="zc.s.dc",e.SIGNAL_CREATE_SESSION="zc.s.cs.1",e.SIGNAL_REMOVE_SESSION="zc.s.rs",e.SIGNAL_SEND_REMOVE_SESSION="zc.s.srs",e.SIGNAL_SEND_MESSAGE="zc.s.sm",e.SIGNAL_HANDLE_RESPOND_DATA="zc.s.hrd",e.SIGNAL_ADD_SESSION="zc.s.as",e.SIGNAL_HANDLE_PUSH_DATA="zc.s.hpd",e.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA="zc.s.hprsd",e.SIGNAL_SEND_MEDIA_DESC="zc.s.smd",e.SIGNAL_SEND_CANDIDATE_INFO="zc.s.sci",e.SIGNAL_SEND_MEDIA_DESC_ACK="zc.s.smda",e.SIGNAL_SEND_CANDIDATE_INFO_ACK="zc.s.scia",e.SIGNAL_SEND_CLOSE_SESSION_ACK="zc.s.scsa",e.SIGNAL_SEND_RESET_SESSION_ACK="zc.s.srsa",e.SIGNAL_REGISTER_PUSH_CALLBACK="zc.s.rpc",e.SIGNAL_CHECK_MESSAGE_TIMEOUT="zc.s.cmt",e.SIGNAL_SEND_HEARTBEAT="zc.s.sh",e.SIGNAL_QUALITY_REPORT="zc.s.qr",e.SIGNAL_SEND_STREAM_STATUS="zc.s.sss",e.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM="zc.s.apvs",e.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM="zc.s.apas",e.SIGNAL_SEND_BROADCAST_STATUS="zc.s.sbs",e.SIGNAL_SEND_NET_PROBE="zc.s.snp",e.SIGNAL_SEND_NET_QUALITY_INFO_PUSH_ACK="zc.s.npa",e.STREAMCENTER_SET_STREAM_GW_NODE="zsc.ssgn",e.STREAMCENTER_CLEAR_CACHED_GWNODES_LIST="zsc.ccgl",e.STREAMCENTER_CHECK_CACHED_NODES_USE="zsc.ccns",e.STREAMCENTER_UPDATE_CACHED_GWNODES_LIST="zsc.ucgl",e.PUBLISHER_START_PUBLISH="zc.p.0.sp.0",e.PUBLISHER_PUBLISH_SUCCESS="zc.p.ps",e.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS="zc.p.0.ocpss",e.PUBLISHER_HANDLE_CREATE_SESSION_WITH_SDP="zc.p.0.hcsws",e.PUBLISHER_ON_CREATE_OFFER_SUCCESS="zc.p.0.ocos",e.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS="zc.p.0.oslds",e.PUBLISHER_ON_GET_REMOTE_DESCRIPTION="zc.p.0.ogrd",e.PUBLISHER_ON_RECV_MEDIA_DESC="zc.p.0.ormd",e.PUBLISHER_ON_RECV_CANDIDATE_INFO="zc.p.0.orci.0",e.PUBLISHER_ON_RECV_PUBLISH_EVENT="zc.p.0.orpe",e.PUBLISHER_ON_RECV_CLIENT_INFO="zc.p.0.orci.1",e.PUBLISHER_ON_ICE_CANDIDATE="zc.p.0.oic",e.PUBLISHER_ON_CONNECTION_STATE_CHANGE="zc.p.0.ocsc",e.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE="zc.p.0.oicsc",e.PUBLISHER_RESET_PUBLISH="zc.p.0.rp",e.PUBLISHER_SET_PLAYER_QUALITY_TIMER="zc.p.0.spqt",e.PUBLISHER_UPLOAD_PUBLISH_QUALITY="zc.p.0.upq",e.PUBLISHER_ON_RECV_RESET_SESSION="zc.p.0.orrs",e.PUBLISHER_ON_RECV_CLOSE_SESSION="zc.p.0.orcs",e.PUBLISHER_SEND_CANDIDATE_INFO="zc.p.0.sci",e.PUBLISHER_STATE_ERROR="zc.p.0.psr",e.PUBLISHER_STOP_PUBLISH="zc.p.0.sp.1",e.PUBLISHER_ON_DISCONNECT="zc.p.0.od",e.PUBLISHER_START_SOUND_LEVEL="zc.p.0.ssl.0",e.PUBLISHER_STOP_SOUND_LEVEL="zc.p.0.ssl.1",e.PUBLISHER_HANDLE_ENC_BITRATE="zc.p.0.heb",e.PUBLISHER_ON_RECV_NET_QUALITY_INFO="zc.p.0.nqi",e.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC="zc.p.0.orumd",e.PUBLISHER_SEND_SEI="zc.p.0.ss",e.PUBLISHER_RESET_GW_NODES="zc.p.0.rgn",e.PUBLISHER_SET_GW_NODES="zc.p.0.sgn",e.PUBLISHER_HANDLE_DISPATCHED_GW_NODES="zc.p.0.hdgn",e.PUBLISHER_PURE_SORT_GW_NODES="zc.p.0.psgn",e.PLAYER_START_PLAY="zc.p.1.sp.0",e.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS="zc.p.ocpss.1",e.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP="zc.p.hcsws.1",e.PLAYER_ON_CREATE_OFFER_SUCCESS="zc.p.ocos.1",e.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS="zc.p.oslds.1",e.PLAYER_ON_RECV_MEDIA_DESC="zc.p.ormd.1",e.PLAYER_ON_RECV_CANDIDATE_INFO="zc.p.orci.1",e.PLAYER_ON_RECV_PLAY_EVENT="zc.p.orpe.1",e.PLAYER_ON_RECV_CLIENT_INFO="zc.p.orci.1.1",e.PLAYER_ON_ICE_CANDIDATE="zc.p.oic.1",e.PLAYER_ON_CONNECTION_STATE_CHANGE="zc.p.ocsc.1",e.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE="zc.p.oicsc.1",e.PLAYER_RESET_PLAY="zc.p.rp.1",e.PLAYER_SET_PLAYER_QUALITY_TIMER="zc.p.spqt.1",e.PLAYER_UPLOAD_PLAYER_QUALITY="zc.p.upq.1",e.PLAYER_ON_RECV_RESET_SESSION="zc.p.orrs.1",e.PLAYER_ON_RECV_CLOSE_SESSION="zc.p.orcs.1",e.PLAYER_ON_RECV_STREAM_STATUS="zc.p.orss.1",e.PLAYER_ON_GOT_REMOTE_STREAM="zc.p.ogrs.1",e.PAYER_GET_VIDEO_CODEC="zc.p.gvc",e.PLAYER_SEND_CANDIDATE_INFO="zc.p.sci.1",e.PLAYER_STATE_ERROR="zc.p.psr.1",e.PLAYER_STOP_PLAY="zc.p.1.sp.1",e.PLAYER_ON_DISCONNECT="zc.p.od.1",e.PLAYER_START_SOUND_LEVEL="zc.p.ssl.1",e.PLAYER_STOP_SOUND_LEVEL="zc.p.ssl.1.1",e.PLAYER_ON_RECV_NET_QUALITY_INFO="zc.p.1.nqi",e.PLAYER_RESET_GW_NODES="zc.p.1.rgn",e.PLAYER_SET_GW_NODES="zc.p.1.sgn",e.PLAYER_HANDLE_DISPATCHED_GW_NODES="zc.p.1.hdgn",e.PLAYER_PURE_SORT_GW_NODES="zc.p.1.psgn",e.UPLOAD_SPEED_LOG_QUALITY="zc.uslq",e.PUBLISH_SET_CAPTURE_VOLUME="zc.p.scv",e.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe",e.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ="zc.sh.msbss",e.STREAMHANDLER_MERGE_STREAM="zc.sh.ms",e.STREAMHANDLER_PATCH_STREAM_LIST="zc.sh.psl",e.STREAMHANDLER_SEND_BIZCHANNEL_REQUESTV2="zc.sh.sbr",e.ANALOGSOCKET_UPDATE_MEDIA_READY_STATE="zc.as.umrs",e.ANALOGSOCKET_UPDATE_ACCESS_READY_STATE="zc.as.uars",e.ANALOGSOCKET_SET_MEDIA_SERVER_STATE="zc.as.smss",e.ANALOGSOCKET_SET_ACCESS_SERVER_STATE="zc.as.sass",e.ANALOGSOCKET_SEND="zc.as.s.0",e.ANALOGSOCKET_OPEN="zc.as.op"}(t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={}))},9595:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTC=t.ZegoSettingConfig=void 0;var r=function(){function e(){this.defaultSetting={publish_video_codec:"H264",camera_video_bitrate:800,screen_video_bitrate:1500,custom_video_bitrate:0,l3_play_buffer_ms:500,AEC:!0,AGC:!0,ANS:!0,resource_mode:0,bitrate_mode:"default",auto_to_tcp:!1,udp_max_fail_num:2,probe_started_num:3,udp_or_tcp:"udp",hardware_encode:!1,camera_hard_encode:!1,custom_hard_encode:!1},this.userChangedKey={},this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}return e.prototype.setSetting=function(e,t){var r=Array.isArray(t)&&t.length>0;for(var n in e)for(var i in e[n])if(!i.endsWith("_ctrlmode")){if(r&&-1==t.indexOf(i))continue;var o=e[n][i+"_ctrlmode"];1===o?this.userChangedKey[i]||(this.setting[i]=e[n][i]):2===o?this.setting[i]=e[n][i]:this.defaultSetting[i]&&(this.setting[i]=this.defaultSetting[i]),"number"==typeof o&&(this.setting[i+"_ctrlmode"]=e[n][i+"_ctrlmode"])}},e.prototype.getSetting=function(e,t){return void 0===t&&(t=!1),t?2==this.setting[e+"_ctrlmode"]?this.setting[e]:void 0:this.setting[e]},e.prototype.setUserValue=function(e,t){2!==this.setting[e+"_ctrlmode"]&&(this.userChangedKey[e]=!0,this.setting[e]=t)},e}();t.ZegoSettingConfig=r,t.RTC="rtc"},7325:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateCenter=void 0;var n=r(6706),i=r(608),o=r(1089),s=r(6706),a=r(3529),c=r(3544),u=r(1378),l=function(){function e(e,t){this.logger=e,this.dataReport=t,this.debug=!1,this.testEnvironment=!1,this.pullLimited=!0,this.useNetAgent=!0,this.configOK=!1,this.relateService=[],this.role=2,this.maxMemberCount=0,this.roomCreateFlag=1,this.callbackList={},this.publishStreamList={},this.waitPublishStreamList={},this.streamUrlMap={},this.cmdCallback={},this.customUrl=[],this.customPlayUrl=[],this.turnOverTcpOnly=!1,this.customSetTcpOrUdp=!1,this.supportUdp=!1,this.audioEffectBuffer={},this.audioBitRate=48e3,this.cdnSeq=0,this.listenerList={roomStreamUpdate:[],streamExtraInfoUpdate:[],playerStateUpdate:[],publisherStateUpdate:[],screenSharingEnded:[],publishQualityUpdate:[],playQualityUpdate:[],remoteCameraStatusUpdate:[],remoteMicStatusUpdate:[],soundLevelUpdate:[],capturedSoundLevelUpdate:[],videoDeviceStateChanged:[],audioDeviceStateChanged:[],deviceError:[],_deviceError:[],_remoteCameraStatusUpdate:[],_remoteMicStatusUpdate:[],_streamUpdated:[],receiveRealTimeSequentialData:[],beautyEffectOverload:[],playerRecvSEI:[],beautyEffectError:[]},this.reportList={},this.reportSeqList={startPublish:{},rePublish:{},startPlay:{},rePlay:{},stopPublish:{},stopPlay:{}},this.streamTrigger={},this.audioStreamList={},this.deviceInfos=null,this.deviceChangeTimer=null,this.deviceStateOut=!1,this.streamRetryTime=300,this.checkList=[],this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""},this.streamConnectTime=0,this.clientIP="",this.accessClientIp="",this.isMultiOuter=!1,this.type="PUBLIC",this.roomList=[],this.tempRoomList=[],this.isMultiRoom=!1,this.browser="",this.unregisterSeiFilter="",this.isTestMode=!1,this.playAccelerate=!0,this.connectChanged=!1,this.autoSwitchDeviceSetting={camera:!1,microphone:!1},this.testStreamRetryMode=0,this.testStreamRetryCount=10,this.supportDispatchByPass=!1,this.logReportCallback=i.ClientUtil.logReportCallback,this.unregisterCallback=i.ClientUtil.unregisterCallback,this.checkIllegalCharacters=i.ClientUtil.checkIllegalCharacters,this.decodeServerError=i.ClientUtil.decodeServerError,this.getLiveRoomError=i.ClientUtil.getLiveRoomError,this.getServerError=i.ClientUtil.getServerError,this.mergeStreamList=i.ClientUtil.mergeStreamList,this.checkInteger=i.ClientUtil.checkInteger,this.isUrl=i.ClientUtil.isUrl,this.actionSuccessCallback=i.ClientUtil.actionSuccessCallback,this.checkValidNumber=i.ClientUtil.checkValidNumber,this.getDevices=i.ClientUtil.getDevices,this.uint8arrayToBase64=i.ClientUtil.uint8arrayToBase64,this.getSeq=s.getSeq,this.getReportSeq=n.getReportSeq}return Object.defineProperty(e.prototype,"networkState",{get:function(){var e;return null===(e=this.rtm)||void 0===e?void 0:e.stateCenter.networkState},set:function(e){var t;(null===(t=this.rtm)||void 0===t?void 0:t.stateCenter)&&void 0!==e&&(this.rtm.stateCenter.networkState=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamCenter",{get:function(){return this._streamCenter},set:function(e){this._streamCenter=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"billingTimer",{get:function(){return this._billingTimer||(this._billingTimer=new c.BillingTimer(this.logger,this)),this._billingTimer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chargeInfosSaver",{get:function(){return this._chargeInfosSaver||(this._chargeInfosSaver=new u.ChargeInfosSaverWeb(this.logger,this)),this._chargeInfosSaver},enumerable:!1,configurable:!0}),e.prototype.getRequestId=function(){return this.idName+"-"+(0,s.getSeq)()},e.prototype.getSignalCmdContent=function(e,t,r,n){var i={request_id:t,room_id:e,from_userid:this.idName,from_username:this.nickName,to_userid:r};return null!=n&&(i.result=n),JSON.stringify(i)},e.prototype.actionListener=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(!["playQualityUpdate","publishQualityUpdate","soundLevelUpdate","capturedSoundLevelUpdate","playerRecvSEI"].includes(e)&&this.listenerList[e]){var s=(0,n.getReportSeq)();this.dataReport.newReport(s,a.ZegoRTCLogEvent.kZegoListener.event),this.dataReport.addMsgInfo(s,{listener:e,params:r}),this.dataReport.uploadReport(s),["deviceError","streamExtraInfoUpdate","publisherStateUpdate","playerStateUpdate","roomStreamUpdate"].includes(e)&&this.logger.info("zc.al ".concat(e," ").concat(JSON.stringify(r)))}this.listenerList[e]&&this.listenerList[e].forEach((function(n){try{setTimeout((function(){n.apply(void 0,r)}),0)}catch(r){t.logger.error(o.ZEGO_WEBRTC_ACTION.STATECENTER_ACTION_LISTENER+" "+e+" "+r)}}))},e.prototype.getRoomByRoomID=function(e){return this.roomList.find((function(t){return t.roomID==e}))},e.prototype.getPlayRoom=function(e){return this.roomList.find((function(t){return!!t.streamList.find((function(t){return t.stream_id==e}))}))},e}();t.StateCenter=l},5740:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoStreamCenter=void 0,t.ZegoStreamCenter=function(){this.publisherList={},this.playerList={},this.stopedPlayerList={}}},7560:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamHandler=void 0;var n=r(6706),i=r(2752),o=r(1089),s=function(){function e(e,t,r,n,i){this.logger=e,this.stateCenter=t,this.rtm=r,this.streamCenter=n,this.roomID=i,this.minStreamSeq=0,this.streamSeq=0,this.streamQuerying=!1,this.streamSeqMergeMap=null,this.streamListHBMergeInterval=2e3,this.streamListMergeInterval=5e3}return e.prototype.setCDNInfo=function(e,t){e.urlFlv=t.urls_flv instanceof Array?t.urls_flv[0]||"":"string"==typeof t.urls_flv?t.urls_flv:"",e.urlHls=t.urls_m3u8 instanceof Array?t.urls_m3u8[0]||"":"string"==typeof t.urls_m3u8?t.urls_m3u8:"",e.urlFlvPlus=t.urls_flv_plus instanceof Array?t.urls_flv_plus[0]||"":"string"==typeof t.urls_flv_plus?t.urls_flv_plus:"",e.urlHlsPlus=t.urls_m3u8_plus instanceof Array?t.urls_m3u8_plus[0]||"":"string"==typeof t.urls_m3u8_plus?t.urls_m3u8_plus:"",e.urlHttpsFlv=t.urls_https_flv instanceof Array?t.urls_https_flv[0]||"":"string"==typeof t.urls_https_flv?t.urls_https_flv:"",e.urlHttpsHls=t.urls_https_m3u8 instanceof Array?t.urls_https_m3u8[0]||"":"string"==typeof t.urls_https_m3u8?t.urls_https_m3u8:"",e.urlRtmp=t.urls_rtmp instanceof Array?t.urls_rtmp[0]||"":"string"==typeof t.urls_rtmp?t.urls_rtmp:""},e.prototype.onStreamUpdated=function(e,t,r){},e.prototype.onStreamExtraInfoUpdated=function(e,t){},e.prototype.handleStreamStart=function(e,t){this.logger.info("zb.sh.hss call stream update"),this.room=t,e.body?(this.streamListHBMergeInterval=e.body.stream_list_hb_wait_merge_time||2e3,this.streamListMergeInterval=e.body.stream_list_push_merge_timeout||5e3,this.streamQuerying=!1,this.handleFullUpdateStream(e.body.stream_seq,e.body.stream_info||[]),this.handleReconnectStream(e.body.stream_info),this.logger.info("zb.sh.hss call end")):this.logger.error("zb.sh.hss server response wrong")},e.prototype.onPublishStateUpdate=function(e,t,r){},e.prototype.updateStreamInfo=function(e,t,r,o){var s,a,c=this;void 0===r&&(r=""),this.logger.info("zb.sh.usi call");var u=r,l=null===(s=this.room)||void 0===s?void 0:s.streamList.find((function(t){return t.stream_id===e}));l||this.logger.warn("zb.sh.usi stream not in room cmd "+t);var d={stream_id:e,extra_info:u};2002!==t&&2003!==t||(d.stream_sid=(null==l?void 0:l.stream_sid)||"");var h=JSON.stringify(d),p={sub_cmd:t,stream_msg:h,third_token:null===(a=this.room)||void 0===a?void 0:a.token},f=this.room;this.room.streamInfoList[e]={};var g=function(r,n){c.handleStreamUpdateRsp(r,e,t)},m=function(s,a){var u=c.room;if(u&&!u.isResetRoom&&!c.rtm.isDisConnect()&&s.code&&s.code==i.errorCodeList.TIMEOUT.code&&u.streamInfoList[e].seq==a)2001==t&&c.stateCenter.publishStreamList[e]&&c.stateCenter.publishStreamList[e].state==n.ENUM_PUBLISH_STREAM_STATE.update_info||2002==t?(c.logger.warn("zb.sh.usi resend stream update "+t),setTimeout((function(){c.updateStreamInfo(e,t,r,o)}),0)):o&&o(i.errorCodeList.TIMEOUT);else if(s.body&&s.body.err_code){var l=c.stateCenter.getServerError(s.body.err_code,c.stateCenter.useNetAgent,s.body.err_message);[1011,1000002002].includes(l.code)&&(l=i.errorCodeList.TOKEN_EXPIRED),o&&o(l,a),t===n.ENUM_STREAM_SUB_CMD.liveBegin&&c.onPublishStateUpdate(n.ENUM_PUBLISH_STATE_UPDATE.error,e,l)}};this.room.streamInfoList[e].seq=this.stateCenter.useNetAgent?this.rtm.liveRoomHandler.sendStreamUpdate(p,g,m,{sessionID:null==f?void 0:f.sessionID,roomID:null==f?void 0:f.roomID,roomSessionID:null==f?void 0:f.roomSessionID}):this.rtm.service.sendMessage("stream",p,g,m,void 0,{sessionID:null==f?void 0:f.sessionID,roomID:null==f?void 0:f.roomID,roomSessionID:null==f?void 0:f.roomSessionID}),this.logger.info("zb.sh.usi call success cmd "+t)},e.prototype.handleStreamUpdateRsp=function(e,t,r){var n,i,o;if(this.rtm.isDisConnect())this.logger.warn("zb.sh.hsur not login");else if(0==e.body.err_code){this.logger.info("zb.sh.hsur stream seq "+this.streamSeq+" server seq "+e.body.stream_seq),this.streamSeq=this.streamSeq+1;var s=this.room;if(s)if((null===(n=null==e?void 0:e.body)||void 0===n?void 0:n.token_remain_time)&&(this.stateCenter.getRoomByRoomID(null===(i=null==e?void 0:e.header)||void 0===i?void 0:i.room_id)?this.rtm.resetRoomTokenTimer(e.header.room_id,e.body.token_remain_time):this.logger.error("zb.sh.hsur room no found ignore "+JSON.stringify(null===(o=e.header)||void 0===o?void 0:o.room_id))),this.stateCenter.useNetAgent)this.handleStreamSync(e,t,r),delete s.streamInfoList[t];else{e.body.stream_seq>this.streamSeq&&(this.logger.info("zb.sh.hsur seq diff, server: "+e.body.stream_seq+" client: "+this.streamSeq),this.fetchStreamList());for(var a=0;a<e.body.stream_info.length;a++){var c=e.body.stream_info[a].stream_id;this.handleStreamRsp(s,c,e.body.stream_info[a],r),delete s.streamInfoList[c]}}else this.logger.info("hsur.0 room no found")}else this.logger.error("zb.sh.hsur stream update error "+e.body.err_code)},e.prototype.handleStreamSync=function(e,t,r){if(this.handleStreamRsp(this.room,t,{stream_id:t,stream_sid:e.body.stream_sid,stream_ver:e.body.stream_ver,stream_nid:e.body.stream_nid},r),e.body.stream_seq>this.streamSeq)return this.logger.info("zb.sh.hss.1 seq diff server: "+e.body.stream_seq+" client "+this.streamSeq),void this.fetchStreamList();var n=this.room.streamList.find((function(e){return e.stream_id==t}));n&&e.body.stream_ver>n.stream_ver&&this.fetchStreamList(t)},e.prototype.handleStreamRsp=function(e,t,r,i){var o=this.stateCenter.publishStreamList[t];if(o){if(o.state==n.ENUM_PUBLISH_STREAM_STATE.update_info){o.state=n.ENUM_PUBLISH_STREAM_STATE.publishing,this.logger.info("hsur.0 cmd "+i);var s=e.streamList.find((function(e){return e.stream_id==t}));2001===i||s?s&&s.stream_sid!==r.stream_sid&&(this.logger.info("hsur.0 update sid. "+t+" origin:"+s.stream_sid+", new:"+r.stream_sid),s.stream_sid=r.stream_sid):e.streamList.push(r),this.onPublishStateUpdate(n.ENUM_PUBLISH_STATE_UPDATE.start,t,{code:0,message:""})}}else this.logger.info("hsur.0 stream is not exist")},e.prototype.handleFetchStreamListRsp=function(e,t){if(this.logger.info("zb.sh.hfslr call"),this.streamQuerying=!1,0===e.body.err_code)if(this.streamSeq!==e.body.stream_seq){var r=e.body.stream_info;t&&(r=e.body.stream_info.filter((function(e){return e.stream_id===t}))),this.handleFullUpdateStream(e.body.stream_seq,r),this.logger.info("zb.sh.hfslr call success")}else this.logger.info("zb.sh.hfslr same seq");else this.logger.info("zb.sh.hfslr server error=",e.body.err_code)},e.prototype.handleFullUpdateStream=function(e,t){var r=this;this.logger.info("zb.sh.hfus call"),this.streamSeq=e,this.logger.debug("zb.sh.hfus server seq "+this.streamSeq),this.stateCenter.mergeStreamList(this.stateCenter.idName,this.room.streamList,t,(function(e,t,i){0!==e.length&&(r.logger.debug("zb.sh.hfus callback addstream"),r.onStreamUpdated(r.roomID,n.ENUM_STREAM_UPDATE_TYPE.added,r.makeCallbackStreamList(e))),0!==t.length&&(r.logger.debug("zb.sh.hfus callback delstream"),r.onStreamUpdated(r.roomID,n.ENUM_STREAM_UPDATE_TYPE.deleted,r.makeCallbackStreamList(t))),0!==i.length&&(r.logger.debug("zb.sh.hfus callback updatestream"),r.onStreamExtraInfoUpdated(r.roomID,r.makeCallbackStreamList(i)))})),this.logger.info("zb.sh.hfus call success")},e.prototype.handlePushStreamUpdateMsg=function(e){if(this.logger.warn("zb.sh.hpsum call "+JSON.stringify(e)),e.body.stream_info&&0!==e.body.stream_info.length){if(e.body.stream_info.length+this.streamSeq!==e.body.stream_seq)return this.logger.info("zb.sh.hpsum call updatestream"),void this.fetchStreamList();switch(this.streamSeq=e.body.stream_seq,e.body.stream_cmd){case n.ENUM_STREAM_UPDATE_CMD.added:this.handleAddedStreamList(e.body.stream_info);break;case n.ENUM_STREAM_UPDATE_CMD.deleted:this.handleDeletedStreamList(e.body.stream_info);break;case n.ENUM_STREAM_UPDATE_CMD.updated:this.handleUpdatedStreamList(e.body.stream_info)}this.logger.info("zb.sh.hpsum call success")}else this.logger.info("zb.sh.hpsum, emtpy list")},e.prototype.handlePriPushStreamUpdateMsg=function(e){if(this.logger.info("zb.sh.hpsum call"),e.body.streams_info&&0!==e.body.streams_info.length){if(e.body.streams_info.length+this.streamSeq!==e.body.stream_seq)return this.logger.info("zb.sh.hpsum call updatestream"),void this.mergeStreamByStreamSeq(e.body.stream_cmd,e.body.stream_seq,e.body.streams_info);switch(this.streamSeq=e.body.stream_seq,e.body.stream_cmd){case n.ENUM_STREAM_UPDATE_CMD_PRI.added:this.handleAddedStreamList(e.body.streams_info);break;case n.ENUM_STREAM_UPDATE_CMD_PRI.deleted:this.handleDeletedStreamList(e.body.streams_info);break;case n.ENUM_STREAM_UPDATE_CMD_PRI.updated:this.handleUpdatedStreamList(e.body.streams_info)}this.logger.info("zb.sh.hpsum call success")}else this.logger.info("zb.sh.hpsum, emtpy list")},e.prototype.handleAddedStreamList=function(e){this.logger.debug("zb.sh.hasl call");for(var t,r=[],i=0;i<e.length;i++)if(e[i].anchor_id_name!=this.stateCenter.idName&&e[i].id_name!=this.stateCenter.idName&&e[i].user_id!==this.stateCenter.idName){t=!1;for(var o=0;o<this.room.streamList.length;o++)if(e[i].stream_id===this.room.streamList[o].stream_id){t=!0;break}t||r.push(e[i])}else this.logger.debug("hdsl.0 have self stream added");if(0!==r.length){this.logger.debug("zb.sh.hasl callback addstream");for(var s=0;s<r.length;s++)this.room.streamList.push(r[s]);this.onStreamUpdated(this.roomID,n.ENUM_STREAM_UPDATE_TYPE.added,this.makeCallbackStreamList(r))}this.logger.info("zb.sh.hasl call success")},e.prototype.handleDeletedStreamList=function(e){this.logger.debug("zb.sh.hdsl call");for(var t=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.stateCenter.idName&&e[r].id_name!=this.stateCenter.idName&&e[r].user_id!==this.stateCenter.idName){for(var i=this.room.streamList.length-1;i>=0;i--)if(e[r].stream_id===this.room.streamList[i].stream_id){!this.stateCenter.connectChanged&&this.room.streamList.splice(i--,1),t.push(e[r]);break}}else this.logger.debug("zb.sh.hdsl have self stream deleted");0!==t.length&&(this.logger.debug("zb.sh.hdsl callback delstream"),this.onStreamUpdated(this.roomID,n.ENUM_STREAM_UPDATE_TYPE.deleted,this.makeCallbackStreamList(t))),this.logger.info("zb.sh.hdsl call")},e.prototype.handleUpdatedStreamList=function(e){this.logger.debug("zb.sh.husl call");for(var t=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.stateCenter.idName&&e[r].id_name!=this.stateCenter.idName&&e[r].user_id!==this.stateCenter.idName){for(var n=0;n<this.room.streamList.length;n++)if(e[r].stream_id===this.room.streamList[n].stream_id){e[r].extra_info!==this.room.streamList[n].extra_info&&(this.room.streamList[n]=e[r],t.push(e[r]));break}}else this.logger.debug("hsul.0 have self stream updated");0!==t.length&&(this.logger.debug("zb.sh.husl callback updatestream"),this.onStreamExtraInfoUpdated(this.roomID,this.makeCallbackStreamList(t))),this.logger.info("zb.sh.husl call success")},e.prototype.fetchStreamList=function(e){var t,r,n,i=this;if(this.logger.info("zb.sh.fsl call"),this.rtm.isDisConnect())this.logger.info("zb.sh.fsl state error");else if(this.streamQuerying)this.logger.info("zb.sh.fsl already doing");else{if(this.streamQuerying=!0,this.logger.debug("zb.sh.fsl send fetch request"),this.stateCenter.useNetAgent)this.rtm.liveRoomHandler.getStreamList({},(function(t){i.handleFetchStreamListRsp(t,e)}),(function(e){}),{roomID:null===(t=this.room)||void 0===t?void 0:t.roomID,sessionID:null===(r=this.room)||void 0===r?void 0:r.sessionID,roomSessionID:null===(n=this.room)||void 0===n?void 0:n.roomSessionID});else{var o=this.room;this.rtm.service.sendMessage("stream_info",{reserve:0},(function(e){i.handleFetchStreamListRsp(e)}),(function(e,t){}),void 0,{roomID:null==o?void 0:o.roomID,sessionID:null==o?void 0:o.sessionID,roomSessionID:null==o?void 0:o.roomSessionID})}this.logger.info("zb.sh.fsl call success")}},e.prototype.handleReconnectStream=function(e){var t,r,i,o;this.logger.info("zb.sh.hrs call");var s=this.streamCenter.publisherList,a=this.streamCenter.playerList,c=function(a){if((null===(r=null===(t=s[a])||void 0===t?void 0:t.room)||void 0===r?void 0:r.roomID)!==u.roomID)return"continue";var c=e.find((function(e){return e.stream_id==a}));if(s[a].publisher.state!=n.ENUM_PUBLISH_STATE.publishing||c&&(!c||c.anchor_id_name===u.stateCenter.idName||c.id_name===u.stateCenter.idName||c.user_id===u.stateCenter.idName)){if(s[a].publisher.state==n.ENUM_PUBLISH_STATE.stop&&!(null===(o=null===(i=s[a])||void 0===i?void 0:i.retryStreamHandler)||void 0===o?void 0:o.maxTimer)&&e.find((function(e){return e.stream_id==a}))){u.updateStreamInfo(a,n.ENUM_STREAM_SUB_CMD.liveEnd);for(var l=0;l<u.room.streamList.length;l++)if(u.room.streamList[l].stream_id==a){u.room.streamList.splice(l--,1);break}}}else u.updateStreamInfo(a,n.ENUM_STREAM_SUB_CMD.liveBegin,u.stateCenter.publishStreamList[a].extra_info)},u=this;for(var l in s)c(l);for(var l in s)s[l].room.roomID===this.roomID&&s[l].isReDispatch&&(this.logger.info("zb.sh.hrs "+l+"retry dispatch"),(d=s[l].retryDispatchHandler).stopMaxTime(),d.invalid(),d.initStream(l,s[l].publishOption,!0),d.active(0),s[l].isReDispatch=!1);for(var l in a){var d;a[l].room.roomID===this.roomID&&a[l].isReDispatch&&(this.logger.info("zb.sh.hrs "+l+"retry dispatch"),(d=a[l].retryDispatchHandler).stopMaxTime(),d.invalid(),d.initStream(l,a[l].playOption,!1),d.active(0),a[l].isReDispatch=!1)}var h=this.streamCenter.stopedPlayerList,p=function(e){if(h[e].roomID!==f.roomID)return"continue";var t=f.streamCenter,r=h[e],i=r.playOption,o=r.playStream;t.setPlayStateStart(e,i,r.isDataChannel);var s=t.playerList[e].retryDispatchHandler;t.playSuccessCallBackList[e]=h[e].sucCallBack?h[e].sucCallBack:function(e){for(var t=document.querySelectorAll("video, audio"),r=0;r<t.length;r++)o&&t[r].srcObject===o&&(o.getTracks().forEach((function(e){return o.removeTrack(e)})),e.clone().getTracks().forEach((function(e){return o.addTrack(e)})))},h[e].errCallBack&&(t.playErrorCallBackList[e]=h[e].errCallBack),t.onPlayStateUpdate(n.ENUM_PLAY_STATE_UPDATE.retry,e,{code:0,message:""}),s.stopMaxTime(),s.invalid(),s.initStream(e,i,!1),s.startMaxTime(),s.active(0),delete h[e]},f=this;for(var l in h)p(l);this.logger.info("zb.sh.hrs end")},e.prototype.makeCallbackStreamList=function(e){var t,r=[];if(this.stateCenter.useNetAgent&&this.stateCenter.appConfig&&(t=this.stateCenter.appConfig.media_config.play_config.resource_info.filter((function(e){return[n.SignalResourceType.CDN,n.SignalResourceType.DG].includes(e.resource_type)}))),e&&e.length>0)for(var i=0;i<e.length;i++){var o=e[i].stream_id;if(t&&t.length)for(var s=0;s<t.length;s++){for(var a=t[s].resource_type==n.SignalResourceType.DG?"_plus":"",c=[],u=[],l=[],d=0;d<t[s].service_info.length;d++){var h=t[s].service_info[d],p=h.protocol,f=h.url_template.replace("{STREAM_NAME}",o);switch(p){case n.ProtocolType.FLV:c.push(f);break;case n.ProtocolType.HLS:u.push(f);break;case n.ProtocolType.RTMP:l.push(f)}}e[i]["urls_flv"+a]=c,e[i]["urls_m3u8"+a]=u,e[i]["urls_rtmp"+a]=l}var g={user:{userID:e[i].anchor_id_name||e[i].id_name,userName:e[i].anchor_nick_name||e[i].nick_name},extraInfo:e[i].extra_info,streamID:e[i].stream_id,roomID:"",urlFlv:"",urlFlvPlus:"",urlRtmp:"",urlHls:"",urlHlsPlus:"",urlHttpsFlv:"",urlHttpsHls:"",streamGID:e[i].stream_gid,closeType:e[i].close_type};this.setCDNInfo(g,e[i]),r.push(g)}return r},e.prototype.sendBizChannelRequest=function(e,t,r,n){var i=this;void 0===n&&(n=!1),e=Object.assign(e,{is_retry_req:n?1:0});var o=this.room;this.rtm.service.sendMessage("biz_channel",e,(function(e,r){t(e.header.seq,e.body.cmd,e.body.rsp_body)}),(function(n,o){var s=n.body.err_code;"number"!=typeof s||2002!==s?r(s,o,n.body.rsp_body):i.sendBizChannelRequest(e,t,r,!0)}),void 0,{roomID:null==o?void 0:o.roomID,sessionID:null==o?void 0:o.sessionID,roomSessionID:null==o?void 0:o.roomSessionID})},e.prototype.sendBizChannelRequestV2=function(e,t,r,n){var i=this,s=e.server,a=e.location,c=e.cmd,u=e.channel,l=this.rtm.netAgent,d=this.room,h=void 0,p=t.timestamp;t&&(h=JSON.stringify(t));var f={cmd:c,req_body:h,appid:this.stateCenter.appid,timestamp:p||Math.ceil((new Date).getTime()/1e3),token:null==d?void 0:d.token,user_id:this.stateCenter.idName,channel:u||"media"};this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_SEND_BIZCHANNEL_REQUESTV2+" "+JSON.stringify(f)+" request "+JSON.stringify(e)),l.startHttpRequest({service:s,headers:[],body:f,idName:this.stateCenter.idName,method_no:2,ack:!1,location:a},(function(e){i.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_SEND_BIZCHANNEL_REQUESTV2+" rsp "+JSON.stringify(e.body));var s=e.status_code,a=e.body;if(200===s){var c=a;if("string"==typeof a)try{c=JSON.parse(a)}catch(e){throw n(s),e}var u=c.err_code,l=c.rsp_body,d=void 0;try{d=JSON.parse(l)}catch(e){d=l}if(0!==u)return"number"==typeof u&&2002===u?void i.sendBizChannelRequest(t,r,n,!0):void n(s,u,d);r(d)}else n(s)}),(function(e){n(-1,null==e?void 0:e.code,void 0,e)}))},e.prototype.updateStreamExtraInfo=function(e,t,r,n){},e.prototype.setStreamExtraInfo=function(e,t,r,n){},e.prototype._publishTarget=function(e,t,r){},e.prototype.patchStreamList=function(e){var t=this;if("number"==typeof e.body.StreamRefresh&&0!==e.body.StreamRefresh)return this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_PATCH_STREAM_LIST+" stream refresh "),void this.fetchStreamList();e.body.stream_seq===this.streamSeq||this.streamSeqMergeMap||(this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_PATCH_STREAM_LIST+" call update stream "+this.streamSeq+" server "+e.body.stream_seq),this.streamSeqMergeTimer&&clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=setTimeout((function(){t.handleMergeTimeout()}),this.streamListHBMergeInterval)),this.minStreamSeq=e.body.stream_seq},e.prototype.getStreamSeq=function(){return this.streamSeq},e.prototype.mergeStreamByStreamSeq=function(e,t,r){var n=this;this.streamSeqMergeMap||(this.logger.warn(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ+" new merge stream list "+this.streamSeq+" server "+t),this.streamSeqMergeMap={},this.streamSeqMergeTimer&&clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=setTimeout((function(){n.handleMergeTimeout()}),this.streamListMergeInterval)),this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ+" ".concat(this.streamSeqMergeMap," ").concat(e," ").concat(t," ").concat(r)),this.streamSeqMergeMap[t]={cmd:e,streamList:r}},e.prototype.handleMergeTimeout=function(){if(this.streamSeqMergeMap){var e=Object.keys(this.streamSeqMergeMap).map((function(e){return+e})).sort((function(e,t){return e-t}));e[e.length-1]-e[0]+1===e.length||e[e.length-1]>=this.minStreamSeq?this.mergeStream(e):(this.streamSeqMergeMap=null,this.fetchStreamList())}},e.prototype.mergeStream=function(e){var t=this;this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM+" merge streamList "+this.streamSeq+" streamSeqList "+e.join(","));var r=e[e.length-1],i=[];e.forEach((function(e){if(t.streamSeqMergeMap&&t.streamSeqMergeMap[e])switch(t.streamSeqMergeMap[e].cmd){case n.ENUM_STREAM_UPDATE_CMD.added:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=i.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&i.splice(t),i.push(e)}));break;case n.ENUM_STREAM_UPDATE_CMD.deleted:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=i.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&i.splice(t)}));break;case n.ENUM_STREAM_UPDATE_CMD.updated:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=i.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&i.splice(t),i.push(e)}))}})),this.streamSeqMergeMap=null,this.logger.info(o.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM+" "+i),this.handleFullUpdateStream(r,i)},e.prototype.reset=function(){this.minStreamSeq=0,this.streamSeqMergeMap=null,this.streamSeqMergeTimer&&(clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=void 0),this.streamListHBMergeInterval=2e3,this.streamListMergeInterval=5e3},e}();t.StreamHandler=s},6706:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ENUM_SOURCE_TYPE=t.ENUM_DISPATCH_TYPE=t.ENUM_BROADCASTER_STATUS=t.ENUM_PLAY_SOURCE_TYPE=t.ENUM_PUBLISH_STATE_NEGO=t.ENUM_PUSH_SIGNAL_SUB_CMD=t.ENUM_SIGNAL_SUB_CMD=t.QUALITYLEVEL=t.SERVER_ERROR_CODE=t.ENUM_STREAM_UPDATE_CMD_PRI=t.ENUM_STREAM_UPDATE_CMD=t.MINIUM_HEARTBEAT_INTERVAL=t.STREAM_DELETE_REASON=t.ENUM_NETWORK_STATE=t.ENUM_RUN_STATE=t.ENUM_STREAM_UPDATE_TYPE=t.ENUM_STREAM_CMD_PRI=t.ENUM_STREAM_SUB_CMD=t.ENUM_PUBLISH_STREAM_STATE=t.MAX_RETRY_CONNECT_INTERVAL=t.MAX_TRANS_DATA_LENGTH=t.MAX_TRANS_TYPE_LENGTH=t.MAX_MIX_TASK_ID_LENGTH=t.MAX_MESSAGE_LENGTH=t.MAX_ROOM_ID_LENGTH=t.MAX_USER_NAME_LENGTH=t.MAX_USER_ID_LENGTH=t.MAX_STREAM_ID_LENGTH=t.MAX_TRY_HEARTBEAT_COUNT=t.SEND_MSG_TIMEOUT=t.SEND_MSG_RESET=t.MAX_TRY_CONNECT_COUNT=t.streamMap=t.ENUM_CONNECT_STATE=t.ProtocolType=t.SignalResourceType=t.ENUM_PROBE_STATE=t.ENUM_PLAY_STATE_NEGO=t.ENUM_PLAYER_STATE=t.ENUM_PLAY_STATE=t.ENUM_PUBLISH_STATE=t.ENUM_SCREEM_RESOLUTION_TYPE=t.ENUM_RESOLUTION_TYPE=t.ENUM_SIGNAL_STATE=t.ERROR_CODES=t.ENUM_REMOTE_TYPE=t.LOG_LEVEL=t.ENUM_LOG_LEVEL=t.ROOMVERSION=t.PROTO_VERSION=void 0,t.BusinessService=t.NetConnection=t.ZegoExpressWebRTM=t.ZegoDataReport=t.ZegoLogger=t.ZegoExpressWebRTMEngine=t.getReportSeq=t.getSeq=t.ResourceMode=t.PlayMode=t.ZegoSEIType=t.QUALITY_CONSTANT=t.QualityGrade=t.REPORT_ACTION=t.ENUM_RETRY_STATE=t.ENUM_PLAY_STATE_UPDATE=t.ENUM_PUBLISH_STATE_UPDATE=t.LinkedList=t.ListNode=t.E_CLIENT_TYPE=void 0,t.PROTO_VERSION="2.20.2",t.ROOMVERSION="V1",function(e){e[e.debug=0]="debug",e[e.info=1]="info",e[e.warn=2]="warn",e[e.error=3]="error",e[e.report=99]="report",e[e.disable=100]="disable"}(t.ENUM_LOG_LEVEL||(t.ENUM_LOG_LEVEL={})),t.LOG_LEVEL={debug:0,info:1,warn:2,error:3,report:99,disable:100},function(e){e[e.disable=0]="disable",e[e.websocket=1]="websocket",e[e.https=2]="https"}(t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={})),t.ERROR_CODES={ROOM_SESSION_ID_ERR:1000000152,FETCH_TRANS_UNKNOWN_CHANNEL:1000001108,FETCH_TRANS_UNKNOWN_TYPE:1000001109,FETCH_TRANS_WRONG_SEQ:1000001110},function(e){e[e.disconnected=0]="disconnected",e[e.connecting=1]="connecting",e[e.connected=2]="connected"}(t.ENUM_SIGNAL_STATE||(t.ENUM_SIGNAL_STATE={})),t.ENUM_RESOLUTION_TYPE={LOW:{width:320,height:240,frameRate:15,bitRate:300},MEDIUM:{width:640,height:480,frameRate:15,bitRate:800},HIGH:{width:1280,height:720,frameRate:20,bitRate:1500}},t.ENUM_SCREEM_RESOLUTION_TYPE={LOW:{frameRate:20,bitRate:800},MEDIUM:{frameRate:15,bitRate:1500},HIGH:{frameRate:5,bitRate:2e3}},t.ENUM_PUBLISH_STATE={start:0,waitingSessionRsp:1,waitingOfferRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,publishing:6,stop:7,didNotStart:8},t.ENUM_PLAY_STATE={start:0,waitingSessionRsp:1,waitingOfferRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,playing:6,stop:7,didNotStart:8},t.ENUM_PLAYER_STATE={start:0,playing:1,stop:2},t.ENUM_PLAY_STATE_NEGO={stop:0,start:1,waiterAnswer:2,waitingCandidate:3,sendCandidate:4,iceConnected:5,iceDisconnected:6,iceClosed:7,iceFailed:8},function(e){e[e.tryProbe=0]="tryProbe",e[e.probed=2]="probed"}(t.ENUM_PROBE_STATE||(t.ENUM_PROBE_STATE={})),function(e){e[e.CDN=0]="CDN",e[e.RTC=1]="RTC",e[e.L3=2]="L3",e[e.DG=3]="DG"}(t.SignalResourceType||(t.SignalResourceType={})),function(e){e[e.UDP=0]="UDP",e[e.RTMP=1]="RTMP",e[e.FLV=2]="FLV",e[e.HLS=3]="HLS",e[e.WEBRTC=4]="WEBRTC"}(t.ProtocolType||(t.ProtocolType={})),t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},t.streamMap={"/lr/push/stream_add":12001,"/lr/push/stream_delete":12002,"/lr/push/stream_update":12003},t.MAX_TRY_CONNECT_COUNT=3,t.SEND_MSG_RESET=2,t.SEND_MSG_TIMEOUT=1,t.MAX_TRY_HEARTBEAT_COUNT=5,t.MAX_STREAM_ID_LENGTH=256,t.MAX_USER_ID_LENGTH=64,t.MAX_USER_NAME_LENGTH=256,t.MAX_ROOM_ID_LENGTH=128,t.MAX_MESSAGE_LENGTH=1024,t.MAX_MIX_TASK_ID_LENGTH=256,t.MAX_TRANS_TYPE_LENGTH=128,t.MAX_TRANS_DATA_LENGTH=4096,t.MAX_RETRY_CONNECT_INTERVAL=12,t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_CMD_PRI={liveBegin:"zegochat_js.room_stream_create_req",liveEnd:"zegochat_js.room_stream_delete_req",liveUpdate:"zegochat_js.room_stream_update_req"},t.ENUM_STREAM_UPDATE_TYPE={added:1,deleted:0},function(e){e[e.logout=0]="logout",e[e.trylogin=1]="trylogin",e[e.login=2]="login"}(t.ENUM_RUN_STATE||(t.ENUM_RUN_STATE={})),function(e){e[e.offline=0]="offline",e[e.online=1]="online"}(t.ENUM_NETWORK_STATE||(t.ENUM_NETWORK_STATE={})),t.STREAM_DELETE_REASON={0:{code:1,description:"user_stop_publishing_stream_normal"},1:{code:2,description:"user_heart_beat_timeout"},2:{code:3,description:"user_repeat_login"},3:{code:4,description:"user_kicked_out"},4:{code:5,description:"user_offline"},100:{code:6,description:"remove_by_server"}},function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CDN=1]="CDN",e[e.RTC=2]="RTC",e[e.L3=3]="L3"}(n||(n={})),t.MINIUM_HEARTBEAT_INTERVAL=3e3,t.ENUM_STREAM_UPDATE_CMD={added:12001,deleted:12002,updated:12003},t.ENUM_STREAM_UPDATE_CMD_PRI={added:1,updated:2,deleted:3},t.SERVER_ERROR_CODE=1e4,function(e){e[e.low=1]="low",e[e.stantard=2]="stantard",e[e.hight=3]="hight",e[e.custome=4]="custome"}(t.QUALITYLEVEL||(t.QUALITYLEVEL={})),t.ENUM_SIGNAL_SUB_CMD={none:0,joinLiveRequest:1001,joinLiveResult:1002,joinLiveInvite:1003,joinLiveStop:1004},t.ENUM_PUSH_SIGNAL_SUB_CMD={none:0,pushJoinLiveRequest:11001,pushJoinLiveResult:11002,pushJoinLiveInvite:11003,pushJoinLiveStop:11004},t.ENUM_PUBLISH_STATE_NEGO={stop:0,start:1,waiterAnswer:2,waitingCandidate:3,sendCandidate:4,iceConnected:5,iceDisconnected:6,iceClosed:7,iceFailed:8},function(e){e[e.cdn=0]="cdn",e[e.ultra=1]="ultra"}(t.ENUM_PLAY_SOURCE_TYPE||(t.ENUM_PLAY_SOURCE_TYPE={})),function(e){e[e.stop=0]="stop",e[e.start=1]="start"}(t.ENUM_BROADCASTER_STATUS||(t.ENUM_BROADCASTER_STATUS={})),function(e){e[e.cdn=0]="cdn",e[e.ultra=1]="ultra",e[e.customUrl=2]="customUrl"}(t.ENUM_DISPATCH_TYPE||(t.ENUM_DISPATCH_TYPE={})),function(e){e[e.CDN=0]="CDN",e[e.BGP=1]="BGP"}(t.ENUM_SOURCE_TYPE||(t.ENUM_SOURCE_TYPE={})),function(e){e[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallPragram=2]="ClientType_SmallPragram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc"}(t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={}));var i=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._id=null,this.next=null,this.prev=null,this._id=e,this._data=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id?this._id:null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),e.prototype.hasNext=function(){return this.next&&this.next.id},e.prototype.hasPrev=function(){return this.prev&&this.prev.id},e}();t.ListNode=i;var o=function(){function e(){this.start=new i,this.end=new i,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return e.prototype.insertBefore=function(e,t){var r=new i(this._idCounter,t);return r.next=e,r.prev=e.prev,e.prev&&(e.prev.next=r),e.prev=r,++this._idCounter,++this._numNodes,r},e.prototype.addLast=function(e){return this.insertBefore(this.end,e)},e.prototype.add=function(e){return this.addLast(e)},e.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},e.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},e.prototype.size=function(){return this._numNodes},e.prototype.getFromFirst=function(e){var t=0,r=this.start.next;if(e>=0)for(;t<e&&null!==r;)r=r.next,++t;else r=null;if(null===r)throw"Index out of bounds.";return r},e.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},e.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},e.prototype.removeFirst=function(){var e=null;return this._numNodes>0&&this.start.next&&(e=this.remove(this.start.next)),e},e.prototype.removeLast=function(){var e=null;return this._numNodes>0&&this.end.prev&&(e=this.remove(this.end.prev)),e},e.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},e.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},e.prototype.find=function(e){for(var t=this.start,r=!1,n=null;t.hasNext()&&!r;)e(t=t.next)&&(n=t,r=!0);return n},e.prototype.map=function(e){for(var t=this.start,r=[];t.hasNext();)e(t=t.next)&&r.push(t);return r},e.prototype.push=function(e){return this.addLast(e)},e.prototype.unshift=function(e){this.insertBefore(this._numNodes>0?this.start.next:this.end,e)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(){return this.removeFirst()},e}();t.LinkedList=o,t.ENUM_PUBLISH_STATE_UPDATE={start:0,error:1,retry:2},t.ENUM_PLAY_STATE_UPDATE={start:0,error:1,retry:2,stop:3},t.ENUM_RETRY_STATE={didNotStart:0,retrying:1,finished:2},t.REPORT_ACTION={eventStart:"eventStart",eventEndWithMsgInfo:"eventEndWithMsgInfo",addEventMsg:"addEventMsg",addEvent:"addEvent",eventEnd:"eventEnd",addMsgInfo:"addMsgInfo"},function(e){e[e.Unknown=-1]="Unknown",e[e.Excellent=0]="Excellent",e[e.Good=1]="Good",e[e.Middle=2]="Middle",e[e.Poor=3]="Poor",e[e.Die=4]="Die"}(t.QualityGrade||(t.QualityGrade={})),function(e){e[e.MinQuality=0]="MinQuality",e[e.DieQuality=0]="DieQuality",e[e.PoorMinQuality=1]="PoorMinQuality",e[e.MiddleMinQuality=30]="MiddleMinQuality",e[e.GoodMinQuality=60]="GoodMinQuality",e[e.ExcellentMinQuality=85]="ExcellentMinQuality",e[e.MaxQuality=100]="MaxQuality"}(t.QUALITY_CONSTANT||(t.QUALITY_CONSTANT={})),function(e){e[e.ZegoDefined=0]="ZegoDefined",e[e.UserUnregister=1]="UserUnregister"}(t.ZegoSEIType||(t.ZegoSEIType={})),function(e){e[e.CDN=0]="CDN",e[e.L3=1]="L3"}(t.PlayMode||(t.PlayMode={})),function(e){e[e.RTC=0]="RTC",e[e.CDN=1]="CDN",e[e.L3=2]="L3",e[e.DG=3]="DG"}(t.ResourceMode||(t.ResourceMode={}));var s=r(4119);Object.defineProperty(t,"getSeq",{enumerable:!0,get:function(){return s.getSeq}}),Object.defineProperty(t,"getReportSeq",{enumerable:!0,get:function(){return s.getReportSeq}}),Object.defineProperty(t,"ZegoExpressWebRTMEngine",{enumerable:!0,get:function(){return s.ZegoExpressWebRTMEngine}}),Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return s.ZegoLogger}}),Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return s.ZegoDataReport}}),Object.defineProperty(t,"ZegoExpressWebRTM",{enumerable:!0,get:function(){return s.ZegoExpressWebRTM}}),Object.defineProperty(t,"NetConnection",{enumerable:!0,get:function(){return s.NetConnection}}),Object.defineProperty(t,"BusinessService",{enumerable:!0,get:function(){return s.BusinessService}})},2752:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},STREAMID_TOO_LONG:{code:1000014,message:"stream ID is too long"},STREAM_ID_NULL:{code:1000015,message:"streamID is empty"},STREAM_ID_INVALID_CHARACTER:{code:1000016,message:"stream ID contains illegal characters"},NETWORK_BROKEN:{code:1000017,message:"network is broken"},LOCALSTREAM_WRONG:{code:1000018,message:"local stream wrong"},INPUT_PARAM:{code:1100001,message:"input param error."},TIMEOUT:{code:1100002,message:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},INIT_SDK_WRONG:{code:1101e3,message:"init sdk wrong"},WX_GET_SETTING_FAIL:{code:1101001,message:"wx get setting fail"},GET_CONFIG_FAIL:{code:1101002,message:"get app config fail"},USER_ID_NULL:{code:1002005,message:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,message:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,message:"user ID is too long"},USER_NAME_NULL:{code:1002008,message:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,message:"username is too long"},ROOM_ID_NULL:{code:1002011,message:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,message:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,message:"room ID is too long"},LOGIN_TIMEOUT:{code:1002031,message:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,message:"users logging into the room exceeds the maximum number"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,message:"kickout may be the same user ID login other"},ROOM_RETRY_TIMEOUT:{code:1002053,message:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,message:"server has sent a signal to kick out"},ROOM_INNER_ERROR:{code:1002099,message:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,message:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,message:"parse json error."},LOGIN_PROCESSING:{code:1102012,message:"login is processing."},LIVEROOM_REQUEST_ERROR:{code:1102013,message:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,message:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,message:"user login state is wrong."},TOKEN_ERROR:{code:1102016,message:"token error"},DISPATCH_ERROR:{code:1102017,message:"dispatch error"},TOKEN_EXPIRED:{code:1102018,message:"token expired"},SUBCMD_ERROR:{code:1102019,message:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,message:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,message:"biz channel error."},DISPATCH_TIMEOUT:{code:1102022,message:"dispatch request timeout"},CONNECT_FAILED:{code:1102023,message:"connect signal fail"},PUBLISHER_MEDIA_SERVER_FORBID:{code:1003025,message:"stream is forbided by media server"},PUBLISHER_EXTRA_INFO_TOO_LONG:{code:1003051,message:"stream extra info is too long"},PUBLISHER_PARAM:{code:1103001,message:"input param error"},PUBLISHER_BROWSER_NOT_SUPPORT:{code:1103002,message:"browser do not support"},PUBLISHER_DISPATCH_FAIL:{code:1103003,message:"dispatch request error"},PUBLISHER_SCREEN_FAILED:{code:1103010,message:"screen fail"},ENUMERATE_DEVICES_FAIL:{code:1103011,message:"enumerate devices fail"},PUBLISHER_DISPATCH_REQUEST_FAIL:{code:1103020,message:"dispatch request fail"},PUBLISHER_SESSION_REQUEST_FAIL:{code:1103021,message:"session request fail"},PUBLISHER_CREATE_OFFER_ERROR:{code:1103022,message:"create offer error"},PUBLISHER_SET_LOCAL_DESC_ERROR:{code:1103023,message:"setLocalDescription error"},PUBLISHER_MEDIA_DESC_ERROR:{code:1103024,message:"mediaDesc error"},PUBLISHER_SET_REMOTE_DESC_ERROR:{code:1103025,message:"other side offer error"},PUBLISHER_CANDIDATE_ERROR:{code:1103026,message:"candidate error"},PUBLISHER_SESSION_CLOSED:{code:1103027,message:"server session closed"},PUBLISHER_MEDIA_CONNECTION_ERROR:{code:1103028,message:"ice connection error"},PUBLISHER_SERVER_NEGO_TIMEOUT:{code:1103030,message:"negotiation timeout"},PUBLISH_DEVICE_OUT_ERR:{code:1103041,message:"device change "},PUBLISH_SCREEN_CANCELED:{code:1103042,message:"screen canceled"},PUBLISH_SCREEN_NOT_SUPPORT:{code:1103043,message:"screen not support"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"},REPEATED_PULL:{code:1103049,message:"repeated pull same stream"},PUBLISHER_WEBSOCKET_DISCONNECTED:{code:1103050,message:"websocket disconnected"},PUBLISHER_RETRY_TIMEOUT:{code:1103051,message:"publisher retry timeout"},PUBLISHER_HTTPS_REQUIRED:{code:1103053,message:"https is required"},PUBLISHER_NO_PREVIEW:{code:1103054,message:"no preview"},PUBLISHER_STREAM_NO_FOUND:{code:1103055,message:"publish stream no found"},PUBLISHER_IS_PUBLISHING:{code:1103056,message:"publish is publishing"},PUBLISHER_CLIENT_IP_CHANGED:{code:1103058,message:"client ip changed"},PUBLISHER_TTL_OVERTIME:{code:1103059,message:"ttl over time"},PUBLISHER_SESSION_TIMEOUT:{code:1103060,message:"session request timeout"},PUBLISHER_GET_USER_MEDIA_FAIL:{code:1103061,message:"get media fail"},PUBLISHER_DEVICE_NO_ALLOWED:{code:1103064,message:"get device not allowed"},PUBLISHER_DEVICE_NO_READABLE:{code:1103065,message:"device is not readable"},PUBLISHER_OVER_CONSTRAINED:{code:1103066,message:"device does not meet constraints"},PUBLISHER_UPDATE_SDP_TIMEOUT:{code:1103067,message:"update sdp time out"},PUBLISHER_UPDATE_SDP_FAIL:{code:1103068,message:"update sdp fail"},VIDEO_EFFECT_IS_STARTING:{code:1103073,message:"video effect is starting, please operate after video effect is started"},PUBLISHER_NET_PROBE_POOR:{code:1103069,message:"publish stream poor and net probe poor"},PLAYER_PARAM:{code:1104001,message:"input parm error"},PLAYER_DISPATCH_REQUEST_FAIL:{code:1104020,message:"dispatch request fail"},PLAYER_SESSION_REQUEST_FAIL:{code:1104021,message:"session request fail"},PLAYER_CREATE_OFFER_ERROR:{code:1104022,message:"create offer error"},PLAYER_SET_LOCAL_DESC_ERROR:{code:1104023,message:"setLocalDescription error"},PLAYER_MEDIA_DESC_ERROR:{code:1104024,message:"mediaDesc error"},PLAYER_SET_REMOTE_DESC_ERROR:{code:1104025,message:"other side offer error"},PLAYER_CANDIDATE_ERROR:{code:1104026,message:"candidate error"},PLAYER_SESSION_CLOSED:{code:1104027,message:"server session closed"},PLAYER_MEDIA_CONNECTION_ERROR:{code:1104028,message:"ice connection error"},PLAYER_WEBSOCKET_DISCONNECTED:{code:1104029,message:"websocket disconnected"},PLAYER_SERVER_NEGO_TIMEOUT:{code:1104030,message:"negotiation timeout"},PLAYER_RETRY_TIMEOUT:{code:1104031,message:"player retry timeout"},PLAYER_IS_PLAYING:{code:1104032,message:"player is playing"},PLAYER_CLIENT_IP_CHANGED:{code:1104033,message:"client ip changed"},PLAYER_TTL_OVERTIME:{code:1104034,message:"ttl is over time"},PLAYER_SESSION_RESET:{code:1104035,message:"reset session push"},PLAYER_SESSION_TIMEOUT:{code:1104036,message:"session request timeout"},PLAYER_PROBE_TIMEOUT:{code:1104037,message:"probe time out"},PLAYER_UNSUPPORTED_PROTOCOL:{code:1104038,message:"resource mode is not supported"},PLAYER_STREAM_NOT_EXIST:{code:1104039,message:"play stream not found"},PLAYER_NET_PROBE_POOR:{code:1103040,message:"publish stream poor and net probe poor"},DEVICE_ERROR_TYPE_UNPLUGGED:{code:1006006,message:"the device is unplugged"},IM_CONTENT_NULL:{code:1009001,message:"message content is empty"},IM_CONTENT_TOO_LONG:{code:1009002,message:"message content is too long"},IM_SEND_FAILED:{code:1009010,message:"failed to send message"},FREQ_LIMITED:{code:1109001,message:"frequency limited."}}},3529:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWechatLogEvent=t.ZegoRTCLogEvent=void 0;var n=r(2752),i=function(e){return e};t.ZegoRTCLogEvent={kZegoTaskCreateStream:{event:"/sdk/create_stream",error:{kBrowserNotSupportError:n.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kParamError:n.errorCodeList.PUBLISHER_PARAM,kScreenCancelError:n.errorCodeList.PUBLISH_SCREEN_CANCELED,kScreenFailedError:n.errorCodeList.PUBLISHER_SCREEN_FAILED,kScreenNotSupportError:n.errorCodeList.PUBLISH_SCREEN_NOT_SUPPORT,kHttpsRequiredError:n.errorCodeList.PUBLISHER_HTTPS_REQUIRED,kGetUserMediaError:n.errorCodeList.PUBLISHER_GET_USER_MEDIA_FAIL,kDeviceNoAllowedError:n.errorCodeList.PUBLISHER_DEVICE_NO_ALLOWED,kDeviceNoReadableError:n.errorCodeList.PUBLISHER_DEVICE_NO_READABLE,kDeviceOverConstrainedError:n.errorCodeList.PUBLISHER_OVER_CONSTRAINED},stream_type:i,screen:i,camera:i,custom:i},kZegoTaskPublishStart:{event:"/sdk/api/publish_request",error:{kPublishParamError:n.errorCodeList.PUBLISHER_PARAM,kPublishNetworkTimeoutError:n.errorCodeList.TIMEOUT,kPublishDispatchTimeoutError:n.errorCodeList.DISPATCH_TIMEOUT,kPublishDispatchError:n.errorCodeList.DISPATCH_ERROR,kPublishNetworkBrokenError:n.errorCodeList.NETWORK_BROKEN,kPublishNoPreviewError:n.errorCodeList.PUBLISH_NO_PREVIEW,kPublishEffectIsStarting:n.errorCodeList.VIDEO_EFFECT_IS_STARTING,kPublishNoLoginError:n.errorCodeList.NOT_LOGIN,kPublishRetryTimeoutError:n.errorCodeList.PUBLISHER_RETRY_TIMEOUT,kMediaServerForbidError:n.errorCodeList.PUBLISHER_MEDIA_SERVER_FORBID,kPublishTokenExpiredError:n.errorCodeList.TOKEN_EXPIRED,kPublishSessionClosedError:n.errorCodeList.PUBLISHER_SESSION_CLOSED,kPublishNegoTimeoutError:n.errorCodeList.PUBLISHER_SERVER_NEGO_TIMEOUT,kCreateOfferError:n.errorCodeList.PUBLISHER_CREATE_OFFER_ERROR,kSetLocalDescError:n.errorCodeList.PUBLISHER_SET_LOCAL_DESC_ERROR,kSessionTimeoutError:n.errorCodeList.PUBLISHER_SESSION_TIMEOUT,kSessionRequestError:n.errorCodeList.PUBLISHER_SESSION_REQUEST_FAIL,kSetRemoteDescError:n.errorCodeList.PUBLISHER_SET_REMOTE_DESC_ERROR,kMediaConnectionError:n.errorCodeList.PUBLISHER_MEDIA_CONNECTION_ERROR,kWebsocketDisconnectedError:n.errorCodeList.PUBLISHER_WEBSOCKET_DISCONNECTED,kMediaDescError:n.errorCodeList.PUBLISHER_MEDIA_DESC_ERROR,kCandidateError:n.errorCodeList.PUBLISHER_CANDIDATE_ERROR,kIsPublishing:n.errorCodeList.PUBLISHER_IS_PUBLISHING,kClientIPChangedError:n.errorCodeList.PUBLISHER_CLIENT_IP_CHANGED,kTTLOverTimeError:n.errorCodeList.PUBLISHER_TTL_OVERTIME,kUpdateMediaDescriptionTimeOut:n.errorCodeList.PUBLISHER_UPDATE_SDP_TIMEOUT,kUpdateMediaDescriptionError:n.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL,kPublishNetProbePoor:n.errorCodeList.PUBLISHER_NET_PROBE_POOR},publishOption:i,message:i,session_id:i,stream:i,video_en_codec_id:i,cap_w:i,cap_h:i,w:i,h:i,video_en_fps:i,video_en_bps:i,audio_c_channel_count:i,audio_en_bps:i,aec_level:i,ans_level:i,agc:i,traffic_control_min_video_bitrate:i,use_na:i},kZegoTaskVideoCaptureSize:{event:"/sdk/api/publish_video_c_size",session_id:i,w:i,h:i},kZegoTaskVideoPlaySize:{event:"/sdk/play_video_size_changed",session_id:i,w:i,h:i},kZegoTaskRePublish:{event:"/sdk/republish",stream:i},kZegoTaskPublishStop:{event:"/sdk/stop_publish",error:{kParamError:n.errorCodeList.PUBLISHER_PARAM},stream:i},kZegoTaskPlayStart:{event:"/sdk/api/play_request",error:{kStreamIDNullError:n.errorCodeList.STREAM_ID_NULL,kPlayParamError:n.errorCodeList.PLAYER_PARAM,kPlayStreamIDToLongError:n.errorCodeList.STREAMID_TOO_LONG,kPlayStreamIDInvalidCharacterError:n.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPlayNoLoginError:n.errorCodeList.NOT_LOGIN,kPlayRepeatedPullError:n.errorCodeList.REPEATED_PULL,kPlayNetworkTimeoutError:n.errorCodeList.TIMEOUT,kPlayDispatchTimeoutError:n.errorCodeList.DISPATCH_TIMEOUT,kPlayDispatchError:n.errorCodeList.DISPATCH_ERROR,kPlayNetworkBrokenError:n.errorCodeList.NETWORK_BROKEN,kPlayUnsupportedResourceMode:n.errorCodeList.PLAYER_UNSUPPORTED_PROTOCOL,kPlayStreamNotFound:n.errorCodeList.PLAYER_STREAM_NOT_EXIST,kPlayRetryTimeoutError:n.errorCodeList.PLAYER_RETRY_TIMEOUT,kPlaySessionClosedError:n.errorCodeList.PLAYER_SESSION_CLOSED,kPlaySessionResetError:n.errorCodeList.PLAYER_SESSION_RESET,kPlayNegoTimeoutError:n.errorCodeList.PLAYER_SERVER_NEGO_TIMEOUT,kCreateOfferError:n.errorCodeList.PLAYER_CREATE_OFFER_ERROR,kSetLocalDescError:n.errorCodeList.PLAYER_SET_LOCAL_DESC_ERROR,kSessionRequestError:n.errorCodeList.PLAYER_SESSION_REQUEST_FAIL,kSessionTimeoutError:n.errorCodeList.PLAYER_SESSION_TIMEOUT,kSetRemoteDescError:n.errorCodeList.PLAYER_SET_REMOTE_DESC_ERROR,kMediaConnectionError:n.errorCodeList.PLAYER_MEDIA_CONNECTION_ERROR,kWebsocketDisconnectedError:n.errorCodeList.PLAYER_WEBSOCKET_DISCONNECTED,kCandidateError:n.errorCodeList.PLAYER_CANDIDATE_ERROR,kMediaDescError:n.errorCodeList.PLAYER_MEDIA_DESC_ERROR,kIsPlaying:n.errorCodeList.PLAYER_IS_PLAYING,kClientIPChangedError:n.errorCodeList.PLAYER_CLIENT_IP_CHANGED,kTTLOverTimeError:n.errorCodeList.PLAYER_TTL_OVERTIME,kProbeTimeOutError:n.errorCodeList.PLAYER_PROBE_TIMEOUT,kPlayNetProbePoor:n.errorCodeList.PLAYER_NET_PROBE_POOR},playOption:i,message:i,session_id:i,stream:i,audio_activate:i,video_activate:i,use_na:i,biz_product:i},kZegoTaskRePlay:{event:"/sdk/replay",stream:i},kZegoTaskPlayStop:{event:"/sdk/stop_play",error:{kParamError:n.errorCodeList.PUBLISHER_PARAM},stream:i,biz_product:i},kZegoTaskEnumDevices:{event:"/device/list",error:{kBrowserNotSupportError:n.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:n.errorCodeList.ENUMERATE_DEVICES_FAIL},dev_list:i},kZegoTaskAudioOutput:{event:"/device/audio_capture",error:{kBrowserNotSupportError:n.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:n.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:i,device:i},kZegoTaskVideoCapture:{event:"/device/video_capture",error:{kBrowserNotSupportError:n.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:n.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:i,device:i},kZegoTaskDeviceInterrupt:{event:"/device/interrupt",error:{kBrowserNotSupportError:n.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:n.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:i,interrupt:i},kZegoTaskSetDebug:"/sdk/set_debug",kZegoTaskSetLog:"/sdk/set_log_config",kZegoTaskCheckSystemRequirements:{event:"/sdk/check_system",capability:i},kZegoTaskRemoteCameraUpdate:{event:"/sdk/remote_camera_update",stream:i,status:i},kZegoTaskRemoteMicUpdate:{event:"/sdk/remote_mic_update",stream:i,status:i},kZegoTaskDestroyStream:{event:"/sdk/destroy_stream",error:{kLocalStreamError:n.errorCodeList.LOCALSTREAM_WRONG}},kZegoTaskScreenSharingEnded:"/sdk/screen_share_end",kZegoTaskAudioOutputChanged:{event:"/device/api/audio_output",session_id:i,stream:i,device:i,reason:i},kZegoEventPublishStat:"/sdk/publish_stat_report",kZegoEventPlayStat:"/sdk/play_stat_report",kZegoTaskLiveRoomGetStreamUpdateInfo:{event:"/liveroom/get_stream_update_info",stream_update_type:i,update_stream:i},kZegoTaskLiveRoomGetStreamExtraInfo:{event:"/liveroom/get_stream_extra_info",update_stream:i},kZegoTaskPlayDecodeFirstVideoFrame:{event:"/sdk/play_decode_first_video_frame",session_id:i,fft_consumed:i,biz_product:i},kZegoVisibilityChange:{event:"/app/background"},kZegoSetCaptureVolume:{event:"/sdk/set_capture_volume",error:{kParamError:n.errorCodeList.INPUT_PARAM}},kZegoListener:{event:"/sdk/listener"},kZegoNetProbe:{event:"/sdk/net_probe"},kZegoNetProbeResult:{event:"/sdk/net_probe_result"},kZegoTaskCloudSettingCache:{event:"/cloud_setting/cache"},kZegoTaskCloudSettingRefresh:{event:"/cloud_setting/refresh"},kZegoTaskCDNPlay:{event:"/cdn/play",protocol:i,tryidx:i,url:i,stop_reason:i,biz_product:i},kZegoTaskL3Play:{event:"/L3/play",protocol:i,tryidx:i,url:i,stop_reason:i,biz_product:i},kZegoTaskSrcChange:{event:"/sdk/play_src_changed",last_src:i,src:i,biz_product:i}},t.ZegoWechatLogEvent={kZegoTaskCheckSystemRequirements:{event:"/sdk/check_system",error:{kCheckSystemGetSettingFailError:n.errorCodeList.WX_GET_SETTING_FAIL},capability:i},kZegoTaskPublishStart:{event:"/sdk/api/publish_request",error:{kPublishStreamIDNullError:n.errorCodeList.STREAM_ID_NULL,kPublishParamError:n.errorCodeList.PUBLISHER_PARAM,kPublishStreamIDTooLongError:n.errorCodeList.STREAMID_TOO_LONG,kPublishStreamIDInvalidCharacterError:n.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPublishNetworkTimeoutError:n.errorCodeList.TIMEOUT,kPublishDispatchTimeoutError:n.errorCodeList.DISPATCH_TIMEOUT,kPublishDispatchError:n.errorCodeList.DISPATCH_ERROR,kPublishNetworkBrokenError:n.errorCodeList.NETWORK_BROKEN,kPublishNoLoginError:n.errorCodeList.NOT_LOGIN,kPublishRetryTimeoutError:n.errorCodeList.PUBLISHER_RETRY_TIMEOUT,kIsPublishing:n.errorCodeList.PUBLISHER_IS_PUBLISHING},publishOption:i,stream:i,message:i},kZegoTaskPlayStart:{event:"/sdk/api/play_request",error:{kPlayStreamIDNullError:n.errorCodeList.STREAM_ID_NULL,kPlayParamError:n.errorCodeList.PLAYER_PARAM,kPlayStreamIDTooLongError:n.errorCodeList.STREAMID_TOO_LONG,kPlayStreamIDInvalidCharacterError:n.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPlayNoLoginError:n.errorCodeList.NOT_LOGIN,kPlayRepeatedPullError:n.errorCodeList.REPEATED_PULL,kPlayNetworkTimeoutError:n.errorCodeList.TIMEOUT,kPlayDispatchTimeoutError:n.errorCodeList.DISPATCH_TIMEOUT,kPlayDispatchError:n.errorCodeList.DISPATCH_ERROR,kPlayNetworkBrokenError:n.errorCodeList.NETWORK_BROKEN,kPlayRetryTimeoutError:n.errorCodeList.PLAYER_RETRY_TIMEOUT,kIsPlaying:n.errorCodeList.PLAYER_IS_PLAYING},playOption:i,message:i,session_id:i,stream:i,audio_activate:i,video_activate:i},kZegoEventPublishStat:"/sdk/publish_stat_report",kZegoEventPlayStat:"/sdk/play_stat_report",kZegoTaskRePublish:"/sdk/republish",kZegoTaskRePlay:"/sdk/replay",kZegoTaskPublishStop:{event:"/sdk/stop_publish",error:{kParamError:n.errorCodeList.PUBLISHER_PARAM},stream:i},kZegoTaskPlayStop:{event:"/sdk/stop_play",error:{kParamError:n.errorCodeList.PUBLISHER_PARAM},stream:i},kZegoTaskLiveRoomGetStreamUpdateInfo:{event:"/liveroom/get_stream_update_info",stream_update_type:i,update_stream:i},kZegoTaskLiveRoomGetStreamExtraInfo:{event:"/liveroom/get_stream_extra_info",update_stream:i}}},2367:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WEBRTC_ACTION=void 0,function(e){e.SET_VIDEO_CONFIG="zc.svc",e.SET_AUDIO_CONFIG="zc.sac",e.REPLACE_TRACK="zc.rp",e.SET_BEAUTY_EFFECT="zc.sbe",e.ENABLE_STREAM="zc.es",e.ENABLE_MIC_ONLY="zc.emo",e.ACTIVATE_SEI_INSERT="zc.asi",e.MUTE_PUBLISH_STREAM_VIDEO="zc.mpsv.0",e.MUTE_PUBLISH_STREAM_AUDIO="zc.mpsa.0",e.MUTE_MIC="zc.mm",e.MUTE_PLAY_STREAM_VIDEO="zc.mpsv.1",e.MUTE_PLAY_STREAM_AUDIO="zc.mpsa.1",e.ADD_TRACK="zc.at",e.REMOVE_TRACK="zc.rt",e.HANDLE_TRACK="zc.ht"}(t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={}))},4495:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdvancedModule=void 0;var s=r(2367),a=r(5098),c=r(8706),u=r(608),l=function(){function e(e,t,r,n){this.logger=e,this.dataReport=t,this.streamCenter=r,this.stateCenter=n,this.screenShotReady=!1}return e.prototype.setVideoConfig=function(e,t){var r=this;return this.logger.info(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" call"),new Promise((function(n,i){var o,a,l=c.ZegoRTCLogEvent.kZegoSetVideoConfig.error,d=l.kLocalStreamError,h=l.kParamError,p=r.stateCenter.getReportSeq();if(r.dataReport.newReport(p,c.ZegoRTCLogEvent.kZegoSetVideoConfig.event),!(e instanceof MediaStream))return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" localStream not found"),r.dataReport.addMsgInfo(p,d),r.dataReport.uploadReport(p),void i({errorCode:h.code,extendedData:h.message+" localStream no found"});if(!t||"object"!=typeof t||0==Object.keys(t).length)return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints wrong"),r.dataReport.addMsgInfo(p,h),r.dataReport.uploadReport(p),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"});if(t.width&&"number"==typeof t.width&&!r.stateCenter.checkValidNumber(t.width,0,7680))return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints width integer number, range[0, 7680]"),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints width integer number, range[0, 7680]"}),r.dataReport.uploadReport(p),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"});if(t.width&&"object"==typeof t.width){if(!(a=u.ClientUtil.checkConstraintExtendWithMessage(t.width,"width",0,7680)).result)return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints width: "+a.message),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints width: "+a.message}),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"})}else if(t.width&&"number"!=typeof t.width&&"object"!=typeof t.width)return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints width must be a number or an object. "),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints width must be a number or an object."}),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"});if(t.height&&"number"==typeof t.height&&!r.stateCenter.checkValidNumber(t.height,0,4320))return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints height integer number, range[0, 4320]"),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints height integer number, range[0, 4320]"}),r.dataReport.uploadReport(p),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"});if(t.height&&"object"==typeof t.height){if(!(a=u.ClientUtil.checkConstraintExtendWithMessage(t.height,"height",0,4320)).result)return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints height: "+a.message),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints height: "+a.message}),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"})}else if(t.height&&"number"!=typeof t.height&&"object"!=typeof t.height)return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints height must be a number or an object. "),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints height must be a number or an object."}),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"});return t.maxBitrate&&"number"!=typeof t.maxBitrate?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+(o=" constraints maxBitrate is not a number")),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+o}),r.dataReport.uploadReport(p),void i({errorCode:h.code,extendedData:h.message+o})):void 0!==t.frameRate&&"number"!=typeof t.frameRate&&"object"!=typeof t.frameRate?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+(o=" constraints frameRate is not a number or an object")),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+o}),r.dataReport.uploadReport(p),void i({errorCode:h.code,extendedData:h.message+o})):"number"!=typeof t.frameRate||t.frameRate>0&&t.frameRate%1==0?t.frameRate&&"object"==typeof t.frameRate&&!(a=u.ClientUtil.checkConstraintExtendWithMessage(t.frameRate,"frameRate")).result?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints frameRate: "+a.message),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints frameRate: "+a.message}),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"})):void r.setPublishStreamConstraints(e,t,(function(e){r.dataReport.uploadReport(p),n(e)})):(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints frameRate must be positive integer number"),r.dataReport.addMsgInfo(p,{error:h.code,message:h.message+" constraints frameRate must be positive integer number"}),r.dataReport.uploadReport(p),void i({errorCode:h.code,extendedData:h.message+" constraints wrong"}))}))},e.prototype.setAudioConfig=function(e,t){var r=this;return this.logger.info(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" call"),new Promise((function(n){var i=r.stateCenter.getReportSeq();return r.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoSetAudioConfig.event),e instanceof MediaStream?!t||"object"!=typeof t||0==Object.keys(t).length||void 0!==t.AEC&&"boolean"!=typeof t.AEC||void 0!==t.AGC&&"boolean"!=typeof t.AGC||void 0!==t.ANS&&"boolean"!=typeof t.ANS?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" constraints wrong"),r.dataReport.addMsgInfo(i,c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError),r.dataReport.uploadReport(i),void n({errorCode:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.message+" constraints wrong"})):void r.setPublishStreamConstraints(e,t,(function(e){r.dataReport.uploadReport(i),n(e)})):(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" localStream not found"),r.dataReport.addMsgInfo(i,c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError),r.dataReport.uploadReport(i),void n({errorCode:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.message+" localStream no found"}))}))},e.prototype.enableStream=function(e,t){if(this.logger.info(s.ZEGO_WEBRTC_ACTION.ENABLE_STREAM+" call"),"boolean"!=typeof t.video&&"boolean"!=typeof t.audio)return this.logger.error(s.ZEGO_WEBRTC_ACTION.ENABLE_STREAM+" option error"),!1;var r=!0,n=!0;return"boolean"==typeof t.video&&(r=this.enableCamera(e,t.video,t.retain)),"boolean"==typeof t.audio&&(n=this.enableMicrophone(e,t.audio)),r&&n},e.prototype.enableMicrophoneOnly=function(e){if(this.logger.info(s.ZEGO_WEBRTC_ACTION.ENABLE_MIC_ONLY+" call"),"boolean"!=typeof e)return!1;for(var t=0;t<this.streamCenter.previewStreamList.length;t++)if(!this.streamCenter.previewStreamList[t].enableMicrophoneOnly(e,this.streamCenter))return this.logger.error("zsc.emo.0 previewer ".concat(t," change mic mute state failed")),!1;return this.streamCenter.isMicEnabled=e,!0},e.prototype.replaceTrack=function(e,t,r){return i(this,void 0,void 0,(function(){var n,i,a;return o(this,(function(o){return n=this.stateCenter.getReportSeq(),this.dataReport.newReport(n,c.ZegoRTCLogEvent.kZegoReplaceTrack.event),i=c.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError,e instanceof MediaStream?t&&t instanceof MediaStreamTrack?(a=this._replaceTrack(e,t,r),this.dataReport.uploadReport(n),[2,a]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.REPLACE_TRACK+" mediastream track no found"),this.dataReport.uploadReport(n,void 0,i),[2,{errorCode:i.code,extendedData:i.message+" mediastream track no found"}]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.REPLACE_TRACK+" localStream not found"),this.dataReport.uploadReport(n,void 0,i),[2,{errorCode:i.code,extendedData:i.message+" localStream no found"}])}))}))},e.prototype.setPublishStreamConstraints=function(e,t,r){var n=this;this.logger.info("zsc.spsc.0 constraints",JSON.stringify(t));var s=this.streamCenter.checkPreview(e);if(!s)return this.logger.error("zsc.spsc.0 preview no found"),void(r&&r({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}));var c=s.videoTrack,u=s.audioTrack,l=!1,d=!1;c&&(t.width||t.height||t.frameRate||t.videoQuality)&&(t.videoQuality||(s.mediaStreamConfig.videoQuality=4),l=!0),void 0===t.ANS&&void 0===t.AGC&&void 0===t.AEC||(d=!0),l&&!c?(this.logger.error("zsc.spsc.0 video track not found"),r&&r({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message})):t.video=!0,d&&!u?(this.logger.error("zsc.spsc.0 audio track not found"),r&&r({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message})):t.audio=!0;var h,p=JSON.parse(JSON.stringify(s.mediaStreamConfig)),f=Object.assign(s.mediaStreamConfig,t);"screen"==s.previewType?(h=this.streamCenter.getScreenConstrains(f)).bitRate!==p.bitRate&&(t.maxBitrate=h.bitRate):h=s.getMediaStreamConstraints(f,!0),this.logger.info("zsc.spsc.0 applyConstraints ",JSON.stringify(h));var g=[];l&&c&&g.push(c.applyConstraints(h.video));var m=!0;d&&(m=(null==u?void 0:u.enabled)||!1,null==u||u.stop(),g.push(navigator.mediaDevices.getUserMedia({video:!1,audio:h.audio})));var _=this.streamCenter.getPublishList(e);_.forEach((function(e){var r,i=null==e?void 0:e.publisher,o=(null===(r=null==i?void 0:i.peerConnection)||void 0===r?void 0:r.getSenders())||[];if(o.length>0&&t.maxBitrate){var a=o.filter((function(e){return e.track&&"video"===e.track.kind}));a||n.logger.error("zsc.spsc.0 video sender no found");var c=a.length>1?a[1]:a[0]?a[0]:null;if(c){var u=c.getParameters();u.encodings||(u.encodings=[{}]),u.encodings[0].maxBitrate=1e3*t.maxBitrate,g.push(c.setParameters(u))}else n.logger.error("zsc.spsc.0 video sender no found")}else t.maxBitrate&&(s.videoInfo.bitRate=t.maxBitrate)})),g.length>0?Promise.all(g).then((function(e){var i,o,a=e[1];if(d){var c=(o=l?e[1]:e[0]).getVideoTracks()[0];null==c||c.stop();var u=o.getAudioTracks()[0];u.enabled=m,a=JSON.stringify(u.getSettings()),s.replacePreviewTrack(u),s.gainNode||s.onAudioTrackChange(u)}if(t.maxBitrate&&(s.videoInfo.bitRate=t.maxBitrate,_.forEach((function(e){var r=null==e?void 0:e.publisher;r&&(r.videoInfo.bitRate=t.maxBitrate)}))),null===(i=null==h?void 0:h.video)||void 0===i?void 0:i.frameRate){var p=h.video.frameRate;s.videoInfo.frameRate=p,_.forEach((function(e){var t=null==e?void 0:e.publisher;t&&(t.videoInfo.frameRate=p)}))}n.logger.info("zsc.spsc.0 set constraints success",a),r&&r({errorCode:0,extendedData:""})})).catch((function(t){return i(n,void 0,void 0,(function(){var n,i,c,u,l=this;return o(this,(function(o){switch(o.label){case 0:return this.logger.error("zsc.spsc.0 fail reason ",t.name,t.toString()),d?(n=s.getMediaStreamConstraints(p),this.logger.info("zsc.spsc.0 oldMediaStreamConstraints ",JSON.stringify(n)),[4,navigator.mediaDevices.getUserMedia({video:!1,audio:n.audio}).catch((function(e){l.logger.error("zsc.spsc.0.1 setbackup fail "+e.name)}))]):[3,2];case 1:(i=o.sent())&&(null==(c=e.getVideoTracks()[0])||c.stop(),u=i.getAudioTracks()[0],s.replacePreviewTrack(u),s.gainNode||s.onAudioTrackChange(u)),this.logger.info("zsc.spsc.0.1 setbackup suc "),o.label=2;case 2:return r&&r({errorCode:a.errorCodeList.PUBLISHER_CONSTRAINTS_ERROR.code,extendedData:"".concat(t.name," ").concat(t.constraint?"constraint:"+t.constraint:"")}),[2]}}))}))})):(this.logger.warn("zsc.spsc.0 constaints is no changes"),r&&r({errorCode:a.errorCodeList.PUBLISHER_CONSTRAINTS_ERROR.code,extendedData:"constraints is no changes"}))},e.prototype.useVideoDevice=function(e,t){var r=this;return this.logger.info("zc.uvd.0 call"),new Promise((function(n){var i=r.stateCenter.getReportSeq();if(r.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.event),r.dataReport.addMsgInfo(i,{device:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.device(t)}),!(e instanceof MediaStream))return r.logger.error("zc.uvd.0 localStream not found"),r.dataReport.addMsgInfo(i,c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kLocalStreamError),r.dataReport.uploadReport(i),void n({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message});if("string"!=typeof t)return r.logger.error("zc.uvd.0 deviceID must be string"),r.dataReport.addMsgInfo(i,{error:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,message:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message+" deviceID must be string"}),r.dataReport.uploadReport(i),void n({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message});var o=function(t){r.dataReport.uploadReport(i),r.streamCenter.getPublishList(e).forEach((function(e){var t,r;e.cameraLabel=(null===(r=null===(t=e.publisher.previewer)||void 0===t?void 0:t.videoTrack)||void 0===r?void 0:r.label)||e.cameraLabel})),n(t)};r.stateCenter.getDevices((function(i){if(!i.cameras.find((function(e){return e.deviceID==t})))return r.logger.error("zc.uvd.0 device is not found"),void n({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kDevicesNoFoundError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kDevicesNoFoundError.message});r.switchDevice("video",e,t,o)}),(function(n){r.logger.warn("zc.uvd.0 getDevices err:",n),r.switchDevice("video",e,t,o)}))}))},e.prototype.useAudioDevice=function(e,t){var r=this;return this.logger.info("zc.uad.1 call"),new Promise((function(n){var i=r.stateCenter.getReportSeq();r.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.event),r.dataReport.addMsgInfo(i,{device:c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.device(t)});var o=function(e,t){r.logger.error("zc.uad.1 "+t);var o=e;o.message=o.message+(t?" "+t:""),r.dataReport.addMsgInfo(i,o),r.dataReport.uploadReport(i),n({errorCode:o.code,extendedData:o.message})},s=function(t){r.dataReport.uploadReport(i),r.streamCenter.getPublishList(e).forEach((function(t){var r;t.microLabel=(null===(r=e.getAudioTracks()[0])||void 0===r?void 0:r.label)||t.microLabel})),n(t)};e instanceof MediaStream?"string"==typeof t?r.stateCenter.getDevices((function(i){if(!i.microphones.find((function(e){return e.deviceID==t})))return r.logger.error("zc.uad.1 device is not found"),void n({errorCode:c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kDevicesNoFoundError.code,extendedData:c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kDevicesNoFoundError.message});r.switchDevice("audio",e,t,s)}),(function(n){r.logger.warn("zc.uad.1 getDevices err:",n),r.switchDevice("audio",e,t,s)})):o(c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kParamError,"deviceID must be string"):o(c.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kLocalStreamError,"localStream not found")}))},e.prototype.enableDualStream=function(e){this.logger.info("zsc.eds call");var t=this.streamCenter.checkPreview(e);t&&!t.lowStream?navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"custom"==t.previewType?this.logger.error("zsc.eds can not support firefox"):this.streamCenter.checkPublish(e)?this.logger.error("zsc.eds is publishing"):(t.enableDualStream=!0,t.createLowStream()):this.logger.error("zsc.eds preview no found")},e.prototype.setLowStreamParameter=function(e,t){var r=this.streamCenter.checkPreview(e);if(r){var n=r.videoInfo;t.width&&n.width&&t.width>n.width?this.logger.error("zsc.slsp.0 low stream width can not larger than high stream"):t.height&&n.height&&t.height>n.height?this.logger.error("zsc.slsp.0 low stream height can not larger than high stream"):t.frameRate&&n.frameRate&&t.frameRate>n.frameRate||t.height&&n.bitRate&&t.bitRate>n.bitRate||(r.lowStreamConfig=Object.assign(r.lowStreamConfig,t))}else this.logger.error("zsc.slsp.0 preview no found")},e.prototype.handleTrack=function(e,t,r,n,c){var u;return i(this,void 0,void 0,(function(){var l,d,h,p,f,g,m,_,v,y,E,S=this;return o(this,(function(b){switch(b.label){case 0:return t instanceof MediaStream?r instanceof MediaStreamTrack&&"audio"!=r.kind?(l=this.streamCenter.checkPreview(t))?"video"===r.kind&&(null===(u=l.videoEffect)||void 0===u?void 0:u.enabled)?(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" need to disable video beauty effect first"),c&&c({errorCode:a.errorCodeList.VIDEO_EFFECT_IS_RUNNING.code,extendedData:"need to disable video beauty effect before add or remove track"}),[2]):"ADD"==e&&(t.getTracks().length>=2||t.getTracks().find((function(e){return e.kind==r.kind})))?(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" only stream which have one track and kind no exist can add track"),c&&c({errorCode:a.errorCodeList.TRACK_CAN_NOT_ADD.code,extendedData:a.errorCodeList.TRACK_CAN_NOT_ADD.message}),[2]):"REMOVE"!=e||1!=t.getTracks().length&&t.getTracks().includes(r)?!(d=this.streamCenter.checkPublish(t))||5===d.publisher.stateNego&&1!=d.publisher.isUpdateSDP?(h=l.rtcViewer,d?(p=d.publisher,f=l,(g=d.publisher.peerConnection)?(p.isUpdateSDP=!0,"ADD"!=e?[3,1]:(g.addTrack(r,t),[3,4])):[2]):[3,6]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" publish state wrong"),c&&c({errorCode:a.errorCodeList.PUBLISHER_STATE_WRONG.code,extendedData:a.errorCodeList.PUBLISHER_STATE_WRONG.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" not supported"),c({errorCode:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.code,extendedData:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" stream no found"),c&&c({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" only can handle video track"),c({errorCode:a.errorCodeList.INPUT_PARAM.code,extendedData:a.errorCodeList.INPUT_PARAM.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" stream wrong"),c({errorCode:a.errorCodeList.INPUT_PARAM.code,extendedData:a.errorCodeList.INPUT_PARAM.message}),[2]);case 1:return window.RTCPeerConnection&&window.RTCPeerConnection.prototype.getTransceivers&&window.RTCRtpTransceiver.prototype.stop?[4,g.getSenders().find((function(e){return e.track&&e.track==r}))]:(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" not supported getTransceivers"),c({errorCode:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.code,extendedData:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.message}),[2]);case 2:return m=b.sent(),[4,g.getTransceivers().find((function(e){return e.sender==m}))];case 3:if(_=b.sent(),!(m&&_&&_.stop))return this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" sender no found"),c&&c({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}),[2];try{g.removeTrack(m),_.stop()}catch(e){this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" "+e),c&&c({errorCode:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.code,extendedData:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.message+" "+e})}b.label=4;case 4:return v={},y=this.streamCenter.previewStreamList.find((function(e){return e.localStream.getTracks().find((function(e){return e==r}))})),v=y&&"ADD"==e?y.videoInfo:{},[4,g.createOffer()];case 5:return E=b.sent(),p.onCreateOfferSuccess(E,!0,v,(function(s){return i(S,void 0,void 0,(function(){var i;return o(this,(function(o){return 0!==s?c&&c({errorCode:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.code,extendedData:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.message}):(i="video"==r.kind?"videoTrack":"audioTrack","ADD"==e?(t.addTrack(r),f[i]=r,h&&h.setTrack("video"==r.kind,r),"video"==r.kind&&1==r.enabled?p.sendStreamStatus(0,p.mic_status,!0):1==r.enabled&&p.sendStreamStatus(p.camera_status,0,!0)):("video"==r.kind?p.sendStreamStatus(2,p.mic_status,!0):p.sendStreamStatus(p.camera_status,2,!0),t.removeTrack(r),f[i]=null,h&&h.setTrack("video"==r.kind,null)),l.mediaStreamConfig.video="ADD"==e,n({errorCode:0,extendedData:""})),[2]}))}))})),[3,7];case 6:"ADD"==e?(t.addTrack(r),h&&h.setTrack("video"==r.kind,r)):(t.removeTrack(r),h&&h.setTrack("video"==r.kind,null)),n({errorCode:0,extendedData:""}),l.mediaStreamConfig.video="ADD"==e,b.label=7;case 7:return[2]}}))}))},e.prototype.switchDevice=function(e,t,r,i){var o=this,s=this.streamCenter.checkPreview(t);if(!s)return this.logger.error("zsc.sd.0 preview no found"),void(i&&i({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}));if("video"===e&&0==s.mediaStreamConfig.video)return this.logger.error("zsc.sd.0 camera can not be changed when video is false"),void(i&&i({errorCode:a.errorCodeList.VIDEO_DEVICE_FALSE.code,extendedData:a.errorCodeList.VIDEO_DEVICE_FALSE.message}));if("audio"===e&&0==s.mediaStreamConfig.audio)return this.logger.error("zsc.sd.0 microphone can not be changed when audio is false"),void(i&&i({errorCode:a.errorCodeList.AUDIO_DEVICE_FALSE.code,extendedData:a.errorCodeList.AUDIO_DEVICE_FALSE.message}));s.mediaStreamConfig.videoInput!==r&&delete s.mediaStreamConfig.facingMode;var c,u={};"video"===e?(u.videoInput=r,c=s.videoTrack):(u.audioInput=r,c=s.audioTrack);var l=this.stateCenter.browser;this.logger.info("zsc.sd.0 browser "+l),"firefox"===l&&(null==c||c.stop());var d=n(n({},s.mediaStreamConfig),u),h=s.getMediaStreamConstraints(d),p=function(r,n){n.getTracks().forEach((function(r){if(r.kind===e){var n="video"===e,i=n?"videoTrack":"audioTrack",a=s[i];r.enabled=a.enabled,n&&s.lowStream&&s.lowStream.getTracks().forEach((function(e){return e.stop()}));var c=o.streamCenter.getPublishList(t);c.length>0&&(!s.muteImage||r.enabled||!n)?c.map((function(e){return e.publisher})).forEach((function(e){e.replacePublishedTrack(r)})):s&&s.muteImage&&!r.enabled&&n?s[i]=r:s&&s.replacePreviewTrack(r),a&&a.stop()}})),s.restartSoundLevel()};"audio"==e?h.video=!1:h.audio=!1,navigator.mediaDevices.getUserMedia(h).then((function(t){Object.assign(s.mediaStreamConfig,u),p(0,t),o.logger.info("zsc.sd.0 switch "+e+" device success"),i&&i({errorCode:0,extendedData:""})}),(function(t){var r,n;"video"==e?null===(r=s.videoTrack)||void 0===r||r.stop():null===(n=s.audioTrack)||void 0===n||n.stop(),o.logger.warn("zsc.sd.0 switch "+e+" device failed, stop last device and retry. ",t+""),navigator.mediaDevices.getUserMedia(h).then((function(t){Object.assign(s.mediaStreamConfig,u),p(0,t),o.logger.info("zsc.sd.0 swtich "+e+" device success"),i&&i({errorCode:0,extendedData:""})}),(function(t){o.logger.warn("zsc.sd.0 swtich "+e+" device failed and recover last device. ",t+"");var r=s.getMediaStreamConstraints(s.mediaStreamConfig),n=a.errorCodeList.VIDEO_DEVICE_FALSE;"audio"===e&&(n=a.errorCodeList.AUDIO_DEVICE_FALSE),navigator.mediaDevices.getUserMedia(r).then((function(r){p(0,r),o.logger.info("zsc.sd.0 recover last "+e+" device success"),i&&i({errorCode:n.code,extendedData:n.message+" "+JSON.stringify(t)})}),(function(t){o.logger.error("zsc.sd.0 swtich "+e+" device and recover failed, please recreate stream. ",t+""),i&&i({errorCode:n.code,extendedData:n.message+" "+JSON.stringify(t)})}))}))}))},e.prototype._replaceTrack=function(e,t,r){var n=this.streamCenter.checkPreview(e),i=this.streamCenter.getPublishList(e);if(i.length){var o=null;return i.forEach((function(e){var n;o=null===(n=e.publisher)||void 0===n?void 0:n.replacePublishedTrack(t,!1,{isTrackProcessedFromOriginalStream:r})})),o}return n?n.localStream.getTracks().find((function(e){return e.kind===t.kind}))?(n.replacePreviewTrack(t,!1,{isTrackProcessedFromOriginalStream:r}),{errorCode:0,extendedData:""}):(this.logger.error("zc.rt.0 track no found"),{errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}):(this.logger.error("zc.rt.0 preview no found"),{errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message})},e.prototype.enableMicrophone=function(e,t){var r=this.streamCenter.checkPreview(e);return r?r.enableMicrophone(t,this.streamCenter):(this.logger.error("zsc.em.0 no preview"),!1)},e.prototype.enableCamera=function(e,t,r){var n=this.streamCenter.checkPreview(e);return n?n.enableCamera(t,this.streamCenter,r):(this.logger.error("zsc.ec.0 no preview"),!1)},e.prototype.setDummyCaptureImagePath=function(e,t){var r=this;return new Promise((function(n,i){var o=r.streamCenter.checkPreview(t);if(!o)return r.logger.error("zc.sdcp.0 preview no found"),void n(!1);if("string"!=typeof e)return r.logger.error("zc.sdcp.0 filePath type error"),void n(!1);var s=new Image;s.src=e,s.crossOrigin="anonymous",s.onload=function(){o.loadImgTimer&&clearTimeout(o.loadImgTimer),o.loadImgTimer=void 0,r.logger.info("zc.sdcp.0 load file path success"),o.muteImage=s,n(!0)},o.loadImgTimer=setTimeout((function(){r.logger.error("zc.sdcp.0 load img timeout"),n(!1)}),5e3)}))},e.prototype.enableAutoSwitchDevice=function(e){this.stateCenter.autoSwitchDeviceSetting=n(n({},this.stateCenter.autoSwitchDeviceSetting),e)},e}();t.AdvancedModule=l},4378:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.signal=t.publisher=t.publishModule=t.playModule=t.preview=t.streamHandler=t.zegoWebRTC=t.ENUM_PUBLISH_STREAM_STATE=t.ENUM_STREAM_CMD_PRI=t.ENUM_STREAM_SUB_CMD=t.PROTO_VERSION=void 0;var s=r(2367),a=r(5098),c=r(8706),u=r(7248);function l(e,t){return e&&"live"===e.readyState?!0===e.enabled?0:"video"===e.kind&&"firefox"===t?2:20:2}t.PROTO_VERSION="2.20.2",t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_CMD_PRI={liveBegin:"zegochat_js.room_stream_create_req",liveEnd:"zegochat_js.room_stream_delete_req",liveUpdate:"zegochat_js.room_stream_update_req"},t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},t.zegoWebRTC={mutePublishStreamVideo:function(e,t,r){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" call");var n=this.stateCenter.getReportSeq();if(this.dataReport.newReport(n,c.ZegoRTCLogEvent.kZegoTaskMutePublishVideo),"boolean"!=typeof t||void 0!==r&&"boolean"!=typeof r)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" option error"),!1;var i=this.rtcModules.advancedModule.enableStream(e,{video:!t,retain:r});return this.dataReport.uploadReport(n),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" end"),i},mutePublishStreamAudio:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" call");var r=this.stateCenter.getReportSeq();if(this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskMutePublishAudio),"boolean"!=typeof t)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" option error"),!1;var n=this.rtcModules.advancedModule.enableStream(e,{audio:!t});return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" end"),n},mutePlayStreamVideo:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_VIDEO+" call "+e+" "+t);var r=this.stateCenter.getReportSeq();this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskMutePlayVideo);var n=this.rtcModules.playModule.mutePlayStream(e,"video",t);return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_VIDEO+" end"),n},mutePlayStreamAudio:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_AUDIO+" call "+e+" "+t);var r=this.stateCenter.getReportSeq();this.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoTaskMutePlayAudio);var n=this.rtcModules.playModule.mutePlayStream(e,"audio",t);return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_AUDIO+"end"),n},muteMicrophone:function(e){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" call");var t=this.stateCenter.getReportSeq();if(this.dataReport.newReport(t,c.ZegoRTCLogEvent.kZegoTaskMuteMicrophone),"boolean"!=typeof e)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" option error"),!1;var r=this.rtcModules.advancedModule.enableMicrophoneOnly(!e);return this.dataReport.uploadReport(t),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" end"),r},activateSEIInsert:function(e){return this.rtcModules.publishModule.activateSEIInsert(e.stream,e.action,e.infoType)},getAudioInfo:function(e,t,r){if(!e)return this.logger.error("localStream is empty!"),!1;var i=n({},r);return new u.MediaUtil(this.ac,i).connectToSource(e,(function(e){t(e)}))},startRecord:function(e){var t=this,r=this.streamCenter.checkPreview(e);if(r){var n=e.clone(),i=n.getAudioTracks();i.length>0&&r.hasEmptyAudioTrack&&i.forEach((function(e){n.removeTrack(e)})),this.recordedBlobs=[];var o={mimeType:"video/webm;codecs=vp9"};MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:"video/webm"},MediaRecorder.isTypeSupported(o.mimeType)||(o={mimeType:""}))));try{this.mediaRecorder=new MediaRecorder(n,o)}catch(e){return void this.logger.error("Exception while creating ZegoMediaRecorder:",e)}this.mediaRecorder.onstop=function(e){t.logger.warn("Recorder stopped: "+e)},this.mediaRecorder.ondataavailable=this.handleDataAvailable.bind(this),this.mediaRecorder.start(10)}else this.logger.error("stream is not from zego!")},stopRecord:function(){this.mediaRecorder?this.mediaRecorder.stop():this.logger.warn("please invoke startRecord first")},resumeRecord:function(){this.mediaRecorder?this.mediaRecorder.resume():this.logger.warn("please invoke startRecord first")},pauseRecord:function(){this.mediaRecorder?this.mediaRecorder.pause():this.logger.warn("please invoke startRecord first")},saveRecord:function(e){if(this.mediaRecorder&&this.recordedBlobs){var t=new Blob(this.recordedBlobs,{type:"video/webm"}),r=window.URL.createObjectURL(t),n=document.createElement("a");n.style.display="none",n.href=r,n.download=e+".webm",document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(r)}),100)}else this.logger.warn("please invoke startRecord first")},handleDataAvailable:function(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)},addTrack:function(e,t){var r=this;return new Promise((function(n,i){r.logger.info(s.ZEGO_WEBRTC_ACTION.ADD_TRACK+" call"),r.rtcModules.advancedModule.handleTrack("ADD",e,t,n,i)}))},removeTrack:function(e,t){var r=this;return new Promise((function(n,i){r.logger.info(s.ZEGO_WEBRTC_ACTION.REMOVE_TRACK+" call"),r.rtcModules.advancedModule.handleTrack("REMOVE",e,t,n,i)}))},enableCameraCapturing:function(e,t){return void 0===t&&(t=!0),i(this,void 0,void 0,(function(){var r;return o(this,(function(n){return(r=this.streamCenter.checkPreview(e))?[2,r.enableCameraCapturing(t)]:(this.logger.error("zsc.ecc no preview"),[2,!1])}))}))}},t.streamHandler={},t.preview={enableCamera:function(e,t,r){var n,i,o,s=this;if(!this.localStream||0==this.localStream.getVideoTracks().length)return this.logger.error("zp.ec.2 video track no found"),!1;var a,c=this.videoTrack;if(!e&&this.muteImage){var u=document.createElement("canvas");u.width=this.muteImage.width,u.height=this.muteImage.height;var d=u.getContext("2d");this.muteImageAnID=setInterval((function(){d.drawImage(s.muteImage,0,0)}),100),a=u.captureStream().getVideoTracks()[0],this.localStream.removeTrack(this.localStream.getVideoTracks()[0]),this.localStream.addTrack(a),this.rtcViewer&&this.rtcViewer.setVideo(a)}else e&&this.muteImage&&((null===(n=null==this?void 0:this.videoEffect)||void 0===n?void 0:n.enabled)?this.replacePreviewTrack(this.videoEffect.output,!0):this.replacePreviewTrack(this.videoTrack));var h=this.stateCenter.browser;if(r&&!e||!c){if(r&&!e)if(null===(i=this.videoEffect)||void 0===i?void 0:i.enabled)this.logger.warn("zp.ec.2 Unable to keep the preview screen when beauty is turned on");else{var p=this.cloneVideoTrack;this.cloneVideoTrack=this.videoTrack.clone(),this.cloneVideoTrack.enabled=!0,this.replacePreviewTrack(this.cloneVideoTrack,!1,{retainTrack:!0}),p&&p.stop()}}else if(c.enabled=e,"chrome"===h&&e&&void 0!==typeof c.getSettings().width&&c.getSettings().width>0&&navigator.userAgent){var f=0,g=(navigator.userAgent.toLowerCase().match(/chrome\/([\d.]+)/)||[])[1];if(g&&(f=parseInt(g.split(",")[0])),f&&f>=87&&f<92){var m=c.getSettings().width-1,_=c.getSettings().height-1,v=c.getSettings().frameRate;c.applyConstraints({width:m,height:_,frameRate:v}).then((function(){c.applyConstraints({width:s.videoInfo.width,height:s.videoInfo.height,frameRate:v})}))}}c&&(c.enabled=e),null===(o=this.lowStream)||void 0===o||o.getVideoTracks().forEach((function(t){t.enabled=e}));var y=t.getPublishList(this.localStream).map((function(e){return e.publisher}));return y.length&&y.forEach((function(t){var r,n=null===(r=t.peerConnection)||void 0===r?void 0:r.getSenders().filter((function(e){var t;return"video"===(null===(t=e.track)||void 0===t?void 0:t.kind)}));n&&n.forEach((function(t){var r;!e&&s.muteImage&&a?null==t||t.replaceTrack(a):e&&((null===(r=null==s?void 0:s.videoEffect)||void 0===r?void 0:r.enabled)&&s.videoEffect.output?t.track!==s.videoEffect.output&&(null==t||t.replaceTrack(s.videoEffect.output)):t.track!==s.videoTrack&&(null==t||t.replaceTrack(s.videoTrack)),s.muteImageAnID&&clearInterval(s.muteImageAnID))}));var i=s.muteImage&&!e?0:l(s.videoTrack,h);t.sendStreamStatus(i,t.mic_status)})),this.isVideoEnabled=e,this.logger.info("zp.ec.2 call success"),!0},enableMicrophone:function(e,t){if(!this.localStream)return this.logger.error("zp.em.2 no localStream"),!1;this.localStream.getAudioTracks().forEach((function(t){t.enabled=e})),this.audioTrack&&(this.audioTrack.enabled=e&&t.isMicEnabled);var r=t.getPublishList(this.localStream).map((function(e){return e.publisher}));return r.length&&r.forEach((function(r){r.signal&&r.sendStreamStatus(r.camera_status,e&&t.isMicEnabled?0:2)})),this.isAudioEnabled=e,this.logger.debug("zp.em.2 call success"),!0},replacePreviewTrack:function(e,t,r){var n;return void 0===t&&(t=!1),void 0===r&&(r={}),i(this,void 0,void 0,(function(){var i,s,a,c,u;return o(this,(function(o){switch(o.label){case 0:return this.logger.info("zsc.rpt.0 call"),e&&e.kind&&this.localStream?(i=!0===(null==r?void 0:r.retainTrack),s="audio"===e.kind?"audioTrack":"videoTrack",t||!(null===(n=this.videoEffect)||void 0===n?void 0:n.enabled)||"video"!==e.kind?[3,3]:i?[3,2]:[4,this.videoEffect.setInput(e)]):[2];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:"audio"===e.kind&&this.audioNodeQueue&&!r.isTrackProcessedFromOriginalStream?((a=new MediaStream).addTrack(e),c=this.ac.createMediaStreamSource(a),this.audioNodeQueue.replaceSource(c)):(this.logger.info("zsc.rpt.0 replace local track"),(u=this.localStream.getTracks().find((function(t){return t.kind===e.kind})))!==e&&(u&&this.localStream.removeTrack(u),this.localStream.addTrack(e)),this.localStream.addTrack(e),this.rtcViewer&&(this.rtcViewer.setTrack("video"===e.kind,e),"safari"===this.stateCenter.browser&&this.rtcViewer.resume(!0)),!i&&"video"===e.kind&&this.enableDualStream&&this.createLowStream()),o.label=4;case 4:return t||i||(this[s]=e),this.logger.info("zsc.rpt.0 end"),[2]}}))}))},enableCameraCapturing:function(e){return i(this,void 0,void 0,(function(){var t,r,i,s,a,c,u,d,h,p;return o(this,(function(o){switch(o.label){case 0:return this.localStream&&this.videoTrack&&"camera"===this.previewType?(t=this.streamCenter.getPublishList(this.localStream).map((function(e){return e.publisher})),e?"live"!==this.videoTrack.readyState?[3,1]:(this.logger.warn("zp.ecc camera is already capturing"),[3,12]):[3,13]):(this.logger.error("zp.ecc not camera stream"),[2,!1]);case 1:r=this.getMediaStreamConstraints(n(n({},this.mediaStreamConfig),{audio:!1})),o.label=2;case 2:return o.trys.push([2,11,,12]),[4,navigator.mediaDevices.getUserMedia(r)];case 3:return i=o.sent(),(s=i.getVideoTracks()[0]).enabled=this.isVideoEnabled,!1===s.enabled&&this.logger.warn("zp.ecc video is not enabled"),!this.muteImage||this.isVideoEnabled?[3,4]:(this.videoTrack=s,s.enabled=!this.isVideoEnabled,[3,10]);case 4:if(!t.length)return[3,9];a=0,o.label=5;case 5:return a<t.length?[4,t[a].replacePublishedTrack(s)]:[3,8];case 6:if(0!==(null==(c=o.sent())?void 0:c.errorCode))throw c;o.label=7;case 7:return a++,[3,5];case 8:return[3,10];case 9:this.replacePreviewTrack(s),o.label=10;case 10:return[3,12];case 11:return u=o.sent(),this.logger.error("zsc.ecc resume camera capturing failed. "+JSON.stringify(u)),[2,!1];case 12:return[3,16];case 13:return d=this.videoTrack.enabled,"safari"===(h=this.stateCenter.browser)?[3,15]:(this.videoTrack.enabled=!1,[4,new Promise((function(e){setTimeout((function(){e(void 0)}),200)}))]);case 14:o.sent(),o.label=15;case 15:this.videoTrack.stop(),this.videoTrack.enabled=d,t.length&&(p=this.muteImage&&!this.isVideoEnabled?0:l(this.videoTrack,h),t.forEach((function(e){e.sendStreamStatus(p,e.mic_status)}))),o.label=16;case 16:return[2,!0]}}))}))}},t.playModule={mutePlayStream:function(e,t,r){var n=this;return this.logger.info("zsc.mps.0 call "+t+" "+r),new Promise((function(i,o){if("string"!=typeof e||""==e)return n.logger.error("zsc.mps.0 streamID must be string and not empty"),void o(!1);if("boolean"!=typeof r)return n.logger.error("zsc.mps.0 mute must be boolean"),void o(!1);var s=n.streamCenter.playerList[e];if(!s)return n.logger.error("zsc.mps.0 player not found"),void o(!1);if("video"===t){if(s.playOption&&!1===s.playOption.video||s.player&&0!==s.player.cameraStatus)return n.logger.error("zsc.mps.0 stream no contain video"),void o(!1);s.player.signal.ActivatePlayVideoStream(n.stateCenter.getSeq(),s.player.sessionId,r,(function(){n.logger.info("zsc.mps.0 suc");var e=n.stateCenter.getReportSeq();s.player.playMediaStatus.video=!r,n.dataReport.newReport(e,c.ZegoRTCLogEvent.kZegoPlayContentChanged.event),n.dataReport.addMsgInfo(e,{session_id:c.ZegoRTCLogEvent.kZegoPlayContentChanged.session_id(s.player.sessionId),video_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.video_activate(s.player.playMediaStatus.video?1:0),audio_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.audio_activate(s.player.playMediaStatus.audio?1:0)}),n.playVideoStatus=n.dataReport.uploadReport(e),i(!0)}),(function(){n.logger.error("zsc.mps.0 fail"),o(!1)}))}else if("audio"===t){if(s.playOption&&!1===s.playOption.audio||s.player&&0!==s.player.micStatus)return n.logger.error("zsc.mps.0 stream no contain audio"),void o(!1);s.player.signal.ActivatePlayAudioStream(n.stateCenter.getSeq(),s.player.sessionId,r,(function(){n.logger.info("zsc.mps.0 suc");var e=n.stateCenter.getReportSeq();s.player.playMediaStatus.audio=!r,n.dataReport.newReport(e,c.ZegoRTCLogEvent.kZegoPlayContentChanged.event),n.dataReport.addMsgInfo(e,{session_id:c.ZegoRTCLogEvent.kZegoPlayContentChanged.session_id(s.player.sessionId),video_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.video_activate(s.player.playMediaStatus.video?1:0),audio_activate:c.ZegoRTCLogEvent.kZegoPlayContentChanged.audio_activate(s.player.playMediaStatus.audio?1:0)}),n.dataReport.uploadReport(e),i(!0)}),(function(){n.logger.error("zsc.mps.0 fail"),o(!1)}))}else o(!1)}))},setStreamAudioOutput:function(e,t){var r=this;return!(null==t||0==t.length||!e)&&(this.logger.debug("zsc.ssao.0 device "+t),e?"undefined"!==e.sinkId?(e.setSinkId(t).then((function(){r.logger.info("zsc.ssao.0 success device: "+t)})).catch((function(e){r.logger.info("zsc.ssao.0 "+e.name)})),!0):(this.logger.error("zsc.ssao.0 browser does not suppport"),!1):(this.logger.error("zsc.ssao.0 no localVideo"),!1))}},t.publishModule={activateSEIInsert:function(e,t,r){void 0===r&&(r=0);var n=this.streamCenter.checkPreview(e);return n?0!==t&&1!==t?(this.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" value of \u201caction\u201d should be 0 or 1"),!1):(n.activatesSEIConfig={action:t,infoType:r},this.streamCenter.getPublishList(e).map((function(e){return e.publisher})).forEach((function(e){e.activateSEIInsert(t,r)})),!0):(this.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" stream is not created"),!1)}},t.publisher={activateSEIInsert:function(e,t){var r=this;return new Promise((function(n,i){return r.signal?(r.signal&&r.signal.activateSEIInsert(r.stateCenter.getSeq(),r.sessionId,r.peerID,e,t,(function(e,t,i){var o=!1;0===i.result?(r.logger.info(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" called success"),o=!0):1===i.result?(r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" "+i.peer_id+" invalid param."),o=!1):2===i.result&&(r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" peer not exist"),o=!1),n(o)}),(function(e){1===e&&r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" request timeout")})),!1):n(!1)}))},replacePublishedTrack:function(e,t,r){var n;return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){var i,s,c,u,d,h,p,f;return o(this,(function(o){switch(o.label){case 0:return s=null==(i=this.previewer)?void 0:i.videoEffect,u=i["".concat(c=e.kind,"Track")],d=null===(n=this.peerConnection)||void 0===n?void 0:n.getSenders().filter((function(e){return e.track.kind===c})),h=this.stateCenter.browser,u?(p=0,f=0,"video"===c?(p=l(t?u:e,h),f=this.mic_status):"audio"===c&&(f=l(e,h),p=this.camera_status),[4,i.replacePreviewTrack(e,t,r)]):[3,2];case 1:return o.sent(),d?(d.forEach((function(r,n){"audio"!==c&&!t&&(null==s?void 0:s.enabled)||("video"==c&&i.lowStream&&d.length>1&&0==n?r.replaceTrack(i.lowStream.getVideoTracks()[0]):"audio"===c&&i.audioNodeQueue||r.replaceTrack(e))})),this.sendStreamStatus(p,f)):this.logger.info("zc.rt.1 replace remote track will work after stream published"),this.logger.info("zc.rt.1 replace remote track success"),[2,{errorCode:0,extendedData:""}];case 2:return this.logger.error("zc.rt.1 publisher track no found"),[2,{errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}]}}))}))}},t.signal={activateSEIInsert:function(e,t,r,n,i,o,a){this.logger.info(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" call "+t),this.sendMessageWithCallback("ActivateSEIInsertReq",e,t,{peer_id:r,action:n,info_type:i},o,a)}}},5098:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},INPUT_PARAM:{code:1100001,message:"input param error."},PUBLISH_NOT_PUBLISH:{code:1103040,message:"publisher not found"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"},TRACK_NOT_FOUND:{code:1103047,message:"track is not found"},DEVICE_NOT_FOUND:{code:1103048,message:"device is not found"},PUBLISHER_CONSTRAINTS_ERROR:{code:1103029,message:"constraint error"},PUBLISHER_CDN_PUSH_ERROR:{code:1103052,message:"publisher cdn push error"},VIDEO_DEVICE_FALSE:{code:1103045,message:"video is false"},AUDIO_DEVICE_FALSE:{code:1103046,message:"audio is false"},UNKNOWN_SERVER_ERROR:{code:1100999,message:"unknown server error"},LOCALSTREAM_WRONG:{code:1000018,message:"local stream wrong"},PUBLISHER_STREAM_NO_FOUND:{code:1103055,message:"publish stream no found"},PUBLISH_TARGET_NO_RESPONSE:{code:1103063,message:"publish target no response"},BIZ_CHANNEL_ERROR:{code:1102021,message:"biz channel error."},INVALID_CHANNEL:{code:1102024,message:"invalid channel"},PUBLISHER_EXTRA_INFO_NULL:{code:1003050,message:"extra info of publishing stream is null"},PUBLISHER_UPDATE_STREAM_INFO_FAIL:{code:1103062,message:"update stream info fail"},TRACK_CAN_NOT_ADD:{code:1103063,message:"only stream which have one track and kind no exist can add track"},TRACK_CAN_NOT_REMOVE:{code:1103064,message:"stream which only has one track can not remove "},PUBLISHER_UPDATE_SDP_FAIL:{code:1103068,message:"update sdp fail"},PUBLISHER_STATE_WRONG:{code:1103069,message:"publisher state wrong"},HANDLE_TRACK_NOT_SUPPORTED:{code:1103070,message:"not support remove track"},VIDEO_EFFECT_IS_RUNNING:{code:1103071,message:"video effect processor is running"}}},3824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4495),i=r(4378);t.default={type:"Advance",install:function(e,t,r,o,s,a,c,u){for(var l in Object.defineProperty(t.prototype,"initAdvance",{value:function(){this.advancedModule=new n.AdvancedModule(this.logger,this.dataReport,this.streamCenter,this.stateCenter)},writable:!1}),i.zegoWebRTC)Object.defineProperty(e.prototype,l,{value:i.zegoWebRTC[l],writable:!1});for(var l in i.streamHandler)Object.defineProperty(r.prototype,l,{value:i.streamHandler[l],writable:!1});for(var l in i.preview)Object.defineProperty(o.prototype,l,{value:i.preview[l],writable:!1});for(var l in i.playModule)Object.defineProperty(s.prototype,l,{value:i.playModule[l],writable:!1});for(var l in i.publishModule)Object.defineProperty(a.prototype,l,{value:i.publishModule[l],writable:!1});for(var l in i.publisher)Object.defineProperty(c.prototype,l,{value:i.publisher[l],writable:!1});for(var l in i.signal)Object.defineProperty(u.prototype,l,{value:i.signal[l],writable:!1})}}},8706:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var n=r(5098),i=function(e){return e};t.ZegoRTCLogEvent={kZegoSetVideoConfig:{event:"/sdk/set_video_config",error:{kParamError:n.errorCodeList.INPUT_PARAM,kLocalStreamError:n.errorCodeList.LOCALSTREAM_WRONG}},kZegoSetAudioConfig:{event:"/sdk/set_audio_config",error:{kParamError:n.errorCodeList.INPUT_PARAM}},kZegoReplaceTrack:{event:"/sdk/replace_track",error:{kParamError:n.errorCodeList.INPUT_PARAM}},kZegoTaskUseVideoDevice:{event:"/device/api/video_c",error:{kParamError:n.errorCodeList.INPUT_PARAM,kDevicesNoFoundError:n.errorCodeList.DEVICE_NOT_FOUND,kLocalStreamError:n.errorCodeList.LOCALSTREAM_WRONG},device:i},kZegoTaskUseAudioDevice:{event:"/device/api/audio_c",error:{kParamError:n.errorCodeList.INPUT_PARAM,kDevicesNoFoundError:n.errorCodeList.DEVICE_NOT_FOUND,kLocalStreamError:n.errorCodeList.LOCALSTREAM_WRONG},device:i},kZegoPlayContentChanged:{event:"/sdk/play_content_changed",session_id:i,video_activate:i,audio_activate:i},kZegoTaskMutePublishVideo:"/sdk/mute_publish_video",kZegoTaskMutePublishAudio:"/sdk/mute_publish_audio",kZegoTaskMuteMicrophone:"/sdk/mute_microphone",kZegoTaskMutePlayVideo:"/sdk/mute_play_video",kZegoTaskMutePlayAudio:"/sdk/mute_play_audio"}},7248:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaUtil=void 0;var r=function(){function e(e,t){var r=t.type,n=t.channels,i=void 0===n?1:n,o=t.bufferSize,s=void 0===o?0:o,a=t.sampleBit,c=void 0===a?16:a,u=t.sampleRate,l=void 0===u?44100:u,d=this;this.instant=0,this.slow=0,this.clip=0,this.context=e,this.type=r,this.channels=i,this.bufferSize=s,this.sampleBit=c,this.sampleRate=l,this.script=e.createScriptProcessor(s,i,i),(new Date).getTime(),this.script.addEventListener("audioprocess",(function(e){var t,n=e.inputBuffer.getChannelData(0),i=0,o=0;for(t=0;t<n.length;++t)i+=n[t]*n[t],Math.abs(n[t])>.99&&(o+=1);if(d.instant=Math.sqrt(i/n.length),d.slow=.95*d.slow+.05*d.instant,d.clip=o/n.length,"pcm"===r||"wav"===r){for(var s=[],a=0;a<d.channels;a++)s.push(e.inputBuffer.getChannelData(a));d.recorderBuffer(s)}})),"pcm"!==r&&"wav"!==r||this.initRecorderBuffer(r)}return e.prototype.connectToSource=function(e,t){try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),void 0!==t&&t(null)}catch(e){console.error(e),void 0!==t&&t(e)}return this},e.prototype.recorderBuffer=function(e){this.worker.postMessage({command:"record",val:e})},e.prototype.initRecorderBuffer=function(e){var t=this;this.worker=this.inlineWorker((function(){var e,t,r,n,i,o,s=[];function a(e,t,r){for(var n=0;n<r.length;n++,t+=2){var i=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,i<0?32768*i:32767*i,!0)}}function c(e,t,r){for(var n=0;n<r.length;n++,t++){var i=Math.max(-1,Math.min(1,r[n])),o=i<0?128*i:127*i;e.setInt8(t,o+=128)}}function u(e,t,r){for(var n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}function l(e,t){for(var r=new Float32Array(t.length/e),n=0,i=0;n<r.length;)r[n]=t[i],i+=e,n++;return r}function d(e,t,r){for(var n=new Float32Array(t*e.length),i=0,o=0;o<r[0].length;o++)n.set(r[0][o],i),i+=r[0][o].length;return n}function h(e,t){for(var r=new Float32Array(e.length+t.length),n=0;n<e.length+t.length;n+=2)r[n]=e[n/2>>0],r[n+1]=t[n/2>>0];return r}function p(t){var r,n;if(1==e)r=d(s[0],i,s),1!=t&&(n=l(t,r));else if(2==e){var o=d(s[0],i,s),a=d(s[1],i,s);1!=t?n=h(l(t,o),l(t,a)):r=h(o,a)}return 1!=t?n:r}function f(e){var r=function(e,r){var n;8==r?n=e.length:16==r&&(n=e.length,n*=2);var i=new ArrayBuffer(n),o=new DataView(i);return 8==r?c(o,0,e):16==t&&a(o,0,e),o}(p(e),t);self.postMessage({command:"exportPcmLive",val:r})}function g(n){var i=function(n,i){var o;8==i?o=n.length:16==t&&(o=n.length,o*=2);var s=new ArrayBuffer(o+44),l=new DataView(s),d=r,h=t,p=e;return u(l,0,"RIFF"),l.setUint32(4,36+o,!0),u(l,8,"WAVE"),u(l,12,"fmt "),l.setUint32(16,16,!0),l.setUint16(20,1,!0),l.setUint16(22,p,!0),l.setUint32(24,d,!0),l.setUint32(28,d*p*(h/8),!0),l.setUint16(32,p*(h/8),!0),l.setUint16(34,h,!0),u(l,36,"data"),l.setUint32(40,o,!0),8==t?c(l,44,n):16==t&&a(l,44,n),l}(p(n),t);self.postMessage({command:"exportWav",val:i})}this.onmessage=function(a){switch(a.data.command){case"init":e=(c=a.data.val).sampleChannel,t=c.sampleBit,r=c.sampleRate,n=c.oldSampleRate,i=c.bufferSize,o=c.type;break;case"record":!function(t){for(var i=0;i<e;i++)s[i]||(s[i]=[]),s[i].push(t[i]);var a=Math.round(n/r);"pcm"===o?f(a):"wav"===o&&g(a),s=[]}(a.data.val)}var c}})),this.worker.postMessage({command:"init",val:{sampleChannel:this.channels,sampleBit:this.sampleBit,sampleRate:this.sampleRate,oldSampleRate:this.context.sampleRate,bufferSize:this.bufferSize,type:e}}),this.worker.onmessage=function(e){switch(e.data.command){case"exportPcmLive":t.onReceiveBuffer(e.data.val);break;case"exportWav":t.onReceiveWav(e.data.val)}}},e.prototype.onReceiveBuffer=function(e){},e.prototype.onReceiveWav=function(e){},e.prototype.writeString=function(e,t,r){for(var n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))},e.prototype.writeBuffer=function(e,t,r){for(var n=0;n<r.byteLength;n++)e.setUint8(t+n,r[n])},e.prototype.concatenation=function(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].buffer.byteLength;var n=new Uint8Array(t),i=0;for(r=0;r<e.length;++r)n.set(new Uint8Array(e[r].buffer),i),i+=e[r].buffer.byteLength;return n},e.prototype.encodeWave=function(e){var t=this.concatenation(e),r=t.byteLength,n=new ArrayBuffer(r+44),i=new DataView(n),o=this.sampleRate,s=this.sampleBit,a=this.channels;return this.writeString(i,0,"RIFF"),i.setUint32(4,36+r,!0),this.writeString(i,8,"WAVE"),this.writeString(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,a,!0),i.setUint32(24,o,!0),i.setUint32(28,o*a*(s/8),!0),i.setUint16(32,a*(s/8),!0),i.setUint16(34,s,!0),this.writeString(i,36,"data"),i.setUint32(40,r,!0),this.writeBuffer(i,44,t),i},e.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()},e.prototype.inlineWorker=function(e){if(Worker&&e){var t=e.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],r=URL.createObjectURL(new window.Blob([t],{type:"text/javascript"}));return new Worker(r)}return null},e}();t.MediaUtil=r},2523:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WEBRTC_ACTION=void 0,function(e){e.PRELOAD_EFFECT="zc.pe.0",e.PLAY_EFFECT="zc.pe.1",e.PAUSE_EFFECT="zc.pe.2",e.RESUME_EFFECT="zc.re",e.STOP_EFFECT="zc.se",e.UNLOAD_EFFECT="zc.ue",e.AUDIO_EFFECT_PROCESS="zc.aep",e.SET_EFFECT_VOLUME="zc.sev",e.START_MIXING_AUDIO="zc.sma.0",e.STOP_MIXING_AUDIO="zc.sma.1",e.MIXING_BUFFER="zc.mb",e.STOP_MIXING_BUFFER="zc.smb",e.PUBLISHER_PLAY_EFFECT="zc.p.0.pe.0",e.PUBLISHER_PAUSE_EFFECT="zc.p.0.pe.1",e.PUBLISHER_RESUME_EFFECT="zc.p.0.re",e.PUBLISHER_STOP_EFFECT="zc.p.0.se",e.PUBLISHER_START_MIXING_AUDIO="zc.p.0.sma.0",e.PUBLISHER_STOP_MIXING_AUDIO="zc.p.0.sma.1",e.SET_MIXING_AUDIO_VOLUME="zc.smav",e.PUBLISHER_MIXING_BUFFER="zc.p.0.mb",e.PUBLISHER_SET_MIXING_AUDIO_VOLUME="zc.p.0.smav"}(t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={}))},3013:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioBufferProcessor=void 0;var n=r(4853),i=function(){function e(e,t,r,n){this.logger=e,this.ac=t,this.localStream=r,this.rtcViewer=n,this.audioBufferList=[],this.replace=!1,this.effectEndedCallBack=null,this.effectEndedListener=null,this.startTimes=0,this.startOffset=0,this.pauseTimes=0,this.resumeOffset=0,this.paused=!1,this.isMixAudio=!1,this.isMixingBuffer=!1,this.loop=!1}return e.prototype.playEffect=function(e,t,r,n,i){var o=this;!0!==this.isMixAudio?this.audioBuffer?(this.startOffset=e||0,this.loop=t||!1,this.replace=r||!1,this.effectEndedCallBack=i,this.mixEffect(this.audioBuffer,(function(){o.buffSource.loop=!!t,e?o.buffSource.start(0,e/1e3):o.buffSource.start(0),o.startTimes=Date.now(),o.effectEndedListener=o.effectEndedHandler.bind(o),o.buffSource.addEventListener("ended",o.effectEndedListener),n&&n()}))):this.logger.error("amu.pe.1 no audio buffer found"):this.logger.warn("amu.pe.1 audio is mixing")},e.prototype.stopMixingBuffer=function(){return this.isMixingBuffer=!1,this.stopMixingAudio()},e.prototype.playRealTimeEffect=function(e){var t=this;this.mixEffect(e,(function(){t.buffSource&&t.buffSource.start(0),t.buffSource&&t.buffSource.addEventListener("ended",(function(){t.audioBufferList.shift(),t.audioBufferList.length>0&&t.isMixAudio&&t.playRealTimeEffect(t.audioBufferList[0])}))}))},e.prototype.pauseEffect=function(){this.audioBufferList.length>0?this.logger.error("amu.pe.0 real time buffer can not be paused"):(this.stopMixingAudio(!0),this.resumeOffset=(this.pauseTimes-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration),this.paused=!0)},e.prototype.resumeEffect=function(){return this.audioBufferList.length>0?(this.logger.error("amu.pe.0 real time buffer can not be resume"),!1):(this.playEffect(this.resumeOffset,this.loop,this.replace,void 0,this.effectEndedCallBack),this.startOffset=this.resumeOffset,this.paused=!1,!0)},e.prototype.mixEffect=function(e,t){this.localStream?(this.ac.resume(),this.gainNode=this.ac.createGain(),this.buffSource=this.ac.createBufferSource(),this.buffSource.buffer=e,this.buffSource.connect(this.gainNode),this.gainNode.connect(this.ac.destination),this.replaceTrack()&&t()):this.logger.error("amu.me.0 localStream can not be found")},e.prototype.replaceTrack=function(){if(!this.destination||!this.streamSource)return!1;!this.replace&&this.streamSource.connect(this.destination),this.gainNode.connect(this.destination);var e=this.destination.stream.getAudioTracks()[0];return this.micTrack=this.localStream.getAudioTracks()[0],this.localStream.removeTrack(this.micTrack),this.localStream.addTrack(e),this.rtcViewer&&this.rtcViewer.setAudio(e),this.isMixAudio=!0,!0},e.prototype.effectEndedHandler=function(){this.stopMixingAudio(),this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null},e.prototype.stopMixingAudio=function(e){return void 0===e&&(e=!1),this.paused?(this.logger.info("amu.sma.1 audioEffect is paused"),!e&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):this.isMixAudio?this.localStream?(this.buffSource&&(this.buffSource.removeEventListener("ended",this.effectEndedListener),this.buffSource.stop(),this.pauseTimes=Date.now(),this.buffSource.disconnect(this.gainNode),this.buffSource=null),this.gainNode.disconnect(this.destination),this.gainNode.disconnect(this.ac.destination),this.isMixAudio=!1,this.audioBufferList=[],!e&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):(this.logger.error("amu.sma.1 localStream can not be found"),!1):(this.logger.warn("amu.sma.1 no mixing audio found"),!0)},e.prototype.getProcess=function(){var e=Date.now();return this.paused&&(e=this.pauseTimes),(e-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration)},e.prototype.seekTo=function(e){void 0===e&&(e=0),this.startOffset=e,this.paused?this.resumeOffset=e:(this.stopMixingAudio(!0),this.playEffect(e,this.loop,this.replace,void 0,this.effectEndedCallBack))},e.prototype.mixingBuffer=function(e,t){var r=this;!0!==this.isMixAudio||0!=this.audioBufferList.length||0!=this.isMixingBuffer?(this.ac.resume(),this.ac.decodeAudioData(e,(function(e){r.audioBufferList.push(e),1==r.audioBufferList.length&&r.playRealTimeEffect(r.audioBufferList[0]),r.isMixingBuffer=!0,t&&t()}),(function(e){r.logger.error("amu.mb.0 "+e),t&&t({code:n.errorCodeList.PUBLISHER_DECODE_AUDIO_FAIL.code,message:n.errorCodeList.PUBLISHER_DECODE_AUDIO_FAIL.message+" "+e})}))):this.logger.error("amu.mb.0 audio is mixing")},e.prototype.setMixingAudioVolume=function(e){return this.gainNode?(this.gainNode.gain.value=e,!0):(this.logger.error("amu.sma.2 no mixing audio found"),!1)},e}();t.AudioBufferProcessor=i},4194:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioMix=void 0;var r=function(){function e(e,t,r,n,i,o){this.logger=e,this.ac=t,this.localStream=r,this.mediaEleSources=n,this.browser=i,this.rtcViewer=o,this.replace=!1,this.isMixAudio=!1,this.audioCurrentTimer=null,this.audioResumedTimer=null}return e.prototype.startMixingAudio=function(e,t){if(this.replace=t||!1,this.isMixAudio)return this.logger.error("amu.sma.0 audio is mixing"),!1;if(!this.localStream)return this.logger.error("amu.sma.0 localStream can not be found"),!1;if(e.captureStream=e.captureStream||e.mozCaptureStream||e.webkitCaptureStream,this.ac.resume(),this.gainNode=this.ac.createGain(),"safari"===this.browser){var r=this.mediaEleSources.find((function(t){return t.audio===e}));if(r)this.audioNode=r.node;else{var n=this.ac.createMediaElementSource(e);this.audioNode=n,this.mediaEleSources.push({audio:e,node:n})}this.getBrowserInfo(),this.audioResumedTimer=setInterval((function(){e.currentTime=e.currentTime+.45}),6e3)}else this.audioNode=this.ac.createMediaStreamSource(e.captureStream());return this.audioNode.connect(this.gainNode),this.replaceTrack()},e.prototype.getBrowserInfo=function(){var e,t={},r=navigator.userAgent.toLowerCase();e=(r.match(/x [\d._]+/gi)+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."),t.sysVer=e;var n=r.match(/(msie|firefox|chrome|opera|version).*?([\d.]+)/);return n&&(t.browser=n[1].replace(/version/,"'safari"),t.ver=n[2]),t},e.prototype.replaceTrack=function(){if(!this.destination||!this.streamSource)return!1;!this.replace&&this.streamSource.connect(this.destination),this.gainNode.connect(this.destination);var e=this.destination.stream.getAudioTracks()[0];return this.micTrack=this.localStream.getAudioTracks()[0],this.localStream.removeTrack(this.micTrack),this.localStream.addTrack(e),this.rtcViewer&&this.rtcViewer.setAudio(e),this.isMixAudio=!0,!0},e.prototype.stopMixingAudio=function(){return this.isMixAudio?this.localStream?(this.audioNode&&(this.audioNode.disconnect(this.gainNode),this.audioNode=null,this.audioCurrentTimer&&(clearInterval(this.audioCurrentTimer),this.audioCurrentTimer=null),this.audioResumedTimer&&(clearInterval(this.audioResumedTimer),this.audioResumedTimer=null)),this.gainNode.disconnect(this.destination),this.isMixAudio=!1,!0):(this.logger.error("amu.sma.1 localStream can not be found"),!1):(this.logger.warn("amu.sma.1 no mixing audio found"),!0)},e.prototype.setMixingAudioVolume=function(e){return this.gainNode?(this.gainNode.gain.value=e,!0):(this.logger.error("amu.sma.2 no mixing audio found"),!1)},e}();t.AudioMix=r},6459:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AudioMixModule=void 0;var o=r(2523),s=r(4234),a=r(6447),c=r(8011),u=function(){function e(e,t,r,n,i){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=n,this.ac=i,this.buffer=null,this.blank=null,"safari"==this.stateCenter.browser&&null==this.blank&&null==this.buffer&&(this.ac.resume(),this.buffer=this.ac.createBuffer(1,1,this.ac.sampleRate),this.blank=this.ac.createBufferSource(),this.blank.buffer=this.buffer,this.blank.connect(this.ac.destination),this.blank.start())}return e.prototype.preloadEffect=function(e,t,r){if(this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT,{effectID:e},{effectID:!0}))if(t&&"string"==typeof t){if(this.stateCenter.audioEffectBuffer[e])return this.logger.warn(o.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" audio buffer already exists"),void(r&&r());this.logger.info(o.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" start preload effect"),this._preloadEffect(this.ac,e,t,r)}else this.logger.error(o.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" params error")},e.prototype.checkPreviewer=function(e,t,r){void 0===t&&(t={});var n=!!(null==r?void 0:r.effectID),i=!!(null==r?void 0:r.previewer),o=t.effectID,s=t.streamID;return!(null==r?void 0:r.streamID)&&!s||"string"==typeof s||s instanceof MediaStream?n&&!o?(this.logger.error(e+" effectID required"),!1):o&&"string"!=typeof o?(this.logger.error(e+" effectID type error"),!1):!i||this.streamCenter.getPreviewer(s)||(this.logger.error("string"==typeof s?e+" "+s+" stream is not publishing":e+" stream doesn't exist"),!1):(this.logger.error(e+" stream type error"),!1)},e.prototype.getEffectDuration=function(e){if(!this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS,{effectID:e},{effectID:!0}))return 0;var t=this.stateCenter.audioEffectBuffer[e];return t?t.duration?Math.floor(1e3*t.duration):0:(this.logger.error(o.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+" effect not found"),0)},e.prototype.getEffectProgress=function(e,t){var r=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});return"boolean"==typeof r?0:this.getAudioManager(r).getEffectProgress(t)},e.prototype.seekAudioEffect=function(e,t,r){if(r<0)return this.logger.error(o.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+" param time error "),!1;var n=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});return"boolean"!=typeof n&&this.getAudioManager(n).seekAudioEffect(t,r)},e.prototype.playEffect=function(e,t,r){return n(this,void 0,void 0,(function(){var n,s,a,c=this;return i(this,(function(i){switch(i.label){case 0:return n=e.path,this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.PLAY_EFFECT,{streamID:e.stream||e.streamID,effectID:s=e.effectID},{streamID:!0,effectID:!0})?(a=this.stateCenter.audioEffectBuffer[s],n?a?(this.logger.warn(o.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" audio effect already exists"),[3,3]):[3,1]:[3,4]):[2];case 1:return[4,new Promise((function(e,t){c.preloadEffect(s,n,(function(r){r?(c.logger.error(o.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" preload audio effect failed"),t(r)):e(void 0)}))}))];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!a)return this.logger.error(o.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" audio effect doesn't exists"),[2];i.label=5;case 5:return this._playEffect(e,t,r),[2]}}))}))},e.prototype.pauseEffect=function(e,t){return this._pauseEffect(e,t)},e.prototype.resumeEffect=function(e,t){return this._resumeEffect(e,t)},e.prototype.stopEffect=function(e,t){return this._stopEffect(e,t)},e.prototype.unloadEffect=function(e){return!!this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.UNLOAD_EFFECT,{effectID:e},{effectID:!0})&&(delete this.stateCenter.audioEffectBuffer[e],!0)},e.prototype.setEffectVolume=function(e,t,r){if("number"!=typeof t||t<0||t>200)return this.logger.error(o.ZEGO_WEBRTC_ACTION.SET_EFFECT_VOLUME+" volume must be a number between 0 and 200"),!1;var n=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.SET_EFFECT_VOLUME,{streamID:e,effectID:r},{streamID:!0,previewer:!0});return"boolean"!=typeof n&&this.getAudioManager(n).setEffectVolume(t/100,r)},e.prototype.startMixingAudio=function(e,t){return this.logger.info(o.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" call "+e),e?t?(this.logger.info(o.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" end "+e),Array.isArray(t)&&0!==t.length&&t.every((function(e){return e instanceof HTMLMediaElement}))?this._startMixingAudio(e,t):(this.logger.error(o.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" audio list param type error"),!1)):(this.logger.error(o.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" no audio"),!1):(this.logger.error(o.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" stream not found"),!1)},e.prototype.stopMixingAudio=function(e,t){return e?Array.isArray(t)&&0!==t.length||void 0===t?this._stopMixingAudio(e,t):(this.logger.error(o.ZEGO_WEBRTC_ACTION.STOP_MIXING_AUDIO+" audio param type error"),!1):(this.logger.error(o.ZEGO_WEBRTC_ACTION.STOP_MIXING_AUDIO+" stream not found"),!1)},e.prototype.mixingBuffer=function(e,t,r,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" call streamID: "+JSON.stringify(e)+" sourceID:"+t),e?t&&"string"==typeof t?(this._mixingBuffer(e,t,r,n),this.logger.info(o.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" end")):this.logger.error(o.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" param source id format error"):this.logger.error(o.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" param streamid format error")},e.prototype.stopMixingBuffer=function(e,t){return this._stopMixingBuffer(e,t)},e.prototype.setMixingAudioVolume=function(e,t,r){return this.logger.info(o.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" call"),e?"number"!=typeof t||t<0||t>200?(this.logger.error(o.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" volume must be a number between 0 and 200"),!1):r&&r instanceof HTMLMediaElement?this._setMixingAudioVolume(e,t,r):(this.logger.error(o.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" no audio"),!1):(this.logger.error(o.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" stream not found"),!1)},e.prototype.getSoundLevel=function(e,t,r){this.logger.info("zc.gsl call");var n=this.stateCenter.getReportSeq();this.dataReport.newReport(n,s.ZegoRTCLogEvent.kZegoTaskGetSoundLevel.event);try{var i=this.ac.createMediaStreamSource(e),o=new c.SoundMeterWorklet(this.logger,this.streamCenter.soundLevelInterval);o.initAudioWorklet(this.ac,i),o.onSoundLevelUpdate=function(e){t(e)},this.stateCenter.audioStreamList[e.id]={mic:i,script:o},this.dataReport.uploadReport(n)}catch(e){r(e),this.dataReport.addMsgInfo(n,s.ZegoRTCLogEvent.kZegoTaskGetSoundLevel.error.kGetSoundLevelError),this.dataReport.uploadReport(n)}this.logger.info("zc.gsl call success")},e.prototype.stopSoundLevel=function(e){this.logger.info("zc.ssl call");var t=this.stateCenter.getReportSeq();this.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskStopSoundLevel);var r=this.stateCenter.audioStreamList[e.id];r.mic.disconnect(),r.script.destroy(),delete this.stateCenter.audioStreamList[e.id],this.dataReport.uploadReport(t)},e.prototype._preloadEffect=function(e,t,r,n){var i=this,o=new XMLHttpRequest;o.open("GET",r,!0),o.setRequestHeader("Range","none"),o.responseType="arraybuffer",o.onload=function(){if(200==o.status||304==o.status)e.decodeAudioData(o.response,(function(e){i.logger.info("zc.pe.0 effect '".concat(t,"' preload success")),i.stateCenter.audioEffectBuffer[t]=e,n&&n()}),(function(e){i.logger.error("zc.pe.0 effect '".concat(t,"' preload fail. ")+e),n&&n(e)}));else{var r=o.statusText;i.logger.error("zc.pe.0 effect '".concat(t,"' preload fail.")+r),n&&n(r)}},o.send()},e.prototype._playEffect=function(e,t,r){var n=this.stateCenter.audioEffectBuffer[e.effectID];if(n){var i=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.PLAY_EFFECT,{streamID:e.stream||e.streamID,effectID:e.effectID},{streamID:!0,effectID:!0,previewer:!0});"boolean"!=typeof i&&this.getAudioManager(i).playEffect(e,n,t,r)}else this.logger.error(o.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" no audio buffer found")},e.prototype._pauseEffect=function(e,t){var r=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.PAUSE_EFFECT,{streamID:e,effectID:t},{streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).pauseEffect(t)},e.prototype._resumeEffect=function(e,t){var r=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.RESUME_EFFECT,{streamID:e,effectID:t},{streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).resumeEffect(t)},e.prototype._stopEffect=function(e,t){var r=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.STOP_EFFECT,{streamID:e,effectID:t},{streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).stopEffect(t)},e.prototype._setMixingAudioVolume=function(e,t,r){var n=this.streamCenter.getPreviewer(e);return n?this.getAudioManager(n).setMixingAudioVolume(t/100,r):(this.logger.error("zc.sma.2 publisher doesn't exist"),!1)},e.prototype._startMixingAudio=function(e,t){var r=this.streamCenter.getPreviewer(e);return r?this.getAudioManager(r).startMixingAudio(t):(this.logger.error("string"==typeof e?"zc.sma.0 "+e+" stream is not publishing":"zc.sma.0 stream doesn't exist"),!1)},e.prototype._stopMixingAudio=function(e,t){var r=this.streamCenter.getPreviewer(e);return r?this.getAudioManager(r).stopMixingAudio(t):(this.logger.error("zc.sma.0 stream doesn't exist"),!1)},e.prototype._mixingBuffer=function(e,t,r,n){var i=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.STOP_MIXING_BUFFER,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});"boolean"!=typeof i&&(r instanceof ArrayBuffer?this.getAudioManager(i).mixingBuffer(t,r,n):this.logger.error("zc.mb.0 array buffer not found"))},e.prototype._stopMixingBuffer=function(e,t){var r=this.checkPreviewer(o.ZEGO_WEBRTC_ACTION.STOP_MIXING_BUFFER,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).stopMixingBuffer(t)},e.prototype.getAudioManager=function(e){var t=e.audioMixManager;return t||(t=new a.PreviewAudioManager(e),e.audioMixManager=t),t},e}();t.AudioMixModule=u},4853:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={GET_SOUND_LEVEL_FAIL:{code:1000019,message:"get sound level error"},PUBLISHER_DECODE_AUDIO_FAIL:{code:1103057,message:"decode audio data fail"}}},7526:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6459);t.default={type:"AudioMix",install:function(e){Object.defineProperty(e.prototype,"initAudioMix",{value:function(){this.audioMixModule=new n.AudioMixModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.ac)}})}}},4234:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var n=r(4853);t.ZegoRTCLogEvent={kZegoTaskGetSoundLevel:{event:"/sdk/get_sound_level",error:{kGetSoundLevelError:n.errorCodeList.GET_SOUND_LEVEL_FAIL}},kZegoTaskStopSoundLevel:"/sdk/stop_sound_level"}},6447:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewAudioManager=void 0;var n=r(2523),i=r(3013),o=r(4194),s=function(){function e(e){this.previewer=e,this.audioSrcNode=void 0,this.audioDestNode=void 0,this.audioMixList=[],this.arrayBufferMap={},this.effectList=[],this.mediaEleSources=e.streamCenter.mediaEleSources}return Object.defineProperty(e.prototype,"logger",{get:function(){return this.previewer.logger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localStream",{get:function(){return this.previewer.localStream},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamCenter",{get:function(){return this.previewer.streamCenter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ac",{get:function(){return this.previewer.ac},enumerable:!1,configurable:!0}),e.prototype.startMixingAudio=function(e){var t=this;return this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" call"),this.localStream?(e.forEach((function(e){var r;if(t.audioMixList.find((function(t){return t.media==e})))t.logger.warn(n.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" mix audio already exist");else if(t.localStream){t.streamCenter.soundLevelDelegate&&t.previewer.stopSoundLevel();var i=new o.AudioMix(t.logger,t.ac,t.localStream,t.mediaEleSources,t.previewer.stateCenter.browser,t.previewer.rtcViewer);t.audioSrcNode||(t.audioSrcNode=t.ac.createMediaStreamSource(t.localStream));var s=!1;t.audioDestNode||(t.audioDestNode=t.ac.createMediaStreamDestination(),s=!0),i.destination=t.audioDestNode,i.streamSource=t.audioSrcNode,t.audioMixList.push({audioMix:i,media:e}),i.startMixingAudio(e),s&&(null===(r=t.audioDestNode)||void 0===r?void 0:r.stream)&&t.previewer.onAudioTrackChange(t.audioDestNode.stream.getAudioTracks()[0]),t.streamCenter.soundLevelDelegate&&t.previewer.startSoundLevel()}})),!0):(this.logger.error(n.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" localStream not found"),!1)},e.prototype.stopMixingAudio=function(e){var t=this;return this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_MIXING_AUDIO+" call"),e?e.forEach((function(e){for(var r=0;r<t.audioMixList.length;r++)if(t.audioMixList[r].media==e){t.audioMixList[r].audioMix.stopMixingAudio()&&t.audioMixList.splice(r--,1);break}})):(this.audioMixList.forEach((function(e){return e.audioMix.stopMixingAudio()})),this.audioMixList=[]),!0},e.prototype.setMixingAudioVolume=function(e,t){this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" call");var r=this.audioMixList.find((function(e){return e.media===t}));return r?(r.audioMix.setMixingAudioVolume(e),this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" call success"),!0):(this.logger.error(n.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" audio is not mixing"),!1)},e.prototype.playEffect=function(e,t,r,o){var s=this;if(this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" call"),this.localStream)if(this.effectList.find((function(r){return r.effectID==e.effectID&&r.audioBuffer==t})))this.logger.warn(n.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" effect already exist ");else{this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel();var a=new i.AudioBufferProcessor(this.logger,this.ac,this.localStream,this.previewer.rtcViewer);this.audioSrcNode||(this.audioSrcNode=this.ac.createMediaStreamSource(this.localStream));var c=!1;this.audioDestNode||(this.audioDestNode=this.ac.createMediaStreamDestination(),c=!0),a.destination=this.audioDestNode,a.streamSource=this.audioSrcNode,a.audioBuffer=t;var u={processor:a,effectID:e.effectID,audioBuffer:t};this.effectList.push(u),a.playEffect(e.playTime,e.loop,!1,(function(){var e;c&&(null===(e=s.audioDestNode)||void 0===e?void 0:e.stream)&&s.previewer.onAudioTrackChange(s.audioDestNode.stream.getAudioTracks()[0]),r&&r()}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.effectList=s.effectList.filter((function(e){return e!==u})),o&&o.apply(void 0,e)})),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" play effect "+e.effectID+" success")}else this.logger.warn(n.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" stream not found")},e.prototype.pauseEffect=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),t.processor.pauseEffect(),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_PAUSE_EFFECT+" pause "+e+" success");else{if(void 0!==e)return this.logger.error(n.ZEGO_WEBRTC_ACTION.PUBLISHER_PAUSE_EFFECT+" effect not found"),!1;this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.effectList.forEach((function(e){return e.processor.pauseEffect()})),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel()}return!0},e.prototype.resumeEffect=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t){this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel();var r=t.processor.resumeEffect();return this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_RESUME_EFFECT+" resume "+e+" success"),r}return void 0===e?(this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.effectList.forEach((function(e){return e.processor.resumeEffect()})),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),!0):(this.logger.error(n.ZEGO_WEBRTC_ACTION.PUBLISHER_RESUME_EFFECT+" no effect found"),!1)},e.prototype.stopEffect=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),t.processor.stopMixingAudio(),this.effectList=this.effectList.filter((function(e){return e!==t})),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_EFFECT+" pause "+e+" success");else{if(void 0!==e)return this.logger.error(n.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_EFFECT+" effect not found"),!1;this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.effectList.forEach((function(e){return e.processor.stopMixingAudio()})),this.effectList=[],this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel()}return!0},e.prototype.setEffectVolume=function(e,t){var r=this.effectList.find((function(e){return e.effectID==t}));if(r)r.processor.setMixingAudioVolume(e),this.logger.info("zp.sev.0 set volume "+t+" success");else{if(void 0!==t)return this.logger.error("zp.sev.0 effect not found"),!1;this.effectList.forEach((function(t){return t.processor.setMixingAudioVolume(e)}))}return!0},e.prototype.mixingBuffer=function(e,t,r){var o=this;if(this.logger.info(n.ZEGO_WEBRTC_ACTION.PUBLISHER_MIXING_BUFFER+" call"),this.localStream)if(this.arrayBufferMap[e])this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.arrayBufferMap[e].mixingBuffer(t,(function(){o.streamCenter.soundLevelDelegate&&o.previewer.startSoundLevel(),r&&r()}));else{this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel();var s=new i.AudioBufferProcessor(this.logger,this.ac,this.localStream,this.previewer.rtcViewer);this.audioSrcNode||(this.audioSrcNode=this.ac.createMediaStreamSource(this.localStream));var a=!1;this.audioDestNode||(this.audioDestNode=this.ac.createMediaStreamDestination(),a=!0),s.destination=this.audioDestNode,s.streamSource=this.audioSrcNode,this.arrayBufferMap[e]=s,s.mixingBuffer(t,(function(){var e;o.streamCenter.soundLevelDelegate&&o.previewer.startSoundLevel(),a&&(null===(e=o.audioDestNode)||void 0===e?void 0:e.stream)&&o.previewer.onAudioTrackChange(o.audioDestNode.stream.getAudioTracks()[0]),r&&r()}))}},e.prototype.stopMixingBuffer=function(e){if(e&&this.arrayBufferMap[e])return this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.arrayBufferMap[e].stopMixingBuffer(),delete this.arrayBufferMap[e],this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),!0;if(void 0===e){for(var t in this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.arrayBufferMap)this.arrayBufferMap[t].stopMixingBuffer();return this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),!0}return this.logger.warn(n.ZEGO_WEBRTC_ACTION.PUBLISHER_MIXING_BUFFER+" arrayBuffer no found"),!1},e.prototype.getEffectProgress=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));return t?t.processor.getProcess():(this.logger.error(n.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+"  effect not found"),0)},e.prototype.seekAudioEffect=function(e,t){var r=this.effectList.find((function(t){return t.effectID==e}));return r?(this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),r.processor.seekTo(t),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),!0):(this.logger.error(n.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+" effect not found"),!1)},e.prototype.stopAudioManager=function(){this.stopMixingAudio(),this.stopMixingBuffer(),this.stopEffect()},e}();t.PreviewAudioManager=s},4897:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataChannel=void 0;var n=r(8835);t.DataChannel={type:"DataChannel",install:function(e){Object.defineProperty(e.prototype,"createRealTimeSequentialDataManager",{value:function(e){this.enableDataChannel(!0);var t=this.stateCenter.getRoomByRoomID(e);return t?t.dataChannelManager?null:(t.dataChannelManager=new n.ZegoRealTimeSequentialDataManager(this,e),t.dataChannelManager):(this.logger.error("zc.crsdm room no exist"),null)},writable:!1}),Object.defineProperty(e.prototype,"destroyRealTimeSequentialDataManager",{value:function(e){var t=this.stateCenter.roomList.find((function(t){return t.dataChannelManager==e}));t&&(e.dataChannelManager.reset(),t.dataChannelManager=null)},writable:!1})}}},3504:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataChannelListener=void 0;var i=function(){function e(e,t){this.zegoWebRTC=e,this.roomID=t,this.pubDataChannelList=[],this.subDataChannelList=[],this.listenerList={receiveRealTimeSequentialData:[]},this.logger=e.logger}return e.prototype.startBroadcasting=function(e,t){return r(this,void 0,void 0,(function(){var t,r,i,o;return n(this,(function(n){switch(n.label){case 0:return this.logger.info("dc.sb.0 call"),this.pubDataChannelList.includes(e)?(this.logger.error("dc.sb.0 datachannel already exist"),[2,!1]):(t=this.zegoWebRTC.streamCenter.publisherList[e])&&t.publisher.dataChannel?(this.pubDataChannelList.push(e),[2,!0]):t&&!t.publisher.dataChannel?(this.logger.error("dc.sb.0 publish datachannel no exist, try other stream ID"),[2,!1]):this.broadcastStream?[3,2]:(r=document.createElement("canvas"),i=this,[4,this.zegoWebRTC.createStream({custom:{source:r}})]);case 1:i.broadcastStream=n.sent(),n.label=2;case 2:return(o=this.zegoWebRTC.startPublishingStream(e,this.broadcastStream,{roomID:this.roomID},!0))&&this.pubDataChannelList.push(e),this.logger.info("dc.sb.0 end"),[2,o]}}))}))},e.prototype.stopBroadcasting=function(e){this.logger.info("dc.sb.1 call"),this.pubDataChannelList=this.pubDataChannelList.filter((function(t){return t!==e}));var t=this.zegoWebRTC.streamCenter.publisherList[e];return t?(t.room.roomID==this.roomID&&t.isDataChannel&&this.zegoWebRTC.stopPublishingStream(e),this.logger.info("dc.sb.1 end"),!0):(this.logger.error("dc.sb.1 datachannel no found"),!1)},e.prototype.sendRealTimeSequentialData=function(e,t){if(!t instanceof ArrayBuffer)return this.logger.error("dc.srsd data type wrong"),!1;var r=this.zegoWebRTC.streamCenter.publisherList[e];return r&&this.pubDataChannelList.includes(e)?this.sendBCMessage(r.publisher,t):(this.logger.error("dc.srsd datachannel no found"),!1)},e.prototype.sendBCMessage=function(e,t){var r;if(!e.dataChannelState)return!1;for(var n=new Uint8Array(t),i=0,o=t.byteLength,s=e.send_seq,a=0,c=(new Date).getTime(),u=0;o>0;){o>1151?u=1141:(u=o,a=1);var l=new Uint8Array(u+10);l[0]=1,l[1]=a,l[2]=e.send_seq>>8&255,l[3]=255&e.send_seq,l[4]=s>>8&255,l[5]=255&s,l[6]=c>>24&255,l[7]=c>>16&255,l[8]=c>>8&255,l[9]=255&c;for(var d=0;d<u;d++)l[d+10]=n[d+i];o-=u,i+=u,e.send_seq++,e.send_seq>=65536&&(e.send_seq=0),null===(r=e.dataChannel)||void 0===r||r.send(l)}return!0},e.prototype.startSubscribing=function(e,t){var i,o;return r(this,void 0,void 0,(function(){var t,r;return n(this,(function(n){switch(n.label){case 0:return this.logger.info("dc.ss.0 call"),this.subDataChannelList.includes(e)?(this.logger.error("dc.ss.0 datachannel already exist"),[2,!1]):(t=this.zegoWebRTC.streamCenter.playerList[e])?[3,2]:[4,this.zegoWebRTC.startPlayingStream(e,void 0,!0)];case 1:n.sent(),t=this.zegoWebRTC.streamCenter.playerList[e],n.label=2;case 2:return(r=t.player).dataChannel?(!(null===(i=r.onDataChannelList)||void 0===i?void 0:i.includes(this.onReceivedDataChannel.bind(this)))&&(null===(o=r.onDataChannelList)||void 0===o||o.push(this.onReceivedDataChannel.bind(this))),this.subDataChannelList.push(e),this.logger.info("dc.ss.0 end"),[2,!0]):(this.logger.error("dc.ss.0 datachannel no exist, try other stream ID"),[2,!1])}}))}))},e.prototype.stopSubscribing=function(e){this.logger.info("dc.ss.1 call"),this.subDataChannelList=this.subDataChannelList.filter((function(t){return t!==e}));var t=this.zegoWebRTC.streamCenter.playerList[e];return t?(t.room.roomID==this.roomID&&t.isDataChannel&&this.zegoWebRTC.stopPlayingStream(e),this.logger.info("dc.ss.1 end"),!0):(this.logger.error("dc.ss.1 datachannel no subscribe"),!1)},e.prototype.on=function(e,t){this.bindListener(e,t)},e.prototype.off=function(e,t){this.deleteListener(e,t)},e.prototype.bindListener=function(e,t){return this.listenerList[e]?"function"!=typeof t?(this.logger.error("zc.o.0 listener callBack must be funciton"),!1):(-1==this.listenerList[e].indexOf(t)&&this.listenerList[e].push(t),!0):(this.logger.error("dc.o.0 event "+e+" no found"),!1)},e.prototype.deleteListener=function(e,t){if(!this.listenerList[e])return this.logger.error("dc.o.1 listener no found"),!1;var r=this.listenerList[e];return t?r.splice(r.indexOf(t),1):this.listenerList[e]=[],!0},e.prototype.actionListener=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.listenerList[e]&&this.listenerList[e].forEach((function(n){try{setTimeout((function(){n.apply(void 0,r)}),0)}catch(r){t.logger.error("dc.al "+e+" "+r)}}))},e.prototype.onReceivedDataChannel=function(e,t,r){this.actionListener("receiveRealTimeSequentialData",e,t,r)},e.prototype.reset=function(){var e=this;for(var t in this.logger.info("dc.rs call"),this.pubDataChannelList.forEach((function(t){var r=e.zegoWebRTC.streamCenter.publisherList[t];r&&r.room.roomID==e.roomID&&r.isDataChannel&&e.zegoWebRTC.stopPublishingStream(t)})),this.subDataChannelList.forEach((function(t){var r=e.zegoWebRTC.streamCenter.playerList[t];r&&r.room.roomID==e.roomID&&r.isDataChannel&&e.zegoWebRTC.stopPlayingStream(t)})),this.listenerList)this.listenerList[t]=[];this.broadcastStream&&this.zegoWebRTC.destroyStream(this.broadcastStream),this.broadcastStream=void 0,this.logger.info("dc.rs end")},e}();t.DataChannelListener=i},5906:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.streamHandler=t.zegoWebRTC=void 0;var i=r(817),o=r(6145),s="2.20.2",a=1e4,c={},u="addMsgInfo";function l(e,t){var r,n,o,s,c="",u=i.errorCodeList;return t.errorCode<2e9&&t.errorCode>1e9?(o={1:"MIXER_START_REQUEST_ERROR",2:"MIXER_START_REQUEST_ERROR",3:"MIXER_AUTHENTICATION_FAILED",150:"MIXER_INPUT_STREAM_NOT_EXISTS",151:"MIXER_START_REQUEST_ERROR",152:"MIXER_STOP_REQUEST_ERROR",153:"MIXER_INPUT_PARAMETERS_ERROR",154:"MIXER_EXCEED_MAX_OUTPUT_COUNT",155:"MIXER_INPUT_PARAMETERS_ERROR",156:"MIXER_VIDEO_CONFIG_INVALID",157:"MIXER_NO_SERVICES",158:"MIXER_EXCEED_MAX_INPUT_COUNT",159:"MIXER_START_REQUEST_ERROR",160:"MIXER_NOT_OWNER_STOPMIXER",170:"MIXER_WATERMARK_PARAMETERS_ERROR",171:"MIXER_WATERMARK_NULL",175:"MIXER_REPEAT_INPUT",190:"MIXER_START_REQUEST_ERROR"},s="MIXER_INNER_ERROR",(n=t.errorCode-a)>1e9&&o[n-1e9]&&(s=o[n-1e9]),r=u[c=s]):t.errorCode<1e6&&(r=e.decodeServerError(t.errorCode,t.extendedData),c=e.getLiveRoomError(t.errorCode,this.stateCenter.useNetAgent)),{reportErr:r,actualError:u[c]}}t.zegoWebRTC={startMixerTask:function(e){var t=this;return new Promise((function(r,n){var i=t.stateCenter.getReportSeq();t.dataReport.newReport(i,o.ZegoRTCLogEvent.kZegoTaskMixStart.event),t.stateCenter.logReportCallback("kZegoTaskMixStart"+e.taskID,t.dataReport,i,t.stateCenter.reportList);var s={errorCode:1005027,extendedData:"mix stream input parameters are wrong"};if(null==e?void 0:e.inputList.find((function(e){return null==e.streamID&&(s.extendedData=s.extendedData+". streamID should be of string type",!0)})))return t.dataReport.addMsgInfo(i,s),t.dataReport.uploadReport(i),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),void n(s);e.outputConfig&&e.outputConfig.outputFps&&(e.outputConfig.outputFPS=e.outputConfig.outputFps);var a=function(r){var o=l(t.stateCenter,r),s=o.reportErr,a=o.actualError;t.dataReport.addMsgInfo(i,s||r),t.dataReport.uploadReport(i),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),a&&(r.errorCode=null==a?void 0:a.code,r.extendedData=(null==a?void 0:a.message)||""),n(r)},c=t.stateCenter.roomList[0];c?c.streamHandler.updateMixStream(e,(function(n){t.dataReport.uploadReport(i),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),r(n)}),a):a({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kNoLoginError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kNoLoginError.message})}))},setMixerTaskConfig:function(e){var t=this;return new Promise((function(r,n){var i=t.stateCenter.getReportSeq();t.dataReport.newReport(i,o.ZegoRTCLogEvent.kZegoTaskMixConfig.event),t.stateCenter.logReportCallback("kZegoTaskMixConfig",t.dataReport,i,t.stateCenter.reportList);var s=t.stateCenter.roomList[0];s?s.streamHandler.setMixerTaskConfig(e).then((function(e){t.dataReport.uploadReport(i),t.stateCenter.unregisterCallback("kZegoTaskMixConfig",t.stateCenter.reportList),r(e)})).catch((function(e){t.dataReport.addMsgInfo(i,e),t.dataReport.uploadReport(i),t.stateCenter.unregisterCallback("kZegoTaskMixConfig",t.stateCenter.reportList),n(e)})):n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kNoLoginError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kNoLoginError.message})}))},stopMixerTask:function(e){var t=this;return new Promise((function(r,n){var i=t.stateCenter.getReportSeq();if(t.dataReport.newReport(i,o.ZegoRTCLogEvent.kZegoTaskMixStop.event),!e||"string"!=typeof e||e.length>256||!t.stateCenter.checkIllegalCharacters(e))return t.logger.error("zb.rh.lg taskID must be string less 256"),t.dataReport.addMsgInfo(i,{error:o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.code,message:o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.message+" param taskID error"}),t.dataReport.uploadReport(i),void n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.message+" param taskID error"});var s=function(e){var r=l(t.stateCenter,e),o=r.reportErr,s=r.actualError;t.dataReport.addMsgInfo(i,o||e),t.dataReport.uploadReport(i),s&&(e.errorCode=null==s?void 0:s.code,e.extendedData=(null==s?void 0:s.message)||""),n(e)},a=t.stateCenter.roomList[0];a?a.streamHandler.stopMixStream(e,(function(e){t.dataReport.uploadReport(i),r(e)}),s):s({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kNoLoginError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kNoLoginError.message})}))}},t.streamHandler={setMixerTaskConfig:function(e){var t=this;return new Promise((function(r,n){var i,s={},a={};if(e&&e.videoCodec){var l=e.videoCodec.toLowerCase();if(-1==["vp8","h264"].indexOf(l))return t.logger.error("zb.sh.ums param videoCode error"),n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kVideoConfigInvalidError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kVideoConfigInvalidError.message}),!1;s.videoCodec=l,a.video_codec=l}if(e.backgroundColor){if(!t.stateCenter.checkInteger(e.backgroundColor))return t.logger.error("zb.sh.ums param backgroundColor must be integer number"),n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;s.backgroundColor=e.backgroundColor,a.background_color=e.backgroundColor}if(e.backgroundImage){if("string"!=typeof e.backgroundImage)return t.logger.error("zb.sh.ums param outputBgImage error"),n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;if(!e.backgroundImage.startsWith("preset-id://")||!e.backgroundImage.endsWith(".jpg")&&!e.backgroundImage.endsWith(".png"))return t.logger.error("zb.sh.ums illegal input background image URL"),n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kBackgroundImageUrlInvalidError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kBackgroundImageUrlInvalidError.message}),!1;s.backgroundImage=e.backgroundImage,a.background_image=e.backgroundImage}if(e.waterMark&&(s.waterMark=e.waterMark,a.water_mark=e.waterMark),e&&e.userData){if(!(e.userData instanceof Uint8Array))return t.logger.error("zb.sh.ums param userData required Uint8Array"),n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;if(e.userData.byteLength>1e3)return t.logger.error("zb.sh.ums param userData should shorter than 1000"),n({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;s.userData=e.userData}e.extraParams&&(s.extraParams||(s.extraParams=[]),(i=s.extraParams).push.apply(i,e.extraParams)),c=s,t.stateCenter.actionSuccessCallback("kZegoTaskMixConfig",t.stateCenter.reportList)&&t.stateCenter.actionSuccessCallback("kZegoTaskMixConfig",t.stateCenter.reportList)(u,void 0,{config:o.ZegoRTCLogEvent.kZegoTaskMixConfig.config(a)}),r({errorCode:0,extendedData:""})}))},stopMixStream:function(e,t,r,n,c){var u=this;this.logger.info("zb.sh.sms call");var l={id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:s};if("string"==typeof e&&(l.task_id=e),null!=n?l.stream_id=this.stateCenter.testEnvironment?"zegotest-"+this.stateCenter.appid+"-"+n:n:null!=c&&(l.mixurl=c),this.stateCenter.useNetAgent)this.sendBizChannelRequestV2({server:12,location:"/interface/command",cmd:"stop_mix"},l,(function(e){t&&t({errorCode:0,extendedData:""})}),(function(e,t,n,s){var c="";if(s)return s==i.errorCodeList.TIMEOUT&&(s=o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kRequestError),s.code&&20010===s.code&&(s=JSON.parse(JSON.stringify(i.errorCodeList.MIXER_NO_SERVICES))),void(r&&r(s,c));if(s=o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError,200===e){if("number"==typeof t)return u.logger.debug("zb.sh.sms error: "+t),t+=1e9,void(r&&r({errorCode:u.stateCenter.getServerError(a+t).code,extendedData:c}));u.logger.error("zb.sh.sms stop mix fail "+JSON.stringify(error));var l=o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError;r&&r({errorCode:l.code,extendedData:l.message})}else u.logger.error("zb.sh.sms "+(c="request mix server fail, error: "+e)),r&&r(s,c)}));else{var d={channel:"zeus",cmd:"stop_mix",req_body:JSON.stringify(l)};this.sendBizChannelRequest(d,(function(){t&&t({errorCode:0,extendedData:""})}),(function(e){var t;"number"==typeof e?r&&r({errorCode:u.stateCenter.getServerError(a+e).code,extendedData:""}):(u.logger.error("zb.sh.sms stop mix fail "+JSON.stringify(e)),t=e==i.errorCodeList.TIMEOUT?o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kRequestError:o.ZegoRTCLogEvent.kZegoTaskMixStop.error.kInternalError,r&&r({errorCode:t.code,extendedData:t.message}))}))}return!0},updateMixStream:function(e,t,r){var l,d,h=this;if(this.logger.info("zb.sh.ums call"),!e.noTaskID&&!e.taskID)return this.logger.error("zb.sh.ums no taskId found"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDNullError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDNullError.message}),!1;if(!e.noTaskID&&"string"!=typeof e.taskID)return this.logger.error("zb.rh.lg taskId must be string"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.noTaskID&&e.taskID.length>256)return this.logger.error("zb.sh.ums taskId is too long"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDToLongError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDToLongError.message}),!1;if(!e.noTaskID&&!this.stateCenter.checkIllegalCharacters(e.taskID))return this.logger.error("zb.sh.ums task ID contains illegal characters"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDInvalidCharacterError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDInvalidCharacterError.message}),!1;if(!e.inputList||0==e.inputList.length)return this.logger.error("zb.sh.ums input list wrong"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInputListNullError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInputListNullError.message}),!1;e.inputList.forEach((function(e){"AUDIO"===e.contentType&&(!e.layout&&(e.layout={top:0,left:0,bottom:0,right:0}),e.layout.top=0,e.layout.left=0,e.layout.bottom=1,e.layout.right=1)}));for(var p=0;p<e.inputList.length;p++){var f=e.inputList[p],g={errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message};if("object"!=typeof f.layout)return this.logger.error("zb.sh.ums input layout must be object"),r(g),!1;if(!(this.stateCenter.checkInteger(f.layout.top,!1)&&this.stateCenter.checkInteger(f.layout.bottom,!1)&&this.stateCenter.checkInteger(f.layout.left,!1)&&this.stateCenter.checkInteger(f.layout.right,!1)))return this.logger.error("zb.sh.ums top\u3001left\u3001bottom\u3001right must be integer number"),r(g),!1;if(void 0!==f.renderMode&&![0,1].includes(f.renderMode))return this.logger.error("zb.sh.ums render_mode is wrong"),r(g),!1}if(!e.outputList||0==e.outputList.length)return this.logger.error("zb.sh.ums no output list found"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputListNullError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputListNullError.message}),!1;if(e.outputList.some((function(e){return"string"==typeof e&&!h.stateCenter.isUrl(e)&&!h.stateCenter.checkIllegalCharacters(e)||"object"==typeof e&&e.target&&!h.stateCenter.isUrl(e.target)&&!h.stateCenter.checkIllegalCharacters(e.target)})))return this.logger.error("zb.sh.ums stream output target is incorrect"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.message}),!1;if(!((d=e.inputList.every((function(e){return"AUDIO"===e.contentType})))||e.outputConfig&&"object"==typeof e.outputConfig))return this.logger.error("zb.sh.ums no output config found"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputNoTargetError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputNoTargetError.message}),!1;if(d&&(e.outputConfig=n(n({},e.outputConfig||{}),{outputBitrate:.001,outputFPS:1,outputWidth:1,outputHeight:1})),!(d||e.outputConfig.outputBitrate&&this.stateCenter.checkInteger(e.outputConfig.outputBitrate)))return this.logger.error("zb.sh.ums bitrate param is required and must be integer number"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputFPS||!this.stateCenter.checkInteger(e.outputConfig.outputFPS))return this.logger.error("zb.sh.ums fps param is required and must be integer number"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputWidth||!this.stateCenter.checkInteger(e.outputConfig.outputWidth))return this.logger.error("zb.sh.ums width param is required and must be integer number"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputHeight||!this.stateCenter.checkInteger(e.outputConfig.outputHeight))return this.logger.error("zb.sh.ums height param is required and must be integer number"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioCodecID&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioCodecID,!1))return this.logger.error("zb.sh.ums AudioCodecID param must be integer number"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioBitrate&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioBitrate))return this.logger.error("zb.sh.ums AudioBitrate param must be integer number"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioChannels&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioChannels,!1))return this.logger.error("zb.sh.ums AudioChannels param must be integer number"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;var m={},_=0;e.outputConfig.singleStreamPassThrough&&"boolean"==typeof e.outputConfig.singleStreamPassThrough&&(_=e.outputConfig.singleStreamPassThrough?1:0),m={task_id:e.taskID,id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:s,bypass:_,timestamp:Math.ceil((new Date).getTime()/1e3)};var v=c;v&&(v.videoCodec&&(m.extra_params=[{key:"video_encode",value:v.videoCodec}]),v.backgroundColor&&(m.output_bg_color=v.backgroundColor),v.backgroundImage&&(m.output_bg_image=v.backgroundImage),v.waterMark&&(m.watermark=v.waterMark),v.userData&&(m.userdata=this.stateCenter.uint8arrayToBase64(v.userData)),v.extraParams&&(!m.extra_params&&(m.extra_params=[]),(l=m.extra_params).push.apply(l,v.extraParams))),m.MixInput=e.inputList.map((function(e,t){var r=e.streamID;return h.stateCenter.testEnvironment&&(r="zegotest-"+h.stateCenter.appid+"-"+e.streamID),{stream_id:r,content_control:"AUDIO"===e.contentType?1:0,rect:{layer:t,top:e.layout.top,left:e.layout.left,bottom:e.layout.bottom,right:e.layout.right},render_mode:e.renderMode}})),this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)&&this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)(u,void 0,{mix_stream_id:o.ZegoRTCLogEvent.kZegoTaskMixStart.mix_stream_id(e.taskID),stream_cnt:o.ZegoRTCLogEvent.kZegoTaskMixStart.stream_cnt(m.MixInput.length),input_stream_list:o.ZegoRTCLogEvent.kZegoTaskMixStart.input_stream_list(m.MixInput)}),m.MixOutput=e.outputList.map((function(t){var n={},i="";if("string"==typeof t)i=t;else{if("object"!=typeof t||!t.target)return h.logger.error("zb.sh.ums output target required"),r({errorCode:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.code,extendedData:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.message}),!1;i=t.target}return i.startsWith("rtmp://")||i.startsWith("https://")&&i.endsWith(".flv")||i.startsWith("https://")&&i.endsWith(".m3u8")?n.mixurl=i:n.stream_id=h.stateCenter.testEnvironment?"zegotest-"+h.stateCenter.appid+"-"+i:i,n.bitrate=1e3*e.outputConfig.outputBitrate,n.fps=e.outputConfig.outputFPS,n.width=e.outputConfig.outputWidth,n.height=e.outputConfig.outputHeight,e.outputConfig.outputAudioCodecID&&(n.audio_enc_id=e.outputConfig.outputAudioCodecID),"vp8"===v.videoCodec?n.audio_enc_id=3:"h264"===v.videoCodec&&(n.audio_enc_id=0),e.outputConfig.outputAudioBitrate&&(n.audio_bitrate=1e3*e.outputConfig.outputAudioBitrate),e.outputConfig.outputAudioChannels&&(n.audio_channel_cnt=e.outputConfig.outputAudioChannels),n.testenv=h.stateCenter.testEnvironment?1:0,n})),this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)&&this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)(u,void 0,{output_target_list:o.ZegoRTCLogEvent.kZegoTaskMixStart.output_target_list(m.MixOutput)}),this.logger.debug("zb.sh.ums send command");var y="zegotest-"+this.stateCenter.appid+"-";if(this.stateCenter.useNetAgent)this.sendBizChannelRequestV2({server:12,location:"/interface/command",cmd:"start_mix"},m,(function(e){var r=e.play.map((function(e){var t={rtmpURL:"",hlsURL:"",flvURL:""},r=e.stream_alias||"";return h.stateCenter.testEnvironment&&r&&r.startsWith(y)&&(r=r.slice(y.length)),t.streamID=r,e.rtmp_url&&e.rtmp_url.length>0&&(t.rtmpURL=e.rtmp_url),e.hls_url&&e.hls_url.length>0&&(t.hlsURL=e.hls_url),e.hdl_url&&e.hdl_url.length>0&&(t.flvURL=e.hdl_url),t}));t&&t({errorCode:0,extendedData:JSON.stringify({mixerOutputList:r})})}),(function(e,t,n,s){var c="";if(s)return s==i.errorCodeList.TIMEOUT&&(s=o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kRequestError),s.code&&20010===s.code&&(s=JSON.parse(JSON.stringify(i.errorCodeList.MIXER_NO_SERVICES))),void(r&&r(s,c));if(s=o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError,200===e){if("number"==typeof t){if(h.logger.debug("zb.sh.ums error: "+t),1000000150==(t+=1e9)&&n){var u=(null==n?void 0:n.non_exist_streams.map((function(e){return h.stateCenter.testEnvironment&&e.startsWith(y)?e.slice(y.length):e})))||[];u.length>0&&(h.logger.debug("zb.sh.ums not exist streams: "+u),c=u.join(","))}return void(r&&r({errorCode:h.stateCenter.getServerError(a+t).code,extendedData:c}))}h.logger.debug("zb.sh.ums error code "+t);var l=o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError;r&&r({errorCode:l.code,extendedData:l.message})}else h.logger.error("zb.sh.ums "+(c="request mix server fail, error: "+e)),r&&r(s,c)}));else{var E={channel:"zeus",cmd:"start_mix",req_body:JSON.stringify(m)};this.sendBizChannelRequest(E,(function(e,n,i){if(h.logger.debug("zb.sh.ums receive message"),0!=i.length){for(var o=JSON.parse(i),s=[],a=0;a<o.play.length;a++){var c={rtmpURL:"",hlsURL:"",flvURL:""},u=o.play[a].stream_alias||"";h.stateCenter.testEnvironment&&u&&u.startsWith(y)&&(u=u.slice(y.length)),c.streamID=u,o.play[a].rtmp_url&&o.play[a].rtmp_url.length>0&&(c.rtmpURL=o.play[a].rtmp_url),o.play[a].hls_url&&o.play[a].hls_url.length>0&&(c.hlsURL=o.play[a].hls_url),o.play[a].hdl_url&&o.play[a].hdl_url.length>0&&(c.flvURL=o.play[a].hdl_url),s.push(c)}t&&t({errorCode:0,extendedData:JSON.stringify({mixerOutputList:s})})}else r&&r({errorCode:h.stateCenter.getServerError(10001).code,extendedData:""})}),(function(e,t,n){if("number"==typeof e){h.logger.debug("zb.sh.ums error: "+e);var s=[];if(1000000150==e&&0!=n.length)for(var c=JSON.parse(n),u=0;u<c.non_exist_streams.length;u++){var l=c.non_exist_streams[u];h.stateCenter.testEnvironment&&l.startsWith(y)?s.push(l.slice(y.length)):s.push(l)}r&&r({errorCode:h.stateCenter.getServerError(a+e).code,extendedData:""})}else{var d;h.logger.debug("zb.sh.ums error code "+e.code),d=e==i.errorCodeList.TIMEOUT?o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kRequestError:o.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError,r&&r({errorCode:d.code,extendedData:d.message})}}))}return!0}}},817:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},INPUT_PARAM:{code:1100001,message:"input param error."},TIMEOUT:{code:1100002,message:"network timeout."},MIXER_NO_SERVICES:{code:1005e3,message:"no mix stream service"},MIXER_TASK_ID_NULL:{code:1005001,message:"mixer task is null"},MIXER_TASK_ID_TOO_LONG:{code:1005002,message:"task ID is too long"},MIXER_TASK_ID_INVALID_CHARACTER:{code:1005003,message:"task ID contains illegal characters"},MIXER_NO_OUTPUT_TARGET:{code:1005005,message:"task configuration does not specify output"},MIXER_OUTPUT_TARGET_INVALID:{code:1005006,message:"stream output target is incorrect"},MIXER_START_REQUEST_ERROR:{code:1005010,message:"start mixer task fail, possibly due to network reasons"},MIXER_STOP_REQUEST_ERROR:{code:1005011,message:"stop mixer task fail, possibly due to network reasons"},MIXER_NOT_OWNER_STOP_MIXER:{code:1005012,message:" maxed task must be stopped by the start user of the task"},MIXER_INPUTLIST_NULL:{code:1005020,message:"Mixed stream task input list is null"},MIXER_OUTPUTLIST_NULL:{code:1005021,message:"Mixed stream task output list is null"},MIXER_VIDEO_CONFIG_INVALID:{code:1005023,message:"invalid mixed stream task video configuration"},MIXER_EXCEED_MAX_INPUT_COUNT:{code:1005025,message:"more than the maximum number of input streams"},MIXER_INPUT_STREAM_NOT_EXISTS:{code:1005026,message:"Input stream does not exist"},MIXER_EXCEED_MAX_OUTPUT_COUNT:{code:1005030,message:"more than the maximum number of output streams"},MIXER_AUTHENTICATION_FAILED:{code:1005050,message:"mixed stream authentication failed"},MIXER_WATERMARK_NULL:{code:1005061,mag:"input watermark is null"},MIXER_WATERMARK_PARAMETERS_ERROR:{code:1005062,message:"input watermark parameter is wrong"},MIXER_WATERMARK_URL_INVALID:{code:1005063,message:"illegal input watermark URL"},MIXER_BACKGROUND_IMAGE_URL_INVALID:{code:1005067,message:"illegal input background image URL"},MIXER_REPEAT_INPUT:{code:1005099,message:"mix stream input repeat"},MIXER_INNER_ERROR:{code:1005099,message:"mixer internal error"}}},577:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5906);t.default={type:"MixStream",install:function(e,t){for(var r in n.zegoWebRTC)Object.defineProperty(e.prototype,r,{value:n.zegoWebRTC[r],writable:!1});for(var r in n.streamHandler)Object.defineProperty(t.prototype,r,{value:n.streamHandler[r],writable:!1})}}},6145:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var n=r(817),i=function(e){return e};t.ZegoRTCLogEvent={kZegoTaskMixStart:{event:"/mix/start_mix",error:{kParamError:n.errorCodeList.INPUT_PARAM,kTaskIDNullError:n.errorCodeList.MIXER_TASK_ID_NULL,kTaskIDToLongError:n.errorCodeList.MIXER_TASK_ID_TOO_LONG,kTaskIDInvalidCharacterError:n.errorCodeList.MIXER_TASK_ID_INVALID_CHARACTER,kInputListNullError:n.errorCodeList.MIXER_INPUTLIST_NULL,kOutputListNullError:n.errorCodeList.MIXER_OUTPUTLIST_NULL,kOutputTargetInvalidError:n.errorCodeList.MIXER_OUTPUT_TARGET_INVALID,kOutputNoTargetError:n.errorCodeList.MIXER_NO_OUTPUT_TARGET,kRequestError:n.errorCodeList.MIXER_START_REQUEST_ERROR,kInternalError:n.errorCodeList.MIXER_INNER_ERROR,kNoLoginError:n.errorCodeList.NOT_LOGIN},mix_stream_id:i,stream_cnt:i,input_stream_list:i,output_target_list:i},kZegoTaskMixStop:{event:"/mix/stop_mix",error:{kParamError:n.errorCodeList.INPUT_PARAM,kTaskIDNullError:n.errorCodeList.MIXER_TASK_ID_NULL,kRequestError:n.errorCodeList.MIXER_STOP_REQUEST_ERROR,kInternalError:n.errorCodeList.MIXER_INNER_ERROR,kNoLoginError:n.errorCodeList.NOT_LOGIN}},kZegoTaskMixConfig:{event:"/mix/config_mix",error:{kParamError:n.errorCodeList.INPUT_PARAM,kVideoConfigInvalidError:n.errorCodeList.MIXER_VIDEO_CONFIG_INVALID,kBackgroundImageUrlInvalidError:n.errorCodeList.MIXER_BACKGROUND_IMAGE_URL_INVALID,kNoLoginError:n.errorCodeList.NOT_LOGIN},config:i}}},2760:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSystemInfo=void 0;var a=s(r(2730)),c=s(r(5947)),u=s(r(1646)),l=s(r(1576)),d=r(7803),h=r(5130);function p(){var e;return i(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(i){switch(i.label){case 0:return(t=null===navigator||void 0===navigator?void 0:navigator.userAgentData)?[4,t.getHighEntropyValues(["platformVersion"]).catch((function(){}))]:[2,{platform:"",majorPlatformVersion:0}];case 1:return r=i.sent()||{},n=parseInt(null===(e=r.platformVersion)||void 0===e?void 0:e.split(".")[0]),[2,{platform:r.platform,majorPlatformVersion:n}]}}))}))}t.getSystemInfo=p;var f="zc.ra.0",g=function(){function e(e,t){var r=this;this.logger=t,this.isSpatial=!1,this.audioSourceList=[],this.audioSourceUpdate=!1,this.localUserList=[],this.speakingUserIdList=[],this.volume=1,this.speaker="",this._audioCtx=null,this.supportSpeakerSet=!1,this.isHide=!1,this.eventHandler={visibilitychange:function(){return i(r,void 0,void 0,(function(){var e,t,r,n,i,s,a,c=this;return o(this,(function(o){switch(o.label){case 0:return this.audioSourceList.forEach((function(e){e.inBackground(document.hidden),c.isHide=document.hidden})),e=function(){c.audioSourceList.forEach((function(e){e.enableSpatializer(c.isSpatial,!0,!1,!1)}))},document.hidden?(t=navigator.userAgent.toLowerCase(),r=t.match(/chrome\/(\d*)/),n=r&&t.includes("mobile"),[4,p()]):[3,2];case 1:if(i=o.sent(),s="Windows"===i.platform&&i.majorPlatformVersion>=13,n||s)return this.logger.info("".concat(f," mobile chrome hide page and stop web audio.")),e(),[2];"running"!==(a=this.audioCtx.state)?(this.logger.info("".concat(f," hidden ctx: ").concat(a,", resume ctx")),this.audioCtx.resume(),setTimeout((function(){var t=c.audioCtx.state;c.isHide&&("running"===t?c.logger.info("".concat(f," hidden ctx: ").concat(t,".")):(c.logger.warn("".concat(f," hidden ctx: ").concat(t,", ctx resume failed. stop web audio.")),e()))}),2e3)):this.logger.info("".concat(f," hidden ctx: ").concat(a,".")),o.label=2;case 2:return[2]}}))}))}},this.zegoRTC=e,document.addEventListener("visibilitychange",this.eventHandler.visibilitychange,!1),this.zegoRTC.on("roomStreamUpdate",(function(e,t,i){var o=i.map((function(e){var t=r.getStreamInfo(e.extraInfo,e.streamID),i=t.isRangeAudioStream,o=t.teamID,s=t.sendMode;return n(n({},e),{isRangeAudioStream:i,teamID:o,sendMode:s})})).filter((function(e){return e.isRangeAudioStream})),s=o.map((function(e){return e.user.userID}));"DELETE"===t?r.speakingUserIdList=r.speakingUserIdList.filter((function(e){var t=!s.includes(e);if(!t){var n=r.audioSourceMap[e];n&&n.stopPlayingAudio("stop for stream delete")}return t})):"ADD"===t&&(r.speakingUserIdList=r.speakingUserIdList.concat(s),o.forEach((function(e){var t=e.user.userID,n=r.audioSourceMap[t],i=e.teamID,o=e.sendMode,s=!(!["",void 0].includes(i)&&r.rangeListener.teamID===i)&&r.isSpatial;if(n)n.streamID!==e.streamID&&(n.stopPlayingAudio("stop for old stream"),n.streamID=e.streamID),void 0!==o&&(n.sendMode=o),i!==n.teamID&&(n.teamID=i),n.enableSpatializer(s);else{var c=new a.default(r.logger,{userID:t,teamID:i,sendMode:o},{audioCtx:r.audioCtx,zegoRTC:r.zegoRTC,isSpatial:s,maxDistance:r.rangeListener.recvRange,volume:r.volume,speaker:r.speaker,isHide:r.isHide});c.streamID=e.streamID,r.audioSourceList.push(c),r.playStreamHandler.hasChanged=!0}}))),r.playStreamHandler.setAudioSourceList(r.speakingAudioSourceList)})),this.zegoRTC.on("playerStateUpdate",(function(e){var t=r.audioSourceList.find((function(t){return t.streamID===e.streamID}));t&&("NO_PLAY"===e.state?t.isPlaying=!1:("PLAYING"===e.state&&t.checkTrackChanged(),t.isPlaying=!0))})),this.zegoRTC.on("streamExtraInfoUpdate",(function(e,t){r.logger.info("zc.ra.0 recv extra info: "+JSON.stringify(t)),t.forEach((function(e){var t=r.audioSourceMap[e.user.userID];if(t&&t.streamID){var n=r.getStreamInfo(e.extraInfo,e.streamID),i=n.teamID,o=n.sendMode;i!==t.teamID&&(t.teamID=i,r.enableSpatializer(r.isSpatial)),void 0!==o&&(t.sendMode=o),r.playStreamHandler.hasChanged=!0}}))})),this.zegoRTC.RTM._on("_roomStateUpdate",(function(e,t){"CONNECTED"===t?(r.roomID=e,r.rangeListener.userID=r.zegoRTC.RTM.getUserID(),r.playStreamHandler.hasChanged=!0):"DISCONNECTED"===t&&(r.roomID=void 0,r.rangeListener.reset(),r.enableSpeaker(!1),r.audioSourceList=[],r.playStreamHandler.setAudioSourceList([]),r.localUserList=[],r.playStreamHandler.setLocalUserList([]))})),this.zegoRTC.RTM.on("roomUserUpdate",(function(e,t,n){var i;r.logger.info("zc.ra.0 roomUserUpdate: ",e,t,JSON.stringify(n)),"ADD"===t?(i=r.localUserList).push.apply(i,n):"DELETE"===t&&n.forEach((function(e){r.localUserList=r.localUserList.filter((function(t){return t.userID!==e.userID}))})),r.playStreamHandler.setLocalUserList(r.localUserList)})),this.zegoRTC.on("publishQualityUpdate",(function(e,t){var i=e.match(/(.*)_(.*)/);if(3===(null==i?void 0:i.length)){var o=i[1];if(r.rangeListener.userID!==o)return;var s=n({},t.audio);r.eventManager.emit("publishQualityUpdate",o,s)}})),this.zegoRTC.on("playQualityUpdate",(function(e,t){var i,o=e.match(/(.*)_(.*)/);if(3===(null==o?void 0:o.length)){var s=o[1],a=t.audio,c=t.peerToPeerDelay,u=t.peerToPeerPacketLostRate;if(!(null===(i=r.audioSourceList)||void 0===i?void 0:i.some((function(e){return e.userID===s}))))return;var l=n(n({},a),{peerToPeerDelay:c,peerToPeerPacketLostRate:u});r.eventManager.emit("playQualityUpdate",s,l)}}));var s=window.AudioContext||window.webkitAudioContext;this._audioCtx=this.zegoRTC&&this.zegoRTC.ac||new s,this.rangeListener=c.default.getInstance(this.audioCtx,this.zegoRTC),this.playStreamHandler=u.default.getInstance(this.logger,this.rangeListener),this.eventManager=l.default.getInstance()}return Object.defineProperty(e.prototype,"audioSourceMap",{get:function(){return this.audioSourceList.reduce((function(e,t){return t.userID&&(e[t.userID]=t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speakingAudioSourceList",{get:function(){var e=this;return this.audioSourceList.filter((function(t){return e.speakingUserIdList.includes(t.userID)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playingAudioSourceList",{get:function(){return this.audioSourceList.filter((function(e){return e.isPlaying}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audioCtx",{get:function(){if(!this._audioCtx){var e=window.AudioContext||window.webkitAudioContext;this._audioCtx=new e}return this._audioCtx},enumerable:!1,configurable:!0}),e.getInstance=function(t,r){return e.instance||(e.instance=new e(t,r)),e.instance},e.prototype.resumeAudioContext=function(){return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t){h.AudioElPool.generateEls(),"running"===e.audioCtx.state&&t(!0),e.audioCtx.onstatechange=function(){"running"===e.audioCtx.state&&t(!0)},e.audioCtx.resume(),e.logger.info("zc.ra.0 resume audio ctx"),setTimeout((function(){t(!1)}),3e3)}))]}))}))},e.prototype.getAudioContextState=function(){return this.audioCtx.state},e.prototype.getStreamInfo=function(e,t){var r,n=null;try{n=JSON.parse(e)}catch(e){return this.logger.warn(f+" parse room extra info failed. ".concat(t," is not ra stream.")),{isRangeAudioStream:!1}}if(!n.hasOwnProperty("range_audio_team_id")||!n.hasOwnProperty("range_audio_mode"))return this.logger.warn(f+" extra info has no mode. ".concat(t," is not ra stream.")),{isRangeAudioStream:!1};r={1:0,2:1,3:2}[n.range_audio_mode];var i=n.r_a_s_flag,o={teamID:n.range_audio_team_id||void 0,sendMode:r,isRangeAudioStream:void 0===i||1===i};return this.logger.info("".concat(f," ").concat(t," parse extra info: ").concat(JSON.stringify(o),".")),o},e.prototype.setAudioReceiveRange=function(e){if(!(0,d.checkNumber)(e))throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' requires to be type number.");if((e=Number(e))<0)throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' can not be less than 0.");this.logger.info("zc.ra.0 set receive range: "+e),this.rangeListener.recvRange=e,this.audioSourceList.forEach((function(t){t.setMaxDistance(e)})),this.playStreamHandler.hasChanged=!0},e.prototype.updateSelfPosition=function(e,t,r,n){var i=function(e){return"Failed to execute 'updateSelfPosition': Argument '".concat(e,"' requires an array of type number.\"")};if(!(0,d.checkCoordinate)(e))throw new Error(i("position"));if(!(0,d.checkCoordinate)(t))throw new Error(i("axisForward"));if(!(0,d.checkCoordinate)(r))throw new Error(i("axisRight"));if(!(0,d.checkCoordinate)(n))throw new Error(i("axisUp"));this.logger.info(f+" set self position [".concat(e,"]")),this.rangeListener&&this.rangeListener.updateSelfPosition(e,t,n),this.playStreamHandler.setListener(this.rangeListener)},e.prototype.updateAudioSource=function(e,t){if(e=String(e),!(0,d.checkCoordinate)(t))throw new Error("Failed to execute 'updateAudioSource': Arguments 'position' must be an array of type number.");this.logger.info(f+" set source ".concat(e," position [").concat(t,"]"));var r=this.audioSourceMap[e];r?r.setPosition(t):(r=new a.default(this.logger,{userID:e,position:t},{audioCtx:this.audioCtx,zegoRTC:this.zegoRTC,isSpatial:this.isSpatial,maxDistance:this.rangeListener.recvRange,volume:this.volume,speaker:this.speaker,isHide:this.isHide}),this.enableSpatializer(this.isSpatial),this.audioSourceList.push(r)),this.playStreamHandler.setAllAudioSourceList(this.audioSourceList)},e.prototype.enableMicrophone=function(e){if(void 0===e&&(e=!0),!this.rangeListener.userID)throw new Error("Enable mic failed. Please log in room first.");return e?this.rangeListener.startPublishingStream():this.rangeListener.stopPublishingStream()},e.prototype.selectMic=function(e){return i(this,void 0,void 0,(function(){var t,r,n,i;return o(this,(function(o){switch(o.label){case 0:if("string"!=typeof e&&void 0!==e)throw new Error("Select mic failed. DeviceID error.");if(r=(t=this.rangeListener).audioStream,n=t.isPublishing,this.logger.info("zc.ra.0 select mic: "+e),!r||!n)return[3,5];i={errorCode:0},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.zegoRTC.useAudioDevice(r,e||"")];case 2:return i=o.sent(),[3,4];case 3:return o.sent(),[2,!1];case 4:return 0===i.errorCode?(this.rangeListener.micID=e,[2,!0]):[2,!1];case 5:return this.rangeListener.micID=e,[2,!0];case 6:return[2]}}))}))},e.prototype.enableSpeaker=function(e){if(void 0===e&&(e=!0),e&&!this.roomID)throw new Error("Enable speaker failed. Please log in room first.");this.playStreamHandler.isEnable=e,this.logger.info("zc.ra.0 enable speaker: "+e),e?(h.AudioElPool.generateEls(),this.playStreamHandler.startPlayingAudioStream()):this.playStreamHandler.stopPlayingAudioStream()},e.prototype.enableSpatializer=function(e){var t=this;void 0===e&&(e=!0),this.logger.info("zc.ra.0 set spatializer: "+e),this.isSpatial=!!e,this.audioSourceList.forEach((function(r){var n=!(!["",void 0].includes(r.teamID)&&t.rangeListener.teamID===r.teamID)&&e;r.enableSpatializer(n)})),e&&this.rangeListener.updateListenerEffect()},e.prototype.setRangeAudioTeamID=function(e){this.logger.info("zc.ra.0 set team id: "+e),this.rangeListener.setTeamID(e),this.enableSpatializer(this.isSpatial),this.playStreamHandler.hasChanged=!0},e.prototype.setRangeAudioMode=function(e){this.logger.info("zc.ra.0 set mode "+e),this.rangeListener.setSendMode(e),this.rangeListener.setRecvMode(e),this.playStreamHandler.hasChanged=!0},e.prototype.setAudioVolume=function(e){var t=this;if(this.logger.info(f+" set volume ".concat(e)),e<0)throw new Error("Failed to execute 'setVolume': The volume provided is outside the range [0, 200].");this.volume=e/100,this.audioSourceList.forEach((function(e){e.setVolume(t.volume)}))},e.prototype.selectSpeaker=function(e){var t=this;if(void 0===e&&(e=""),"string"!=typeof e)throw new Error("Select speaker failed. Device ID error.");if(!this.supportSpeakerSet){if(!document.createElement("audio").setSinkId)throw new Error("Failed to execute 'selectSpeaker': browser not support.");this.supportSpeakerSet=!0}this.speaker=e,this.logger.info("zc.ra.0 set speaker: "+e),""===e&&this.logger.warn("zc.ra.0 set speaker to be default. "),this.audioSourceList.find((function(r){return i(t,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,r.setSpeaker(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),this.logger.warn(f+" set speaker failed. id: ".concat(e,", error: ").concat(t)),[2,!0];case 3:return[2,!1]}}))}))}))},e.prototype.setPositionUpdateFrequency=function(e){if(!(e>=15))throw new Error("Failed to execute 'setPositionUpdateFrequency': The frequency provided is outside the range [15, +].");this.playStreamHandler.interval=Number(e)||100,this.logger.info("zc.ra.0 set interval: "+e)},e.prototype.on=function(e,t){return this.eventManager.addEventHandler(e,t)},e.prototype.off=function(e,t){return this.eventManager.removeEventHandler(e,t)},e.prototype.enableAudioSourceUpdateChecker=function(e){this.logger.info("zc.ra.0 set source update: "+e),this.audioSourceUpdate=e,this.playStreamHandler.setAudioSourceUpdate(e)},e}();t.default=g},2777:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeAudio=void 0;var n=r(3116);t.RangeAudio={type:"RangeAudio",install:function(e){Object.defineProperty(e.prototype,"createRangeAudioInstance",{value:function(){return this.rangeAudio||(this.rangeAudio=n.ZegoExpressRangeAudio.getInstance(this,this.logger)),this.rangeAudio},writable:!1})}}},5130:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioElPool=void 0;var r=function(){function e(){}return e.generateEls=function(e){if(void 0===e&&(e=30),this.elements.length>=e)this.elements.forEach((function(e){e.dom.play().catch((function(e){}))}));else{var t=Array(e-this.elements.length).fill(0).map((function(e,t){var r=document.createElement("audio");return r.muted=!0,r.setAttribute("autoplay","autoplay"),r.setAttribute("playsInline","playsInline"),r.id="audio"+t,{dom:r,id:t,used:!1}}));this.elements=this.elements.concat(t)}},e.useAudioEl=function(){0===this.elements.length&&this.generateEls();var e=this.elements.find((function(e){return!e.used}));return e&&(e.used=!0),e},e.stopUsingAudioEl=function(e){var t=this.elements[e];t&&(t.dom.muted=!0,t.used=!1)},e.elements=[],e}();t.AudioElPool=r},2730:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RANGE_AUDIO=void 0;var s=r(1297),a=r(5130);t.RANGE_AUDIO="zc.ra.1";var c=o(r(8047)),u=r(2760),l=function(){function e(e,t,r){this.logger=e,this.streamID=null,this.panner=null,this.gainNode=null,this.volume=1,this.isSpatial=!1,this.autoPlay=!0,this.loopbackConn=null,this.speaker="",this.position=null,this.stream=null,this.sourceNode=null,this.isPlaying=!1,this.distance=null,this.audioTrack=null,this.audioEl=null,this.playOnAudioContext=!1,this.useWebAudio=!0,this.isHide=!1,this.audioCtx=r.audioCtx,this.zegoRTC=r.zegoRTC,this.isSpatial=r.isSpatial,this.maxDistance=r.maxDistance||1e5,this.setVolume(r.volume),this.setSpeaker(r.speaker).catch((function(e){})),this.inBackground(r.isHide),this.userID=t.userID,this.teamID=t.teamID,this.sendMode=void 0!==t.sendMode?t.sendMode:s.ZegoRangeAudioMode.World,t.position&&(this.position=t.position),this.destNode=this.audioCtx.createMediaStreamDestination()}return e.prototype.createPanner=function(){var e=this.position||[0,0,0],t=this.maxDistance,r=this.audioCtx.createPanner(),n=this.audioCtx.createGain();return r.panningModel="HRTF",r.distanceModel="linear",r.refDistance=1,r.maxDistance=2.6*t,r.rolloffFactor=1,r.coneOuterGain=.4,void 0!==r.positionX?(r.positionX.value=e[1],r.positionY.value=e[2],r.positionZ.value=-e[0]):r.setPosition(e[1],e[2],-e[0]),{panner:r,gainNode:n}},e.prototype.setVolume=function(e){isNaN(e)||(this.volume=e,this.gainNode&&(this.gainNode.gain.value=this.volume))},e.prototype.setSpeaker=function(e){var r;return n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:if("string"!=typeof e)return[2];if(this.speaker=e,!this.audioEl)return[3,10];if(!(n=null===(r=this.audioEl)||void 0===r?void 0:r.setSinkId))return[3,8];i.label=1;case 1:return i.trys.push([1,6,,7]),this.playOnAudioContext?[3,3]:[4,n.call(this.audioEl,e||"")];case 2:return i.sent(),[3,5];case 3:return[4,n.call(this.audioEl,"")];case 4:i.sent(),i.label=5;case 5:return this.logger.info(t.RANGE_AUDIO+" ".concat(this.userID," set speaker success. id: ").concat(e,".")),[3,7];case 6:throw o=i.sent(),this.logger.error(t.RANGE_AUDIO+" ".concat(this.userID," set speaker failed. id: ").concat(e,"  error: ").concat(o,".")),o;case 7:return[3,9];case 8:throw"setting speaker not support.";case 9:return[3,11];case 10:this.logger.info(t.RANGE_AUDIO+" ".concat(this.userID," no element.")),i.label=11;case 11:return[2]}}))}))},e.prototype.checkTrackChanged=function(){var e;if(this.stream){var r=this.stream.getAudioTracks()[0];r&&r!==this.audioTrack&&(this.logger.info(t.RANGE_AUDIO+" retry play success, render stream."),null===(e=this.sourceNode)||void 0===e||e.disconnect(),this.sourceNode=this.audioCtx.createMediaStreamSource(this.stream),this.enableSpatializer(this.isSpatial,!0),this.audioTrack=r)}},e.prototype.startPlayingAudio=function(e){var r,o;return n(this,void 0,void 0,(function(){var n,s,c,u,l;return i(this,(function(i){switch(i.label){case 0:if(!this.streamID)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),e&&this.logger.info(t.RANGE_AUDIO+" ".concat(this.streamID," ")+e),this.isPlaying=!0,n=this,[4,this.zegoRTC.startPlayingStream(this.streamID)];case 2:return n.stream=i.sent(),this.audioTrack=this.stream.getAudioTracks()[0],[3,4];case 3:if(1103049===(s=i.sent()).code)return[2];throw s;case 4:return this.audioEl=a.AudioElPool.useAudioEl()||null,this.logger.info(t.RANGE_AUDIO+" ".concat(this.streamID," start using audio el ").concat(null===(r=this.audioEl)||void 0===r?void 0:r.id)),(c=null===(o=this.audioEl)||void 0===o?void 0:o.dom)||(this.logger.error(t.RANGE_AUDIO+" not enough audio elements"),c=document.createElement("audio"),this.audioEl={id:-1,dom:c,used:!0},c.setAttribute("autoplay","autoplay")),c.muted=!0,this.stream&&(this.sourceNode=this.audioCtx.createMediaStreamSource(this.stream)),this.panner||(u=this.createPanner(),l=u.gainNode,this.panner=u.panner,this.gainNode=l,l.gain.value=this.volume),this.sourceNode?[4,this.enableSpatializer(this.isSpatial,!0)]:[3,6];case 5:i.sent(),i.label=6;case 6:return"suspended"===this.audioCtx.state&&this.audioCtx.resume(),[2]}}))}))},e.prototype.stopPlayingAudio=function(e){this.isPlaying&&this.streamID?(this.logger.info(t.RANGE_AUDIO+" ".concat(this.streamID," ")+e),this.zegoRTC.stopPlayingStream(this.streamID),this.isPlaying=!1):this.streamID&&this.logger.info(t.RANGE_AUDIO+" ".concat(this.streamID," not playing, ")+e),this.stream=null,this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null);var r=this.audioEl,n=null==r?void 0:r.dom;n&&(n.srcObject=null,n.parentNode&&n.parentNode.removeChild(n));var i=(null==r?void 0:r.id)||-1;r&&i>=0&&(a.AudioElPool.stopUsingAudioEl(i),this.logger.info(t.RANGE_AUDIO+" ".concat(this.streamID," stop using audio el ").concat(i))),this.audioEl=null,this.loopbackConn&&(this.loopbackConn.close(),this.loopbackConn.onError=null)},e.prototype.setPosition=function(e){this.position=e,this.panner&&(void 0!==this.panner.positionX?(this.panner.positionX.value=e[1],this.panner.positionY.value=e[2],this.panner.positionZ.value=-e[0]):this.panner.setPosition(e[1],e[2],-e[0]))},e.prototype.setMaxDistance=function(e){this.maxDistance=e,this.panner&&(e<10&&(e=10),this.panner.maxDistance=2.6*e)},e.prototype.getDistanceFromListener=function(e){var t=this.position,r=e.position;if(!r||!t)return null;var n=[t[0]-r[0],t[1]-r[1],t[2]-r[2]];return this.distance=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)),this.distance},e.prototype.enableSpatializer=function(e,r,o,s){var a,l,d,h,p;return void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=!0),n(this,void 0,void 0,(function(){var n,f,g,m,_,v,y,E,S,b,T,C,R,O=this;return i(this,(function(i){switch(i.label){case 0:return r||this.isSpatial!==e?(this.isSpatial=e,n=navigator.userAgent.toLowerCase(),f=n.match(/chrome\/(\d*)/),g=f&&n.includes("mobile"),[4,(0,u.getSystemInfo)()]):[2];case 1:return m=i.sent(),_="Windows"===m.platform&&m.majorPlatformVersion>=13,v=this.isHide&&(_||g),y="running"!==this.audioCtx.state,s&&(v||y)&&(this.logger.warn("".concat(t.RANGE_AUDIO," ").concat(this.streamID," stop web audio. system: ").concat(m.platform," ").concat(m.majorPlatformVersion)),s=!1),E=n.includes("safari")&&!n.includes("chrome"),S=n.includes("micromessenger")&&new RegExp(/(iphone|ipad|ipod|ios)/i).test(n),this.playOnAudioContext=o,this.sourceNode?(this.sourceNode.disconnect(),null===(a=this.panner)||void 0===a||a.disconnect(),null===(l=this.gainNode)||void 0===l||l.disconnect(),this.gainNode?(b=this.sourceNode.connect(this.gainNode),this.panner&&e&&(b=b.connect(this.panner)),b.connect(o?this.audioCtx.destination:this.destNode),this.position&&this.setPosition(this.position),this.logger.info(t.RANGE_AUDIO+" play ".concat(e?"3d":"normal"," stream '").concat(this.streamID,"' on ").concat(o?"audio ctx":"element")),(T=null===(d=this.audioEl)||void 0===d?void 0:d.dom)?o?(T.srcObject!==this.stream&&(T.srcObject=this.stream,T.muted=!0,T.oncanplay=function(){T.play().then((function(){O.logger.info(t.RANGE_AUDIO+" ".concat(O.streamID," ctx autoplay success.")),O.checkPlayStatus()})).catch((function(e){O.logger.warn(t.RANGE_AUDIO+" ".concat(O.streamID," ctx autoplay failed."))}))}),[3,6]):[3,2]:[3,6]):[3,6]):[3,6];case 2:return C=this.destNode.stream,R=!S&&!E,this.useWebAudio=s,this.loopbackConn&&(this.loopbackConn.close(),this.loopbackConn.onError=null),s||!this.stream?[3,3]:(this.logger.info("".concat(t.RANGE_AUDIO," ").concat(this.streamID," stop audio api")),this.sourceNode.disconnect(),null===(h=this.panner)||void 0===h||h.disconnect(),null===(p=this.gainNode)||void 0===p||p.disconnect(),C=this.stream,[3,5]);case 3:return R&&C?(this.loopbackConn=this.loopbackConn||new c.default(this.streamID||"",this.logger),this.loopbackConn.onError=function(e){O.logger.warn(t.RANGE_AUDIO+" ".concat(O.streamID," loopback failed! ").concat(e)),O.enableSpatializer(O.isSpatial,!0,!0)},[4,this.loopbackConn.bindStream(C,this.streamID||void 0)]):[3,5];case 4:C=i.sent(),i.label=5;case 5:T.muted=!0,T.srcObject=C,this.setSpeaker(this.speaker).catch((function(e){})),T.oncanplay=function(){if(T){T.muted=!1;var e=function(e){O.logger.error(t.RANGE_AUDIO+" ".concat(O.streamID,"' autoplay failed. error: ").concat(e)),O.enableSpatializer(O.isSpatial,!0,!0)};T.play().then((function(){(null==T?void 0:T.paused)?e("audio paused"):(O.logger.info(t.RANGE_AUDIO+" ".concat(O.streamID," element autoplay success.")),O.checkPlayStatus())})).catch((function(t){e(t)}))}},i.label=6;case 6:return[2]}}))}))},e.prototype.inBackground=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.isHide!==e&&(this.isHide=e,e||this.useWebAudio||this.enableSpatializer(this.isSpatial,!0))},e.prototype.checkPlayStatus=function(){var e=this;setTimeout((function(){var r;if(e.isPlaying){var n=null===(r=e.audioEl)||void 0===r?void 0:r.dom,i=e.audioCtx.state;!n||n.paused||n.muted&&!e.playOnAudioContext||"running"!==i?(e.logger.warn("".concat(t.RANGE_AUDIO," ").concat(e.streamID," play detection is abnormal. audio ctx:").concat(i,", paused:").concat(null==n?void 0:n.paused,", muted:").concat(null==n?void 0:n.muted)),"running"!==i&&(e.audioCtx.resume(),setTimeout((function(){e.logger.warn("".concat(t.RANGE_AUDIO," ").concat(e.streamID," play resume. audio ctx:").concat(i,", paused:").concat(null==n?void 0:n.paused,", muted:").concat(null==n?void 0:n.muted))}),1e3))):e.logger.info("".concat(t.RANGE_AUDIO," ").concat(e.streamID," play detection is fine"))}}),2e3)},e}();t.default=l},1576:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.handlerListMap={microphoneStateUpdate:[],audioSourceWithinRangeUpdate:[],publishQualityUpdate:[],playQualityUpdate:[]}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addEventHandler=function(e,t){if(!this.handlerListMap[e])return!1;if("function"!=typeof t)throw new Error("Params callBack is not a Function");return-1==this.handlerListMap[e].indexOf(t)&&this.handlerListMap[e].push(t),!0},e.prototype.removeEventHandler=function(e,t){return!!this.handlerListMap[e]&&(this.handlerListMap[e]=t?this.handlerListMap[e].filter((function(e){return e!==t})):[],!0)},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.handlerListMap[e]&&this.handlerListMap[e].forEach((function(r){try{setTimeout((function(){r.apply(void 0,t)}),0)}catch(t){console.error('Fail to execute callback of event "'.concat(e,'" : ').concat(t))}}))},e}();t.default=r},8047:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.RANGE_AUDIO=void 0,t.RANGE_AUDIO="zc.ra.3";var i=function(){function e(e,t){this.streamID=e,this.logger=t,this.rtcConn=null,this.loopbackConn=null,this.destStream=new MediaStream,this.onError=null}return e.prototype.bindStream=function(e,i){var o,s;return r(this,void 0,void 0,(function(){var r,a,c,u,l,d,h=this;return n(this,(function(n){switch(n.label){case 0:return i&&(this.streamID=i),r=["completed","connected"],this.rtcConn&&this.loopbackConn&&r.includes(this.rtcConn.connectionState)?(a=null===(o=this.rtcConn)||void 0===o?void 0:o.getSenders().find((function(e){var t;return"audio"===(null===(t=e.track)||void 0===t?void 0:t.kind)})),e.getTracks().forEach((function(e){"audio"===e.kind&&(null==a||a.replaceTrack(e))})),[3,10]):[3,1];case 1:this.rtcConn=new RTCPeerConnection,this.loopbackConn=new RTCPeerConnection,c={offerVideo:!0,offerAudio:!0,offerToReceiveAudio:!1,offerToReceiveVideo:!1},this.rtcConn.onicecandidateerror=function(e){h.logger.warn(t.RANGE_AUDIO+" ".concat(h.streamID," loopback in ice error: ").concat(JSON.stringify(e)))},this.loopbackConn.onicecandidateerror=function(e){h.logger.warn(t.RANGE_AUDIO+" ".concat(h.streamID," loopback out ice error: ").concat(JSON.stringify(e)))},this.rtcConn.onicecandidate=function(e){var r,n=e.candidate;n&&(h.logger.info(t.RANGE_AUDIO+" ".concat(h.streamID," loopback add out candidate: ").concat(n)),null===(r=h.loopbackConn)||void 0===r||r.addIceCandidate(new RTCIceCandidate(n)))},this.loopbackConn.onicecandidate=function(e){var r,n=e.candidate;n&&(h.logger.info(t.RANGE_AUDIO+" ".concat(h.streamID," loopback add in candidate: ").concat(n)),null===(r=h.rtcConn)||void 0===r||r.addIceCandidate(new RTCIceCandidate(n)))},window.setTimeout((function(){h.rtcConn&&h.loopbackConn&&(r.includes(h.rtcConn.iceConnectionState)&&r.includes(h.loopbackConn.iceConnectionState)?h.logger.info(t.RANGE_AUDIO+" ".concat(h.streamID," loopback connect ok.")):(h.logger.warn(t.RANGE_AUDIO+" ".concat(h.streamID," loopback connect failed. in state: ").concat(h.rtcConn.iceConnectionState,", out state: ").concat(h.loopbackConn.iceConnectionState)),h.close(),h.onError&&h.onError("time out")))}),2e3),this.loopbackConn.ontrack=function(e){var r=e.track;h.logger.info(t.RANGE_AUDIO+" ".concat(h.streamID," loopback receive track")),h.replaceTrack(r)},e.getTracks().find((function(t){var r;if("audio"===t.kind)return null===(r=h.rtcConn)||void 0===r||r.addTrack(t,e),!0})),n.label=2;case 2:return n.trys.push([2,9,,10]),[4,this.rtcConn.createOffer(c)];case 3:return u=n.sent(),[4,this.rtcConn.setLocalDescription(u)];case 4:return n.sent(),[4,this.loopbackConn.setRemoteDescription(u)];case 5:return n.sent(),[4,this.loopbackConn.createAnswer()];case 6:return(l=n.sent()).sdp=null===(s=l.sdp)||void 0===s?void 0:s.replace(/useinbandfec=/,"stereo=1;useinbandfec="),[4,this.loopbackConn.setLocalDescription(l)];case 7:return n.sent(),[4,this.rtcConn.setRemoteDescription(l)];case 8:return n.sent(),this.logger.info(t.RANGE_AUDIO+" ".concat(this.streamID," loopback set sdp completed.")),[3,10];case 9:return d=n.sent(),this.logger.error(t.RANGE_AUDIO+" ".concat(this.streamID," loopback connect failed.").concat(d)),this.close(),this.onError&&this.onError("connect failed"),this.onError=null,[3,10];case 10:return[2,this.destStream]}}))}))},e.prototype.replaceTrack=function(e){var t=this;"audio"===e.kind&&(this.destStream.getTracks().forEach((function(e){t.destStream.removeTrack(e)})),this.destStream.addTrack(e))},e.prototype.close=function(){var e=this,t=this.rtcConn,r=this.loopbackConn;this.destStream.getTracks().forEach((function(t){e.destStream.removeTrack(t)})),null==t||t.close(),null==r||r.close(),this.rtcConn=null,this.loopbackConn=null},e}();t.default=i},1646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RANGE_AUDIO=void 0;var n=r(1297);t.RANGE_AUDIO="zc.ra.2";var i=function(){function e(e,t){this.logger=e,this.isEnable=!1,this.interval=100,this.timer=null,this.audioSourceList=[],this.hasChanged=!1,this.audioSourceUpdate=!1,this.maxPlayingQuantity=20,this.allAudioSourceList=[],this.audioSourceWithinRangeList=[],this.localUserList=[],this.rangeListener=t}return e.getInstance=function(t,r){return e.instance||(e.instance=new e(t,r)),e.instance},e.prototype.setAudioSourceUpdate=function(e){this.audioSourceUpdate=e},e.prototype.setListener=function(e){this.rangeListener=e,this.hasChanged=!0},e.prototype.setAudioSourceList=function(e){this.audioSourceList=e,this.logger.info("".concat(t.RANGE_AUDIO," set src list: [").concat(e.map((function(e){return e.userID})).join(","),"]")),this.hasChanged=!0},e.prototype.setAllAudioSourceList=function(e){e&&(this.allAudioSourceList=e),this.hasChanged=!0},e.prototype.startPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.hasChanged=!0,this.playAudioTask()},e.prototype.playAudioTask=function(){var e=this;this.hasChanged&&(this.hasChanged=!1,this.handlePlayAudioTask()),this.timer=window.setTimeout((function(){e.playAudioTask()}),this.interval)},e.prototype.handlePlayAudioTask=function(){var e=this;if(this.isEnable){this.logger.info("".concat(t.RANGE_AUDIO," handler task start"));var r=[],i=this.getTeamAudioSourceGroup(),o=i.otherList,s=0;i.teamList.forEach((function(t){s<e.maxPlayingQuantity&&(t.isPlaying||t.startPlayingAudio("play for team"),s++)}));var a=this.rangeListener.recvMode===n.ZegoRangeAudioMode.World;a&&(o.forEach((function(t){t.distance=t.getDistanceFromListener(e.rangeListener)})),o.sort((function(e,t){return null===e.distance?1:null===t.distance||e.distance<t.distance?-1:e.distance>t.distance?1:0}))),o.forEach((function(t){if(a&&s<e.maxPlayingQuantity&&t.sendMode===n.ZegoRangeAudioMode.World&&null!==t.distance&&(null===e.rangeListener.recvRange||t.distance<=e.rangeListener.recvRange))t.isPlaying||t.startPlayingAudio("play for range"),s++;else{var r="stop for mode or range. mode: ".concat(t.sendMode,", range: ").concat(t.distance," > ").concat(e.rangeListener.recvRange);t.stopPlayingAudio(r)}})),this.logger.info(t.RANGE_AUDIO+" playing quantity: ".concat(s,".")),this.audioSourceUpdate&&(this.allAudioSourceList.forEach((function(t){t.distance=t.getDistanceFromListener(e.rangeListener);var n=null!==t.distance&&(null===e.rangeListener.recvRange||t.distance<=e.rangeListener.recvRange),i=!!e.localUserList.find((function(e){return e.userID===t.userID}));n&&i&&r.push({userID:t.userID,position:t.position})})),this.checkAudioSourceListDiff(r,this.audioSourceWithinRangeList)&&this.rangeListener.eventHandler.emit("audioSourceWithinRangeUpdate",r),this.audioSourceWithinRangeList=r)}else this.stopPlayingAudioStream()},e.prototype.getTeamAudioSourceGroup=function(){var e=this,t=[],r=[];return this.audioSourceList.forEach((function(n){[n.teamID,e.rangeListener.teamID].includes(void 0)||""===n.teamID||n.teamID!==e.rangeListener.teamID?r.push(n):t.push(n)})),{teamList:t,otherList:r}},e.prototype.stopPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.audioSourceList.forEach((function(e){e.stopPlayingAudio("stop for all stream")}))},e.prototype.setLocalUserList=function(e){this.localUserList=e,this.hasChanged=!0},e.prototype.checkAudioSourceListDiff=function(e,t){for(var r,n=0;n<e.length;n++){r=!1;for(var i=0;i<t.length;i++)if(e[n].userID===t[i].userID){r=!0;break}if(!r)return!0}for(var o=0;o<t.length;o++){r=!1;for(var s=0;s<e.length;s++)if(t[o].userID===e[s].userID){r=!0;break}if(!r)return!0}return!1},e}();t.default=i},5947:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(1297),o=r(2730),s=n(r(1576));function a(e){return{0:1,1:2,2:3}[e]}var c=function(){function e(e,t){var r=this;this.recvMode=i.ZegoRangeAudioMode.World,this.sendMode=i.ZegoRangeAudioMode.World,this.recvRange=null,this.position=null,this.forwardAxis=[1,0,0],this.upAxis=[0,0,1],this.audioStream=null,this.enableMic=!1,this.isPublishing=!1,this.streamID=null,this.zegoRTC=t,this.audioCtx=e,this.audioListener=this.audioCtx.listener,this.eventHandler=s.default.getInstance(),this.zegoRTC.on("publisherStateUpdate",(function(e){var t=e.state,n=e.errorCode,o=e.extendedData,s=e.streamID.match(/(.*)_(.*)/);if(3===(null==s?void 0:s.length)){if(r.userID!==s[1])return;"NO_PUBLISH"===t?(r.isPublishing=!1,r.stopPublishingStream()):r.isPublishing=!0,r.eventHandler.emit("microphoneStateUpdate",{NO_PUBLISH:i.ZegoRangeAudioMicrophoneState.Off,PUBLISH_REQUESTING:i.ZegoRangeAudioMicrophoneState.TurningOn,PUBLISHING:i.ZegoRangeAudioMicrophoneState.On}[t],n,o)}}))}return Object.defineProperty(e.prototype,"logger",{get:function(){return this.zegoRTC.logger},enumerable:!1,configurable:!0}),e.getInstance=function(t,r){return e.instance||(e.instance=new e(t,r)),e.instance},e.prototype.updateSelfPosition=function(e,t,r){this.position=e,this.forwardAxis=t,Array.isArray(r)&&(this.upAxis=r),this.updateListenerEffect()},e.prototype.updateListenerEffect=function(){this.position&&(this.audioListener.positionX?(this.audioListener.positionX.value=this.position[1],this.audioListener.positionY.value=this.position[2],this.audioListener.positionZ.value=-this.position[0]):this.audioListener.setPosition(this.position[1],this.position[2],-this.position[0]),this.audioListener.forwardX?(this.audioListener.forwardX.value=this.forwardAxis[1],this.audioListener.forwardY.value=this.forwardAxis[2],this.audioListener.forwardZ.value=-this.forwardAxis[0],this.audioListener.upX.value=this.upAxis[1],this.audioListener.upY.value=this.upAxis[2],this.audioListener.upZ.value=-this.upAxis[0]):this.audioListener.setOrientation(this.forwardAxis[1],this.forwardAxis[2],-this.forwardAxis[0],this.upAxis[1],this.upAxis[2],-this.upAxis[0]))},e.prototype.startPublishingStream=function(){var e=this;this.enableMic?this.logger.warn(o.RANGE_AUDIO+" mic is already enabled"):(this.enableMic=!0,this.zegoRTC.createStream({camera:{video:!1,audio:!0,audioInput:this.micID||void 0,audioBitrate:30}}).then((function(t){if(!e.userID)throw e.zegoRTC.destroyStream(t),e.enableMic=!1,Error("Enable mic failed. Please log in room first.");e.audioStream&&e.audioStream!==t&&e.zegoRTC.destroyStream(e.audioStream),e.audioStream=t;var r={range_audio_team_id:e.teamID||"",range_audio_mode:a(e.sendMode),r_a_s_flag:1};e.streamID=e.userID+"_"+Date.now(),e.zegoRTC.startPublishingStream(e.streamID,t,{extraInfo:JSON.stringify(r)})})).catch((function(t){throw e.audioStream=null,e.enableMic=!1,t})))},e.prototype.stopPublishingStream=function(){this.isPublishing&&this.streamID&&this.zegoRTC.stopPublishingStream(this.streamID),this.isPublishing=!1,this.audioStream&&(this.zegoRTC.destroyStream(this.audioStream),this.audioStream=null),this.enableMic=!1},e.prototype.setRecvMode=function(e){this.recvMode=e},e.prototype.setSendMode=function(e){this.sendMode=e,this.updateSteamExtraInfo()},e.prototype.setTeamID=function(e){this.teamID=e,this.updateSteamExtraInfo()},e.prototype.updateSteamExtraInfo=function(){this.streamID&&this.isPublishing&&this.zegoRTC.setStreamExtraInfo(this.streamID,JSON.stringify({range_audio_team_id:this.teamID||"",range_audio_mode:a(this.sendMode),r_a_s_flag:1}))},e.prototype.reset=function(){this.audioStream&&this.stopPublishingStream(),this.userID=void 0,this.streamID=null},e}();t.default=c},7803:function(e,t){"use strict";function r(e){return!isNaN(Number(e))&&Number.MAX_SAFE_INTEGER>=Number(e)&&Number(e)>=-Number.MAX_SAFE_INTEGER}Object.defineProperty(t,"__esModule",{value:!0}),t.checkCoordinate=t.checkBoolean=t.checkNumber=void 0,t.checkNumber=r,t.checkBoolean=function(e){return!1},t.checkCoordinate=function(e){if(Array.isArray(e)){for(var t=0;t<3;t++)if(!r(e[t]))return!1;return!0}return!1}},2938:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdvancedModule=void 0;var n=r(1091),i=r(4427),o=function(){function e(e,t,r,n){this.logger=e,this.dataReport=t,this.streamCenter=r,this.stateCenter=n,this.screenShotReady=!1}return e.prototype.publishTarget=function(e){var t=this,r=this.stateCenter.getReportSeq();switch(e.type){case"addpush":this.dataReport.newReport(r,i.ZegoRTCLogEvent.kZegoTaskAddPublishCdnUrl.event);break;case"delpush":case"clearpush":this.dataReport.newReport(r,i.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.event)}return this.dataReport.addMsgInfo(r,{stream:i.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.stream(e.streamID),target_url:i.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.target_url(e.pushUrl)}),new Promise((function(o,s){var a=function(e,n){t.logger.error("zb.pt"+(n||e.message)),t.dataReport.addMsgInfo(r,{error:e.code,message:e.message+(n||"")}),t.dataReport.uploadReport(r),s({errorCode:e.code,extendedData:e.message+(n?" "+n:"")})};if(-1==["addpush","delpush","clearpush"].indexOf(e.type))return t.logger.error("zb.sh.pt cdn push type error"),void a(n.errorCodeList.PUBLISHER_CDN_PUSH_ERROR,"type error");if(e.streamID&&"string"==typeof e.streamID)if(e.pushUrl&&"string"==typeof e.pushUrl)if(t.stateCenter.publishStreamList[e.streamID]){var c=t.streamCenter.getRoomByStreamID(e.streamID);c?c.streamHandler._publishTarget(e,(function(e){t.dataReport.uploadReport(r),o(e)}),a):a(i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kNoLoginError)}else a(i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kPublishStreamNoFoundError);else a(i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kParamError,"push url error");else a(i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kParamError,"stream id type error")}))},e}();t.AdvancedModule=o},4243:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.streamHandler=t.zegoWebRTC=t.ENUM_PUBLISH_STREAM_STATE=t.ENUM_STREAM_CMD_PRI=t.ENUM_STREAM_SUB_CMD=t.PROTO_VERSION=void 0;var n=r(1091),i=r(4427);t.PROTO_VERSION="2.20.2",t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_CMD_PRI={liveBegin:"zegochat_js.room_stream_create_req",liveEnd:"zegochat_js.room_stream_delete_req",liveUpdate:"zegochat_js.room_stream_update_req"},t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},t.zegoWebRTC={setStreamExtraInfo:function(e,t){var r=this;return new Promise((function(n,o){var s=r.stateCenter.getReportSeq();r.dataReport.newReport(s,i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.event),r.dataReport.addMsgInfo(s,{stream:i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.stream(e),stream_extra_info:i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.stream_extra_info(t)});var a=function(e,t){r.logger.error("zb.ssei "+t),r.dataReport.addMsgInfo(s,{error:e.code,message:e.message+" "+t}),r.dataReport.uploadReport(s),o({errorCode:e.code,extendedData:e.message+" "+t})};if("string"==typeof e&&""!=e)if("string"==typeof t&&""!=t)if(r.RTM.isDisConnect())a(i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kNoLoginError,"not login");else if(r.stateCenter.publishStreamList[e]){var c=r.streamCenter.getRoomByStreamID(e);c?(r.dataReport.addMsgInfo(s,{room_sid:i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.room_sid(c.sessionID)}),c.streamHandler.setStreamExtraInfo(e,t,n,a),r.dataReport.uploadReport(s)):a(i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kNoLoginError,"not login")}else a(i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kPublishStreamNoFoundError,"publish stream no found");else a(i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kParamError,"extraInfo must be string and no empty");else a(i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kParamError,"streamID must be string and not empty")}))}},t.streamHandler={_publishTarget:function(e,r,o){var s=this;this.logger.info("zb.sh.ptcall");var a=Math.ceil((new Date).getTime()/1e3),c=e.streamID;this.stateCenter.testEnvironment&&(c="zegotest-"+this.stateCenter.appid+"-"+e.streamID);var u={appid:this.stateCenter.appid,biz_type:0,timestamp:a,seq:this.stateCenter.cdnSeq++,version:1*t.PROTO_VERSION,stream_id:c,pushurl:e.pushUrl};if(this.logger.debug("zb.sh.pt send command"),this.stateCenter.useNetAgent)this.sendBizChannelRequestV2({server:1,location:"/liveroomcmd/push",cmd:e.type},u,(function(t){s.logger.info("zb.sh.pt receive message");var i=t||{},a=i.code,c=i.message;a&&0!=a?(s.logger.error("zb.sh.pt "+e.type+" error code: "+a+" "+c),o(n.errorCodeList.UNKNOWN_SERVER_ERROR," cmd: ".concat(e.type," ").concat(a," ").concat(c))):(s.logger.info("zb.sh.pt "+e.type+" success"),r&&r({errorCode:0,extendedData:""}))}),(function(t,r,n,a){var c="";a||(a=i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kUnknownServerError,200===t?(s.logger.info("zb.sh.pt error: "+r),a=i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kUnknownServerError,2001==r?a=i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kInvalidChannelError:2002==r&&(a=i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kBizChannelError),c="cmd: ".concat(e.type,", biz_code: ").concat(r)):c="request media server fail, error: "+t,s.logger.error("zb.sh.pt "+c)),o&&o(a,c)}));else{var l={channel:"media",cmd:e.type,req_body:JSON.stringify(u)};this.sendBizChannelRequest(l,(function(t,a,c){if(s.logger.info("zb.sh.pt receive message"),0!=c.length){var u=JSON.parse(c),l=u.code,d=u.message;l&&0!=l?(s.logger.error("zb.sh.pt "+e.type+" error code: "+l+" "+d),o(n.errorCodeList.UNKNOWN_SERVER_ERROR," cmd: ".concat(e.type," ").concat(l," ").concat(d))):(s.logger.info("zb.sh.pt "+e.type+" success"),r&&r({errorCode:0,extendedData:""}))}else o(i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kNoResponseError)}),(function(t,r,n){s.logger.info("zb.sh.pt error: "+t);var a=i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kUnknownServerError;2001==t?a=i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kInvalidChannelError:2002==t&&(a=i.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kBizChannelError),s.logger.error("zb.sh.pt "),o(a," cmd: ".concat(e.type," ").concat(t," ").concat("","  "))}))}},updateStreamExtraInfo:function(e,r,n,o){this.logger.info("zb.sh.usei call");var s=t.ENUM_STREAM_SUB_CMD.liveUpdate;this.stateCenter.publishStreamList[e]&&this.stateCenter.publishStreamList[e].state>=t.ENUM_PUBLISH_STREAM_STATE.update_info?(this.stateCenter.publishStreamList[e].extra_info=r,this.updateStreamInfo(e,s,r),n({errorCode:0})):this.stateCenter.publishStreamList[e]&&this.stateCenter.publishStreamList[e].state===t.ENUM_PUBLISH_STREAM_STATE.tryPublish?(this.stateCenter.publishStreamList[e].extra_info=r,n({errorCode:0})):o(i.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kUpdateStreamInfoFailError)},setStreamExtraInfo:function(e,t,r,n){this.updateStreamExtraInfo(e,t,r,n)}}},1091:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},INPUT_PARAM:{code:1100001,message:"input param error."},PUBLISH_NOT_PUBLISH:{code:1103040,message:"publisher not found"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"},TRACK_NOT_FOUND:{code:1103047,message:"track is not found"},DEVICE_NOT_FOUND:{code:1103048,message:"device is not found"},PUBLISHER_CONSTRAINTS_ERROR:{code:1103029,message:"constraint error"},PUBLISHER_CDN_PUSH_ERROR:{code:1103052,message:"publisher cdn push error"},VIDEO_DEVICE_FALSE:{code:1103045,message:"video is false"},AUDIO_DEVICE_FALSE:{code:1103046,message:"audio is false"},UNKNOWN_SERVER_ERROR:{code:1100999,message:"unknown server error"},LOCALSTREAM_WRONG:{code:1000018,message:"local stream wrong"},PUBLISHER_STREAM_NO_FOUND:{code:1103055,message:"publish stream no found"},PUBLISH_TARGET_NO_RESPONSE:{code:1103063,message:"publish target no response"},BIZ_CHANNEL_ERROR:{code:1102021,message:"biz channel error."},INVALID_CHANNEL:{code:1102024,message:"invalid channel"},PUBLISHER_EXTRA_INFO_NULL:{code:1003050,message:"extra info of publishing stream is null"},PUBLISHER_UPDATE_STREAM_INFO_FAIL:{code:1103062,message:"update stream info fail"},TRACK_CAN_NOT_ADD:{code:1103063,message:"only stream which have one track and kind no exist can add track"},TRACK_CAN_NOT_REMOVE:{code:1103064,message:"stream which only has one track can not remove "},PUBLISHER_UPDATE_SDP_FAIL:{code:1103068,message:"update sdp fail"},PUBLISHER_STATE_WRONG:{code:1103069,message:"publisher state wrong"},HANDLE_TRACK_NOT_SUPPORTED:{code:1103070,message:"not support remove track"},VIDEO_EFFECT_IS_RUNNING:{code:1103071,message:"video effect processor is running"}}},6012:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2938),i=r(4243);t.default={type:"StreamCommon",install:function(e,t,r){for(var o in Object.defineProperty(t.prototype,"initStreamCommon",{value:function(){this.streamCommonModule=new n.AdvancedModule(this.logger,this.dataReport,this.streamCenter,this.stateCenter)},writable:!1}),i.zegoWebRTC)Object.defineProperty(e.prototype,o,{value:i.zegoWebRTC[o],writable:!1});for(var o in i.streamHandler)Object.defineProperty(r.prototype,o,{value:i.streamHandler[o],writable:!1})}}},4427:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var n=r(1091),i=function(e){return e};t.ZegoRTCLogEvent={kZegoTaskPublishTarget:{event:"/sdk/publish_target",error:{kParamError:n.errorCodeList.INPUT_PARAM,kPublishStreamNoFoundError:n.errorCodeList.PUBLISHER_STREAM_NO_FOUND,kNoLoginError:n.errorCodeList.NOT_LOGIN,kNoResponseError:n.errorCodeList.PUBLISH_TARGET_NO_RESPONSE,kBizChannelError:n.errorCodeList.BIZ_CHANNEL_ERROR,kInvalidChannelError:n.errorCodeList.INVALID_CHANNEL,kUnknownServerError:n.errorCodeList.UNKNOWN_SERVER_ERROR}},kZegoTaskAddPublishCdnUrl:{event:"/sdk/add_publish_cdn_url",error:{kParamError:n.errorCodeList.INPUT_PARAM}},kZegoTaskRemovePublishCdnUrl:{event:"/sdk/remove_publish_cdn_url",error:{kParamError:n.errorCodeList.INPUT_PARAM},stream:i,target_url:i},kZegoTaskClearPublishCdnUrl:{event:"/sdk/clear_publish_cdn_url",error:{kParamError:n.errorCodeList.INPUT_PARAM}},kZegoTaskLiveRoomSendStreamExtraInfo:{event:"/liveroom/send_stream_extra_info",error:{kParamError:n.errorCodeList.INPUT_PARAM,kExtraInfoNullError:n.errorCodeList.PUBLISHER_EXTRA_INFO_NULL,kNoLoginError:n.errorCodeList.NOT_LOGIN,kPublishStreamNoFoundError:n.errorCodeList.PUBLISHER_STREAM_NO_FOUND,kUpdateStreamInfoFailError:n.errorCodeList.PUBLISHER_UPDATE_STREAM_INFO_FAIL},stream:i,stream_extra_info:i,room_sid:i}}},3524:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.preview=t.zegoWebRTC=void 0;var a=s(r(954)),c=r(3471);t.zegoWebRTC={setBeautyEffect:function(e,t,r,i){var o=this;return void 0===i&&(i=!0),new Promise((function(s,a){var u,l;if(!(e instanceof MediaStream))return o.logger.error("zc.p.0.sbe.0 localStream not found"),void a({errorCode:1100001,extendedData:" localStream no found"});var d=function(e){s(e)},h=o.streamCenter.checkPreview(e);if(!h)return o.logger.error("zc.sbe.0 preview no found"),void d({errorCode:c.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:c.errorCodeList.PUBLISH_NO_PREVIEW.message});var p=(null===(u=h.videoEffect)||void 0===u?void 0:u.stateFlag)||{base:!1,lowLight:!1};if(i)!(t=!!t)&&p.lowLight?r={sharpenIntensity:0,whitenIntensity:0,rosyIntensity:0,smoothIntensity:0,lowlightEnhancement:p.lowLight?1:0}:t&&(r=n({lowlightEnhancement:p.lowLight?1:0},r)),p.base=t;else{var f=r.lowlightEnhancement;r=(null===(l=h.videoEffect)||void 0===l?void 0:l.enabled)||1!==f?{lowlightEnhancement:f}:{sharpenIntensity:0,whitenIntensity:0,rosyIntensity:0,smoothIntensity:0,lowlightEnhancement:f},p.lowLight=1===f}h.setBeautyEffect(p.base||p.lowLight,r,p).then((function(){d({errorCode:0,extendedData:""})})).catch((function(e){a({errorCode:e.errorCode||-1,extendedData:e.extendedData||e.toString()})}))}))},setLowlightEnhance:function(e,t){return this.setBeautyEffect(e,!0,{lowlightEnhancement:t},!1)}},t.preview={setBeautyEffect:function(e,t,r){return i(this,void 0,void 0,(function(){var n,s=this;return o(this,(function(u){switch(u.label){case 0:if(!this.videoTrack)return this.logger.error("zc.p.0.sbe.0 video track no found"),[2];if("undefined"==typeof WebGLRenderingContext)throw{errorCode:(n=c.errorCodeList.VIDEO_EFFECT_NOT_SUPPORT).code,extendedData:n.message};return a.default?this.videoEffect?this.videoTrack===this.videoEffect.input?[3,2]:[4,this.videoEffect.setInput(this.videoTrack)]:[3,4]:[3,7];case 1:u.sent(),u.label=2;case 2:return[4,this.videoEffect.setBeautyEffectOptions(e,t)];case 3:return u.sent(),this.videoEffect.stateFlag=r,[3,6];case 4:return this.videoEffect=new a.default(this.logger,this.videoTrack),this.videoEffect.onError=function(e,t){s.stateCenter.actionListener("beautyEffectError",s.localStream,e.errorCode,e.extendedData,t)},this.videoEffect.onOutputChange=function(e){return i(s,void 0,void 0,(function(){var t,r;return o(this,(function(n){return this.videoTrack&&this.localStream&&(t=this.videoTrack,e&&(t=e),this.localStream.getVideoTracks()[0]!==t&&((r=this.streamCenter.getPublishList(this.localStream)).map((function(e){return e.publisher})).forEach((function(e){e&&e.previewer&&e.replacePublishedTrack(t,!0)})),0===r.length&&this.replacePreviewTrack(t,!!e))),[2]}))}))},[4,this.videoEffect.setBeautyEffectOptions(e,t)];case 5:u.sent(),this.videoEffect.stateFlag=r,u.label=6;case 6:return[3,8];case 7:this.logger.error("zc.p.0.sbe.0 beauty effect module no found"),u.label=8;case 8:return[2]}}))}))}}},3048:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLISH_SET_BEAUTY_EFFECT=void 0;var s=o(r(8606)),a=o(r(8658)),c=o(r(5934)),u=o(r(8302));t.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe.2";var l=r(3471).errorCodeList.VIDEO_EFFECT_NOT_SUPPORT,d={errorCode:l.code,extendedData:l.message},h=function(){function e(e){this.logger=e,this.gl=null,this.effectConfig={sharpenIntensity:.5,whitenIntensity:.5,rosyIntensity:.5,smoothIntensity:.5,lowlightEnhancement:0},this.originResolution={width:0,height:0},this.shaderList=[],this.frameBufferList=[],this.outputTextureList=[],this.inputTexture=null,this.failedTimes=0,this.onRenderError=function(e){},this.enableBeauty=!1}return e.prototype.setEnableBeauty=function(e){this.enableBeauty=!!e},e.prototype.handleInitError=function(){this.failedTimes++,this.failedTimes>30&&(this.failedTimes=0,this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" get webgl context failed"),this.onRenderError(d))},e.prototype.init=function(e,r,o){return n(this,void 0,void 0,(function(){var n,l,h,p;return i(this,(function(i){switch(i.label){case 0:return void 0!==window.WebGLRenderingContext?(this.canvasEl=o,this.gl=o.getContext("webgl"),this.gl?(this.initGL(e,r),this.inputTexture?[4,(n=new c.default(this.gl,e,r)).setConstUniforms()]:(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input texture not found"),this.handleInitError(),[2])):(this.handleInitError(),[2])):(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" not support webgl!"),this.onRenderError(d),[2]);case 1:return i.sent(),(l=new s.default(this.gl,e,r)).setConstUniforms(),(h=new a.default(this.gl,e,r)).setConstUniforms(),(p=new u.default(this.gl,e,r)).setConstUniforms(),this.shaderList=[n,l,h,p],this.setEffectConfig(this.effectConfig),[2]}}))}))},e.prototype.render=function(e){return n(this,void 0,void 0,(function(){var r,n,o,s,a=this;return i(this,(function(i){switch(i.label){case 0:return(r=this.gl)&&this.canvasEl&&!r.isContextLost()?[3,4]:this.canvasEl?(this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" gl lost, restart effect"),this.release(),[4,this.init(e.videoWidth,e.videoHeight,this.canvasEl)]):[3,2];case 1:return i.sent(),[3,3];case 2:this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" canvas lost"),this.onRenderError(d),i.label=3;case 3:return[2];case 4:return this.originResolution.height===e.videoHeight&&this.originResolution.width===e.videoWidth||!(Math.abs(this.originResolution.height-e.videoHeight)>2||Math.abs(this.originResolution.width-e.videoWidth)>2)?[3,7]:0===e.videoHeight||0===e.videoWidth?[2]:(this.canvasEl.width=e.videoWidth,this.canvasEl.height=e.videoHeight,e.setAttribute("width",e.videoWidth.toString()),e.setAttribute("height",e.videoHeight.toString()),!this.gl||this.gl.isContextLost()?[3,5]:(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution changed to ".concat(e.videoWidth,"x").concat(e.videoHeight,", reset resolution.")),this.resetResolution(e.videoWidth,e.videoHeight),this.shaderList.forEach((function(t){t.resetResolution(e.videoWidth,e.videoHeight)})),[3,7]));case 5:return this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution changed and gl context lost, restart effect"),this.release(),[4,this.init(e.videoWidth,e.videoHeight,this.canvasEl)];case 6:i.sent(),i.label=7;case 7:return n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],o=[0,1,2,0,2,3],s=[0,0,1,0,1,1,0,1],r.viewport(0,0,e.width,e.height),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.inputTexture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),this.shaderList.forEach((function(e,t){var i=e.program;if(i){e.renderPreTextures&&e.renderPreTextures(n,o,s),r.useProgram(i),e.render();var c=r.getUniformLocation(i,"uTexture"),u=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW);var l=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,l),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),r.STATIC_DRAW);var d=r.getAttribLocation(i,"aPosition");r.enableVertexAttribArray(d),r.vertexAttribPointer(d,3,r.FLOAT,!1,0,0);var h=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,h),r.bufferData(r.ARRAY_BUFFER,new Float32Array(s),r.STATIC_DRAW);var p=r.getAttribLocation(i,"aTexCoordinate");r.enableVertexAttribArray(p),r.vertexAttribPointer(p,2,r.FLOAT,!1,0,0);var f=t===a.shaderList.length-1?null:a.outputTextureList[t];r.bindFramebuffer(r.FRAMEBUFFER,t===a.shaderList.length-1?null:a.frameBufferList[t]),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),r.activeTexture(r.TEXTURE0),f&&r.bindTexture(r.TEXTURE_2D,f),r.uniform1i(c,0)}})),[2]}}))}))},e.prototype.setEffectConfig=function(e){var t=this;isNaN(e.sharpenIntensity)||(this.effectConfig.sharpenIntensity=e.sharpenIntensity),isNaN(e.whitenIntensity)||(this.effectConfig.whitenIntensity=e.whitenIntensity),isNaN(e.rosyIntensity)||(this.effectConfig.rosyIntensity=e.rosyIntensity),isNaN(e.smoothIntensity)||(this.effectConfig.smoothIntensity=e.smoothIntensity),isNaN(e.lowlightEnhancement)||(this.effectConfig.lowlightEnhancement=e.lowlightEnhancement),this.shaderList.forEach((function(e){e.setEffectConfig(t.effectConfig)}))},e.prototype.release=function(){var e,t=this;this.shaderList.forEach((function(e){var r;e.program&&(null===(r=t.gl)||void 0===r||r.deleteProgram(e.program))})),this.outputTextureList.forEach((function(e){var r;e&&(null===(r=t.gl)||void 0===r||r.deleteTexture(e))})),this.frameBufferList.forEach((function(e){var r;e&&(null===(r=t.gl)||void 0===r||r.deleteFramebuffer(e))})),this.inputTexture&&(null===(e=this.gl)||void 0===e||e.deleteTexture(this.inputTexture)),this.inputTexture=this.gl=null,this.shaderList.forEach((function(e){e.release()})),this.shaderList=[],this.outputTextureList=[],this.frameBufferList=[]},e.prototype.initGL=function(e,r){var n=this.gl;if(!n)return this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" webgl context not found");this.inputTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.inputTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR);for(var i=0;4>i;i++){var o=n.createTexture();if(!o)return this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" create texture failed");n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,r,0,n.RGBA,n.UNSIGNED_BYTE,null);var s=n.createFramebuffer();if(!s)return this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" create frame buffer failed");n.bindFramebuffer(n.FRAMEBUFFER,s),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o,0),this.outputTextureList.push(o),this.frameBufferList.push(s)}n.viewport(0,0,e,r),this.originResolution.width=e,this.originResolution.height=r},e.prototype.resetResolution=function(e,r){var n=this.gl;if(!n)return this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" can not find webgl context");for(var i=0;i<this.outputTextureList.length;i++)n.bindTexture(n.TEXTURE_2D,this.outputTextureList[i]),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,r,0,n.RGBA,n.UNSIGNED_BYTE,null);n.viewport(0,0,e,r),this.originResolution.width=e,this.originResolution.height=r},e}();t.default=h},3471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={VIDEO_EFFECT_NOT_SUPPORT:{code:1103072,message:"not support beauty effect"},VIDEO_TRACK_NOT_READABLE:{code:1103074,message:"video track is not readable"},VIDEO_TRACK_OVERLOAD:{code:1103075,message:"beauty effect overload"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"}}},957:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeautyEffect=void 0;var n=r(3524);t.BeautyEffect={type:"BeautyEffect",install:function(e,t){for(var r in n.preview)Object.defineProperty(t.prototype,r,{value:n.preview[r],writable:!1});for(var r in n.zegoWebRTC)Object.defineProperty(e.prototype,r,{value:n.zegoWebRTC[r],writable:!1})}}},836:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.logger=e,this.recordedFrameCount=0,this.targetFrameRate=0,this.recordingDuration=0}return e.prototype.startRecordBeautyEffectOutput=function(e){return r(this,void 0,void 0,(function(){var t,r,i,o=this;return n(this,(function(n){switch(n.label){case 0:return t=6,this.recordID?(this.logger.warn("zc.p.0.sbe.3 detector is already recording"),[2,{result:!0}]):(r=(new Date).getTime(),this.recordID=r,this.targetFrameRate=e,this.recordedFrameCount=0,this.recordingDuration=t,[4,new Promise((function(e){window.setTimeout(e,1e3*o.recordingDuration)}))]);case 1:return n.sent(),this.recordID!==r?(this.recordID=void 0,[2,{result:!0}]):(this.recordID=void 0,i=this.recordedFrameCount/t,this.recordedFrameCount<this.targetFrameRate*this.recordingDuration/2?(this.logger.warn("zc.p.0.sbe.3 detect effect overload: current fps: "+i),[2,{result:!1,targetFPS:this.targetFrameRate,currentFPS:i}]):(this.logger.info("zc.p.0.sbe.3 detect effect current fps: "+i),[2,{result:!0}]))}}))}))},e.prototype.stopRecordBeautyEffectOutput=function(){this.recordedFrameCount=this.targetFrameRate=0,this.recordID=void 0},e.prototype.addFrame=function(){this.recordID&&(this.recordedFrameCount+=1)},e}();t.default=i},6976:function(e,t){"use strict";function r(e){for(var t=e,r="",n=0;n<t.length;n++){var i=t.charCodeAt(n),o=i;i>=65&&i<=90&&(o=(i-65-13+26)%26+65),i>=97&&i<=122&&(o=(i-97-13+26)%26+97),r+=String.fromCharCode(o)}return r}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){this.gl=e,this.width=t,this.height=r,this.type="baseShader",this.program=null,this.program=null}return e.prototype.setEffectConfig=function(e){},e.prototype.setConstUniforms=function(){},e.prototype.resetResolution=function(e,t){this.width=e||this.width,this.height=t||this.height},e.prototype.render=function(){},e.prototype.renderPreTextures=function(e,t,r){},e.prototype.makeProgram=function(e,t){var n=this.gl,i=r(e),o=r(t),s=this.makeShader(i,n.VERTEX_SHADER),a=this.makeShader(o,n.FRAGMENT_SHADER),c=n.createProgram();return n.attachShader(c,s),n.attachShader(c,a),n.linkProgram(c),n.getProgramParameter(c,n.LINK_STATUS),c},e.prototype.release=function(){},e.prototype.makeShader=function(e,t){var r=this.gl,n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS),n},e}();t.default=n},8606:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(r(6976)),a=r(1199),c=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.width=r,i.height=n,i.type="BlurShader",i.blurXProgram=null,i.blurYProgram=null,i.diffProgram=null,i.uIntensity=null,i.smoothIntensity=.5,i.blurTextureList=[],i.blurBufferList=[],i.blurXProgram=i.makeProgram(a.borderBlurVS,a.borderBlurFS),i.setBorderBlurProgram(i.blurXProgram,1/(r||1),0),i.blurYProgram=i.makeProgram(a.borderBlurVS,a.borderBlurFS),i.setBorderBlurProgram(i.blurYProgram,0,1/(n||1)),i.diffProgram=i.makeProgram(a.diffBlurVS,a.diffBlurFS),i.setDiffBlurProgram(i.diffProgram),i.program=i.makeProgram(a.mixBlurVS,a.mixBlurFS),i.initBlurBuffer(),i}return i(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.smoothIntensity)||(this.smoothIntensity=e.smoothIntensity/100)},t.prototype.render=function(){this.gl.uniform1f(this.uIntensity,this.smoothIntensity)},t.prototype.initBlurBuffer=function(){var e=this,t=this.gl;this.blurTextureList.forEach((function(t){var r;t&&(null===(r=e.gl)||void 0===r||r.deleteTexture(t))})),this.blurBufferList.forEach((function(t){var r;t&&(null===(r=e.gl)||void 0===r||r.deleteFramebuffer(t))})),this.blurTextureList=[],this.blurBufferList=[];for(var r=0;r<3;r++){var n=t.createTexture();if(!n)return;t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null);var i=t.createFramebuffer();if(!i)return;t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),this.blurTextureList.push(n),this.blurBufferList.push(i)}},t.prototype.renderPreTextures=function(e,t,r){var n=this,i=this.gl,o=[0,1,0],s=[1,1,2];[this.blurXProgram,this.blurYProgram,this.diffProgram].forEach((function(a,c){if(a){i.useProgram(a);var u=i.getUniformLocation(a,"uTexture");i.uniform1i(u,o[c]);var l=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,l),i.bufferData(i.ARRAY_BUFFER,new Float32Array(e),i.STATIC_DRAW);var d=i.createBuffer();i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,d),i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),i.STATIC_DRAW);var h=i.getAttribLocation(a,"aPosition");i.enableVertexAttribArray(h),i.vertexAttribPointer(h,3,i.FLOAT,!1,0,0);var p=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,p),i.bufferData(i.ARRAY_BUFFER,new Float32Array(r),i.STATIC_DRAW);var f=i.getAttribLocation(a,"aTexCoordinate");i.enableVertexAttribArray(f),i.vertexAttribPointer(f,2,i.FLOAT,!1,0,0),i.bindFramebuffer(i.FRAMEBUFFER,n.blurBufferList[c]),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0),i.activeTexture(i.TEXTURE0+s[c]),i.bindTexture(i.TEXTURE_2D,n.blurTextureList[c])}}))},t.prototype.setConstUniforms=function(){var e=this.width,t=this.height,r=this.program;if(r){var n=this.gl;n.useProgram(r);var i=n.getUniformLocation(r,"widthOffset");n.uniform1f(i,1/e);var o=n.getUniformLocation(r,"heightOffset");n.uniform1f(o,1/t),this.uIntensity=n.getUniformLocation(r,"blurAlpha"),n.uniform1f(this.uIntensity,this.smoothIntensity);var s=n.getUniformLocation(r,"blurTexture");n.uniform1i(s,1);var a=n.getUniformLocation(r,"blurDiffTexture");n.uniform1i(a,2)}},t.prototype.resetResolution=function(e,t){this.width=e||this.width,this.height=t||this.height},t.prototype.setBorderBlurProgram=function(e,t,r){var n=this.gl;n.useProgram(e);var i=n.getUniformLocation(e,"texBlurWidthOffset");n.uniform1f(i,t);var o=n.getUniformLocation(e,"texBlurHeightOffset");n.uniform1f(o,r)},t.prototype.setDiffBlurProgram=function(e){var t=this.gl;t.useProgram(e);var r=t.getUniformLocation(e,"blurTexture");t.uniform1i(r,1)},t}(s.default);t.default=c},5263:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lightLut=void 0,t.lightLut="\ndata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAM3mlDQ1BJQ0MgUHJvZmlsZQAAWIWlVwdYU8kWnluS0BJ6lRI60gwoXUqkBpBeBFGJIZBACDEFAbEhiyu4dhHBsqKiKIsdgcWGBQtrB7sLuigo6+IqNixvEopYdt/7vnfzzb3/nXPOnDpnbgBQ5TAFAh4KAMjki4WBUfSEKQmJVNJdIAe0gTKwB8pMlkhAj4gIhSyAn8Vng2+uV+0AkT6v2UnX+pb+rxchhS1iwedxOHJTRKxMAJCJAJC6WQKhGAB5MzhvOlsskOIgiDUyYqJ8IU4CQE5pSFZ6GQWy+Wwhl0UNFDJzqYHMzEwm1dHekRohzErl8r5j9f97ZfIkI7rhUBJlRIfApz20vzCF6SfFrhDvZzH9o4fwk2xuXBjEPgCgJgLxpCiIgyGeKcmIpUNsC3FNqjAgFmIviG9yJEFSPAEATCuPExMPsSHEwfyZYeEQu0PMYYl8EyG2griSw2ZI8wRjhp3nihkxEEN92DNhVpSU3xoAfGIK289/cB5PzcgKkdpgAvFBUXa0/7DNeRzfsEFdeHs6MzgCYguIX7J5gVGD6xD0BOII6ZrwneDH54WFDvpFKGWLZP7Cd0K7mBMjzZkjAEQTsTAmatA2YkwqN4ABcQDEORxhUNSgv8SjAp6szmBMiO+FkqjYQR9JAWx+rHRNaV0sYAr9AwdjRWoCcQgTsEEWmAnvLMAHnYAKRIALsmUoDTBBJhxUaIEtHIGQiw+HEHKIQIaMQwi6RujDElIZAaRkgVTIyYNyw7NUkALlB+Wka2TBIX2Trtstm2MN6bOHw9dwO5DANw7ohXQORJNBh2wmB9qXCZ++cFYCaWkQj9YyKB8hs3XQBuqQ9T1DWrJktjBH5D7b5gvpfJAHZ0TDnuHaOA0fD4cHHop74jSZlBBy5AI72fxE2dyw1s+eS33rGdE6C9o62vvR8RqO4QkoJYbvPOghfyg+ImjNeyiTMST9lZ8r9CRWAkHpskjG9KoRK6gFwhlc1qXlff+StW+1232Rt/DRdSGrlJRv6gLqIlwlXCbcJ1wHVPj8g9BG6IboDuEu/N36blSyRmKQBkfWSAWwv8gNG3LyZFq+tfNzzgbX+WoFBBvhpMtWkVIz4eDKeEQj+ZNALIb3VJm03Ve5C/xab0t+kw6gti89fg5Qa1Qazn6Odhten3RNqSU/lb9CTyCYXpU/wBZ8pkrzwF4c9ioMFNjS9tJ6adtoNbQXtPufOWg3aH/S2mhbIOUptho7hB3BGrBGrBVQ4VsjdgJrkKEarAn+9v1Dhad9p8KlFcMaqmgpVTxUU6Nrf3Rk6aOiJeUfjnD6P9Tr6IqRZux/s2j0Ol92BPbnXUcxpThQSBRrihOFTkEoxvDnSPGByJRiQgmlaENqEMWS4kcZMxKP4VrnDWWY+8X+HrQ4AVKHK4Ev6y5MyCnlYA75+7WP1C+8lHrGHb2rEDLcVdxRPeF7vYj6xc6KhbJcMFsmL5Ltdr5MTvBF/YlkXQjOIFNlOfyObbgh7oAzYAcKB1ScjjvhPkN4sCsN9yVZpnBvSPXC/XBXaR/7oi+w/qv1o3cGm+hOtCT6Ey0/04l+xCBiAHw6SOeJ44jBELtJucTsHLH0kPfNEuQKuWkcMZUOv3LYVAafZW9LdaQ5wNNN+s00+CnwIlL2LYRotbIkwuzBOVx6IwAF+D2lAXThqWoKT2s7qNUFeMAz0x+ed+EgBuZ1OvSDA+0Wwsjmg4WgCJSAFWAtKAebwTZQDWrBfnAYNMEeewZcAJdBG7gDz5Mu8BT0gVdgAEEQEkJG1BFdxAgxR2wQR8QV8UL8kVAkCklAkpE0hI9IkHxkEVKCrELKkS1INbIPaUBOIOeQK8gtpBPpQf5G3qEYqoRqoAaoBToOdUXpaAgag05D09BZaB5aiC5Dy9BKtAatQ0+gF9A2tAN9ivZjAFPEtDBjzA5zxXyxcCwRS8WE2DysGCvFKrFa2ANasGtYB9aLvcWJuDpOxe1gFoPwWJyFz8Ln4UvxcnwnXoefwq/hnXgf/pFAJugTbAjuBAZhCiGNMJtQRCglVBEOEU7DDt1FeEUkErVgflxg3hKI6cQ5xKXEjcQ9xOPEK8SHxH4SiaRLsiF5ksJJTJKYVERaT6ohHSNdJXWR3sgpyhnJOcoFyCXK8eUK5Erldskdlbsq91huQF5F3lzeXT5cPkU+V365/Db5RvlL8l3yAwqqCpYKngoxCukKCxXKFGoVTivcVXihqKhoouimGKnIVVygWKa4V/GsYqfiWyU1JWslX6UkJYnSMqUdSseVbim9IJPJFmQfciJZTF5GriafJN8nv6GoU+wpDEoKZT6lglJHuUp5piyvbK5MV56unKdcqnxA+ZJyr4q8ioWKrwpTZZ5KhUqDyg2VflV1VQfVcNVM1aWqu1TPqXarkdQs1PzVUtQK1baqnVR7qI6pm6r7qrPUF6lvUz+t3qVB1LDUYGika5Ro/KJxUaNPU01zgmacZo5mheYRzQ4tTMtCi6HF01qutV+rXeudtoE2XZutvUS7Vvuq9mudMTo+OmydYp09Om0673Spuv66GbordQ/r3tPD9az1IvVm623SO63XO0ZjjMcY1pjiMfvH3NZH9a31o/Tn6G/Vb9XvNzA0CDQQGKw3OGnQa6hl6GOYbrjG8Khhj5G6kZcR12iN0TGjJ1RNKp3Ko5ZRT1H7jPWNg4wlxluMLxoPmFiaxJoUmOwxuWeqYOpqmmq6xrTZtM/MyGyyWb7ZbrPb5vLmruYc83XmLeavLSwt4i0WWxy26LbUsWRY5lnutrxrRbbytpplVWl1fSxxrOvYjLEbx162Rq2drDnWFdaXbFAbZxuuzUabK7YEWzdbvm2l7Q07JTu6XbbdbrtOey37UPsC+8P2z8aZjUsct3Jcy7iPNCcaD55udxzUHIIdChwaHf52tHZkOVY4Xh9PHh8wfv74+vHPJ9hMYE/YNOGmk7rTZKfFTs1OH5xdnIXOtc49LmYuyS4bXG64arhGuC51PetGcJvkNt+tye2tu7O72H2/+18edh4ZHrs8uidaTmRP3DbxoaeJJ9Nzi2eHF9Ur2etnrw5vY2+md6X3Ax9TnxSfKp/H9LH0dHoN/dkk2iThpEOTXvu6+871Pe6H+QX6Fftd9Ffzj/Uv978fYBKQFrA7oC/QKXBO4PEgQlBI0MqgGwwDBotRzegLdgmeG3wqRCkkOqQ85EGodagwtHEyOjl48urJd8PMw/hhh8NBOCN8dfi9CMuIWRG/RhIjIyIrIh9FOUTlR7VEq0fPiN4V/SpmUszymDuxVrGS2OY45bikuOq41/F+8aviO6aMmzJ3yoUEvQRuQn0iKTEusSqxf6r/1LVTu5KckoqS2qdZTsuZdm663nTe9CMzlGcwZxxIJiTHJ+9Kfs8MZ1Yy+2cyZm6Y2cfyZa1jPU3xSVmT0sP2ZK9iP071TF2V2p3mmbY6rYfjzSnl9HJ9ueXc5+lB6ZvTX2eEZ+zI+MSL5+3JlMtMzmzgq/Ez+KeyDLNysq4IbARFgo5Z7rPWzuoThgirRIhomqherAH/YLZKrCQ/SDqzvbIrst/Mjpt9IEc1h5/TmmuduyT3cV5A3vY5+BzWnOZ84/yF+Z1z6XO3zEPmzZzXPN90fuH8rgWBC3YuVFiYsfC3AlrBqoKXi+IXNRYaFC4ofPhD4A+7iyhFwqIbiz0Wb/4R/5H748Ul45esX/KxOKX4fAmtpLTk/VLW0vM/OfxU9tOnZanLLi53Xr5pBXEFf0X7Su+VO1eprspb9XD15NV1a6hrite8XDtj7bnSCaWb1ymsk6zrKAstq19vtn7F+vflnPK2ikkVezbob1iy4fXGlI1XN/lsqt1ssLlk87ufuT/f3BK4pa7SorJ0K3Fr9tZH2+K2tWx33V5dpVdVUvVhB39Hx86onaeqXaqrd+nvWr4b3S3Z3VOTVHP5F79f6mvtarfs0dpTshfslex9si95X/v+kP3NB1wP1B40P7jhkPqh4jqkLreu7zDncEd9Qv2VhuCG5kaPxkO/2v+6o8m4qeKI5pHlRxWOFh79dCzvWP9xwfHeE2knHjbPaL5zcsrJ66ciT108HXL67JmAMydb6C3HznqebTrnfq7hvOv5wxecL9S1OrUe+s3pt0MXnS/WXXK5VH/Z7XLjlYlXjl71vnrimt+1M9cZ1y+0hbVdaY9tv3kj6UbHzZSb3bd4t57fzr49cGcB/Igvvqdyr/S+/v3K38f+vqfDueNIp19n64PoB3cesh4+/UP0x/uuwkfkR6WPjR5Xdzt2N/UE9Fx+MvVJ11PB04Heoj9V/9zwzOrZwb98/mrtm9LX9Vz4/NPfS1/ovtjxcsLL5v6I/vuvMl8NvC5+o/tm51vXty3v4t89Hpj9nvS+7MPYD40fQz7e/ZT56dN/AC1d8Bx8dIG+AAAAHGlET1QAAAACAAAAAAAAAIAAAAAoAAAAgAAAAIAAAB7VdMrVpAAAHqFJREFUeAHsnHmsnmWZxj9nnBlFUUFcx1FxQ0GsuCG77IsKLavKDrJoQYggIOBgpBQKjYBsEWgxhQoGaiUUSmgpDdghyBIEQpGwhqWhQKCEAoE231zXdd/P897Pu3zntD2HZDJ+f7SHAn/4y7Xdz0fs9f75+SeBfxL4f0zgHb13vvNfm59/WcXPO/7vfHrvfve73vWu/7DPv+fPv9nnna2fJrBBf7KKLEf7X++9D5/V38vPe96z2mqrvds+gJKoiE0m4z84IP3WCqn8w0GAVvDvjTSQ3ofWWuuDa665xhprfOAD73+/aBgO8BCRhERKqWEhmzqaFkLEVAIZxl+tIJeV/sd7n/jPj3/sox/9yIc/BBKOQiwE432r4yN5UCBOpEICtVAq/JiHyl872NgfRw2ln4fBZdA/slIQep9Ze+1PffK/PmEcPvqRRMJUQV1AGAYDVqlwOBC6pjKO+ydTacUiSAPZdBMSqUEMVvzv9db94jpf+PxngeHTzoGCIAjTxFofBAo6RCYJMEQjqcMipNJIzpKEJGilQy5ZPMNg4/9IEk7778Nk0dtgzFfWXw8U1vn85xIG6gHGIIhAIqKgMAgjScPEkd0i0whHck1TJYZG9km/ZAZdPwyfzbAQCVxv4w2/+fWvfXXMV7683pdA4QsJg+RAYxQgmBOMiiALuaSE0YZDLWNMZBr9EvQRf0xA/PcuHOWfrzAc/xd6W26+6cYbbfjNbxDC+hUFqQGuYDxIEBmEzFGRoEPcIsZCMCppsGXt42Gaf0sSsbIxLJFD7ecalu58KcHwrwbB6e24/TZbbbHZJgZhgzGksC61YGJANiAcIIfAQdaQNxATToKiKFBEGAWNhCPGhzGpgHi0DsmkKqFAp/m/f+Cf9Hbd5Xs7br/tVt/ZfNNNNv42lbDBV8eMgRRAwSyBaBAGycE5yBkJBCRBEhFFGwtTRogNjo5uHMEzJFP5Bj/VtNH4y4Aj/9hFofejvXYftzMZbL3lFptturEgMBRkiHW/pGBAMlQYaAtxYFIyIgwEJFEjIVUIRbaIVYkHaMxQwahwNOUhkQSNlESGZgJImUXxQ++g/ff54Z67jd35ezttv+02EALdQCV8XVJgLBgFWAIBmdUAW1Qc6iDqJAKKyEJd0k0jq6Nsl5whaYokLIVIhqETE05v/GEHH7Dvj/baY1cy2GG7bbbacgu6oYAQKEgMhmHtTzMdmhxcES6Jwh7WIJYWVXSmkZG6tehX10ZQRyePOpG6Slqt0zv2qPGHH3IgZLDX7onB1ltCCHADIHyLSmAqQApZCxJDUoMwSA7mCxjDBRFAUBJ1ElEWhS48P21oEEYZonW3DODRINJAstpqvZNPOPaoI35yKGSw9w/23H3cLtLBtltv9R0JQRCSH5yCxeM6X6AnMoYODoyIBIKSqEikzPRd4SUSKlW6SC4ZgkZwy0AeTSLv6U38NRAcfeRPDv3xgfvtAyvsNm6X78MLDAQJYRNTgkGgFEwLTqGJIdnC9eCCaIBoJ2GqSBap6aIFRqs2CrcMweO97+2dPek0IPjF0Uf+9LBDDoIMfpgY7Lj9dttICJshErISFI2QAmJhvXU9Hp1CVAMwWDwEDnRGAUKSCCSiKGoo6iwqGKldO5xCw/gQa59jvYt+99szJpwCBD//2fjDDz2YMoAVdpUOwABm2DK7AZkAJbAfIIVIgcMpi8EjEguKKVlyoCCaIAaSSCisUBseyc0aI3QAjRLH6qv3pl1y4bmTMwI44aD9KQMwGEsv7LjDdttug1TcArEoIQhCikYaImshU1A0AAP3U8LQwaFUhIEwTWhb5XXFpMCHexMfULCP5UT8lRj8w/j0D3XQ8eldfcXUi88/56zTTz3lJKjgqCPghIMPgAxohcQAgWBCqEFIUlAsmCNEQWIoMVRywHzwIaUjwwRRAzEkiYRiEItgk+CTeqf0Zv35ymlTLjrv7DMnEsFxxxx15E/phP33pRWcwXd33CGbYbNNKyWYH9iSY2SIlAsc0bSEegLRkNVADG6LBofsjKo2dI7n7nBNFElRqWKgLnKzShxJF/q9N2/2X66eftklF/7ut5MmnvrfJ/3yuGOOPnI8nXDAfmaF3cbRC8YgCgG5SDskCEoFGsIp6JTowOByoC0KDjkhJIgWEIU76v7IDqlk0chOuSV5RL/3bp9/06wZV14+9ffnnzt50mm/MQQ/G/8TOOHA/c0KuzuDnRiKxsAjwSAgGREKNpgghUyBJWGWSJ4o1JDk0M5BgmiCcHM4iQ5RVCiGYrHGGr2//+22uTdABH+49KLzzjnrDENw7NE/OwJOMBn86Ad77YFakA4QihnC5pspEgIErUYzREkhJQM8gWhwDJaRSknaoslBgugC0U6i7o+AooNF75H771ow78brZlx1+VT44OyMgHl4+KEmg71/qDgYN3ZneCEwUDcwEgoIlEJBQfEYxDAkhtIXxsFAtEiig0QTRQ7OEBdrrtl75tEH7759/pzrZ179x2lTfn/Bub898/QJNMLxx/78KITBYYdABkxENCMisWRg1cCCDBAUCgGCayFRiGJoqqGwhTikJeWV4aUxAERyR7JHC4mA4oO9l559bOG9d9x282yI4IrLLr3ofCH4NRGgFY8cTycoDfaGFfbcvWRgiUAh1CFwLwUK61s6lhSsJ0iBpqiqwlyRbVHnEJxhy7JIy9wcfnf4EcYXmzYUa/XefHnREw/dd+eCW26SCKZefOF550yeNHGCIThGYYBAdBkwDgIDDwSORcai3CA7qB4KCApHdQQoKB49H5sYUjhkOSge2jm4M9oUwSdt++gWTfdoDUWv/+aS5558+P67b7917uxrZ1w1/Q/wAaIAnVghgBMQiCiFffeWFchgF+ZBCgRVA4SQIGzEitzwW6oHKCFLoU4BwZBrgqshqiFjGIJDEREOIh+g0AM/3SQ+1Ov333pl8VOPPHjPHbfNu3HWzKuvvPyyS+ADpGGFgGHAQJQMZAXqYCwZpFCkGVwIyQ0JAkvS/eDZiFgIWqgouBi6McgWQQ8hIPh0nQ4NP7rCJW4cWkh8GAD6y159/ulHF/4dNphzw7Uz/jR92hT4AFFwxmmuAuYhOoGBeCD2ERIRcWDVuPP3vRjUjkhFc0MHhCiFJoXSE+0YJIdhcCitUVdEReIjBNBftvSFZx5/6L67br/1ZokAYfj7CxAFhuDkE084DgiwDOgEymC/fWCFFAe77OzlqEAwISQ3qBwKJUQpwBCqCGxH5gKCoRQDPVFgKF1hGLr04IKogWiSEID+8qUvPvvEw/ffc8df591EEfxx2tRLLkIUTD7zdKrAECAP5QSXQbYCJpIz0EqCGYIQvCEzhOwH3wpcjpmCxSMpBDEMwBDkEDkUxhgKhAHoL3/tpUVPPvLgvXcumD939qyZ11x5xR+mXMwomDypQoBKYC0mGWQrsBacgVYS9nISggqyhMDzAaFQSCGFIw+JJgVGQ4GBjVmpIbSmzUk7MKqTExMiJUSaESksP/YxB9Dvv/7yc08hCO66/bZ5N11PEVwOHzAKzgKC35wiFfzimKMZBnACAvFA7iNZAXEgBiqGncgAgRCEwJXgDSklsB4AwaMRUlA2mhQQjoFCmxiyKYQhcOClqVvTZ3UrhySIZI2PZwD915csfvqxh+6/+46/3jJn9nUzr7lqOnzAKACCiRMyAoYBnIBAVBq0MWA5IhAKIaggGQkbbwQI1pEJAqKxNESg4MGQLJHF0InBbBHzwQZE6YtKERWA/htLnn/m8X88cO/fFiALJQLzwe/OQSEkBMf/4hggMCeYDDwR99wj6gAMGAhioETQUqIQ6hCSH1QQJoWGFkgh5KOeGuSJ4WGwfHAOdRABQP/NV15AFD4oG8y5wURw2aUXX3g+0zAgOPbnCAM4AdOgLoPKCxwIwQzej+YGh+DJWPnBpDAEhUIMNQx1VxRyaOcQAfTffPXFRU8+uvA+2GD+XIjgz1cjDOEDREFAgCMBCBAGdAJ7EWmAcZDjIOcBGAQzZCEMgpBmo0MoteDxGIPBxFBh0FHRwFBw4CsMPnyY46cA0H9r6UvPPYUguOdv/3MrCpEiQBhOQSUqDZMKfnn8ccciDxEG7IQgA19Iu7UxUCpSCHRDE4KSMfghZ6MXZcqFtBiGiSGEpGMo4uGTnywBiMDTDAK0wS1zb5xFEUyfBh9cdD6igIVgcSgEFgYeiEEGXIm77cpuRC9wKFZm8I2QGeRMqOrBotGkUFHAWrDpqI5op1AmpJ2YpoaIoeTwqRqA/rLXXl78zOMIgrvvWDD/ZongT380HzQQIA8ZBnICZRAY7FljkALB67EmhJgJUEIKhToEGqKNwkAxBFMUGBKHOgAQWPL8s088spA2uG3enNkUwVXTkw/OnkwVnMpSPOmXJxxHBAwDTYMKgcdBqQMxUDNwJ/F0KtzQhNAuhUSBlsBqkhZSS+QB2YgGw9Aih7UbAPrLX1/yAqLwoQfuvfP2v5oIMIuumDYVPkAUMA0jAuYhw4CBWMhAB1OdgUIx12NmECIBOyENBSihgFAZIlLIGLwrAwV5IiRkG4YmgP7yN155cdFTj/1DNri1EoH6AD4oEaASmId1J1gr6GiMeVAFAs1QE0KeCRlCSkZO58oQoSLoiEY8yhK5LQer4TMtAPr9N1598bmnH3944X20AbIQdTDjTwzDKahERQFmQTYCETAPmzKQFRiJmYG9IDAU62ao52KEMEAKrVposYSJoamGz7YCwCB4afEzTzzy0P1mAyUBGhFhKB+wECoEJ55wPFoxhUHlBBsHakZjME69IAYeCDRDIQQvSC+HvJstGd0PTSl0U2gVQ8TwuXYA/TeXvvz8s08++o8H2Aa3QgTXQwRoxMsdwblnoxOzCohAeZidkNNAVmAcsBYwD8aNtcORz2k5EDIDj0VFQjcEuyU5G5kK0RCFI3JX1ilENXy+A0D/rddAgEFAGzALWQfXMAzNB0zDiADDQPuw5gTbiLQC46BgoCdFM0NNCO4GRYLKoVBC5QeXQshGSaFJQZbowNAFAARQBk8hCGiDBchCEwEakSJQFKgTJ06wUjxRCMow8GLUTqYVhsfAu0FuKCFYPVR+cCn4CZGksEIU1ukE0F/2+iuIQgTBA3+/i1mIVSQRVD5AFEw+c9LphuBXJ53IYaAwKGWgfUQrtDPwYuAjAgKhxQ0DIJSpEA2RY0EdkavStBDF0A1ABBCFj7IPOQmyCNwHXAUNBKoEq0WfBiYDJiLvpVYdWCCwGYIZJAS5IUVCtkOhhAChHgstFKrhZBS+OAAABgHK4NknH3sYQXCXsrAQASuRCFAIUQVeCUkFPo8oA1rB40C1UGUin9ftZMgMfCMoFuGGARA8FMJWKKQwmMKXBgEgAUahgoA2mH/znNnXX/eXGVejEaddxkrEKmAhVAhOhhGYhzaO8jSQDJiIbgWrhdwLOpoKBl6PvpghhBQJKIe6EjwUBkmhk8K6AwH0WYcvLHr6cQYBbXDrPKyiWdfOvAazSH2AdaxtSASnKQ5/lRFwI6d1pJWsaylaIepAr6rOIJhBQijcgEioQ8ALW4CQpNAwRBuF9YYAAAJLXkAUIghkA2ShRIBGtDCEDy44j/MYnZgR4E6SCjICOxSiDEIcBB3weu4UQnBDN4SaHzKEXBE1Cl8eCgDr8MXnnkEQoA/v5iRwEVQ+8CgoEWgbpUpwJ2QZZCukSNRU5kaiDgoGnoqFECwSBkOgH7qlUFFYf0gAIPDKi4sRBG4D7EKsIiSBiYC7iFHghYBxOOHUX5/y3786Ga3oKshO0EqmDDwRrRl9HnQxiPWoRIAQLBKQi3UIXg9dfijDURS+MjQA1uFLz2MTPWI2QBaiEJkEEgF2EU4kRgHSELOgQFA6wXqRKxlp4ImodaBI9JOppoM8FZWKSQgGQd3gDKpgDBDoh1YpVIYYMwwAIIAyWMQgkA2QhbfMzSKwPrAoUCEYAjyZSAURgTmBvegyMCsoDjoZ5HasdhKEkGKxcEMJwZOxAaEWC8MB0F/2BsrAgoBtcMcCFmISAcPwsilcx0pDdCLGYWoEzsOch9YJCsRKBtYKvpD8XLCbyfMgh6LMkITQ5YYmhOiHIhVkiK8OCwAGwVJFIYOAbaAsTCLAKJAPPApQCB0IPAzohLoMqjhoMsihqHasC6ElEhyCvyhQCYTQLoUNhgegv/xNlAGjEH3INsB5hEJ0EdgomHqpogBpSAQYhw0VHGO1KCcwECEDvqRqI2ok6mjU5cxqzDrIxeCBAAZBCNENVS4OASFL4WvDBIBJ9BqjEEGAPnQbzEtJgGVY+QBpiAuhDUG6lLSO6ARLg8QAt4LHQZ1BLkcPhGQGXU6WCIUQymBsU0KOxq8PGwDrkASwCGQDTIJKBJhFCEP2AXyAKGAhcBkVKshhoIHIZ9RKBihGJaKswMcDXc5BByWDwgyohmFBYD00/PCN4QPov4UyYBQiCB68TzZAIboI0IgIQ94HtgqwDRsIqjxUGNAJTRm4FfSAwjjIDPJIUijKDEEIsR+LlcDVHOzQgPDNFQCgOnzhOQUBbHDPncjCLALMIoUh+sCiQAgwC0wFaRuZCiwM6AQPREsDyUCt4OuAVhiSQUrFuhCqhqxOBz4t6dU9K+FbKwKAdcgoVBCwDSwLTQSYRQpD+ECVyG3IO7EVgW1k1qI7IaSBWyHEQZOBikGBkMyAVEQi1CFgKnkudkHYcIUAGAEFgdkAj2W0geoA21hhCB9YFDAN1YktKrA8ZBi4E3Ip5FYIcRB0kIdiwaA0gydClYsDIHx7xQCwDhmFDAL0YWUDbYKZMxSG2EWqRKWhCqFFBXo8Uy26E0IplFawSGwyUDkWgWD1WBdCFQksh7oSNlpBAEYAUchFsNBtoCzkJpAI+FJgPuCNZIXQYgTbh0TgTrB5pDRQMWYrcCWyFoZgADM0hYCR4ELwSKhD2HhFAeA/LGUZYBNhEaAP78Uy9izEiYgDiWGoPoAPeCPxsYCzoKGCKg/dCdaLKQ2CFRiJQzFIgQAGLUIYAGHFAYjAi4u5CBAEsAGzMIiAYchx7JUIBEzDFgR2JTAPWYsWiE0Z6BUtIKjrQAMhBUJqx4JBNRLcDYyEpIRNVgIACKAMPAgWPuAEVIgSARtRPrBKvJCXcisCGwbMQ3eCBWJKAz0c5IEUGOxRdaMysc7AzFBAwP1YuiFDWBkAKoOXnlcQRBtwFd0wC08lEoH5AJVoUeAITp+odei7QAhSHkYnpFLQ4wnfk/moPgwGKRTrDKp+DG4QhJUCAAIoA26iJzCMgw1wH7kIuAyTDywKpAKLAp5JhkDnsvKQ46h0gtIgy6CbgR9N0EEqBgRCNEOxEVwIdANzcfOVA9BfhjpkFDII0Aa0gbIwicDDEH1AH/BAYCGETkwI+HR2wvFE4GFg0yAFot5OKINohSIStZXFQGO5ZNAhhAhhJQGwDl99WVFofag2YBYGESgMVYlYx0IQo6BAwErwMDAn2KHgB6O/odWskKuxySCEYsWgEkJYSt9ZWQAg8PqrikIsgsoGPA48CSQC94EqsZGGbQiiE1plULOCz4NWBggEM0MFwQazJwKFsOVKA+AgWLpEUfgEbIAgsElg03j29ZxFCEOMAvqAV2KZhtrHjkCvh2xF5qHVYnKCetHTIFlhGAxSMbQwKIWw1SoA6L/1xlJFoQcBRxEnQSEChCFGgfmAz4aKgjALWhDkMEjTQL3INKgnYqgFzYNCB10MqnqkELZeFQCsQ0bhoqefDDbALtR95CKwUcBdpEO5C4HekEMehk6QE0IaWCIGGfhKbGUQQxHNUJnBhbDNKgFQHTIKeRooCFIW3nLzHNsEM3EjIgzNBykKWAgNFUQEpRMUiEEGLVYYggFCsW4GF8K2qwaAdYgy4CZiEOA6uvduLmNkIY/kIILgg9SJrQjYil4JKQzkhAEyyAtJtVDoIA1F6KDOwI+G7VYRgJUBohCLABeyjyJMgtvmJxFcOzOFofsAaZijIJ8IlgVUgSOwZZCcoMcjPSLyMZlpUJOBx4FXI55QUh50MXAzbL+qAPrLVQbaRMEGysIsAjQiwxDjWFHAPsgIzkqHohDo+yQg8EqwM0EXsx6PiIBp4Ecz0oADKceBLyRVY8kgjSTXQdWOO6wyABFAGTAIkg14ICoLlQS8kiUCjgKfhgWCM/1Wzgg4D20fhjBwJ3gvNmTgx8JABraWCzPsuOoAMAhYBopCEdBtgFcCFmIlghSGfDrmOi4RTLLnggEIdCfUZNCwgseBIrFdB3UGO40EAJaBopBBoDbwScBCTCLALGIjZh8MA4HlYQgDrSM+JbfJIFtBcTBcBt8dEQAqA65CI6A2sPOIWTj3JtbBdX9RI+pIVBRkArkTSxVwHpYI9HymZ1QiSGlQyMDjoIrEoXTwvZEBAAK4DGIQ4KUIj2UsxFIECkNEQc0HaRbkgcxrOSJIYZCdkHsxp0EeSDEOUjU2MtG98P0RAsA65C72KOQosklghViJgOdBuw98FtQRlHmoWvT3sw4ZuBUUB4rEgQx2HikAVgbcRB4EHEX33JWyMCcBG1EXkldiNgK3ob0cDkCgWsxO8IVovQgnhHEQrYA46Gawy4gBAAGVgRPgLJQNuAtDErARLQxDJYZZoGUUEfg2UisqDzUQgxNa0sDHgaxQRCJmor5mwnfveEPBRho7duQAsA5fi0GQbJALEdcBr2QPw3ofpDvRxiG/UmQpIguAoMxDPaJyHeVpkAMxJKKsUMVBqoUag3EjCUB1mKJQffjAfXgsy1noSSAR2IVU94EXgsZhJwLlod7SiYDToJEGeSfLCikO2hjsOqIAqjLIfeg2QBZqFWUReBjKB8UwsjtxAAI9nnkY5JFcIMgykBUKBooDVGPWwW4jC4AEuAotCHAfBhuoECkCvJzztYhhGPug2obqxIiAT8jJCI0wGEoGlRUQB6kWMoPdRxiA1aEI6DRAH9IGfCpSIWIaVyKwC6kQQTqS1Ik8EdwIQGDDILWi52GXE8pxUDVjikTUgjMYaQAsgyoKEQRqA74SKAuxirIIrBEhggLBBedbGg5GoPfDHAYxEItS8GJsWsGqkQxGHEAkwNMAfchR5FmIQkwi4DZ2HxiBEAX2ZMRZ0KkCRxDCoBGILgNPxGSFEInUwcgDyAQUBLgPow10IQYR2JkcRZCiQIXQjUBXgudhqMXcCfVi1E5ODPbmt2yIA+pgFADg/5YnRyGDAPchR5FsoOMA95ElgR4KPAyjD2wYZQS8lWtZkIaBXtL5lM4wMCdkBnw6ye9HkkFhBWcwKgAyAZ4GNRtYIZoI8FSSfYAkiKvA0lCdyGXUgcAroRYGGUGXDFIzksHoADACtokQBOpDbwNkIQpRIrgRwzA2oosgPZfYqxk7sQVB1Yo5DEonhHnkMlAiFlZAHOw9SgByECzmcRRtoF3IVdQUQYgCv5FUCG0I0jBQK+rLVX672uqEUgaFFTCU9xktAIkANxGCQH2oNtAkQBYWIvA3QxAIUWCPZiyEtIyiERoIwjIIYZAnYpsMYIV9Rw2AEdAqTEHgowiTwC5EPpdhGNqBlJahCKTnEqWhOpGzwLKA/4XFhFPTnaR3dK8EfsFc1WKxEF0GVTEmK+w3egD6y70M+EpCG6AP1QaaBHwy5SoCAkuCPAryLrKXU6UhC2EIBDkPW53g80gy0KmQrLD/KAJIdYh3IgSB+tBHEWzALOQqSiIoGjH7wKJAaegPJgNUoK+UTAVFGNRLQTJIiXjAqAJQGfCJIAUBryO0ASYBspCFOEAE9nXqxTaMmIYVgjPwYjLxNPyHNjKCjgQNAyKoL4PghDYZHDi6APrL7DJAFCoIog1wHqkQgwjyKEh9YOtYaTgMBLkSWmQwPj0bxDSADA4aZQBVFHoQ8DpCG+BA9CxMIuDLeTWLQh8oCnIaohB8H7epoBtBPhRqMjh4tAGIAJ8IEIUMAl5H0QYqxE4R2HeJlygKmIapE+1KqiHQNjoJ3yU087Dei5UMfjzqAECAlwFXIRcBZ6HaAAdiykKtIjViEAEfS0IlKgqYhj4LhkKQxlGtEzwQKxkcMvoArAwsClMQRBuoEGMdhCRIlah1zChwBOzEOgK9mejbFFOB5WFtILoTfB7xWno7ALAM8EiCd6IqCGADHIiYBMpCm8bVLCpGgfkgR4GpYKUQZCfoUJAMDntbAIAAnolqQYBR5DawQmwVgfvAKpFRwDT0QhikgqIVXQX5Yo4yOPztAZCiMAaB2cAnga8iDkNu46IP3AeqREaBp6GNw6YRdCTwqwQ6wYeBNnJeRz4NTAZvEwASsCjkIrD7kG3gNtBxgPuIz2UFAXs5Tk8FjIISATtR72ZVI/iXKQlBZlBdi+4EBeJP3y4AVgaIwhQE6kO3ASdBWkV1BHg7jz5gFHgaeieuKILSCePfNgB2G3kUahGoDzmKaAM7DhoiSM+m00MlehRUnZgOxVIFvpAblVA64Yj/BQAA//8grTFYAAAMPUlEQVTlm+eOVdcShP3CDAjDAIYBRLZBZGyBSQIHrOsoRzleXSfZBJFEEthYDCCSfEGEEUHH3dVh9Vp7nwH5x5wd5g2m1PVVda99XhrM3N/Tx48e3r/3/zu3b964dvXKX3/+cenC+XNnTp86cfzY0cO///brLz//+L///vD9d99+8/VXX37x+WeffvLxRx9+8P5/3nvv0LvvvP3WwYMH9u/bu3fP7jff3LXzjTde37F9+7atW7ds3rxp48YN69e/9uqr69atXbNm9epVK1euWLF8+bJlS5dOLFmyePErryxatHDhggXj4/Pnz5837+WX586dM2f27NljY7NmzXpp5v7/weDp4ylW4O/bt25cvzr51+U/Ll08f+7s6VMnTxw7euTw76TATyxBVEAlOPQuJDjAEuwhCXaRBK9PI8GqJMGES6AaiATQYGxsbEYFGDx9MvXwwb27qsCVy39eunjh3Nkzp0/SEJACNARQoDIENAU8BDQFB/azBLtJgp0iwbZtW7ds2bypMgWZBK6BjAFLYGMwswIMnj2ZesQK3Ll18/q1SbbBxWSDI7BBPgTJB4eSD4IEO3Zsdwk25EaYXgJ1wpwZFoAUePzowf27DoLSBr/9KjYohgAoiD4IKPh3EigM5s60AINnjkIFQbSBspCHwBQIMCx8oCggGk4nwUrDYcZDABFOmHEBWIGEQrLBZbfBSUqDwEKTQOJA8kB8wCjYpz4oaLhpY8UIdRI4D+fNvAASBg4Cz0OkwXFWgAPxpx89EFMiciQSCWIkJhpaJkKC10IoSioiFHUKYiyOQgAOA0GhNgIGgacBSSAKFJ0gKwWcB6EVVDJxw/qqBFwMJiYyJ4yPj49EAAkDRSE1gmgDqQR5K0q1SGCIPLBITMUIKLBmNEwC0iCWowWjEQBh4J1I8pBrodjAemHZCbQZ5j5IKAg0RDl8IQkWjkgADwNpBAQCtwGaMUgQAjF141COgw+8G4ZAYBzWGyFMwaJRCSBhoCik1YCKMechdgPqhYmFGQm0FgGG0QfaCgwFWTms4FCWBOPhyATwMEAnUhDABmdoN0Ag5iz0IZD1IMsD8oGgwCSgJSn14+kkWDxCASQMgELqRAoCSYNkA92PvBPojpiWRPVBgQJk4otIsGSUAiAMFIW0GjAIog10PUok8C1ZEpFhaD7QSBQUGA0RCLolDZuCiZEKkMKAliMFAbajs26DtB/ZEGg3BgyjD9KtAMeClIlaDuslWDpaAQIKqRMxCPhMwkcCupNoM85IYEMgiejHEvKBtuOAgheSYNmIBXAFCIUKAuShpQGWg0wCZqEMAWCIUqCnAlkQggR0MkIg8LkAK0J1CpaPWgAKA+7FhEK6kjAIOA/VBriTVAJRh0AS0WFI+4FWQzmX4GiGk5FKQGczPheUEqwYvQCqAF3KFARcjN0GfipiFqZOIAsSYGilQFckQUGgoQaClsNSgpUNEMBQSHciA8FzbBCHwGFY6wMEwnQSrGqCAKIAtUIFQcpDZqGUIk+DYkv2IdA9WbbEvBgpDbUW5EZY3QgBFIUFCKINShLo5Ry1yGGYTgXBB+iGwyVY0wwBoICjkBuB5KHvBlka2BDIloxEZBhyKRAfyO24SkNvRjYFa9eubYgApADCgFHIIOBirLUQlUCvBDEQyyGwUiB5ECIxBkJFgnVNEUDikHoxo5AbAUCAtyNRQO6FroA+IKUhYBhqOfY8CChQGnot8FBsjgAZCtEIJA+rNvDtQIYAtYhhONQHeEUZIkGDBGAF6OFIUSgg0Dx87hBwLWIYqg8IBdyL4ANDgdLQM5G3JGJBkwSwMNBOpCCot4Gdy6pDkHxgEtCtAMUoDwR5TtvQKAEsDBIIUIxxKbJz4ZHDdjenXigkkFNJGIJqHmBBUBp6JkKCZgkgYcAo5E4kIMB+yAdTXhCzVqSP6RgCdGNORIVhXSQqCnRD4JsRSdAwATgM6CsCboW8HMmGzLtBqUARBxgCrkUBhtKLzAdAQU5DSNA4ATQMGIW8HHke8sH0+UMQfMCfVVgvslagKPBAIAmaJ4CFAToRGgEeTgQEuQ30YBhIEIaAYBgk4M8K9HKqXxbswLVgawMFyFGoIEhHAgWBvyHqkuwkCEMgR0OLxCgBfWHDj8p0MGmiAAUKEwjqbKCtCBdDuxYpDFMpKFqB05AkaKQAqgBQqCAIeRhsYEuyXEp4CNCNEwwrPkA7xmdWfDqlKWimABYGQCGWI94Ps+3oeFoOhgyBNsPgA9sSvRiRBE0VIEdhAkGVhRqI+RAoDGMpqEMBTUFjBYACdCLQTmQbMn9JEPPQWCjVmEmAexktSApDWRJDHqQFgT+229lcASQM0AqtEaQzCRpB6oX6hSEuJUaCNARyLLFeBB84CnY1WIAMhQEE5RDYcpAPAXfjKgwLHxANmywAK8C9mD8u5dVAN2Q+mgcb2LVMWhEPAb405TigIUhrcupFaMfaCnY3WgCEAZ8IZD1EMc7yMK1HGojYj4wEaQjkUmB5gIc0RcGehgsQUCjLEe6leDkJQ3BUj8b5EIRaJOciKwXwgaJgb9MFyFA4BAS2I0sglkNQwNDyQH2wr/ECGAqlE8UNWUCQeqEcStCKjAQ6BDERCx/sb74ACYU4GAsIuBbWshCBWDMEAsNQCtQHB1ogABQQFOqVpAoCqwRg4ZAhkHMRSkHywcE2CCBhIK3QXg2wGugMoBUxCISFlSHIEhFDkHzwVjsEkDCQSxkaAX9IULGBrEcSiNyKAgmKREx58HZLBNAwSJ2oqkB2KEEg8n6knYCGgN9PQAIrBfDBO20RwMMgLUdxBvxcKL0QgVgdApOA35DwmEpXw9YIkKFQnw/FBTENpBIgEOMQ6ILk6wGGAD441B4BRIGEwpo81GYMFj5/CCQPWiSAhsFQFJoNAgs5EJUE1SEQH7RKgITCSidKC6JUAhxKOBADCfhUEnZE8UG7BIgo1A25yENtxmCht6I0BN6NrRl+0DIBShSWIFAbJBZaK9JOIHfjAMMP2yaAolAvZXg+9BlwG0glcBbmJCh80DoBTIGyE4XtSGwAFnogpmKYD8HH7RNgYL2YD8YCgqwW6s04sZADcegQfNJGAaooDArouVAqgbOQW1HtEHzaSgGGotCPBLIggoUxELM4QCJ+1k4BHATRBWE3EBskFnIg1g/B5y0VwBWoBUG0gbNQW1ExBF+0VQDvxVUF7FaWXo8sEGuG4Mv2CkBD8HgKzyZZGPiZJNiAWciBWDMEX7VYgBoUVtIAlcBZqIEY4+DrNgswDQjUBtKMUQnYBjVD8E2rBRiqgNVC2ACVgFnIgVgOwbftFqBeAc/D8HTCNtAh4ED0O8F3LRegphfzp4XxVgYboBIEFnox/L71AmQozFYDqYXyhso2MBZqK5Ih+KH9AtTbYNKeDWADrwTVIeiAALUKDLFBYKGSoAsCVBXwQ1GwgVeCFIhMgk4IUCiQHs+0FlZsoIHIQ9ANASgM6HOiSjGupIGxMAxBVwSoU0DzsLAB90JlIS/JnRGgqoCBQGqh24ArgbKQq3F3BCgUcBCEUuTNWHshV+MOCRAUCIcizUNsRyhFnAZqA96PuiRAHQq1GCcbeDOW5eBwtwQIQyBXEvnV0eQV5CHe0dkGcQg6JkChgIFA8tBtwM1YWXi0awJEBfxUFvOQ04BtoJXgWOcEcAX4C2N9ORIQ1NrgePcEgAJZK1QQIA9LG5zooABlGCgIJA9RC4MNTnZSALcBu8AeUAUEnIcxDU51U4CggIFAinHFBqc7KoApgB9b8AzopxTIw2iDM10VoEShgKBqg7OdFSBHYSUPLQ3OdVgAswEVggwEmQ3Od1kAV8A6kYAAeWhpcKHTAqgC/oQcQMC1kG1wsdsC5CiMIOA85DS41HEBBs/CtTRuyAwC2KDrAoQw0OUogQA26L4AhkLrRAAB9kPYoAcC5CgUEKAYwwZ9ECBDYQAB5+GVXghACvjDkXQigICL8WQ/BEgo1E7kILjaFwFyFCYQXOuNAKKAvp8mEFzvjwARhQkEN3okQEChdCIGwc0+CZB6MVAIENzqlQAWBrIeAgS3eyZARCFAcKdvAgQUAgR/906AhEIBQf8EcBRiPbzbQwEyFN7rpQABhff7KUBC4YOeCuAofNhXAQyFj3orgKJwqscCCAj6LAAr8KTXAjAK+y0AobDnAgwG/wCbrnNMhT0MDgAAAABJRU5ErkJggg=="},8658:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(r(6976)),a=r(1199),c=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.width=r,i.height=n,i.type="LightShader",i.uLightIntensity=null,i.uRedIntensity=null,i.whitenIntensity=.5,i.rosyIntensity=.5,i.program=i.makeProgram(a.lightVS,a.lightFS),i}return i(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.whitenIntensity)||(this.whitenIntensity=e.whitenIntensity/100),isNaN(e.rosyIntensity)||(this.rosyIntensity=e.rosyIntensity/100)},t.prototype.render=function(){var e=this.gl;e.uniform1f(this.uLightIntensity,this.whitenIntensity),e.uniform1f(this.uRedIntensity,this.rosyIntensity)},t.prototype.setConstUniforms=function(){var e=this.program;if(e){var t=this.gl;t.useProgram(e),this.uLightIntensity=t.getUniformLocation(e,"intensity"),t.uniform1f(this.uLightIntensity,this.whitenIntensity),this.uRedIntensity=t.getUniformLocation(e,"rosyIntensity"),t.uniform1f(this.uRedIntensity,this.rosyIntensity);var r=t.getUniformLocation(e,"uPMVMatrix");t.uniformMatrix4fv(r,!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},t}(s.default);t.default=c},5934:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(r(6976)),u=r(1199),l=r(5263),d=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.width=r,i.height=n,i.type="LowLightShader",i.uIntensity=null,i.lowlightEnhancement=!1,i.lutTex=null,i.lutImg=null,i.lutTexIdx=10,i.uLutTex=null,i.program=i.makeProgram(u.lightEnhanceVS,u.lightEnhanceFS),i}return i(t,e),t.prototype.setEffectConfig=function(e){this.lowlightEnhancement=1===e.lowlightEnhancement},t.prototype.release=function(){this.gl.deleteTexture(this.lutTex)},t.prototype.render=function(){var e=this.gl;e.uniform1f(this.uIntensity,this.lowlightEnhancement?.6:0);var t=this,r=t.program,n=t.width,i=t.height,o=t.lutTex;if(r){var s=e.getUniformLocation(r,"texelWidth");e.uniform1f(s,1/n);var a=e.getUniformLocation(r,"texelHeight");e.uniform1f(a,1/i),e.activeTexture(e.TEXTURE0+this.lutTexIdx),e.bindTexture(e.TEXTURE_2D,o)}},t.prototype.setConstUniforms=function(){return o(this,void 0,void 0,(function(){var e,t,r,n,i,o,a,c,u,d,h=this;return s(this,(function(s){switch(s.label){case 0:return e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t=[1,1,1,0,-.344,1.772,1.402,-.714,0],r=[.298973,-.168721,.500019,.58706,-.331298,-.41873,.113967,.500019,-.081289],(n=this.program)?((i=this.gl).useProgram(n),this.uIntensity=i.getUniformLocation(n,"uIntensity"),o=i.getUniformLocation(n,"matYUVtoRGB"),i.uniformMatrix3fv(o,!1,t),a=i.getUniformLocation(n,"matRGBtoYUV"),i.uniformMatrix3fv(a,!1,r),c=i.getUniformLocation(n,"uPMVMatrix"),i.uniformMatrix4fv(c,!1,e),u=i.getUniformLocation(n,"inputImageTexture2"),d=this,[4,new Promise((function(e){var t=i.createTexture(),r=h.lutTexIdx,n=h.lutImg;n||(n=new Image),n.onload=function(){h.lutImg=n,i.activeTexture(i.TEXTURE0+r),i.bindTexture(i.TEXTURE_2D,t),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,i.LUMINANCE,i.UNSIGNED_BYTE,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.uniform1i(u,r),t&&e(t)},n.src=l.lightLut}))]):[2];case 1:return d.lutTex=s.sent(),[2]}}))}))},t}(c.default);t.default=d},1199:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lightEnhanceFS=t.lightEnhanceVS=t.mixBlurFS=t.mixBlurVS=t.diffBlurFS=t.diffBlurVS=t.borderBlurFS=t.borderBlurVS=t.sharpnessFS=t.sharpnessVS=t.lightFS=t.lightVS=void 0,t.lightVS="cerpvfvba uvtuc sybng;\nnggevohgr irp2 nGrkPbbeqvangr;\nnggevohgr irp4 nCbfvgvba;\nhavsbez zng4 hCZIZngevk;\ninelvat irp2 iGrkPbbeq;\nibvq znva() {\n    ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;\n    iGrkPbbeq = nGrkPbbeqvangr;\n}",t.lightFS="cerpvfvba uvtuc sybng;\ninelvat irp2 iGrkPbbeq;\nhavsbez fnzcyre2Q hGrkgher;\nhavsbez sybng vagrafvgl;\nhavsbez sybng ebflVagrafvgl;\nirp3 oevtugarffNaqPbagenfg(irp3 pbybe){\n  sybng v = vagrafvgl * 1.0;\n  sybng CV = 3.1415926;\n  sybng O = 0.12 * v;\n  sybng p = 0.1 * v;\n  sybng x = gna((45. + 44. * p) / 180.0 * CV);\n  pbybe = ((pbybe*255.0 - 127.5 * (1.0 - O)) * x + 127.5 * (1.0 + O)) / 255.0;\n  erghea pbybe;\n}\nibvq znva() {\n  irp4 grkgherPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);\n  grkgherPbybe = irp4(oevtugarffNaqPbagenfg(grkgherPbybe.eto), grkgherPbybe.j);\n  grkgherPbybe.e = zva(grkgherPbybe.e + 0.06 * ebflVagrafvgl, 1.0);\n  ty_SentPbybe = grkgherPbybe;\n}",t.sharpnessVS="\nnggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez sybng vzntrJvqguSnpgbe;\nhavsbez sybng vzntrUrvtugSnpgbe;\nhavsbez sybng funecarff; \ninelvat irp2 iGrkPbbeq;\ninelvat irp2 yrsgGrkgherPbbeqvangr;\ninelvat irp2 evtugGrkgherPbbeqvangr;\ninelvat irp2 gbcGrkgherPbbeqvangr;\ninelvat irp2 obggbzGrkgherPbbeqvangr;\ninelvat sybng pragreZhygvcyvre;\ninelvat sybng rqtrZhygvcyvre;\nibvq znva() {\n  ty_Cbfvgvba = nCbfvgvba;\n  irp2 jvqguFgrc = irp2(vzntrJvqguSnpgbe, 0.0);\n  irp2 urvtugFgrc = irp2(0.0, vzntrUrvtugSnpgbe);\n  iGrkPbbeq = nGrkPbbeqvangr.kl;\n  yrsgGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - jvqguFgrc;\n  evtugGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + jvqguFgrc;\n  gbcGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + urvtugFgrc;\n  obggbzGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - urvtugFgrc;\n  pragreZhygvcyvre = 1.0 + 4.0 * funecarff;\n  rqtrZhygvcyvre = funecarff;\n}\n",t.sharpnessFS="\ncerpvfvba uvtuc sybng;\ninelvat uvtuc irp2 iGrkPbbeq;\ninelvat uvtuc irp2 yrsgGrkgherPbbeqvangr;\ninelvat uvtuc irp2 evtugGrkgherPbbeqvangr;\ninelvat uvtuc irp2 gbcGrkgherPbbeqvangr;\ninelvat uvtuc irp2 obggbzGrkgherPbbeqvangr;\ninelvat uvtuc sybng pragreZhygvcyvre;\ninelvat uvtuc sybng rqtrZhygvcyvre;\nhavsbez fnzcyre2Q hGrkgher;\nibvq znva() {\n  zrqvhzc irp4 nPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);\n  zrqvhzc irp3 grkgherPbybe = nPbybe.eto;\n  zrqvhzc irp3 yrsgGrkgherPbybe = grkgher2Q(hGrkgher, yrsgGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 evtugGrkgherPbybe = grkgher2Q(hGrkgher, evtugGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 gbcGrkgherPbybe = grkgher2Q(hGrkgher, gbcGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 obggbzGrkgherPbybe = grkgher2Q(hGrkgher, obggbzGrkgherPbbeqvangr).eto;\n  ty_SentPbybe = irp4((grkgherPbybe * pragreZhygvcyvre - (yrsgGrkgherPbybe * rqtrZhygvcyvre + evtugGrkgherPbybe * rqtrZhygvcyvre + gbcGrkgherPbybe * rqtrZhygvcyvre + obggbzGrkgherPbybe * rqtrZhygvcyvre)), nPbybe.n);\n}",t.borderBlurVS="nggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez uvtuc sybng grkOyheJvqguBssfrg;\nhavsbez uvtuc sybng grkOyheUrvtugBssfrg;\ninelvat irp2 i_grkpbbeq0;\ninelvat irp4 grkgherFuvsg_1;\ninelvat irp4 grkgherFuvsg_2;\ninelvat irp4 grkgherFuvsg_3;\ninelvat irp4 grkgherFuvsg_4;\nibvq znva()\n{\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n\n  irp2 fvatyrFgrcBssfrg = irp2(grkOyheJvqguBssfrg, grkOyheUrvtugBssfrg)*2.5;\n\n  grkgherFuvsg_1 = irp4(nGrkPbbeqvangr.kl - fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + fvatyrFgrcBssfrg);\n  grkgherFuvsg_2 = irp4(nGrkPbbeqvangr.kl - 2.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 2.0 * fvatyrFgrcBssfrg);\n  grkgherFuvsg_3 = irp4(nGrkPbbeqvangr.kl - 3.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 3.0 * fvatyrFgrcBssfrg);\n  grkgherFuvsg_4 = irp4(nGrkPbbeqvangr.kl - 4.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 4.0 * fvatyrFgrcBssfrg);\n}",t.borderBlurFS="cerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\ninelvat uvtuc irp4 grkgherFuvsg_1;\ninelvat uvtuc irp4 grkgherFuvsg_2;\ninelvat uvtuc irp4 grkgherFuvsg_3;\ninelvat uvtuc irp4 grkgherFuvsg_4;\nibvq znva(ibvq) { \n  zrqvhzc irp3 fhz = grkgher2Q(hGrkgher, i_grkpbbeq0).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.mj).eto;\n  ty_SentPbybe = irp4(fhz * 0.1111, 1.0); \n}",t.diffBlurVS="nggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez zng4 hCZIZngevk;\ninelvat irp2 i_grkpbbeq0;\nibvq znva()\n{\n  // ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n}",t.diffBlurFS="cerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\nhavsbez fnzcyre2Q oyheGrkgher;\nibvq znva(ibvq) {\n  irp4 vPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);\n  irp4 zrnaPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);\n  irp4 qvssPbybe = vPbybe - zrnaPbybe;\n  qvssPbybe.e = zva(qvssPbybe.e * 50.0 * qvssPbybe.e, 1.0);\n  qvssPbybe.t = zva(qvssPbybe.t * 50.0 * qvssPbybe.t, 1.0);\n  qvssPbybe.o = zva(qvssPbybe.o * 50.0 * qvssPbybe.o, 1.0);\n  ty_SentPbybe = irp4(qvssPbybe.eto, 1.0);\n}",t.mixBlurVS="\nnggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\ninelvat irp2 i_grkpbbeq0;\nhavsbez sybng jvqguBssfrg;\nhavsbez sybng urvtugBssfrg;\ninelvat irp2 grkgherFuvsg_1;\ninelvat irp2 grkgherFuvsg_2;\ninelvat irp2 grkgherFuvsg_3;\ninelvat irp2 grkgherFuvsg_4;\nibvq znva()\n{\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n  grkgherFuvsg_1 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,urvtugBssfrg));\n  grkgherFuvsg_2 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,-urvtugBssfrg));\n  grkgherFuvsg_3 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,urvtugBssfrg));\n  grkgherFuvsg_4 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,-urvtugBssfrg));\n}\n",t.mixBlurFS="\ncerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\nhavsbez fnzcyre2Q oyheGrkgher;\nhavsbez fnzcyre2Q oyheQvssGrkgher;\nhavsbez ybjc sybng oyheNycun;\nibvq znva(ibvq) {\n  ybjc irp4 vPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);\n  ybjc irp4 zrnaPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);\n  ybjc irp4 inePbybe = grkgher2Q(oyheQvssGrkgher, i_grkpbbeq0);\n  ybjc sybng nycun = oyheNycun * 1.0;\n  ybjc sybng gurgn = 0.1;\n  zrqvhzc sybng c = pynzc((zva(vPbybe.e, zrnaPbybe.e - 0.1) - 0.2) * 4.0, 0.0, 1.0);\n  zrqvhzc sybng zrnaIne = znk(znk(inePbybe.e, inePbybe.t), inePbybe.o);\n  zrqvhzc sybng xZva = 0.1;\n  ybjc irp3 erfhygPbybe;\n  xZva = (1.0 - zrnaIne / (zrnaIne + gurgn)) * c * nycun;\n  erfhygPbybe = zvk(vPbybe.eto, zrnaPbybe.eto, xZva);\n  erfhygPbybe = zvk(vPbybe.eto, erfhygPbybe, zva(1.0,nycun));\n  ty_SentPbybe = irp4(erfhygPbybe,1.0);\n}",t.lightEnhanceVS="\nnggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez sybng grkryJvqgu;\nhavsbez sybng grkryUrvtug;\ninelvat irp2 grkgherPbbeqvangr[9];\ninelvat irp2 grkgherPbbeqvangr2;\nhavsbez zng4 hCZIZngevk;\nibvq znva(){\n    ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;\n    grkgherPbbeqvangr2 = nGrkPbbeqvangr.kl;\n    grkgherPbbeqvangr[0] = nGrkPbbeqvangr.kl;\n    irp2 jvqguFgrc = irp2(grkryJvqgu, 0.0);\n    irp2 urvtugFgrc = irp2(0.0, grkryUrvtug);\n    irp2 jvqguUrvtugFgrc = irp2(grkryJvqgu, grkryUrvtug);\n    irp2 jvqguArtngvirUrvtugFgrc = irp2(grkryJvqgu, -grkryUrvtug);\n    \n    grkgherPbbeqvangr[0] = nGrkPbbeqvangr.kl;\n    grkgherPbbeqvangr[1] = nGrkPbbeqvangr.kl - jvqguFgrc;\n    grkgherPbbeqvangr[2] = nGrkPbbeqvangr.kl + jvqguFgrc;\n    \n    grkgherPbbeqvangr[3] = nGrkPbbeqvangr.kl - urvtugFgrc;\n    grkgherPbbeqvangr[4] = nGrkPbbeqvangr.kl - jvqguUrvtugFgrc;\n    grkgherPbbeqvangr[5] = nGrkPbbeqvangr.kl + jvqguArtngvirUrvtugFgrc;\n    \n    grkgherPbbeqvangr[6] = nGrkPbbeqvangr.kl + urvtugFgrc;\n    grkgherPbbeqvangr[7] = nGrkPbbeqvangr.kl - jvqguArtngvirUrvtugFgrc;\n    grkgherPbbeqvangr[8] = nGrkPbbeqvangr.kl + jvqguUrvtugFgrc;\n}\n",t.lightEnhanceFS="cerpvfvba uvtuc sybng;\ninelvat uvtuc irp2 grkgherPbbeqvangr[9];\ninelvat uvtuc irp2 grkgherPbbeqvangr2;\nhavsbez fnzcyre2Q hGrkgher;\nhavsbez fnzcyre2Q vachgVzntrGrkgher2;\nhavsbez uvtuc zng3 zngLHIgbETO;\nhavsbez uvtuc zng3 zngETOgbLHI;\nhavsbez sybng hVagrafvgl;\npbafg irp3 pbzcIrp = irp3(-0.0/255.0, -128.0/255.0, -128.0/255.0);\nirp4 eto2lhi(irp4 vachgETO) {\n    irp3 bhgchgLHI;\n    bhgchgLHI = zngETOgbLHI * vachgETO.eto;\n    bhgchgLHI -= pbzcIrp;\n    erghea irp4(pynzc(bhgchgLHI,\n                        irp3(0.0, 0.0, 0.0),\n                        irp3(1.0, 1.0, 1.0)),\n                        vachgETO.n);\n}\nirp2 fnghengvba(irp2 bet, sybng snpgbe) {\n    irp2 zbq = irp2((bet.k - 128.0/255.0) * snpgbe + 128.0/255.0,\n                    (bet.l - 128.0/255.0) * snpgbe + 128.0/255.0);\n    erghea pynzc(zbq, irp2(0.0, 0.0), irp2(1.0, 1.0));\n}\nirp4 lhi2eto(irp4 vachgLHI) {\n    irp3 bhgchgETO;\n    vachgLHI.eto += pbzcIrp;\n    bhgchgETO = zngLHIgbETO * vachgLHI.eto;\n    erghea irp4(pynzc(bhgchgETO,\n                        irp3(0.0, 0.0, 0.0),\n                        irp3(1.0, 1.0, 1.0)),\n                        vachgLHI.n);\n}\nibvq znva(){\n    irp4 lhi[9];\n    sbe(vag v = 0; v < 9; v++){\n        lhi[v] = eto2lhi(grkgher2Q(hGrkgher, grkgherPbbeqvangr[v]));\n    }\n    sybng fzbbguL = 0.0;\n    fzbbguL += 1.0*lhi[4].e + 2.0*lhi[3].e + 1.0*lhi[5].e;\n    fzbbguL += 2.0*lhi[1].e + 4.0*lhi[0].e + 2.0*lhi[2].e;\n    fzbbguL += 1.0*lhi[7].e + 2.0*lhi[6].e + 1.0*lhi[8].e;\n    fzbbguL = fzbbguL / 16.0;\n    sybng bhgchgL = grkgher2Q(vachgVzntrGrkgher2, irp2(fzbbguL, lhi[0].e)).e;\n    irp3 arjLHI = irp3(zvk(fzbbguL, bhgchgL, hVagrafvgl), lhi[0].to);\n    ty_SentPbybe = lhi2eto(irp4(arjLHI.eto, lhi[0].n));\n}\n"},8302:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(r(6976)),a=r(1199),c=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.width=r,i.height=n,i.type="SharpnessShader",i.uIntensity=null,i.sharpenIntensity=.5,i.program=i.makeProgram(a.sharpnessVS,a.sharpnessFS),i}return i(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.sharpenIntensity)||(this.sharpenIntensity=e.sharpenIntensity/100)},t.prototype.render=function(){this.gl.uniform1f(this.uIntensity,.5*this.sharpenIntensity)},t.prototype.resetResolution=function(e,t){this.width=e||this.width,this.height=t||this.height,this.setConstUniforms()},t.prototype.setConstUniforms=function(){var e=this.width,t=this.height,r=this.program;if(r){var n=this.gl;n.useProgram(r);var i=n.getUniformLocation(r,"imageWidthFactor");n.uniform1f(i,1/e);var o=n.getUniformLocation(r,"imageHeightFactor");n.uniform1f(o,1/t),this.uIntensity=n.getUniformLocation(r,"sharpness"),n.uniform1f(this.uIntensity,.5*this.sharpenIntensity)}},t}(s.default);t.default=c},954:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLISH_SET_BEAUTY_EFFECT=void 0;var s=o(r(836)),a=o(r(3048)),c=r(3471),u=c.errorCodeList.VIDEO_TRACK_NOT_READABLE,l=c.errorCodeList.VIDEO_TRACK_OVERLOAD,d={errorCode:u.code,extendedData:u.message},h={errorCode:l.code,extendedData:l.message};t.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe.1";var p=function(){function e(e,t){var r=this;this.logger=e,this.kind="video",this._enabled=!1,this.lastRenderTime=0,this.stateFlag={base:!1,lowLight:!1},this.isStarting=!1,this.animationFrameId=0,this.backgroundLoop=null,this.eventHandler={visibilitychange:function(){document.hidden?function e(){return n(r,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.backgroundLoop=window.setTimeout(e,Math.floor(1e3/this.fps)),!document.hidden&&this.backgroundLoop?(clearTimeout(this.backgroundLoop),this.backgroundLoop=null,[2]):[4,this.renderAFrame()];case 1:return t.sent(),[2]}}))}))}():r.backgroundLoop&&(clearTimeout(r.backgroundLoop),r.backgroundLoop=null)}},this.setInput(t,!0),this.fps=15,this.detector=new s.default(e),this.backgroundLoop&&clearTimeout(this.backgroundLoop),this.backgroundLoop=null,this.lastRenderTime=0,this.manager=new a.default(e),this.manager.onRenderError=function(e){1103072===e.errorCode&&r.stopEffect(),r.onError(e)}}return Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){return this._output},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.manager.effectConfig||{}},enumerable:!1,configurable:!0}),e.prototype.setBeautyEffectOptions=function(e,r){return void 0===r&&(r={}),n(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e&&this.manager.setEffectConfig(r),this.enabled===e?[3,6]:(this.manager.setEnableBeauty(e),this.enabled!==e&&this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" effect enabled "+e+"; options: "+JSON.stringify(r)),this.enabled=e,e?this.input?[4,this.startEffect()]:[3,2]:[3,3]);case 1:n.sent(),n.label=2;case 2:return[3,5];case 3:return[4,this.stopEffect()];case 4:n.sent(),n.label=5;case 5:n.label=6;case 6:return[2]}}))}))},e.prototype.startEffect=function(){return n(this,void 0,void 0,(function(){var e,r,o=this;return i(this,(function(s){switch(s.label){case 0:return this.isStarting=!0,this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" call start effect"),this.input?this.input&&this.output&&this.input!==this.output?(this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" video effect is already enabled"),[2]):[4,this.startWebGLProcessor().catch((function(e){throw o.stopEffect(),e}))]:(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" start effect failed, input track is null"),[2]);case 1:return e=s.sent(),[4,this.updateOutput(e)];case 2:return s.sent(),this.enabled=!0,this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" start effect success"),this.detector.startRecordBeautyEffectOutput(this.fps).then((function(e){!e.result&&o.onError&&o.onError(h,{targetFPS:e.targetFPS,currentFPS:e.currentFPS})})),r=function(){return n(o,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.enabled&&(this.animationFrameId=requestAnimationFrame(r)),[4,this.renderAFrame()];case 1:return e.sent(),[2]}}))}))},this.animationFrameId=requestAnimationFrame(r),document.addEventListener("visibilitychange",this.eventHandler.visibilitychange,!1),this.isStarting=!1,[2]}}))}))},e.prototype.renderAFrame=function(){return n(this,void 0,void 0,(function(){var e,t,r;return i(this,(function(n){switch(n.label){case 0:return e=Date.now(),t=1e3/this.fps,(r=this.lastRenderTime?e-this.lastRenderTime:t)>=t?(this.lastRenderTime=e-(r-t),this.videoEl&&this.videoEl.paused&&this.videoEl.play(),this.enabled&&this.videoEl?this.videoEl.videoWidth>6&&this.videoEl.videoHeight>6?[4,this.manager.render(this.videoEl)]:[3,2]:[3,3]):[3,3];case 1:n.sent(),n.label=2;case 2:this.output&&this.output.requestFrame&&this.output.requestFrame(),this.detector.addFrame(),n.label=3;case 3:return[2]}}))}))},e.prototype.stopEffect=function(){return n(this,void 0,void 0,(function(){var e=this;return i(this,(function(r){switch(r.label){case 0:return this.enabled=!1,this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" call stop effect"),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0),this.detector.stopRecordBeautyEffectOutput(),this.manager.release(),[4,this.updateOutput()];case 1:return r.sent(),void 0===this.removeDomTimer&&(this.removeDomTimer=window.setTimeout((function(){!1===e.enabled&&e.destroy()}),18e4)),document.removeEventListener("visibilitychange",this.eventHandler.visibilitychange),[2]}}))}))},e.prototype.destroy=function(){this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" destroy hidden elements"),this.canvasEl&&this.canvasEl.remove(),this.videoEl&&this.videoEl.remove(),this.videoEl=this.canvasEl=void 0,this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0)},e.prototype.startWebGLProcessor=function(){return n(this,void 0,void 0,(function(){var e,r,n,o,s=this;return i(this,(function(i){switch(i.label){case 0:return this.input?(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" start webgl processor"),this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0),this.canvasEl&&this.videoEl?[3,2]:(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" create elements"),this.canvasEl&&(this.canvasEl.remove(),this.canvasEl=void 0),this.videoEl&&(this.videoEl.remove(),this.videoEl=void 0),this.canvasEl=document.createElement("canvas"),this.videoEl=document.createElement("video"),this.videoEl.setAttribute("autoplay",""),this.videoEl.setAttribute("muted",""),this.videoEl.muted=!0,this.videoEl.setAttribute("playsinline",""),this.videoEl.setAttribute("style","display:none"),e=new Promise((function(e,r){var n=null;s.videoEl&&s.videoEl.addEventListener("playing",(function t(){n&&clearTimeout(n),s.videoEl&&s.videoEl.removeEventListener("playing",t),e(void 0)})),n=window.setTimeout((function(){s.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" video track error"),r(d)}),1e3)})),this.videoEl.srcObject=new MediaStream([this.input]),this.videoEl.play(),[4,e])):(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input track is null"),[2]);case 1:i.sent(),i.label=2;case 2:if(r=this.input.getSettings(),n=r.width||this.videoEl.videoWidth,o=r.height||this.videoEl.videoHeight,r.frameRate&&this.fps!==r.frameRate&&(this.fps=r.frameRate,this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" set target fps: "+this.fps)),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" beauty video processor: width "+r.width+" height "+r.height),!n||!o)throw this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution of track is wrong"),d;return this.canvasEl.width=n,this.canvasEl.height=o,this.videoEl.setAttribute("width",n.toString()),this.videoEl.setAttribute("height",o.toString()),this.manager.init(n,o,this.canvasEl),[2,this.canvasEl.captureStream().getVideoTracks()[0]]}}))}))},e.prototype.setInput=function(e,r){return void 0===r&&(r=!1),n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:return e===this.input?[3,6]:e.kind!==this.kind?(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" kind of track is not video"),[2]):(this.output&&this.input===this.output&&this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input track is same as effect track"),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" change input track"),r?this.input?[4,this.removeInput()]:[3,2]:[3,5]);case 1:i.sent(),i.label=2;case 2:return this.input=e,this.enabled&&!this.videoEl?[4,this.startEffect()]:[3,4];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:this.input=e,(n=this.videoEl)&&(n.srcObject?((o=n.srcObject).getTracks().forEach((function(e){return o.removeTrack(e)})),o.addTrack(this.input)):n.srcObject=new MediaStream([this.input]),n.play()),i.label=6;case 6:return[2]}}))}))},e.prototype.removeInput=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.input=void 0,[4,this.stopEffect()];case 1:return e.sent(),[2]}}))}))},e.prototype.updateOutput=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.output===e?[3,3]:(this._output=e,this.onOutputChange?[4,this.onOutputChange(this._output)]:[3,2]);case 1:t.sent(),t.label=2;case 2:t.label=3;case 3:return[2]}}))}))},e.prototype.onOutputChange=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2]}))}))},e.prototype.onError=function(e,t){},e}();t.default=p},6171:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioNodeQueue=void 0;var r=function(){function e(e,t){this.source=e,this.destination=t,this.audioNodeList=[],this.source.connect(this.destination)}return Object.defineProperty(e.prototype,"lastNode",{get:function(){return this.isEmpty()?null:this.audioNodeList[this.audioNodeList.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"secondToLastNode",{get:function(){return this.audioNodeList.length<2?null:this.audioNodeList[this.audioNodeList.length-2]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstNode",{get:function(){return this.isEmpty()?null:this.audioNodeList[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"secondNode",{get:function(){return this.audioNodeList.length<2?null:this.audioNodeList[1]},enumerable:!1,configurable:!0}),e.prototype.pushBack=function(e){this.lastNode?(this.lastNode.disconnect(),this.lastNode.connect(e),e.connect(this.destination)):(this.source.disconnect(),this.source.connect(e),e.connect(this.destination)),this.audioNodeList.push(e)},e.prototype.popBack=function(){this.lastNode&&(this.lastNode.disconnect(),this.secondToLastNode?(this.secondToLastNode.disconnect(),this.secondToLastNode.connect(this.destination)):(this.source.disconnect(),this.source.connect(this.destination))),this.audioNodeList.pop()},e.prototype.pushFront=function(e){this.source.disconnect(),this.source.connect(e),e.connect(this.firstNode?this.firstNode:this.destination),this.audioNodeList.unshift(e)},e.prototype.popFront=function(){this.source.disconnect(),this.firstNode&&(this.firstNode.disconnect(),this.source.connect(this.secondNode?this.secondNode:this.destination)),this.audioNodeList.shift()},e.prototype.remove=function(e){var t=this.audioNodeList.indexOf(e);if(-1!==t){if(e.disconnect(),t-1>=0){var r=this.audioNodeList[t-1];r.disconnect(),r.connect(this.lastNode!=e?this.audioNodeList[t+1]:this.destination)}else this.source.disconnect(),this.source.connect(this.lastNode!=e?this.audioNodeList[t+1]:this.destination);this.audioNodeList.splice(t,1)}},e.prototype.isConnected=function(e){return-1!==this.audioNodeList.indexOf(e)},e.prototype.isEmpty=function(){return 0===this.audioNodeList.length},e.prototype.replaceSource=function(e){this.source.disconnect(),e.connect(this.firstNode?this.firstNode:this.destination),this.source=e},e.prototype.replaceDestination=function(e){this.lastNode?(this.lastNode.disconnect(),this.lastNode.connect(e)):(this.source.disconnect(),this.source.connect(e)),this.destination=e},e}();t.AudioNodeQueue=r},608:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientUtil=void 0;var n=r(6706),i=r(3529),o=r(7139),s=function(){function e(){}return e.checkIllegalCharacters=function(e){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(e)&&/^[^:/]*$/g.test(e)},e.isUrl=function(e){return!!(e.startsWith("rtmp://")||e.startsWith("avertp://")||e.startsWith("https://")&&e.endsWith(".flv")||e.startsWith("https://")&&e.endsWith(".m3u8"))},e.registerCallback=function(e,t,r){t.success&&(r[e+"SuccessCallback"]=t.success),t.error&&(r[e+"ErrorCallback"]=t.error)},e.actionErrorCallback=function(e,t){return t[e+"ErrorCallback"]},e.actionSuccessCallback=function(e,t){return t[e+"SuccessCallback"]},e.logReportCallback=function(t,r,n,i){e.registerCallback(t,{success:function(t,i){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];e.dataReportEvent(r,n,t,i,o)}},i)},e.actionLogReportCallback=function(t,r,n,i,o){e.actionSuccessCallback(t,r)&&e.actionSuccessCallback(t,r)(n,i)},e.getServerError=function(e,t,r){if(t)return{code:e,message:r||"liveroom error"};var n={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",1010:"token expired",1011:"token format error",1013:"token03 format error",2002:"biz channel error",1e9:"liveroom cmd error, code:",1000002001:"need relogin",1000002002:"third token auth error",1000002003:"token nonce type should be int64",1000002004:"token appid type  should be uint32",1000002005:"token timeout type should be int64",1000002006:"token user_id type should be string",1000002007:"token room_id type should be string",1000002008:"token format error",1000002009:"token privilege type should be map",1000002010:"token expire_time type should be int64",1000002011:"token user_id type should be string",1000002012:"token not exist",1000002013:"token update error",1000002014:"token not need to check"};if(0===e)return{code:0,message:""};var i={code:0,message:"liveroom cmd error"};if(i.code=e,e>1e9){var o=n[e];i.message=o?"liveroom cmd error, code: "+e+", message: "+o:n[1e9]+e}else i.message=n[e]?n[e]+" code:"+e:"unknown error code:"+e;return i},e.unregisterCallback=function(e,t){delete t[e+"SuccessCallback"],delete t[e+"ErrorCallback"]},e.decodeServerError=function(e,t){var r={code:-1,message:"server error"};return e>1e9&&(r.code=e-1e9+52e6),t&&(r.message=t),r},e.getLiveRoomError=function(e,t){var r={1016:"MULTI_ROOM_UNABLE",1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:"TOKEN_ERROR",2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:"TOKEN_ERROR",5022:"ROOM_COUNT_EXCEED"};return t?e>2e5&&e<3e5?r[e-2e5]:e<2e5?{50116:"TOKEN_ERROR",50117:"TOKEN_EXPIRED",50118:"TOKEN_ERROR",50119:"TOKEN_ERROR",50120:"TOKEN_ERROR",50121:"TOKEN_ERROR",50122:"TOKEN_ERROR",50123:"TOKEN_EXPIRED",50124:"TOKEN_ERROR",50125:"TOKEN_ERROR",50126:"TOKEN_ERROR",50127:"TOKEN_ERROR",50128:"TOKEN_ERROR"}[e]||r[e]||"ROOM_INNER_ERROR":r[e]||"ROOM_INNER_ERROR":e>1e9?r[e-1e9]||"":{1:"PARSE_JSON_ERROR",1001:"LOGIN_PROCESSING",1002:"LIVEROMM_REQUEST_ERROR",1003:"ZPUSH_REQUEST_FAIL",1004:"ZPUSH_REQUEST_FAIL",1005:"ZPUSH_REQUEST_FAIL",1006:"LOGIN_STATE_WRONG",1007:"ZPUSH_REQUEST_FAIL",1008:"TOKEN_ERROR",1009:"DIAPATCH_ERROR",1010:"TOKEN_EXPIRED",1011:"TOKEN_ERROR",1012:"SUBCMD_ERROR",1101:"ZEGO_AUTH_ERROR",2001:"BIZ_CHANNEL_ERROR",2002:"BIZ_CHANNEL_ERROR"}[e]||"ROOM_INNER_ERROR"},e.getKickoutError=function(e){var t={};switch(e){case 1:t.code=63000001,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:t.code=63000002,t.message="zpush manual kickout",t.name="MANUAL_KICKOUT";break;case 3:t.code=63000003,t.message="kickout reason = "+e;break;case 4:t.code=63000004,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 5:t.code=63000005,t.message="zpush token expired",t.name="TOKEN_EXPIRED";break;default:t.code=e,t.message="kickout reason = "+e}return t},e.dataReportEvent=function(e,t,r,n,i){switch(r){case"eventStart":e.eventStart(t,n);break;case"eventEndWithMsgInfo":e.eventEndWithMsgInfo(t,n,i[0]);break;case"addEventMsg":e.addEventMsg(t,n,i[0],i[1]);break;case"addEvent":e.addEvent(t,n);break;case"eventEnd":e.eventEnd(t,n);break;case"addMsgInfo":e.addMsgInfo(t,i[0])}},e.isKeepTryLogin=function(e){switch(e){case 1002:case 1003:return!0;default:return!1}},e.mergeStreamList=function(e,t,r,n){var i,o=[],s=[],a=[];r||(r=[]);for(var c=0;c<r.length;c++)if(r[c].anchor_id_name!=e&&r[c].id_name!=e&&r[c].user_id!=e){i=!1;for(var u=0;u<t.length;u++)if(r[c].stream_id===t[u].stream_id){r[c].extra_info!==t[u].extra_info&&a.push(r[c]),i=!0;break}i||o.push(r[c])}for(var l=0;l<t.length;l++)if(t[l].anchor_id_name!=e&&t[l].id_name!=e&&t[l].user_id!=e){i=!1;for(var d=0;d<r.length;d++)if(t[l].stream_id===r[d].stream_id){i=!0;break}i||s.push(t[l])}for(t.splice(0),c=0;c<r.length;c++)t.push(r[c]);n(o,s,a)},e.checkInteger=function(e,t){return 0==t?"number"==typeof e&&e%1==0&&e>=0:"number"==typeof e&&e%1==0&&e>0},e.checkValidNumber=function(e,t,r){return t=t||1,r=r||1e4,"number"==typeof e&&e%1==0&&e>=t&&e<=r},e.uuid=function(e,t){var r,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(t=t||n.length,e)for(r=0;r<e;r++)i[r]=n[0|Math.random()*t];else{var o=void 0;for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",r=0;r<36;r++)i[r]||(o=0|16*Math.random(),i[r]=n[19==r?3&o|8:o])}return i.join("")},e.getDevices=function(e,t){void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(t){for(var r=[],n=[],i=[],o=0;o<t.length;o++){var s=t[o];"audioinput"===s.kind&&r.push({deviceName:s.label,deviceID:s.deviceId}),"audiooutput"===s.kind&&n.push({deviceName:s.label,deviceID:s.deviceId}),"videoinput"===s.kind&&i.push({deviceName:s.label,deviceID:s.deviceId})}e&&e({microphones:r,speakers:n,cameras:i})})).catch((function(e){console.error("enumerate devices wrong "+e),t&&t(i.ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kEnumDevicesError)})):t&&t(i.ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kBrowserNotSupportError)},e.getPublisherStateType=function(e){return 0==e||1==e?0==e?"PUBLISHING":"NO_PUBLISH":"PUBLISH_REQUESTING"},e.getPlayerStateType=function(e){return 0==e||1==e?0==e?"PLAYING":"NO_PLAY":"PLAY_REQUESTING"},e.getSteamUpdateType=function(e){return 0==e?"DELETE":"ADD"},e.getNetQuality=function(e,t,r){return void 0!==r?.15*this.calcQualityOfJitter(r)+.85*Math.min(this.calcQualityOfRtt(e),this.calcQualityOfLostRate(t,!1)):Math.min(this.calcQualityOfRtt(e),this.calcQualityOfLostRate(t,!0))},e.isIos=function(){return null!==navigator.platform.match("iPhone")},e.isMacOs=function(){return null!==navigator.platform.match("Mac")},e.isAndroid=function(){return null!==navigator.platform.match("Android")},e.isWindows=function(){return null!==navigator.platform.match("Windows")},e.isWin32=function(){return null!==navigator.platform.match("Win32")&&null===navigator.userAgent.match("WOW64")},e.isLinux=function(){return null!==navigator.platform.match("Linux")},e.getOsType=function(){return this.isIos()?o.OSType.IOS:this.isAndroid()?o.OSType.ANDROID:this.isMacOs()?o.OSType.MAC:this.isWin32()?o.OSType.WIN32:o.OSType.UNKNOWN},e.checkScreenParams=function(t,r){if("object"==typeof t&&void 0!==t.videoQuality&&!e.checkInteger(t.videoQuality))return r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," videoQuality must be integer number"),!1;if("object"==typeof t&&void 0!==t.sourceID&&"string"!=typeof t.sourceID)return r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," sourceID must be string"),!1;if("object"==typeof t&&4===t.videoQuality){if(!e.checkCameraOrScreenBitRate(t.bitRate,r))return!1;if(!e.checkParamsWithConstraintExtend(t,r))return!1}return!0},e.checkParamsWithConstraintExtend=function(t,r){for(var n=0,o=["frameRate","width","height"];n<o.length;n++){var s=o[n],a=t[s];if(void 0===a)return r&&r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," ".concat(s," is required when videoQuality is 4")),!1;if("number"==typeof a&&!e.checkInteger(a,!1))return r&&r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," ".concat(s," must be integer number")),!1;if("number"==typeof a&&("width"===s||"height"===s)&&a<0)return r&&r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," ".concat(s," must greater than 0.")),!1;if("number"==typeof a&&"width"===s&&a>7680)r&&r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," ".concat(s," cannot greater than 7680."));else if("number"==typeof a&&"height"===s&&a>4320)r&&r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," ".concat(s," cannot greater than 4320."));else if("object"==typeof a){if("width"===s&&!e.checkConstraintExtend(a,s,r,0,7680))return!1;if("height"===s&&!e.checkConstraintExtend(a,s,r,0,4320))return!1;if("frameRate"===s&&!e.checkConstraintExtend(a,s,r))return!1}else if("number"!=typeof a&&"object"!=typeof a)return r&&r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," ".concat(s," must be number or object")),!1}return!0},e.checkConstraintExtendWithMessage=function(t,r,n,i){if("object"!=typeof t)return{result:!1,message:"Invalid constraint. Constraint Extend must be a object"};if(0===Object.keys(t).length)return{result:!1,message:"".concat(r," can not be a empty object")};for(var o=0,s=["exact","ideal","max","min"];o<s.length;o++){var a=s[o],c=t[a];if("number"==typeof c&&!e.checkInteger(c,!1))return{result:!1,message:" ".concat(a," of ").concat(r," must be integer number")};if("number"==typeof n&&"number"==typeof c&&c<n)return{result:!1,message:" ".concat(a," of ").concat(r," must greater than ").concat(n)};if("number"==typeof i&&"number"==typeof c&&c>i)return{result:!1,message:" ".concat(a," of ").concat(r," cannot greater than ").concat(i)}}return{result:!0,message:"Constraint Extend OK."}},e.checkConstraintExtend=function(t,r,n,o,s){var a=e.checkConstraintExtendWithMessage(t,r,o,s);return a.result||n&&n(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,a.message),a.result},e.checkBitRateLimit=function(e,t){return!(e>10240)||(t(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps"),!1)},e.checkCameraOrScreenBitRate=function(t,r){if(void 0===t)return r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate is required when videoQuality is 4"),!1;if("number"==typeof t){if(!e.checkValidNumber(t,0,10240))return r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number"),!1;if(!e.checkBitRateLimit(t,r))return!1}else r(i.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be number");return!0},e.checkCameraParams=function(t,r){return!!e.checkParamsWithConstraintExtend(t,r)&&!!e.checkCameraOrScreenBitRate(t.bitRate,r)},e.isParamEmpty=function(e){return null!=e&&""!==e},e.isTypeString=function(e){return"string"==typeof e},e.isTooLong=function(e,t){return!(e.length>=t)},e.isReDispatch=function(e){var t=e.message.match(/action:(\d+)/),r=t?Number(t[1]):NaN;return[i.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kTTLOverTimeError,i.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kClientIPChangedError,i.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kTTLOverTimeError,i.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kClientIPChangedError].includes(e)||[6].includes(r)},e.arrAvg=function(e,t,r){return e.push(t),e.length>r&&e.shift(),e.reduce((function(e,t){return e+t}))/e.length},e.calcQualityOfRtt=function(e){return e<600?97-Math.pow(.09*e,1.1):18*Math.exp(.002*(600-e))},e.calcQualityOfJitter=function(e){return e<=50?98-Math.pow(e,1.15):n.QUALITY_CONSTANT.PoorMinQuality},e.calcQualityOfLostRate=function(e,t){if(t)return e<=55?99-Math.pow(.8*e,1.18):n.QUALITY_CONSTANT.PoorMinQuality;var r=100*e;return r<=40?96-Math.pow(r,1.22):n.QUALITY_CONSTANT.PoorMinQuality},e.quality2QualityGrade=function(e){return e>=n.QUALITY_CONSTANT.ExcellentMinQuality?n.QualityGrade.Excellent:e>=n.QUALITY_CONSTANT.GoodMinQuality?n.QualityGrade.Good:e>=n.QUALITY_CONSTANT.MiddleMinQuality?n.QualityGrade.Middle:e>=n.QUALITY_CONSTANT.PoorMinQuality?n.QualityGrade.Poor:n.QualityGrade.Die},e.checkAudioTrackIsActive=function(e){return!!e.enabled},e.checkVideoTrackIsActive=function(e){return!!e.enabled},e.isSupportEncodedTransforms=function(){var e=!!window.RTCRtpScriptTransform;if(!e){var t=!!RTCRtpSender.prototype.createEncodedStreams,r=!1;try{new ReadableStream,r=!0}catch(e){console.error("Transferable streams are not supported.")}e=t&&r}return e},e.uint8arrayToBase64=function(e){for(var t,r=0,n=e.length,i="";r<n;)t=e.subarray(r,Math.min(r+32768,n)),i+=String.fromCharCode.apply(null,Array.from(t)),r+=32768;return btoa(i)},e.isMobile=function(){return!!(navigator.userAgent.match(/Mobi/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i))},e}();t.ClientUtil=s},4671:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.handlerListMap={}}return e.prototype.addEventHandler=function(e,t){if(this.handlerListMap[e]||(this.handlerListMap[e]=[]),"function"!=typeof t)throw new Error("Params callBack is not a Function");return-1==this.handlerListMap[e].indexOf(t)&&this.handlerListMap[e].push(t),!0},e.prototype.removeEventHandler=function(e,t){return!!this.handlerListMap[e]&&(this.handlerListMap[e]=t?this.handlerListMap[e].filter((function(e){return e!==t})):[],!0)},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.handlerListMap[e]&&this.handlerListMap[e].forEach((function(r){try{setTimeout((function(){r.apply(void 0,t)}),0)}catch(t){console.error('Fail to execute callback of event "'.concat(e,'" : ').concat(t))}}))},e}();t.default=r},7646:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.H264Parser=void 0;var r=function(){function e(e){this.view=e,this.offset=0,this.current_start_code_size=0,this.current_nalu_start=0,this.current_nalu_size=0,this.start_code_size=0,this.nalu_start=0,this.left_size=0,this.nalu_size=0,this.left_size=e.byteLength}return e.prototype.FindStartCode=function(){var e=this.view.byteLength-this.offset;for(this.current_start_code_size=0,this.current_nalu_start=-1;e>=3;){if(0==this.view.getUint8(this.offset)&&0==this.view.getUint8(this.offset+1)&&1==this.view.getUint8(this.offset+2))return this.current_start_code_size=3,this.current_nalu_start=this.offset,this.offset-1>=0&&0==this.view.getUint8(this.offset-1)&&(++this.current_start_code_size,--this.current_nalu_start),this.offset+=3,!0;--e,++this.offset}return!1},e.prototype.FindNalu=function(){return this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,!(this.offset>=this.view.byteLength)&&!!this.FindStartCode()&&(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,!0)},e.prototype.NextNalu=function(e){return this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,!(this.offset>=this.view.byteLength)&&!!this.FindStartCode()&&(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,!(!e||6==(31&this.view.getUint8(this.nalu_start+this.start_code_size)))||(this.FindStartCode()?(this.offset=this.current_nalu_start,this.nalu_size=this.current_nalu_start-this.nalu_start,!0):(this.nalu_size=this.view.byteLength-this.nalu_start,!0)))},e}();t.H264Parser=r},7139:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OSType=void 0,function(e){e.WIN32="WIN32",e.MAC="Mac",e.ANDROID="Android",e.LINUX="Linux",e.IOS="iOS",e.UNKNOWN="WTF"}(t.OSType||(t.OSType={}))},6502:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryHandler=void 0;var r=function(){function e(){this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryStartTime=0,this.retryActiveCount=1,this.retryNetCount=0,this.retryNetMaxTimes=3,this.isOverTime=!1}return e.prototype.init=function(e,t,r,n){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof r&&(this.RETRY_CONTINUE_COUNT=r),"number"==typeof n&&(this.RETRY_MAX_TIME_INTERVAL=n)},e.prototype.invalid=function(){this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.startRetryTimer&&clearTimeout(this.startRetryTimer),this.startRetryTimer=null,this.retryStartTime=0,this.retryActiveCount=1,this.retryNetCount=0},e.prototype.isRetrying=function(){return null!==this.retryTimer||null!==this.startRetryTimer||null!==this.maxTimer},e}();t.RetryHandler=r},4767:function(e,t){"use strict";var r=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.SdpUtil=void 0;var n=function(){function e(){}return e.zegoSdp=function(e){var t=e.split("\r\n"),n=[],i=[];t.forEach((function(e){var t=e.match(/a=rtpmap:(\d+)\s+((H264\/90000)|(opus\/48000\/2))/);t&&t[1]&&t[2]&&("H264/90000"===t[2]&&n.push(t[1]),"opus/48000/2"===t[2]&&i.push(t[1]))}));var o=[];return t.map((function(e){var t=!0,s=e.match(/((a=rtcp-fb:)|(a=rtpmap:)|(a=fmtp:))(\d+)/);if(s&&s[5]&&(r(r([],n,!0),i,!0).some((function(e){return e==s[5]}))||(t=!1)),e.indexOf("m=video")>-1){var a=e.split(" ");e=r([a[0],a[1],a[2]],n,!0).join(" ")}else e.indexOf("m=audio")>-1&&(a=e.split(" "),e=r([a[0],a[1],a[2]],i,!0).join(" "));t&&o.push(e)})),o.join("\r\n")},e.getSDPByVideDecodeType=function(e,t,n){var i={str:"",arr:[],obj:{H264:[],H265:[],VP8:[],VP9:[],OTHER:[]}};if(!e.includes("m=video"))return e;var o=/m=video.+/.exec(e)[0];o=o.match(/[\s|\d]+/g)[1].replace(" ",""),i.str=o,i.arr=i.str.split(" "),i.arr.forEach((function(t){var r=new RegExp("a=rtpmap:"+t+".+").exec(e)[0];r.includes("H264")?i.obj.H264.push(t):r.includes("H265")?i.obj.H265.push(t):r.includes("VP8")?i.obj.VP8.push(t):r.includes("VP9")?i.obj.VP9.push(t):i.obj.OTHER.push(t)})),i.obj.OTHER.forEach((function(t){var r=new RegExp("a=fmtp:"+t+".+apt=(\\d+)").exec(e),n=r&&r[1];n&&(i.obj.H264.includes(n)?i.obj.H264.push(t):i.obj.H265.includes(n)?i.obj.H265.push(t):i.obj.VP8.includes(n)?i.obj.VP8.push(t):i.obj.VP9.includes(n)&&i.obj.VP9.push(t))}));var s=[];if("VP9"===t?s=r(r(r([],i.obj.H265,!0),i.obj.H264,!0),i.obj.VP8,!0):"VP8"===t?s=r(r(r([],i.obj.H265,!0),i.obj.H264,!0),i.obj.VP9,!0):"H264"===t?s=r(r(r([],i.obj.H265,!0),i.obj.VP8,!0),i.obj.VP9,!0):"H265"===t&&(s=r(r(r([],i.obj.VP8,!0),i.obj.H264,!0),i.obj.VP9,!0)),"H264"==t&&"boolean"==typeof n){var a=[];i.obj.H264.forEach((function(t){var r=new RegExp("a=fmtp:"+t+".+\\s\\n","g").exec(e);n?(null==r?void 0:r.find((function(e){return e.includes("profile-level-id=42e01f")})))||a.push(t):(null==r?void 0:r.find((function(e){return e.includes("profile-level-id=42e01f")})))&&a.push(t);var i=new RegExp("a=fmtp:"+t+".+apt=(\\d+)").exec(e),o=i&&i[1];o&&a.includes(o)&&a.push(t)})),a.length==i.obj.H264.length&&(a=[]),s=s.concat(a)}return s.forEach((function(t){var r=i.arr.indexOf(t);i.arr.splice(r,1);var n=new RegExp("a=rtpmap:"+t+".+\\s\\n","g"),o=new RegExp("a=rtcp-fb:"+t+".+\\s\\n","g"),s=new RegExp("a=fmtp:"+t+".+\\s\\n","g");e=(e=(e=e.replace(n,"")).replace(o,"")).replace(s,"")})),e=e.replace(o,i.arr.join(" "))},e}();t.SdpUtil=n},1358:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRTCUtil=void 0;var o=r(3529),s=r(4395),a=r(608),c=function(){function e(){}return e.supportDetection=function(e,t,r,o){return n(this,void 0,void 0,(function(){var n,s,a,c,u,l,d,h;return i(this,(function(i){switch(i.label){case 0:return n={webRTC:!1,customCapture:!1,camera:!1,microphone:!1,videoCodec:{H264:!1,H265:!1,VP8:!1,VP9:!1},screenSharing:e,errInfo:{}},o&&"screenSharing"===o?(t({result:e,errInfo:n.errInfo}),[2]):o&&"customCapture"!==o||(((s=document.createElement("video")).captureStream||s.mozCaptureStream)&&(n.customCapture=!0),"customCapture"!==o)?(a=navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,c="https:"!==window.location.protocol&&"file:"!==window.location.protocol&&-1==window.location.hostname.indexOf("127.0.0.1")&&-1==window.location.hostname.indexOf("localhost"),o&&"camera"!==o&&"microphone"!==o?[3,9]:a?c?(n.camera=!1,console.error("webrtc requires https or localhost"),[3,9]):[3,1]:[3,9]):(t({result:n.customCapture,errInfo:n.errInfo}),[2]);case 1:if(o&&"camera"!==o)return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,navigator.mediaDevices.getUserMedia({video:!0})];case 3:return(u=i.sent())&&(n.camera=!0)&&u.getTracks().forEach((function(e){return e.stop()})),[3,5];case 4:return l=i.sent(),n.errInfo.camera={name:l.name,message:l.message},console.error("camera devices detect error: ",l.name,l.message),[3,5];case 5:if(o&&"microphone"!==o)return[3,9];i.label=6;case 6:return i.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 7:return(d=i.sent())&&(n.microphone=!0)&&d.getTracks().forEach((function(e){return e.stop()})),[3,9];case 8:return h=i.sent(),n.errInfo.microphone={name:h.name,message:h.message},console.error("microphone devices detect error: ",h.name,h.message),[3,9];case 9:return"camera"===o||"microphone"===o?(t({result:n[o],errInfo:n.errInfo}),[2]):(this.supportVideoCodeType((function(e,r){o||(n.videoCodec.H264=e.H264,n.videoCodec.H265=e.H265,n.videoCodec.VP8=e.VP8,n.videoCodec.VP9=e.VP9,n.webRTC=e.webRTC),r&&("string"==typeof r?n.errInfo.extendedDate=r:n.errInfo.webRTC={name:r.name,message:r.message},console.error("videoCodec detect error: "+r)),t&&t(o?{result:e[o],errInfo:n.errInfo}:n)}),r,o),[2])}}))}))},e.supportVideoCodeType=function(e,t,r){return n(this,void 0,void 0,(function(){var n,o,a,c,u,l,d,h,p,f;return i(this,(function(i){switch(i.label){case 0:return n={webRTC:!1,H264:!1,VP8:!1,VP9:!1,H265:!1},r?1!==t||"VP8"!==r&&"H264"!==r?[3,2]:[4,(f=new s.CheckModule).checkSupportByType(r)]:[3,2];case 1:return"boolean"==typeof(o=i.sent())?(n[r]=o,[2,e(n)]):(n[r]=!1,[2,e(n,o)]);case 2:if("webRTC"!==r&&1!==t)return[3,7];i.label=3;case 3:return i.trys.push([3,5,,6]),[4,(new RTCPeerConnection).createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 4:return i.sent(),n.webRTC=!0,[3,6];case 5:return a=i.sent(),e&&e(n,a),[3,6];case 6:if("webRTC"===r)return[2,e(n)];i.label=7;case 7:if(1===t){for(c="",l=[],d=0,h=u=["VP8","H264"];d<h.length;d++)p=h[d],f=new s.CheckModule,l.push(f.checkSupportByType(p));return Promise.all(l).then((function(t){t.forEach((function(e,t){"boolean"==typeof e?n[u[t]]=!0:(n[u[t]]=!1,c=e)})),c?e(n,c):e(n)})),[2]}try{(new RTCPeerConnection).createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(t){if(n.webRTC=!0,t&&t.sdp){var i=t.sdp.split("\r\n");if(n.H264=i.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("H264/")>-1})),"H264"===r)return e(n);if(n.VP8=i.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("VP8/")>-1})),"VP8"===r)return e(n);n.VP9=i.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("VP9/")>-1})),n.H265=i.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("H265/")>-1})),e&&e(n)}}))}catch(t){e&&e(n,t)}return[2]}}))}))},e.checkScreenParams=function(e,t){if("object"==typeof e&&void 0!==e.videoQuality&&!a.ClientUtil.checkInteger(e.videoQuality))return t(o.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," videoQuality must be integer number"),!1;if("object"==typeof e&&void 0!==e.sourceID&&"string"!=typeof e.sourceID)return t(o.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," sourceID must be string"),!1;if("object"==typeof e&&4===e.videoQuality){if(!a.ClientUtil.checkCameraOrScreenBitRate(e.bitRate,t))return!1;if(!a.ClientUtil.checkParamsWithConstraintExtend(e,t))return!1}return!0},e.checkCameraParams=function(e,t){return!!a.ClientUtil.checkParamsWithConstraintExtend(e,t)&&!!a.ClientUtil.checkCameraOrScreenBitRate(e.bitRate,t)},e.base64ToUint8Array=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(t),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n},e.decodeString=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(String,Array.from(e))))},e.encodeString=function(e){return Uint8Array.from(Array.from(unescape(encodeURIComponent(e))).map((function(e){return e.charCodeAt(0)})))},e}();t.WebRTCUtil=c},5321:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWebRTC=void 0;var c=r(6706),u=r(608),l=r(1358),d=r(7325),h=r(1089),p=r(3529),f=r(908),g=r(3409),m=r(7560),_=r(1547),v=o(r(5515)),y=r(3770),E=r(4865),S=r(361),b=r(5019),T=r(5028),C=r(9595),R=r(9595),O=function(){function e(e,t,r,n){void 0===n&&(n=0);var i=this;this.mediaEleSources=[],this.logger=e,this.dataReport=t,this.ac=new("undefined"!=typeof webkitAudioContext?webkitAudioContext:AudioContext),this.ac.addEventListener("statechange",(function(){"suspended"===i.ac.state&&i.ac.resume()})),this.checkAudioContext(),this.stateCenter=new d.StateCenter(this.logger,this.dataReport),this.stateCenter.clientType="webrtc",this.stateCenter.settingConfig=new R.ZegoSettingConfig,this.RTM=r,this.streamCenter=new g.ZegoStreamCenterWeb(this.logger,this.stateCenter,this.dataReport,this.RTM,this.ac,this.mediaEleSources),this.rtcModules=new f.RTCModules(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.RTM,this.ac,this),this.stateCenter.browser=v.browserDetails.browser,this.RTM.cloudSetting.setEnvVariable("sdk_version",c.PROTO_VERSION),this.RTM.cloudSetting.getSettingCache(C.RTC).then((function(e){i.logger.info(h.ZEGO_WEBRTC_ACTION.CONSTRUCTOR+" streamConfig "+JSON.stringify(e));var t=(0,c.getReportSeq)();i.dataReport.newReport(t,p.ZegoRTCLogEvent.kZegoTaskCloudSettingCache.event),i.dataReport.addMsgInfo(t,{files:[{name:C.RTC,content:null==e?void 0:e.setting,versions:null==e?void 0:e.versions}]}),i.dataReport.uploadReport(t),i.stateCenter.settingConfig.setSetting(null==e?void 0:e.setting)})).catch((function(e){i.logger.warn(h.ZEGO_WEBRTC_ACTION.CONSTRUCTOR+" streamConfig "+JSON.stringify(e))})),this.stateCenter.rtm=this.RTM,this.stateCenter.streamCenter=this.streamCenter,this.stateCenter.chargeInfosSaver.checkAndReport()}return e.prototype.checkAudioContext=function(){var e=this;if(this.ac&&"suspended"===this.ac.state){var t=function t(){"running"!==e.ac.state?e.ac.resume():(window.removeEventListener("click",t),window.removeEventListener("touchstart",t))};window.addEventListener("click",t),window.addEventListener("touchstart",t)}},e.prototype.mutePublishStreamVideo=function(e,t,r){return!1},e.prototype.mutePublishStreamAudio=function(e,t){return!1},e.prototype.mutePlayStreamVideo=function(e,t){return new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.mutePlayStreamAudio=function(e,t){return new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.muteMicrophone=function(e){return!1},e.prototype.isMicrophoneMuted=function(){return!this.streamCenter.isMicEnabled},e.prototype.setAudioOutput=function(e,t){return this.logger.info(h.ZEGO_WEBRTC_ACTION.SET_AUDIO_OUTPUT+" call"),"string"!=typeof t?(this.logger.error("audiooutput is not string"),!1):this.rtcModules.playModule.setStreamAudioOutput(e,t)},e.prototype.setCustomSignalUrl=function(e){if(this.logger.info(h.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" call: "+e),e&&0!=e.length){var t=!0;e.forEach((function(e){return 0!=e.indexOf("wss://")&&(t=!1)})),t?this.stateCenter.customUrl=e:this.logger.error(h.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" url is not correct")}else this.logger.error(h.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" param error")},e.prototype.setGWNode=function(e){"string"==typeof e&&e.length>0&&(this.streamCenter.gwNode=e)},e.prototype.setQualityMonitorCycle=function(e){return"number"==typeof e&&e>=1e3?(this.streamCenter.setQualityMonitorCycle(e),!0):(this.logger.error("zc.sqmc.0 time must be number and bigger than 1000"),!1)},e.prototype.startPlayingStream=function(e,t,r){return this.logger.info(h.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" call by user"),this.rtcModules.playModule.startPlayingStream(e,t,r)},e.prototype.stopPlayingStream=function(e){this.logger.info(h.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call by user"),this.rtcModules.playModule.stopPlayingStream(e)},e.prototype.setPlayAccelerate=function(e){this.stateCenter.playAccelerate=e},e.prototype.setTurnOverTcpOnly=function(e){this.logger.info(h.ZEGO_WEBRTC_ACTION.SET_TURN_OVER_TCP_ONLY+" call "+e),"boolean"==typeof e?this.stateCenter.turnOverTcpOnly=e:this.logger.error("zc.p.stoto.0 param must be param")},e.prototype.createStream=function(e){return this.rtcModules.publishModule.createStream(e)},e.prototype.destroyStream=function(e){this.rtcModules.publishModule.destroyStream(e)},e.prototype.startPublishingStream=function(e,t,r,n){return this.logger.info(h.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" call by user"),this.rtcModules.publishModule.startPublishingStream(e,t,r,n)},e.prototype.activateSEIInsert=function(e){return console.error("should install advanced module"),!1},e.prototype.setSEIConfig=function(e){this.stateCenter.seiConfig=e},e.prototype.sendSEI=function(e,t){return this.rtcModules.publishModule.sendSEI(e,t)},e.prototype.stopPublishingStream=function(e){return this.logger.info(h.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" call by user"),this.rtcModules.publishModule.stopPublishingStream(e,void 0,!0)},e.prototype.setVideoConfig=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setVideoConfig(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.setAudioConfig=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setAudioConfig(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.replaceTrack=function(e,t,r){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.replaceTrack(e,t,r):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.preloadEffect=function(e,t,r){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.preloadEffect(e,t,r):console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757")},e.prototype.getEffectDuration=function(e){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.getEffectDuration(e):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),0)},e.prototype.getEffectCurrentProgress=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.getEffectProgress(e,t):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),0)},e.prototype.seekAudioEffect=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.seekAudioEffect(e,t,r):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.playEffect=function(e,t,r){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.playEffect(e,t,r):console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757")},e.prototype.pauseEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.pauseEffect(e,t):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.resumeEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.resumeEffect(e,t):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.stopEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopEffect(e,t):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.unloadEffect=function(e){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.unloadEffect(e):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.setEffectVolume=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.setEffectVolume(e,t,r):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.startMixingAudio=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.startMixingAudio(e,t):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.stopMixingAudio=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopMixingAudio(e,t):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.mixingBuffer=function(e,t,r,n){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.mixingBuffer(e,t,r,n):console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757")},e.prototype.stopMixingBuffer=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopMixingBuffer(e,t):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.setMixingAudioVolume=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.setMixingAudioVolume(e,t,r):(console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757"),!1)},e.prototype.checkSystemRequirements=function(t,r){var n=this,i=navigator&&navigator.mediaDevices&&(e.screenShotReady||"getDisplayMedia"in navigator.mediaDevices);return this.logger.info(h.ZEGO_WEBRTC_ACTION.CHECK_SUPPORT+" call"+navigator.userAgent),new Promise((function(e){var o=(0,c.getReportSeq)();n.dataReport.newReport(o,p.ZegoRTCLogEvent.kZegoTaskCheckSystemRequirements.event);var s=r||"all",a=function(t){n.dataReport.addMsgInfo(o,{capability:p.ZegoRTCLogEvent.kZegoTaskCheckSystemRequirements.capability(t)}),n.dataReport.uploadReport(o);var r=n.stateCenter.checkList.indexOf(s);n.stateCenter.checkList.splice(r,1),e(t)};return["webRTC","customCapture","camera","microphone","screenSharing","H264","VP8","all"].includes(s)&&[0,1].includes(t)?n.stateCenter.checkList.includes(s)||n.stateCenter.checkList.includes("all")?a({result:!1,errInfo:{extendedDate:"The last test of the same type has not returned a result "}}):(n.stateCenter.checkList.push(s),void l.WebRTCUtil.supportDetection(i,a,t,r)):a({result:!1,errInfo:{extendedDate:"param error"}})}))},e.prototype.enumDevices=function(e,t){return s(this,void 0,void 0,(function(){var r,n,i,o,s,u,l,d,h,f,g,m,_,v=this;return a(this,(function(a){switch(a.label){case 0:return this.logger.info("zc.ed.0 call"),r=function(){return new Promise((function(e,t){var r=(0,c.getReportSeq)();v.dataReport.newReport(r,p.ZegoRTCLogEvent.kZegoTaskEnumDevices.event),v.rtcModules.publishModule.recordDevices((function(t){var n=[],i=!0,o=!0;t.cameras.forEach((function(e){""===e.deviceID&&(i=!1),n.push({device:e.deviceName,type:0})})),t.microphones.forEach((function(e){""===e.deviceID&&(o=!1),n.push({device:e.deviceName,type:1})})),t.speakers.forEach((function(e){return n.push({device:e.deviceName,type:2})})),v.dataReport.addMsgInfo(r,{dev_list:p.ZegoRTCLogEvent.kZegoTaskEnumDevices.dev_list(n)}),v.dataReport.uploadReport(r),e({devices:t,enableCamera:i,enableMic:o})}),(function(e){v.dataReport.addMsgInfo(r,e),v.dataReport.uploadReport(r),t(e)}))}))},[4,r()];case 1:return n=a.sent(),i=n.enableCamera,o=n.enableMic,s=n.devices,e?(this.logger.info("zc.ed.0 check permission"),u={video:!0,audio:!0},"videoinput"===t?u.audio=!1:"audioinput"!==t&&"audiooutput"!==t||(u.video=!1),d=u.audio&&!o,(l=u.video&&!i)||d?(this.logger.info("zc.ed.0 need to get device permission. needCamera: ".concat(l,", needMic: ").concat(d)),[4,navigator.mediaDevices.getUserMedia(u).catch((function(){}))]):[3,4]):[3,4];case 2:return(h=a.sent())&&h.getTracks().forEach((function(e){e.stop()})),[4,r()];case 3:f=a.sent(),g=f.devices,m=f.enableCamera,_=f.enableMic,u.video&&!m&&this.logger.warn("zc.ed.0 get video device permission failed."),u.audio&&!_&&this.logger.warn("zc.ed.0 get audio device permission failed."),s=g,a.label=4;case 4:return[2,s]}}))}))},e.prototype.getCameras=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"videoinput")];case 1:return[2,e.sent().cameras]}}))}))},e.prototype.getMicrophones=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"audioinput")];case 1:return[2,e.sent().microphones]}}))}))},e.prototype.getSpeakers=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"audiooutput")];case 1:return[2,e.sent().speakers]}}))}))},e.prototype.getAudioInfo=function(e,t,r){},e.prototype.getSoundLevel=function(e,t,r){this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.getSoundLevel(e,t,r):console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757")},e.prototype.stopSoundLevel=function(e){this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopSoundLevel(e):console.error("\u672a\u5f15\u5165\u6df7\u97f3\u6a21\u5757")},e.handleDataAvailable=function(t){t.data&&t.data.size>0&&e.recordedBlobs.push(t.data)},e.prototype.startRecord=function(e){},e.prototype.stopRecord=function(){},e.prototype.resumeRecord=function(){},e.prototype.pauseRecord=function(){},e.prototype.saveRecord=function(e){},e.prototype.useVideoDevice=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.useVideoDevice(e,t):new Promise((function(e,t){e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.useAudioDevice=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.useAudioDevice(e,t):(console.error("should use advanced module first"),new Promise((function(e,t){e({errorCode:-1,extendedData:"should install advanced module"})})))},e.prototype.getElectronScreenSources=function(){return this.rtcModules.publishModule.getElectronScreenSources()},e.prototype.setSoundLevelDelegate=function(e,t,r){this.logger.info("zc.ssd.0 call"),"boolean"==typeof e?t&&(!this.stateCenter.checkInteger(t)||t<100||t>3e3)?this.logger.error("zc.ssd.0 soundLevel interval must be integer number which is between 100 and 3000"):this.streamCenter.setSoundLevelDelegate(e,t,r):this.logger.error("zc.ssd.0 param 1 must be boolean")},e.prototype.on=function(e,t){return this.rtcModules.bindListener(e,t)},e.prototype.off=function(e,t){return this.rtcModules.deleteListener(e,t)},e.prototype.getVersion=function(){return c.PROTO_VERSION},e.prototype.setStreamExtraInfo=function(e,t){return new Promise((function(e,t){console.error("should use advanced module first"),t()}))},e.prototype.addPublishCdnUrl=function(e,t){return this.logger.info("zg.cm.apu call ",e,t),this.rtcModules.streamCommonModule?this.rtcModules.streamCommonModule.publishTarget({type:"addpush",streamID:e,pushUrl:t}):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.removePublishCdnUrl=function(e,t){return this.logger.info("zg.cm.apu call ",e,t),this.rtcModules.streamCommonModule?this.rtcModules.streamCommonModule.publishTarget({type:"delpush",streamID:e,pushUrl:t}):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.startMixerTask=function(e){return new Promise((function(e,t){console.error("\u672a\u5f15\u5165\u6df7\u6d41\u6a21\u5757"),t()}))},e.prototype.setMixerTaskConfig=function(e){return new Promise((function(e,t){console.error("\u672a\u5f15\u5165\u6df7\u6d41\u6a21\u5757"),t()}))},e.prototype.stopMixerTask=function(e){return new Promise((function(e,t){console.error("\u672a\u5f15\u5165\u6df7\u6d41\u6a21\u5757"),t()}))},e.prototype.setCaptureVolume=function(e,t){return this.rtcModules.publishModule.setCaptureVolume(e,t)},e.use=function(t){switch(t.type){case"AudioMix":t.install(f.RTCModules,_.ZegoPublish);break;case"MixStream":t.install(e,m.StreamHandler,f.RTCModules);break;case"StreamCommon":t.install(e,f.RTCModules,m.StreamHandler);break;case"Advance":t.install(e,f.RTCModules,m.StreamHandler,y.ZegoPreview,E.PlayModule,S.PublishModule,_.ZegoPublish,b.ZegoSignal);break;case"BeautyEffect":t.install(e,y.ZegoPreview);break;case"RangeAudio":case"DataChannel":case"AiDenoise":t.install(e)}},e.prototype.createRangeAudioInstance=function(){throw new Error("should use range audio module")},e.prototype.createRealTimeSequentialDataManager=function(e){throw new Error("should use datachannel module")},e.prototype.destroyRealTimeSequentialDataManager=function(e){throw new Error("should use datachannel module")},e.prototype.enableDataChannel=function(e){"boolean"==typeof e&&(this.streamCenter.isDataChannelEnabled=e)},e.prototype.addTrack=function(e,t){return new Promise((function(e,t){throw new Error("use advanced module first")}))},e.prototype.removeTrack=function(e,t){return new Promise((function(e,t){throw new Error("use advanced module first")}))},e.prototype.setBeautyEffect=function(e,t,r){return new Promise((function(e,t){console.error("should install video effect module and advanced module"),e({errorCode:-1,extendedData:"should install video effect module and advanced module"})}))},e.prototype.setLowlightEnhance=function(e,t){return new Promise((function(e,t){console.error("should install video effect module and advanced module"),e({errorCode:-1,extendedData:"should install video effect module and advanced module"})}))},e.prototype.getPublishingStreamQuality=function(e){return this.rtcModules.publishModule.getStreamStats(e)},e.prototype.getPlayingStreamQuality=function(e){return this.rtcModules.playModule.getStreamStats(e)},e.prototype.checkAudioTrackIsActive=function(e){return MediaStreamTrack instanceof e&&"video"===e.kind?u.ClientUtil.checkAudioTrackIsActive(e):(this.logger.error("zc.caia.0 track type error"),!1)},e.prototype.checkVideoTrackIsActive=function(e){return MediaStreamTrack instanceof e&&"audio"===e.kind?u.ClientUtil.checkVideoTrackIsActive(e):(this.logger.error("zc.cvia.0 track type error"),!1)},e.prototype.setDummyCaptureImagePath=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setDummyCaptureImagePath(e,t):new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.setAccess=function(e){this.RTM.setAccess(e),this.stateCenter.useNetAgent=this.RTM.getSettingUnify(!0),this.RTM.setAccess(this.stateCenter.useNetAgent),this.stateCenter.useNetAgent=this.RTM.getUseNetAgent()},e.prototype.setAudioOutputDevice=function(e,t){return s(this,void 0,void 0,(function(){var r;return a(this,(function(n){switch(n.label){case 0:return(r=null==e?void 0:e.setSinkId)?(e.setsinkid&&(e.setsinkid.enabled=!0),[4,r.call(e,t)]):[3,2];case 1:return n.sent(),[2,!0];case 2:throw Error("Browser not support set audio output.")}}))}))},e.prototype.enableCameraCapturing=function(e,t){return void 0===t&&(t=!0),s(this,void 0,void 0,(function(){return a(this,(function(e){return console.error("should use advanced module first"),[2,!1]}))}))},e.prototype.enableDualStream=function(e){this.rtcModules.advancedModule?this.rtcModules.advancedModule.enableDualStream(e):console.error("use advance module first")},e.prototype.setLowStreamParameter=function(e,t){this.rtcModules.advancedModule?this.rtcModules.advancedModule.setLowStreamParameter(e,t):console.error("use advance module first")},e.prototype.setRemoteDefaultVideoStreamType=function(e){this.logger.info("zc.srdvs call"),[0,1,2].includes(e)?this.stateCenter.streamType=e:this.logger.error("zc.srdvs streamType must be number 0 or 1 or 2")},e.prototype.enableVideoHardwareEncoder=function(e){if("boolean"==typeof e){var t=this.stateCenter.settingConfig;t.setUserValue("hardware_encode",e),t.setUserValue("camera_hard_encode",e),t.setUserValue("custom_hard_encode",e)}},e.prototype.createLocalViewer=function(e){var t=this.streamCenter.checkPreview(e),r=null==t?void 0:t.getViewer();if(!r)throw Error("create viewer failed.");return new T.ZegoStreamView(r)},e.prototype.createRemoteViewer=function(e){var t=this.streamCenter.checkPlayer(e),r=null==t?void 0:t.getViewer();if(!r)throw Error("create viewer failed.");return new T.ZegoStreamView(r)},e.prototype.enableAiDenoise=function(e,t){return new Promise((function(e,t){console.error("should install ai denoise module and advanced module"),e({errorCode:-1,extendedData:"should install ai denoise module and advanced module"})}))},e.prototype.enableAutoSwitchDevice=function(e){if(this.rtcModules.advancedModule)return this.rtcModules.advancedModule.enableAutoSwitchDevice(e);throw new Error("should use advanced module first")},e.screenShotReady=!1,e}();t.ZegoWebRTC=O,window.addEventListener("message",(function(e){var t=e.data.type,r=e.origin;r!==window.location.origin&&console.warn("ScreenStream: you should discard foreign event from origin:",r),"SS_PING"===t&&(O.screenShotReady=!0)}))},746:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalogSocket=void 0;var n,i,o=r(6706),s=r(1089);!function(e){e[e.Connected=0]="Connected",e[e.Disconnected=1]="Disconnected",e[e.Broken=2]="Broken"}(n||(n={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(i||(i={}));var a=function(){function e(e,t,r,i){var s=this;this.server=e,this.netAgent=t,this.signalConfig=r,this.logger=i,this.readyState=WebSocket.CLOSED,this.isActive=!1,this.accessServerState=n.Disconnected,this.originAccessServerState=n.Disconnected,this.mediaServerState=n.Disconnected,this.originMediaServerState=n.Disconnected,this.eventHandler={accessDisconnect:function(){s.setAccessServerState(n.Disconnected)},accessConnect:function(){s.setAccessServerState(n.Connected)},accessBroken:function(){s.setAccessServerState(n.Broken)},mediaDisconnect:function(){s.setMediaServerState(n.Disconnected)},mediaConnect:function(e){s.setMediaServerState(n.Connected,e)},mediaBroken:function(){s.setMediaServerState(n.Broken)}},this.wsHandler=t.getPCRequest("unified_rtc"===e?o.BusinessService.SERVICE_WEBRTC_SIGNAL:o.BusinessService.SERVICE_L3_WEBRTC_SIGNAL,{path:r.path,query:r.query}),this.setAccessServerState(t.isConnect()?n.Connected:n.Disconnected),this.setMediaServerState(0===this.wsHandler.connectState?n.Connected:n.Disconnected)}return e.prototype.updateAccessReadyState=function(){this.isActive&&this.accessServerState===n.Connected&&this.mediaServerState!==n.Connected?this.onreconnnecting&&this.onreconnnecting():this.accessServerState===n.Disconnected&&this.logger.warn(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_UPDATE_ACCESS_READY_STATE+" access timeout")},e.prototype.updateMediaReadyState=function(e){return this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_UPDATE_MEDIA_READY_STATE+" "+e),this.mediaServerState===n.Connected?(this.originMediaServerState===n.Broken&&e===i.AUTO&&this.onreconnnecting&&this.onreconnnecting(),void(this.readyState!==WebSocket.OPEN&&(this.readyState=WebSocket.OPEN,this.onopen&&this.onopen()))):this.mediaServerState===n.Disconnected?(this.wsHandler.off("connected",this.eventHandler.mediaConnect),this.wsHandler.off("disconnected",this.eventHandler.mediaDisconnect),this.wsHandler.off("broken",this.eventHandler.mediaBroken),this.wsHandler.off("downLoadMessage"),this.netAgent.off("connected",this.eventHandler.accessConnect),this.netAgent.off("disconnected",this.eventHandler.accessDisconnect),this.netAgent.off("broken",this.eventHandler.accessBroken),void(this.readyState!==WebSocket.CLOSED&&(this.readyState=WebSocket.CLOSED,this.onclose&&this.onclose()))):void(this.mediaServerState===n.Broken&&(this.readyState=WebSocket.CONNECTING,this.onerror&&this.onerror(new Event("signal connecting"))))},e.prototype.setMediaServerState=function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_MEDIA_SERVER_STATE+" "+e+" "+t),this.mediaServerState!==e?(this.originMediaServerState=this.mediaServerState,this.mediaServerState=e,this.updateMediaReadyState(t)):this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_MEDIA_SERVER_STATE+" same state")},e.prototype.setAccessServerState=function(e){this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_ACCESS_SERVER_STATE+" "+e),this.accessServerState!==e?(this.originAccessServerState=this.accessServerState,this.accessServerState=e,this.updateAccessReadyState()):this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_ACCESS_SERVER_STATE+" same state")},e.prototype.open=function(){var e=this;this.isActive=!0,this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_OPEN+" state "+this.mediaServerState),this.mediaServerState===n.Disconnected&&(this.wsHandler.on("connected",this.eventHandler.mediaConnect),this.wsHandler.on("disconnected",this.eventHandler.mediaDisconnect),this.wsHandler.on("broken",this.eventHandler.mediaBroken),this.netAgent.on("connected",this.eventHandler.accessConnect),this.netAgent.on("disconnected",this.eventHandler.accessDisconnect),this.netAgent.on("broken",this.eventHandler.accessBroken),this.wsHandler.on("downLoadMessage",(function(t){e.logger.info("zc.as.op download msg "+t),e.onmessage({data:t})})))},e.prototype.close=function(){this.isActive=!1,this.wsHandler.off("connected",this.eventHandler.mediaConnect),this.wsHandler.off("disconnected",this.eventHandler.mediaDisconnect),this.wsHandler.off("broken",this.eventHandler.mediaBroken),this.wsHandler.off("downLoadMessage"),this.netAgent.off("connected",this.eventHandler.accessConnect),this.netAgent.off("disconnected",this.eventHandler.accessDisconnect),this.netAgent.off("broken",this.eventHandler.accessBroken),this.wsHandler.closeRequest()},e.prototype.send=function(e,t,r){var n=this;this.wsHandler.sendRequest({payload:e,ack:t,isInSendMap:r},(function(e){n.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SEND+" fail "+e),n.onerror&&n.onerror(e)}),(function(e){n.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SEND+" suc "+e)}))},e.prototype.onopen=function(){},e.prototype.onclose=function(e){},e.prototype.onerror=function(e){},e.prototype.onmessage=function(e){},e.prototype.onreconnnecting=function(){},e}();t.AnalogSocket=a},3544:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingTimer=void 0;var n=r(4418),i=function(){function e(e,t){this.logger=e,this.stateCenter=t,this.chargeInfosInterval=6e4,this.reporting=!1}return Object.defineProperty(e.prototype,"chargeInfosSaver",{get:function(){return this.stateCenter.chargeInfosSaver},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamCenter",{get:function(){return this.stateCenter.streamCenter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roomChargeInfos",{get:function(){return this._roomChargeInfos||(this._roomChargeInfos={itemtype:"ChargeInfos",timestamp_begin:0,timestamp_end:0,timestamp_diff_flag:0,timestamp_diff:0,infos:[]}),this._roomChargeInfos.timestamp_begin=(new Date).getTime(),0!==this._roomChargeInfos.timestamp_end?(this._roomChargeInfos.timestamp_diff=this._roomChargeInfos.timestamp_begin-this._roomChargeInfos.timestamp_end,this._roomChargeInfos.timestamp_diff_flag=1):(this._roomChargeInfos.timestamp_diff=0,this._roomChargeInfos.timestamp_diff_flag=0),this._roomChargeInfos.timestamp_end=(new Date).getTime(),this._roomChargeInfos.infos=[{is_publishing:0,play_max_audio_bitrate:0,play_stream_resolution_infos:[],no_playing:1}],this._roomChargeInfos},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chargeInfos",{get:function(){return this.streamCenter?this.streamCenter.getChargeInfos():this.roomChargeInfos},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldEnd",{get:function(){var e,t;return!!this.reporting&&(this.shouldReportRoomTime?(null===(e=this.stateCenter.rtm)||void 0===e||e.stateCenter.roomModulesList.filter((function(e){!e.isLogout()&&e.isDisConnect()})),0===(null===(t=this.stateCenter.rtm)||void 0===t?void 0:t.stateCenter.roomModulesList.filter((function(e){return!e.isLogout()||!e.isDisConnect()})).length)):!this.streamCenter||!this.streamCenter.signalList||0===Object.keys(this.streamCenter.signalList).length)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldReportRoomTime",{get:function(){var e,t,r;return!(!(null===(e=this.stateCenter.rtm)||void 0===e?void 0:e.stateCenter.appConfig)||!(null===(t=this.stateCenter.rtm)||void 0===t?void 0:t.stateCenter.appConfig.speedlog_config)||1!==(null===(r=this.stateCenter.rtm)||void 0===r?void 0:r.stateCenter.appConfig.speedlog_config.charge_info_report_no_playing))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReporting",{get:function(){return this.reporting},enumerable:!1,configurable:!0}),e.prototype.startChargeInfoTimer=function(){var e=this;if(this.chargeInfosTimer&&(clearTimeout(Number(this.chargeInfosTimer)),this.chargeInfosTimer=null,this.shouldEnd))return this.logger.info(n.ZEGO_BILLING_ACTION.START_CHARGE_INFO_TIMER+" chargeinfos timer report ended"),void(this.reporting=!1);this.chargeInfosTimer=setTimeout((function(){e.logger.report(e.chargeInfos),e.startChargeInfoTimer()}),this.chargeInfosInterval)},e.prototype.startChargeInfosUpload=function(){this.reporting||(this.reporting=!0,this.shouldReportRoomTime&&this.logger.report(this.chargeInfos),this.startChargeInfoTimer(),this.logger.info("zsc.sciu.0 call"))},e.prototype.stopChargeInfosUpload=function(){this.logger.info("zsc.sciu.1 call"),this.chargeInfosTimer&&this.shouldEnd&&(this.logger.info("zsc.sciu.1 stop"),clearTimeout(Number(this.chargeInfosTimer)),this.chargeInfosTimer=null,this.shouldReportRoomTime&&this.logger.report(this.chargeInfos),this.reporting=!1,this.logger.info("zsc.sciu.1 chargeinfos timer report ended"))},e.prototype.samplingChargeInfos=function(){return this.chargeInfos},e}();t.BillingTimer=i},1378:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChargeInfosSaverWeb=void 0;var n=r(4418),i=function(){function e(e,t){this.logger=e,this.stateCenter=t,this.bindListener()}return Object.defineProperty(e.prototype,"billingTimer",{get:function(){return this.stateCenter.billingTimer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"KEY",{get:function(){var e;return"z_cginfos_cache_".concat(null===(e=this.stateCenter.rtm)||void 0===e?void 0:e.stateCenter.appid)},enumerable:!1,configurable:!0}),e.prototype.bindListener=function(){var e=this;window.addEventListener("beforeunload",(function(){if(e.billingTimer.isReporting){var t=e.billingTimer.samplingChargeInfos();e.saveChargeInfosByLocalStorage(t)}}))},e.prototype.saveChargeInfosByLocalStorage=function(e){return this.logger.info(n.ZEGO_BILLING_ACTION.CHARGEINFO_SAVING_LOCALSTORAGE+" call"),localStorage.setItem(this.KEY,JSON.stringify(e))},e.prototype.getAndRemoveChargeInfosFromLocalStorage=function(){this.logger.info(n.ZEGO_BILLING_ACTION.CHARGEINFO_GET_AND_REMOVE_LOCALSTORAGE+" call");var e=localStorage.getItem(this.KEY);return localStorage.removeItem(this.KEY),e},e.prototype.report=function(e){this.logger.report(e)},e.prototype.checkAndReport=function(){this.logger.info(n.ZEGO_BILLING_ACTION.SAVED_CHARGEINFO_REPORT+" call");var e=this.getAndRemoveChargeInfosFromLocalStorage();if(null!=e){var t=JSON.parse(e);this.report(t),this.logger.info(n.ZEGO_BILLING_ACTION.SAVED_CHARGEINFO_REPORT+" reported")}},e}();t.ChargeInfosSaverWeb=i},4418:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_BILLING_ACTION=void 0,function(e){e.SAVED_CHARGEINFO_REPORT="zc.bill.scir",e.CHARGEINFO_SAVING_LOCALSTORAGE="zc.bill.cisl",e.CHARGEINFO_GET_AND_REMOVE_LOCALSTORAGE="zc.bill.cigrl",e.START_CHARGE_INFO_TIMER="zc.bill.tm.scit"}(t.ZEGO_BILLING_ACTION||(t.ZEGO_BILLING_ACTION={}))},4395:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CheckModule=void 0;var o=r(4767),s=function(){function e(){var e=this;this.iceconnectionstatechangeTimes=0,this.isCheckAll=!1;var t=document.createElement("canvas");t.getContext("2d").fillStyle="rgba(255, 255, 255, 0)";try{this.localStream=t.captureStream()}catch(e){console.error("canvas captureStream error",e)}this.timer=setTimeout((function(){e.resolve("Detection timeout"),e.hangup()}),5e3)}return e.prototype.checkSupportByType=function(e){return n(this,void 0,void 0,(function(){var t,r,n=this;return i(this,(function(i){switch(i.label){case 0:return this.checkType=e,t={},this.localPc=new RTCPeerConnection(t),this.remotePc=new RTCPeerConnection(t),r=new Promise((function(e){return n.resolve=e})),this.localPc.addEventListener("icecandidate",(function(e){return n.onIceCandidate(n.localPc,e)})),this.remotePc.addEventListener("icecandidate",(function(e){return n.onIceCandidate(n.remotePc,e)})),this.remotePc.addEventListener("iceconnectionstatechange",(function(t){"connected"===n.remotePc.iceConnectionState&&(n.iceconnectionstatechangeResult=!0),2==++n.iceconnectionstatechangeTimes&&n.iceCandidate&&(clearTimeout(n.timer),n.resolve("connected"===n.remotePc.iceConnectionState||"The browser does not support ".concat(e," format")),n.hangup())})),this.localStream.getTracks().forEach((function(e){return n.localPc.addTrack(e,n.localStream)})),[4,this.check(e)];case 1:return i.sent(),[4,r];case 2:return[2,i.sent()]}}))}))},e.prototype.check=function(e){return n(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.localPc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 1:return(t=n.sent()).sdp=o.SdpUtil.getSDPByVideDecodeType(t.sdp,e),this.onCreateOfferSuccess(t),[3,3];case 2:return r=n.sent(),this.onCreateSessionDescriptionError(r),[3,3];case 3:return[2]}}))}))},e.prototype.onCreateOfferSuccess=function(e){return n(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.localPc.setLocalDescription(e)];case 1:return i.sent(),[3,3];case 2:return t=i.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return i.trys.push([3,5,,6]),[4,this.remotePc.setRemoteDescription(e)];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),this.onSetSessionDescriptionError(r),[2];case 6:return i.trys.push([6,9,,10]),[4,this.remotePc.createAnswer()];case 7:return n=i.sent(),[4,this.onCreateAnswerSuccess(n)];case 8:return i.sent(),[3,10];case 9:return o=i.sent(),this.onCreateSessionDescriptionError(o),[2];case 10:return[2]}}))}))},e.prototype.onCreateAnswerSuccess=function(e){return n(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.remotePc.setLocalDescription(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return n.trys.push([3,5,,6]),[4,this.localPc.setRemoteDescription(e)];case 4:return n.sent(),[3,6];case 5:return r=n.sent(),this.onSetSessionDescriptionError(r),[2];case 6:return[2]}}))}))},e.prototype.onIceCandidate=function(e,t){return n(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getOtherPc(e).addIceCandidate(t.candidate)];case 1:return n.sent(),[3,3];case 2:return r=n.sent(),console.error(this.checkType,"".concat(this.getPcName(e)," addIceCandidate error"),r),clearTimeout(this.timer),this.hangup(),this.resolve(r),[3,3];case 3:return"remotePc"===this.getPcName(e)&&t.candidate&&(this.iceCandidate=!0),this.iceconnectionstatechangeResult&&"localPc"===this.getPcName(e)&&(clearTimeout(this.timer),this.hangup(),this.resolve(!0)),[2]}}))}))},e.prototype.getOtherPc=function(e){return e===this.localPc?this.remotePc:this.localPc},e.prototype.getPcName=function(e){return e===this.localPc?"localPc":"remotePc"},e.prototype.onCreateSessionDescriptionError=function(e){console.error("Failed to create session description: ".concat(e.toString())),clearTimeout(this.timer),this.hangup(),this.resolve(e)},e.prototype.onSetSessionDescriptionError=function(e){console.error("Failed to set session description: ".concat(e.toString())),clearTimeout(this.timer),this.hangup(),this.resolve(e)},e.prototype.hangup=function(){this.localPc.close(),this.remotePc.close(),this.iceconnectionstatechangeTimes=0,this.localStream.getTracks().forEach((function(e){return e.stop()}))},e}();t.CheckModule=s},8493:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryDispatchHandler=void 0;var o=r(6502),s=r(6706),a=r(1089),c=r(3529),u=r(2752),l=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.retryActiveCount=1,o.RETRY_MAX_TIME=90,o.logger=t,o.stateCenter=r,o.rtm=n,o.streamCenter=i,o}return i(t,e),t.prototype.initStream=function(e,t,r){this.streamID=e,this.playOption=t,this.isPublish=r},t.prototype.active=function(e){var t=this;if(this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" retry call "+this.streamID),this.retryTimer)return this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" has active, ignore"),!1;var r=this.rtm.isDisConnect()&&this.stateCenter.networkState==s.ENUM_NETWORK_STATE.offline;if(r){if(this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" check if really offline"),this.retryNetCount>=this.retryNetMaxTimes)return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" network is broken, stop retry"),!1}else this.retryNetCount=0;if(this.isOverTime)return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" retry over time, stop retry"),!1;if(!this.rtm.isLogin()){this.stopMaxTime(),this.invalid();var n=this.isPublish?this.streamCenter.publisherList[this.streamID]:this.streamCenter.playerList[this.streamID];n&&(n.isReDispatch=!0)}var i=this.retryActiveCount-1,o=this.playOption&&2==this.playOption.resourceMode?1:0,c={stream_id:this.streamID,ptype:this.isPublish?"push":"pull",signals:this.streamCenter.getAllInUseUrl(),header_kvs:[{key:"grpc-metadata-push",value:this.playOption&&this.playOption.cdnUrl||""}],retry:i,center_ability:!0,dispatch_type:o};return this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=setTimeout((function(){t.retryTimer=null,r?t.retryNetCount++:t.retryActiveCount++;var e=t.streamCenter.getRoomByStreamID(t.streamID),n=t.rtm.service.sendMessage("webrtc_url",c,(function(e,r){t.handleFetchWebRtcUrlRsp(e)}),(function(e,r){t.handleFetchWebRtcUrlRsp(e)}),void 0,{sessionID:null==e?void 0:e.sessionID,roomID:null==e?void 0:e.roomID,roomSessionID:null==e?void 0:e.roomSessionID});t.isPublish&&n?t.streamCenter.publisherList[t.streamID]&&(t.streamCenter.publisherList[t.streamID].seq=n):n&&t.streamCenter.playerList[t.streamID]&&(t.streamCenter.playerList[t.streamID].seq=n)}),"number"==typeof e?e:1e3*this.retryActiveInterval),this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" call success"),!0},t.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.maxTimer=setTimeout((function(){e.logger.warn("".concat(a.ZEGO_WEBRTC_ACTION.RDH_MAX_TIME," ").concat(e.streamID," dispatch over max time ").concat(e.RETRY_MAX_TIME,"s stop retry")),e.isOverTime=!0,e.invalid();var t=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError;t.message=t.message+" try max limit",e.isPublish?e.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.error,e.streamID,t):e.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,e.streamID,t)}),1e3*this.RETRY_MAX_TIME))},t.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.handleFetchWebRtcUrlRsp=function(e){if(e.code&&[u.errorCodeList.TIMEOUT.code].includes(e.code))this.active();else{if(e.code&&[u.errorCodeList.SOCKET_CLOSE.code].includes(e.code))return this.stopMaxTime(),this.invalid(),void(this.isPublish?this.streamCenter.publisherList[this.streamID].isReDispatch=!0:this.streamCenter.playerList[this.streamID].isReDispatch=!0);var t=e,r=t.body.stream_id,n=!1;if(this.isPublish&&(!this.streamCenter.publisherList[r]||t.header.seq!==this.streamCenter.publisherList[this.streamID].seq))return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" seq is not match, ignore "+this.streamID),this.stopMaxTime(),void this.invalid();if(!(this.isPublish||this.streamCenter.playerList[this.streamID]&&t.header.seq===this.streamCenter.playerList[this.streamID].seq))return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" seq is not match, ignore "+this.streamID),this.stopMaxTime(),void this.invalid();if(this.stateCenter.clientIP=t.body.clientip||"",0===t.body.err_code||2!=t.body.need_action)if(0===t.body.err_code||1===t.body.need_action||[3102].includes(t.body.err_code)){if(this.stopMaxTime(),this.invalid(),t.body.urls&&Array.isArray(t.body.urls)&&t.body.urls.length>0?n=!0:this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" signal url is empty"),"push"===t.body.ptype&&this.streamCenter.publisherList[r]){if(!n)return void this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.error,r,c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishDispatchError);var i=this.streamCenter.publisherList[r];this.stateCenter.publishStreamList[r]?(i.ttl=t.body.hosts_ttl?(new Date).getTime()+1e3*t.body.hosts_ttl:0,i.isCenterNode="boolean"==typeof t.body.is_center_node&&t.body.is_center_node,i.serverUrls=t.body.urls,this.streamCenter.startPublishingStream(r)):this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" no streamid to publish")}else if("pull"==t.body.ptype&&this.streamCenter.playerList[r]){var o;if(!n)return(o=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=o.message+(t.body.err_code?" server error:"+t.body.err_code:""),3102===t.body.err_code&&(o=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayUnsupportedResourceMode),void this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,r,o);var l=this.streamCenter.playerList[r];l.ttl=t.body.hosts_ttl?(new Date).getTime()+1e3*t.body.hosts_ttl:0,l.isCenterNode="boolean"==typeof t.body.is_center_node&&t.body.is_center_node,l.serverUrls=t.body.urls,this.streamCenter.startPlayingStream(r,this.stateCenter.useNetAgent,this.streamCenter.playSuccessCallBackList[r])}}else this.retryActiveInterval=Math.floor(3*Math.random())+3,2==this.retryActiveCount&&((o=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=o.message+(t.body.err_code?" server error:"+t.body.err_code:""),"push"===t.body.ptype?this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.retry,r,o):this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,r,o)),this.active();else this.retryActiveInterval=t.body.action_delay/1e3||Math.floor(3*Math.random())+3,2==this.retryActiveCount&&((o=c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=o.message+(t.body.err_code?" server error:"+t.body.err_code:""),"push"===t.body.ptype?this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.retry,r,o):this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,r,o)),this.active()}},t}(o.RetryHandler);t.RetryDispatchHandler=l},6014:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryStreamHandler=void 0;var o=r(6706),s=r(6502),a=r(3529),c=r(1089),u=r(608),l=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.logger=t,o.stateCenter=r,o.streamCenter=n,o.isPublish=i,o.serverUrls=[],o}return i(t,e),t.prototype.initStream=function(e,t){this.streamID=e,this.serverUrls=t},t.prototype.activePublish=function(e){var t=this;if(this.logger.info("zc.tsh.a retry call "+this.streamID),this.retryTimer)return this.logger.info("zc.tsh.a has active, ignore"),!1;var r=this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline;if(r){if(this.logger.info("zc.tsh.a check if really offline. "+this.retryNetCount),this.retryNetCount>=this.retryNetMaxTimes)return this.logger.warn("zc.tsh.a network is broken, stop retry"),!1}else this.retryNetCount=0;if(this.isOverTime)return this.logger.warn("zc.tsh.a retry over time, stop retry"),!1;if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var n=Math.pow(2,Math.floor(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1)-1);this.retryActiveInterval=n>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:n}var i=this.streamCenter.publisherList[this.streamID].publisher,s=this.serverUrls[0],a=["unified_rtc","unified_l3"].includes(s);if(!a){var c=this.serverUrls,u=i.signal?i.signal.server:"";c.forEach((function(e,r){return r<=c.indexOf(u)&&t.serverUrls.push(e)})),c.splice(0,c.indexOf(u)+1),s=this.serverUrls[this.retryActiveCount%this.serverUrls.length==0?this.serverUrls.length-1:this.retryActiveCount%this.serverUrls.length-1]}var l="number"==typeof e?e:1e3*this.retryActiveInterval;return this.retryTimer=setTimeout((function(){t.logger.info("zc.tsh.a stream ".concat(t.streamID," : connect to ").concat(a?"unified signal server":"signal server "+s)),t.retryTimer&&clearTimeout(t.retryTimer),t.retryTimer=null,r?t.retryNetCount++:t.retryActiveCount++,t.streamCenter.connectPublishServer(t.streamID,s)}),l),this.logger.info("zc.tsh.a call success. delay: "+l),!0},t.prototype.activePull=function(e,t){var r=this;if(this.logger.info("zc.tsh.a retry call "+this.streamID),t&&(this.playStreamSuccess=t),this.retryTimer)return this.logger.info("zc.tsh.a has active, ignore"),!1;var n=this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline;if(n){if(this.logger.info("zc.tsh.a check if really offline. "+this.retryNetCount),this.retryNetCount>=this.retryNetMaxTimes)return this.logger.warn("zc.tsh.a network is broken, stop retry"),!1}else this.retryNetCount=0;if(this.isOverTime)return this.logger.warn("zc.tsh.a retry over time, stop retry"),!1;if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var i=Math.pow(2,Math.floor(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1)-1);this.retryActiveInterval=i>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:i}var s=this.streamCenter.playerList[this.streamID].player,a=this.serverUrls,c=s.signal?s.signal.server:"",u=this.serverUrls[0],l=["unified_rtc","unified_l3"].includes(u);l||(a.forEach((function(e,t){return t<=a.indexOf(c)&&r.serverUrls.push(e)})),a.splice(0,a.indexOf(c)+1),u=this.serverUrls[this.retryActiveCount%this.serverUrls.length==0?this.serverUrls.length-1:this.retryActiveCount%this.serverUrls.length-1]);var d="number"==typeof e?e:1e3*this.retryActiveInterval;return this.retryTimer=setTimeout((function(){r.logger.warn("zc.tsh.a stream ".concat(r.streamID," : connect to ").concat(l?"unified signal server":"signal server "+u)),r.retryTimer&&clearTimeout(r.retryTimer),r.retryTimer=null,n?r.retryNetCount++:r.retryActiveCount++,r.streamCenter.connectPlayServer(r.streamID,r.playStreamSuccess,u)}),d),this.logger.info("zc.tsh.a call success. delay: "+d),!0},t.prototype.startMaxTime=function(){var e=this;this.logger.info("zc.tsh.smt ".concat(this.streamID," call")),this.maxTimer?this.logger.warn("zc.tsh.smt max timer"):(this.logger.info("zc.tsh.smt start max timer"),this.maxTimer=setTimeout((function(){if(e.logger.warn("zc.tsh.smt ".concat(e.streamID," over max time ").concat(e.RETRY_MAX_TIME,"s, stop retry")),e.isOverTime=!0,e.invalid(),e.isPublish){if(!e.streamCenter.publisherList[e.streamID])return void e.logger.info("zc.tsh.smt streamID "+e.streamID+" publish no found");e.publishStateHandle(o.ENUM_PUBLISH_STATE_UPDATE.error,e.streamID,a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishRetryTimeoutError,!0)}else{if(!e.streamCenter.playerList[e.streamID])return void e.logger.info("zc.tsh.smt streamID "+e.streamID+" play no found");e.playStateHandle(o.ENUM_PLAY_STATE_UPDATE.error,e.streamID,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRetryTimeoutError,!0)}}),1e3*this.RETRY_MAX_TIME))},t.prototype.stopMaxTime=function(){this.logger.info("zc.tsh.stmt streamID "+this.streamID+" "+!!this.maxTimer),this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.retryNextSignal=function(e){var t,r;if(this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline)return!0;if(this.isPublish){var n=this.streamCenter.publisherList[this.streamID];if(n.publisher.state==o.ENUM_PUBLISH_STATE.stop&&[a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError.code,a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNegoTimeoutError.code].includes(e.code))return!0;if(n.isCenterNode&&(null===(t=n.publisher.signal)||void 0===t?void 0:t.wsReadyState)==WebSocket.OPEN)return!1;if(!n.isCenterNode&&[a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError.code].includes(e.code)){var i=e.message.match(/reason:(\d+)/);return!["26"].includes(i?i[1]:"")}return!0}var s=this.streamCenter.playerList[this.streamID];return!(s.player.state!=o.ENUM_PLAY_STATE.stop||![a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionTimeoutError.code,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNegoTimeoutError.code].includes(e.code))||(!s.isCenterNode||(null===(r=s.player.signal)||void 0===r?void 0:r.wsReadyState)!=WebSocket.OPEN)&&(!(!s.isCenterNode&&[a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlaySessionClosedError.code].includes(e.code))||(i=e.message.match(/reason:(\d+)/),!["24","26","28"].includes(i?i[1]:"")))},t.prototype.publishStateHandle=function(e,t,r,n,i,s){var l=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" call "+t+" "+(r?r.code+"":"")+" "+n+" "+JSON.stringify(i)+" "+s);var d=n||this.RETRY_MAX_TIME<3;if(!d&&r&&(u.ClientUtil.isReDispatch(r)||0==this.serverUrls.length))return this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" stop "+d+" "+JSON.stringify(this.serverUrls)),this.stopMaxTime(),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,void this.streamCenter.onPublishStateUpdate(e,t,r);var h=this.streamCenter.publisherList[t],p=h.publisher;if(!d&&r&&0!==r.code){this.maxTimer||d||this.startMaxTime(),this.stateCenter.publishStreamList[t].state=o.ENUM_PUBLISH_STREAM_STATE.retryPublish;var f=p.localStream,g=p.videoInfo,m=p.mediaStreamConfig,_=p.publishOption;if(0!=p.sessionId&&p.signal&&p.shouldSendCloseSession()&&(p.signal.sendCloseSession((0,o.getSeq)(),p.sessionId,1),p.signal.removeSession(p.sessionId),p.closeSessionSignal=!0),p.resetPublish(),!d&&!this.retryNextSignal(r)){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" retry current signal "),h.isCenterNode){this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" current node "+p.gwNode+" failed "+JSON.stringify(p.retryFailGwNodes));var v=p.retryFailGwNodes.findIndex((function(e){return e===p.gwNode}));v>=0&&p.retryFailGwNodes.splice(v,1),p.retryFailGwNodes.push(p.gwNode),this.retryNewGwNode(p,r,i,s)}return this.startRetryTimer=setTimeout((function(){l.startRetryTimer&&clearTimeout(l.startRetryTimer),l.startRetryTimer=null,p.startPublish(t,f,g,m,_)}),1e3),void(r&&0!==r.code&&this.streamCenter.onPublishStateUpdate(2,t,r))}this.streamCenter.removeStreamFromSignal(!0,t)}if(d)return this.stopMaxTime(),this.invalid(),1===e&&p.resetPublish(),void this.streamCenter.onPublishStateUpdate(e,t,r);if(r&&0!==r.code&&this.activePublish(void 0)){p&&(p.isExternal=!1);var y=(0,o.getReportSeq)();this.streamCenter.dataReport.newReport(y),this.streamCenter.dataReport.addMsgInfo(y,{stream:a.ZegoRTCLogEvent.kZegoTaskRePublish.stream(this.streamID)}),this.streamCenter.dataReport.uploadReport(y,a.ZegoRTCLogEvent.kZegoTaskRePublish.event),this.streamCenter.onPublishStateUpdate(2,t,r)}this.logger.info(c.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" end "+t)},t.prototype.needReDispatchError=function(e){return[a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNetProbePoor.code,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNetProbePoor.code].includes(e.code)},t.prototype.playStateHandle=function(e,t,r,n,i,s){var l=this;this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" call "+t+" "+(r?r.code+"":"")+" "+n+" "+JSON.stringify(i)+" "+s);var d=n||this.RETRY_MAX_TIME<3;if(!d&&r&&(u.ClientUtil.isReDispatch(r)||0==this.serverUrls.length))return this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" stop "+d+" "+JSON.stringify(this.serverUrls)),this.stopMaxTime(),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,void this.streamCenter.onPlayStateUpdate(e,t,r);var h=this.streamCenter.playerList[t],p=h.player;if(!d&&r&&0!==r.code){!this.maxTimer&&!d&&this.startMaxTime();var f=p.playOption;if(0!=p.sessionId&&p.signal&&p.shouldSendCloseSession()&&(p.signal.sendCloseSession((0,o.getSeq)(),p.sessionId,1),p.signal.removeSession(p.sessionId),p.closeSessionSignal=!0),p.resetPlay(),!d&&!this.retryNextSignal(r)){if(this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" retry current signal "),h.isCenterNode){this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" current node "+p.gwNode+" "+JSON.stringify(p.retryFailGwNodes));var g=p.retryFailGwNodes.findIndex((function(e){return e===p.gwNode}));g>=0&&p.retryFailGwNodes.splice(g,1),p.retryFailGwNodes.push(p.gwNode),this.retryNewGwNode(p,r,i,s)}return this.startRetryTimer=setTimeout((function(){l.startRetryTimer&&clearTimeout(l.startRetryTimer),l.startRetryTimer=null,p.startPlay(t,p.getRemoteStreamSuc,f)}),1e3),void(r&&0!==r.code&&this.streamCenter.onPlayStateUpdate(2,t,r))}this.streamCenter.removeStreamFromSignal(!1,t)}if(d)return this.stopMaxTime(),this.invalid(),void this.streamCenter.onPlayStateUpdate(e,t,r);if(r&&0!==r.code&&this.activePull(void 0)){p&&(p.isExternal=!1);var m=(0,o.getReportSeq)();this.streamCenter.dataReport.newReport(m),this.streamCenter.dataReport.addMsgInfo(m,{stream:a.ZegoRTCLogEvent.kZegoTaskRePlay.stream(this.streamID)}),this.streamCenter.dataReport.uploadReport(m,a.ZegoRTCLogEvent.kZegoTaskRePlay.event),this.streamCenter.onPlayStateUpdate(2,t,r)}this.logger.info(c.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" end "+t)},t.prototype.retryNewGwNode=function(e,t,r,n){var i,o,s,a;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.RETRYSTREAMHANDLER_RETRY_NEW_GW_NODE+" call "+e.streamId),t&&t.code&&this.needReDispatchError(t))this.retryNextGwNode(e,!0,n);else if(null==r?void 0:r.action)switch(null==r?void 0:r.action){case 1:case 5:break;case 2:default:this.retryNextGwNode(e,!1,n);break;case 3:var u=null==r?void 0:r.ins;u&&u.length>0&&(console.warn(u[0]),e.gwNode=((null===(i=u[0])||void 0===i?void 0:i.IP)||(null===(o=u[0])||void 0===o?void 0:o.ip))+":"+((null===(s=u[0])||void 0===s?void 0:s.Port)||(null===(a=u[0])||void 0===a?void 0:a.port)));break;case 4:e.resetGwNodes(),this.streamCenter.clearCachedGwNodesList(e,this.isPublish)}else this.retryNextGwNode(e,!1,n);this.logger.info(c.ZEGO_WEBRTC_ACTION.RETRYSTREAMHANDLER_RETRY_NEW_GW_NODE+" "+e.streamId+" new node "+e.gwNode)},t.prototype.retryNextGwNode=function(e,t,r){var n;if(this.logger.info(c.ZEGO_WEBRTC_ACTION.RETRYSTREAMHANDLER_RETRY_NEXT_GW_NODE+" call "+e.streamId+" "+e.gwNode),0!==(null===(n=e.gwNodeList)||void 0===n?void 0:n.length)||e.gwNode){var i=e.gwNodesTTL<(new Date).getTime(),o=e.iceStateDisConnect&&this.stateCenter.isMultiOuter,s=e.gwNodeList.findIndex((function(t){return t==e.gwNode})),a=s===e.gwNodeList.length-1;this.logger.info(c.ZEGO_WEBRTC_ACTION.RETRYSTREAMHANDLER_RETRY_NEXT_GW_NODE+" "+e.streamId+" ttl: "+i+" ice: "+o+" last: "+a),t||i||e.isLastConnected&&o||a?e.resetGwNodes():e.gwNode=r?e.gwNodeList[0]:e.gwNodeList[++s%e.gwNodeList.length]}else this.logger.info(c.ZEGO_WEBRTC_ACTION.RETRYSTREAMHANDLER_RETRY_NEXT_GW_NODE+" call "+e.streamId+" gwNodeList is empty")},t}(s.RetryHandler);t.RetryStreamHandler=l},1691:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.GatewaySignal=void 0;var o=r(6348),s=r(608),a=r(1358),c=function(){function e(e){this.streamSignal=e,this.callbackMap={}}return e.prototype.mediaStreamSEIUUIDReq=function(e,t,r,c){return n(this,void 0,void 0,(function(){var n=this;return i(this,(function(i){return[2,new Promise((function(i,u){var l=o.webrtc_cmd.WebrtcCmdReqMsg.encode({usr_sei_filter:{sei_filter:c}}).finish(),d=s.ClientUtil.uint8arrayToBase64(l);n.streamSignal.sendGWCmd(e,t,{peer_id:r,cmd_id:5,body:d},(function(e,t,r){var n=a.WebRTCUtil.base64ToUint8Array(r.body),s=o.webrtc_cmd.WebrtcCmdRspMsg.decode(n);i(s)}),(function(e){u(e)}))}))]}))}))},e.prototype.metadataAck=function(e,t,r){return n(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){return n=o.webrtc_cmd.WebrtcCmdRspMsg.encode({meta_data_ack:{result:1}}).finish(),a=s.ClientUtil.uint8arrayToBase64(n),this.streamSignal.sendGWAck(e,t,{peer_id:r,cmd_id:1,body:a}),[2]}))}))},e.prototype.registerPushCallback=function(e,t,r){var n,i=this,s=this.callbackMap[t];s?s[e]=r:(this.callbackMap[t]=((n={})[e]=r,n),this.streamSignal.registerPushCallback("CmdPush",t,(function(e,t,r){var n=a.WebRTCUtil.base64ToUint8Array(r.body),s=o.webrtc_cmd.WebrtcCmdReqMsg.decode(n),c=Object.keys(s)[0];console.error("CmdPush",c,s),c=c||"meta_data_push";var u=i.callbackMap[t];if(u){var l=u[c];l&&l(e,t,r.body)}})))},e.prototype.unregisterPushCallback=function(e,t){var r=this.callbackMap[t];r&&(delete r[e],0===Object.keys(r).length&&(this.streamSignal.unregisterPushCallback("CmdPush",t),delete this.callbackMap[t]))},e}();t.GatewaySignal=c},908:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.RTCModules=void 0;var o=r(6706),s=r(6706),a=r(6706),c=r(3529),u=r(608),l=r(7560),d=r(361),h=r(4865),p=r(1089),f=r(2752),g=r(9595),m=function(){function e(e,t,r,n,i,o,s){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=n,this.rtm=i,this.ac=o,this.zegoWebRtc=s,this.mediaEleSources=[],this.publishModule=new d.PublishModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.rtm,this.zegoWebRtc),this.playModule=new h.PlayModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.rtm),this.initAdvance(),this.initStreamCommon(),this.initAudioMix(),this.init()}return e.prototype.init=function(){this.bindWindowListener(),this.bindRTMListener(),this.bindStreamCenterHandler()},e.prototype.initAudioMix=function(){},e.prototype.initAdvance=function(){},e.prototype.initStreamCommon=function(){},e.prototype.bindWindowListener=function(){var e=this,t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i);window.addEventListener(t?"pagehide":"firefox"===this.stateCenter.browser?"beforeunload":"unload",(function(){for(var t in window.event&&(window.event.cancelBubble=!0),e.streamCenter.publisherList)e.publishModule.stopPublishingStream(t);for(var t in e.streamCenter.playerList)e.playModule.stopPlayingStream(t)})),window.addEventListener("message",(function(t){var r=t.data,n=r.type;"SS_DIALOG_SUCCESS"===n&&e.screenStreamFrom(r.streamId,r.canRequestAudioTrack,u.ClientUtil.actionSuccessCallback("screenShare",e.stateCenter.callbackList)),"SS_DIALOG_CANCEL"===n&&u.ClientUtil.actionSuccessCallback("screenShare",e.stateCenter.callbackList)(!1,null,n)})),window.addEventListener("offline",(function(){if(e.logger.info("zc.off.0 network is broken"),e.stateCenter.networkState=a.ENUM_NETWORK_STATE.offline,e.stateCenter.useNetAgent)e.logger.info("zc.off.0 use netAgent");else{for(var t in e.streamCenter.publisherList)(n=e.streamCenter.publisherList[t].retryStreamHandler).startMaxTime(),n.invalid();for(var t in e.streamCenter.playerList){var r=e.streamCenter.playerList[t],n=r.retryStreamHandler;r.playMode==o.PlayMode.CDN&&r.cdnPlayer&&(r.cdnPlayer.canRetry=!1),n.startMaxTime(),n.invalid()}}})),window.addEventListener("online",(function(t){for(var r in e.logger.info("zc.on.0 network is online"),e.stateCenter.networkState=a.ENUM_NETWORK_STATE.online,e.streamCenter.publisherList){var n=e.streamCenter.publisherList[r].publisher,i=e.streamCenter.publisherList[r].retryStreamHandler;n.state==a.ENUM_PUBLISH_STATE.stop||n.stateNego!==a.ENUM_PUBLISH_STATE_NEGO.iceConnected?!i.isOverTime&&i.publishStateHandle(a.ENUM_PUBLISH_STATE_UPDATE.error,r,c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNetworkBrokenError):n.state==a.ENUM_PUBLISH_STATE.publishing&&i.stopMaxTime()}for(var r in e.streamCenter.playerList){var s=e.streamCenter.playerList[r].player,u=e.streamCenter.playerList[r].playMode,l=(i=e.streamCenter.playerList[r].retryStreamHandler,e.streamCenter.playerList[r].cdnPlayer);u==o.PlayMode.CDN&&l&&(l.canRetry=!1),s.state==a.ENUM_PLAY_STATE.stop||u!==o.PlayMode.CDN&&s.stateNego!==a.ENUM_PLAY_STATE_NEGO.iceConnected?!i.isOverTime&&i.playStateHandle(a.ENUM_PLAY_STATE_UPDATE.error,r,c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNetworkBrokenError):s.state==a.ENUM_PLAY_STATE.playing&&i.stopMaxTime()}})),window.addEventListener("visibilitychange",(function(t){if(Object.keys(e.streamCenter.publisherList).length>0||Object.keys(e.streamCenter.playerList).length>0){var r=(0,a.getReportSeq)();e.dataReport.newReport(r,c.ZegoRTCLogEvent.kZegoVisibilityChange.event),e.dataReport.uploadReport(r)}}))},e.prototype.bindRTMListener=function(){var e,t,r=this;this.rtm._on("_settingCanFetch",(function(e){return n(r,void 0,void 0,(function(){var e=this;return i(this,(function(t){return this.rtm.cloudSetting.fetchSetting(g.RTC).then((function(t){e.logger.info("zc.scf stream config "+JSON.stringify(t)),t&&e.stateCenter.settingConfig.setSetting(t.setting,["auto_to_tcp","udp_max_fail_num","probe_started_num","hardware_encode","camera_hard_encode","custom_hard_encode"]),e.rtm._on("_cloudSettingNotify",(function(t,r){var n=(0,a.getReportSeq)();e.dataReport.newReport(n,c.ZegoRTCLogEvent.kZegoTaskCloudSettingRefresh.event);var i=e.rtm.cloudSetting.getEnvVariables();e.dataReport.addMsgInfo(n,{params:i,files:[{name:t,content:r.setting,versions:r.versions}]}),e.dataReport.uploadReport(n)}))})),[2]}))}))})),this.rtm._on("_appConfigRsp",(function(){r.stateCenter.appConfig=r.rtm.getAppConfig(),r.publishModule.startWaitPublish(),r.playModule.startWaitPlay()})),this.rtm._on("_roomLogin",(function(e,t){r.stateCenter.appid=r.rtm.getAppID(),r.stateCenter.idName=r.rtm.getUserID(),r.stateCenter.testEnvironment=r.rtm.isTestEnvironment(),r.stateCenter.isMultiRoom=r.rtm.getMultiRoom(),r.stateCenter.useNetAgent=r.rtm.getUseNetAgent(),r.streamCenter.setSessionInfo(r.stateCenter.appid,r.stateCenter.idName,r.stateCenter.testEnvironment);var n=r.stateCenter.getRoomByRoomID(e);if(!n){var i=new l.StreamHandler(r.logger,r.stateCenter,r.rtm,r.streamCenter,e);r.bindStreamHandler(i),r.stateCenter.roomList.push(n={roomID:e,streamHandler:i,sessionID:"",roomSessionID:"",token:t,isResetRoom:!1,streamList:[],streamInfoList:[]})}})),this.rtm._on("roomLoginResponse",(function(e){r.logger.info("zc.rlr call "+JSON.stringify(e));var t=e.header.room_id||e.body.room_id;r.stateCenter.appConfig=r.rtm.getAppConfig();var n=r.rtm.getToken(t),i=r.rtm.getSessionId(t),o=r.rtm.getRoomSessionID(t),s=r.stateCenter.getRoomByRoomID(t);if(!s){var a=new l.StreamHandler(r.logger,r.stateCenter,r.rtm,r.streamCenter,t);r.bindStreamHandler(a),r.stateCenter.roomList.push(s={roomID:t,streamHandler:a,sessionID:i,roomSessionID:o,token:n,isResetRoom:!1,streamList:[],streamInfoList:[]})}if(s.sessionID=i,s.roomSessionID=o,r.stateCenter.tempRoomList.length>0)for(var c=function(e){var t=r.stateCenter.tempRoomList[e],n=t.roomID,i=t.streamList,o=r.stateCenter.roomList.find((function(e){return e.roomID===n}));o&&(o.streamList=i.filter((function(e){var t=r.streamCenter.stopedPlayerList[null==e?void 0:e.stream_id];return!!(t&&t.state<=6)})),r.stateCenter.tempRoomList[e].streamList=[])},u=0;u<r.stateCenter.tempRoomList.length;u++)c(u);if(1===e.body.stream_fetch_flag)return r.logger.info("zc.rlr stream fetch "+t),s.streamHandler.room=s,void s.streamHandler.fetchStreamList();s.streamHandler.handleStreamStart(e,s),r.logger.info("zc.rlr end "+t)})),this.rtm._on("_connectChanged",(function(e,t){r.logger.info("zc.cc.0 "+e+" "+JSON.stringify(t)),"connecting"===e?r.stateCenter.connectChanged=!0:"connected"===e&&(r.stateCenter.connectChanged=!1,r.stateCenter.useNetAgent=r.rtm.getUseNetAgent(),r.handleWaitPublishAndPlays(t))})),this.rtm._on("HBResponse",(function(e){var t,n=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,i=r.stateCenter.getRoomByRoomID(n);null==i||i.streamHandler.patchStreamList(e)})),this.rtm._on("_roomStateUpdate",(function(e,t,n,i,o){if("CONNECTED"===t&&r.stateCenter.billingTimer.shouldReportRoomTime&&r.stateCenter.billingTimer.startChargeInfosUpload(),"DISCONNECTED"==t){r.logger.info("zc.rsu "+e+" disconnected "+(n?n+" ":"")+(i||"")+o),r.stateCenter.billingTimer.stopChargeInfosUpload();var s=r.stateCenter.getRoomByRoomID(e);if(s){var a=r.stateCenter.roomList.findIndex((function(t){return t.roomID==e}));s.isResetRoom=!0,s.streamHandler.reset(),r.streamCenter.reset(e,n,o),r.stateCenter.roomList.splice(a,1),o?r.stateCenter.tempRoomList.push(s):r.stateCenter.tempRoomList=r.stateCenter.tempRoomList.filter((function(t){return t.roomID!==e}))}}else r.logger.info("zc.rsu "+e+" state: "+t)})),this.rtm._on("_tokenRenewed",(function(e,t){r.logger.info("zc.tr roomID:"+t+" "+e);var n=r.stateCenter.getRoomByRoomID(t);n&&(n.token=e)})),this.rtm._on("_tokenExpired",(function(e){var t,n;((null===(n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.stop_stream)||void 0===n?void 0:n.stream_id_list)||[]).forEach((function(e){r.publishModule.stopPublishingStream(e,f.errorCodeList.TOKEN_EXPIRED)}))})),this.rtm.service.on("stream",(function(e){var t,n=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",i=r.stateCenter.getRoomByRoomID(n);i?i.streamHandler.handleStreamUpdateRsp(e):r.logger.error(p.ZEGO_WEBRTC_ACTION.ON_STREAM+" room no found")})),this.rtm.liveRoomHandler.handlePushStreamMsg=function(e){e.body.stream_cmd=s.streamMap[e.header.sub_cmd],r.handlePushStreamMsg(e)},null===(e=this.rtm.service)||void 0===e||e.on("push_stream_update",(function(e){r.handlePushStreamMsg(e)})),null===(t=this.rtm.service)||void 0===t||t.on("zegochat_js.push_room_stream_update_req",(function(e){var t,n=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",i=r.stateCenter.getRoomByRoomID(n);i?i.streamHandler.handlePriPushStreamUpdateMsg(e):r.logger.error(p.ZEGO_WEBRTC_ACTION.ON_STREAM+" room no found")}))},e.prototype.handleWaitPublishAndPlays=function(e){for(var t=Object.keys(this.stateCenter.waitPublishStreamList),r=0;r<t.length;r++){var n=t[r],i=this.stateCenter.waitPublishStreamList[n],o=i.localStream,s=i.publishOption,a=i.isDataChannel;if(i.retryStart){if(s.roomID&&s.roomID!==(null==e?void 0:e.roomID)){this.logger.info("zc.hwpap.0 room not connect");continue}this.publishModule.startPublishingStream(n,o,s,a),delete this.stateCenter.waitPublishStreamList[n]}}},e.prototype.handlePushStreamMsg=function(e){var t,r=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",n=this.stateCenter.getRoomByRoomID(r);n?n.streamHandler.handlePushStreamUpdateMsg(e):this.logger.error(p.ZEGO_WEBRTC_ACTION.ON_PUSH_STREAM_UPDATE+" room no found")},e.prototype.bindStreamCenterHandler=function(){var e=this;this.streamCenter.onPlayStateUpdate=function(t,r,n){var i,o=e.stateCenter.reportSeqList.startPlay[r],s=e.streamCenter.playerList[r];if(1==t&&s&&u.ClientUtil.isReDispatch(n)){var a=s.player,c=s.retryDispatchHandler,l=s.playOption;return 0!=a.sessionId&&a.signal&&a.shouldSendCloseSession()&&(a.signal.sendCloseSession(e.stateCenter.getSeq(),a.sessionId,1),a.signal.removeSession(a.sessionId),a.closeSessionSignal=!0),a.resetPlay(),c.stopMaxTime(),c.invalid(),c.initStream(r,l,!1),void(e.rtm.isLogin()?(c.startMaxTime(),c.active(0)):e.streamCenter.playerList[r].isReDispatch=!0)}if(s&&s.player&&(0==t||1==t)&&o&&(e.dataReport.eventEndWithMsgInfo(o,"PlayState",{type:t}),1==t&&n&&e.dataReport.addMsgInfo(o,n),e.dataReport.addMsgInfo(o,{session_id:s.player.sessionId}),e.dataReport.uploadReport(o),delete e.stateCenter.reportSeqList.startPlay[r]),1===t&&e.streamCenter.playErrorCallBackList[r])e.stateCenter.connectChanged||(e.logger.info("zc.opsu.1 connect changed"),e.streamCenter.playErrorCallBackList[r]({errorCode:n&&n.code,extendedData:n&&n.message}),delete e.streamCenter.playErrorCallBackList[r]),e.logger.info("zc.opsu.1 stop play called by sdk"),e.playModule.stopPlayingStream(r,n);else{var d=u.ClientUtil.getPlayerStateType(t);(1===t||(null===(i=null==s?void 0:s.player)||void 0===i?void 0:i.updateCBState({state:d,code:n.code})))&&e.stateCenter.actionListener("playerStateUpdate",{state:d,streamID:r,errorCode:n&&n.code,extendedData:n&&n.message})}},this.streamCenter.onPublishStateUpdate=function(t,r,n){e.onPublishStateUpdateHandle(t,r,n)},this.streamCenter.onPublishQualityUpdate=function(t,r){e.stateCenter.actionListener("publishQualityUpdate",t,r)},this.streamCenter.onPlayQualityUpdate=function(t,r){e.stateCenter.actionListener("playQualityUpdate",t,r)},this.streamCenter.onRemoteCameraStatusUpdate=function(t,r,n){var i=(0,a.getReportSeq)();e.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.event),e.dataReport.addMsgInfo(i,{stream:c.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.stream(t),status:c.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.status(r)}),e.dataReport.uploadReport(i),e.stateCenter.actionListener("remoteCameraStatusUpdate",t,r),e.stateCenter.actionListener("_remoteCameraStatusUpdate",t,n)},this.streamCenter.onRemoteMicStatusUpdate=function(t,r,n){var i=(0,a.getReportSeq)();e.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.event),e.dataReport.addMsgInfo(i,{stream:c.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.stream(t),status:c.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.status(r)}),e.dataReport.uploadReport(i),e.stateCenter.actionListener("remoteMicStatusUpdate",t,r),e.stateCenter.actionListener("_remoteMicStatusUpdate",t,n)},this.streamCenter.onSoundLevelUpdate=function(t){e.stateCenter.actionListener("soundLevelUpdate",t)},this.streamCenter.onMicSoundLevelUpdate=function(t){e.stateCenter.actionListener("capturedSoundLevelUpdate",t)}},e.prototype.bindStreamHandler=function(e){var t=this;e.onStreamUpdated=function(e,r,n){var i=n.map((function(e){return{streamID:e.streamID,user:e.user,extraInfo:e.extraInfo,urlsFLV:e.urlFlv,urlsRTMP:e.urlRtmp,urlsHLS:e.urlHls,urlsHttpsFLV:e.urlHttpsFlv,urlsHttpsHLS:e.urlHttpsHls}})),o={};if(0===r){var s=n.map((function(e){return{stream_id:e.streamID,code:a.STREAM_DELETE_REASON[e.closeType]&&a.STREAM_DELETE_REASON[e.closeType].code||0,description:a.STREAM_DELETE_REASON[e.closeType]&&a.STREAM_DELETE_REASON[e.closeType].description||"unknown"}}));o.stream_delete_reason=s}var l=(0,a.getReportSeq)();if(t.dataReport.newReport(l,c.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.event),t.dataReport.addMsgInfo(l,{stream_update_type:c.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.stream_update_type(1===r?"added":"deleted"),update_stream:c.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.update_stream(i)}),t.dataReport.uploadReport(l),i.length>0&&t.stateCenter.actionListener("roomStreamUpdate",e,u.ClientUtil.getSteamUpdateType(r),i,Object.keys(o).length>0?JSON.stringify(o):""),n.length>0&&t.stateCenter.actionListener("_streamUpdated",r,n),1===r){var d=[];i.forEach((function(e){e.extraInfo&&d.push({streamID:e.streamID,user:e.user,extraInfo:e.extraInfo})})),d.length>0&&t.stateCenter.actionListener("streamExtraInfoUpdate",e,d)}},e.onPublishStateUpdate=function(e,r,n){var i;t.logger.info("zb.opsu ",r);var o=t.stateCenter.reportSeqList.startPublish[r],s=t.streamCenter.publisherList[r];(null==s?void 0:s.publisher)&&(0==e||1==e)&&o&&(t.dataReport.eventEndWithMsgInfo(o,"PublishState",{type:e}),1==e&&t.dataReport.addMsgInfo(o,n),t.dataReport.addMsgInfo(o,{session_id:s.publisher.sessionId}),t.dataReport.uploadReport(o),1012===n.code&&t.streamCenter.stopPublishingStream(r),delete t.stateCenter.reportSeqList.startPublish[r]);var a=u.ClientUtil.getPublisherStateType(e);(1===e||(null===(i=null==s?void 0:s.publisher)||void 0===i?void 0:i.updateCBState({state:a,code:n.code})))&&t.stateCenter.actionListener("publisherStateUpdate",{state:a,streamID:r,errorCode:n.code,extendedData:n.message})},e.onStreamExtraInfoUpdated=function(e,r){var n=r.map((function(e){return{streamID:e.streamID,user:e.user,extraInfo:e.extraInfo}})),i=(0,a.getReportSeq)();t.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamExtraInfo.event),t.dataReport.addMsgInfo(i,{update_stream:c.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamExtraInfo.update_stream(n)}),t.dataReport.uploadReport(i),t.stateCenter.actionListener("streamExtraInfoUpdate",e,n)}},e.prototype.screenStreamFrom=function(e,t,r){var n={};n.audio={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e}},n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:window.screen.width,maxHeight:window.screen.height}},!t&&(n.audio=!1),navigator.mediaDevices.getUserMedia(n).then((function(e){r(!0,e)})).catch((function(e){r(!1,null,e)}))},e.prototype.onPublishStateUpdateHandle=function(e,t,r){var n=this;this.logger.info("zc.opsuh.0 call");var i=this.streamCenter.publisherList[t],o=i.room;if(o)if(0==e){if(this.stateCenter.publishStreamList[t]){var s=!o.streamList.find((function(e){return e.stream_id==t&&(e.anchor_id_name==n.stateCenter.idName||e.id_name==n.stateCenter.idName||e.user_id===n.stateCenter.idName)}));[a.ENUM_PUBLISH_STREAM_STATE.tryPublish,a.ENUM_PUBLISH_STREAM_STATE.retryPublish].includes(this.stateCenter.publishStreamList[t].state)&&s?(this.stateCenter.publishStreamList[t].state=a.ENUM_PUBLISH_STREAM_STATE.update_info,o.streamHandler.updateStreamInfo(t,a.ENUM_STREAM_SUB_CMD.liveBegin,this.stateCenter.publishStreamList[t].extra_info,(function(e){}))):(this.stateCenter.publishStreamList[t].state=a.ENUM_PUBLISH_STREAM_STATE.publishing,this.WebrtcOnPublishStateUpdateHandle(e,t,r))}}else{if(1==e&&i&&u.ClientUtil.isReDispatch(r)){var c=i.publisher,l=i.retryDispatchHandler,d=i.publishOption;return 0!=c.sessionId&&c.signal&&c.shouldSendCloseSession()&&(c.signal.sendCloseSession(this.stateCenter.getSeq(),c.sessionId,1),c.signal.removeSession(c.sessionId),c.closeSessionSignal=!0),c.resetPublish(),l.stopMaxTime(),l.invalid(),l.initStream(t,d,!0),void(this.rtm.isLogin()?(l.startMaxTime(),l.active(0)):this.streamCenter.publisherList[t].isReDispatch=!0)}o.streamHandler.onPublishStateUpdate(e,t,r),1==e&&(this.logger.info("zc.opsuh.0 stop publish called by sdk"),this.publishModule.stopPublishingStream(t,r))}else this.logger.error("zc.opsuh.0 room not exist")},e.prototype.WebrtcOnPublishStateUpdateHandle=function(e,t,r){if(this.stateCenter.publishStreamList[t].state==a.ENUM_PUBLISH_STREAM_STATE.publishing){var n=this.streamCenter.getRoomByStreamID(t);n&&n.streamHandler.onPublishStateUpdate(e,t,r)}},e.prototype.bindListener=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error("zc.o.0 listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error("zc.o.0 event "+e+" no found"),!1)},e.prototype.deleteListener=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error("zc.o.1 listener no found"),!1;this.logger.info("dc.o.1 "+"".concat(e," cb:")+typeof t);var r=this.stateCenter.listenerList[e];return t?r.splice(r.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},e}();t.RTCModules=m},1177:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateCumulativeDuration=t.recordBreakDuration=t.onBreakEnd=void 0,t.onBreakEnd=function(e,t,r,n,i){if(void 0===i&&(i="video"),t.breakStartTime){var o=e-t.breakStartTime;o>=n&&(t.cumulativeBreakDuration+=o,r.breakDuration+=o),t.breakStartTime=void 0}},t.recordBreakDuration=function(e,r,n,i,o,s,a,c,u,l){if(void 0===u&&(u=c),void 0===l&&(l="video"),o>1e3&&(o=1e3),i.breakStartTime)if(n)0===r?(e-i.breakStartTime>=22e3&&(0,t.onBreakEnd)(e,i,a,o,l),s.breakDuration+=1e3):c>=o?c<500?c+u<1e3?((0,t.onBreakEnd)(e-(1e3-u),i,a,o,l),i.breakStartTime=e-c,s.breakDuration+=u+c,s.decodeTime+=1e3-(u+c)):((0,t.onBreakEnd)(e-1e3+u,i,a,o,l),i.breakStartTime=e-1e3+u,s.breakDuration+=1e3):c>=500&&((0,t.onBreakEnd)(e-c,i,a,o,l),i.breakStartTime=e-c,s.breakDuration+=1e3):u<=o?((0,t.onBreakEnd)(e-1e3+u,i,a,o,l),i.breakStartTime=void 0,s.breakDuration+=u,s.decodeTime+=1e3-u,a.decodeDuration+=1e3-u):s.breakDuration+=1e3;else{i.resumeRecv=!1;var d=e-1e3-i.breakStartTime;d<=0&&(d=0),i.breakStartTime=void 0,i.noBreakNoDecodeDuration+=d,s.breakCancelDuration+=d,a.blankDuration+=d}else n?0===r?i.resumeRecv?(i.breakStartTime=e-1e3,s.breakDuration+=1e3):(i.noBreakNoDecodeDuration+=1e3,a.blankDuration+=1e3):u>o?i.resumeRecv?(i.breakStartTime=e-u,i.cumulativeBreakDuration+=u,s.breakDuration+=u,s.decodeTime+=1e3-u,a.breakDuration+=u,a.decodeDuration+=1e3-u):(i.noBreakNoDecodeDuration+=1e3,a.blankDuration+=1e3):(s.decodeTime+=1e3,a.decodeDuration+=1e3):i.decodeStartTime&&(0===r?(i.resumeRecv=!1,i.noBreakNoDecodeDuration+=1e3,a.blankDuration+=1e3):(s.decodeTime+=1e3,a.decodeDuration+=1e3));n&&r&&(i.resumeRecv=!0)},t.calculateCumulativeDuration=function(e,t,r,n,i,o,s){if(void 0===s&&(s="video"),n=n>1e3?1e3:n,t.breakDuration=0,t.breakCancelDuration=0,t.decodeTime=0,r.decodeDuration=0,r.breakDuration=0,r.blankDuration=0,e.decodeStartTime){var a=o,c=a-e.decodeStartTime;if(e.decodeStartTime=void 0,e.totalDuration+=c,e.breakStartTime){var u=a-e.breakStartTime;e.breakStartTime=void 0,i?u>n&&(e.cumulativeBreakDuration+=u):e.noBreakNoDecodeDuration+=u}var l=e.cumulativeBreakDuration,d=e.totalDuration-e.cumulativeBreakDuration-e.noBreakNoDecodeDuration;return e.cumulativeDecodeDuration=d,{cumulativeBreakDuration:l,cumulativeDecodeDuration:d}}return{cumulativeBreakDuration:0,cumulativeDecodeDuration:0}}},4865:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayModule=void 0;var i=r(6706),o=r(1089),s=r(6706),a=r(3529),c=r(608),u=function(){function e(e,t,r,n,i){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=n,this.rtm=i}return e.prototype.startPlayingStream=function(e,t,r){var n=this;return this.logger.info(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" call ",e),new Promise((function(i,o){return n._handlePlayStream(e,t,i,o,r)}))},e.prototype._handlePlayStream=function(e,t,r,u,l){var d=this,h=a.ZegoRTCLogEvent.kZegoTaskPlayStart,p=(0,s.getReportSeq)();this.stateCenter.reportSeqList.startPlay[e]=p,this.dataReport.newReport(p,h.event);var f,g=function(t,r){d.logger.error(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" "+(r||t.message)),d.dataReport.uploadReport(p,void 0,t,r),delete d.stateCenter.reportSeqList.startPlay[e],u&&u(n(n({},t),{errorCode:t.code,extendedData:t.message+(r?" "+r:"")}))};if(void 0===e||"string"!=typeof e||""===e)return g(h.error.kPlayParamError,"stream id type error"),!1;if(e.length>s.MAX_STREAM_ID_LENGTH)return g(h.error.kPlayStreamIDToLongError,"stream id length limit "+s.MAX_STREAM_ID_LENGTH),!1;if(!c.ClientUtil.checkIllegalCharacters(e))return g(h.error.kPlayStreamIDInvalidCharacterError),!1;if(void 0!==t&&"object"!=typeof t)return g(h.error.kPlayParamError,"playOption must be object"),!1;if(this.stateCenter.customUrl&&0!=this.stateCenter.customUrl.length)this.logger.info("zc.p.sps.1 customUrl "+JSON.stringify(this.stateCenter.customUrl)),f=this.stateCenter.customUrl;else{var m=this.stateCenter.settingConfig.getSetting("signal_nodes",!0);m&&m instanceof Array&&m.length>0&&(f=m,this.logger.info("zc.p.sps.1 setting config signal_nodes "+JSON.stringify(m)))}if(f){var _=this.streamCenter.setPlayStateStart(e,t,l);return!0!==_?(g(JSON.parse(JSON.stringify(_)),"cannot start play"),!1):(this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.playerList[e].serverUrls=f,this.streamCenter.startPlayingStream(e,!1,(function(e){r&&r(e)})))}if(this.dataReport.addMsgInfo(p,{stream:h.stream(e),playOption:h.playOption(t),use_na:this.stateCenter.useNetAgent?1:0,biz_product:(null==t?void 0:t.resourceMode)==i.ResourceMode.DG?1:0}),this.stateCenter.useNetAgent&&this.stateCenter.playAccelerate&&this.stateCenter.roomList.length>0)this.logger.info(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" play accelerate");else if(this.rtm.isDisConnect())return g(h.error.kPlayNoLoginError),!1;this.stateCenter.pullLimited||(e=NaN+e),t&&t.videoCodec&&(t.videoCodec=t.videoCodec.toUpperCase());var v=this.stateCenter.settingConfig.getSetting("resource_mode",!0);void 0!==v&&(this.logger.info(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM," setting resource_mode "+v),!t&&(t={}),t.resourceMode=v);var y=this.streamCenter.setPlayStateStart(e,t,l);if(!0!==y)return g(JSON.parse(JSON.stringify(y)),"cannot start play"),!1;if(this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.playSuccessCallBackList[e]=function(e){r&&r(e)},u&&(this.streamCenter.playErrorCallBackList[e]=u),t&&t.resourceMode&&[1,3].includes(t.resourceMode)&&this.streamCenter.playerList[e].playMode==i.PlayMode.CDN)return this.streamCenter.startPlayingStream(e,this.stateCenter.useNetAgent,this.streamCenter.playSuccessCallBackList[e],!0);var E=this.stateCenter.useNetAgent;if(E)return this.stateCenter.appConfig?(this.streamCenter.playerList[e].serverUrls=2===(null==t?void 0:t.resourceMode)?["unified_l3"]:["unified_rtc"],this.streamCenter.startPlayingStream(e,E,this.streamCenter.playSuccessCallBackList[e]),!0):(this.streamCenter.waitPlayList.push(e),!0);var S=this.streamCenter.playerList[e].retryDispatchHandler;return S.stopMaxTime(),S.invalid(),S.initStream(e,t,!1),S.startMaxTime(),S.active(0)},e.prototype.stopPlayingStream=function(e,t){var r,n,c;this.logger.info(o.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call",e);var u=(0,s.getReportSeq)();if(this.stateCenter.reportSeqList.stopPlay[e]=u,this.dataReport.newReport(u,a.ZegoRTCLogEvent.kZegoTaskPlayStop.event),this.dataReport.addMsgInfo(u,{stream:a.ZegoRTCLogEvent.kZegoTaskPlayStop.stream(e)}),"string"!=typeof e||""===e)return this.logger.error(o.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" streamid must be string and not empty"),this.dataReport.uploadReport(u,void 0,a.ZegoRTCLogEvent.kZegoTaskPlayStop.error.kParamError,"stream id type error"),void delete this.stateCenter.reportSeqList.stopPlay[e];var l=this.streamCenter.playerList[e];this.dataReport.addMsgInfo(u,{biz_product:l&&(null===(r=l.playOption)||void 0===r?void 0:r.resourceMode)==i.ResourceMode.DG?1:0});var d=l&&l.player&&l.player.state!==s.ENUM_PLAY_STATE.stop||(null===(n=null==l?void 0:l.retryStreamHandler)||void 0===n?void 0:n.isRetrying());for(var h in this.streamCenter.stopPlayingStream(e),this.stateCenter.streamUrlMap)if(this.stateCenter.streamUrlMap[h]===e){delete this.stateCenter.streamUrlMap[h];break}this.dataReport.addMsgInfo(u,{session_id:null===(c=null==l?void 0:l.player)||void 0===c?void 0:c.sessionId}),this.dataReport.uploadReport(u),d&&this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,e,t||{code:0,message:""}),this.logger.debug(o.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call success")},e.prototype.mutePlayStream=function(e,t,r){return new Promise((function(e,t){e(!1)}))},e.prototype.setStreamAudioOutput=function(e,t){return!1},e.prototype.startWaitPlay=function(){var e=this;this.streamCenter.waitPlayList.forEach((function(t){e.streamCenter.startPlayingStream(t,e.stateCenter.useNetAgent,e.streamCenter.playSuccessCallBackList[t])})),this.streamCenter.waitPlayList=[]},e.prototype.getStreamStats=function(e){var t,r,n;return this.logger.info(o.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" call"),"string"==typeof e&&(n=null===(t=this.streamCenter.playerList[e])||void 0===t?void 0:t.player),n&&(null===(r=null==n?void 0:n.qualityHandler)||void 0===r?void 0:r.currentQuality)?n.qualityHandler.currentQuality||null:(this.logger.error("zsc.sp.0 stream is not playing"),null)},e}();t.PlayModule=u},5634:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayStreamQuality=void 0;var i=r(6706),o=r(1089),s=r(3529),a=r(608),c=r(1177),u=function(){function e(e,t,r,n){this.player=t,this.logger=r,this.dataReport=n,this.playQualityList=[],this.maxQualityListCount=10,this.qualityTimer=null,this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,audioPacketsReceived:0,videoPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0},this.currentQuality={video:{videoBitrate:0,videoFPS:0,videoTransferFPS:0,frameHeight:0,frameWidth:0,muteState:"1",videoQuality:-1,googCodecName:"",videoPacketsLost:0,videoPacketsLostRate:0,videoFramesDecoded:0,videoFramesDropped:0,videoCumulativeDecodeTime:0,videoCumulativeBreakTime:0,videoCumulativeBreakRate:0},audio:{audioBitrate:0,audioCodec:"opus",muteState:"1",audioQuality:-1,audioFPS:0,audioJitter:0,audioLevel:0,audioPacketsLost:0,audioPacketsLostRate:0,audioSamplingRate:0,audioSendLevel:0,googCodecName:"",audioCumulativeDecodeTime:0,audioCumulativeBreakTime:0,audioCumulativeBreakRate:0},peerToPeerDelay:0,peerToPeerPacketLostRate:0},this.decodeStartTime=0,this.netQuality=0,this.probeTime=0,this.probeInterval=6e4,this.probeState=i.ENUM_PROBE_STATE.probed,this.probeTimer=null,this.probeTimeoutInterval=3e4,this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.cumulativeQuality={},this.audioBreakThreshold=200,this.videoBreakThreshold=500,this.videoBreak={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0},this.audioBreak={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0},this.lastSampleTime=0,this.videoBreakReport={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.audioBreakReport={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.videoReliableBreak={decodeDuration:0,breakDuration:0,blankDuration:0},this.audioReliableBreak={decodeDuration:0,breakDuration:0,blankDuration:0},this.totalQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0},this.currentSecondQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0},this.poorQualityNum=0,this.p2pNetStats={p2pLostRate:0,p2pRTT:0},this.sampleTimes=0,this.qualitySampleInterval=1e3,this.qualityTimeInterval=e,this.currentQuality.video.muteState=this.player.videoMuteState,this.currentQuality.audio.muteState=this.player.audioMuteState}return Object.defineProperty(e.prototype,"streamId",{get:function(){return this.player.streamId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.player.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"peerID",{get:function(){return this.player.peerID},enumerable:!1,configurable:!0}),e.prototype.getPlayStats=function(e,t){var r,n,u,l=this;if(null!=e){var d=this.sampleTimes%parseInt((this.qualityTimeInterval/this.qualitySampleInterval).toString())==0;parseInt((this.qualityTimeInterval/this.qualitySampleInterval).toString()),d&&this.getP2PNetStats();for(var h,p=document.querySelectorAll("video, audio"),f=0;f<p.length;f++)p[f].srcObject===this.player.playStream&&(h=p[f]);var g={sampleTimeWindow:this.qualityTimeInterval,audioFractionLost:0,audioPacketsLost:0,audioPacketsLostRate:0,audioBitrate:0,audioLevel:0,audioSendLevel:0,audioSamplingRate:0,audioCodec:"opus",audioQuality:0,audioFPS:0,videoQuality:0,videoPacketsLost:0,videoPacketsLostRate:0,videoBitrate:0,videoFPS:0,nackCount:0,pliCount:0,audioJitter:0,videoJitter:0,videoFractionLost:0,videoFramesDecoded:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoFramesDropped:0,totalRoundTripTime:0,currentRoundTripTime:0,googBandwidthLimitedResolution:void 0,videoCodecName:"",audioCodecName:"",googCpuLimitedResolution:void 0,googAvailableSendBandwidth:0,audioMuteState:this.player.audioMuteState,videoMuteState:this.player.videoMuteState,muted:h?h.muted:void 0,paused:h?h.paused:void 0,volume:h?h.volume:void 0,sinkId:h?h.sinkId:void 0},m=this.lastPlayStats.time,_=0,v=0,y=0,E=0,S=0,b=0,T=0,C=null,R=null;e.forEach((function(e){["ssrc","inbound-rtp"].includes(e.type)&&("video"==e.mediaType||e.id.indexOf("VideoStream")>=0)&&(C=e),("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("audio"==e.mediaType||e.id.indexOf("AudioStream")>=0)&&(R=e)}));var O=(new Date).getTime(),k=function(e,t){return e>t?e-t:0};if(this.lastSampleTime||(this.lastSampleTime=O-1e3),C){var I=C.totalInterFrameDelay,L=C.framesDecoded,w=C.totalSquaredInterFrameDelay,A=k(L,this.totalQuality.framesDecode);this.totalQuality.framesDecode=L;var N=k(I,this.totalQuality.totalInterFrameDelay);this.totalQuality.totalInterFrameDelay=I;var P=k(w,this.totalQuality.totalSquaredInterFrameDelay);this.totalQuality.totalSquaredInterFrameDelay=w;var M=(P-Math.pow(N,2)/(A||1))/(A||1);M=M>0?M:-M;var D=parseInt((1e3/(A+1)).toString()),U=1e3*Math.sqrt(M),x=N/(A||1)*1e3||D,B=(x=parseInt((x>1e3?1e3:x).toString()))+U;B=parseInt((B>1e3?1e3:B).toString()),A>0&&0===this.player.cameraStatus&&!this.videoBreak.decodeStartTime&&(this.videoBreak.decodeStartTime=O-1e3),this.videoBreak.decodeStartTime&&(0,c.recordBreakDuration)(O,A,0===this.player.cameraStatus&&this.player.playMediaStatus.video,this.videoBreak,this.videoBreakThreshold,this.videoBreakReport,this.videoReliableBreak,x,B)}if(R){var j=R.totalSamplesReceived,H=R.concealedSamples,G=R.bytesReceived,z=k(j,this.totalQuality.totalSamplesReceived);this.totalQuality.totalSamplesReceived=j;var q=k(H,this.totalQuality.concealedSamples);this.totalQuality.concealedSamples=H;var V=k(G,this.totalQuality.audioBytesReceived);this.totalQuality.audioBytesReceived=G;var F=parseInt((q/(z||1)*1e3).toString());V>0&&0===this.player.micStatus&&!this.audioBreak.decodeStartTime&&(this.audioBreak.decodeStartTime=O-1e3),this.audioBreak.decodeStartTime&&(0,c.recordBreakDuration)(O,V,0===this.player.micStatus&&this.player.playMediaStatus.audio,this.audioBreak,this.audioBreakThreshold,this.audioBreakReport,this.audioReliableBreak,F,F,"audio")}if(t&&t.result().forEach((function(e){d&&("ssrc"==e.type&&(e.names().indexOf("googBandwidthLimitedResolution")>=0&&(g.googBandwidthLimitedResolution=e.stat("googBandwidthLimitedResolution")),e.names().indexOf("codecImplementationName")>=0&&(g.codecImplementationName=e.stat("codecImplementationName")),"video"==e.stat("mediaType")&&(e.names().indexOf("googCodecName")>=0&&(g.videoCodecName=e.stat("googCodecName")),e.names().indexOf("googCurrentDelayMs")>=0&&(T=e.stat("googCurrentDelayMs"))),"audio"==e.stat("mediaType")&&(e.names().indexOf("googCodecName")>=0&&(g.audioCodecName=e.stat("googCodecName")),e.names().indexOf("googCurrentDelayMs")>=0&&(b=e.stat("googCurrentDelayMs"))),e.names().indexOf("googCpuLimitedResolution")>=0&&(g.googCpuLimitedResolution=e.stat("googCpuLimitedResolution"))),"VideoBwe"==e.type&&e.names().indexOf("googAvailableSendBandwidth")>=0&&(g.googAvailableSendBandwidth=e.stat("googAvailableSendBandwidth")))})),d){e.forEach((function(e){if(("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("audio"==e.mediaType||e.id.indexOf("AudioStream")>=0)){0!=m&&(g.audioBitrate=8*(e.bytesReceived-l.lastPlayStats.audioBytesReceived)/(e.timestamp-m),(r=e.packetsLost-l.lastPlayStats.audioPacketsLost)>0&&(v=r/(r+e.packetsReceived-l.lastPlayStats.audioPacketsReceived))),g.audioBitrate<0&&(g.audioBitrate=0),g.audioJitter=e.jitter,e.packetsLost>0&&(g.audioPacketsLost=e.packetsLost),g.audioFractionLost=e.fractionLost;var t=e.packetsLost-l.lastPlayStats.audioPacketsLost;g.audioFPS=(e.packetsReceived-l.lastPlayStats.audioPacketsReceived)/(e.timestamp-m)*1e3,g.audioPacketsLostRate=t>0?t/(e.packetsReceived-l.lastPlayStats.audioPacketsReceived+t):0,l.lastPlayStats.audioBytesReceived=e.bytesReceived,e.packetsLost>0&&(l.lastPlayStats.audioPacketsLost=e.packetsLost),l.lastPlayStats.audioPacketsReceived=e.packetsReceived,l.lastPlayStats.audioTime=e.timestamp,l.lastPlayStats.time=e.timestamp,l.lastPlayStats.audioBitrate=g.audioBitrate,E=e.jitter}else if(("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("video"==e.mediaType||e.id.indexOf("VideoStream")>=0)){var r;0!=m?(g.videoBitrate=8*(e.bytesReceived-l.lastPlayStats.videoBytesReceived)/(e.timestamp-m),g.videoFPS=1e3*(e.framesDecoded-l.lastPlayStats.framesDecoded)/(e.timestamp-m),(r=e.packetsLost-l.lastPlayStats.videoPacketsLost)>0&&(y=r/(r+e.packetsReceived-l.lastPlayStats.videoPacketsReceived))):"number"==typeof e.framesPerSecond&&(g.videoFPS=e.framesPerSecond),g.videoBitrate<0&&(g.videoBitrate=0),g.videoFPS<0&&(g.videoFPS=0),g.videoJitter=e.jitter,g.nackCount=e.nackCount,g.pliCount=e.pliCount,g.videoFractionLost=e.fractionLost,g.videoFramesDecoded=e.framesDecoded,e.packetsLost>0&&(g.videoPacketsLost=e.packetsLost),g.videoPacketsLostRate=(t=e.packetsLost-l.lastPlayStats.videoPacketsLost)>0?t/(e.packetsReceived-l.lastPlayStats.videoPacketsReceived+t):0,l.lastPlayStats.videoBytesReceived=e.bytesReceived,l.lastPlayStats.framesDecoded=e.framesDecoded,e.packetsLost>0&&(l.lastPlayStats.videoPacketsLost=e.packetsLost),l.lastPlayStats.videoPacketsReceived=e.packetsReceived,l.lastPlayStats.videoTime=e.timestamp,l.lastPlayStats.time=e.timestamp,S=e.jitter}else if("track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0)||e.frameWidth){if(g.frameHeight=e.frameHeight,g.frameWidth=e.frameWidth,0===m||l.lastPlayStats.frameHeight===e.frameHeight&&l.lastPlayStats.frameWidth===e.frameWidth)0===m&&(l.lastPlayStats.frameHeight=e.frameHeight,l.lastPlayStats.frameWidth=e.frameWidth);else{var n=(0,i.getReportSeq)();l.dataReport.newReport(n,s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.event),l.dataReport.addMsgInfo(n,{session_id:s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.session_id(l.sessionId),w:s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.w(e.frameWidth),h:s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.h(e.frameHeight)}),!l.player.isProbe&&l.dataReport.uploadReport(n),l.lastPlayStats.frameHeight=e.frameHeight,l.lastPlayStats.frameWidth=e.frameWidth}0!=m&&(g.videoTransferFPS=1e3*(e.framesReceived-l.lastPlayStats.framesReceived)/(e.timestamp-m),g.videoFramesDropped=e.framesDropped-l.lastPlayStats.framesDropped),g.videoTransferFPS<0&&(g.videoTransferFPS=0),g.videoFramesDropped<0&&(g.videoFramesDropped=0),l.lastPlayStats.framesReceived=e.framesReceived,l.lastPlayStats.framesDropped=e.framesDropped}else"track"==e.type&&("audio"==e.kind||e.id.indexOf("audio")>=0)?(g.audioLevel=e.audioLevel||0,g.audioSendLevel=e.totalAudioEnergy,g.audioSamplingRate=e.totalSamplesDuration):"candidate-pair"==e.type&&(null!=e.totalRoundTripTime&&(g.totalRoundTripTime=e.totalRoundTripTime),null!=e.currentRoundTripTime&&(g.currentRoundTripTime=e.currentRoundTripTime,_=1e3*g.currentRoundTripTime))})),this.lastPlayStats.googCurrentDelayMs=Number(b)||Number(T)||0,y=isNaN(y)||y<0?0:y,S=isNaN(S)||S<0?0:S,v=isNaN(v)||v<0?0:v,E=isNaN(E)||E<0?0:E;var Z=a.ClientUtil.getNetQuality(_,y,S),W=a.ClientUtil.getNetQuality(_,v,E);g.audioQuality=m>0?a.ClientUtil.quality2QualityGrade(W):0,g.videoQuality=m>0?a.ClientUtil.quality2QualityGrade(Z):0,this.player.stateCenter.networkState!==i.ENUM_NETWORK_STATE.offline&&"disconnected"!==(null===(r=this.player.peerConnection)||void 0===r?void 0:r.connectionState)||(g.videoQuality=i.QualityGrade.Die,g.audioQuality=i.QualityGrade.Die);var Y=Math.min(Z,W);this.netQuality=Y,g.peerToPeerDelay=isNaN(this.p2pNetStats.p2pRTT)?0:parseInt((this.p2pNetStats.p2pRTT/2+this.lastPlayStats.googCurrentDelayMs).toString()),g.peerToPeerPacketLostRate=this.p2pNetStats.p2pLostRate,Y<=i.QUALITY_CONSTANT.MiddleMinQuality?this.poorQualityNum++:this.poorQualityNum=0,Y<=this.player.streamCenter.l3BadQualityScore&&this.player.streamCenter.handleQualityBad(this.streamId,this.player.resourceMode,i.PlayMode.L3)?this.logger.info(o.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+"check cdn mode"):m>0&&this.poorQualityNum>=(null===(u=null===(n=this.player)||void 0===n?void 0:n.streamCenter)||void 0===u?void 0:u.probeStartedNum)&&O>this.probeTime+this.probeInterval&&(this.logger.info(o.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" netQuality "+Y+" start net probe"),this.probeState=i.ENUM_PROBE_STATE.tryProbe,this.player.streamCenter.startNetProbe(!1,this.player,this.player.gwNodeList),this.probeTime=O),Y>this.player.streamCenter.l3BadQualityScore&&(this.player.streamCenter.playerList[this.streamId].qualityBadCount=0,this.player.streamCenter.l3ProtocolBadTimestamp=0,this.player.streamCenter.lastHandleL3BadTimestamp=0),this.uploadPlayQuality(g,O),this.updateCurrentQualityStats(g),0!=m&&this.player.onPlayQualityUpdate(this.streamId,this.currentQuality)}}},e.prototype.updateCurrentQualityStats=function(e){var t=e.videoBitrate,r=e.videoFPS,i=e.videoTransferFPS,o=e.frameHeight,s=e.frameWidth,a=e.videoMuteState,c=e.videoQuality,u=e.videoFramesDecoded,l=e.videoFramesDropped,d=e.videoPacketsLost,h=e.videoPacketsLostRate,p=e.audioBitrate,f=e.audioCodec,g=e.audioMuteState,m=e.audioQuality,_=e.audioFPS,v=e.audioJitter,y=e.audioLevel,E=e.audioPacketsLost,S=e.audioPacketsLostRate,b=e.audioSamplingRate,T=e.audioSendLevel,C=e.nackCount,R=e.pliCount,O=e.totalRoundTripTime,k=e.currentRoundTripTime,I=e.peerToPeerDelay,L=e.peerToPeerPacketLostRate,w=e.sampleTimeWindow,A={video:n(n({},this.currentQuality.video),{videoBitrate:t,videoFPS:r,videoTransferFPS:i,frameHeight:o,frameWidth:s,videoQuality:c,videoFramesDecoded:u,videoFramesDropped:l,videoPacketsLost:d,videoPacketsLostRate:h,muteState:a,videoCumulativeDecodeTime:this.videoReliableBreak.decodeDuration,videoCumulativeBreakTime:this.videoReliableBreak.breakDuration,videoCumulativeBreakRate:this.videoReliableBreak.breakDuration/(this.videoReliableBreak.decodeDuration+this.videoReliableBreak.breakDuration||1)}),audio:n(n({},this.currentQuality.audio),{audioBitrate:p,audioCodec:f,audioQuality:m,audioFPS:_,audioJitter:v,audioLevel:y,audioPacketsLost:E,audioPacketsLostRate:S,audioSamplingRate:b,audioSendLevel:T,muteState:g,audioCumulativeDecodeTime:this.audioReliableBreak.decodeDuration,audioCumulativeBreakTime:this.audioReliableBreak.breakDuration,audioCumulativeBreakRate:this.audioReliableBreak.breakDuration/(this.audioReliableBreak.decodeDuration+this.audioReliableBreak.breakDuration||1)}),nackCount:C,pliCount:R,totalRoundTripTime:O,currentRoundTripTime:k,peerToPeerDelay:I,peerToPeerPacketLostRate:(L||0)/255,sampleTimeWindow:w};if(void 0!==e.muted){var N=e.paused,P=e.volume,M=e.sinkId;A.muted=e.muted,A.paused=N,A.volume=P,A.sinkId=M}if(void 0!==e.videoCodecName){var D=e.audioCodecName,U=e.codecImplementationName,x=e.googAvailableSendBandwidth;A.video.googCodecName=e.videoCodecName,A.audio.googCodecName=D,A.codecImplementationName=U,A.googAvailableSendBandwidth=x}this.currentQuality=A},e.prototype.uploadPlayQuality=function(e,t){var r,n;if(this.qualityUpload&&this.player.signal.isServerConnected){var i=t;if(0==this.qualityUploadLastTime||i-this.qualityUploadLastTime>=2e3){if(e.stream_type="play",e.stream_id=this.streamId,e.timeStamp=parseInt((i/1e3).toString()),e.video_break_duration=this.videoBreakReport.breakDuration,e.video_break_cancel_duration=this.videoBreakReport.breakCancelDuration,e.video_decode_time=this.videoBreakReport.decodeTime,this.videoBreakReport.breakCancelDuration=0,this.videoBreakReport.breakDuration=0,this.videoBreakReport.decodeTime=0,e.audio_break_duration=this.audioBreakReport.breakDuration,e.audio_break_cancel_duration=this.audioBreakReport.breakCancelDuration,e.audio_decode_time=this.audioBreakReport.decodeTime,this.audioBreakReport.breakCancelDuration=0,this.audioBreakReport.breakDuration=0,this.audioBreakReport.decodeTime=0,e.real_sampling_interval=i-this.lastSampleTime,!e.frameHeight||!e.frameWidth)for(var s=document.querySelectorAll("video"),a=0;a<s.length;a++){var c=s[a],u=null===(r=c.srcObject)||void 0===r?void 0:r.getVideoTracks()[0];if(u&&u==(null===(n=this.player.playStream)||void 0===n?void 0:n.getVideoTracks()[0])){e.frameHeight=c.videoHeight||0,e.frameWidth=c.videoWidth||0;break}}this.lastSampleTime=i,this.logger.info(o.ZEGO_WEBRTC_ACTION.PLAYER_UPLOAD_PLAYER_QUALITY+" "+this.streamId+" upload"+JSON.stringify(e)),this.player.streamCenter.updateQuality(1,e),this.qualityUploadLastTime=i}}},e.prototype.getP2PNetStats=function(){var e=this;this.player.signal.getP2PNetStats((0,i.getSeq)(),this.sessionId,this.peerID,(function(t,r,n){var i=n.p2p_rtt;e.p2pNetStats.p2pLostRate=n.p2p_lost_rate||0,e.p2pNetStats.p2pRTT=i||0}),(function(e){}))},e.prototype.setPlayQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.info(o.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" "+this.streamId+" startTimer"),this.clearPlayQualityTimer(),this.getP2PNetStats(),this.qualityTimer=setInterval((function(){e.sampleTimes++;var t=e.player.peerConnection;if(t){var r=[t.getStats(null)];"chrome"==e.player.stateCenter.browser&&r.push(new Promise((function(e,r){t.getStats((function(t){return e(t)}),(function(e){return r(e)}))}))),Promise.all(r).then((function(t){e.getPlayStats(t[0],t[1])})).catch((function(t){e.logger.error(o.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" "+e.streamId+" getStats error "+t.toString())}))}}),1e3),this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0})},e.prototype.clearPlayQualityTimer=function(){if(null!=this.qualityTimer){clearInterval(this.qualityTimer),this.qualityTimer=null;var e=(new Date).getTime();this.lastSampleTime=0,this.sampleTimes=0,this.totalQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0},(0,c.calculateCumulativeDuration)(this.videoBreak,this.videoBreakReport,this.videoReliableBreak,this.videoBreakThreshold,0===this.player.cameraStatus&&this.player.playMediaStatus.video,e),(0,c.calculateCumulativeDuration)(this.audioBreak,this.audioBreakReport,this.audioReliableBreak,this.audioBreakThreshold,0===this.player.micStatus&&this.player.playMediaStatus.audio,e,"audio")}this.poorQualityNum=0,this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesDropped:0,framesReceived:0,audioBitrate:0}},e.prototype.startProbeTimeout=function(){var e=this;this.probeTimer=setTimeout((function(){e.logger.error(o.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" probe timeout"),e.player.playStateUpdateError(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kProbeTimeOutError)}),this.probeTimeoutInterval)},e.prototype.stopProbeTimeout=function(){this.probeTimer&&(clearTimeout(this.probeTimer),this.probeTimer=null)},e}();t.PlayStreamQuality=u},3849:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPlayWeb=void 0;var s=r(6706),a=r(4767),c=r(3409),u=r(608),l=r(3529),d=r(1089),h=r(5634),p=r(7646),f=r(1358),g=r(9307),m=r(569),_=r(8011),v=l.ZegoRTCLogEvent.kZegoTaskPlayStart,y=function(){function e(e,t,r,n,i,o,a,u){var l=this;this.curCBState={state:"NO_PLAY",code:0},this._state=s.ENUM_PLAY_STATE.stop,this.lastState=s.ENUM_PLAY_STATE.stop,this.candidateInfo=[],this.broadcasterStatus=s.ENUM_BROADCASTER_STATUS.stop,this.isExternal=!1,this.playQualityList=[],this.maxQualityListCount=10,this.reportSeq=NaN,this.streamReportSeq=(0,s.getSeq)(),this.videoSizeCallback=!1,this.remoteStream=null,this.playStream=null,this.rtcViewer=null,this.playOption={},this.playMediaStatus={video:!0,audio:!0},this.closeSessionSignal=!1,this.stateNego=s.ENUM_PLAY_STATE_NEGO.stop,this.negoTimer=null,this.negoInterval=25e3,this.cameraStatus=0,this.micStatus=0,this.hasSentStreamStatus=!1,this.playEvent=!1,this.gotStreamStatus=!1,this.soundLevel=0,this.mic=null,this.beginTime=0,this.firstFrameTime=0,this.resourceMode=0,this.gwNode="",this.gwNodeList=[],this.gwNodesTTL=0,this.isPeer=!1,this.peerFailCount=0,this.isProbe=!1,this.peerID=0,this.isRecvClientInfo=!1,this.videoCodec="",this.videoCodecTimes=0,this.answerSdpTime=0,this.streamConnectIP="",this.initPoster="",this.initVideoStyle="",this.firstPlay=!0,this.isProbeByDG=!1,this.useResourceTypes=[],this.tryidx=0,this._CDNPlayerClone=null,this.retryFailGwNodes=[],this.dispatchedGwNodes=[],this.audioMuteState="0",this.videoMuteState="0",this.first_pkt=!0,this.next_sn=[],this.pkt_list=[],this.onDataChannelList=[],this.sideMediaConfig={isSEIStart:!1,unregisterSeiFilter:"",filterSize:0},this.cachedGwNodesMode=c.CachedNodesUseMode.DiffReUse,this.iceDisconnectedMaxTime=15e3,this._turnToTcp=!1,this.decodeVideoFrame=function(e,t){if("VP8"===l.videoCodec)t.terminate();else{for(var r=new DataView(e.data),n=0,i=new p.H264Parser(r),o=0,s=!1;i.NextNalu(s);)if(7!=(o=31&r.getUint8(i.nalu_start+i.start_code_size))&&8!=o&&9!=o){if(n=i.nalu_start+i.start_code_size+1,6!=o)break;s=!0;for(var a=0;255===r.getUint8(n);)a+=255,n++;if(243===(a+=r.getUint8(n++))||5===a||100===a){for(var c=0;255===r.getUint8(n);)c+=255,n++;if(c+=r.getUint8(n++),e.data.byteLength-n<c)break;var u=new Uint8Array(4+c);switch(u[0]=0,u[1]=0,a){case 100:u[2]=3,u[3]=235;break;case 5:u[2]=3,u[3]=236;break;case 243:u[2]=3,u[3]=237}for(var d=[],h=n;h<n+c;)0!==r.getInt8(h)||0!==r.getInt8(h+1)||3!==r.getInt8(h+2)||0!==r.getInt8(h+3)&&1!==r.getInt8(h+3)&&2!==r.getInt8(h+3)&&3!==r.getInt8(h+3)?h++:(d.push(h+2),h+=4);for(var g=0,m=0;m<c+d.length;m++)d.includes(n)?(n++,g++):u[4+m-g]=r.getUint8(n++);var _=!1;if(243===a)_=!0;else if(5===a&&l.sideMediaConfig.unregisterSeiFilter){var v=u.slice(4,4+l.sideMediaConfig.filterSize);f.WebRTCUtil.decodeString(v)===l.sideMediaConfig.unregisterSeiFilter&&(_=!0)}_&&l.stateCenter.actionListener("playerRecvSEI",l.streamId,u)}}t.enqueue(e)}},this.decodeAudioFrame=function(e,t){t.enqueue(e)},this.soundMeterWorklet=null,this.streamId=e,this.logger=t,this.signal=r,this.dataReport=n,this.streamCenter=o,this.ac=a,this.stateCenter=u,this.dataReport.newReport(this.streamReportSeq),this.dataReport.addMsgInfo(this.streamReportSeq,{abs_time:Date.now()}),this.qualityHandler=new h.PlayStreamQuality(i,this,this.logger,this.dataReport),this.resourceMode=this.stateCenter.settingConfig.getSetting("resource_mode")}return e.prototype.updateCBState=function(e){var t=this,r=Object.keys(e).some((function(r){return e[r]!==t.curCBState[r]}));return r&&(this.curCBState=e),r},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this.lastState=this._state,this._state=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"probeState",{get:function(){return this.qualityHandler.probeState},set:function(e){this.qualityHandler.probeState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"netQuality",{get:function(){return this.qualityHandler.netQuality},set:function(e){this.qualityHandler.netQuality=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iceStateDisConnect",{get:function(){return[s.ENUM_PLAY_STATE_NEGO.iceClosed,s.ENUM_PLAY_STATE_NEGO.iceDisconnected,s.ENUM_PLAY_STATE_NEGO.iceFailed].includes(this.stateNego)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLastConnected",{get:function(){return this.lastState===s.ENUM_PLAY_STATE.playing},enumerable:!1,configurable:!0}),e.prototype.netProbeToReDispatch=function(){this.playStateUpdateError(v.error.kPlayNetProbePoor)},e.prototype.startPlay=function(e,t,r){var n,i,o,a,c,l=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" called ",e),this.playEvent=!1,this.signal&&this.signal.negoInterval&&(this.negoInterval=this.signal.negoInterval),e){if(this.getRemoteStreamSuc=t,this.playOption=r||{},this.playMediaStatus={video:void 0===this.playOption.video||!!this.playOption.video,audio:void 0===this.playOption.audio||!!this.playOption.audio},r&&r.videoCodec&&(this.playOption.videoCodec=r.videoCodec),"boolean"==typeof(null==r?void 0:r.isSEIStart)&&(this.sideMediaConfig.isSEIStart=null==r?void 0:r.isSEIStart),this.sideMediaConfig.isSEIStart){var h=u.ClientUtil.isSupportEncodedTransforms();((null===(n=this.playOption)||void 0===n?void 0:n.videoCodec)&&"H264"!==(null===(i=this.playOption)||void 0===i?void 0:i.videoCodec)||!h)&&(this.sideMediaConfig.isSEIStart=!1)}(null===(o=this.stateCenter.seiConfig)||void 0===o?void 0:o.unregisterSEIFilter)&&(this.sideMediaConfig.unregisterSeiFilter=null===(a=this.stateCenter.seiConfig)||void 0===a?void 0:a.unregisterSEIFilter,this.sideMediaConfig.filterSize=f.WebRTCUtil.encodeString(this.sideMediaConfig.unregisterSeiFilter).byteLength),null==(null==r?void 0:r.streamType)&&void 0!==this.stateCenter.streamType&&(this.playOption.streamType=this.stateCenter.streamType);var p=this.stateCenter.settingConfig.getSetting("play_video_codec",!0);p&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" setting play_video_codec "+p),this.playOption.videoCodec=p);var g=(null===(c=this.playOption)||void 0===c?void 0:c.resourceMode)==s.ResourceMode.DG?1:0;this.dataReport.addMsgInfo(this.reportSeq,{audio_activate:v.audio_activate(1==this.playOption.audio?1:0==this.playOption.audio?0:1),video_activate:v.video_activate(1==this.playOption.video?1:0==this.playOption.video?0:1),biz_product:v.biz_product(g)}),this.isPeer?this.createOffer({encodedInsertableStreams:this.sideMediaConfig.isSEIStart}):this.createSession(),this.negoTimer=setTimeout((function(){l.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" waiting timeout"),l.playStateUpdateError(v.error.kPlayNegoTimeoutError)}),this.negoInterval),this.isProbe&&this.qualityHandler.startProbeTimeout()}else this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" streamId is null")},e.prototype.onCreatePlaySessionSuccess=function(e){var t=this,r=d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS;this.logger.info(r+" "+this.streamId+" success");var n=[];if(e.turn_server){var i=e.turn_server.split(";");this._turnToTcp=this.stateCenter.turnOverTcpOnly,this.streamCenter.autoSwitchProtocol=this.stateCenter.settingConfig.getSetting("auto_to_tcp")||!1;var o=this.stateCenter.settingConfig.getSetting("udp_max_fail_num");!isNaN(o)&&(this.streamCenter.maxUdpFailNum=o);var s=this.streamCenter,a=s.autoSwitchProtocol,c=s.maxUdpFailNum,u=s.udpFailNum;this.logger.info(r+"  autoToTcp: ".concat(a,", udpFailNum: ").concat(u,", maxUdpFailNum: ").concat(c,".")),a&&!this._turnToTcp&&u>=c&&(this.logger.info(r+" switch to tcp."),this._turnToTcp=!0);var l=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);l&&(this.logger.info(r+" setting udp_or_tcp "+l),this._turnToTcp="tcp"===l);var h,p=i.filter((function(e){return e.indexOf("udp")>-1})),f=i.filter((function(e){return e.indexOf("tcp")>-1}));h=this._turnToTcp?f.length>0?f:p.map((function(e){return e.replace("udp","tcp")})):p,this.logger.info(r+" over tcp "+JSON.stringify(h)),n.push.apply(n,h)}e.stun_server&&n.push(e.stun_server);var g={iceTransportPolicy:"all",iceServers:[{urls:n,username:e.turn_username,credential:e.turn_auth_key}],encodedInsertableStreams:this.sideMediaConfig.isSEIStart};this.logger.info(r+" "+this.streamId+" username: "+e.turn_username),this.logger.info(r+" "+this.streamId+" credential: "+e.turn_auth_key),this.createOffer(g);var m=performance.now();this.signal.registerPushCallback("MediaDescPush",this.sessionId,(function(e,r,n){t.onRecvMediaDesc(e,r,n)})),this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,(function(e,r,n){t.onRecvCandidateInfo(e,r,n)})),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,n,i){if(m){var o=(performance.now()-m).toFixed(0);m=void 0,t.logger.info(r+" ".concat(t.streamId,", cmd: CloseSessionPush, cost_time: ").concat(o))}t.onRecvCloseSession(e,n,i)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,r,n){t.onRecvResetSession(e,r,n)})),this.signal.registerPushCallback("StreamStatusNotifyPush",this.sessionId,(function(e,r,n){t.gotStreamStatus=!0,t.streamStatus=n,t.playStream&&t.onRecvStreamStatus(n)})),this.signal.registerPushCallback("PlayEventPush",this.sessionId,(function(e,n,i){if(m){var o=(performance.now()-m).toFixed(0);t.logger.info(r+" ".concat(t.streamId,", cmd: PlayEventPush, cost_time: ").concat(o))}t.onRecvPlayEvent(e,n,i)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,r,n){t.onRecvClientInfo(e,r,n)})),this.logger.info(r+" "+this.streamId+" call success")},e.prototype.createOffer=function(e){var t=this,r=d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS;this.peerConnection=new RTCPeerConnection(e),this.peerConnection.onicecandidate=function(e){t.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){t.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){t.onIceConnectionStateChange(e)},this.peerConnection.ontrack=function(e){t.onGotRemoteStream(e.streams[0],e.receiver)},this.streamCenter.isDataChannelEnabled&&(this.dataChannel=this.peerConnection.createDataChannel(this.streamId),this.dataChannel.binaryType="arraybuffer",this.dataChannel.onopen=function(e){t.logger.info(r+" "+t.streamId+" data channel open")},this.dataChannel.onmessage=function(e){if(t.logger.info(r+" "+t.streamId+" data channel onmessage"),e.data instanceof Blob){var n=new FileReader,i={};n.readAsArrayBuffer(e.data),n.onload=function(){i.data=n.result,t.onReceivedDataChannel(i)}}else t.onReceivedDataChannel(e)});var n={offerToReceiveAudio:1,offerToReceiveVideo:1};this.playOption&&!1===this.playOption.video&&(n.offerToReceiveVideo=0),this.playOption&&!1===this.playOption.audio&&(n.offerToReceiveAudio=0),this.logger.info(r+" "+this.streamId+" createOffer: "+JSON.stringify(n)),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.dataReport.eventStart(this.streamReportSeq,"CreateOffer"),this.peerConnection.createOffer(n).then((function(e){t.dataReport.eventEnd(t.reportSeq,"CreateOffer"),t.dataReport.eventEnd(t.streamReportSeq,"CreateOffer"),t.onCreateOfferSuccess(e)}),(function(e){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateOffer",{error:e.toString()}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateOffer",{error:e.toString()}),t.logger.error(r+" "+t.streamId+" create offer error "+e.toString()),t.playStateUpdateError(v.error.kCreateOfferError,!0)}))},e.prototype.createSession=function(e){var t,r,n,i=this;this.sessionSeq=(0,s.getSeq)();var o=this.streamId;1==this.streamCenter.testEnvironment&&(o="zegotest-"+this.streamCenter.appid+"-"+this.streamId);var a=this.stateCenter.turnOverTcpOnly,c=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);c&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" setting udp_or_tcp "+c),a="tcp"===c),a&&(this.isPeer=!1);var u="",l=[];this.stateCenter.idName&&l.push("zguid="+this.stateCenter.idName);var h=(null===(r=null===(t=this.streamCenter.publisherList[this.streamId])||void 0===t?void 0:t.room)||void 0===r?void 0:r.roomID)||(null===(n=this.stateCenter.roomList[0])||void 0===n?void 0:n.roomID);if(h&&l.push("zgrid="+h),this.isPeer){this.dataReport.eventStart(this.reportSeq,"CreateSessionWithSdp"),this.dataReport.eventStart(this.streamReportSeq,"CreateSessionWithSdp");var p=this.stateCenter.settingConfig.getSetting("l3_play_buffer_ms"),f=(new Date).getTime();"number"==typeof this.playOption.streamType&&l.push("video_stream_type="+this.playOption.streamType),l.length>0&&(u=l.join("&")),this.signal.createSessionWithSdp({seq:this.sessionSeq,type:this.isProbe?2:1,mode:0,streamId:o,strAuthParam:this.playOption&&this.playOption.streamParams||"",sdp:e.sdp,serverHost:this.gwNode,playBufLevel:[s.ResourceMode.L3,s.ResourceMode.DG].includes(this.resourceMode)?p:void 0,params:u},(function(e,t,r){var n=(new Date).getTime();i.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" create session time "+(n-f)),i.handleCreateSessionWithSdpResp(e,t,r)}),(function(e,t){i.sessionSeq==t?(i.dataReport.eventEndWithMsg(i.reportSeq,"CreateSession",{error:e}),i.dataReport.eventEndWithMsg(i.streamReportSeq,"CreateSession",{error:e}),i.playStateUpdateError(e==s.SEND_MSG_TIMEOUT?v.error.kSessionTimeoutError:v.error.kSessionRequestError)):i.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" seq is not match.")}))}else this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.dataReport.eventStart(this.streamReportSeq,"CreateSession"),l.length>0&&(u=l.join("&")),this.signal.createSession(this.sessionSeq,1,0,o,this.playOption&&this.playOption.streamParams,this.gwNode,u,(function(e,t,r){i.handleCreateSessionResp(e,t,r)}),(function(e,t){i.sessionSeq==t?(i.dataReport.eventEndWithMsg(i.reportSeq,"CreateSession",{error:e}),i.dataReport.eventEndWithMsg(i.streamReportSeq,"CreateSession",{error:e}),i.playStateUpdateError(e==s.SEND_MSG_TIMEOUT?v.error.kSessionTimeoutError:v.error.kSessionRequestError)):i.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" seq is not match.")}));this.state=s.ENUM_PLAY_STATE.waitingSessionRsp,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" called success"),this.stateNego=s.ENUM_PLAY_STATE_NEGO.start},e.prototype.setGwNodes=function(e){var t;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SET_GW_NODES+" "+this.streamId+" "+JSON.stringify(null==e?void 0:e.gw_nodes)+" "+JSON.stringify(this.retryFailGwNodes)),(null===(t=e.gw_nodes)||void 0===t?void 0:t.length)>0){var r=this.sortGwNodes(e.gw_nodes,this.retryFailGwNodes);this.retryFailGwNodes=[],this.handleDispatchedGwNodes(r,e.gw_nodes_ttl)}},e.prototype.resetGwNodes=function(){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_RESET_GW_NODES+" "+this.streamId),this.gwNode="",this.gwNodeList=[],this.gwNodesTTL=0},e.prototype.pureSortGwNodes=function(){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_PURE_SORT_GW_NODES+" "+this.streamId);var e=this.sortGwNodes(this.gwNodeList,this.retryFailGwNodes);this.gwNodeList=e},e.prototype.sortGwNodes=function(e,t){return t.forEach((function(t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),e.push(t))})),e},e.prototype.handleDispatchedGwNodes=function(e,t){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_DISPATCHED_GW_NODES+" "+this.streamId+" "+JSON.stringify(e)),Array.isArray(e)){this.gwNodeList=e.length>0?e:this.gwNodeList,this.gwNode=e.length>0?this.gwNodeList[0]:this.gwNode;var r=0===t?60:t;this.gwNodesTTL=r?(new Date).getTime()+1e3*r:this.gwNodesTTL,e.length>0&&this.streamCenter.updateCachedGwNodesList(this,!1,e,r)}},e.prototype.handleCreateSessionResp=function(e,t,r){var n=r.turn_server,i=n.split("?")[0]&&n.split("?")[0].slice(5),o=this.streamCenter.server.split("?"),s=o[1]&&o[1].slice(2),a="webrtc://".concat(i,"/").concat(s,"/").concat(this.streamId);this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSession",{sessionId:r.session_id,url:a}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSession",{sessionId:r.session_id,url:a}),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" sessionId:"+r.session_id),this.sessionSeq==e?(this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,0!==r.result?(this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" create error"),this.playStateUpdateError(v.error.kSessionRequestError)):(this.sessionId=r.session_id,this.sessionToken=r.session_token,this.setGwNodes(r),this.dataReport.addMsgInfo(this.reportSeq,{session_id:v.session_id(this.sessionId)}),this.onCreatePlaySessionSuccess(r))):this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" seq is not match.")},e.prototype.handleCreateSessionWithSdpResp=function(e,t,r){var n=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" sessionId:"+t),this.sessionSeq==e){this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSessionWithSdp",{sessionId:t});var i=0,o=(new Date).getTime();if(this.dataReport.dataStatistics[this.reportSeq]&&this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" "+this.streamId+" create sdp time "+(i=o-this.dataReport.dataStatistics[this.reportSeq].event_time)),this.answerSdpTime=o,this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSessionWithSdp",{sessionId:t,sessionTime:i}),0!==r.result){if(this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" create session failed "+r.result),this.stateCenter.useNetAgent&&1004===(null==r?void 0:r.result))return void this.playStateUpdateError(v.error.kPlayStreamNotFound,!0);this.playStateUpdateError(v.error.kSessionRequestError)}else{this.sessionId=t,this.sessionToken=r.session_token,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" create session success ",this.streamId),this.setGwNodes(r),this.dataReport.eventStart(this.reportSeq,"IceConnected");var s=performance.now();this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,t,r){if(s){var i=(performance.now()-s).toFixed(0);s=void 0,n.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" ".concat(n.streamId,", cmd: CloseSessionPush, cost_time: ").concat(i))}n.onRecvCloseSession(e,t,r)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,t,r){n.onRecvResetSession(e,t,r)})),this.signal.registerPushCallback("StreamStatusNotifyPush",this.sessionId,(function(e,t,r){n.gotStreamStatus=!0,n.streamStatus=r,n.playStream&&n.onRecvStreamStatus(r)})),this.signal.registerPushCallback("PlayEventPush",this.sessionId,(function(e,t,r){if(s){var i=(performance.now()-s).toFixed(0);s=void 0,n.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" ".concat(n.streamId,", cmd: PlayEventPush, cost_time: ").concat(i))}n.onRecvPlayEvent(e,t,r)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,t,r){n.onRecvClientInfo(e,t,r)})),this.signal.registerPushCallback("NetQualityProbeRsp",this.sessionId,(function(e,t,r){n.onRecvPlayEvent(e,t,r)})),this.signal.registerPushCallback("NetQualityInfoPush",this.sessionId,(function(e,t,r){n.onRecvNetQualityInfo(e,t,r)})),this.onGetRemoteOfferSuccess(r.sdp)}}else this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" seq is not match.")},e.prototype.onCreateOfferSuccess=function(e){var t=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp1 "+e.sdp.substr(0,e.sdp.length/2)),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp2 "+e.sdp.substr(e.sdp.length/2)),e.sdp=e.sdp.replace(/sendrecv/g,"recvonly"),e.sdp=e.sdp.replace(/useinbandfec=/,"stereo=1;useinbandfec=");var r=e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)?e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)[0]:null;if(r){var n=r.replace(/recvonly/,"sendrecv");e.sdp=e.sdp.replace(r,n)}e.sdp=(0,m.addSPSDescription)(e.sdp),e.sdp=(0,m.addRRTRLine)(e.sdp),this.playOption.videoCodec&&(e.sdp=a.SdpUtil.getSDPByVideDecodeType(e.sdp,this.playOption.videoCodec)),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetLocalDescription"),this.peerConnection.setLocalDescription(e).then((function(){t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription"),t.dataReport.eventEnd(t.streamReportSeq,"SetLocalDescription"),t.onSetLocalDescriptionSuccess(e)}),(function(e){t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+t.streamId+" set error "+e.toString()),t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription",{error:e.toString()}),t.dataReport.eventEnd(t.streamReportSeq,"SetLocalDescription",{error:e.toString()}),t.playStateUpdateError(v.error.kSetLocalDescError,!0)}))},e.prototype.onSetLocalDescriptionSuccess=function(e){var t=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" success"),this.isPeer)this.createSession(e);else{var r={sdp:e.sdp};2==this.resourceMode&&(r.min_play_buf_level_ms=500),this.answerSeq=(0,s.getSeq)(),this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.answerSeq,this.sessionId,0,r,(function(e,r,n){t.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" sendMediaDesc resp"),t.answerSeq==e&&t.sessionId==r?(t.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" send success stateNego:waiterAnswer"),t.stateNego=s.ENUM_PLAY_STATE_NEGO.waiterAnswer,t.dataReport.eventEnd(t.reportSeq,"SendMediaDesc"),t.dataReport.eventEnd(t.streamReportSeq,"SendMediaDesc"),t.state=s.ENUM_PLAY_STATE.waitingServerAnswer):t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" seq or sessionId is not equal "+t.answerSeq+" "+e,0+t.sessionId+" "+r)}),(function(e,r){t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" failed to send "+e),t.dataReport.eventEndWithMsg(t.reportSeq,"SendMediaDesc",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendMediaDesc",{error:e}),t.playStateUpdateError(v.error.kMediaDescError)})),this.state=s.ENUM_PLAY_STATE.waitingOfferRsp}},e.prototype.onRecvMediaDesc=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received ",r),this.stateNego=s.ENUM_PLAY_STATE_NEGO.waitingCandidate,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.state===s.ENUM_PLAY_STATE.waitingServerAnswer?(this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0),this.onGetRemoteOfferSuccess(r.sdp)):this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onGetRemoteOfferSuccess=function(e){var t,r=this,n={type:"answer",sdp:e,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetRemoteDescription"),this._turnToTcp=this.stateCenter.turnOverTcpOnly,this.streamCenter.autoSwitchProtocol=this.stateCenter.settingConfig.getSetting("auto_to_tcp")||!1;var i=this.stateCenter.settingConfig.getSetting("udp_max_fail_num");!isNaN(i)&&(this.streamCenter.maxUdpFailNum=i);var o=this.streamCenter,a=o.autoSwitchProtocol,c=o.maxUdpFailNum,u=o.udpFailNum;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+"  autoToTcp: ".concat(a,", udpFailNum: ").concat(u,", maxUdpFailNum: ").concat(c,".")),a&&!this._turnToTcp&&u>=c&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" switch to tcp."),this._turnToTcp=!0);var l=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);l&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" setting udp_or_tcp "+l),this._turnToTcp="tcp"===l),this._turnToTcp&&(null===(t=n.sdp.match(/candidate.*/g))||void 0===t||t.forEach((function(e){var t=e.replace(/udp/,"tcp");t.includes(" tcptype ")||(t=t.replace(" typ host "," typ host tcptype passive ")),n.sdp=n.sdp.replace(e,t)}))),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" remoteSdp ",n.sdp),this.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).then((function(){r.dataReport.eventEnd(r.reportSeq,"SetRemoteDescription"),r.dataReport.eventEnd(r.streamReportSeq,"SetRemoteDescription"),r.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+r.streamId+" set success")}),(function(e){r.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+r.streamId+" set remote error "+e.toString()),r.dataReport.eventEndWithMsg(r.reportSeq,"SetRemoteDescription",{error:e.toString()}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SetRemoteDescription",{error:e.toString()}),r.playStateUpdateError(v.error.kSetRemoteDescError,!0)})),this.state=s.ENUM_PLAY_STATE.waitingServerICE,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" call success")},e.prototype.onRecvCandidateInfo=function(e,t,r){var n=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" received "),this.state==s.ENUM_PLAY_STATE.waitingServerICE){this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.dataReport.addEvent(this.streamReportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[];for(var i=0;i<r.infos.length;i++){var o={sdpMid:r.infos[i].sdpMid,sdpMLineIndex:r.infos[i].sdpMLineIndex,candidate:r.infos[i].candidate};this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" candidate "+o.candidate),this.peerConnection.addIceCandidate(new RTCIceCandidate(o)).then((function(){n.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+n.streamId+" add success")}),(function(e){n.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+n.streamId+" add error "+e.toString()),n.playStateUpdateError(v.error.kCandidateError,!0)}))}this.state=s.ENUM_PLAY_STATE.connecting,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" call success")}else this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onRecvPlayEvent=function(e,t,r){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_PLAY_EVENT+" "+this.streamId+" received"),!0===this.playEvent&&0==r.event){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_PLAY_EVENT+" "+this.streamId+" retry: "+this.streamId);var n=this.streamId,i=this.playOption;this.signal.sendCloseSession((0,s.getSeq)(),this.sessionId,1),this.resetPlay(),this.startPlay(n,this.getRemoteStreamSuc,i)}else this.playEvent=!0},e.prototype.onRecvClientInfo=function(e,t,r){this.stateCenter.clientIP!==r.clientip&&this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CLIENT_INFO+" client ip changed "+this.stateCenter.clientIP+" "+r.clientip),this.stateCenter.clientIP=r.clientip,this.peerID=r.peer_id,this.streamConnectIP=r.clientip,this.stateCenter.isMultiOuter=this.isMultiOuter(),this.isProbe&&this.stateNego==s.ENUM_PLAY_STATE_NEGO.iceConnected&&this.signal.sendNetProbe((0,s.getSeq)(),this.sessionId,this.peerID,(function(){}),(function(){})),this.isRecvClientInfo=!0},e.prototype.onRecvNetQualityInfo=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_NET_QUALITY_INFO+" call"),this.qualityHandler.stopProbeTimeout();var n=0,i=r.lossrate,o=r.rtt;(this.peerID!==r.peer_id&&!this.isProbeByDG||null==typeof i||null==typeof o)&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_NET_QUALITY_INFO+" local peerID:"+this.peerID+" remote peerID:"+r.peer_id+" lossrate:"+i+" rtt:"+o),n=1),this.signal.sendNetQualityInfoPushAck((0,s.getSeq)(),this.sessionId,this.peerID,n),0==n&&"number"==typeof i&&"number"==typeof o?(this.isProbeByDG=!1,this.onCalNetQualityResult(0,u.ClientUtil.getNetQuality(o,i))):this.onCalNetQualityResult(1)},e.prototype.onIceCandidate=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" called"),null!=e.candidate&&(this.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate "+e.candidate.candidate),this.state<s.ENUM_PLAY_STATE.connecting||this.state==s.ENUM_PLAY_STATE.stop?(this.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" cached"),this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex})):(this.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" send"),this.sendCandidateInfo([{candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex}])))},e.prototype.onConnectionStateChange=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CONNECTION_STATE_CHANGE+" "+this.streamId+" called "+e.target.signalingState),this.state!=s.ENUM_PLAY_STATE.stop&&null!=this.peerConnection&&"closed"===e.target.signalingState&&(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=s.ENUM_PLAY_STATE_NEGO.iceClosed,this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState))},e.prototype.onIceConnectionStateChange=function(e){var t,r=this;if(this.state!=s.ENUM_PLAY_STATE.stop&&null!=this.peerConnection)if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState){if(this.stateNego=s.ENUM_PLAY_STATE_NEGO.iceConnected,this.isProbe&&this.isPeer&&(this.isRecvClientInfo||this.isProbeByDG))return this.signal.sendNetProbe((0,s.getSeq)(),this.sessionId,this.peerID,(function(){}),(function(){})),void(null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null));if(null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.dataReport.addEvent(this.reportSeq,"IceConnected"),this.dataReport.addEvent(this.streamReportSeq,"IceConnected"),this.answerSdpTime){var n=(new Date).getTime()-this.answerSdpTime;this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" ice time "+n)}for(var i in this.isProbe||this.state==s.ENUM_PLAY_STATE.playing||(this.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.start,this.streamId,{code:0,message:""},!0),this.getRemoteStreamSuc&&this.getRemoteStreamSuc(this.playOption.resourceMode==s.ResourceMode.DG&&this.firstPlay?null:this.playStream)),this.state=s.ENUM_PLAY_STATE.playing,this.dataReport.eventStart(this.reportSeq,"PlayState"),this.dataReport.eventStart(this.streamReportSeq,"PlayState"),this.streamCenter.publisherList)if(this.streamCenter.publisherList[i].publisher.state==s.ENUM_PUBLISH_STATE.publishing&&this.broadcasterStatus==s.ENUM_BROADCASTER_STATUS.stop){this.signal&&this.signal.sendBroadcasterStatus((0,s.getSeq)(),this.sessionId,1),this.broadcasterStatus=s.ENUM_BROADCASTER_STATUS.start;break}if(!this.isProbe){this.qualityHandler.setPlayQualityTimer();var o=this.stateCenter.settingConfig.getSetting("probe_started_num");!isNaN(o)&&(this.streamCenter.probeStartedNum=o)}if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateNego:iceConnected"),this.isPeer&&(this.peerFailCount=0),0==this.firstFrameTime){this.firstFrameTime=(new Date).getTime()-this.beginTime;var a=(0,s.getReportSeq)();this.dataReport.newReport(a,l.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.event),this.dataReport.addMsgInfo(a,{session_id:l.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.session_id(this.sessionId),fft_consumed:l.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.fft_consumed(this.firstFrameTime),biz_product:l.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.biz_product((null===(t=this.playOption)||void 0===t?void 0:t.resourceMode)==s.ResourceMode.DG?1:0)}),!this.isProbe&&this.dataReport.uploadReport(a)}this._turnToTcp||(this.streamCenter.udpFailNum=0)}else"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=s.ENUM_PLAY_STATE_NEGO.iceClosed,this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.stateNego=s.ENUM_PLAY_STATE_NEGO.iceFailed,this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)):"disconnected"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceDisconnected"),this.stateNego=s.ENUM_PLAY_STATE_NEGO.iceDisconnected,this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" ice disconnected"),this.iceDisconnectedTimer||(this.iceDisconnectedTimer=setTimeout((function(){r.checkPlayConnectionFailedState("disconnected")}),this.iceDisconnectedMaxTime)))},e.prototype.checkPlayConnectionFailedState=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+"  state "+this.state+" connectionState "+e),this.playStateUpdateError(v.error.kMediaConnectionError)},e.prototype.resetPlay=function(){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_RESET_PLAY+" "+this.streamId+" call"),this.state=s.ENUM_PLAY_STATE.stop,this.playEvent=!1,this.isRecvClientInfo=!1,null!=this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.stopVideocTimer(),this.qualityHandler.stopProbeTimeout(),this.qualityHandler.clearPlayQualityTimer(),this.signal&&(this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId),this.signal.unregisterPushCallback("SessionResetPush",this.sessionId),this.signal.unregisterPushCallback("PlayEventPush",this.sessionId),this.signal.unregisterPushCallback("ClientInfoPush",this.sessionId),this.signal.unregisterPushCallback("NetQualityProbeRsp",this.sessionId),this.signal.unregisterPushCallback("NetQualityInfoPush",this.sessionId)),this.sessionSeq=0,this.answerSeq=0,this.videoSizeCallback=!1,this.stopSoundLevel()},e.prototype.onRecvResetSession=function(e,t,r){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_RESET_SESSION+" "+this.streamId+" received "),t==this.sessionId){this.signal.sendCloseSessionAck(e,this.sessionId,0);var n=JSON.parse(JSON.stringify(v.error.kPlaySessionClosedError));this.negoTimer&&clearTimeout(this.negoTimer),this.playStateUpdateError(n)}else this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_RESET_SESSION+" "+this.streamId+" cannot find session")},e.prototype.onRecvCloseSession=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CLOSE_SESSION+" "+this.streamId+" "+JSON.stringify(r)),this.signal.sendCloseSessionAck(e,this.sessionId,0);var n=r.err_info?JSON.parse(r.err_info.toLowerCase()):{},i=n.action?n.action:null,o=1*r.reason,s=JSON.parse(JSON.stringify(1004===(null==n?void 0:n.err)?v.error.kPlayStreamNotFound:v.error.kPlaySessionClosedError));s.message+=" reason:".concat(o," ").concat(i?" action:"+i:""," ").concat((null==n?void 0:n.err)?" err:"+(null==n?void 0:n.err):""),this.negoTimer&&clearTimeout(this.negoTimer);var a=!([4,8,10,11,12,14,24,26,27,28].includes(o)||[2,3,4,5,6].includes(i));1004===(null==n?void 0:n.err)&&(a=!0);var c=!1;if(!this._turnToTcp)if([8,10].includes(o)||[18,15].includes(o)&&2===i&&[3001,3002].includes(n.err)){this.streamCenter.udpFailNum++;var u=this.streamCenter;u.autoSwitchProtocol&&u.udpFailNum>=u.maxUdpFailNum&&(this.isPeer=!1,this.streamCenter.setIsPeer(!1),c=!0)}else this._turnToTcp||(this.streamCenter.udpFailNum=0);this.playStateUpdateError(s,a,n,c)},e.prototype.onRecvStreamStatus=function(e){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" call"),this.logger.info("".concat(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS," ").concat(this.streamId," status camera_status: ").concat(e.camera_status," mic_status: ").concat(e.mic_status)),(!this.hasSentStreamStatus||this.cameraStatus!==e.camera_status)&&this.onRemoteCameraStatusUpdate(this.streamId,this.getCameraMicStatus(e.camera_status),e.camera_status),(!this.hasSentStreamStatus||this.micStatus!==e.mic_status)&&this.onRemoteMicStatusUpdate(this.streamId,this.getCameraMicStatus(e.mic_status),e.mic_status),this.hasSentStreamStatus=!0,this.cameraStatus=e.camera_status,this.micStatus=e.mic_status,this.videoMuteState=0===e.camera_status?"0":"1",this.audioMuteState=0===e.mic_status?"0":"1","boolean"==typeof this.playOption.video)this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" has set video option, ignore stream status");else{var t=this.playStream,r=this.rtcViewer;if(0!==e.camera_status&&20!==e.camera_status)t.getVideoTracks().forEach((function(e){e.enabled=!1,e.stop(),t.removeTrack(e),r&&r.setVideo(null)}));else if(0===t.getVideoTracks().length){var n=this.remoteStream.clone().getVideoTracks()[0];t.addTrack(n),r&&r.setVideo(n,"safari"===this.stateCenter.browser)}if("safari"===this.stateCenter.browser)for(var i=document.querySelectorAll("video, audio"),o=0;o<i.length;o++){var s=i[o];s.srcObject===this.playStream&&(this.playStream=new MediaStream(this.playStream),s.srcObject=this.playStream)}}this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" call success")},e.prototype.onGotRemoteStream=function(e,t){var r=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_GOT_REMOTE_STREAM+" "+this.streamId+" called "+e),e){if(this.sideMediaConfig.isSEIStart&&"function"==typeof t.createEncodedStreams&&("video"===t.track.kind?this.createVideoReceiverTransform(t):"audio"===t.track.kind&&this.createAudioReceiverTransform(t)),this.playStream){this.playStream.getTracks().forEach((function(e){return r.playStream.removeTrack(e)}));var n=this.rtcViewer;e.clone().getTracks().forEach((function(e){return i(r,void 0,void 0,(function(){return o(this,(function(t){return this.playStream.addTrack(e),n&&n.setTrack("video"===e.kind,e,"safari"===this.stateCenter.browser),[2]}))}))}))}else this.playStream=e.clone();this.audioMuteState=this.playStream.getAudioTracks().length>0?"0":"1",this.videoMuteState=this.playStream.getVideoTracks().length>0?"0":"1",this.remoteStream=e,this.getVideoCodec(),this.gotStreamStatus&&this.onRecvStreamStatus(this.streamStatus),this.dataReport.addEvent(this.reportSeq,"GetRemoteStream"),this.streamCenter.soundLevelDelegate&&!this.isProbe&&this.startSoundLevel()}else this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_GOT_REMOTE_STREAM+" "+this.streamId+" remote stream is empty")},e.prototype.createVideoReceiverTransform=function(e){var t=e.createEncodedStreams(),r=new TransformStream({transform:this.decodeVideoFrame});this.receiverStreams=t,t.readable.pipeThrough(r).pipeTo(t.writable)},e.prototype.createAudioReceiverTransform=function(e){var t=e.createEncodedStreams(),r=new TransformStream({transform:this.decodeAudioFrame});t.readable.pipeThrough(r).pipeTo(t.writable)},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" called"),!(e=e.filter((function(e){return!(e.candidate.indexOf("tcp")>0)&&(!!e.candidate||void 0)})))||e.length<1?this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.dataReport.eventStart(this.streamReportSeq,"SendIceCandidate"),this.stateNego!==s.ENUM_PLAY_STATE_NEGO.iceConnected&&(this.stateNego=s.ENUM_PLAY_STATE_NEGO.sendCandidate),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" stateNego:sendCandidate"),this.signal.sendCandidateInfo((0,s.getSeq)(),this.sessionId,e,(function(e,r,n){t.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+t.streamId+" send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate"),t.dataReport.eventEnd(t.streamReportSeq,"SendIceCandidate")}),(function(e,r){t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+t.streamId+" failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendIceCandidate",{error:e}),t.playStateUpdateError(v.error.kCandidateError)})))},e.prototype.shouldSendCloseSession=function(){return this.state!=s.ENUM_PLAY_STATE_UPDATE.stop&&this.state!=s.ENUM_PLAY_STATE.waitingSessionRsp},e.prototype.playStateUpdateError=function(e,t,r,n){this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_STATE_ERROR+" call ",this.streamId,JSON.stringify(e)),this.isProbe?this.onCalNetQualityResult(1):this.streamId&&this.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,this.streamId,e,t,r,n),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_STATE_ERROR+" "+this.streamId+" ended")},e.prototype.getCameraMicStatus=function(e){return 0==e?"OPEN":"MUTE"},e.prototype.onPlayStateUpdate=function(e,t,r,n,i,o){},e.prototype.onPlayQualityUpdate=function(e,t){},e.prototype.onRemoteCameraStatusUpdate=function(e,t,r){},e.prototype.onRemoteMicStatusUpdate=function(e,t,r){},e.prototype.stopPlay=function(){var e,t;for(var r in this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_STOP_PLAY+" "+this.streamId+" called"),this.streamCenter.publisherList)if(this.streamCenter.publisherList[r].publisher.state==s.ENUM_PUBLISH_STATE.publishing&&this.broadcasterStatus==s.ENUM_BROADCASTER_STATUS.start){this.signal&&this.signal.sendBroadcasterStatus((0,s.getSeq)(),this.sessionId,0),this.broadcasterStatus=s.ENUM_BROADCASTER_STATUS.stop;break}this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession((0,s.getSeq)(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.streamReportSeq,"PlayState",{state:this.state+""}),this.dataReport.addEvent(this.streamReportSeq,"StopPlay"),this.dataReport.addMsgExt(this.streamReportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.resetPlay();var i=this.qualityHandler,o=i.videoBreak,a=i.audioBreak,c=2===this.resourceMode?"l3":"rtc",u=((e={})["".concat(c,"_a_break_time")]=a.cumulativeBreakDuration,e["".concat(c,"_a_decode_time")]=a.cumulativeDecodeDuration,e["".concat(c,"_v_break_time")]=o.cumulativeBreakDuration,e["".concat(c,"_v_decode_time")]=o.cumulativeDecodeDuration,e);this.dataReport.addMsgInfo(this.streamReportSeq,n({itemtype:"RTCPlayStream",use_na:this.stateCenter.useNetAgent?1:0,cdn_a_break_time:0,cdn_a_decode_time:0,cdn_v_break_time:0,cdn_v_decode_time:0,l3_a_break_time:0,l3_a_decode_time:0,l3_v_break_time:0,l3_v_decode_time:0,rtc_a_break_time:0,rtc_a_decode_time:0,rtc_v_break_time:0,rtc_v_decode_time:0,use_resource_type:this.useResourceTypes,biz_product:(null===(t=this.playOption)||void 0===t?void 0:t.resourceMode)==s.ResourceMode.DG?1:0},u));var l=this.rtcViewer;l&&l.stop(),this.retryFailGwNodes=[],!this.isProbe&&this.dataReport.uploadReport(this.streamReportSeq,"RTCPlayStream")},e.prototype.onDisconnect=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_DISCONNECT+" "+this.streamId+" call"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.playStateUpdateError(e||v.error.kWebsocketDisconnectedError,!!e)},e.prototype.startSoundLevel=function(){var e,t=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" call streamID: "+this.streamId),!this.isProbe)if(this.remoteStream&&0!=this.remoteStream.getAudioTracks().length){null===(e=this.soundMeterWorklet)||void 0===e||e.destroy(),this.mic&&this.mic.disconnect()&&(this.mic=null);try{this.mic=this.ac.createMediaStreamSource(this.remoteStream);var r=this.soundMeterWorklet=new _.SoundMeterWorklet(this.logger,this.streamCenter.soundLevelInterval);r.initAudioWorklet(this.ac,this.mic),r.onSoundLevelUpdate=function(e){t.soundLevel=100*e}}catch(e){this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" get sound level failed "+e)}}else this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" "+this.streamId+" remote stream no found")},e.prototype.stopSoundLevel=function(){var e;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_STOP_SOUND_LEVEL+" call streamID: "+this.streamId),null===(e=this.soundMeterWorklet)||void 0===e||e.destroy(),this.mic&&this.mic.disconnect(),this.mic=null},e.prototype.onCalNetQualityResult=function(e,t){},e.prototype.onReceivedDataChannel=function(e){var t,r,n=this,i=new Uint8Array(e.data,0,10),o=e.data.byteLength-10,s=new Uint8Array(e.data,10,o);if(1==i[0]){var a=i[1],c=i[2]<<8|i[3],u=i[4]<<8|i[5],l=(new Date).getTime();if(this.first_pkt&&(this.next_sn[0]=c==u?c:u,this.first_pkt=!1),this.pkt_list.push({sn:c,sn0:u,recv_ts:l,flags:a,payload_len:o,payloadArray:s}),this.pkt_list.sort(this.compareShort),c==this.next_sn[0]){var d=this.pkt_list.filter((function(e){return e.sn0==u}));if(d.sort(this.compareShort),null!=d.find((function(e){return 1&e.flags}))&&d.length==this.compareShort(c,u)+1){for(var h=0,p=new ArrayBuffer(65536),f=0;f<d.length;f++)new Uint8Array(p).set(d[f].payloadArray,h),h+=d[f].payload_len;null===(t=this.onDataChannelList)||void 0===t||t.forEach((function(e){e(p,h,n.streamId)})),this.pkt_list=[],this.first_pkt=!0}this.next_sn[0]++}else for(var g=function(){var e=m.pkt_list.filter((function(e){return e.sn0==n.pkt_list[0].sn0}));if(e.sort(m.compareShort),null!=e.find((function(e){return 1&e.flags}))&&e.length==m.compareShort(e[e.length-1].sn,e[0].sn0)+1){for(var t=0,i=new ArrayBuffer(65536),o=0;o<e.length;o++)new Uint8Array(i).set(e[o].payloadArray,t),t+=e[o].payload_len;m.next_sn[0]=e[0].sn0+e.length,null===(r=m.onDataChannelList)||void 0===r||r.forEach((function(e){e(i,t,n.streamId)})),m.pkt_list=[],m.first_pkt=!0}else if(l-e[0].ts<4e3){var s=e[0].sn0;for(o=0;o<e.length&&s==e[o].sn;o++)s++;return m.next_sn[0]=s,"break"}for(o=0;o<e.length;o++)m.pkt_list.shift()},m=this;this.pkt_list.length>0&&"break"!==g(););}},e.prototype.compareShort=function(e,t){var r=new Uint16Array(1);r[0]=e-t;var n=new Int16Array(1);return n[0]=r[0],n[0]},e.prototype.getVideoCodec=function(){var e=this;this.peerConnection&&(this.peerConnection.getStats().then((function(t){t.forEach((function(r){if("inbound-rtp"===r.type&&"video"===r.kind&&r.codecId){var n=t.get(r.codecId).mimeType.toLowerCase();n.indexOf("h264")>-1?e.videoCodec="H264":n.indexOf("vp8")>-1&&(e.videoCodec="VP8",e.sideMediaConfig.isSEIStart&&e.logger.error(d.ZEGO_WEBRTC_ACTION.PAYER_GET_VIDEO_CODEC+" video code VP8 is not support SEI"))}}))})),this.videoCodecTimes++,this.videoCodec||this.videoCodecTimes>=5)?this.stopVideocTimer():this.videoCodecTimer=setTimeout((function(){e.getVideoCodec()}),100)},e.prototype.stopVideocTimer=function(){this.videoCodecTimer&&(clearTimeout(this.videoCodecTimer),this.videoCodecTimer=null)},e.prototype.getViewer=function(){return this.playStream&&!this.rtcViewer&&(this.rtcViewer=new g.StreamView(this.playStream,this)),this.rtcViewer},e.prototype.isMultiOuter=function(){return!(!this.stateCenter.accessClientIp||!this.streamConnectIP||this.stateCenter.accessClientIp===this.streamConnectIP)},e.prototype.isCustomCdn=function(){return!1},e}();t.ZegoPlayWeb=y},361:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.PublishModule=void 0;var s=r(1089),a=r(6706),c=r(3529),u=r(608),l=r(2752),d=r(3770),h=r(5321),p=r(1358),f=function(){function e(e,t,r,n,i,o){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=n,this.rtm=i,this.zegoWebRtc=o,this.recordDevices()}return e.prototype.createStream=function(e){var t=this;return this.logger.info(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" call"),e&&e.camera&&e.camera.audioBitRate&&(e.camera.audioBitrate=e.camera.audioBitRate),e&&e.camera&&e.camera.bitrate&&(e.camera.bitRate=e.camera.bitrate),e&&e.screen&&"object"==typeof e.screen&&e.screen.bitrate&&(e.screen.bitRate=e.screen.bitrate),e&&e.custom&&e.custom.bitrate&&(e.custom.bitRate=e.custom.bitrate),new Promise((function(r,i){var o="camera",l=(0,a.getReportSeq)();t.dataReport.newReport(l,c.ZegoRTCLogEvent.kZegoTaskCreateStream.event);var d=function(e){var n=t.streamCenter.checkPreview(e),i=e;if(n&&navigator.userAgent){var o=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);o&&o[1]&&o[1].includes("15_1")&&(i=t.getStreamThroughCanvas(e),n.localStream=i)}if(0==i.getAudioTracks().length){var s=t.streamCenter.ac.createMediaStreamDestination(),a=s?s.stream:null,c=a?a.getAudioTracks()[0]:null;c&&(c.enabled=!1,i.addTrack(c),n&&(n.hasEmptyAudioTrack=!0))}t.dataReport.uploadReport(l),!t.stateCenter.deviceInfos&&t.recordDevices(),r(i),t.streamCenter.activeSoundLevel()},f=function(e,r){void 0===r&&(r=""),t.dataReport.addMsgInfo(l,{error:e.code,message:e.message+r}),t.dataReport.uploadReport(l),i({code:e.code,msg:e.message+r})};if("https:"!==window.location.protocol&&"file:"!==window.location.protocol&&-1==window.location.hostname.indexOf("127.0.0.1")&&-1==window.location.hostname.indexOf("localhost"))return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" https or localhost required "),void f({code:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError.code,message:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError.message+" https or localhost required"});if(e&&e.screen){if(o="screen",!p.WebRTCUtil.checkScreenParams(e.screen,f))return;var g=t.stateCenter.browser,m=t.streamCenter.getScreenConstrains(e.screen);t.dataReport.addMsgInfo(l,{stream_type:c.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("screen"),screen:c.ZegoRTCLogEvent.kZegoTaskCreateStream.screen(m)});var _=function(e){t.streamCenter.createScreenPreviewer(e,m)&&d(e),e.getVideoTracks()[0].onended=function(){var r=(0,a.getReportSeq)();t.dataReport.newReport(r),t.dataReport.uploadReport(r,c.ZegoRTCLogEvent.kZegoTaskScreenSharingEnded),e&&t.stopPreview(e),t.stateCenter.actionListener("screenSharingEnded",e)}};"firefox"==g||"object"==typeof e.screen&&"firefox"==e.screen.type?t.startScreenShotFirFox("screen",m,(function(e,t,r){e?t&&_(t):r&&f(r)})):"chrome"==g&&h.ZegoWebRTC.screenShotReady||"object"==typeof e.screen&&"shot"==e.screen.type?t.startScreenShotChrome((function(r,n,i){r?(t.logger.info(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" using extension"),n&&_(n)):(i&&t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" extension "+i),"SS_DIALOG_CANCEL"===i||"object"==typeof e.screen&&"shot"==e.screen.type?i&&f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenCancelError):t.startScreenSharing(m,(function(e,r,n){e?r&&_(r):(t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" "+n),n&&f(n))})))})):"Electron"==g||"object"==typeof e.screen&&"Electron"==e.screen.type?t.startScreenShotElectron(m,(function(e,t,r){e?t&&_(t):r&&f(r)})):t.startScreenSharing(m,(function(e,t,r){e?t&&_(t):r&&f(r)}))}else{if(e&&"object"==typeof e.camera&&void 0!==e.camera.videoQuality&&!u.ClientUtil.checkInteger(e.camera.videoQuality))return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" videoQuality must be integer number"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," videoQuality must be integer number");if(e&&e.camera&&e.camera.audioBitrate){if(!u.ClientUtil.checkInteger(e.camera.audioBitrate))return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate must be integer number"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate must be integer number");if(e.camera.audioBitrate<6)return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate cannot less 6 kbps"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot less 6 kbps");if(e.camera.audioBitrate>510)return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate cannot greater than 510 kbps"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot greater than 510 kbps");t.stateCenter.audioBitRate=1e3*e.camera.audioBitrate}if(e&&e.camera&&e.camera.bitRate){if("number"!=typeof e.camera.bitRate)return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate must be integer number"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number");if(e.camera.bitRate>10240)return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate cannot greater than 10 Mbps"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps")}if(e&&e.camera&&void 0!==e.camera.channelCount&&!u.ClientUtil.checkInteger(e.camera.channelCount))return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" channelCount must be integer number"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," channelCount must be integer number");if(e&&e.camera&&4===e.camera.videoQuality&&!p.WebRTCUtil.checkCameraParams(e.camera,f))return;if(e&&e.custom&&e.custom.bitRate){if(!u.ClientUtil.checkInteger(e.custom.bitRate))return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate must be integer number"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number");if(e.custom.bitRate>10240)return t.logger.error(s.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate cannot greater than 10 Mbps"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps")}if(e&&e.custom&&e.custom.audioBitrate){if(!u.ClientUtil.checkInteger(e.custom.audioBitrate))return t.logger.error("ze.cs.0 audioBitrate must be integer number"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate must be integer number");if(e.custom.audioBitrate<6)return t.logger.error("ze.cs.0 audioBitrate cannot less 6 kbps"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot less 6 kbps");if(e.custom.audioBitrate>510)return t.logger.error("ze.cs.0 audioBitrate cannot greater than 510 kbps"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot greater than 510 kbps")}if(e&&e.custom&&void 0!==e.custom.channelCount&&1!==e.custom.channelCount&&2!==e.custom.channelCount)return t.logger.error("ze.cs.0 channelCount must number 1 or 2"),void f(c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," channelCount must number 1 or 2");var v={};if(e&&e.camera)o="camera",v=e.camera,t.dataReport.addMsgInfo(l,{stream_type:c.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("camera"),camera:c.ZegoRTCLogEvent.kZegoTaskCreateStream.camera(e.camera)}),"boolean"!=typeof v.video&&(v.video=!0),"boolean"!=typeof v.audio&&(v.audio=!0);else if(e&&e.custom){o="custom",v=e.custom;var y=e.custom.source instanceof MediaStream?"MediaStream":"HTMLElement";t.dataReport.addMsgInfo(l,{stream_type:c.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("custom"),custom:c.ZegoRTCLogEvent.kZegoTaskCreateStream.custom(n(n({},e.custom),{source:y}))})}t.startPreview(v,o,d,f)}}))},e.prototype.destroyStream=function(e){this.logger.info(s.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" call");var t=(0,a.getReportSeq)();if(this.dataReport.newReport(t),!(e instanceof MediaStream))return this.logger.error(s.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" localStream is not mediaStream or tracks is null"),this.dataReport.addMsgInfo(t,c.ZegoRTCLogEvent.kZegoTaskDestroyStream.error.kLocalStreamError),void this.dataReport.uploadReport(t,c.ZegoRTCLogEvent.kZegoTaskDestroyStream.event);e instanceof MediaStream&&0==e.getTracks().length&&this.logger.info(s.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" tracks is null"),this.stopPreview(e),this.dataReport.uploadReport(t,c.ZegoRTCLogEvent.kZegoTaskDestroyStream.event)},e.prototype.startPublishingStream=function(e,t,r,n){this.logger.info(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" call ",e);var i,o=!0,l="",d=(0,a.getReportSeq)();this.stateCenter.reportSeqList.startPublish[e]=d,this.dataReport.newReport(d,c.ZegoRTCLogEvent.kZegoTaskPublishStart.event);var h=c.ZegoRTCLogEvent.kZegoTaskPublishStart.error,p=h.kPublishParamError;o&&void 0===e&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+(l="stream id required")),o=!1,i=p),!o||e&&"string"==typeof e||(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+(l="stream id type wrong")),o=!1,i=p),o&&e.length>a.MAX_STREAM_ID_LENGTH&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+(l="stream id length limit")),o=!1,i=p),o&&!u.ClientUtil.checkIllegalCharacters(e)&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+(l="stream ID contains illegal characters")),o=!1,i=p),o&&(!t||t instanceof MediaStream&&0==t.getTracks().length)&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+(l="localStream wrong")),o=!1,i=p);var f=this.streamCenter.checkPreview(t);if(o&&!f&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+(l="stream is not from zego")),o=!1,i=h.kPublishNoPreviewError),(null==f?void 0:f.isVideoEffectStarting)&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+(l=(i=h.kPublishEffectIsStarting).message)),o=!1),o&&void 0!==r&&"object"!=typeof r&&(o=!1,i=p,l="publishOption must be object"),o&&void 0!==r&&void 0!==r.streamParams&&"string"!=typeof r.streamParams&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption streamParams must be string"),o=!1,i=p,l=" publishOption streamParams must be string"),o&&void 0!==r&&void 0!==r.extraInfo&&"string"!=typeof r.extraInfo&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption extraInfo must be string"),o=!1,i=p,l=" publishOption extraInfo must be string"),o&&void 0!==r&&void 0!==r.videoCodec&&"string"!=typeof r.videoCodec&&(this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption videoCodec must be string"),o=!1,i=p,l=" publishOption videoCodec must be string"),!o||!this.stateCenter.isMultiRoom||r&&"string"==typeof r.roomID&&""!=r.roomID||(o=!1,i=p,l=" roomID is need if set multi room"),r&&r.videoCodec&&(r.videoCodec=r.videoCodec.toUpperCase()),o&&(this.stateCenter.waitPublishStreamList[e]={retryStart:!1,localStream:t,publishOption:r,isDataChannel:n}),o&&this.rtm.isDisConnect()){if(this.stateCenter.connectChanged)return this.stateCenter.waitPublishStreamList[e].retryStart=!0,this.logger.info(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" connect changed"),!1;this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" not login"),o=!1,i=h.kPublishNoLoginError}if(!o)throw this.logger.error(s.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+l),this.dataReport.uploadReport(d,void 0,i,l),delete this.stateCenter.reportSeqList.startPublish[e],{errorCode:null==i?void 0:i.code,extendedData:l};r||(r={}),this.dataReport.addMsgInfo(d,{stream:c.ZegoRTCLogEvent.kZegoTaskPublishStart.stream(e),publishOption:c.ZegoRTCLogEvent.kZegoTaskPublishStart.publishOption(r),use_na:this.stateCenter.useNetAgent?1:0}),r.audioBitRate=this.stateCenter.audioBitRate;var g,m=r.roomID?r.roomID:this.stateCenter.roomList[0]?this.stateCenter.roomList[0].roomID:"",_=this.stateCenter.getRoomByRoomID(m);if(!_)return this.logger.error("zc.p.sps.1 room no found"),!1;if(this.dataReport.addMsgInfo(d,{publish_room_id:m,isMulti:this.stateCenter.isMultiRoom}),this.stateCenter.customUrl&&0!=this.stateCenter.customUrl.length)this.logger.info("zc.p.sps.1 customUrl "+JSON.stringify(this.stateCenter.customUrl)),g=this.stateCenter.customUrl;else{var v=this.stateCenter.settingConfig.getSetting("signal_nodes",!0);v&&v instanceof Array&&v.length>0&&(g=v,this.logger.info("zc.p.sps.1 setting config signal_nodes "+JSON.stringify(v)))}if(g)return this.stateCenter.publishStreamList[e]={state:a.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:r.extraInfo},this.streamCenter.setPublishStateStart(_,e,t,r,n)?(_.streamHandler.onPublishStateUpdate(a.ENUM_PUBLISH_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.publisherList[e].serverUrls=g,this.streamCenter.startPublishingStream(e)):(this.logger.info("zc.p.sps.1 cannot start publish"),!1);if(!this.streamCenter.setPublishStateStart(_,e,t,r,n))return this.logger.error("zc.p.sps.1 cannot start publish"),!1;this.stateCenter.publishStreamList[e]={state:a.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:r.extraInfo},this.logger.info("zc.p.sps.1 start publish"),_.streamHandler.onPublishStateUpdate(a.ENUM_PUBLISH_STATE_UPDATE.retry,e,{code:0,message:""});var y=this.stateCenter.useNetAgent,E=this.streamCenter.publisherList[e];if(y)return this.stateCenter.appConfig?(this.streamCenter.publisherList[e].serverUrls=["unified_rtc"],this.streamCenter.startPublishingStream(e,y),!0):(this.streamCenter.waitPublishList.push(e),!0);var S=E.retryDispatchHandler;return S.stopMaxTime(),S.invalid(),S.initStream(e,r,!0),S.startMaxTime(),S.active(0)},e.prototype.activateSEIInsert=function(e,t,r){return void 0===r&&(r=0),!1},e.prototype.sendSEI=function(e,t){if(!u.ClientUtil.isSupportEncodedTransforms())return this.logger.warn(s.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" browser not support "),!1;if(!(t instanceof Uint8Array))return this.logger.error(s.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" inData required Uint8Array"),!1;if(t.byteLength>4096)return this.logger.error(s.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" inData length limit"),!1;var r=this.streamCenter.publisherList[e];return r&&r.publisher?r.publisher.sendSEI(t):(this.logger.warn(s.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" publish not exist"),!1)},e.prototype.stopPublishingStream=function(e,t,r){var n,i;this.logger.info(s.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" call ",e+(t?t.toString():"")+" "+r);var o=(0,a.getReportSeq)();if(this.stateCenter.reportSeqList.stopPublish[e]=o,this.dataReport.newReport(o,c.ZegoRTCLogEvent.kZegoTaskPublishStop.event),this.dataReport.addMsgInfo(o,{streamID:c.ZegoRTCLogEvent.kZegoTaskPublishStop.stream(e)}),"string"!=typeof e||""==e)return this.logger.error(s.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" streamID must be string and not empty"),this.dataReport.uploadReport(o,void 0,c.ZegoRTCLogEvent.kZegoTaskPublishStop.error.kParamError,"stream id type error"),delete this.stateCenter.reportSeqList.stopPublish[e],!1;var u=this.streamCenter.publisherList[e],l=this.streamCenter.getRoomByStreamID(e),d=u&&u.publisher&&u.publisher.state!==a.ENUM_PUBLISH_STATE.stop||(null===(n=null==u?void 0:u.retryStreamHandler)||void 0===n?void 0:n.isRetrying());if(this.streamCenter.stopPublishingStream(e),r&&delete this.stateCenter.waitPublishStreamList[e],this.stateCenter.publishStreamList[e]){if(this.stateCenter.publishStreamList[e].state>=a.ENUM_PUBLISH_STREAM_STATE.update_info&&l){t&&1102018===t.code||l.streamHandler.updateStreamInfo(e,a.ENUM_STREAM_SUB_CMD.liveEnd);for(var h=0;h<l.streamList.length;h++)if(l.streamList[h].stream_id==e){!this.stateCenter.connectChanged&&l.streamList.splice(h--,1);break}}delete this.stateCenter.publishStreamList[e]}return this.dataReport.addMsgInfo(o,{session_id:null===(i=null==u?void 0:u.publisher)||void 0===i?void 0:i.sessionId}),this.dataReport.uploadReport(o),l&&d&&l.streamHandler.onPublishStateUpdate(a.ENUM_PUBLISH_STATE_UPDATE.error,e,t||{code:0,message:""}),!0},e.prototype.setCaptureVolume=function(e,t){var r=this;return new Promise((function(n){var i;r.logger.info(s.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" call");var o=function(e){r.logger.error(s.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" "+e),n({errorCode:c.ZegoRTCLogEvent.kZegoSetCaptureVolume.error.kParamError.code,extendedData:JSON.stringify({fail_reason:c.ZegoRTCLogEvent.kZegoSetCaptureVolume.error.kParamError.message+" "+e})})},a=r.streamCenter.ac,u=r.streamCenter.checkPreview(e);if(e instanceof MediaStream&&u)if(0!=e.getAudioTracks().length)if("number"!=typeof t||t<0||t>200)o(" volume must be number between 0 to 200");else{if(u.gainNode)u.gainNode.gain.value=t/100;else{u.audioNodeQueue||u.initAudioNodeQueue();var l=a.createGain();null===(i=u.audioNodeQueue)||void 0===i||i.pushFront(l),u.gainNode=l,u.gainNode.gain.value=t/100}a.resume(),n({errorCode:0,extendedData:""}),r.logger.info(s.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" call success")}else o(" stream audioTrack no found");else o(" stream must be created by zego")}))},e.prototype.getElectronScreenSources=function(){var e=this;return new Promise((function(t,r){var n=window.require("electron");n||(e.logger.error("zc.gess.0 Electron is not exist"),r({message:"Electron is not exist"})),n.desktopCapturer.getSources({types:["window","screen"]}).then((function(e){var r=e.map((function(e){return{id:e.id,name:e.name,thumbnail:e.thumbnail}}));t(r)})).catch((function(t){e.logger.error("zc.gess.0 "+t),r(t)}))}))},e.prototype.startScreenShotChrome=function(e){if(h.ZegoWebRTC.screenShotReady)window.postMessage({type:"SS_UI_REQUEST",text:"start"},"*"),u.ClientUtil.registerCallback("screenShare",{success:e},this.stateCenter.callbackList);else{var t='zc.b.ss Please install the extension:1. Go to chrome://extensions  2. Check: "Enable Developer mode   3. Click: "Load the unpacked extension... 4. Choose "extension" folder from the repository 5. Reload this page';this.logger.error(t),e(!1,null,{code:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+t})}},e.prototype.startScreenSharing=function(e,t){var r=this;"getDisplayMedia"in navigator.mediaDevices?navigator.mediaDevices.getDisplayMedia({audio:e.audio,video:e.video}).then((function(e){t(!0,e)})).catch((function(e){r.logger.error("zc.b.sss "+e),e.message&&"permission denied"==e.message.toLowerCase()?t(!1,null,c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenCancelError):t(!1,null,{code:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})})):(this.logger.error("zc.b.sss brower does not support getDisplayMedia"),t(!1,null,c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError))},e.prototype.startScreenShotFirFox=function(e,t,r){var i=this,o={video:n(n({},t.video),{mediaSource:e}),audio:t.audio};navigator.mediaDevices.getUserMedia(o).then((function(e){r(!0,e)})).catch((function(e){i.logger.error("ze.ssf.1 "+e),r(!1,null,{code:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})}))},e.prototype.startScreenShotElectron=function(e,t){var r=this;if(!window.require("electron"))return this.logger.error("ze.sse.1 Electron is not exist"),void t(!1,null,{code:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" Electron is not exist"});var n={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e.sourceID,maxWidth:window.screen.width,maxHeight:window.screen.height}},audio:!1};navigator.mediaDevices.getUserMedia(n).then((function(e){t(!0,e)})).catch((function(e){r.logger.error("ze.sse.1 "+e),t(!1,null,{code:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:c.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})}))},e.prototype.startPreview=function(e,t,r,n){var i=this,o=null;return o=new d.ZegoPreview(this.logger,this.streamCenter.ac,this.stateCenter,this.streamCenter,t),this.streamCenter.previewStreamList.push(o),o.startPreview(e,(function(n){i.streamCenter.soundLevelDelegate&&(null==o||o.startSoundLevel()),"camera"===t&&(!1===(null==e?void 0:e.audio)&&o&&(o.hasMicTrack=!1),(null==o?void 0:o.micTrack)&&(o.micTrack.enabled=i.streamCenter.isMicEnabled)),(null==e?void 0:e.videoOptimizationMode)&&i.streamCenter.setVideoTrackContentHint(n,null==e?void 0:e.videoOptimizationMode),i.logger.debug("zsc.sp.0 call success"),!i.stateCenter.deviceInfos&&i.recordDevices(),r&&r(n)}),(function(e){i.streamCenter.previewStreamList=i.streamCenter.previewStreamList.filter((function(e){return e!==o})),n&&n(e)})),!0},e.prototype.stopPreview=function(e){if(!e)return this.logger.warn("zsc.sp.0 localStream null"),!1;for(var t in this.streamCenter.publisherList)this.streamCenter.publisherList[t].localStream===e&&(this.streamCenter.publisherList[t].localStream=null);var r=this.streamCenter.checkPreview(e);return r?(r.previewSuc&&(r.stopPreview(),this.streamCenter.removePreview(r)),!0):(this.logger.warn("zsc.sp.0 no preview"),!1)},e.prototype.recordDevices=function(e,t){var r,s=this;this.logger.info("zsc.rd.0 call"),u.ClientUtil.getDevices((function(t){s.stateCenter.deviceInfos={microphones:t.microphones,speakers:t.speakers,cameras:t.cameras},e&&e(t)}),(function(e){s.logger.warn("zsc.rd.0 getDevices err:",e),t&&t(e)})),void 0!==(null===(r=navigator.mediaDevices)||void 0===r?void 0:r.ondevicechange)&&(navigator.mediaDevices.ondevicechange=null,navigator.mediaDevices.ondevicechange=function(e){s.logger.info("zsc.rd.0 devicechange"),s.stateCenter.deviceChangeTimer&&(clearTimeout(s.stateCenter.deviceChangeTimer),s.stateCenter.deviceChangeTimer=null),s.stateCenter.deviceChangeTimer=setTimeout((function(){u.ClientUtil.getDevices((function(e){for(var t=[],r=function(r){var n=s.stateCenter.deviceInfos.cameras[r];e.cameras.find((function(e){return e.deviceID===n.deviceID}))||t.push(n)},u=0;u<s.stateCenter.deviceInfos.cameras.length;u++)r(u);s.stateCenter.deviceStateOut=!1;var d=!1;t.length>0&&(d=!0),t.forEach((function(e){for(var t in s.streamCenter.publisherList){var r=s.streamCenter.publisherList[t],n=r.publisher;r.localStream&&""!==r.cameraLabel&&r.cameraLabel===e.deviceName&&(d=!1,n.sendStreamStatus(-6,n.mic_status),s.stateCenter.actionListener("_deviceError",l.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,e.deviceName,"camera"),s.stateCenter.actionListener("deviceError",l.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,e.deviceName)),r.localStream&&0===r.localStream.getAudioTracks().length&&(d=!1)}var i=(0,a.getReportSeq)();s.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),s.dataReport.addMsgInfo(i,{interrupt:0}),s.dataReport.uploadReport(i),s.stateCenter.actionListener("videoDeviceStateChanged","DELETE",e)})),d&&(s.stateCenter.deviceStateOut=!0);var h=s.stateCenter.deviceInfos.microphones.filter((function(t){return!e.microphones.find((function(e){return e.deviceID===t.deviceID}))}));h.forEach((function(e){for(var t in s.streamCenter.publisherList){var r=s.streamCenter.publisherList[t],n=r.publisher;r.localStream&&""!==r.microLabel&&(r.microLabel===e.deviceName||""!==r.microLabel&&r.microLabel.includes(e.deviceName))&&(n.sendStreamStatus(n.camera_status,-6),s.stateCenter.actionListener("_deviceError",l.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,s.streamCenter.publisherList[t].microLabel,"micro"),s.stateCenter.actionListener("deviceError",l.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,s.streamCenter.publisherList[t].microLabel))}var i=(0,a.getReportSeq)();s.dataReport.newReport(i,c.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),s.dataReport.addMsgInfo(i,{interrupt:0}),s.dataReport.uploadReport(i),s.stateCenter.actionListener("audioDeviceStateChanged","DELETE","Input",e)}));var p=s.stateCenter.deviceInfos.speakers.filter((function(t){return!e.speakers.find((function(e){return e.deviceID===t.deviceID}))})),f=e.cameras.filter((function(e){return!s.stateCenter.deviceInfos.cameras.find((function(t){return t.deviceID===e.deviceID}))})),g=e.microphones.filter((function(e){return!s.stateCenter.deviceInfos.microphones.find((function(t){return t.deviceID===e.deviceID}))})),m=e.speakers.filter((function(e){return!s.stateCenter.deviceInfos.speakers.find((function(t){return t.deviceID===e.deviceID}))}));p.forEach((function(e){var t=(0,a.getReportSeq)();s.dataReport.newReport(t,c.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.event),s.dataReport.addMsgInfo(t,{reason:c.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.reason("delete"),device:c.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.device(e)}),s.dataReport.uploadReport(t),s.stateCenter.actionListener("audioDeviceStateChanged","DELETE","Output",e)})),f.forEach((function(e){var t=(0,a.getReportSeq)();s.dataReport.newReport(t,c.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),s.dataReport.addMsgInfo(t,{interrupt:1}),s.dataReport.uploadReport(t),s.stateCenter.actionListener("videoDeviceStateChanged","ADD",e)})),g.forEach((function(e){var t=(0,a.getReportSeq)();s.dataReport.newReport(t,c.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),s.dataReport.addMsgInfo(t,{interrupt:1}),s.dataReport.uploadReport(t),s.stateCenter.actionListener("audioDeviceStateChanged","ADD","Input",e)})),m.forEach((function(e){var t=(0,a.getReportSeq)();s.dataReport.newReport(t,c.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.event),s.dataReport.addMsgInfo(t,{reason:c.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.reason("add"),device:c.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.device(e)}),s.dataReport.uploadReport(t),s.stateCenter.actionListener("audioDeviceStateChanged","ADD","Output",e)}));var _=n({},s.stateCenter.deviceInfos);if(s.stateCenter.deviceInfos={microphones:e.microphones,speakers:e.speakers,cameras:e.cameras},s.stateCenter.autoSwitchDeviceSetting.microphone){var v=s.stateCenter.deviceInfos.microphones;h&&0!==h.length&&0!=v.length&&s.streamCenter.previewStreamList.forEach((function(e){return i(s,void 0,void 0,(function(){var t,r,n,i,s,a,c;return o(this,(function(o){switch(o.label){case 0:return t=e.localStream,r=v[0].deviceID,i=null==(n=e.audioTrack)?void 0:n.getSettings().deviceId,s=!1,i&&"default"===i?(a=_.microphones.find((function(e){return"default"===e.deviceID})).deviceName,c=v.find((function(e){return"default"===e.deviceID})).deviceName,s=c!==a):""!==i&&(s=h.some((function(e){return e.deviceID===i}))),t&&s&&""!==r?[4,this.zegoWebRtc.useAudioDevice(t,r)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))}))}if(s.stateCenter.autoSwitchDeviceSetting.camera){var y=s.stateCenter.deviceInfos.cameras;t&&0!==t.length&&0!=y.length&&s.streamCenter.previewStreamList.forEach((function(e){return i(s,void 0,void 0,(function(){var r,n,i,s,a,c,u;return o(this,(function(o){switch(o.label){case 0:return r=e.localStream,n=y[0].deviceID,s=null==(i=e.videoTrack)?void 0:i.getSettings().deviceId,a=!1,s&&"default"===s?(c=_.cameras.find((function(e){return"default"===e.deviceID})).deviceName,u=y.find((function(e){return"default"===e.deviceID})).deviceName,a=u!==c):""!==s&&(a=t.some((function(e){return e.deviceID===s}))),r&&a&&""!==n?[4,this.zegoWebRtc.useVideoDevice(r,n)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))}))}}),(function(e){s.logger.warn("zsc.rd.0 getDevices err:",e)}))}),500)})},e.prototype.getStreamThroughCanvas=function(e){if(0==e.getVideoTracks().length)return e;var t=document.createElement("video"),r=document.createElement("canvas"),n=r.getContext("2d");t.setAttribute("style","display:none"),r.setAttribute("style","display:none"),t.setAttribute("muted",""),t.muted=!0,t.setAttribute("autoplay",""),t.autoplay=!0,t.setAttribute("playsinline",""),document.body.append(t),document.body.append(r),t.srcObject=e;var i=function i(){null==n||n.drawImage(t,0,0,r.width,r.height),window.requestAnimationFrame(i),t.srcObject=e};t.oncanplay=function(){r.width=t.videoWidth,r.height=t.videoHeight,t.play(),i()};var o=r.captureStream(15),s=o.getVideoTracks()[0],a=s.stop;if(s.stop=function(){a.call(s),i(),t.remove(),r.width=0,r.remove()},e instanceof MediaStream&&e.getAudioTracks().length){var c=e.getAudioTracks()[0];o.addTrack(c)}return o},e.prototype.getStreamStats=function(e){var t,r,n;return this.logger.info(s.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" call"),e instanceof MediaStream&&e.getTracks().length>0?n=null===(t=this.streamCenter.checkPublish(e))||void 0===t?void 0:t.publisher:"string"==typeof e&&(n=null===(r=this.streamCenter.publisherList[e])||void 0===r?void 0:r.publisher),n?(null==n?void 0:n.currentQuality)||null:(this.logger.error("zsc.sp.0 stream is not publishing"),null)},e.prototype.startWaitPublish=function(){var e=this;this.streamCenter.waitPublishList.forEach((function(t){e.streamCenter.startPublishingStream(t,e.stateCenter.useNetAgent)})),this.streamCenter.waitPublishList=[]},e}();t.PublishModule=f},3770:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPreview=void 0;var s=r(6706),a=r(3529),c=r(1089),u=r(9307),l=r(6171),d=r(8011),h=function(){function e(e,t,r,n,i){var o=this;this.logger=e,this.ac=t,this.stateCenter=r,this.streamCenter=n,this.previewType=i,this.localStream=null,this.videoInfo={},this.rtcViewer=null,this.previewSuc=!1,this.soundLevel=0,this.hasEmptyAudioTrack=!1,this.script=null,this.mic=null,this._audioTrack=null,this._videoTrack=null,this.cloneVideoTrack=null,this.originVideoTrack=null,this.activateSEIConfig=null,this.isAudioEnabled=!0,this.isVideoEnabled=!0,this.gainNode=null,this.cameraMaxResolution={},this.enableDualStream=!1,this.lowStreamConfig={width:160,height:120,frameRate:15,bitRate:50},this.muteImage=null,this.hasMicTrack=!0,this.enableMicrophoneOnly=function(e,t){if(!o.localStream)return o.logger.error("zp.em.2 no localStream"),!1;var r=t.getPublishList(o.localStream).map((function(e){return e.publisher}));return r.length&&r.forEach((function(t){t.sendStreamStatus(t.camera_status,o.isAudioEnabled&&e?0:2)})),o.micTrack?(o.micTrack.enabled=o.isAudioEnabled&&e,o.logger.debug("zp.emo.2 call success"),!0):(o.logger.info("zp.emo.2 no micTrack"),!0)},this.soundMeterWorklet=null,this.audioMixManager=null}return Object.defineProperty(e.prototype,"audioTrack",{get:function(){var e;return this._audioTrack||(null===(e=this.localStream)||void 0===e?void 0:e.getAudioTracks()[0])||null},set:function(e){this._audioTrack=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoTrack",{get:function(){var e;return this._videoTrack||(null===(e=this.localStream)||void 0===e?void 0:e.getVideoTracks()[0])||null},set:function(e){this._videoTrack=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"micTrack",{get:function(){return this.hasMicTrack&&"camera"===this.previewType&&this.audioTrack||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVideoEffectStarting",{get:function(){return!!this.videoEffect&&this.videoEffect.isStarting},enumerable:!1,configurable:!0}),e.prototype.getMediaStreamConstraints=function(e,t){var r={audio:null,video:null};if(r.audio=!0,r.video={width:640,height:480,frameRate:15,bitRate:this.stateCenter.settingConfig.getSetting("camera_video_bitrate")},e.audio?void 0===e.audioInput&&void 0===e.ANS&&void 0===e.AGC&&void 0===e.AEC&&void 0===e.channelCount?(r.audio={},r.audio.noiseSuppression=this.stateCenter.settingConfig.getSetting("ANS"),r.audio.autoGainControl=this.stateCenter.settingConfig.getSetting("AGC"),r.audio.echoCancellation=this.stateCenter.settingConfig.getSetting("AEC"),r.audio.channelCount=1):(r.audio={},null!=e.audioInput&&(r.audio.deviceId={exact:e.audioInput}),void 0!==e.ANS&&(r.audio.noiseSuppression=e.ANS),void 0!==e.AGC&&(r.audio.autoGainControl=e.AGC),void 0!==e.AEC&&(r.audio.echoCancellation=e.AEC),void 0!==e.channelCount&&(r.audio.channelCount=e.channelCount)):!1===e.audio&&(r.audio=!1),e.video){var n=640,i=480,o=15,a=this.stateCenter.settingConfig.getSetting("camera_video_bitrate");if(1===e.videoQuality?(n=s.ENUM_RESOLUTION_TYPE.LOW.width,i=s.ENUM_RESOLUTION_TYPE.LOW.height,o=s.ENUM_RESOLUTION_TYPE.LOW.frameRate,a=s.ENUM_RESOLUTION_TYPE.LOW.bitRate):2===e.videoQuality?(n=s.ENUM_RESOLUTION_TYPE.MEDIUM.width,i=s.ENUM_RESOLUTION_TYPE.MEDIUM.height,o=s.ENUM_RESOLUTION_TYPE.MEDIUM.frameRate,a=s.ENUM_RESOLUTION_TYPE.MEDIUM.bitRate):3===e.videoQuality?(n=s.ENUM_RESOLUTION_TYPE.HIGH.width,i=s.ENUM_RESOLUTION_TYPE.HIGH.height,o=s.ENUM_RESOLUTION_TYPE.HIGH.frameRate,a=s.ENUM_RESOLUTION_TYPE.HIGH.bitRate):4===e.videoQuality?(n=e.width,i=e.height,o=e.frameRate,a=e.bitRate||this.stateCenter.settingConfig.getSetting("camera_video_bitrate")):this.logger.info("zp.gmsc.2 use default"),t&&!e.videoQuality&&(e.width&&(n=e.width),e.height&&(i=e.height),e.frameRate&&(o=e.frameRate),e.bitRate&&(a=e.bitRate)),!1===e.horizontal){var c=i;i=n,n=c}!0===e.isSwitch&&(c=i,i=n,n=c),r.video={width:n,height:i,frameRate:o,bitRate:a},null!=e.facingMode?r.video.facingMode=e.facingMode:null!=e.videoInput&&null!=e.videoInput&&""!=e.videoInput&&(r.video.deviceId={exact:e.videoInput}),this.logger.info("zp.gmsc.2 width: "+n+" height: "+i+" rate: "+o)}else!1===e.video&&(e.audioBitrate&&(r.video={}),r.video=!1);return r},e.prototype.startPreview=function(e,t,r){return i(this,void 0,void 0,(function(){var i,s,c,u,l,d,h,p,f=this;return o(this,(function(o){return this.logger.debug("zp.sv.2 called"),this.mediaStreamConfig=e,void 0===navigator.mediaDevices||null==navigator.mediaDevices.getUserMedia?(r&&r(a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError),[2]):(i=function(e){t(e)},e.source instanceof MediaStream?(s=e.source.getVideoTracks(),c=s.length>0?s[0].getSettings():{width:0,height:0,frameRate:0},this.logger.debug("zp.sv.2 use external media stream"),this.previewSuc=!0,this.localStream=e.source,this.initMediaTrack(e.source),this.videoInfo={width:c.width,height:c.height,frameRate:c.frameRate,bitRate:e.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),startBitrate:e.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode"),minBitrate:e.minBitrate,keyFrameInterval:e.keyFrameInterval,channelCount:e.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*e.audioBitrate||48e3},i&&i(this.localStream),[2]):e.source instanceof HTMLMediaElement?((u=this.captureStream(e.source,e))?(this.videoInfo.bitRate=e.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),this.previewSuc=!0,this.initMediaTrack(u),i&&i(u)):r&&r(a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError),[2]):((l=this.getMediaStreamConstraints(e)).audio&&(d=this.stateCenter.settingConfig.getSetting("AEC",!0),h=this.stateCenter.settingConfig.getSetting("AGC",!0),p=this.stateCenter.settingConfig.getSetting("ANS",!0),"boolean"==typeof d&&(this.logger.info("zp.sv.2 setting AEC "+d),l.audio.echoCancellation=d),"boolean"==typeof h&&(this.logger.info("zp.sv.2 setting AGC "+h),l.audio.autoGainControl=h),"boolean"==typeof p&&(this.logger.info("zp.sv.2 setting ANS "+p),l.audio.noiseSuppression=p)),this.videoInfo=n(n({},l.video),{keyFrameInterval:e.keyFrameInterval}),this.videoInfo?(this.videoInfo.audioBitrate=1e3*e.audioBitrate||48e3,this.videoInfo.startBitrate=e.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode"),this.videoInfo.minBitrate=e.minBitrate,this.videoInfo.keyFrameInterval=e.keyFrameInterval):e.audioBitrate&&(this.videoInfo={audioBitrate:1e3*e.audioBitrate||48e3}),this.mediaStreamConfig.video=!!l.video,this.mediaStreamConfig.audio=!!l.audio,this.logger.info("zp.sv.2 ",JSON.stringify(l)),e.unlimitedCaptureResolution&&l.video.width&&(l.video.width={ideal:4096},l.video.height={ideal:2160},this.logger.info("zp.sv.2 ","capture max resolution of camera")),navigator.mediaDevices.getUserMedia(l).then((function(t){f.logger.info("zp.sv.2 success"),f.localStream=t,f.previewSuc=!0,f.initMediaTrack(t),f.videoInfo&&(f.videoInfo.channelCount=e.channelCount||(f.audioTrack&&f.audioTrack.getSettings?f.audioTrack.getSettings().channelCount:1)),i&&i(t)}),(function(e){if(f.logger.info("zp.sv.2 failed ",e.name," ",e.message),r){var t=a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kGetUserMediaError;t.message=t.message+" "+e.name+" "+e.message,"NotAllowedError"===e.name||"SecurityError"===e.name?(t=n({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceNoAllowedError)).message=e.name+": "+t.message:"NotReadableError"===e.name?(t=n({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceNoReadableError)).message=e.name+": "+t.message:"OverconstrainedError"===e.name&&((t=n({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceOverConstrainedError)).message=e.name+": "+t.message+(e.constraint?". such as "+e.constraint:"")),r(t)}})),[2]))}))}))},e.prototype.captureStream=function(e,t){if(!e)return this.logger.info("zp.cs.2 no local video"),null;var r;if(e.captureStream)r=e.captureStream(),this.logger.debug("zp.cs.2 captureStream");else{if(!e.mozCaptureStream)return this.logger.info("zp.cs.2 don't support"),null;r=e.mozCaptureStream(),this.logger.debug("zp.cs.2 mozCaptureStream")}return 0==r.getTracks().length?(this.logger.error("zp.cs.2 external capture tracks no found"),null):(this.localStream=r,this.videoInfo={width:e.videoWidth,height:e.videoHeight,frameRate:0,bitRate:t.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),channelCount:t.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*t.audioBitrate||48e3,startBitrate:t.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode"),minBitrate:t.minBitrate,keyFrameInterval:t.keyFrameInterval},this.logger.debug("zp.cs.2 called success"),this.localStream)},e.prototype.stopPreview=function(){var e,t,r,n,i,o;if(this.logger.info("zp.sv.2.1 called"),this.localStream){var s=this.rtcViewer;s&&s.stop(),this.videoEffect&&(this.videoEffect.setBeautyEffectOptions(!1),this.videoEffect.destroy()),null===(e=this.cloneVideoTrack)||void 0===e||e.stop(),this.muteImageAnID&&cancelAnimationFrame(this.muteImageAnID),null===(t=this.originVideoTrack)||void 0===t||t.stop(),null===(r=this.videoTrack)||void 0===r||r.stop(),null===(n=this.audioTrack)||void 0===n||n.stop(),null===(i=this.audioMixManager)||void 0===i||i.stopAudioManager(),this.localStream.getTracks().reverse().forEach((function(e){return e.stop()})),this.localStream=null,null===(o=this.lowStream)||void 0===o||o.getTracks().reverse().forEach((function(e){return e.stop()})),this.lowStream=void 0,this.videoInfo={}}},e.prototype.enableMicrophone=function(e,t){return!1},e.prototype.enableCamera=function(e,t,r){return!1},e.prototype.enableCameraCapturing=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2,!1]}))}))},e.prototype.startSoundLevel=function(){var e,t=this;if(this.localStream&&0!=this.localStream.getAudioTracks().length){null===(e=this.soundMeterWorklet)||void 0===e||e.destroy(),this.mic&&this.mic.disconnect();try{this.mic=this.ac.createMediaStreamSource(this.localStream);var r=this.soundMeterWorklet=new d.SoundMeterWorklet(this.logger,this.streamCenter.soundLevelInterval);r.initAudioWorklet(this.ac,this.mic),r.onSoundLevelUpdate=function(e){t.soundLevel=100*e}}catch(e){this.logger.error(c.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" get sound level failed "+e)}}},e.prototype.stopSoundLevel=function(){var e;this.soundLevel=0,null===(e=this.soundMeterWorklet)||void 0===e||e.destroy(),this.mic&&this.mic.disconnect(),this.mic=null},e.prototype.restartSoundLevel=function(){this.streamCenter.soundLevelDelegate?(this.stopSoundLevel(),this.startSoundLevel()):this.stopSoundLevel()},e.prototype.setBeautyEffect=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.replacePreviewTrack=function(e,t,r){void 0===t&&(t=!1)},e.prototype.createLowStream=function(){var e,t,r,n=null===(e=this.localStream)||void 0===e?void 0:e.getVideoTracks()[0];if(n){var i=n.getSettings().height,o=n.getSettings().width,s=i&&o?i/o:1;try{this.lowStream=null===(t=this.localStream)||void 0===t?void 0:t.clone();var a,c=null===(r=this.lowStream)||void 0===r?void 0:r.getVideoTracks()[0],u=this.lowStreamConfig,l=u.width,d=u.frameRate;a=Math.round(s*this.lowStreamConfig.width),null==c||c.applyConstraints({width:l,height:a,frameRate:d})}catch(e){this.logger.error("zp.cls "+e)}}},e.prototype.initAudioNodeQueue=function(e){var t,r;if(!this.audioTrack||!this.localStream)return!1;var n=new MediaStream;n.addTrack(this.audioTrack);var i=this.ac.createMediaStreamSource(n),o=this.ac.createMediaStreamDestination();this.audioNodeQueue=new l.AudioNodeQueue(i,o);var s=o.stream.getAudioTracks()[0];if(this.audioMixManager&&(null===(t=this.audioMixManager)||void 0===t?void 0:t.audioDestNode)&&e)return!0;var a=this.rtcViewer;for(var c in this.streamCenter.publisherList){var u=this.streamCenter.publisherList[c];if(u.localStream==this.localStream){var d=null===(r=u.publisher.peerConnection)||void 0===r?void 0:r.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));d&&d.replaceTrack(s);break}}var h=this.localStream.getAudioTracks()[0];return h&&(s.enabled=h.enabled,this.localStream.removeTrack(h)),this.localStream.addTrack(s),a&&a.setAudio(s),!0},e.prototype.initMediaTrack=function(e){e.getVideoTracks().length>0&&(this.videoTrack=e.getVideoTracks()[0],this.originVideoTrack=this.videoTrack),e.getAudioTracks().length>0&&(this.audioTrack=e.getAudioTracks()[0])},e.prototype.onAudioTrackChange=function(e){},e.prototype.getViewer=function(){return this.localStream&&!this.rtcViewer&&(this.rtcViewer=new u.StreamView(this.localStream,this)),this.rtcViewer},e}();t.ZegoPreview=h},1547:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPublish=void 0;var i=r(6706),o=r(4767),s=r(3409),a=r(608),c=r(3529),u=r(1089),l=r(7646),d=function(){function e(e,t,r,n,o,a,c){var u=this;this.curCBState={state:"NO_PUBLISH",code:0},this._state=i.ENUM_PUBLISH_STATE.stop,this.lastState=i.ENUM_PUBLISH_STATE.stop,this.sessionId=0,this.sessionToken="",this.candidateInfo=[],this.qualityTimer=null,this.publishQualityList=[],this.maxQualityListCount=10,this.lastPublishStats={},this.currentQuality={video:{videoBitrate:0,videoFPS:0,videoTransferFPS:0,frameHeight:0,frameWidth:0,muteState:"1",videoQuality:-1,videoPacketsLost:0,videoPacketsLostRate:0,googCodecName:""},audio:{audioBitrate:0,audioCodec:"opus",muteState:"1",audioQuality:-1,audioFPS:0,audioPacketsLost:0,audioPacketsLostRate:0,googCodecName:""}},this.canvasTimer=null,this.reportSeq=NaN,this.streamReportSeq=(0,i.getSeq)(),this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.qualitySeq=0,this.videoInfo={width:0,height:0,frameRate:0,bitRate:0,channelCount:1,audioBitrate:48e3,minBitrate:0,keyFrameInterval:2},this.mediaStreamConfig=null,this.offerSeq=0,this.peerConnection=null,this.qualityCount=0,this.closeSessionSignal=!1,this.channelCount=1,this.localSdpOrder=[],this.remoteSdpOrder=[],this.videoCodec="H264",this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.stop,this.isExternal=!1,this.negoInterval=25e3,this.publishEvent=!1,this.cameraState="on",this.microState="on",this.gwNode="",this.gwNodeList=[],this.gwNodesTTL=0,this.retryFailGwNodes=[],this.dispatchedGwNodes=[],this.needIncMax=!1,this.probeCount=0,this.gotMax=!1,this.initFitCnt=0,this.targetRate=0,this.totalBitrateArray=[],this.totalTargetRateArray=[],this.totalRetransRateArray=[],this.isPeer=!1,this.peerFailCount=0,this.peerID=0,this.netQuality=0,this.probeTime=0,this.probeInterval=6e4,this.probeState=i.ENUM_PROBE_STATE.probed,this.iceDisconnectedMaxTime=15e3,this.isUpdateSDP=!1,this.isUdpSuccess=!1,this.toBeReplacedTracks={},this.send_seq=0,this.dataChannelState=0,this.first_pkt=!0,this.next_sn=[],this.pkt_list=[],this.answerSdpTime=0,this.streamConnectIP="",this.mediaSideInfos=[],this.lowMediaSideInfos=[],this.sideMediaConfig={isSEIStart:!1,SEIType:i.ZegoSEIType.ZegoDefined,unregisterSeiFilter:"",uuidSend:!1},this.poorQualityNum=0,this.cachedGwNodesMode=s.CachedNodesUseMode.DiffReUse,this._turnToTcp=!1,this.encodeLowVideoFrame=function(e,t){u.encodeFrame(e,t,!0)},this.encodeVideoFrame=function(e,t){u.encodeFrame(e,t,!1)},this.camera_status=2,this.mic_status=2,this.streamId=e,this.logger=t,this.dataReport=r,this.qualityTimeInterval=n,this.streamCenter=o,this.stateCenter=a,this.dataReport.newReport(this.streamReportSeq),this.videoCodec=this.stateCenter.settingConfig.getSetting("publish_video_codec"),this.previewer=c,this.localStream=c.localStream,c.onAudioTrackChange=function(e){var t=u.peerConnection&&u.peerConnection.getSenders().find((function(t){var r;return(null===(r=t.track)||void 0===r?void 0:r.kind)===e.kind}));t?(t.replaceTrack(e),u.logger.info("zc.oatc remote audio track change success")):u.logger.warn("zc.oatc stream has not sender")}}return e.prototype.updateCBState=function(e){var t=this,r=Object.keys(e).some((function(r){return e[r]!==t.curCBState[r]}));return r&&(this.curCBState=e),r},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this.lastState=this._state,this._state=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lowStream",{get:function(){var e;return null===(e=this.previewer)||void 0===e?void 0:e.lowStream},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iceStateDisConnect",{get:function(){return[i.ENUM_PUBLISH_STATE_NEGO.iceClosed,i.ENUM_PUBLISH_STATE_NEGO.iceDisconnected,i.ENUM_PUBLISH_STATE_NEGO.iceFailed].includes(this.stateNego)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLastConnected",{get:function(){return this.lastState===i.ENUM_PUBLISH_STATE.publishing},enumerable:!1,configurable:!0}),e.prototype.publishStateUpdateError=function(e,t,r,n){this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_STATE_ERROR+"  call ",this.streamId+" "+JSON.stringify(e)),this.streamId&&this.onPublishStateUpdate(i.ENUM_PUBLISH_STATE_UPDATE.error,this.streamId,e,t,r,n),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_STATE_ERROR+"  ended")},e.prototype.netProbeToReDispatch=function(){this.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNetProbePoor)},e.prototype.resetPublish=function(){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_RESET_PUBLISH+"   "+this.streamId+" call"),this.state=i.ENUM_PUBLISH_STATE.stop,this.publishEvent=!1,null==this.peerConnection&&null==this.peerConnection||(this.peerConnection.close(),this.peerConnection=null),null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.clearPublishQualityTimer(),this.clearCanvasTimer(),this.signal&&(this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId),this.signal.unregisterPushCallback("SessionResetPush",this.sessionId),this.signal.unregisterPushCallback("PublishEventPush",this.sessionId),this.signal.unregisterPushCallback("ClientInfoPush",this.sessionId)),this.sessionSeq=0,this.offerSeq=0,this.candidateInfo=[],this.publishQualityList=[],this.qualityUploadLastTime=0,this.resetEncBitrate(),this.isUpdateSDP=!1},e.prototype.clearPublishQualityTimer=function(){null!=this.qualityTimer&&(clearInterval(this.qualityTimer),this.qualityTimer=null),this.lastPublishStats={},this.qualityCount=0,this.poorQualityNum=0},e.prototype.clearCanvasTimer=function(){null!=this.canvasTimer&&(clearInterval(this.canvasTimer),this.canvasTimer=null)},e.prototype.shouldSendCloseSession=function(){return this.state!=i.ENUM_PUBLISH_STATE.stop&&this.state!=i.ENUM_PUBLISH_STATE.waitingSessionRsp},e.prototype.startPublish=function(e,t,r,n,i){var o,s,l,d,h,p=this;if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+e+" called"),this.signal&&this.signal.negoInterval&&(this.negoInterval=this.signal.negoInterval),e){var f;this.localStream=t,this.mediaStreamConfig=n,this.channelCount=n.channelCount,this.publishOption=i||{},(null==i?void 0:i.SEIType)&&(this.sideMediaConfig.SEIType=i.SEIType),this.currentQuality.video.muteState=(null===(s=null===(o=this.previewer)||void 0===o?void 0:o.videoTrack)||void 0===s?void 0:s.enabled)?"0":"1",this.currentQuality.audio.muteState=this.localStream.getAudioTracks().length>0&&this.localStream.getAudioTracks()[0].enabled?"0":"1",navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&n&&(n.externalCapture||n.externalMediaStream)&&(this.localStream.onaddtrack=function(){var e,t,r,n;p.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+p.streamId+" Track added");var i=[];(null===(e=p.previewer)||void 0===e?void 0:e.videoTrack)&&i.push(null===(t=p.previewer)||void 0===t?void 0:t.videoTrack);var o=p.localStream.getAudioTracks();if(i.length>1){var s=null===(r=p.peerConnection)||void 0===r?void 0:r.getSenders().find((function(e){var t;return(null===(t=e.track)||void 0===t?void 0:t.id)===p.localStream.getVideoTracks()[0].id}));null==s||s.replaceTrack(i[1]),p.localStream.removeTrack(i[0])}else o.length>1&&(s=null===(n=p.peerConnection)||void 0===n?void 0:n.getSenders().find((function(e){var t;return(null===(t=e.track)||void 0===t?void 0:t.kind)===o[1].kind})),null==s||s.replaceTrack(o[1]),p.localStream.removeTrack(o[0]))}),r&&(this.videoInfo=r),i&&i.videoCodec&&(this.videoCodec=i.videoCodec);var g=null===(l=this.previewer)||void 0===l?void 0:l.previewType;switch(g){case"camera":f=this.stateCenter.settingConfig.getSetting("camera_video_bitrate",!0);break;case"screen":f=this.stateCenter.settingConfig.getSetting("screen_video_bitrate",!0);break;case"custom":f=this.stateCenter.settingConfig.getSetting("custom_video_bitrate",!0)}void 0!==f&&(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting "+g+" "+f),this.videoInfo.bitRate=f);var m=this.stateCenter.settingConfig.getSetting("bitrate_mode",!0);m&&(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting bitrate_mode "+m),this.videoInfo.startBitrate=m);var _=this.stateCenter.settingConfig.getSetting("publish_video_codec",!0);if(_&&(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting publish_video_codec "+_),this.videoCodec=_),"boolean"==typeof(null==i?void 0:i.isSEIStart)&&(this.sideMediaConfig.isSEIStart=null==i?void 0:i.isSEIStart),this.sideMediaConfig.isSEIStart){var v=a.ClientUtil.isSupportEncodedTransforms();"H264"===this.videoCodec&&v||(this.sideMediaConfig.isSEIStart=!1)}(null===(d=this.stateCenter.seiConfig)||void 0===d?void 0:d.unregisterSEIFilter)&&(this.sideMediaConfig.unregisterSeiFilter=null===(h=this.stateCenter.seiConfig)||void 0===h?void 0:h.unregisterSEIFilter),this.dataReport.addMsgInfo(this.reportSeq,{video_en_codec_id:c.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_codec_id("VP8"==this.videoCodec?2:0),audio_c_channel_count:c.ZegoRTCLogEvent.kZegoTaskPublishStart.audio_c_channel_count(2==this.channelCount?2:1),audio_en_bps:c.ZegoRTCLogEvent.kZegoTaskPublishStart.audio_en_bps(this.videoInfo.audioBitrate),aec_level:c.ZegoRTCLogEvent.kZegoTaskPublishStart.aec_level(1==n.AEC?2:0==n.AEC?0:2),ans_level:c.ZegoRTCLogEvent.kZegoTaskPublishStart.ans_level(1==n.ANS?2:0==n.ANS?0:2),agc:c.ZegoRTCLogEvent.kZegoTaskPublishStart.agc(1==n.AGC?2:0==n.AGC?0:2),traffic_control_min_video_bitrate:c.ZegoRTCLogEvent.kZegoTaskPublishStart.traffic_control_min_video_bitrate(this.videoInfo.bitRate)}),this.isPeer?this.createOffer({encodedInsertableStreams:this.sideMediaConfig.isSEIStart}):this.createSession(),this.negoTimer=setTimeout((function(){p.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" waiting timeout"),p.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNegoTimeoutError)}),this.negoInterval)}else this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+e+" streamId is null")},e.prototype.activateSEIInsert=function(e,t){return new Promise((function(e,t){e(!1)}))},e.prototype.createSession=function(e,t){var r,n,o,s=this;this.sessionSeq=(0,i.getSeq)();var a=this.streamId;1==this.streamCenter.testEnvironment&&(a="zegotest-"+this.streamCenter.appid+"-"+this.streamId);var l=this.stateCenter.turnOverTcpOnly,d=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);d&&(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting udp_or_tcp "+d),l="tcp"===d),l&&(this.isPeer=!1);var h="",p=[];this.stateCenter.idName&&p.push("zguid="+this.stateCenter.idName);var f=(null===(n=null===(r=this.streamCenter.publisherList[this.streamId])||void 0===r?void 0:r.room)||void 0===n?void 0:n.roomID)||(null===(o=this.stateCenter.roomList[0])||void 0===o?void 0:o.roomID);if(f&&p.push("zgrid="+f),this.isPeer){this.dataReport.eventStart(this.reportSeq,"CreateSessionWithSdp"),this.dataReport.eventStart(this.streamReportSeq,"CreateSessionWithSdp");var g=(new Date).getTime();p.length>0&&(h=p.join("&")),this.signal.createSessionWithSdp({seq:this.sessionSeq,type:0,mode:0,streamId:a,videoInfo:this.videoInfo,strAuthParam:this.publishOption&&this.publishOption.streamParams||"",sdp:t||e.sdp,serverHost:this.gwNode,params:h},(function(e,t,r){var n=(new Date).getTime();s.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" create session time "+(n-g)),s.handleCreateSessionWithSdpResp(e,t,r)}),(function(e,t){s.sessionSeq==t?(s.dataReport.eventEndWithMsg(s.reportSeq,"CreateSession",{error:e}),s.dataReport.eventEndWithMsg(s.streamReportSeq,"CreateSession",{error:e}),s.publishStateUpdateError(e==i.SEND_MSG_TIMEOUT?c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError:c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)):s.logger.warn(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" seq is not match.")}))}else this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.dataReport.eventStart(this.streamReportSeq,"CreateSession"),p.length>0&&(h=p.join("&")),this.signal.createSession(this.sessionSeq,0,0,a,this.publishOption&&this.publishOption.streamParams,this.gwNode,h,(function(e,t,r){s.handleCreateSessionResp(e,t,r)}),(function(e,t){s.sessionSeq==t?(s.dataReport.eventEndWithMsg(s.reportSeq,"CreateSession",{error:e}),s.dataReport.eventEndWithMsg(s.streamReportSeq,"CreateSession",{error:e}),s.publishStateUpdateError(e==i.SEND_MSG_TIMEOUT?c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError:c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)):s.logger.warn(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" seq is not match.")}));this.state=i.ENUM_PUBLISH_STATE.waitingSessionRsp,this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" called success"),this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.start},e.prototype.handleCreateSessionResp=function(e,t,r){var n=r.turn_server,i=n.split("?")[0]&&n.split("?")[0].slice(5),o=this.streamCenter.server.split("?"),s=o[1]&&o[1].slice(2),a="webrtc://".concat(i,"/").concat(s,"/").concat(this.streamId);this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSession",{sessionId:r.session_id,url:a}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSession",{sessionId:r.session_id,url:a}),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" sessionId:"+r.session_id),this.sessionSeq==e?(this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,0!==r.result?(this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create session failed "+r.result),this.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)):(this.sessionId=r.session_id,this.sessionToken=r.session_token,this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create session success "+this.sessionId),this.setGwNodes(r),this.dataReport.addMsgInfo(this.reportSeq,{session_id:c.ZegoRTCLogEvent.kZegoTaskPublishStart.session_id(this.sessionId)}),this.onCreatePublishSessionSuccess(r))):this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" seq is not match.")},e.prototype.handleCreateSessionWithSdpResp=function(e,t,r){var n=this;if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" sessionId:"+t),this.sessionSeq==e){this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSessionWithSdp",{sessionId:t});var i=0,o=(new Date).getTime();if(this.dataReport.dataStatistics[this.reportSeq]&&this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create sdp time "+(i=o-this.dataReport.dataStatistics[this.reportSeq].event_time)),this.answerSdpTime=o,this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSessionWithSdp",{sessionId:t,sessionTime:i}),0!==r.result)this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" create session failed "+r.result),this.publishStateUpdateError({code:c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError.code,message:c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError.message+" result:"+r.result});else{this.sessionId=t,this.sessionToken=r.session_token,this.setGwNodes(r),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" get remote session success "+this.streamId),this.dataReport.eventStart(this.reportSeq,"IceConnected");var s=performance.now();this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,t,r){if(s){var i=(performance.now()-s).toFixed(0);s=void 0,n.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" ".concat(n.streamId,", cmd: CloseSessionPush, cost_time: ").concat(i))}n.onRecvCloseSession(e,t,r)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,t,r){n.onRecvResetSession(e,t,r)})),this.signal.registerPushCallback("PublishEventPush",this.sessionId,(function(e,t,r){if(s){var i=(performance.now()-s).toFixed(0);s=void 0,n.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" ".concat(n.streamId,", cmd: PublishEventPush, cost_time: ").concat(i))}n.onRecvPublishEvent(e,t,r)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,t,r){n.onRecvClientInfo(e,t,r)})),this.signal.registerPushCallback("MediaDescUpdatePush",this.sessionId,(function(e,t,r){n.onRecvUpdateMediaDescription(e,t,r)})),this.onGetRemoteOfferSuccess(r.sdp)}}else this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" seq is not match.")},e.prototype.setGwNodes=function(e){var t;if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_GW_NODES+" "+this.streamId+" "+JSON.stringify(null==e?void 0:e.gw_nodes)+" "+JSON.stringify(this.retryFailGwNodes)),(null===(t=e.gw_nodes)||void 0===t?void 0:t.length)>0){var r=this.sortGwNodes(e.gw_nodes,this.retryFailGwNodes);this.retryFailGwNodes=[],this.handleDispatchedGwNodes(r,e.gw_nodes_ttl)}},e.prototype.resetGwNodes=function(){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_RESET_GW_NODES+" "+this.streamId),this.gwNode="",this.gwNodeList=[],this.gwNodesTTL=0},e.prototype.pureSortGwNodes=function(){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_PURE_SORT_GW_NODES+" "+this.streamId);var e=this.sortGwNodes(this.gwNodeList,this.retryFailGwNodes);this.gwNodeList=e},e.prototype.sortGwNodes=function(e,t){return t.forEach((function(t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),e.push(t))})),e},e.prototype.handleDispatchedGwNodes=function(e,t){if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_HANDLE_DISPATCHED_GW_NODES+" "+this.streamId+" "+JSON.stringify(e)),Array.isArray(e)){this.gwNodeList=e.length>0?e:this.gwNodeList,this.gwNode=e.length>0?this.gwNodeList[0]:this.gwNode;var r=0===t?60:t;this.gwNodesTTL=r?(new Date).getTime()+1e3*r:this.gwNodesTTL,e.length>0&&this.streamCenter.updateCachedGwNodesList(this,!0,e,r)}},e.prototype.onCreatePublishSessionSuccess=function(e){var t=this,r=u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS;this.logger.info(r+" "+this.streamId+" called");var n=[];if(e.turn_server){var i=e.turn_server.split(";");this._turnToTcp=this.stateCenter.turnOverTcpOnly,this.streamCenter.autoSwitchProtocol=this.stateCenter.settingConfig.getSetting("auto_to_tcp")||!1;var o=this.stateCenter.settingConfig.getSetting("udp_max_fail_num");!isNaN(o)&&(this.streamCenter.maxUdpFailNum=o);var s=this.streamCenter,a=s.autoSwitchProtocol,c=s.maxUdpFailNum,l=s.udpFailNum;this.logger.info(r+"  autoToTcp: ".concat(a,", udpFailNum: ").concat(l,", maxUdpFailNum: ").concat(c,".")),a&&!this._turnToTcp&&l>=c&&(this.logger.info(r+" switch to tcp. "),this._turnToTcp=!0);var d=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);d&&(this.logger.info(r+" setting udp_or_tcp "+d),this._turnToTcp="tcp"===d);var h,p=i.filter((function(e){return e.indexOf("udp")>-1})),f=i.filter((function(e){return e.indexOf("tcp")>-1}));h=this._turnToTcp?f.length>0?f:p.map((function(e){return e.replace("udp","tcp")})):p,this.logger.info(r+" over tcp "+JSON.stringify(h)),n.push.apply(n,h)}e.stun_server&&n.push(e.stun_server);var g={iceTransportPolicy:"all",iceServers:[{urls:n,username:e.turn_username,credential:e.turn_auth_key}],encodedInsertableStreams:this.sideMediaConfig.isSEIStart};this.logger.info(r+" "+this.streamId+" username: "+e.turn_username),this.logger.info(r+" "+this.streamId+" credential: "+e.turn_auth_key),this.createOffer(g);var m=performance.now();this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,(function(e,r,n){t.onRecvCandidateInfo(e,r,n)})),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,n,i){if(m){var o=(performance.now()-m).toFixed(0);m=void 0,t.logger.info(r+" ".concat(t.streamId,", cmd: CloseSessionPush, cost_time: ").concat(o))}t.onRecvCloseSession(e,n,i)})),this.signal.registerPushCallback("MediaDescPush",this.sessionId,(function(e,r,n){t.onRecvMediaDescription(e,r,n)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,r,n){t.onRecvResetSession(e,r,n)})),this.signal.registerPushCallback("PublishEventPush",this.sessionId,(function(e,n,i){if(m){var o=(performance.now()-m).toFixed(0);m=void 0,t.logger.info(r+" ".concat(t.streamId,", cmd: PublishEventPush, cost_time: ").concat(o))}t.onRecvPublishEvent(e,n,i)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,r,n){t.onRecvClientInfo(e,r,n)})),this.signal.registerPushCallback("MediaDescUpdatePush",this.sessionId,(function(e,r,n){t.onRecvUpdateMediaDescription(e,r,n)})),this.logger.info(r+" "+this.streamId+" call success")},e.prototype.createOffer=function(e){var t,r,n,i=this,o=u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS;this.peerConnection=new RTCPeerConnection(e),this.peerConnection.onicecandidate=function(e){i.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){i.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){i.onIceConnectionStateChange(e)},this.streamCenter.isDataChannelEnabled&&(this.dataChannel=this.peerConnection.createDataChannel(this.streamId),this.dataChannel.binaryType="arraybuffer",this.dataChannel.onopen=function(e){i.logger.info(o+" "+i.streamId+" data channel open"),i.dataChannelState=1},this.dataChannel.onclose=function(e){i.logger.error(o+" "+i.streamId+" data channel close ")});var s=[],a=[];if(this.lowStream&&this.lowStream.getVideoTracks().forEach((function(e){var t,r=null===(t=i.peerConnection)||void 0===t?void 0:t.addTrack(e,i.lowStream);i.sideMediaConfig.isSEIStart&&r&&"function"==typeof r.createEncodedStreams&&i.createVideoSenderTransform(r,!0)})),this.localStream){if(this.localStream.getTracks().forEach((function(e){var t,r=null===(t=i.peerConnection)||void 0===t?void 0:t.addTrack(e,i.localStream);i.sideMediaConfig.isSEIStart&&r&&"function"==typeof r.createEncodedStreams&&("video"===e.kind?i.createVideoSenderTransform(r):"audio"===e.kind&&i.createAudioSenderTransform(r))})),!(null===(t=this.previewer)||void 0===t?void 0:t.videoTrack)&&this.sideMediaConfig.isSEIStart){this.videoInfo.bitRate||(this.videoInfo.bitRate=50);var l=this.addCanvasStreamVideoTrack(),d=this.peerConnection.addTrack(l,this.localStream);d&&"video"==l.kind&&this.createVideoSenderTransform(d)}(null===(r=this.previewer)||void 0===r?void 0:r.videoTrack)&&(s=[null===(n=this.previewer)||void 0===n?void 0:n.videoTrack]),a=this.localStream.getAudioTracks(),s.length>0&&this.logger.info(o+" "+this.streamId+" video device: "+s[0].label),a.length>0&&this.logger.info(o+" "+this.streamId+" audio device: "+a[0].label)}var h={offerToReceiveAudio:a.length>0?1:0,offerToReceiveVideo:s.length>0?1:0};this.logger.info(o+" "+this.streamId+" createOffer: "+JSON.stringify(h)),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.dataReport.eventStart(this.streamReportSeq,"CreateOffer"),this.peerConnection.createOffer(h).then((function(e){i.dataReport.eventEnd(i.reportSeq,"CreateOffer"),i.dataReport.eventEnd(i.streamReportSeq,"CreateOffer"),i.onCreateOfferSuccess(e)}),(function(e){i.dataReport.eventEndWithMsg(i.reportSeq,"CreateOffer",{error:e.toString()}),i.dataReport.eventEndWithMsg(i.streamReportSeq,"CreateOffer",{error:e.toString()}),i.logger.error(o+" "+i.streamId+" create offer error "+e.toString()),i.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCreateOfferError,!0)}))},e.prototype.sendSEI=function(e){var t,r;if("H264"!==this.videoCodec)return this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" code not support"),!1;if(!this.sideMediaConfig.isSEIStart)return this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" not enable to send sei"),!1;var n=null===(t=this.peerConnection)||void 0===t?void 0:t.getSenders().filter((function(e){return e.track&&"video"===e.track.kind}));return n&&"function"!=typeof(null===(r=n[0])||void 0===r?void 0:r.createEncodedStreams)?(this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" browser not support"),!1):this.sideMediaConfig.SEIType==i.ZegoSEIType.UserUnregister&&e.byteLength<=16?(this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" inData size should greater than 16"),!1):this.mediaSideInfos.length>=10?(this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" side info count limit"),!1):(this.mediaSideInfos.push(e.buffer),this.lowStream&&this.lowMediaSideInfos.push(e.buffer),!0)},e.prototype.createAudioSenderTransform=function(e){var t=e.createEncodedStreams(),r=new TransformStream({transform:this.encodeAudioFrame});t.readable.pipeThrough(r).pipeTo(t.writable)},e.prototype.encodeAudioFrame=function(e,t){t.enqueue(e)},e.prototype.createVideoSenderTransform=function(e,t){void 0===t&&(t=!1);var r=e.createEncodedStreams(),n=new TransformStream({transform:t?this.encodeLowVideoFrame:this.encodeVideoFrame});r.readable.pipeThrough(n).pipeTo(r.writable)},e.prototype.encodeSEINalu=function(e){var t=e.byteLength,r=parseInt(t/255),n=t%255,o=1+(r+1)+t+1,s=new ArrayBuffer(o),a=new DataView(s),c=0;a.setUint8(c++,this.sideMediaConfig.SEIType===i.ZegoSEIType.UserUnregister?5:243);for(var u=0;u<r;u++)a.setUint8(c++,255);a.setUint8(c++,n);var l=new DataView(e);for(u=0;u<(null==e?void 0:e.byteLength);u++)a.setInt8(c++,l.getInt8(u));a.setInt8(c++,128);var d=[];return{rbspView:a,ebspLength:o+d.length,ebspPreventProcessPos:d.map((function(e,t){return e+t}))}},e.prototype.encodeFrame=function(e,t,r){var n=r?this.lowMediaSideInfos:this.mediaSideInfos;if(n.length>0){for(var i=new DataView(e.data),o=[],s=0,a=0;a<n.length;a++){var c=this.encodeSEINalu(n[a]);s+=5+(S=c.ebspLength),o.push(c)}r?this.lowMediaSideInfos=[]:this.mediaSideInfos=[];for(var u=new ArrayBuffer(s+e.data.byteLength),d=new DataView(u),h=0,p=new l.H264Parser(i),f=0,g=!1,m=!1;p.NextNalu();){var _=31&i.getUint8(p.nalu_start+p.start_code_size);if(7==_)g=!0,f+=p.nalu_size;else if(8==_)m=!0,f+=p.nalu_size;else if(9==_)continue;if(g&&m)break}for(var v=0;v<f;v++)d.setInt8(h++,i.getInt8(v));for(a=0;a<o.length;a++){var y=o[a],E=y.rbspView,S=y.ebspLength,b=y.ebspPreventProcessPos;d.setUint8(h++,0),d.setUint8(h++,0),d.setUint8(h++,0),d.setUint8(h++,1),d.setUint8(h++,6);for(var T=0,C=0;C<S;C++)b.indexOf(C)>-1?(d.setInt8(h++,3),T++):d.setInt8(h++,E.getInt8(C-T))}for(v=f;v<e.data.byteLength;v++)d.setInt8(h++,i.getInt8(v));e.data=u}t.enqueue(e)},e.prototype.onCreateOfferSuccess=function(e,t,r,n){var i,s=this;t&&(this.isUpdateSDP=!0,n&&(this.updateSDPCallBack=n)),this.videoInfo.bitRate>0&&(e.sdp=this.updateBandwidthRestriction(e.sdp,this.videoInfo.bitRate)),e.sdp=e.sdp.replace(/sendrecv/g,"sendonly");var a=e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)?e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)[0]:null;if(a){var l=a.replace(/sendonly/,"sendrecv");e.sdp=e.sdp.replace(a,l)}e.sdp=e.sdp.replace(/useinbandfec=\d+/,(this.videoInfo.audioBitrate?"maxaveragebitrate="+this.videoInfo.audioBitrate:"")+(2===this.videoInfo.channelCount?";stereo=1":"")),this.localSdpOrder=e.sdp.match(/m=(.\w*)\s/g)||[],this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" local sdp revert "+this.localSdpOrder.join("")),e.sdp=o.SdpUtil.getSDPByVideDecodeType(e.sdp,this.videoCodec),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp1 "+e.sdp.substr(0,e.sdp.length/2)),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp2 "+e.sdp.substr(e.sdp.length/2)),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetLocalDescription"),null===(i=this.peerConnection)||void 0===i||i.setLocalDescription(e).then((function(){s.dataReport.eventEnd(s.reportSeq,"SetLocalDescription"),s.dataReport.eventEnd(s.streamReportSeq,"SetLocalDescription"),s.onSetLocalDescriptionSuccess(e,r)}),(function(e){s.dataReport.eventEndWithMsg(s.reportSeq,"SetLocalDescription",{error:e.toString()}),s.dataReport.eventEndWithMsg(s.streamReportSeq,"SetLocalDescription",{error:e.toString()}),s.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+s.streamId+" error "+e.toString()),s.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSetLocalDescError,!0)}))},e.prototype.updateBandwidthRestriction=function(e,t){var r="AS";return"firefox"===this.stateCenter.browser&&(t=1e3*(t>>>0),r="TIAS"),-1===e.indexOf("b="+r+":")?e.replace(/(m=video.*\r\nc=IN.*\r\n)/g,"$1b="+r+":"+t+"\r\n"):(e=e.replace(new RegExp("b="+r+":.*\r\n","g"),"b="+r+":"+t+"\r\n")).replace("b="+r+":"+t+"\r\n","")},e.prototype.onSetLocalDescriptionSuccess=function(e,t){var r,s,a,l=this;this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" success"),!this.isUpdateSDP&&(this.state=i.ENUM_PUBLISH_STATE.waitingOfferRsp),t&&(this.videoInfo=n(n({},this.videoInfo),t));var d=!1,h=null===(r=this.previewer)||void 0===r?void 0:r.previewType,p=this.stateCenter.settingConfig;"camera"===h?d=p.getSetting("camera_hard_encode"):"screen"===h?d=p.getSetting("hardware_encode"):"custom"===h&&(d=p.getSetting("custom_hard_encode"));var f=!d;this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" ".concat(null===(s=this.previewer)||void 0===s?void 0:s.previewType," software encode: ").concat(f,", "));var g=o.SdpUtil.getSDPByVideDecodeType(e.sdp,this.videoCodec,f),m={sdp:g,width:this.videoInfo.width,height:this.videoInfo.height,frameRate:this.videoInfo.frameRate,video_min_kpbs:this.videoInfo.bitRate,video_max_kpbs:this.videoInfo.bitRate,audio_kpbs:48,keyframe_intv:Math.floor((null===(a=this.videoInfo)||void 0===a?void 0:a.keyFrameInterval)||2)};if(this.offerSeq=(0,i.getSeq)(),this.isUpdateSDP){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" update sdp");var _=n(n({},m),{seq:this.sessionSeq,peerID:this.peerID,type:0});return this.dataReport.eventStart(this.reportSeq,"SendMediaDescUpdate"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDescUpdate"),void this.signal.sendMediaDescUpdateReq(this.offerSeq,this.sessionId,_,(function(e,t,r){}),(function(e,t){l.dataReport.eventEndWithMsg(l.reportSeq,"SendMediaDescUpdate",{error:e}),l.dataReport.eventEndWithMsg(l.streamReportSeq,"SendMediaDescUpdate",{error:e}),l.updateSDPCallBack&&l.updateSDPCallBack(-1),l.publishStateUpdateError(e==i.SEND_MSG_TIMEOUT?c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kUpdateMediaDescriptionTimeOut:c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kUpdateMediaDescriptionError)}))}this.isPeer?this.createSession(e,g):(this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.offerSeq,this.sessionId,0,m,(function(e,t,r){l.offerSeq==e&&l.sessionId==t?(l.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+l.streamId+" send success"),l.dataReport.eventEndWithMsg(l.reportSeq,"SendMediaDesc",{mediaDescription:{width:m.width,height:m.height,frameRate:m.frameRate,video_min_kpbs:m.video_min_kpbs,video_max_kpbs:m.video_max_kpbs,audio_kpbs:m.audio_kpbs,keyframe_intv:m.keyframe_intv}}),l.dataReport.eventEndWithMsg(l.streamReportSeq,"SendMediaDesc",{mediaDescription:{width:m.width,height:m.height,frameRate:m.frameRate,video_min_kpbs:m.video_min_kpbs,video_max_kpbs:m.video_max_kpbs,audio_kpbs:m.audio_kpbs,keyframe_intv:m.keyframe_intv}}),l.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+l.streamId+" send success stateNego:waiterAnswer"),l.stateNego=i.ENUM_PUBLISH_STATE_NEGO.waiterAnswer,l.state=i.ENUM_PUBLISH_STATE.waitingServerAnswer):l.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+l.streamId+" seq or sessionId is not equal")}),(function(e,t){l.dataReport.eventEndWithMsg(l.reportSeq,"SendMediaDesc",{error:e}),l.dataReport.eventEndWithMsg(l.streamReportSeq,"SendMediaDesc",{error:e}),l.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)})),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" call success"))},e.prototype.onRecvUpdateMediaDescription=function(e,t,r){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC+" "+this.streamId+" received"),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.dataReport.addEvent(this.reportSeq,"RecvUpdateMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvUpdateMediaDesc"),this.signal.sendUpdateMediaDescAck(e,this.sessionId,0,this.peerID),1==r.type?this.onGetRemoteOfferSuccess(r.sdp):this.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)},e.prototype.onRecvMediaDescription=function(e,t,r){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received"),this.state==i.ENUM_PUBLISH_STATE.waitingServerAnswer?(this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.waitingCandidate,this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0),1==r.type?this.onGetRemoteOfferSuccess(r.sdp):this.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)):this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onGetRemoteOfferSuccess=function(e){var t,r,n,o=this;this.videoInfo.audioBitrate&&48e3!==this.videoInfo.audioBitrate&&(e=e.replace(/maxaveragebitrate=(\d+)/,"maxaveragebitrate="+this.videoInfo.audioBitrate)),this.remoteSdpOrder=e.match(/m=(.\w*)\s/g)||[],this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+NaN+this.remoteSdpOrder.join("")),this._turnToTcp=this.stateCenter.turnOverTcpOnly,this.streamCenter.autoSwitchProtocol=this.stateCenter.settingConfig.getSetting("auto_to_tcp")||!1;var s=this.stateCenter.settingConfig.getSetting("udp_max_fail_num");!isNaN(s)&&(this.streamCenter.maxUdpFailNum=s);var a=this.streamCenter,l=a.autoSwitchProtocol,d=a.maxUdpFailNum,h=a.udpFailNum;this.logger.info("zp.oro.0  autoToTcp: ".concat(l,", udpFailNum: ").concat(h,", maxUdpFailNum: ").concat(d,".")),l&&!this._turnToTcp&&h>=d&&(this.logger.info("zp.oro.0 switch to tcp."),this._turnToTcp=!0);var p=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);if(p&&(this.logger.info("zp.oro.0 setting udp_or_tcp "+p),this._turnToTcp="tcp"===p),this._turnToTcp&&(null===(t=e.match(/candidate.*/g))||void 0===t||t.forEach((function(t){var r=t.replace(/udp/,"tcp");r.includes(" tcptype ")||(r=r.replace(" typ host "," typ host tcptype passive ")),e=e.replace(t,r)}))),this.logger.info("zp.oro.0 "+this.streamId+" sdp revert "+this.localSdpOrder.join("")+" "+this.remoteSdpOrder.join("")),this.localSdpOrder.join()!==this.remoteSdpOrder.join()&&this.localSdpOrder.length==this.remoteSdpOrder.length){var f=new RegExp("[\\s\\S]*"+this.remoteSdpOrder[0]).exec(e)[0].replace(this.remoteSdpOrder[0],""),g=[],m="";this.localSdpOrder.forEach((function(t){var r=o.remoteSdpOrder.findIndex((function(e){return e==t})),n=new RegExp(t+"[\\s\\S]*"+(o.remoteSdpOrder[r+1]||"")).exec(e)[0].replace(o.remoteSdpOrder[r+1],""),i=/a=mid:(\w)/.exec(n)[1];g.push(i),m+=n||""})),e=f.replace(/a=group:BUNDLE.*/,"a=group:BUNDLE "+g.join(" "))+m,this.localSdpOrder=[],this.remoteSdpOrder=[]}var _=e.match(/m=video(.|\r|\n)*a=rtpmap(.|\r|\n)*(a=fmtp:(\d+).*)/);if("chrome"==this.stateCenter.browser){var v=0,y=0;if(this.videoInfo.bitRate&&"target"===this.videoInfo.startBitrate&&(v=this.videoInfo.bitRate),this.videoInfo.minBitrate)y=this.videoInfo.minBitrate;else if("screen"===this.previewer.previewType){var E=function(e){var t=0,r=e.frameRate,n=e.width*e.height*(r<=30?r:30);return"number"==typeof n?(t=n<=3888e3?200:n<=6912e3?400:n<=15552e3?700:n<=27648e3?1e3:2e3)>e.bitRate&&(t=e.bitRate):t=parseInt(.6*e.bitRate+""),{minBitrate:t,resolution:n}}(this.videoInfo);y=E.minBitrate,this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+" resolution: ".concat(E.resolution,", min bitrate: ").concat(y))}var S=[];if(y&&S.push("x-google-min-bitrate=".concat(y)),v&&S.push("x-google-start-bitrate=".concat(v)),null!==_&&S.length){var b,T=_[3];b=-1!==T.indexOf("apt=")?"a=fmtp:96 "+S.join(";")+"\n"+T:"".concat(T,";").concat(S.join(";")),e=e.replace(T,b)}}if(this.videoInfo.bitRate>0){var C=/b=AS.*(\r\n|\n)/.test(e);e=C?e.replace(/AS:(\d+)/,"AS:"+this.videoInfo.bitRate):e.replace(/m=video.*(\r\n|\n)c=.*(\r\n|\n)/,"$&b=AS:".concat(this.videoInfo.bitRate,"\n"));var R=null===(r=this.peerConnection)||void 0===r?void 0:r.getSenders().filter((function(e){return e.track&&"video"===e.track.kind}));null==R||R.forEach((function(e){var t,r,n,i,s,a;if(e&&e.getParameters&&e.setParameters){var c=e.getParameters();if(c.encodings&&0!=c.encodings.length||(c.encodings=[{}]),(null===(t=e.track)||void 0===t?void 0:t.id)==(null===(r=o.lowStream)||void 0===r?void 0:r.getVideoTracks()[0].id)){var u=null===(n=o.previewer)||void 0===n?void 0:n.lowStreamConfig.bitRate;u&&(c.encodings[0].maxBitrate=1e3*u)}else{c.encodings[0].maxBitrate=1e3*o.videoInfo.bitRate;var l=o.lastPublishStats.frameWidth,d=(null===(s=null===(i=o.previewer)||void 0===i?void 0:i.cameraMaxResolution)||void 0===s?void 0:s.maxWidth)||0,h=null===(a=o.previewer.videoTrack)||void 0===a?void 0:a.getSettings().width,p=l?Math.min(d,l):d;if(d&&h){var f=Math.max(p/h,1);c.encodings[0].scaleResolutionDownBy=f}}e.setParameters(c)}}))}this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+" remoteSdp:",e);var O={type:"answer",sdp:e,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetRemoteDescription"),null===(n=this.peerConnection)||void 0===n||n.setRemoteDescription(new RTCSessionDescription(O)).then((function(){o.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+o.streamId+" set success"),o.dataReport.eventEnd(o.reportSeq,"SetRemoteDescription"),o.dataReport.eventEnd(o.streamReportSeq,"SetRemoteDescription"),o.stateNego==i.ENUM_PUBLISH_STATE_NEGO.iceConnected&&o.updateSDPCallBack&&(o.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+o.streamId+" update sdp success"),o.updateSDPCallBack(0),o.updateSDPCallBack=void 0,o.isUpdateSDP=!1)}),(function(e){o.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+o.streamId+" failed: "+e.toString()),o.dataReport.eventEndWithMsg(o.reportSeq,"SetRemoteDescription",{error:e.toString()}),o.dataReport.eventEndWithMsg(o.streamReportSeq,"SetRemoteDescription",{error:e.toString()}),o.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSetRemoteDescError,!0)})),this.state=i.ENUM_PUBLISH_STATE.waitingServerICE,this.logger.debug(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+" call success")},e.prototype.onIceConnectionStateChange=function(e){var t=this;if(this.state!=i.ENUM_PUBLISH_STATE.stop&&null!=this.peerConnection)if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState){if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" connected state "+this.state),this.dataReport.eventEnd(this.reportSeq,"IceConnected"),this.dataReport.eventEnd(this.streamReportSeq,"IceConnected"),this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.iceConnected,this.answerSdpTime){var r=(new Date).getTime()-this.answerSdpTime;this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" ice time "+r)}this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateNego:iceConnected"),this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.publishEvent?this.publishSuccess():(this.firstGetStatsTimer&&clearTimeout(this.firstGetStatsTimer),this.firstGetStatsTimer=null,this.firstGetStatsTimer=setTimeout((function(){var e;t.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" get first stats state "+t.state),t.state!==i.ENUM_PUBLISH_STATE.publishing&&(null===(e=t.peerConnection)||void 0===e||e.getStats().then((function(e){t.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" get first stats suc"),e.size>0&&t.publishSuccess()})))}),1e3))}else"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.iceClosed,this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.iceFailed,this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)):"disconnected"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceDisconnected"),this.logger.warn(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" ice disconnected "),this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.iceDisconnected,this.iceDisconnectedTimer||(this.iceDisconnectedTimer=setTimeout((function(){t.checkPublishConnectionFailedState("disconnected")}),this.iceDisconnectedMaxTime)))},e.prototype.onIceCandidate=function(e){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate"+e.candidate),e.candidate&&(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate"+e.candidate.candidate),this.state<i.ENUM_PUBLISH_STATE.connecting||this.state==i.ENUM_PUBLISH_STATE.stop?this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex}):this.sendCandidateInfo([{candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex}]))},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" called"),!(e=e.filter((function(e){return e.candidate.indexOf("relay")>0})))||e.length<1?this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.dataReport.eventStart(this.streamReportSeq,"SendIceCandidate"),this.stateNego!==i.ENUM_PUBLISH_STATE_NEGO.iceConnected&&(this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.sendCandidate),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" stateNego:sendCandidate"),this.signal.sendCandidateInfo((0,i.getSeq)(),this.sessionId,e,(function(e,r,n){t.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+t.streamId+" send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate"),t.dataReport.eventEnd(t.streamReportSeq,"SendIceCandidate")}),(function(e,r){t.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+t.streamId+" failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendIceCandidate",{error:e}),t.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCandidateError)})))},e.prototype.onConnectionStateChange=function(e){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CONNECTION_STATE_CHANGE+" "+this.streamId+" called "+e.target.signalingState),this.state!=i.ENUM_PUBLISH_STATE.stop&&null!=this.peerConnection&&"closed"===e.target.signalingState&&(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=i.ENUM_PUBLISH_STATE_NEGO.iceClosed,this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState))},e.prototype.onRecvCandidateInfo=function(e,t,r){var n,o=this;if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" received "+JSON.stringify(r.infos)),this.state==i.ENUM_PUBLISH_STATE.waitingServerICE){this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.dataReport.addEvent(this.streamReportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[];for(var s=0;s<r.infos.length;s++){var a={sdpMid:r.infos[s].sdpMid,sdpMLineIndex:r.infos[s].sdpMLineIndex,candidate:r.infos[s].candidate};this.logger.debug(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+""+this.streamId+" candidate "+a.candidate),null===(n=this.peerConnection)||void 0===n||n.addIceCandidate(new RTCIceCandidate(a)).then((function(){o.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+o.streamId+" add success")}),(function(e){o.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+o.streamId+" add error "+e.toString()),o.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCandidateError,!0)}))}this.state=i.ENUM_PUBLISH_STATE.connecting,this.dataReport.eventStart(this.reportSeq,"IceConnected"),this.dataReport.eventStart(this.streamReportSeq,"IceConnected")}else this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onRecvCloseSession=function(e,t,r){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CLOSE_SESSION+" "+this.streamId+" "+JSON.stringify(r)),this.dataReport.addEvent(this.reportSeq,"RecvCloseSession"),this.signal.sendCloseSessionAck(e,this.sessionId,0);var n=r.err_info?JSON.parse(r.err_info.toLowerCase()):{},i=n.action?n.action:null,o=1*r.reason,s=JSON.parse(JSON.stringify(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError));s.message+=" reason:".concat(o," ").concat(i?" action:"+i:""," ").concat((null==n?void 0:n.err)?" err:"+(null==n?void 0:n.err):""),1011===n.err&&(s=c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaServerForbidError),1014===n.err&&(s=c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishTokenExpiredError),this.negoTimer&&clearTimeout(this.negoTimer);var a=!([4,8,10,11,12,14,18,24,26,27,28].includes(o)||[2,3,4,5,6].includes(i)),l=!1;if(!this._turnToTcp)if([8,10].includes(o)||[18,15].includes(o)&&2===i&&[3001,3002].includes(n.err)){this.streamCenter.udpFailNum++;var d=this.streamCenter;d.autoSwitchProtocol&&d.udpFailNum>=d.maxUdpFailNum&&(this.isPeer=!1,this.streamCenter.setIsPeer(!1),l=!0)}else this._turnToTcp||(this.streamCenter.udpFailNum=0);this.publishStateUpdateError(s,a,n,l)},e.prototype.onRecvResetSession=function(e,t,r){if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_RESET_SESSION+" "+this.streamId+" received "),t==this.sessionId){this.signal.sendCloseSessionAck(e,this.sessionId,0);var n=c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError;this.negoTimer&&clearTimeout(this.negoTimer),this.publishStateUpdateError(n)}else this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_RESET_SESSION+" "+this.streamId+" cannot find session")},e.prototype.onRecvPublishEvent=function(e,t,r){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_PUBLISH_EVENT+" "+this.streamId+" received"),this.publishEvent=!0,this.firstGetStatsTimer&&(clearTimeout(this.firstGetStatsTimer),this.firstGetStatsTimer=null),this.stateNego===i.ENUM_PUBLISH_STATE_NEGO.iceConnected&&0==r.event&&this.publishSuccess()},e.prototype.onRecvClientInfo=function(e,t,r){this.stateCenter.clientIP!==r.clientip&&this.logger.warn(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CLIENT_INFO+" client ip changed "+this.stateCenter.clientIP+" "+r.clientip),this.stateCenter.clientIP=r.clientip,this.peerID=r.peer_id,this.streamConnectIP=r.clientip,this.stateCenter.isMultiOuter=this.isMultiOuter(),this.sideMediaConfig.isSEIStart&&this.sideMediaConfig.SEIType==i.ZegoSEIType.UserUnregister&&this.sendSEIUUID();var n=this.previewer;if(n&&null!==n.activateSEIConfig){var o=null==n?void 0:n.activateSEIConfig;this.activateSEIInsert(o.action,o.infoType)}},e.prototype.sendSEIUUID=function(){var e=this;this.signal.gw.mediaStreamSEIUUIDReq((0,i.getSeq)(),this.sessionId,this.peerID,this.sideMediaConfig.unregisterSeiFilter).then((function(t){var r;0==(null===(r=null==t?void 0:t.usr_sei_filter)||void 0===r?void 0:r.result)&&(e.sideMediaConfig.uuidSend=!0)})).catch((function(e){console.error()}))},e.prototype.checkPublishConnectionFailedState=function(e){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" streamID "+this.streamId," state "+this.state+" connectionState "+e),this.publishStateUpdateError(c.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaConnectionError)},e.prototype.setPublishQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_PLAYER_QUALITY_TIMER+" "+this.streamId+" called"),this.clearPublishQualityTimer(),this.qualityTimer=setInterval((function(){e.peerConnectionGetStats()}),this.qualityTimeInterval),this.lastPublishStats={audioPacketsLost:0,videoPacketsLost:0,videoPacketsSent:0,audioPacketsSent:0,audioRetransmittedPacketsSent:0,videoTime:(new Date).getTime(),audioTime:(new Date).getTime(),time:0,audioBytesSent:0,videoBytesSent:0,framesEncoded:0,framesSent:0,videoRetransmittedPacketsSent:0},this.qualitySeq=(0,i.getSeq)(),this.qualityCount=0)},e.prototype.peerConnectionGetStats=function(e){var t=this;if(this.peerConnection){var r=[this.peerConnection.getStats(null)];"chrome"==this.stateCenter.browser&&r.push(new Promise((function(e,r){var n;null===(n=t.peerConnection)||void 0===n||n.getStats((function(t){return e(t)}),(function(e){return r(e)}))}))),Promise.all(r).then((function(r){var n=t.getPublishStats(r[0],r[1]);e&&e(n,r[0],r[1])})).catch((function(e){t.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_PLAYER_QUALITY_TIMER+" "+t.streamId+" getStats error "+e.toString())}))}},e.prototype.getPublishStats=function(e,t){var r,n,o=this;if(e){for(var s,l=document.querySelectorAll("video, audio"),d=0;d<l.length;d++)l[d].srcObject===this.localStream&&(s=l[d]);var h=this.streamCenter.checkPreview(this.localStream),p={sampleTimeWindow:this.qualityTimeInterval,audioCodec:"opus",audioTargetBitrate:this.videoInfo.audioBitrate/1e3||0,audioBitrate:0,videoTargetBitrate:this.videoInfo.bitRate||0,videoTargetFPS:this.videoInfo.frameRate||0,videoBitrate:0,audioFPS:0,audioLevel:0,audioInputLevel:0,audioPacketsLost:0,audioPacketsLostRate:0,sendLevel:0,samplingRate:0,videoFPS:0,nackCount:0,pliCount:0,audioQuality:0,videoQuality:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoPacketsLost:0,videoPacketsLostRate:0,totalRoundTripTime:0,currentRoundTripTime:0,googBandwidthLimitedResolution:void 0,videoCodecName:"",audioCodecName:"",googCpuLimitedResolution:void 0,googAvailableSendBandwidth:0,googActualEncBitrate:0,googTargetEncBitrate:0,googFrameWidthInput:0,googFrameHeightInput:0,googFrameRateInput:0,qualityLimitationReason:"",codecImplementationName:"",videoMuteState:(null===(r=null==h?void 0:h.videoTrack)||void 0===r?void 0:r.enabled)?"0":"1",audioMuteState:this.localStream.getAudioTracks().length>0&&this.localStream.getAudioTracks()[0].enabled?"0":"1",muted:s?s.muted:void 0,paused:s?s.paused:void 0,volume:s?s.volume:void 0,sinkId:s?s.sinkId:void 0},f=this.lastPublishStats.time,g=0,m=0,_=0,v=0,y=0,E=0;e.forEach((function(e){if(("outbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesSent)&&"audio"==e.mediaType)0!=f&&(p.audioBitrate=8*(e.bytesSent-o.lastPublishStats.audioBytesSent)/(e.timestamp-f),e.retransmittedPacketsSent=e.retransmittedPacketsSent||0,e.packetsSent=e.packetsSent||0,p.audioFPS=(e.packetsSent-(e.retransmittedPacketsSent-o.lastPublishStats.audioRetransmittedPacketsSent)-o.lastPublishStats.audioPacketsSent)/(e.timestamp-f)*1e3||0,_=(e.retransmittedPacketsSent-o.lastPublishStats.audioRetransmittedPacketsSent)/(e.packetsSent-o.lastPublishStats.audioPacketsSent)),p.audioBitrate<0&&(p.audioBitrate=0),o.lastPublishStats.audioBytesSent=e.bytesSent,o.lastPublishStats.time=e.timestamp,o.lastPublishStats.audioPacketsSentTimeStamp=e.packetsSent-o.lastPublishStats.audioPacketsSent,o.lastPublishStats.audioPacketsSent=e.packetsSent,o.lastPublishStats.audioRetransmittedPacketsSent=e.retransmittedPacketsSent;else if(("outbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesSent)&&"video"==e.mediaType)p.isHardwareEncode=function(e){if(e){var t=null==e?void 0:e.toLocaleLowerCase();if("unknown"!==t)return"openh264"!==t&&"libvpx"!==t}}(e.encoderImplementation),0!=f&&(p.videoBitrate=8*(e.bytesSent-o.lastPublishStats.videoBytesSent)/(e.timestamp-f),p.videoFPS=1e3*(e.framesEncoded-o.lastPublishStats.framesEncoded)/(e.timestamp-f),v=(e.retransmittedPacketsSent-o.lastPublishStats.videoRetransmittedPacketsSent)/(e.packetsSent-o.lastPublishStats.videoPacketsSent)),p.videoBitrate<0&&(p.videoBitrate=0),p.videoFPS<0&&(p.videoFPS=0),p.nackCount=e.nackCount,p.pliCount=e.pliCount,p.qualityLimitationReason=e.qualityLimitationReason,o.lastPublishStats.videoBytesSent=e.bytesSent,o.lastPublishStats.framesEncoded=e.framesEncoded,o.lastPublishStats.time=e.timestamp,o.lastPublishStats.videoPacketsSentTimeStamp=e.packetsSent-o.lastPublishStats.videoPacketsSent,o.lastPublishStats.videoPacketsSent=e.packetsSent,o.lastPublishStats.videoRetransmittedPacketsSent=e.retransmittedPacketsSent;else if("remote-inbound-rtp"==e.type&&"video"==e.kind){e.packetsLost>0&&(p.videoPacketsLost=e.packetsLost);var t=e.packetsLost-o.lastPublishStats.videoPacketsLost;p.videoPacketsLostRate=t>0?t/o.lastPublishStats.videoPacketsSentTimeStamp:0,e.packetsLost>0&&(o.lastPublishStats.videoPacketsLost=e.packetsLost),o.lastPublishStats.videoTime=e.timestamp,m=1e3*e.roundTripTime,E=e.jitter}else if("remote-inbound-rtp"==e.type&&"audio"==e.kind){e.packetsLost>0&&(p.audioPacketsLost=e.packetsLost);var r=e.packetsLost-o.lastPublishStats.audioPacketsLost;p.audioPacketsLostRate=r>0?r/o.lastPublishStats.audioPacketsSentTimeStamp:0,e.packetsLost>0&&(o.lastPublishStats.audioPacketsLost=e.packetsLost),o.lastPublishStats.audioTime=e.timestamp,g=1e3*e.roundTripTime,y=e.jitter}else if("media-source"==e.type&&("audio"==e.kind||e.id.toLowerCase().indexOf("audio")>=0))p.audioLevel=e.audioLevel||0,p.sendLevel=e.totalAudioEnergy,p.audioInputLevel=32767*e.totalAudioEnergy,p.samplingRate=e.totalSamplesDuration;else if("track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0||e.frameWidth)){if(p.frameHeight=e.frameHeight,p.frameWidth=e.frameWidth,0===f||o.lastPublishStats.frameHeight===e.frameHeight&&o.lastPublishStats.frameWidth===e.frameWidth)0===f&&(o.lastPublishStats.frameHeight=e.frameHeight,o.lastPublishStats.frameWidth=e.frameWidth);else{var n=(0,i.getReportSeq)();o.dataReport.newReport(n,c.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.event),o.dataReport.addMsgInfo(n,{session_id:c.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.session_id(o.sessionId),w:c.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.w(e.frameWidth),h:c.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.h(e.frameHeight)}),o.dataReport.uploadReport(n),o.lastPublishStats.frameHeight=e.frameHeight,o.lastPublishStats.frameWidth=e.frameWidth}0!=f&&(p.videoTransferFPS=1e3*(e.framesSent-o.lastPublishStats.framesSent)/(e.timestamp-f)),p.videoTransferFPS<0&&(p.videoTransferFPS=0),o.lastPublishStats.framesSent=e.framesSent}else"candidate-pair"==e.type&&(null!=e.totalRoundTripTime&&(p.totalRoundTripTime=e.totalRoundTripTime),null!=e.currentRoundTripTime&&(p.currentRoundTripTime=e.currentRoundTripTime))})),t&&t.result().forEach((function(e){"ssrc"==e.type&&e.names().indexOf("googBandwidthLimitedResolution")>=0&&(p.googBandwidthLimitedResolution=e.stat("googBandwidthLimitedResolution")),"ssrc"==e.type&&"video"==e.stat("mediaType")&&e.names().indexOf("googCodecName")>=0&&(p.videoCodecName=e.stat("googCodecName")),"ssrc"==e.type&&"audio"==e.stat("mediaType")&&e.names().indexOf("googCodecName")>=0&&(p.audioCodecName=e.stat("googCodecName")),"ssrc"==e.type&&e.names().indexOf("googCpuLimitedResolution")>=0&&(p.googCpuLimitedResolution=e.stat("googCpuLimitedResolution")),"ssrc"==e.type&&e.names().indexOf("googFrameWidthInput")>=0&&(p.googFrameWidthInput=e.stat("googFrameWidthInput")),"ssrc"==e.type&&e.names().indexOf("googFrameHeightInput")>=0&&(p.googFrameHeightInput=e.stat("googFrameHeightInput")),"ssrc"==e.type&&e.names().indexOf("googFrameRateInput")>=0&&(p.googFrameRateInput=e.stat("googFrameRateInput")),"ssrc"==e.type&&e.names().indexOf("codecImplementationName")>=0&&(p.codecImplementationName=e.stat("codecImplementationName")),"VideoBwe"==e.type&&e.names().indexOf("googAvailableSendBandwidth")>=0&&(p.googAvailableSendBandwidth=e.stat("googAvailableSendBandwidth")),"VideoBwe"==e.type&&e.names().indexOf("googActualEncBitrate")>=0&&(p.googActualEncBitrate=e.stat("googActualEncBitrate")),"VideoBwe"==e.type&&e.names().indexOf("googTargetEncBitrate")>=0&&(p.googTargetEncBitrate=e.stat("googTargetEncBitrate")),"VideoBwe"==e.type&&e.names().indexOf("googRetransmitBitrate")>=0&&(p.googRetransmitBitrate=e.stat("googRetransmitBitrate"))})),"chrome"===this.stateCenter.browser&&this.handleEncBitrate(Number.parseInt(p.googTargetEncBitrate),Number.parseInt(p.googActualEncBitrate),Number.parseInt(p.googRetransmitBitrate)),m=isNaN(m)||m<0?0:m,v=isNaN(v)||v<0?0:v,E=isNaN(E)||E<0?0:E,g=isNaN(g)||g<0?0:g,_=isNaN(_)||_<0?0:_,y=isNaN(y)||y<0?0:y;var S=a.ClientUtil.getNetQuality(m,v,E),b=a.ClientUtil.getNetQuality(g,_,y);if(p.videoQuality=f>0?a.ClientUtil.quality2QualityGrade(S):0,p.audioQuality=f>0?a.ClientUtil.quality2QualityGrade(b):0,this.stateCenter.networkState!==i.ENUM_NETWORK_STATE.offline&&"disconnected"!==(null===(n=this.peerConnection)||void 0===n?void 0:n.connectionState)||(p.videoQuality=i.QualityGrade.Die,p.audioQuality=i.QualityGrade.Die),!p.frameHeight||!p.frameWidth){var T=this.localStream.getVideoTracks()[0];T&&(p.frameHeight=T.getSettings().height||0,p.frameWidth=T.getSettings().width||0)}var C=Math.min(S,b);this.netQuality=C,C<=i.QUALITY_CONSTANT.MiddleMinQuality?this.poorQualityNum++:this.poorQualityNum=0,f>0&&this.poorQualityNum>=this.streamCenter.probeStartedNum&&(new Date).getTime()>this.probeTime+this.probeInterval&&(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_PLAYER_QUALITY_TIMER+" netQuality "+C+" start net probe"),this.probeState=i.ENUM_PROBE_STATE.tryProbe,this.streamCenter.startNetProbe(!0,this,this.gwNodeList),this.probeTime=(new Date).getTime()),this.updateCurrentQualityStats(p),0!==f&&(this.uploadPublishQuality(p),this.onPublishQualityUpdate(this.streamId,this.currentQuality,e,t))}},e.prototype.updateCurrentQualityStats=function(e){var t=e.videoBitrate,r=e.videoFPS,i=e.videoTransferFPS,o=e.frameHeight,s=e.frameWidth,a=e.videoMuteState,c=e.videoQuality,u=e.isHardwareEncode,l=e.audioBitrate,d=e.audioCodec,h=e.audioMuteState,p=e.audioQuality,f=e.audioFPS,g={video:n(n({},this.currentQuality.video),{videoBitrate:t,videoFPS:r,videoTransferFPS:i,frameHeight:o,frameWidth:s,muteState:a,videoQuality:c,isHardwareEncode:u}),audio:n(n({},this.currentQuality.audio),{audioBitrate:l,audioCodec:d,muteState:h,audioQuality:p,audioFPS:f}),nackCount:e.nackCount,pliCount:e.pliCount,totalRoundTripTime:e.totalRoundTripTime,currentRoundTripTime:e.currentRoundTripTime,qualityLimitationReason:e.qualityLimitationReason};if(void 0!==e.videoPacketsLost){var m=e.videoPacketsLostRate;g.video.videoPacketsLost=e.videoPacketsLost,g.video.videoPacketsLostRate=m}if(void 0!==e.audioPacketsLost){var _=e.audioPacketsLostRate;g.audio.audioPacketsLost=e.audioPacketsLost,g.audio.audioPacketsLostRate=_}if(void 0!==e.muted&&(g.muted=e.muted,g.paused=e.paused,g.volume=e.volume,g.sinkId=e.sinkId),void 0!==e.googBandwidthLimitedResolution){var v=e.videoCodecName,y=e.audioCodecName,E=e.googFrameWidthInput,S=e.googFrameHeightInput,b=e.googCpuLimitedResolution,T=e.googFrameRateInput,C=e.codecImplementationName,R=e.googAvailableSendBandwidth,O=e.googActualEncBitrate,k=e.googTargetEncBitrate;g.googBandwidthLimitedResolution=e.googBandwidthLimitedResolution,g.video.googCodecName=v,g.audio.googCodecName=y,g.googCpuLimitedResolution=b,g.googFrameWidthInput=E,g.googFrameHeightInput=S,g.googFrameRateInput=T,g.codecImplementationName=C,g.googAvailableSendBandwidth=R,g.googActualEncBitrate=O,g.googTargetEncBitrate=k}this.currentQuality=g},e.prototype.uploadPublishQuality=function(e){if(this.qualityUpload&&this.signal.isServerConnected){var t=(new Date).getTime();(0==this.qualityUploadLastTime||t-this.qualityUploadLastTime>=2e3)&&(e.stream_type="publish",e.stream_id=this.streamId,e.timeStamp=Math.round(t/1e3),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_UPLOAD_PUBLISH_QUALITY+" "+this.streamId+" upload"+JSON.stringify(e)),this.streamCenter.updateQuality(0,e),this.qualityUploadLastTime=t)}},e.prototype.stopPublish=function(){if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_PUBLISH+"  .1 "+this.streamId+" called"),Object.keys(this.streamCenter.publisherList).length=1)for(var e in this.streamCenter.playerList){var t=this.streamCenter.playerList[e].player;t.state==i.ENUM_PLAY_STATE.playing&&t.broadcasterStatus==i.ENUM_BROADCASTER_STATUS.start&&(this.signal&&this.signal.sendBroadcasterStatus((0,i.getSeq)(),t.sessionId,0),t.broadcasterStatus=i.ENUM_BROADCASTER_STATUS.stop)}this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession((0,i.getSeq)(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.streamReportSeq,"PublishState",{state:this.state+""}),this.dataReport.addEvent(this.streamReportSeq,"StopPublish"),this.dataReport.addMsgExt(this.streamReportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.dataReport.addMsgInfo(this.streamReportSeq,{itemtype:"RTCPublishStream",use_na:this.stateCenter.useNetAgent?1:0}),this.dataReport.uploadReport(this.streamReportSeq,"RTCPublishStream"),this.retryFailGwNodes=[],this.resetPublish()},e.prototype.onPublishStateUpdate=function(e,t,r,n,i,o){},e.prototype.onPublishQualityUpdate=function(e,t,r,n){},e.prototype.onDisconnect=function(e){this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_DISCONNECT+" "+this.streamId+" call"),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_DISCONNECT+" "+this.streamId+" websocket disconnect"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.publishStateUpdateError(e||c.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kWebsocketDisconnectedError,!!e)},e.prototype.publishSuccess=function(){var e,t;if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" call"),this._turnToTcp||(this.streamCenter.udpFailNum=0),this.isUpdateSDP&&this.updateSDPCallBack)return this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" "+this.streamId+" update sdp success"),this.updateSDPCallBack(0),this.updateSDPCallBack=void 0,void(this.isUpdateSDP=!1);for(var r in this.state!=i.ENUM_PUBLISH_STATE.publishing&&this.onPublishStateUpdate(i.ENUM_PUBLISH_STATE_UPDATE.start,this.streamId,{code:0,message:""},!0),this.isPeer&&(this.peerFailCount=0),this.state=i.ENUM_PUBLISH_STATE.publishing,this.dataReport.eventStart(this.reportSeq,"PublishState"),this.dataReport.eventStart(this.streamReportSeq,"PublishState"),this.streamCenter.playerList){var n=this.streamCenter.playerList[r].player;n.state==i.ENUM_PLAY_STATE.playing&&n.broadcasterStatus==i.ENUM_BROADCASTER_STATUS.stop&&(this.signal&&this.signal.sendBroadcasterStatus((0,i.getSeq)(),n.sessionId,1),n.broadcasterStatus=i.ENUM_BROADCASTER_STATUS.start)}var o=this.stateCenter.settingConfig.getSetting("probe_started_num");!isNaN(o)&&(this.streamCenter.probeStartedNum=o),this.setPublishQualityTimer();var s=2,a=2,c=null===(e=this.previewer)||void 0===e?void 0:e.videoTrack,l=0!==this.localStream.getAudioTracks().length&&this.localStream.getAudioTracks()[0];(c&&"live"===c.readyState&&!0===c.enabled||(null===(t=this.previewer)||void 0===t?void 0:t.muteImage))&&(s=0),l&&"live"===l.readyState&&!0===l.enabled&&(a=0),this.sendStreamStatus(s,a,!0),this.streamCenter.soundLevelDelegate&&this.previewer&&this.previewer.startSoundLevel(),this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" call success")},e.prototype.startSoundLevel=function(){var e;if(this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" call streamID: "+this.streamId),this.localStream&&0!=this.localStream.getAudioTracks().length)try{null===(e=this.previewer)||void 0===e||e.startSoundLevel()}catch(e){this.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" "+this.streamId+" get sound level failed "+e)}else this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" "+this.streamId+" local stream no found")},e.prototype.stopSoundLevel=function(){var e;this.logger.info(u.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_SOUND_LEVEL+" call streamID: "+this.streamId),null===(e=this.previewer)||void 0===e||e.stopSoundLevel()},e.prototype.handleEncBitrate=function(e,t,r){var n,i=this,o=1e3*this.videoInfo.bitRate,s=0;if(t>0){this.needIncMax||this.gotMax||(this.probeCount++,t>=.75*e?(this.probeCount>=10&&this.initFitCnt>=.6*this.probeCount&&(this.gotMax=!0,this.targetRate=o),this.initFitCnt++):this.probeCount>=10&&this.initFitCnt/this.probeCount<.3&&(this.needIncMax=!0));var c=a.ClientUtil.arrAvg(this.totalBitrateArray,t,10);this.needIncMax&&(c>=1.05*o?this.targetRate>o&&(this.targetRate-=c>e?c-e:c-o,this.targetRate=Math.max(this.targetRate,o),this.targetRate=Math.min(this.targetRate,2*o),s=this.targetRate):c<.8*o&&(0===this.targetRate&&(this.targetRate=e),this.targetRate=this.targetRate>=o?this.targetRate+.08*o:1.05*this.targetRate,this.targetRate=Math.min(this.targetRate,2*o),s=this.targetRate))}if(r>0&&r<o){var l=a.ClientUtil.arrAvg(this.totalRetransRateArray,r,5);this.needIncMax?l+t>1.05*o&&(this.targetRate-=l+t-o,this.targetRate=Math.max(this.targetRate,o-l),s=this.targetRate):s=this.targetRate-l}else this.targetRate<o&&(this.targetRate=o,s=this.targetRate);if(s>0){s=a.ClientUtil.arrAvg(this.totalTargetRateArray,s,5);var d=null===(n=this.peerConnection)||void 0===n?void 0:n.getSenders().filter((function(e){return e.track&&"video"===e.track.kind}));if(!d)return;var h=d.length>1?d[1]:d[0]?d[0]:null;if(!h)return;var p=h.getParameters();p.encodings||(p.encodings=[{}]),p.encodings[0].maxBitrate=s,h.setParameters(p).catch((function(e){i.logger.error(u.ZEGO_WEBRTC_ACTION.PUBLISHER_HANDLE_ENC_BITRATE+" "+e)}))}},e.prototype.resetEncBitrate=function(){this.needIncMax=!1,this.probeCount=0,this.gotMax=!1,this.initFitCnt=0,this.targetRate=0,this.totalBitrateArray=[],this.totalTargetRateArray=[],this.totalRetransRateArray=[]},e.prototype.replacePublishedTrack=function(e,t,r){return void 0===t&&(t=!1),{errorCode:-1,extendedData:"should install advanced module first"}},e.prototype.sendStreamStatus=function(e,t,r,n){var o=this;void 0===r&&(r=!1),void 0===n&&(n=0),(r||this.camera_status!==e||this.mic_status!==t)&&this.signal&&(this.camera_status=e,this.mic_status=t,n++,this.signal.sendStreamStatus((0,i.getSeq)(),this.sessionId,e,t,this.streamId,(function(){o.camera_status===e&&o.mic_status===t&&n<=1&&o.sendStreamStatus(e,t,!0,n)})))},e.prototype.addCanvasStreamVideoTrack=function(e){var t=document.createElement("canvas"),r=new Image;return r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAFFJREFUOE9jZGBgaGBgYLBnYGBwYCANHGBgYDjIyMDAcIWBgUGbNL1w1VdBBvwnUzNY26gBo2EwjNLBfjJyIiz7HADlBVB2DiEjR15lYGBYAwAypRSY53SYoAAAAABJRU5ErkJggg==",t.width=80,t.height=80,this.canvasTimer=setInterval((function(){var e;(e=t.getContext("2d"))&&e.drawImage(r,0,0,16,16)}),200),t.captureStream().getVideoTracks()[0]},e.prototype.isMultiOuter=function(){return!(!this.stateCenter.accessClientIp||!this.streamConnectIP||this.stateCenter.accessClientIp===this.streamConnectIP)},e.prototype.isCustomCdn=function(){var e,t;return void 0!==(null===(e=this.publishOption)||void 0===e?void 0:e.cdnUrl)&&""!==(null===(t=this.publishOption)||void 0===t?void 0:t.cdnUrl)},e}();t.ZegoPublish=d},569:function(e,t){"use strict";var r=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.addRRTRLine=t.addSPSDescription=void 0,t.addSPSDescription=function(e){var t,r=e,n=function(e){var t={m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"}]};function r(e,t,r){var n=function(e){return String(Number(e))===e?Number(e):e},i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;(function(e,t,r,i){if(i&&!r)t[i]=n(e[1]);else for(var o=0;o<r.length;o+=1)null!=e[o+1]&&(t[r[o]]=n(e[o+1]))})(r.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)}var n=RegExp.prototype.test.bind(/^([a-z])=(.*)/),i=[],o={},s=o;return e.split(/(\r\n|\r|\n)/).filter(n).forEach((function(e){var n=e[0],o=e.slice(2);"m"===n&&(i.push({rtp:[],fmtp:[]}),s=i[i.length-1]);for(var a=0;a<(t[n]||[]).length;a+=1){var c=t[n][a];if(c.reg&&c.reg.test(o))return r(c,s,o)}})),o.media=i,o}(e),i=[];return n.media.forEach((function(e){"video"===e.type&&e.fmtp.forEach((function(e){t="a=fmtp:"+e.payload+" "+e.config,-1===e.config.indexOf("sps-pps-idr-in-keyframe")&&-1===i.indexOf(t)&&i.push(t)}))})),i.forEach((function(e){r=r.replace(new RegExp(e,"g"),e+";sps-pps-idr-in-keyframe=1")})),r},t.addRRTRLine=function(e){var t=e.split("\r\n"),n=new Map;t.forEach((function(e,r){if(/^a=rtcp-fb:/.test(e)&&t[r+1]&&!/^a=rtcp-fb:/.test(t[r+1])){var i=e.match(/^a=rtcp-fb:\d+/);i&&n.set(r+1,i[0]+" rrtr")}}));for(var i=Array.from(n),o=0;o<i.length;o++){var s=r([],i[o],!0);t.splice(s[0]+o,0,s[1])}return t.join("\r\n")}},1111:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSoundProcessor=void 0,t.createSoundProcessor=function(e,t,r){var n=e.createScriptProcessor(4096,1,1);return t.connect(n),n.connect(e.destination),n.onaudioprocess=function(e){for(var t=e.inputBuffer.getChannelData(0),n=0,i=0;i<t.length;i++)n<t[i]&&(n=t[i]);r&&r(n)},e.resume(),n}},8011:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SoundMeterWorklet=t.WorkletModule=void 0;var o=r(1111),s=new Blob(['\nclass VolumeMeter extends AudioWorkletProcessor {\n  constructor() {\n    super();\n    this.volume = 0;\n    this.intervalTime = 1000;\n    this.tick = this.intervalTime;\n    this.isStop = false;\n    this.port.onmessage = event => {\n      const { data } = event;\n      switch (data.name) {\n        case "setIntervalTime":\n          this.intervalTime = data.intervalTime;\n          break;\n        case "stop":\n          this.isStop = true;\n          break;\n      }\n    };\n  }\n  process(inputs) {\n    const input = inputs[0];\n    if (this.isStop) {\n      return false;\n    }\n    if (input.length > 0) {\n      const buffer = input[0];\n      let maxVal = this.volume;\n      for (let i = 0; i < buffer.length; i++) {\n        if (maxVal < buffer[i]) {\n          maxVal = buffer[i];\n        }\n      }\n      this.volume = maxVal;\n      this.tick -= buffer.length;\n      if (this.tick < 0) {\n        this.tick += (this.intervalTime / 1000) * sampleRate;\n        this.port.postMessage({ volume: this.volume });\n        this.volume = 0;\n      }\n    }\n    return true;\n  }\n}\ntry {\n  registerProcessor("meter", VolumeMeter);\n} catch (error) {\n  \n}  \n'],{type:"application/javascript"}),a=function(){function e(){}return e.addModuleToContext=function(e,t){return n(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t.info("zc.smw worklet addModule call"),[4,e.audioWorklet.addModule(URL.createObjectURL(s))];case 1:return n.sent(),t.info("zc.smw worklet addModule success"),this.isSuccess=!0,[2];case 2:return r=n.sent(),t.warn("zc.smw"+" worklet addModule catch error. ".concat(null==r?void 0:r.message)),[3,3];case 3:return[2]}}))}))},e.isSuccess=!1,e}();t.WorkletModule=a;var c=function(){function e(e,t){void 0===t&&(t=1e3),this.logger=e,this.interval=t,this.worklet=null,this.processor=null,this.volume=0,this.onSoundLevelUpdate=function(e){}}return e.prototype.preload=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return a.isSuccess?[3,2]:[4,a.addModuleToContext(e,this.logger)];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.initAudioWorklet=function(e,t){return n(this,void 0,void 0,(function(){var r,n=this;return i(this,(function(i){switch(i.label){case 0:return[4,this.preload(e)];case 1:if(i.sent(),this.worklet)t.connect(this.worklet).connect(e.destination);else try{(r=this.worklet=new AudioWorkletNode(e,"meter")).port.onmessage=function(e){n.onSoundLevelUpdate&&n.onSoundLevelUpdate(e.data.volume||0)},t.connect(r).connect(e.destination),this.setInterval(this.interval)}catch(r){this.logger.warn("zc.smw not suppot AudioWorkletNode"+r),this.processor=(0,o.createSoundProcessor)(e,t,(function(e){n.onSoundLevelUpdate&&n.onSoundLevelUpdate(e||0)}))}return[2]}}))}))},e.prototype.setInterval=function(e){var t=this.worklet;this.interval=e,t&&t.port.postMessage({name:"setIntervalTime",intervalTime:e})},e.prototype.destroy=function(){this.processor&&(this.processor.onaudioprocess=null,this.processor.disconnect()),this.worklet&&(this.worklet.port.postMessage({name:"stop"}),this.worklet.port.onmessage=null,this.worklet.disconnect()),this.worklet=null,this.processor=null},e}();t.SoundMeterWorklet=c},5019:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSignal=void 0;var i=r(6706),o=r(1089),s=r(2752),a=r(1691),c=r(746),u=["LoginReq","CreateSessionWithSdpReq","CreateSessionReq"],l=function(){function e(e,t,r,n){void 0===n&&(n=!1),this.netAgent=r,this.useNetAgent=n,this.sendDataMap={},this.sendDataList=new i.LinkedList,this.sendDataCheckOnceCount=100,this.signalSeq=0,this.pushCallback={},this.sessionInfos={},this.tryHeartbeatCount=0,this.heartbeatInterval=1e4,this.sendDataTimeout=5e3,this.sendDataDropTimeout=1e4,this.sendDataCheckTimer=null,this.sendDataCheckInterval=2e3,this.loginTimer=null,this.successConnectedCallback=null,this.checkMessageList=["ActivateVideoPlayStreamReq","ActivateAudioPlayStreamReq","CreateSessionReq","CreateSessionWithSdpReq","ActivateSEIInsertReq","StreamStatusNotify","MediaDescUpdateReq"],this.tryConnectCount=1,this.tryConnectTimer=null,this.tryConnectInterval=3e3,this.state=i.ENUM_CONNECT_STATE.disconnect,this.tokenType=0,this.browser=this.getBrowserAndVersion(),this.platform=navigator.platform,this._websocket=null,this.negoInterval=25e3,this.negoTryCount=1,this.negoTryMaxCount=2,this.logger=e,this.stateCenter=t,this.stateCenter.streamConnectTime&&(this.tryConnectInterval=this.stateCenter.streamConnectTime),this.gw=new a.GatewaySignal(this)}return Object.defineProperty(e.prototype,"wsReadyState",{get:function(){var e;return null===(e=this.websocket)||void 0===e?void 0:e.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocket",{get:function(){return this._websocket},set:function(e){null===e&&this.useNetAgent||(this._websocket=e)},enumerable:!1,configurable:!0}),e.prototype.getBrowserAndVersion=function(){var e,t=navigator.userAgent,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(r[1])?{name:"IE",version:(e=/\brv[ :]+([\d\.]+)/g.exec(t)||[])[1]||""}:"Chrome"===r[1]&&null!=(e=t.match(/\bOPR|Edge\/([\d\.]+)/))?{name:"Opera",version:e[1]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/([\d+\.]+)/i))&&r.splice(1,1,e[1]),{name:r[0],version:r[1]})},e.prototype.setSessionInfo=function(e,t){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SET_SESSION_INFO+" call"),this.appid=e+"",this.userid=t},e.prototype.onDisconnect=function(e,t){},e.prototype.onUpdateHeartBeatInterval=function(e){},e.prototype.resetConnectTimer=function(){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_RESET_CONNECT_TIMER+" call"),clearTimeout(this.tryConnectTimer),this.tryConnectTimer=null,this.tryConnectCount=0},e.prototype.handleWsMessage=function(e){var t=JSON.parse(e.data);this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" signmsg= ",t.header.cmd),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" signmsg= "+JSON.stringify(t)),t.header.appid==this.appid&&t.header.user_id===this.userid?this.handleServerPush(t):this.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" check header failed")},e.prototype.bindWebSocketEvents=function(){var e=this;this.tryHeartbeatCount=0,this.tryConnectInterval=this.stateCenter.streamConnectTime?this.stateCenter.streamConnectTime:3e3,this.websocket&&(this.websocket.onclose=function(t){if(e.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" close msg = "+JSON.stringify((null==t?void 0:t.code)?null==t?void 0:t.code:t)),e.state!=i.ENUM_CONNECT_STATE.disconnect){if(e.useNetAgent)return void e.disconnectCallback();e.successConnectedCallback=e.connectCallback,e.resetConnectTimer(),e.startConnectTimer((function(t){1008===t&&e.disconnectCallback(s.errorCodeList.TOKEN_EXPIRED)})),e.resetCheckMessage()}},this.websocket.onerror=function(t){e.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" msg = "+JSON.stringify(t))})},e.prototype.resetCheckMessage=function(){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_RESET_CHECK_MESSAGE+" call"),clearTimeout(this.sendDataCheckTimer),this.sendDataCheckTimer=null;for(var e=this.sendDataList.getFirst();null!=e;)this.sendDataList.remove(e),e._data.error&&e._data.error(i.SEND_MSG_RESET,e._data.seq),e=this.sendDataList.getFirst();this.sendDataMap={}},e.prototype.handleServerPush=function(e){switch(e.header.cmd){case"LoginRsp":this.handleRespondData("LoginReq",e);break;case"CreateSessionRsp":this.handleRespondData("CreateSessionReq",e),0===e.body.result&&this.addSession(e.header.session_id,e.body.session_token);break;case"CreateSessionWithSdpRsp":this.handleRespondData("CreateSessionWithSdpReq",e),0===e.body.result&&this.addSession(e.header.session_id,e.body.session_token);break;case"MediaDescRsp":this.handleRespondData("MediaDescReq",e);break;case"CandidateInfoRsp":this.handleRespondData("CandidateInfoReq",e);break;case"CloseSessionRsp":this.handleRespondData("CloseSessionReq",e),this.removeSession(e.header.session_id);break;case"ClientHBRsp":this.handleRespondData("ClientHBReq",e);break;case"MediaDescPush":case"CandidateInfoPush":case"StreamStatusNotifyPush":case"PublishEventPush":case"PlayEventPush":case"ClientInfoPush":case"NetQualityInfoPush":case"MediaDescUpdatePush":case"CmdPush":this.handlePushData(e);break;case"CloseSessionPush":this.handlePushData(e),this.removeSession(e.header.session_id);break;case"QualityReportRsp":this.handleRespondData("QualityReportReq",e);break;case"SessionResetPush":this.handlePushResetSessionData(e);break;case"ActivateVideoPlayStreamRsp":this.handleRespondData("ActivateVideoPlayStreamReq",e);break;case"ActivateAudioPlayStreamRsp":this.handleRespondData("ActivateAudioPlayStreamReq",e);break;case"NetQualityProbeRsp":this.handleRespondData("NetQualityProbeReq",e);break;case"ActivateSEIInsertRsp":this.handleRespondData("ActivateSEIInsertReq",e);break;case"StreamStatusNotifyAck":this.handleRespondData("StreamStatusNotify",e);break;case"Peer2PeerNetStatsGetRsp":this.handleRespondData("Peer2PeerNetStatsGetReq",e);break;case"MediaDescUpdateRsp":this.handleRespondData("MediaDescUpdateReq",e);break;case"CmdRsp":this.handleRespondData("CmdReq",e)}},e.prototype.disconnectCallback=function(e,t){this.logger.info("zc.s.dcb "+JSON.stringify(e)+" "+t),this.connectCallback&&(this.connectCallback(t||-1,this.server,void 0),this.connectCallback=null);var r=this.server;this.disconnectServer(),this.onDisconnect(r,e)},e.prototype.updateToken=function(){var e=this;this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_UPDATE_TOKEN+" call");var t={token:this.token,tokenType:this.tokenType,roomid:this.roomID,anchorname:this.stateCenter.anchor_info.anchor_id,sdkversion:i.PROTO_VERSION,osinfo:navigator.appVersion};if(0!=Object.keys(this.sessionInfos).length){var r=[];for(var n in this.sessionInfos){var s=parseInt(n);r.push({session_id:s,session_token:this.sessionInfos[s].token})}t.sessions=r}this.sendMessageWithCallback("LoginReq",this.stateCenter.getSeq(),0,t,(function(t,r,n){if(0==n.result){e.token=n.token,e.tokenType=n.tokenType;var i={report:n.report,report_interval:n.report_interval_ms};n.negoInterval&&(e.negoInterval=n.negoInterval),n.negoTryCount&&(e.negoTryCount=n.negoTryCount),n.negoTryMaxCount&&(e.negoTryMaxCount=n.negoTryMaxCount),null!=e.connectCallback&&(e.connectCallback(0,e.server,i),e.connectCallback=null),e.checkMessageTimeout()}else null!=e.connectCallback&&(e.connectCallback(n.result,e.server,{error:n.strError}),e.connectCallback=null)}),(function(){null!=e.connectCallback&&(e.connectCallback(-1,e.server,void 0),e.connectCallback=null)}))},e.prototype.sendMessageWithCallback=function(e,t,r,n,s,a){var c,l=this;void 0===s&&(s=null),void 0===a&&(a=null),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" call "+e+" "+t+" "+(null===(c=this.websocket)||void 0===c?void 0:c.readyState));var d=performance.now();if(!this.websocket||"LoginReq"!==e&&this.websocket.readyState!==WebSocket.OPEN)return this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" connect not establish"),void(a&&a(i.SEND_MSG_TIMEOUT,t));var h={header:this.getHeader(e,t,r),body:n},p={seq:t,deleted:!1,cmd:e,time:(new Date).getTime(),success:function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(u.includes(e)){var i=(performance.now()-d).toFixed(0);l.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" seq: ".concat(t,", cmd: ").concat(e,", cost_time: ").concat(i))}s&&s.apply(void 0,r)},error:a},f=this.sendDataList.push(p);this.sendDataMap[p.seq]=f;var g=JSON.stringify(h);this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" "+g),this.useNetAgent&&"LoginReq"===e?this.websocket.send(g,void 0,!0):this.websocket.send(g),this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" success")},e.prototype.getHeader=function(e,t,r){return{version:"1.0.1",cmd:e,appid:this.appid+"",seq:t,user_id:this.userid,session_id:r}},e.prototype.connectServer=function(e,t,r,n){var a,u=this;if(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" "+r),this.roomID=e,this.token=t,this.server=r,this.state=i.ENUM_CONNECT_STATE.connecting,this.connectCallback=n,this.isServerConnected)this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket is connected"),this.resetConnectTimer(),this.state=i.ENUM_CONNECT_STATE.connected;else try{if(this.useNetAgent){if(!this.stateCenter.appConfig)return void this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" no app config ");var l=this.stateCenter.appConfig.media_config.publish_config.resource_info.find((function(e){return e.resource_type===i.SignalResourceType.RTC}));if(!l)return void(n&&n(s.errorCodeList.GET_CONFIG_FAIL));var d=null===(a=null==l?void 0:l.service_info)||void 0===a?void 0:a.find((function(e){return e.protocol===i.ProtocolType.WEBRTC}));if(!d)return void(n&&n(s.errorCodeList.GET_CONFIG_FAIL));var h=d.url_template.split("{IP}")[1].split("?"),p=h[0],f=h[1],g={path:p,query:f};this.stateCenter.isTestMode&&(g={path:p+2,query:f}),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" signal "+JSON.stringify(g)),this.websocket instanceof WebSocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),!this.websocket&&(this.websocket=new c.AnalogSocket(this.server,this.netAgent,g,this.logger)),this.websocket.open()}else this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" need new websocket"),this.websocket&&(this.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" close error websocket"),this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close()),this.websocket=new WebSocket(this.server);this.websocket.onclose=function(e){u.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket close call  "+JSON.stringify(e)),u.useNetAgent&&u.state!=i.ENUM_CONNECT_STATE.disconnect&&(u.successConnectedCallback=u.connectCallback,u.resetConnectTimer(),u.startConnectTimer((function(e){1008===e&&u.disconnectCallback(s.errorCodeList.TOKEN_EXPIRED)})))},this.websocket.onerror=function(e){u.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket onerror call  "+JSON.stringify(e)),u.stateCenter.useNetAgent&&(null==e?void 0:e.code)&&u.disconnectCallback(void 0,null==e?void 0:e.code)},this.useNetAgent&&this.websocket instanceof c.AnalogSocket?(this.websocket.onopen=function(){u.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket open call"),u.bindWebSocketEvents(),u.state=i.ENUM_CONNECT_STATE.connected,u.websocket&&(u.websocket.onmessage=u.handleWsMessage.bind(u))},this.websocket.onreconnnecting=function(){u.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket reconnecting "+!!u.successConnectedCallback),u.successConnectedCallback&&(u.connectCallback=u.successConnectedCallback),u.updateToken()},this.websocket.onmessage=this.handleWsMessage.bind(this),this.updateToken()):this.websocket.onopen=function(){u.resetConnectTimer(),u.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket open call"),u.websocket&&(u.websocket.onmessage=u.handleWsMessage.bind(u)),u.bindWebSocketEvents(),u.updateToken(),u.state=i.ENUM_CONNECT_STATE.connected}}catch(e){this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket error "+e)}this.useNetAgent||(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" "+this.tryConnectInterval),this.tryConnectTimer=setTimeout((function(){u.startConnectTimer(n)}),this.tryConnectInterval))},e.prototype.startConnectTimer=function(e){if(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" call"),this.tryConnectCount>=i.MAX_TRY_CONNECT_COUNT)return this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" beyond "+this.server+"max limit"),void this.disconnectCallback();this.websocket&&this.websocket.readyState===WebSocket.OPEN?(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" websocket is connected"),this.resetConnectTimer()):(this.tryConnectCount+=1,this.connectServer(this.roomID,this.token,this.server,e))},e.prototype.disconnectServer=function(){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_DISCONNECT_SERVER+" call"),this.connectCallback=null,this.resetCheckMessage(),this.resetConnectTimer(),this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),this.token="",this.sessionInfos={},this.tokenType=0,this.tryHeartbeatCount=0,this.tryConnectCount=0,this.state=i.ENUM_CONNECT_STATE.disconnect},Object.defineProperty(e.prototype,"isServerConnected",{get:function(){var e;return(null===(e=this.websocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN},enumerable:!1,configurable:!0}),e.prototype.createSession=function(e,t,r,n,s,a,c,u,l){void 0===s&&(s=""),void 0===a&&(a=""),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CREATE_SESSION+" call: "+n);var d="";i.PROTO_VERSION.split(".").forEach((function(e,t){return d+=1==e.length&&1==t?"0"+e:e})),this.sendMessageWithCallback("CreateSessionReq",e,0,{type:t,stream_id:n,platform:this.platform,browser:this.browser.name,version:this.browser.version,app_id:this.appid,negotiate_mode:r,strAuthParam:s,sdk_version:1*d,turn_server_host:"string"==typeof a?a:"",params:c},u,l)},e.prototype.createSessionWithSdp=function(e,t,r){var s,a=e.seq,c=e.type,u=e.streamId,l=e.strAuthParam,d=e.sdp,h=e.serverHost,p=e.playBufLevel,f=e.params,g=(null===(s=e.videoInfo)||void 0===s?void 0:s.keyFrameInterval)||2;this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CREATE_SESSION+" call: "+u);var m="";i.PROTO_VERSION.split(".").forEach((function(e,t){return m+=1==e.length&&1==t?"0"+e:e}));var _={type:c,app_id:this.appid,stream_id:u,sdp:d,user_id:this.userid,platform:this.platform,browser:this.browser.name,sdk_vers:parseInt(m),clientIp:"",media_server_host:"string"==typeof h?h:"",strAuthParam:l,params:f,keyframe_intv:parseInt(g)};p&&(_.min_play_buf_level_ms=p),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CREATE_SESSION+" "+u+" params: "+JSON.stringify(n(n({},_),{sdp:void 0}))),this.sendMessageWithCallback("CreateSessionWithSdpReq",a,0,_,t,r)},e.prototype.sendMediaDescUpdateReq=function(e,t,r,n,i){this.sendMessageWithCallback("MediaDescUpdateReq",e,t,{peer_id:r.peerID,type:r.type,sdp:r.sdp,width:r.width,height:r.height,framerate:r.frameRate,video_min_kpbs:r.video_min_kpbs,video_max_kpbs:r.video_max_kpbs,audio_kpbs:r.audio_kpbs,keyframe_intv:r.keyframe_intv},n,i)},e.prototype.removeSession=function(e){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_REMOVE_SESSION+" call "+e),this.sessionInfos[e]&&delete this.sessionInfos[e]},e.prototype.sendCloseSession=function(e,t,r,n,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_REMOVE_SESSION+" call: "+t);var s={reason:r};this.removeSession(t),this.sendMessageWithCallback("CloseSessionReq",e,t,s,n,i)},e.prototype.sendMessage=function(e,t,r,n){if(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" call "+e),this.websocket&&this.websocket.readyState===WebSocket.OPEN){var i=this.getHeader(e,t,r),s=JSON.stringify({header:i,body:n});this.websocket.send(s),this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" success")}else this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" connect not establish")},e.prototype.handleRespondData=function(e,t){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" call");var r=this.sendDataMap[t.header.seq];if(null!=r){delete this.sendDataMap[t.header.seq],this.sendDataList.remove(r);var n=r._data;n.cmd!==e?this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" command is not match"):n.success&&n.success(t.header.seq,t.header.session_id,t.body)}else{if("CloseSessionRsp"==t.header.cmd)return;this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" cannot find data "+e)}},e.prototype.addSession=function(e,t){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ADD_SESSION+" call"+e),this.sessionInfos[e]={token:t}},e.prototype.handlePushData=function(e){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_DATA+" call "+e.header.cmd+" session "+e.header.session_id);var t=this.pushCallback[e.header.cmd+e.header.session_id];t?t.callback&&t.callback(e.header.seq,e.header.session_id,e.body):this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_DATA+" no callbackData "+e.header.cmd+" session: "+e.header.session_id)},e.prototype.handlePushResetSessionData=function(e){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" call ");var t=[];if(0==e.body.cResetType)t=Object.keys(this.sessionInfos);else if(1==e.body.cResetType)for(var r=0;r<e.body.session_ids.length;r++)t.push(e.body.session_ids[r]);if(this.sendResetSessionAck(e.header.seq,0,0),0!=t.length)for(var n=0;n<t.length;n++){var i=this.pushCallback[e.header.cmd+t[n]];null==i?this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" no callbackData "+t[n]):i.callback&&i.callback(e.header.seq,t[n],e.body)}else this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" no session to callback")},e.prototype.sendMediaDesc=function(e,t,r,n,i,s){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC+" call: "+t);var a={type:r,sdp:n.sdp};null!=n.width&&(a.width=n.width),null!=n.height&&(a.height=n.height),null!=n.frameRate&&(a.framerate=n.frameRate),null!=n.video_min_kpbs&&(a.video_min_kpbs=n.video_min_kpbs),null!=n.video_max_kpbs&&(a.video_max_kpbs=n.video_max_kpbs),null!=n.audio_kpbs&&(a.audio_kpbs=n.audio_kpbs),null!=n.keyframe_intv&&(a.keyframe_intv=n.keyframe_intv),null!=n.min_play_buf_level_ms&&(a.min_play_buf_level_ms=n.min_play_buf_level_ms),this.sendMessageWithCallback("MediaDescReq",e,t,a,i,s)},e.prototype.sendCandidateInfo=function(e,t,r,n,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CANDIDATE_INFO+" call: "+t);for(var s=[],a=0;a<r.length;a++)s.push({candidate:r[a].candidate,sdpMid:r[a].sdpMid,sdpMLineIndex:r[a].sdpMLineIndex});this.sendMessageWithCallback("CandidateInfoReq",e,t,{infos:s},n,i)},e.prototype.sendMediaDescAck=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC_ACK+" call: "+t),this.sendMessage("MediaDescAck",e,t,{result:r})},e.prototype.sendUpdateMediaDescAck=function(e,t,r,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC_ACK+" call: "+t),this.sendMessage("MediaDescUpdateAck",e,t,{peer_id:n,result:r})},e.prototype.sendCandidateInfoAck=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CANDIDATE_INFO_ACK+" call: "+t),this.sendMessage("CandidateInfoAck",e,t,{result:r})},e.prototype.sendCloseSessionAck=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CLOSE_SESSION_ACK+" call: "+t),this.sendMessage("CloseSessionAck",e,t,{result:r})},e.prototype.sendResetSessionAck=function(e,t,r){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_RESET_SESSION_ACK+" call: "+t),this.sendMessage("SessionResetAck",e,t,{result:r})},e.prototype.registerPushCallback=function(e,t,r){r&&"function"==typeof r&&(this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_REGISTER_PUSH_CALLBACK+" set callback "+t),this.pushCallback[e+t]={callback:r})},e.prototype.unregisterPushCallback=function(e,t){delete this.pushCallback[e+t]},e.prototype.checkMessageTimeout=function(){for(var e,t=this,r=this.sendDataList.getFirst(),n=(new Date).getTime(),s=0,a=0,c=0;null!=r&&!(r._data.time+this.sendDataTimeout>n);)if(delete this.sendDataMap[r._data.seq],this.sendDataList.remove(r),++a,-1!=this.checkMessageList.indexOf(r._data.cmd)){if(null==r._data.error||this.sendDataDropTimeout>0&&r._data.time+this.sendDataDropTimeout<n?++c:(this.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_CHECK_MESSAGE_TIMEOUT+" error cmd = "+r._data.cmd+" seq ="+(null===(e=r._data)||void 0===e?void 0:e.seq)),r._data.error&&r._data.error(i.SEND_MSG_TIMEOUT,r._data.seq)),++s>=this.sendDataCheckOnceCount)break;r=this.sendDataList.getFirst()}else r=this.sendDataList.getFirst();this.sendDataCheckTimer=setTimeout((function(){t.checkMessageTimeout()}),this.sendDataCheckInterval),0==a&&0==c||this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_CHECK_MESSAGE_TIMEOUT+" call success, state: timeout="+a+" drop="+c)},e.prototype.sendHeartbeat=function(){var e=this;if(this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+"call tryHeartbeatCount:"+this.tryHeartbeatCount),0!=Object.keys(this.sessionInfos).length)if(this.state===i.ENUM_CONNECT_STATE.connected){if(++this.tryHeartbeatCount>i.MAX_TRY_HEARTBEAT_COUNT)return this.logger.error(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" heartbeat try limit"),void this.disconnectCallback();var t=[];for(var r in this.sessionInfos)t.push(parseInt(r));var n={session_ids:t},s=(new Date).getTime();this.sendMessageWithCallback("ClientHBReq",this.stateCenter.getSeq(),0,n,(function(t,r,n){e.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" hb time "+((new Date).getTime()-s)),e.heartbeatInterval!=n.hb_interval&&(e.heartbeatInterval=n.hb_interval,e.onUpdateHeartBeatInterval(n.hb_interval)),e.tryHeartbeatCount=0}),(function(e,t){}))}else this.logger.warn(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" state error");else this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" no need to heartbeat")},e.prototype.QualityReport=function(e,t,r,i,s){this.logger.debug(o.ZEGO_WEBRTC_ACTION.SIGNAL_QUALITY_REPORT+" call");var a={streams:[n(n({},r),{aid:t})]};this.sendMessageWithCallback("QualityReportReq",e,t,a,i,s)},e.prototype.sendStreamStatus=function(e,t,r,n,s,a){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_STREAM_STATUS+" call "+t);var c={mic_status:n,camera_status:r};this.logger.info("".concat(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_STREAM_STATUS," stream ").concat(s||""," status ").concat(JSON.stringify(c))),this.sendMessageWithCallback("StreamStatusNotify",e,t,c,(function(){}),(function(e){e===i.SEND_MSG_TIMEOUT&&a&&a()}))},e.prototype.ActivatePlayVideoStream=function(e,t,r,n,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM+" call");var s={active:r?0:1,layer:0};this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM+" activate video "+JSON.stringify(s)),this.sendMessageWithCallback("ActivateVideoPlayStreamReq",e,t,s,n,i)},e.prototype.ActivatePlayAudioStream=function(e,t,r,n,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM+" call");var s={active:r?0:1,layer:0};this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM+" activate audio "+JSON.stringify(s)),this.sendMessageWithCallback("ActivateAudioPlayStreamReq",e,t,s,n,i)},e.prototype.sendBroadcasterStatus=function(e,t,r){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_BROADCAST_STATUS+" call "+t),this.sendMessage("BroadcasterStatusNotify",e,t,{status:r})},e.prototype.sendNetProbe=function(e,t,r,n,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_NET_PROBE+" call "+t),this.sendMessageWithCallback("NetQualityProbeReq",e,t,{peer_id:r,action:1},n,i)},e.prototype.sendNetQualityInfoPushAck=function(e,t,r,n){this.logger.info(o.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_NET_PROBE+" call "+t),this.sendMessage("NetQualityInfoAck",e,t,{peer_id:r,result:n})},e.prototype.activateSEIInsert=function(e,t,r,n,i,o,s){},e.prototype.getP2PNetStats=function(e,t,r,n,i){this.sendMessageWithCallback("Peer2PeerNetStatsGetReq",e,t,{peer_id:r},n,i)},e.prototype.sendGWCmd=function(e,t,r,n,i){this.sendMessageWithCallback("CmdReq",e,t,r,n,i)},e.prototype.sendGWAck=function(e,t,r){this.sendMessage("CmdAck",e,t,r)},e}();t.ZegoSignal=l},8935:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoplayDialog=void 0;var i=n(r(4671)),o="zg_autoplay_wrapper";function s(){return navigator.language.includes("zh")}var a=function(){function e(){this.content='Media play failed. Click the "Resume"to resume.',this.dialogNode=null,this.bodyPosition="static";var e=document.createElement("style");e.innerHTML=".zg_autoplay_mask{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500;}.zg_autoplay_mask div:not(.zg_autoplay_action_wrapper){display:block !important;}.".concat(o,"{padding:14px;background:#fff;border-radius:3px;box-shadow:1px 1px 10px #988e8d;border:1px solid #d1cfcf;max-width:500px;}.").concat(o," a{color:#2473E8;}.zg_autoplay_header{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600;}.zg_autoplay_content{margin:8px 0;}.zg_autoplay_action_wrapper{width:100%;display:flex !important;align-items:center;justify-content:right;float:right;}.zg_autoplay_collapse{margin-right:auto;cursor:pointer}.zg_autoplay_question{height:100%;line-height:16px;cursor:pointer;}.zg_autoplay_action_confirm{margin-left:8px;color:#fff;background:#0072ff;padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold;}.zg_autoplay_action_confirm:hover{opacity:0.9;}.zg_autoplay_collapse,.zg_autoplay_action_confirm,.zg_autoplay_content,.zg_autoplay_question{font-size:14px;}@media screen and (max-width:750px){.").concat(o,"{width:80vw;}}"),document.head.appendChild(e),s()&&(this.content="\u6d4f\u89c8\u5668\u963b\u6b62\u97f3\u89c6\u9891\u64ad\u653e\uff0c\u8bf7\u70b9\u51fb\u201c\u6062\u590d\u64ad\u653e\u201d\u3002"),this.eManager=new i.default}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.createDialog=function(){var e=document.createElement("template");e.innerHTML="<div class='zg_autoplay_mask'><div class='".concat(o,"'><div class='zg_autoplay_header'>").concat(location.host,"</div><div class='zg_autoplay_content'>").concat(this.content,"</div><div class='zg_autoplay_action_wrapper'></div></div></div>").trim();var t=document.createElement("button");t.className="zg_autoplay_action_confirm",t.innerText=s()?"\u6062\u590d\u64ad\u653e":"Resume",t.onclick=this.onConfirm.bind(this);var r=e.content.firstChild,n=r.querySelector(".zg_autoplay_action_wrapper");return n&&n.appendChild(t),r},e.prototype.onConfirm=function(e){e&&e.stopPropagation(),this.eManager.emit("allowPlay"),this.deleteDiaLog()},e.prototype.deleteDiaLog=function(){this.dialogNode&&(document.body.removeChild(this.dialogNode),this.dialogNode=null)},e.prototype.addDiaLog=function(){this.dialogNode=this.dialogNode||this.createDialog(),document.body.appendChild(this.dialogNode),this.dialogNode.onclick=this.onConfirm.bind(this)},e.prototype.on=function(e,t){return this.eManager.addEventHandler(e,t)},e.instance=null,e}();t.AutoplayDialog=a},9307:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StreamView=void 0;var a=s(r(4671)),c=r(3770),u=r(8935).AutoplayDialog.getInstance(),l=function(){function e(e,t){var r,n,i,o=this;this.previewer=t,this.video=null,this.audio=null,this.options={enableAutoplayDialog:!0},this.emitPlayFailed=(r=function(){o.eventManager.emit("autoplayFailed"),o.options.enableAutoplayDialog&&u.addDiaLog()},void 0===(n=600)&&(n=100),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=this;clearTimeout(i),i=window.setTimeout((function(){r.apply(o,e)}),n)});var s=this.id="".concat(e.id),c=document.createElement("div");c.id="zg-rtc-player_".concat(s),c.setAttribute("style","width:100%;height:100%;position:relative;background-color:black;overflow:hidden;");var l=e.getVideoTracks()[0],d=e.getAudioTracks()[0],h=document.createElement("video");h.id="zg-rtc-video_".concat(s),h.setAttribute("style","width:100%;height:100%;object-fit:contain;"),h.setAttribute("autoplay","autoplay"),h.setAttribute("playsinline","playsinline"),h.muted=!0,h.srcObject=new MediaStream,l&&h.srcObject.addTrack(l);var p=document.createElement("audio");p.id="zg-rtc-audio_".concat(s),p.setAttribute("autoplay","autoplay"),p.setAttribute("playsinline","playsinline"),p.srcObject=new MediaStream,d&&p.srcObject.addTrack(d),this.wrapper=c,this.video=h,this.audio=p,this.eventManager=new a.default,u.on("allowPlay",(function(){o.resume()}))}return Object.defineProperty(e.prototype,"isLocal",{get:function(){return this.previewer instanceof c.ZegoPreview},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMounted",{get:function(){return!!this.wrapper.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasAudio",{get:function(){var e,t,r;return!!(null===(e=this.audio)||void 0===e?void 0:e.parentNode)&&"live"===(null===(r=null===(t=this.audio.srcObject)||void 0===t?void 0:t.getTracks()[0])||void 0===r?void 0:r.readyState)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasVideo",{get:function(){var e,t,r;return!!(null===(e=this.video)||void 0===e?void 0:e.parentNode)&&"live"===(null===(r=null===(t=this.video.srcObject)||void 0===t?void 0:t.getTracks()[0])||void 0===r?void 0:r.readyState)},enumerable:!1,configurable:!0}),e.prototype.resume=function(e){return i(this,void 0,void 0,(function(){var t=this;return o(this,(function(r){return["audio","video"].forEach((function(r){return i(t,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return t="audio"===r?this.audio:this.video,("audio"===r?this.hasAudio:this.hasVideo)?(e&&t&&(t.srcObject=t.srcObject),[4,null==t?void 0:t.play()]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))})),[2]}))}))},e.prototype.play=function(e,t){void 0===t&&(t={});var r=null;if("string"==typeof e?r=document.getElementById(e):e instanceof HTMLElement&&(r=e),!r)throw"Execute `play` failed, container not exist";this.options=n(n({},this.options),t);var i=this.options,o=i.objectFit,s=i.muted,a=i.mirror,c=!this.isLocal;this.audio&&"boolean"==typeof s&&(c=!s),this.video&&(void 0!==o&&(this.video.style.objectFit=o),"boolean"==typeof a&&(this.video.style.transform=a?"rotateY(180deg)":"")),!r.contains(this.wrapper)&&r.appendChild(this.wrapper),this.mountPlayer(this.video,!0),this.mountPlayer(this.audio,c)},e.prototype.stop=function(){var e,t=null===(e=this.wrapper)||void 0===e?void 0:e.parentNode;t&&t.removeChild(this.wrapper)},e.prototype.setVideo=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,this.setTrack(!0,e,t)];case 1:return r.sent(),[2]}}))}))},e.prototype.setAudio=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,this.setTrack(!1,e,t)];case 1:return r.sent(),[2]}}))}))},e.prototype.setTrack=function(e,t,r){return void 0===r&&(r=!1),i(this,void 0,void 0,(function(){var n,i,s,a=this;return o(this,(function(o){switch(o.label){case 0:return(n=e?this.video:this.audio)&&(i=n.srcObject)?t?[3,1]:((s=i.getTracks()).forEach((function(e){null==i||i.removeTrack(e)})),[3,8]):[2];case 1:if(!(t instanceof MediaStreamTrack))return[3,8];if((s=i.getTracks()).includes(t))return[3,8];if(s.forEach((function(e){null==i||i.removeTrack(e)})),i.addTrack(t),!r)return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.resume(!0)];case 3:case 4:return o.sent(),[3,5];case 5:return[3,8];case 6:return[4,n.play().catch((function(t){(e?a.hasVideo:a.hasAudio)&&n.paused&&a.emitPlayFailed(t)}))];case 7:o.sent(),o.label=8;case 8:return[2]}}))}))},e.prototype.setMirror=function(e){var t=this.options.mirror=!!e;this.video&&(this.video.style.transform=t?"rotateY(180deg)":"")},e.prototype.setVideoMuted=function(e){return this.mountPlayer(this.video,!e)},e.prototype.setAudioMuted=function(e){return this.mountPlayer(this.audio,!e)},e.prototype.setVolume=function(e){if(this.audio){var t=e>100?1:e/100;return this.audio.volume=t,this.audio.volume==t}return!1},e.prototype.takeStreamSnapshot=function(e){var t=this.video;if(!t)return"";if(!t.srcObject)return"";var r=document.createElement("canvas");r.width=this.video.videoWidth,r.height=this.video.videoHeight;var n=r.getContext("2d");n&&n.drawImage(this.video,0,0,r.width,r.height);var i=r.toDataURL("image/"+(null==e?void 0:e.imageType)||0,null==e?void 0:e.quality),o="png";return(null==e?void 0:e.imageType)&&(o=["png","jpeg"].includes(null==e?void 0:e.imageType)?null==e?void 0:e.imageType:"png"),(null==e?void 0:e.save)&&r.toBlob((function(t){var r=window.URL.createObjectURL(t),n=document.createElement("a");n.style.display="none",n.href=r;var i=(null==e?void 0:e.fileName)||"snapshot"+Date.now();n.download=i+"."+o,document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(r)}),100)})),i},e.prototype.mountPlayer=function(e,t){var r,n,i=this;if(!e||!this.wrapper)return!1;var o="VIDEO"===e.tagName;if(t){if(t&&"live"===(null===(n=null===(r=null==e?void 0:e.srcObject)||void 0===r?void 0:r.getTracks()[0])||void 0===n?void 0:n.readyState)){var s=null,a=function(){e.oncanplay=null,s&&(clearTimeout(s),s=null),e.play().catch((function(){i.isMounted&&(o&&i.hasVideo||!o&&i.hasAudio)&&i.emitPlayFailed()}))};e.muted=!1,e.play().catch((function(){})),s=window.setTimeout((function(){a()}),1e3),e.oncanplay=function(){a()},!e.parentNode&&this.wrapper.appendChild(e)}}else{e.muted=!0;var c=e.parentNode;c&&c.removeChild(e)}return!0},e.prototype.on=function(e,t){return!!t&&this.eventManager.addEventHandler(e,t)},e.prototype.off=function(e,t){return this.eventManager.removeEventHandler(e,t)},e.prototype.useAudioOut=function(e){var t;return i(this,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return(r=null===(t=this.audio)||void 0===t?void 0:t.setSinkId)?[4,r.call(this.audio,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},e.prototype.destroy=function(){this.stop(),this.audio=null,this.video=null},e}();t.StreamView=l},3409:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoStreamCenterWeb=t.CachedNodesUseMode=void 0;var u,l=r(6706),d=r(3770),h=r(1547),p=r(5740),f=r(6706),g=r(5019),m=r(3849),_=r(6014),v=r(8493),y=r(2752),E=r(3529),S=r(2990),b=r(1089),T=c(r(3720)),C=r(608);!function(e){e[e.NotReUse=0]="NotReUse",e[e.TheSameReUse=1]="TheSameReUse",e[e.DiffReUse=2]="DiffReUse",e[e.AllReUse=3]="AllReUse"}(u=t.CachedNodesUseMode||(t.CachedNodesUseMode={}));var R=function(e){function t(t,r,n,i,o,s){var a,c=this;return(c=e.call(this)||this).logger=t,c.stateCenter=r,c.dataReport=n,c.rtm=i,c.ac=o,c.mediaEleSources=s,c.testEnvironment=!1,c.heartbeatTimer=null,c.heartbeatInterval=1e4,c.qualityTimerInterval=3e3,c.previewStreamList=[],c.signalList={},c.chargeInfos={itemtype:"ChargeInfos",timestamp_begin:0,timestamp_end:0,timestamp_diff_flag:0,timestamp_diff:0,infos:[]},c.soundLevelDelegate=!1,c.soundLevelInterval=1e3,c.enableInBackground=!1,c.isPeer=!0,c.probeList={},c.isMicEnabled=!0,c.isDataChannelEnabled=!1,c.publishQualityInfos=[],c.playQualityInfos=[],c.qualityUploadTimestamp=0,c.qualityHeadTimestamp=0,c.gwNode="",c.playerList={},c.stopedPlayerList={},c.publisherList={},c.playSuccessCallBackList={},c.playErrorCallBackList={},c.waitPublishList=[],c.waitPlayList=[],c.autoSwitchProtocol=!0,c.udpFailNum=0,c.maxUdpFailNum=2,c.qualityInterval=3e3,c.switchScore=60,c.defaultBadQualityTime=3e4,c.l3BadQualityTime=1e4,c.switchDetectResultScore=60,c.cdnBadQualityScore=60,c.l3BadQualityScore=60,c.multiPlaySwitchRate=.8,c.protocolBadQualityCount=3,c.protocolBadQualityTime=12e3,c.protocolQualityCacheExpiredTime=18e4,c.fallbackInhibitionTime=18e4,c.probeExpiredTime=3e4,c.minProbeInterval=15e3,c.l3DetectedTimestamp=0,c.l3DetectResult=0,c.isL3Fallback=!1,c.cdnProtocolBadTimestamp=0,c.l3ProtocolBadTimestamp=0,c.lastHandleCDNBadTimestamp=0,c.lastHandleL3BadTimestamp=0,c.cdnProtocolBadTime=0,c.l3ProtocolBadTime=0,c.probeStartedNum=3,c.cachedGwNodesList={},c.cachedGwNodesMode=u.TheSameReUse,c.tryCountConnectInterval=3e3,c.checkMessageTimeout=function(){for(var e in c.signalList)c.signalList[e].signal&&c.signalList[e].signal.checkMessageTimeout()},c.getAllInUseUrl=function(){var e=[];for(var t in c.signalList)e.push(t);return e},c.onDisconnectHandle=function(e,t){if(c.logger.info("zsc.od.0 call"),c.signalList[e]){for(var r=c.signalList[e],n=0;n<r.publishConnectedList.length;n++){var i=c.publisherList[r.publishConnectedList[n]];i&&i.publisher&&i.publisher.onDisconnect(t)}for(n=0;n<r.playConnectedList.length;n++){var o=c.playerList[r.playConnectedList[n]];o&&o.player&&o.player.onDisconnect(t)}delete c.signalList[e],c.stopSignalHeartbeat(),c.stateCenter.billingTimer.stopChargeInfosUpload(),c.stopSoundLevel()}},c.eventHandler={visibilitychange:function(){var e=!document.hidden;!c.enableInBackground&&c.soundLevelDelegate&&(e?(c.enableSoundLevelProcessor(!0),c.activeSoundLevel()):(c.soundLevelTimer&&clearTimeout(c.soundLevelTimer),c.soundLevelTimer=null,c.enableSoundLevelProcessor(!1))),c.ac.resume()}},c.rtm._on("_roomStateUpdate",(function(e,t){for(var r in c.playerList){var n=c.playerList[r],i=n.cdnPlayer;n.room.roomID==e&&i&&n.player.state===f.ENUM_PLAY_STATE.playing&&n.playMode==l.PlayMode.CDN&&("CONNECTED"==t?(i.canRetry=!0,i.retry()):"DISCONNECTED"===t&&c.stopPlayingStream(r))}})),document.addEventListener("visibilitychange",c.eventHandler.visibilitychange),null===(a=c.rtm.netAgent)||void 0===a||a.on("clientInfo",(function(e){if(c.stateCenter.accessClientIp&&(null==e?void 0:e.clientIP)&&c.stateCenter.accessClientIp!==e.clientIP){for(var t in c.logger.warn(b.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CLIENT_INFO+" client ip changed "+c.stateCenter.accessClientIp+" "+e.clientIP),c.publisherList){var r=c.publisherList[t].publisher;r.resetGwNodes(),c.clearCachedGwNodesList(r,!0)}for(var t in c.playerList){var n=c.playerList[t].player;n.resetGwNodes(),c.clearCachedGwNodesList(n,!1)}}c.stateCenter.accessClientIp=e.clientIP})),c}return i(t,e),Object.defineProperty(t.prototype,"cameraPreviewStream",{get:function(){return this.previewStreamList.find((function(e){return"camera"===e.previewType}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"microphonePreviewStream",{get:function(){return this.previewStreamList.find((function(e){return"camera"===e.previewType&&e.micTrack}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldReportNoPlaying",{get:function(){return this.stateCenter.billingTimer.shouldReportRoomTime},enumerable:!1,configurable:!0}),t.prototype.onSignalDisconnected=function(e){},t.prototype.setQualityMonitorCycle=function(e){var t=this;return this.logger.debug("zsc.qmc.0 timeInterval "+e),0==Object.keys(this.publisherList).length?this.qualityTimerInterval=e:Object.keys(this.publisherList).forEach((function(r){t.publisherList[r].publisher.qualityTimeInterval=e,t.publisherList[r].publisher.setPublishQualityTimer()})),!0},t.prototype.setSessionInfo=function(e,t,r){this.logger.debug("zsc.ssi.0 called"),this.appid=e,this.userid=t,this.testEnvironment=r},t.prototype.onPlayStateUpdate=function(e,t,r){},t.prototype.onPlayQualityUpdate=function(e,t){},t.prototype.onPublishStateUpdate=function(e,t,r){},t.prototype.onPublishQualityUpdate=function(e,t){},t.prototype.onUpdateHeartBeatIntervalHandle=function(e){e!=this.heartbeatInterval&&(this.logger.debug("zsc.uhb.0 update "+e),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatInterval=e,this.startSignalHeartbeat())},t.prototype.setPublishStateStart=function(e,t,r,n,i){var o,s,a=this;this.logger.info("zsc.pss.0 call "+t);var c=this.checkPreview(r);if(!c)return this.logger.error("zsc.pss.0 stream not found"),!1;var u=this.publisherList[t],l=this.stateCenter.reportSeqList.startPublish[t];if(this.dataReport.eventStart(l,"setPublishState"),u)return this.logger.error("zsc.pss.0 publisher already exist"),this.dataReport.eventEndWithMsgInfo(l,"setPublishState",{message:"publisher already exist"}),this.dataReport.uploadReport(l,void 0,E.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kIsPublishing),delete this.stateCenter.reportSeqList.startPublish[t],!1;var d=new h.ZegoPublish(t,this.logger,this.dataReport,this.qualityTimerInterval,this,this.stateCenter,c);d.state=f.ENUM_PUBLISH_STATE.start,d.isPeer=this.isPeer,d.reportSeq=this.stateCenter.reportSeqList.startPublish[t],d.isExternal=!0,d.cachedGwNodesMode=this.cachedGwNodesMode;var p=null===(o=null==c?void 0:c.videoTrack)||void 0===o?void 0:o.label,g=r.getAudioTracks()[0]&&r.getAudioTracks()[0].label,m=null===(s=null==c?void 0:c.videoTrack)||void 0===s?void 0:s.getSettings().deviceId,y=r.getAudioTracks()[0]&&r.getAudioTracks()[0].getSettings().deviceId,S=new _.RetryStreamHandler(this.logger,this.stateCenter,this,!0);return this.publisherList[t]={seq:0,room:e,localStream:r,publisher:d,serverUrls:[],ttl:0,isCenterNode:!0,streamID:t,publishOption:n,cameraLabel:p||"",microLabel:g||"",cameraDeviceId:m||"",microDeviceId:y||"",deviceStateCount:0,retryStreamHandler:S,retryDispatchHandler:new v.RetryDispatchHandler(this.logger,this.stateCenter,this.rtm,this),isDataChannel:i},d.onPublishStateUpdate=function(e,r,n,i,o,s){var c=a.publisherList[r];c?c.retryStreamHandler.publishStateHandle(e,c.streamID,n,i,o,s):a.logger.error("zsc.psuh.0 cannot find publish "+t)},d.onPublishQualityUpdate=function(e,r){var n=a.publisherList[e];n?(a.stateCenter.deviceStateOut&&0===r.audio.audioBitrate?(n.deviceStateCount++,n.deviceStateCount>=2&&(n.deviceStateCount=0,a.stateCenter.deviceStateOut=!1,a.logger.warn("zsc.pss.0 publish audio error by device"))):n.deviceStateCount=0,a.onPublishQualityUpdate(n.streamID,r)):a.logger.error("zsc.psuh.0 cannot find publish "+t)},this.dataReport.eventStart(d.reportSeq,"GetSignalUrl"),this.dataReport.eventStart(d.streamReportSeq,"GetSignalUrl"),!0},t.prototype.startPublishingStream=function(e,t){void 0===t&&(t=!1),this.logger.info("zsc.sps.0 call");var r=this.publisherList[e];if(!r)return this.logger.error("zsc.sps.0 publisher don't exist"),!1;var n=r.publisher;if(!t){if(this.dataReport.eventEndWithMsg(n.reportSeq,"GetSignalUrl",{urls:r.serverUrls,is_center:r.isCenterNode}),this.dataReport.eventEndWithMsg(n.streamReportSeq,"GetSignalUrl",{urls:r.serverUrls,is_center:r.isCenterNode}),!r.serverUrls||0===r.serverUrls.length)return r.retryStreamHandler.publishStateHandle(f.ENUM_PUBLISH_STATE_UPDATE.error,e,y.errorCodeList.DISPATCH_ERROR),this.logger.info("zsc.sps.0 server don't have signal url"),!0;var i=r.serverUrls.indexOf(this.server);-1!==i&&(r.serverUrls.splice(i,1),r.serverUrls.unshift(this.server))}var o=r.retryStreamHandler;return o.invalid(),o.init(this.stateCenter.streamRetryTime),o.initStream(e,r.serverUrls),o.startMaxTime(),o.activePublish(0)},t.prototype.updateWaitingList=function(e,t,r,n,i){var o={streamID:r,success:n,error:i};t?e.publishWaitingList.push(o):e.playWaitingList.push(o)},t.prototype.publishStream=function(e){var t=this.publisherList[e].publisher;if(t){var r=null,n=null,i=this.publisherList[e].publishOption,o=this.checkPreview(this.publisherList[e].localStream);o?(r=o.localStream,n=o.videoInfo,this.dataReport.addMsgInfo(this.stateCenter.reportSeqList.startPublish[e],{cap_w:E.ZegoRTCLogEvent.kZegoTaskPublishStart.cap_w(o.videoInfo.width),cap_h:E.ZegoRTCLogEvent.kZegoTaskPublishStart.cap_h(o.videoInfo.height),w:E.ZegoRTCLogEvent.kZegoTaskPublishStart.w(o.videoInfo.width),h:E.ZegoRTCLogEvent.kZegoTaskPublishStart.h(o.videoInfo.height),video_en_fps:E.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_fps(o.videoInfo.frameRate),video_en_bps:E.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_bps(o.videoInfo.bitRate)}),r?(this.logger.info("zsc.ps.0 call success"),this.setStreamGwNode(t,!0),t.startPublish(e,r,n,o.mediaStreamConfig,i)):this.logger.error("zsc.ps.0 no localStream found")):this.logger.error("zsc.ps.0 no preview found")}else this.logger.info("zsc.ps.0 publisher don't exist")},t.prototype.connectPublishServer=function(e,t){var r=this,n=this.publisherList[e];return n?(this.dataReport.eventStart(n.publisher.reportSeq,"ConnectServer"),this.dataReport.eventStart(n.publisher.streamReportSeq,"ConnectServer"),this.connectWithReuseSignalServer(e,!0,t,(function(e,t,n){var i=r.publisherList[e];if(i){var o=i.publisher;if(o){r.dataReport.eventEndWithMsg(o.reportSeq,"ConnectServer",{result:0,server:n}),r.dataReport.eventEndWithMsg(o.streamReportSeq,"ConnectServer",{result:0,server:n});var s=t.tokenInfo;r.logger.info("zsc.cps.0 update token success"),s&&s.report&&(o.qualityUpload=s.report,o.qualityUploadInterval=s.report_interval),o.signal=t.signal,r.server=n,r.publishStream(e),r.getTokenSuccess()}else r.logger.info("zsc.cps.1 check publisher don't exist")}else r.logger.info("zsc.cps.0 after connect publisher don't exist")}),(function(e,t){r.logger.error("zsc.cps.0 "+e+" connect fail "+JSON.stringify(t));var n=r.publisherList[e];if(n){var i=n.publisher;if(i){var s;r.dataReport.eventEndWithMsg(i.reportSeq,"ConnectServer",{result:t}),r.dataReport.uploadReport(i.reportSeq),delete r.stateCenter.reportSeqList.startPublish[e];var a=!1;t&&t.code===y.errorCodeList.GET_CONFIG_FAIL.code?(s=o({},y.errorCodeList.GET_CONFIG_FAIL),a=!0):((s=o({},y.errorCodeList.CONNECT_FAILED)).message=s.message+" "+t,1008===t&&(s=y.errorCodeList.TOKEN_EXPIRED,a=!0),20010===t&&(a=!0,s=JSON.parse(JSON.stringify(y.errorCodeList.PUBLISHER_SESSION_REQUEST_FAIL)))),n.retryStreamHandler.publishStateHandle(f.ENUM_PUBLISH_STATE_UPDATE.error,e,s,a)}else r.logger.info("zsc.cps.1 check publisher don't exist")}else r.logger.info("zsc.cps.0 after connect publisher don't exist")})),!0):(this.logger.error("zsc.cps.0 publisher don't exist"),!1)},t.prototype.getTokenSuccess=function(){this.logger.debug("zsc.gts.0 call")},t.prototype.stopPublishingStream=function(e){var t=this.publisherList[e];if(t){var r=t.retryStreamHandler;for(var n in r&&(r.stopMaxTime(),r.invalid()),this.signalList)this.signalList[n].publishWaitingList=this.signalList[n].publishWaitingList.filter((function(t){return t.streamID!==e}));delete this.publisherList[e],t.publisher&&(t.publisher.stopPublish(),delete t.publisher),this.removeStreamFromSignal(!0,e),this.stopSignalHeartbeat(),this.stateCenter.billingTimer.stopChargeInfosUpload(),this.stopSoundLevel(),this.logger.debug("zsc.sps.0.1 call success")}else this.logger.warn("zsc.sps.0.1 publisher don't exist")},t.prototype.connectWithReuseSignalServer=function(e,t,r,n,i){var o=this;this.logger.info("zsc.crss.0 begin "+r);var s=null;if(this.signalList[r])(s=this.signalList[r]).state==f.ENUM_SIGNAL_STATE.connected?(this.logger.info("zsc.crss.0 already connected "+r+" streamId: "+e),t?s.publishConnectedList.push(e):s.playConnectedList.push(e),n(e,s,r)):s.state==f.ENUM_SIGNAL_STATE.connecting&&(this.logger.info("zsc.crss.0 signal is connecting "+r+" streamId: "+e),this.updateWaitingList(s,t,e,n,i));else{this.logger.info("zsc.crss.0 new signal "+r+", streamId: "+e);var a=["unified_rtc","unified_l3"].includes(r),c=new g.ZegoSignal(this.logger,this.stateCenter,this.rtm.netAgent,a);c.setSessionInfo(this.appid,this.userid),a||(c.onUpdateHeartBeatInterval=this.onUpdateHeartBeatIntervalHandle.bind(this)),c.onDisconnect=this.onDisconnectHandle;var u=this.publisherList[e]||this.playerList[e]||null,l=null==u?void 0:u.retryStreamHandler;if(this.stateCenter.streamConnectTime)c.tryConnectInterval=this.stateCenter.streamConnectTime;else if(l&&l.retryActiveCount){var d=l.retryActiveCount*(l.retryActiveCount-1)/2+2;c.tryConnectInterval=1e3*(d=d>f.MAX_RETRY_CONNECT_INTERVAL?f.MAX_RETRY_CONNECT_INTERVAL:d)}this.signalList[r]={signal:c,state:f.ENUM_SIGNAL_STATE.connecting,publishWaitingList:[],playWaitingList:[],publishConnectedList:[],playConnectedList:[],tokenInfo:null},this.updateWaitingList(this.signalList[r],t,e,n,i);var h=null==u?void 0:u.room.token,p=null==u?void 0:u.room.roomID;this.logger.info("zsc.crss.0 "+h),c.connectServer(p||this.stateCenter.roomList[0].roomID,h||this.stateCenter.roomList[0].token,r,(function(e,t,n){if(s=o.signalList[r],0!=e){o.logger.info("zsc.crss.0 connect failed "+t);for(var i=s.publishWaitingList,c=i.length-1;c>=0;c--)(l=i[c]).error&&l.error(l.streamID,e);var u=s.playWaitingList;for(c=u.length-1;c>=0;c--){var l;(l=u[c]).error&&l.error(l.streamID,e)}delete o.signalList[r]}else o.logger.info("zsc.crss.0 connected success "+t),s.state=f.ENUM_SIGNAL_STATE.connected,s.tokenInfo=n,s.publishWaitingList.forEach((function(e){e.success&&e.success(e.streamID,s,t),s&&s.publishConnectedList.push(e.streamID)})),s.playWaitingList.forEach((function(e){e.success&&e.success(e.streamID,s,t),s&&s.playConnectedList.push(e.streamID)})),s.publishWaitingList=[],s.playWaitingList=[],a||null!=o.heartbeatTimer||o.startSignalHeartbeat(),o.stateCenter.billingTimer.startChargeInfosUpload(),o.activeSoundLevel()}))}},t.prototype.setPlayStateStart=function(e,t,r){var n=this;if(this.logger.info("zsc.pss.1 call "+e),this.rtm.isDisConnect()&&this.stateCenter.networkState==l.ENUM_NETWORK_STATE.offline)return this.logger.error("zsc.pss.1 network offline"),!1;var i=this.playerList[e],o=this.stateCenter.reportSeqList.startPlay[e];if(this.dataReport.eventStart(o,"setPlayState"),i)return this.logger.error("zsc.pss.1 player already exist"),this.dataReport.eventEndWithMsgInfo(o,"setPlayState",{message:"player already exist"}),this.dataReport.uploadReport(o,void 0,E.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kIsPlaying),delete this.stateCenter.reportSeqList.startPlay[e],E.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRepeatedPullError;var s=this.getPlayRoom(e)||this.stateCenter.roomList[0];if(!s)return this.logger.error("zsc.pss.1 not login room"),this.dataReport.eventEndWithMsgInfo(o,"setPlayState",{message:"not login room"}),this.dataReport.uploadReport(o,void 0,E.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNoLoginError),E.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNoLoginError;var a=new m.ZegoPlayWeb(e,this.logger,null,this.dataReport,this.qualityTimerInterval,this,this.ac,this.stateCenter);t&&[0,1,2,3].includes(t.resourceMode)&&(a.resourceMode=t.resourceMode),this.dataReport.addMsgInfo(o,{resourceMode:a.resourceMode,play_room_id:null==s?void 0:s.roomID,isMulti:this.stateCenter.isMultiRoom}),a.state=f.ENUM_PLAY_STATE.start,a.isPeer=this.isPeer,a.reportSeq=this.stateCenter.reportSeqList.startPlay[e],a.isExternal=!0,a.cachedGwNodesMode=this.cachedGwNodesMode,a.beginTime=(new Date).getTime();var c=new _.RetryStreamHandler(this.logger,this.stateCenter,this,!1),u=l.PlayMode.CDN,d=(new Date).getTime();for(var h in this.playerList)if(this.playerList[h].playMode==l.PlayMode.L3){u=l.PlayMode.L3;break}return this.cdnProtocolBadTimestamp&&this.cdnProtocolBadTimestamp+this.protocolQualityCacheExpiredTime>d&&0==this.l3ProtocolBadTimestamp&&(u=l.PlayMode.L3),this.playerList[e]={seq:0,room:s,player:a,signal:null,serverUrls:[],ttl:0,isCenterNode:!0,streamID:e,playOption:t,retryStreamHandler:c,retryDispatchHandler:new v.RetryDispatchHandler(this.logger,this.stateCenter,this.rtm,this),isDataChannel:r,cdnPlayer:null==t?void 0:t.CDNPlayer,playMode:u},a.onPlayStateUpdate=function(e,t,r,i,o,s){var a=n.playerList[t];a?c.playStateHandle(e,a.streamID,r,i,o,s):n.logger.error("zsc.pss.1 cannot find play "+t)},a.onPlayQualityUpdate=function(e,t){var r=n.playerList[e];r?n.onPlayQualityUpdate(r.streamID,t):n.logger.error("zsc.pss.1 cannot find play "+e)},a.onRemoteCameraStatusUpdate=function(e,t,r){var i=n.playerList[e];i?n.onRemoteCameraStatusUpdate(i.streamID,t,r):n.logger.error("zsc.pss.1 cannot find play "+e)},a.onRemoteMicStatusUpdate=function(e,t,r){var i=n.playerList[e];i?n.onRemoteMicStatusUpdate(i.streamID,t,r):n.logger.error("zsc.pss.1 cannot find play "+e)},this.dataReport.eventStart(a.reportSeq,"GetSignalUrl"),this.dataReport.eventStart(a.streamReportSeq,"GetSignalUrl"),!0},t.prototype.onRemoteMicStatusUpdate=function(e,t,r){},t.prototype.onRemoteCameraStatusUpdate=function(e,t,r){},t.prototype.startPlayingStream=function(e,t,r,n){var i,o;void 0===t&&(t=!1),this.logger.info("zsc.sps.1 start play called");var s=this.playerList[e];if((null===(i=s.playOption)||void 0===i?void 0:i.CDNVideo)&&s.player.firstPlay){var a=s.playOption.CDNVideo;s.player._CDNPlayerClone=a.cloneNode(),s.player.initPoster=(null==a?void 0:a.getAttribute("poster"))||"",s.player.initVideoStyle=(null==a?void 0:a.getAttribute("style"))||"",s.player.firstPlay=!1}if(n)return this.playCDN(e,this.playerList[e].playOption,this.playSuccessCallBackList[e],this.playErrorCallBackList[e]),!0;if(!s)return this.logger.error("zsc.sps.1 player don't exist"),!1;var c=s.player;if(-1==e.indexOf("zegoprobe-")&&(s.playMode==l.PlayMode.L3||(null===(o=s.playOption)||void 0===o?void 0:o.resourceMode)==l.ResourceMode.L3)){var u=(0,l.getReportSeq)();this.dataReport.newReport(u,E.ZegoRTCLogEvent.kZegoTaskL3Play.event),this.dataReport.addMsgInfo(u,{tryidx:E.ZegoRTCLogEvent.kZegoTaskL3Play.protocol(c.tryidx),biz_product:E.ZegoRTCLogEvent.kZegoTaskL3Play.protocol(s.playOption.resourceMode==l.ResourceMode.DG?1:0)}),this.dataReport.uploadReport(u)}if(!t){if(this.dataReport.eventEndWithMsg(c.reportSeq,"GetSignalUrl",{urls:s.serverUrls}),this.dataReport.eventEndWithMsg(c.streamReportSeq,"GetSignalUrl",{urls:s.serverUrls}),0==s.serverUrls.length)return s.retryStreamHandler.playStateHandle(f.ENUM_PLAY_STATE_UPDATE.error,e,y.errorCodeList.DISPATCH_ERROR),this.logger.info("zsc.sps.1 server don't have signal url"),!1;var d=s.serverUrls.indexOf(this.server);-1!==d&&(s.serverUrls.splice(d,1),s.serverUrls.unshift(this.server))}var h=s.retryStreamHandler;return h.invalid(),h.init(this.stateCenter.streamRetryTime),h.initStream(e,s.serverUrls),h.startMaxTime(),h.activePull(0,r)},t.prototype.connectPlayServer=function(e,t,r){var n=this,i=this.playerList[e];return i?(this.dataReport.eventStart(i.player.reportSeq,"ConnectServer"),this.dataReport.eventStart(i.player.streamReportSeq,"ConnectServer"),this.connectWithReuseSignalServer(e,!1,r,(function(e,r,i){var o=n.playerList[e];if(o){var s=o.player;if(s){n.dataReport.eventEndWithMsg(s.reportSeq,"ConnectServer",{result:0,server:i}),n.dataReport.eventEndWithMsg(s.streamReportSeq,"ConnectServer",{result:0,server:i});var a=r.tokenInfo;n.logger.info("zsc.cps.1 update token success"),a&&a.report&&(s.qualityHandler.qualityUpload=a.report,s.qualityHandler.qualityUploadInterval=a.report_interval),s.signal=r.signal,n.server=i,n.playStream(e,t),n.getTokenSuccess()}else n.logger.error("zsc.cps.1 checkplayer don't exist")}else n.logger.error("zsc.cps.1 after connect player don't exist")}),(function(t,i){var s=n.playerList[t];if(s){n.dataReport.eventEndWithMsg(s.player.reportSeq,"ConnectServer",{result:i}),!s.player.isProbe&&n.dataReport.uploadReport(s.player.reportSeq),delete n.stateCenter.reportSeqList.startPlay[e];var a=o({},y.errorCodeList.CONNECT_FAILED);a.message=a.message+" "+i,1008===i&&(a=y.errorCodeList.TOKEN_EXPIRED);var c=1008==i;20010===i&&(c=!0,a="unified_l3"===r?y.errorCodeList.PLAYER_UNSUPPORTED_PROTOCOL:y.errorCodeList.PLAYER_SESSION_REQUEST_FAIL),s.retryStreamHandler.playStateHandle(f.ENUM_PLAY_STATE_UPDATE.error,t,a,c)}else n.logger.error("zsc.cps.1 after connect player don't exist")})),!0):(this.logger.error("zsc.cps.1 player don't exist"),!1)},t.prototype.playStream=function(e,t){var r=this.playerList[e].player;r?(this.logger.info("zsc.ps.1 call success"),this.setStreamGwNode(r,!1),r.startPlay(e,t,this.playerList[e].playOption)):this.logger.warn("zsc.ps.1 player don't exist")},t.prototype.stopSignalHeartbeat=function(){this.logger.debug("zsc.ssh.1 call");var e=0;for(var t in this.signalList)e+=1;this.heartbeatTimer&&0==e&&(this.logger.info("zsc.ssh.1 stop"),clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},t.prototype.removeStreamFromSignal=function(e,t){this.logger.info("zsc.rsfs.0 call "+e+" "+t);var r=[];for(var n in this.signalList){var i=this.signalList[n];if(e){for(var o=0;o<i.publishConnectedList.length;o++)if(i.publishConnectedList[o]===t){this.logger.debug("zsc.rsfs.0 found from publish"),i.publishConnectedList.splice(o,1);break}for(o=0;o<i.publishWaitingList.length;o++)if(i.publishWaitingList[o].streamID===t){this.logger.debug("zsc.rsfs.0 found from publish"),i.publishWaitingList.splice(o,1);break}}else{for(var s=0;s<i.playConnectedList.length;s++)if(i.playConnectedList[s]===t){this.logger.debug("zsc.rsfs.0 found from play"),i.playConnectedList.splice(s,1);break}for(s=0;s<i.playWaitingList.length;s++)if(i.playWaitingList[s].streamID===t){this.logger.debug("zsc.rsfs.0 found from play"),i.playWaitingList.splice(s,1);break}}0==i.publishConnectedList.length&&0==i.playConnectedList.length&&0==i.publishWaitingList.length&&0==i.playWaitingList.length&&(i.signal.disconnectServer(),r.push(n))}for(var a=0;a<r.length;a++)delete this.signalList[r[a]],this.server==r[a]&&(this.server="")},t.prototype.stopPlayingStream=function(e){var t=this.playerList[e];if(t){var r=t.retryStreamHandler,n=t.cdnPlayer;for(var i in r&&(r.stopMaxTime(),r.invalid()),this.signalList)this.signalList[i].playWaitingList=this.signalList[i].playWaitingList.filter((function(t){return t.streamID!==e}));if(t.playMode==l.PlayMode.CDN&&n&&n.stop(),delete this.playerList[e],t.player){t.player.stopPlay();var o=t.player.rtcViewer;o&&o.stop()}this.removeStreamFromSignal(!1,e),this.stopSignalHeartbeat(),this.stateCenter.billingTimer.stopChargeInfosUpload(),this.stopSoundLevel(),delete this.playSuccessCallBackList[e],delete this.playErrorCallBackList[e],this.logger.debug("zsc.sps.1.1 call success")}else this.logger.info("zsc.sps.1.1 player don't exist")},t.prototype.reset=function(e,t,r){var n,i,o,s;for(var a in this.logger.info("zsc.rs call "+e+" "+t+" "+r),this.publisherList)this.publisherList[a].room.roomID!=e&&e||(null===(i=null===(n=this.publisherList[a].room)||void 0===n?void 0:n.streamHandler)||void 0===i||i.onPublishStateUpdate(f.ENUM_PUBLISH_STATE_UPDATE.error,a,1002031==t?E.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishRetryTimeoutError:{code:0,message:""}),r&&this.stateCenter.waitPublishStreamList[a]?this.stateCenter.waitPublishStreamList[a].retryStart=!0:r||delete this.stateCenter.waitPublishStreamList[a],this.stopPublishingStream(a));var c=function(n){var i=u.playerList[n].room;if(r&&(null===(s=null===(o=u.playerList[n])||void 0===o?void 0:o.player)||void 0===s?void 0:s.state)<=f.ENUM_PLAY_STATE.playing){var a=u.playerList[n],c=null==a?void 0:a.player;u.stopedPlayerList[n]={streamID:n,playStream:c.playStream,roomID:a.room.roomID,playOption:a.playOption,state:c.state,sucCallBack:(null==c?void 0:c.state)!==f.ENUM_PLAY_STATE.playing?u.playSuccessCallBackList[n]:void 0,errCallBack:(null==c?void 0:c.state)!==f.ENUM_PLAY_STATE.playing?u.playErrorCallBackList[n]:void 0}}if(i.roomID!=e||!i.streamList.find((function(e){return e.stream_id==n}))&&1!=u.stateCenter.roomList.length){if(i.roomID==e&&u.stateCenter.roomList.length>1){var l=u.stateCenter.roomList.find((function(t){return t.roomID!==e}));l?u.playerList[n].room=l:(u.stopPlayingStream(n),u.onPlayStateUpdate(f.ENUM_PLAY_STATE_UPDATE.error,n,E.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRetryTimeoutError))}}else u.onPlayStateUpdate(f.ENUM_PLAY_STATE_UPDATE.error,n,1002031==t?E.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRetryTimeoutError:{code:0,message:""}),u.stopPlayingStream(n)},u=this;for(var l in this.playerList)c(l);0==Object.keys(this.publisherList).length&&0==Object.keys(this.playerList).length&&(this.probeList={}),this.waitPublishList=[],this.waitPlayList=[],this.publishQualityInfos=[],this.playQualityInfos=[],this.qualityHeadTimestamp=0,this.qualityUploadTimestamp=0,this.l3DetectedTimestamp=0,this.l3DetectResult=0,this.isL3Fallback=!1,this.cdnProtocolBadTimestamp=0,this.l3ProtocolBadTimestamp=0,this.lastHandleCDNBadTimestamp=0,this.lastHandleL3BadTimestamp=0,this.cdnProtocolBadTime=0,this.l3ProtocolBadTime=0,this.qualityWebsocket&&(this.qualityWebsocket.close(),this.qualityWebsocket=void 0),this.logger.info("zsc.rs call success")},t.prototype.startSignalHeartbeat=function(){var e=this;this.logger.debug("zsc.ssh.0 call"),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatTimer=setTimeout((function(){e.checkSignalHeartbeat()}),this.heartbeatInterval)},t.prototype.checkSignalHeartbeat=function(){for(var e in this.logger.debug("zsc.csh.0 call"),this.signalList)this.signalList[e].signal&&this.signalList[e].signal.sendHeartbeat();this.heartbeatTimer&&this.startSignalHeartbeat()},t.prototype.getChargeInfos=function(){this.logger.debug("zsc.cci.0 call");var e={is_publishing:0,play_max_audio_bitrate:0,play_stream_resolution_infos:[]};for(var t in this.shouldReportNoPlaying&&(e.no_playing=1),this.chargeInfos.timestamp_begin=(new Date).getTime(),this.publisherList){this.publisherList[t].publisher.state===f.ENUM_PUBLISH_STATE.publishing&&(e.is_publishing=1);break}e.play_max_audio_bitrate=0;var r=function(t){var r={width:n.playerList[t].player.qualityHandler.lastPlayStats.frameWidth,height:n.playerList[t].player.qualityHandler.lastPlayStats.frameHeight};if(!r.height||!r.width){var i=n.playerList[t].player.playStream;r=i&&0!==i.getVideoTracks().length?i.getVideoTracks()[0].getSettings():void 0}var o={video_width:r&&r.width?r.width:0,video_height:r&&r.height?r.height:0,count:1};if(!e.play_stream_resolution_infos.find((function(e){return e.video_width==o.video_width&&e.video_height==o.video_height&&(e.count++,!0)}))&&e.play_stream_resolution_infos.push(o),0==o.video_width&&0==o.video_height){var s=1e3*n.playerList[t].player.qualityHandler.lastPlayStats.audioBitrate;s>e.play_max_audio_bitrate&&(e.play_max_audio_bitrate=s)}},n=this;for(var i in this.playerList)r(i);return 0!==e.play_stream_resolution_infos.length&&this.shouldReportNoPlaying&&(e.no_playing=0),0!==this.chargeInfos.timestamp_end?(this.chargeInfos.timestamp_diff=this.chargeInfos.timestamp_begin-this.chargeInfos.timestamp_end,this.chargeInfos.timestamp_diff_flag=1):(this.chargeInfos.timestamp_diff=0,this.chargeInfos.timestamp_diff_flag=0),this.chargeInfos.timestamp_end=(new Date).getTime(),this.chargeInfos.infos=[e],this.chargeInfos},t.prototype.getPublisher=function(e){var t=null;if("string"==typeof e&&this.publisherList[e]&&this.publisherList[e].publisher)t=this.publisherList[e].publisher;else if(e instanceof MediaStream){var r=this.checkPublish(e);r&&(t=null==r?void 0:r.publisher)}return t},t.prototype.getPreviewer=function(e){var t,r=null;return"string"==typeof e&&this.publisherList[e]&&this.publisherList[e].publisher?r=null===(t=this.publisherList[e].publisher)||void 0===t?void 0:t.previewer:e instanceof MediaStream&&(r=this.checkPreview(e)),r},t.prototype.checkPlayer=function(e){var t=Object.values(this.playerList).find((function(t){return t.player.playStream===e}));return(null==t?void 0:t.player)||null},t.prototype.checkPreview=function(e){for(var t=0;t<this.previewStreamList.length;t++)if(this.previewStreamList[t].localStream===e)return this.previewStreamList[t];return null},t.prototype.checkPublish=function(e){for(var t in this.publisherList)if(this.publisherList[t].localStream==e)return this.publisherList[t];return null},t.prototype.getPublishList=function(e){var t=[];for(var r in this.publisherList)this.publisherList[r].localStream==e&&t.push(this.publisherList[r]);return t},t.prototype.removePreview=function(e){for(var t=0;t<this.previewStreamList.length;t++)if(this.previewStreamList[t]===e){this.previewStreamList.splice(t,1);break}},t.prototype.onPlayerStreamUrlUpdate=function(e,t,r){},t.prototype.getScreenConstrains=function(e){var t={};if("boolean"==typeof e&&e)t={audio:!1,video:{frameRate:f.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate},bitRate:this.stateCenter.settingConfig.getSetting("screen_video_bitrate")||f.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate};else if("object"==typeof e){switch(e.videoQuality){case 1:t={video:{frameRate:f.ENUM_SCREEM_RESOLUTION_TYPE.LOW.frameRate},bitRate:f.ENUM_SCREEM_RESOLUTION_TYPE.LOW.bitRate};break;case 3:t={video:{frameRate:f.ENUM_SCREEM_RESOLUTION_TYPE.HIGH.frameRate},bitRate:f.ENUM_SCREEM_RESOLUTION_TYPE.HIGH.bitRate};break;case 4:t={video:{frameRate:e.frameRate,width:e.width,height:e.height},bitRate:e.bitRate};break;case 2:t={video:{frameRate:f.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate},bitRate:f.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate};break;default:t={video:{frameRate:f.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate},bitRate:this.stateCenter.settingConfig.getSetting("screen_video_bitrate")||f.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate}}t.audio="boolean"==typeof e.audio&&e.audio,t=o(o(o({},e),t),{width:void 0,height:void 0,frameRate:void 0})}return t},t.prototype.createScreenPreviewer=function(e,t){var r=new d.ZegoPreview(this.logger,this.ac,this.stateCenter,this,"screen"),n=e.getVideoTracks()[0].getSettings();return this.previewStreamList.push(r),r.mediaStreamConfig=t,e.getAudioTracks().length>0&&(r.audioTrack=e.getAudioTracks()[0]),r.localStream=e,r.videoInfo={width:n.width,height:n.height,frameRate:n.frameRate||15,bitRate:(null==t?void 0:t.bitRate)||1e3,startBitrate:(null==t?void 0:t.startBitrate)||this.stateCenter.settingConfig.getSetting("bitrate_mode"),minBitrate:null==t?void 0:t.minBitrate,keyFrameInterval:null==t?void 0:t.keyFrameInterval},r.previewSuc=!0,r.previewType="screen",(null==t?void 0:t.videoOptimizationMode)&&this.setVideoTrackContentHint(e,null==t?void 0:t.videoOptimizationMode),r},t.prototype.setSoundLevelDelegate=function(e,t,r){void 0===r&&(r=!1),this.logger.info("zsc.ssd.0 call"),t&&this.setSoundLevelInterval(t),this.soundLevelDelegate=e,this.enableInBackground=r,this.enableSoundLevelProcessor(e),e?(this.logger.info("zsc.ssd.0 start getting sound"),this.activeSoundLevel()):(this.logger.info("zsc.ssd.0 stop getting sound"),this.soundLevelTimer&&clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null,this.soundLevelInterval=1e3)},t.prototype.setSoundLevelInterval=function(e){var t,r;if(e&&this.soundLevelDelegate){for(var n in this.soundLevelInterval=e,this.previewStreamList)null===(t=this.previewStreamList[n].soundMeterWorklet)||void 0===t||t.setInterval(e);for(var n in this.playerList)null===(r=this.playerList[n].player.soundMeterWorklet)||void 0===r||r.setInterval(e)}},t.prototype.enableSoundLevelProcessor=function(e){for(var t in this.previewStreamList){var r=this.previewStreamList[t];e?r.startSoundLevel():r.stopSoundLevel()}for(var t in this.playerList){var n=this.playerList[t].player;e?n.startSoundLevel():n.stopSoundLevel()}},Object.defineProperty(t.prototype,"hasRemoteStream",{get:function(){return Object.keys(this.signalList).length>0},enumerable:!1,configurable:!0}),t.prototype.activeSoundLevel=function(){!this.soundLevelTimer&&this.soundLevelDelegate&&this.startSoundLevel()},t.prototype.startSoundLevel=function(){var e=this;this.soundLevelTimer&&(clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null),this.soundLevelDelegate&&(this.hasRemoteStream&&this.checkSoundLevel(),this.checkMicSoundLevel(),this.soundLevelTimer=setTimeout((function(){e.startSoundLevel()}),this.soundLevelInterval))},t.prototype.checkSoundLevel=function(){this.logger.debug("zsc.csl.0 call");var e=[];for(var t in this.publisherList){var r=0,n=this.publisherList[t].publisher,i=n.previewer;i&&(r=i.soundLevel),e.push({streamID:this.getBackStreamId(n.streamId),soundLevel:r,type:"push"})}for(var t in this.playerList){var o=this.playerList[t].player;o.streamId&&!o.isProbe&&e.push({streamID:this.getBackStreamId(o.streamId),soundLevel:o.soundLevel,type:"pull"})}this.soundLevelDelegate&&e.length>0&&this.onSoundLevelUpdate(e)},t.prototype.checkMicSoundLevel=function(){this.microphonePreviewStream&&this.soundLevelDelegate&&this.onMicSoundLevelUpdate(this.microphonePreviewStream.soundLevel)},t.prototype.getBackStreamId=function(e){return this.testEnvironment&&e?e.replace("zegotest-"+this.appid+"-",""):e},t.prototype.onSoundLevelUpdate=function(e){},t.prototype.onMicSoundLevelUpdate=function(e){},t.prototype.stopSoundLevel=function(){this.soundLevelTimer&&!this.hasRemoteStream&&0===this.previewStreamList.length&&(this.logger.info("zsc.ssl.0 stop"),clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null)},t.prototype.startNetProbe=function(e,t,r,n){var i=this,o=(0,l.getReportSeq)();if(this.dataReport.newReport(o,E.ZegoRTCLogEvent.kZegoNetProbe.event),this.isPeer)if(n){var s="zegoprobe-"+(new Date).getTime();this.setPlayStateStart(s);var a=this.playerList[s]?this.playerList[s].player:null;if(!a)return;a.isProbe=!0,this.playerList[s].serverUrls=["unified_l3"],this.startPlayingStream(s,!0,(function(){})),this.playerList[s].player.isProbeByDG=!0,a.onCalNetQualityResult=function(e,t){i.logger.info("zc.ocnqr.0 l3 detect "+e+" "+t),i.stopPlayingStream(s),i.l3DetectResult=t,i.l3DetectedTimestamp=(new Date).getTime()}}else{var c=!0;r&&0==r.length&&t&&(c=!1,r=e?this.publisherList[t.streamId].serverUrls:this.playerList[t.streamId].serverUrls),r&&t&&r.forEach((function(n){if(!(i.probeList[n]&&i.probeList[n].timeStamp+9e5<(new Date).getTime()||t.probeState==f.ENUM_PROBE_STATE.probed)){var s="zegoprobe-"+(new Date).getTime();i.setPlayStateStart(s);var a=i.playerList[s]?i.playerList[s].player:null;a&&(a.isProbe=!0,c?(a.gwNode=n,a.signal=t.signal,a.startPlay(s,(function(){}))):i.connectPlayServer(s,(function(){}),n),a.onCalNetQualityResult=function(c,u){i.logger.info("zc.ocnqr.0 "+a.gwNode+" "+c+" "+u),i.probeList[n]={result:c,netQuality:u,timeStamp:(new Date).getTime()};var l=Object.keys(i.probeList),d=r&&r.every((function(e){return l.findIndex((function(t){return t===e}))>=0}));t.gwNode==n||t.signal.server==n?t.netQuality=u:i.handleCalNetQualityResult(e,c,u,t,n,d),i.stopPlayingStream(s),i.dataReport.addMsgInfo(o,{netQuality:t.netQuality,nodeList:r}),i.dataReport.uploadReport(o)})}}))}else this.dataReport.uploadReport(o,void 0,{code:-1,message:"not support peer"})},t.prototype.handleCalNetQualityResult=function(e,t,r,n,i,o){if(this.logger.info("zc.hcqr.0 "+n.netQuality+" probe "+r+" "+i),0===t){var s=(0,l.getReportSeq)();this.dataReport.newReport(s,E.ZegoRTCLogEvent.kZegoNetProbeResult.event);var a=!1;r>Math.max(75,n.netQuality+20)&&n.probeState==f.ENUM_PROBE_STATE.tryProbe?(a=!0,this.retryStream(n,e,i),n.probeState=f.ENUM_PROBE_STATE.probed):(a=!1,n.probeState==f.ENUM_PROBE_STATE.tryProbe&&o&&n.netProbeToReDispatch(),this.logger.warn("zc.hcqr.0 "+n.netQuality+" probe "+r+" "+i)),this.dataReport.addMsgInfo(s,{isSwitch:a,isPublish:e,streamID:n.streamId,result:t,node:i,netQuality:n.netQuality,probeNetQuality:r}),this.dataReport.uploadReport(s)}},t.prototype.retryStream=function(e,t,r){if(t){var n=e,i=n.streamId,o=n.localStream,s=n.videoInfo,a=n.mediaStreamConfig,c=n.publishOption;0!=n.sessionId&&n.signal&&n.shouldSendCloseSession()&&(n.signal.sendCloseSession(this.stateCenter.getSeq(),n.sessionId,1),n.signal.removeSession(n.sessionId),n.closeSessionSignal=!0),n.resetPublish(),this.publisherList[i].isCenterNode?(n.gwNode=r,n.startPublish(i,o,s,a,c)):(n.isExternal=!1,this.connectPublishServer(i,r))}else{var u=e,l=(i=u.streamId,u.getRemoteStreamSuc),d=u.playOption;0!=u.sessionId&&u.signal&&u.shouldSendCloseSession()&&(u.signal.sendCloseSession(this.stateCenter.getSeq(),u.sessionId,1),u.signal.removeSession(u.sessionId),u.closeSessionSignal=!0),u.resetPlay(),this.playerList[i].isCenterNode?(u.gwNode=r,u.startPlay(i,l,d)):(u.isExternal=!1,this.connectPlayServer(i,l,r))}},t.prototype.getRoomByStreamID=function(e){return this.publisherList[e]?this.publisherList[e].room:this.playerList[e]?this.playerList[e].room:void 0},t.prototype.setVideoTrackContentHint=function(e,t){if("string"==typeof t){var r=t.toLowerCase();if(["default","motion","detail","text"].includes(r)){var n=e.getVideoTracks()[0];n?"contentHint"in n?(this.logger.info("zc.svtch "+r),n.contentHint="default"==r?"":r):this.logger.warn("zc.svtch mediaStreamTrack contentHint attribute not supported"):this.logger.warn("zc.svtch video track no found")}else this.logger.warn("zc.svtch videoOptimizationMode wrong")}else this.logger.warn("zc.svtch videoOptimizationMode type wrong")},t.prototype.getPlayRoom=function(e){return this.stateCenter.roomList.find((function(t){return!!t.streamList.find((function(t){return t.stream_id==e}))}))},t.prototype.getQualityHead=function(e,t){var r=new Uint8Array(12);r[0]=0,r[1]=12,r[2]=e.length>>8,r[3]=e.length-(r[2]<<8),r[4]=t.length>>24,r[5]=t.length-(r[4]<<24)>>16,r[6]=t.length-(r[4]<<24)-(r[5]<<16)>>8,r[7]=t.length-(r[4]<<24)-(r[5]<<16)-(r[6]<<8);var n=Math.ceil((new Date).getTime()/1e3);return r[8]=n>>24,r[9]=n-(r[8]<<24)>>16,r[10]=n-(r[8]<<24)-(r[9]<<16)>>8,r[11]=n-(r[8]<<24)-(r[9]<<16)-(r[10]<<8),r},t.prototype.streamQualityUpload=function(){var e,t=this;if(Object.keys(this.publisherList).length>0||Object.keys(this.playerList).length>0){var r={version:10,timestamp:this.qualityHeadTimestamp,event:0,app_id:this.stateCenter.appid,user_id:this.stateCenter.idName,biz_type:1,time_offset:T.default.MAX_VALUE,os_type:C.ClientUtil.getOsType(),sdk_version:f.PROTO_VERSION},n={publish_quality_infos:this.publishQualityInfos,play_quality_infos:this.playQualityInfos,client_type:2},i=S.logreport.SpeedLogHead.create(r),o=S.logreport.QualityEvent.create(n),c=S.logreport.SpeedLogHead.encode(i).finish(),u=S.logreport.QualityEvent.encode(o).finish(),l=this.getQualityHead(c,u),d=new Uint8Array(12+c.length+u.length);d.set(l),d.set(c,12),d.set(u,12+c.length);var h=null===(e=this.logger.url)||void 0===e?void 0:e.split("/")[2];if(!h)return;var p=function(){return new Promise((function(e){if(t.qualityWebsocket&&2!=t.qualityWebsocket.readyState&&3!=t.qualityWebsocket.readyState)1==t.qualityWebsocket.readyState&&e(t.qualityWebsocket);else{var r=t.stateCenter.appid,n=t.stateCenter.idName,i=t.stateCenter.roomList[0].token,o="wss://".concat(h,"/ws/report/stream?appid=").concat(r,"&product=rtc&token=").concat(encodeURIComponent(i),"&id_name=").concat(n);t.qualityWebsocket=new WebSocket(o),t.qualityWebsocket.onopen=function(){t.qualityWebsocket&&e(t.qualityWebsocket)},t.qualityWebsocket.onclose=function(){t.logger.info(b.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" speed log socket close")}}}))};p().then((function(e){var r=Date.now()%1e4,n=!1;e.onmessage=function(i){(i.data+"").includes("success")&&(t.logger.info(b.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" quality (".concat(r,") upload success")),n=!0),e.onmessage=null},setTimeout((function(){return s(t,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return n?[3,2]:[4,p()];case 1:e.sent().send(d),this.logger.info(b.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" retry upload quality (".concat(r,"), length: ")+d.length+"."),e.label=2;case 2:return[2]}}))}))}),3e3),e.send(d),t.logger.info(b.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" upload quality (".concat(r,"), length: ")+d.length+".")}))}},t.prototype.updateQuality=function(e,t){var r=this,n=(new Date).getTime(),i=JSON.stringify(this.publishQualityInfos).length+JSON.stringify(this.playQualityInfos).length;0!==this.qualityUploadTimestamp&&n-this.qualityUploadTimestamp>6e4||i>8e3?(this.publishQualityInfos.forEach((function(e){return e.timestamp_offset_end=Math.round(n/1e3)-r.qualityHeadTimestamp})),this.playQualityInfos.forEach((function(e){return e.timestamp_offset_end=Math.round(n/1e3)-r.qualityHeadTimestamp})),this.streamQualityUpload(),this.publishQualityInfos=[],this.playQualityInfos=[],this.qualityHeadTimestamp=Math.round((new Date).getTime()/1e3),this.qualityUploadTimestamp=n):0==this.qualityHeadTimestamp&&(this.qualityHeadTimestamp=Math.round((new Date).getTime()/1e3),this.qualityUploadTimestamp=n),0==e?this.handlePublishQualityData(t):this.handlePlayQualityData(t)},t.prototype.handlePublishQualityData=function(e){var t=this.publishQualityInfos.find((function(t){return t.stream_id==e.stream_id&&t.video_width==e.frameWidth&&t.video_height==e.frameHeight}));if(!t){var r=this.getRoomByStreamID(e.stream_id);t={timestamp_offset_begin:Math.abs(Number(e.timeStamp-this.qualityHeadTimestamp)),timestamp_offset_end:0,stream_id:e.stream_id,session_id:r?Number(r.sessionID):0,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:r?r.roomID:"",evnvironment:1,room_session_id:r?Number(r.roomSessionID):0,resource_type:2},this.publishQualityInfos.push(t)}t.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_capture_fps:Math.round(10*e.videoFPS)||0,video_network_fps:Math.round(10*e.videoTransferFPS)||0,uplink_plr:e.audioPacketsLostRate,rtt:Math.round(1e3*e.currentRoundTripTime)||0,audio_network_fps:Math.round(10*e.audioFPS),captured_sound_level:Math.round(e.audioLevel),sample_time_window:Math.round(e.sampleTimeWindow/10)})},t.prototype.handlePlayQualityData=function(e){var t,r=this.playQualityInfos.find((function(t){return t.stream_id==e.stream_id&&t.video_width==e.frameWidth&&t.video_height==e.frameHeight}));if(!r){var n=this.getRoomByStreamID(e.stream_id),i=null===(t=this.playerList[e.stream_id])||void 0===t?void 0:t.player;r={timestamp_offset_begin:Math.abs(Number(e.timeStamp-this.qualityHeadTimestamp)),timestamp_offset_end:0,stream_id:e.stream_id,session_id:n?Number(n.sessionID):0,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:n?n.roomID:"",room_session_id:n?Number(n.roomSessionID):0,resource_type:0===(null==i?void 0:i.resourceMode)?2:3},this.playQualityInfos.push(r)}r.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_network_fps:Math.round(10*e.videoFPS)||0,downlink_plr:Math.round(e.audioPacketsLostRate)||0,audio_network_fps:Math.round(10*e.audioFPS)||0,audio_break_duration:Math.round(e.audio_break_duration/10),video_break_duration:Math.round(e.video_break_duration/10),rtt:Math.round(1e3*e.currentRoundTripTime)||0,rendered_sound_level:Math.round(e.audioLevel),audio_break_cancel_duration:Math.round(e.audio_break_cancel_duration/10),video_break_cancel_duration:Math.round(e.video_break_cancel_duration/10),audio_decode_time:Math.round(e.audio_decode_time/10),video_decode_time:Math.round(e.video_decode_time/10),real_sampling_interval:Math.round(e.real_sampling_interval/10),video_frames_decoded:Math.round(e.videoFramesDecoded)||0,video_frames_dropped:Math.round(e.videoFramesDropped)||0,sample_time_window:Math.round(e.sampleTimeWindow/10),peer_to_peer_plr:e.peerToPeerPacketLostRate,peer_to_peer_delay:e.peerToPeerDelay})},t.prototype.setIsPeer=function(e){this.isPeer=e,Object.values(this.publisherList).forEach((function(t){t.publisher.isPeer=e})),Object.values(this.playerList).forEach((function(t){t.player.isPeer=e}))},t.prototype.getCDNUrl=function(e,t){var r,n,i=this.stateCenter.appConfig.media_config.play_config.resource_info;if(i.length)for(var o=i.find((function(e){return e.resource_type==t})),s=0;s<o.service_info.length;s++){var a=o.service_info[s],c=a.protocol,u=a.url_template.replace("{STREAM_NAME}",e);switch(c){case l.ProtocolType.FLV:r=u;break;case l.ProtocolType.HLS:n=u}}return{flv:r,hls:n}},t.prototype.playCDN=function(e,t,r,n){var i,o=this;if(!t.CDNVideo)return this.logger.error("zsc.pc.1 cdn video no found"),n&&n(),!1;var s=(0,l.getReportSeq)();this.dataReport.newReport(s,E.ZegoRTCLogEvent.kZegoTaskCDNPlay.event);var a="",c=null===(i=this.getPlayRoom(e))||void 0===i?void 0:i.streamList.find((function(t){return t.stream_id==e})),u=this.playerList[e],d=u.cdnPlayer,h=u.playOption.resourceMode;u.player.streamId=e,u.player.playOption=u.playOption,u.player.tryidx++,this.dataReport.addMsgInfo(s,{tryidx:E.ZegoRTCLogEvent.kZegoTaskCDNPlay.protocol(u.player.tryidx),biz_product:E.ZegoRTCLogEvent.kZegoTaskCDNPlay.protocol(h==l.ResourceMode.DG?1:0)});var p=c||{},g=p.urls_flv,m=p.urls_flv_plus,_=p.urls_m3u8,v=p.urls_m3u8_plus;if(!c){if(!this.stateCenter.appConfig||!h)return this.logger.error("zsc.pss.1 stream info no found"),n&&n(),!1;var y=this.getCDNUrl(e,h),S=y.flv,b=y.hls;h==l.ResourceMode.DG?(m=S?[S]:[],v=b?[b]:[]):(g=S?[S]:[],_=b?[b]:[])}if(!u||!d)return n&&n(),!1;h===l.ResourceMode.DG&&(u.player.useResourceTypes.push("CDN"),u.player.useResourceTypes=Array.from(new Set(u.player.useResourceTypes)));var T=h==l.ResourceMode.DG?m:g,C=h==l.ResourceMode.DG?v:_;if(d.isSupportFLV()&&(null==T?void 0:T.length)>0)a=T[0],this.dataReport.addMsgInfo(s,{protocol:E.ZegoRTCLogEvent.kZegoTaskCDNPlay.protocol("flv")});else if(d.isSupportHLS()&&(null==C?void 0:C.length)>0)a=C[0],this.dataReport.addMsgInfo(s,{protocol:E.ZegoRTCLogEvent.kZegoTaskCDNPlay.protocol("hls")});else if(!u.cdnUrl)return this.logger.error("zsc.pc.1 can not find cdn plus urls"),n&&n(),!1;if((a=a.replace("http://","https://"))!==u.cdnUrl&&u.player.tryidx>1){var R=(0,l.getReportSeq)();this.dataReport.newReport(R,E.ZegoRTCLogEvent.kZegoTaskSrcChange.event),this.dataReport.addMsgInfo(R,{src:E.ZegoRTCLogEvent.kZegoTaskSrcChange.src(a),last_src:E.ZegoRTCLogEvent.kZegoTaskSrcChange.src(u.cdnUrl)}),this.dataReport.uploadReport(R)}return u.cdnUrl=a||u.cdnUrl,this.dataReport.addMsgInfo(s,{url:E.ZegoRTCLogEvent.kZegoTaskCDNPlay.url(u.cdnUrl)}),this.dataReport.uploadReport(s),u.playMode==l.PlayMode.CDN&&(d.play(u.cdnUrl,t.CDNVideo),t.CDNVideo.srcObject=null,this.onPlayStateUpdate(f.ENUM_PLAY_STATE_UPDATE.start,e,{code:0,message:"success"}),d.onQualityUpdate=function(r,n){n<=o.cdnBadQualityScore?o.handleQualityBad(e,t.resourceMode,l.PlayMode.CDN):(u.qualityBadCount=0,o.cdnProtocolBadTimestamp=0,o.lastHandleCDNBadTimestamp=0)},d.onComplete=function(){if(u.playMode==l.PlayMode.CDN&&u.player.state==f.ENUM_PLAY_STATE.playing)d.retry();else var e=u.player,t=e.initPoster,r=e.initVideoStyle,n=u.playOption.CDNVideo,i=setTimeout((function(){clearTimeout(i),n&&n.setAttribute("style",r),n&&n.setAttribute("poster",t)}),1e3)},d.onError=function(e){o.stateCenter.networkState==l.ENUM_NETWORK_STATE.offline&&(d.canRetry=!1),o.dataReport.addMsgInfo(s,{stop_reason:E.ZegoRTCLogEvent.kZegoTaskCDNPlay.protocol(e)}),o.logger.error(e),o.dataReport.uploadReport(s)},d.onCanplay=function(){if(u.player.state!=f.ENUM_PLAY_STATE.playing&&(u.player.state=f.ENUM_PLAY_STATE.playing,0==u.player.firstFrameTime)){u.player.firstFrameTime=Date.now()-u.player.beginTime;var e=(0,l.getReportSeq)();o.dataReport.newReport(e,E.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.event),o.dataReport.addMsgInfo(e,{session_id:E.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.session_id(u.player.sessionId),fft_consumed:E.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.fft_consumed(u.player.firstFrameTime),biz_product:E.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.biz_product(t.resourceMode==l.ResourceMode.DG?1:0)}),o.dataReport.uploadReport(e)}},r&&r(),!0)},t.prototype.handleQualityBad=function(e,t,r){var n=this;if(this.logger.info("zsc.hqb.0 call ".concat(e," ").concat(t," ").concat(r)),t!==l.ResourceMode.DG)return!1;this.fetchL3CDNCloudSetting();var i=(new Date).getTime(),o=0;for(var s in this.playerList)this.playerList[s].isQualityBad&&o++;r==l.PlayMode.CDN?(this.cdnProtocolBadTime=this.cdnProtocolBadTime+(0==this.lastHandleCDNBadTimestamp?this.qualityInterval:i-this.lastHandleCDNBadTimestamp),(o>=this.protocolBadQualityCount||this.cdnProtocolBadTime>=this.protocolBadQualityTime)&&(this.cdnProtocolBadTime=0,this.cdnProtocolBadTimestamp=(new Date).getTime())):r==l.PlayMode.L3&&(this.l3ProtocolBadTime=this.l3ProtocolBadTime+(0==this.lastHandleL3BadTimestamp?this.qualityInterval:i-this.lastHandleL3BadTimestamp),(o>=this.protocolBadQualityCount||this.l3ProtocolBadTime>=this.protocolBadQualityTime)&&(this.l3ProtocolBadTime=0,this.l3ProtocolBadTimestamp=(new Date).getTime()));var a=!1,c=this.playerList[e],u=c.qualityBadCount?c.qualityBadCount*this.qualityInterval:0;if((r==l.PlayMode.L3&&u>this.l3BadQualityTime||r==l.PlayMode.CDN&&this.isL3Fallback&&u>this.fallbackInhibitionTime||r==l.PlayMode.CDN&&!this.isL3Fallback&&u>this.defaultBadQualityTime)&&(a=!0),a){for(var d in c.isQualityBad=!0,o=0,this.playerList)this.playerList[d].isQualityBad&&o++;if(r==l.PlayMode.CDN&&(0==this.l3DetectedTimestamp||this.l3DetectedTimestamp+this.probeExpiredTime<i&&this.l3DetectedTimestamp+this.minProbeInterval<i)&&(this.l3DetectedTimestamp=(new Date).getTime(),this.startNetProbe(!1,void 0,void 0,!0)),o/Object.keys(this.playerList).filter((function(e){return!e.includes("zegoprobe")})).length>this.multiPlaySwitchRate){this.logger.error("zsc.hqb.0 low quality "+(0==r?"CDN":"L3"));var h=Object.keys(this.playerList).filter((function(e){return!e.includes("zegoprobe")}));return h.forEach((function(e,t){var i=n.playerList[e];r==l.PlayMode.L3?(n.stopPlayingStream(e),n.playerList[e]=i,i.isQualityBad=!1,i.playMode=l.PlayMode.CDN,i.qualityBadCount=0,n.playCDN(e,i.playOption,n.playSuccessCallBackList[e],n.playErrorCallBackList[e])):n.l3DetectResult>n.switchDetectResultScore&&(i.qualityBadCount=0,n.l3DetectedTimestamp=0,t==h.length-1&&(n.l3DetectResult=0),n.cdnSwitchL3(i))})),r==l.PlayMode.L3&&(this.isL3Fallback=!0),!0}}return"number"==typeof c.qualityBadCount?c.qualityBadCount++:c.qualityBadCount=1,!1},t.prototype.cdnSwitchL3=function(e){var t,r=this,n=e.streamID,i=this.stateCenter.useNetAgent;if(e.playMode=l.PlayMode.L3,this.stopPlayingStream(n),this.playerList[n]=e,e.isQualityBad=!1,(null===(t=e.playOption)||void 0===t?void 0:t.resourceMode)==l.ResourceMode.DG&&(e.player.useResourceTypes.push("L3"),e.player.useResourceTypes=Array.from(new Set(e.player.useResourceTypes))),i)this.stateCenter.appConfig?(e.serverUrls=["unified_l3"],this.startPlayingStream(n,i,(function(t){var n;r.logger.info("zsc.cqi.1 switch l3 success");var i=e.player,o=i.initPoster,s=i.initVideoStyle,a=e.playOption.CDNVideo;if("safari"===r.stateCenter.browser&&a&&e.player._CDNPlayerClone){var c=a.parentElement;if(c){var u=document.createElement("style"),l=a.cloneNode(!0),d=Date.now().toString(16);u.innerText=".zego_cdn_video_".concat(d," .zego_clone_video_").concat(d,"{width:").concat(a.offsetWidth,"px;height:").concat(a.offsetHeight,"px;}")+".zego_cdn_video_".concat(d," .hide_").concat(d,"{display:none!important;width:0;height:0}"),document.head.append(u),l.classList.add("zego_clone_video_".concat(d)),l.id=e.streamID+"_clone",l.src="",l.srcObject=t,l.classList.add("hide_".concat(d)),a.before(l),c.classList.add("zego_cdn_video_".concat(d));var h=setTimeout((function(){clearTimeout(h),a.classList.add("hide_".concat(d)),l.classList.remove("hide_".concat(d))}),2e3),p=setTimeout((function(){var t;clearTimeout(p),e.playOption.CDNVideo=l,null===(t=e.cdnPlayer)||void 0===t||t.stop(),c.classList.remove("zego_cdn_video_".concat(d)),a.classList.remove("zego_cdn_video_".concat(d)),l.classList.remove("zego_clone_video_".concat(d)),l.id=a.id,u.remove(),a.remove()}),4e3)}}else{null===(n=e.cdnPlayer)||void 0===n||n.stop();var f=setTimeout((function(){clearTimeout(f),a&&a.setAttribute("style",s),a&&a.setAttribute("poster",o)}),1e3);t&&(null==a||(a.srcObject=t))}}))):this.waitPlayList.push(n);else{var o=this.playerList[n].retryDispatchHandler;o.stopMaxTime(),o.invalid(),o.initStream(n,e.playOption,!1),o.startMaxTime(),o.active(0)}},t.prototype.fetchL3CDNCloudSetting=function(){this.switchScore=this.stateCenter.settingConfig.getSetting("switch_score")||60,this.defaultBadQualityTime=this.stateCenter.settingConfig.getSetting("default_bad_quality_time")||3e4,this.l3BadQualityTime=this.stateCenter.settingConfig.getSetting("l3_bad_quality_time")||1e4,this.switchDetectResultScore=this.stateCenter.settingConfig.getSetting("switch_detect_result_score")||60,this.cdnBadQualityScore=this.stateCenter.settingConfig.getSetting("cdn_bad_quality_score")||60,this.l3BadQualityScore=this.stateCenter.settingConfig.getSetting("l3_bad_quality_score")||60,this.multiPlaySwitchRate=this.stateCenter.settingConfig.getSetting("multi_play_switch_rate")||.8,this.protocolBadQualityCount=this.stateCenter.settingConfig.getSetting("protocol_bad_quality_count")||3,this.protocolBadQualityTime=this.stateCenter.settingConfig.getSetting("protocol_bad_quality_time")||12e3,this.protocolQualityCacheExpiredTime=this.stateCenter.settingConfig.getSetting("protocol_quality_cache_expired_time\t")||18e4,this.fallbackInhibitionTime=this.stateCenter.settingConfig.getSetting("fallback_inhibition_time")||18e4,this.probeExpiredTime=this.stateCenter.settingConfig.getSetting("probe_expired_time")||3e4,this.minProbeInterval=this.stateCenter.settingConfig.getSetting("min_probe_interval")||15e3},t.prototype.setStreamGwNode=function(e,t){this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_SET_STREAM_GW_NODE+" call "+e.streamId),this.checkCachedNodesUse(e,t),e.gwNodesTTL&&e.gwNodesTTL<(new Date).getTime()&&(this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_SET_STREAM_GW_NODE+" call "+e.streamId+" ttl timeout, reset gw"),e.gwNode="",e.gwNodeList=[],e.gwNodesTTL=0),this.gwNode&&(e.gwNode=this.gwNode);var r=this.stateCenter.settingConfig.getSetting("gw_nodes");r&&r instanceof Array&&r.length>0&&(this.logger.info(b.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting "+JSON.stringify(r)),e.gwNodeList=r,e.gwNode=e.gwNodeList[0]||e.gwNode),this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_SET_STREAM_GW_NODE+" end "+e.streamId+" "+e.gwNode)},t.prototype.getNodeIndex=function(e,t){var r="",n=t?"publish":"play";switch(e.cachedGwNodesMode){case u.NotReUse:break;case u.TheSameReUse:r=n+"_"+e.streamId;break;case u.DiffReUse:r=n;break;case u.AllReUse:r="stream"}return r},t.prototype.checkCachedNodesUse=function(e,t){if(this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CHECK_CACHED_NODES_USE+" call "+e.streamId+" "+e.cachedGwNodesMode),e.isExternal)if(t&&e.isCustomCdn())this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CHECK_CACHED_NODES_USE+" call "+e.streamId+" custom cdn");else if(this.stateCenter.useNetAgent&&this.stateCenter.isMultiOuter)this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CHECK_CACHED_NODES_USE+" call "+e.streamId+" multi outer");else{var r=this.getNodeIndex(e,t);if(this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CHECK_CACHED_NODES_USE+" "+e.streamId+" "+r),r){var n=this.cachedGwNodesList[r];n&&n.gwNodesTTL>(new Date).getTime()&&(null==n?void 0:n.gwNodes.length)>0&&(this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CHECK_CACHED_NODES_USE+" "+e.streamId+" use cache gwnodes"),e.gwNodeList=n.gwNodes,e.gwNodesTTL=n.gwNodesTTL,e.gwNode=e.gwNodeList[0])}this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CHECK_CACHED_NODES_USE+" end "+e.streamId+" "+e.gwNode)}else this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CHECK_CACHED_NODES_USE+" "+e.streamId+" retry internal")},t.prototype.updateCachedGwNodesList=function(e,t,r,n){if(this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_UPDATE_CACHED_GWNODES_LIST+" call "+e.streamId),0===n)this.setCachedGwNodesMode(u.NotReUse);else if(n>0){var i=this.getNodeIndex(e,t);this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_UPDATE_CACHED_GWNODES_LIST+" "+e.streamId+" nodeIndex "+i),i&&(this.cachedGwNodesList[i]={gwNodes:r,gwNodesTTL:(new Date).getTime()+1e3*n})}},t.prototype.clearCachedGwNodesList=function(e,t){var r=this.getNodeIndex(e,t);this.logger.info(b.ZEGO_WEBRTC_ACTION.STREAMCENTER_CLEAR_CACHED_GWNODES_LIST+" "+e.streamId+" nodeIndex "+r),r&&delete this.cachedGwNodesList[r]},t.prototype.setCachedGwNodesMode=function(e){this.cachedGwNodesMode=e,Object.values(this.publisherList).forEach((function(t){t.publisher.cachedGwNodesMode=e})),Object.values(this.playerList).forEach((function(t){t.player.cachedGwNodesMode=e}))},t}(p.ZegoStreamCenter);t.ZegoStreamCenterWeb=R},2990:function(e,t,r){"use strict";var n,i=r(2100),o=i.Writer,s=i.util,a=i.roots.default||(i.roots.default={});a.logreport=((n={}).SpeedLogHead=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.version=0,e.prototype.signature=s.newBuffer([]),e.prototype.timestamp=0,e.prototype.event=0,e.prototype.app_id=0,e.prototype.user_id="",e.prototype.biz_type=0,e.prototype.device_id="",e.prototype.lite_sign=s.newBuffer([]),e.prototype.token=s.newBuffer([]),e.prototype.os_type="",e.prototype.sdk_version="",e.prototype.time_offset=s.Long?s.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(18).bytes(e.signature),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).uint32(e.timestamp),null!=e.event&&Object.hasOwnProperty.call(e,"event")&&t.uint32(32).uint32(e.event),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(40).uint32(e.app_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(50).string(e.user_id),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(56).uint32(e.biz_type),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(66).string(e.device_id),null!=e.lite_sign&&Object.hasOwnProperty.call(e,"lite_sign")&&t.uint32(74).bytes(e.lite_sign),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(82).bytes(e.token),null!=e.os_type&&Object.hasOwnProperty.call(e,"os_type")&&t.uint32(90).string(e.os_type),null!=e.sdk_version&&Object.hasOwnProperty.call(e,"sdk_version")&&t.uint32(98).string(e.sdk_version),null!=e.time_offset&&Object.hasOwnProperty.call(e,"time_offset")&&t.uint32(104).int64(e.time_offset),t},e.ProtoVersion=(t={},(r=Object.create(t))[t[0]="PROTO_VERSION"]=0,r[t[1]="PROTO_VERSION1"]=1,r[t[2]="PROTO_VERSION2"]=2,r[t[3]="PROTO_VERSION3"]=3,r[t[4]="PROTO_VERSION4"]=4,r[t[5]="PROTO_VERSION5"]=5,r[t[6]="PROTO_VERSION6"]=6,r[t[7]="PROTO_VERSION7"]=7,r[t[8]="PROTO_VERSION8"]=8,r[t[9]="PROTO_VERSION9"]=9,r[t[10]="PROTO_VERSION10"]=10,r),e.Event=function(){var e={},t=Object.create(e);return t[e[0]="QUALITY_EVENT"]=0,t[e[100]="NO_BILLING_EVENT"]=100,t[e[300]="DETECT_QUALITY_EVENT"]=300,t}(),e.BizType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="LIVE"]=1,t[e[2]="RTV"]=2,t}(),e}(),n.SpeedLogRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.code=0,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e}(),n.QualityEvent=function(){function e(e){if(this.publish_quality_infos=[],this.play_quality_infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.hardware_infos=null,e.prototype.publish_quality_infos=s.emptyArray,e.prototype.play_quality_infos=s.emptyArray,e.prototype.network_type=0,e.prototype.charge_infos=null,e.prototype.client_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.hardware_infos&&Object.hasOwnProperty.call(e,"hardware_infos")&&a.logreport.HardwareInfos.encode(e.hardware_infos,t.uint32(10).fork()).ldelim(),null!=e.publish_quality_infos&&e.publish_quality_infos.length)for(var r=0;r<e.publish_quality_infos.length;++r)a.logreport.PublishQualityInfos.encode(e.publish_quality_infos[r],t.uint32(18).fork()).ldelim();if(null!=e.play_quality_infos&&e.play_quality_infos.length)for(r=0;r<e.play_quality_infos.length;++r)a.logreport.PlayQualityInfos.encode(e.play_quality_infos[r],t.uint32(26).fork()).ldelim();return null!=e.network_type&&Object.hasOwnProperty.call(e,"network_type")&&t.uint32(32).uint32(e.network_type),null!=e.charge_infos&&Object.hasOwnProperty.call(e,"charge_infos")&&a.logreport.ChargeInfos.encode(e.charge_infos,t.uint32(42).fork()).ldelim(),null!=e.client_type&&Object.hasOwnProperty.call(e,"client_type")&&t.uint32(800).uint32(e.client_type),t},e.ResourceType=(t={},(r=Object.create(t))[t[0]="UNKNOWN"]=0,r[t[1]="CDN"]=1,r[t[2]="RTC"]=2,r[t[3]="L3"]=3,r),e}(),n.HardwareInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.infos=s.emptyArray,e.prototype.sys_mem_total=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)a.logreport.HardwareInfo.encode(e.infos[r],t.uint32(26).fork()).ldelim();return null!=e.sys_mem_total&&Object.hasOwnProperty.call(e,"sys_mem_total")&&t.uint32(32).uint32(e.sys_mem_total),t},e}(),n.PublishQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.stream_id="",e.prototype.session_id=0,e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.ipv4=0,e.prototype.ipv6="",e.prototype.resource_type=0,e.prototype.infos=s.emptyArray,e.prototype.room_id="",e.prototype.evnvironment=0,e.prototype.ap="",e.prototype.session="",e.prototype.room_session_id=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.protocol_type=0,e.prototype.setting_video_bitrate=0,e.prototype.setting_audio_bitrate=0,e.prototype.setting_video_fps=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).string(e.stream_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(32).uint32(e.session_id),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(40).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(48).uint32(e.video_height),null!=e.ipv4&&Object.hasOwnProperty.call(e,"ipv4")&&t.uint32(56).uint32(e.ipv4),null!=e.ipv6&&Object.hasOwnProperty.call(e,"ipv6")&&t.uint32(66).string(e.ipv6),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(72).uint32(e.resource_type),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)a.logreport.PublishQualityInfo.encode(e.infos[r],t.uint32(82).fork()).ldelim();return null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(90).string(e.room_id),null!=e.evnvironment&&Object.hasOwnProperty.call(e,"evnvironment")&&t.uint32(104).uint32(e.evnvironment),null!=e.ap&&Object.hasOwnProperty.call(e,"ap")&&t.uint32(114).string(e.ap),null!=e.session&&Object.hasOwnProperty.call(e,"session")&&t.uint32(122).string(e.session),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(128).uint64(e.room_session_id),null!=e.protocol_type&&Object.hasOwnProperty.call(e,"protocol_type")&&t.uint32(136).uint32(e.protocol_type),null!=e.setting_video_bitrate&&Object.hasOwnProperty.call(e,"setting_video_bitrate")&&t.uint32(144).uint32(e.setting_video_bitrate),null!=e.setting_audio_bitrate&&Object.hasOwnProperty.call(e,"setting_audio_bitrate")&&t.uint32(152).uint32(e.setting_audio_bitrate),null!=e.setting_video_fps&&Object.hasOwnProperty.call(e,"setting_video_fps")&&t.uint32(160).uint32(e.setting_video_fps),t},e}(),n.PlayQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.stream_id="",e.prototype.session_id=0,e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.ipv4=0,e.prototype.ipv6="",e.prototype.resource_type=0,e.prototype.infos=s.emptyArray,e.prototype.room_id="",e.prototype.session="",e.prototype.room_session_id=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.protocol_type=0,e.prototype.product=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).string(e.stream_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(32).uint32(e.session_id),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(40).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(48).uint32(e.video_height),null!=e.ipv4&&Object.hasOwnProperty.call(e,"ipv4")&&t.uint32(56).uint32(e.ipv4),null!=e.ipv6&&Object.hasOwnProperty.call(e,"ipv6")&&t.uint32(66).string(e.ipv6),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(72).uint32(e.resource_type),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)a.logreport.PlayQualityInfo.encode(e.infos[r],t.uint32(82).fork()).ldelim();return null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(90).string(e.room_id),null!=e.session&&Object.hasOwnProperty.call(e,"session")&&t.uint32(106).string(e.session),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(112).uint64(e.room_session_id),null!=e.protocol_type&&Object.hasOwnProperty.call(e,"protocol_type")&&t.uint32(120).uint32(e.protocol_type),null!=e.product&&Object.hasOwnProperty.call(e,"product")&&t.uint32(128).uint32(e.product),t},e}(),n.ChargeInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.timestamp_diff_flag=0,e.prototype.timestamp_diff=0,e.prototype.room_id="",e.prototype.infos=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.timestamp_diff_flag&&Object.hasOwnProperty.call(e,"timestamp_diff_flag")&&t.uint32(24).uint32(e.timestamp_diff_flag),null!=e.timestamp_diff&&Object.hasOwnProperty.call(e,"timestamp_diff")&&t.uint32(32).uint32(e.timestamp_diff),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(42).string(e.room_id),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)a.logreport.ChargeInfo.encode(e.infos[r],t.uint32(802).fork()).ldelim();return t},e}(),n.HardwareInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sys_cpu_used=0,e.prototype.app_cpu_used=0,e.prototype.sys_mem_used=0,e.prototype.app_mem_used=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.sys_cpu_used&&Object.hasOwnProperty.call(e,"sys_cpu_used")&&t.uint32(8).uint32(e.sys_cpu_used),null!=e.app_cpu_used&&Object.hasOwnProperty.call(e,"app_cpu_used")&&t.uint32(16).uint32(e.app_cpu_used),null!=e.sys_mem_used&&Object.hasOwnProperty.call(e,"sys_mem_used")&&t.uint32(24).uint32(e.sys_mem_used),null!=e.app_mem_used&&Object.hasOwnProperty.call(e,"app_mem_used")&&t.uint32(32).uint32(e.app_mem_used),t},e}(),n.PublishQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.audio_bitrate=0,e.prototype.video_bitrate=0,e.prototype.video_capture_fps=0,e.prototype.video_network_fps=0,e.prototype.uplink_plr=0,e.prototype.rtt=0,e.prototype.audio_network_fps=0,e.prototype.captured_sound_level=0,e.prototype.quality=0,e.prototype.sample_time_window=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.audio_bitrate&&Object.hasOwnProperty.call(e,"audio_bitrate")&&t.uint32(8).uint32(e.audio_bitrate),null!=e.video_bitrate&&Object.hasOwnProperty.call(e,"video_bitrate")&&t.uint32(16).uint32(e.video_bitrate),null!=e.video_capture_fps&&Object.hasOwnProperty.call(e,"video_capture_fps")&&t.uint32(24).uint32(e.video_capture_fps),null!=e.video_network_fps&&Object.hasOwnProperty.call(e,"video_network_fps")&&t.uint32(32).uint32(e.video_network_fps),null!=e.uplink_plr&&Object.hasOwnProperty.call(e,"uplink_plr")&&t.uint32(40).uint32(e.uplink_plr),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(48).uint32(e.rtt),null!=e.audio_network_fps&&Object.hasOwnProperty.call(e,"audio_network_fps")&&t.uint32(56).uint32(e.audio_network_fps),null!=e.captured_sound_level&&Object.hasOwnProperty.call(e,"captured_sound_level")&&t.uint32(64).uint32(e.captured_sound_level),null!=e.quality&&Object.hasOwnProperty.call(e,"quality")&&t.uint32(72).uint32(e.quality),null!=e.sample_time_window&&Object.hasOwnProperty.call(e,"sample_time_window")&&t.uint32(800).uint32(e.sample_time_window),t},e}(),n.PlayQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.audio_bitrate=0,e.prototype.video_bitrate=0,e.prototype.video_network_fps=0,e.prototype.audio_break_count=0,e.prototype.video_break_count=0,e.prototype.downlink_plr=0,e.prototype.peer_to_peer_plr=0,e.prototype.peer_to_peer_delay=0,e.prototype.audio_network_fps=0,e.prototype.audio_break_duration=0,e.prototype.video_break_duration=0,e.prototype.audio_break_rate=0,e.prototype.video_break_rate=0,e.prototype.audio_break_cancel=0,e.prototype.video_break_cancel=0,e.prototype.rtt=0,e.prototype.rendered_sound_level=0,e.prototype.audio_break_cancel_duration=0,e.prototype.video_break_cancel_duration=0,e.prototype.audio_decode_time=0,e.prototype.video_decode_time=0,e.prototype.real_sampling_interval=0,e.prototype.mos=0,e.prototype.audio_decode_fps=0,e.prototype.video_decode_fps=0,e.prototype.video_frames_decoded=0,e.prototype.video_frames_dropped=0,e.prototype.quality=0,e.prototype.evaluation_quality=0,e.prototype.break_stat_duration=0,e.prototype.sample_time_window=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.audio_bitrate&&Object.hasOwnProperty.call(e,"audio_bitrate")&&t.uint32(8).uint32(e.audio_bitrate),null!=e.video_bitrate&&Object.hasOwnProperty.call(e,"video_bitrate")&&t.uint32(16).uint32(e.video_bitrate),null!=e.video_network_fps&&Object.hasOwnProperty.call(e,"video_network_fps")&&t.uint32(24).uint32(e.video_network_fps),null!=e.audio_break_count&&Object.hasOwnProperty.call(e,"audio_break_count")&&t.uint32(32).uint32(e.audio_break_count),null!=e.video_break_count&&Object.hasOwnProperty.call(e,"video_break_count")&&t.uint32(40).uint32(e.video_break_count),null!=e.downlink_plr&&Object.hasOwnProperty.call(e,"downlink_plr")&&t.uint32(48).uint32(e.downlink_plr),null!=e.peer_to_peer_plr&&Object.hasOwnProperty.call(e,"peer_to_peer_plr")&&t.uint32(56).uint32(e.peer_to_peer_plr),null!=e.peer_to_peer_delay&&Object.hasOwnProperty.call(e,"peer_to_peer_delay")&&t.uint32(64).uint32(e.peer_to_peer_delay),null!=e.audio_network_fps&&Object.hasOwnProperty.call(e,"audio_network_fps")&&t.uint32(72).uint32(e.audio_network_fps),null!=e.audio_break_duration&&Object.hasOwnProperty.call(e,"audio_break_duration")&&t.uint32(80).uint32(e.audio_break_duration),null!=e.video_break_duration&&Object.hasOwnProperty.call(e,"video_break_duration")&&t.uint32(88).uint32(e.video_break_duration),null!=e.audio_break_rate&&Object.hasOwnProperty.call(e,"audio_break_rate")&&t.uint32(96).uint32(e.audio_break_rate),null!=e.video_break_rate&&Object.hasOwnProperty.call(e,"video_break_rate")&&t.uint32(104).uint32(e.video_break_rate),null!=e.audio_break_cancel&&Object.hasOwnProperty.call(e,"audio_break_cancel")&&t.uint32(112).uint32(e.audio_break_cancel),null!=e.video_break_cancel&&Object.hasOwnProperty.call(e,"video_break_cancel")&&t.uint32(120).uint32(e.video_break_cancel),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(128).uint32(e.rtt),null!=e.rendered_sound_level&&Object.hasOwnProperty.call(e,"rendered_sound_level")&&t.uint32(136).uint32(e.rendered_sound_level),null!=e.audio_break_cancel_duration&&Object.hasOwnProperty.call(e,"audio_break_cancel_duration")&&t.uint32(144).uint32(e.audio_break_cancel_duration),null!=e.video_break_cancel_duration&&Object.hasOwnProperty.call(e,"video_break_cancel_duration")&&t.uint32(152).uint32(e.video_break_cancel_duration),null!=e.audio_decode_time&&Object.hasOwnProperty.call(e,"audio_decode_time")&&t.uint32(160).uint32(e.audio_decode_time),null!=e.video_decode_time&&Object.hasOwnProperty.call(e,"video_decode_time")&&t.uint32(168).uint32(e.video_decode_time),null!=e.real_sampling_interval&&Object.hasOwnProperty.call(e,"real_sampling_interval")&&t.uint32(176).uint32(e.real_sampling_interval),null!=e.mos&&Object.hasOwnProperty.call(e,"mos")&&t.uint32(184).int32(e.mos),null!=e.audio_decode_fps&&Object.hasOwnProperty.call(e,"audio_decode_fps")&&t.uint32(192).uint32(e.audio_decode_fps),null!=e.video_decode_fps&&Object.hasOwnProperty.call(e,"video_decode_fps")&&t.uint32(200).uint32(e.video_decode_fps),null!=e.video_frames_decoded&&Object.hasOwnProperty.call(e,"video_frames_decoded")&&t.uint32(208).uint32(e.video_frames_decoded),null!=e.video_frames_dropped&&Object.hasOwnProperty.call(e,"video_frames_dropped")&&t.uint32(216).uint32(e.video_frames_dropped),null!=e.quality&&Object.hasOwnProperty.call(e,"quality")&&t.uint32(224).int32(e.quality),null!=e.evaluation_quality&&Object.hasOwnProperty.call(e,"evaluation_quality")&&t.uint32(232).int32(e.evaluation_quality),null!=e.break_stat_duration&&Object.hasOwnProperty.call(e,"break_stat_duration")&&t.uint32(240).uint32(e.break_stat_duration),null!=e.sample_time_window&&Object.hasOwnProperty.call(e,"sample_time_window")&&t.uint32(800).uint32(e.sample_time_window),t},e}(),n.ChargeInfo=function(){function e(e){if(this.play_stream_resolution_infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.is_publishing=0,e.prototype.play_stream_resolution_infos=s.emptyArray,e.prototype.play_max_audio_bitrate=0,e.prototype.no_playing=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.is_publishing&&Object.hasOwnProperty.call(e,"is_publishing")&&t.uint32(8).uint32(e.is_publishing),null!=e.play_stream_resolution_infos&&e.play_stream_resolution_infos.length)for(var r=0;r<e.play_stream_resolution_infos.length;++r)a.logreport.ResolutionInfo.encode(e.play_stream_resolution_infos[r],t.uint32(18).fork()).ldelim();return null!=e.play_max_audio_bitrate&&Object.hasOwnProperty.call(e,"play_max_audio_bitrate")&&t.uint32(24).uint32(e.play_max_audio_bitrate),null!=e.no_playing&&Object.hasOwnProperty.call(e,"no_playing")&&t.uint32(32).uint32(e.no_playing),t},e}(),n.ResolutionInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(8).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(16).uint32(e.video_height),null!=e.count&&Object.hasOwnProperty.call(e,"count")&&t.uint32(24).uint32(e.count),t},e}(),n.NoBillingEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.platform_info="",e.prototype.room_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.platform_info&&Object.hasOwnProperty.call(e,"platform_info")&&t.uint32(10).string(e.platform_info),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).string(e.room_id),t},e}(),n.DynQualityEvent=function(){function e(e){if(this.dyn_quality_infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seq_no="",e.prototype.num=0,e.prototype.dyn_quality_infos=s.emptyArray,e.prototype.device_id="",e.prototype.latitude=0,e.prototype.longitude=0,e.prototype.country="",e.prototype.region="",e.prototype.city="",e.prototype.isp="",e.prototype.ve_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.seq_no&&Object.hasOwnProperty.call(e,"seq_no")&&t.uint32(10).string(e.seq_no),null!=e.num&&Object.hasOwnProperty.call(e,"num")&&t.uint32(16).uint32(e.num),null!=e.dyn_quality_infos&&e.dyn_quality_infos.length)for(var r=0;r<e.dyn_quality_infos.length;++r)a.logreport.DynQualityInfos.encode(e.dyn_quality_infos[r],t.uint32(26).fork()).ldelim();return null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(34).string(e.device_id),null!=e.latitude&&Object.hasOwnProperty.call(e,"latitude")&&t.uint32(40).uint32(e.latitude),null!=e.longitude&&Object.hasOwnProperty.call(e,"longitude")&&t.uint32(48).uint32(e.longitude),null!=e.country&&Object.hasOwnProperty.call(e,"country")&&t.uint32(58).string(e.country),null!=e.region&&Object.hasOwnProperty.call(e,"region")&&t.uint32(66).string(e.region),null!=e.city&&Object.hasOwnProperty.call(e,"city")&&t.uint32(74).string(e.city),null!=e.isp&&Object.hasOwnProperty.call(e,"isp")&&t.uint32(82).string(e.isp),null!=e.ve_mode&&Object.hasOwnProperty.call(e,"ve_mode")&&t.uint32(88).uint32(e.ve_mode),t},e}(),n.DynQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.timestamp_offset_end=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.server_ip="",e.prototype.infos=s.emptyArray,e.prototype.network_type=0,e.prototype.stream_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint64(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint64(e.timestamp_offset_end),null!=e.server_ip&&Object.hasOwnProperty.call(e,"server_ip")&&t.uint32(26).string(e.server_ip),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)a.logreport.DynQualityInfo.encode(e.infos[r],t.uint32(34).fork()).ldelim();return null!=e.network_type&&Object.hasOwnProperty.call(e,"network_type")&&t.uint32(40).uint32(e.network_type),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(50).string(e.stream_id),t},e}(),n.DynQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.time=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.plr=0,e.prototype.rtt=0,e.prototype.score=0,e.prototype.sample_time=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.time&&Object.hasOwnProperty.call(e,"time")&&t.uint32(8).uint64(e.time),null!=e.plr&&Object.hasOwnProperty.call(e,"plr")&&t.uint32(16).uint32(e.plr),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(24).uint32(e.rtt),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(32).uint32(e.score),null!=e.sample_time&&Object.hasOwnProperty.call(e,"sample_time")&&t.uint32(40).uint32(e.sample_time),t},e}(),n),e.exports=a},6348:function(e,t,r){"use strict";var n,i=r(2100),o=i.Reader,s=i.Writer,a=i.util,c=i.roots.default||(i.roots.default={});c.webrtc_cmd=((n={}).MetadataPush=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.width=0,e.prototype.height=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(8).uint32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(16).uint32(e.height),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.MetadataPush;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.width=e.uint32();break;case 2:n.height=e.uint32();break;default:e.skipType(7&i)}}return n},e}(),n.MetadataAck=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.MetadataAck;e.pos<r;){var i=e.uint32();i>>>3==1?n.result=e.sint32():e.skipType(7&i)}return n},e}(),n.VideoStreamSubscribeReq=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).uint32(e.type),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.VideoStreamSubscribeReq;e.pos<r;){var i=e.uint32();i>>>3==1?n.type=e.uint32():e.skipType(7&i)}return n},e}(),n.VideoStreamSubscribeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.VideoStreamSubscribeRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.result=e.sint32():e.skipType(7&i)}return n},e}(),n.VideoStreamFallbackTypeReq=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).uint32(e.type),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.VideoStreamFallbackTypeReq;e.pos<r;){var i=e.uint32();i>>>3==1?n.type=e.uint32():e.skipType(7&i)}return n},e}(),n.VideoStreamFallbackTypeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.VideoStreamFallbackTypeRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.result=e.sint32():e.skipType(7&i)}return n},e}(),n.VideoStreamChangePush=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.change_type=0,e.prototype.video_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.change_type&&Object.hasOwnProperty.call(e,"change_type")&&t.uint32(8).uint32(e.change_type),null!=e.video_type&&Object.hasOwnProperty.call(e,"video_type")&&t.uint32(16).uint32(e.video_type),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.VideoStreamChangePush;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.change_type=e.uint32();break;case 2:n.video_type=e.uint32();break;default:e.skipType(7&i)}}return n},e}(),n.VideoStreamChangeAck=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.VideoStreamChangeAck;e.pos<r;){var i=e.uint32();i>>>3==1?n.result=e.sint32():e.skipType(7&i)}return n},e}(),n.UserUnregisteredSEIFilterReq=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sei_filter="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.sei_filter&&Object.hasOwnProperty.call(e,"sei_filter")&&t.uint32(10).string(e.sei_filter),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.UserUnregisteredSEIFilterReq;e.pos<r;){var i=e.uint32();i>>>3==1?n.sei_filter=e.string():e.skipType(7&i)}return n},e}(),n.UserUnregisteredSEIFilterRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.UserUnregisteredSEIFilterRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.result=e.sint32():e.skipType(7&i)}return n},e}(),n.WebrtcCmdReqMsg=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.meta_data_push=null,e.prototype.video_stream_sub=null,e.prototype.video_fallback_type=null,e.prototype.video_change_push=null,e.prototype.usr_sei_filter=null,Object.defineProperty(e.prototype,"body",{get:a.oneOfGetter(t=["meta_data_push","video_stream_sub","video_fallback_type","video_change_push","usr_sei_filter"]),set:a.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.meta_data_push&&Object.hasOwnProperty.call(e,"meta_data_push")&&c.webrtc_cmd.MetadataPush.encode(e.meta_data_push,t.uint32(10).fork()).ldelim(),null!=e.video_stream_sub&&Object.hasOwnProperty.call(e,"video_stream_sub")&&c.webrtc_cmd.VideoStreamSubscribeReq.encode(e.video_stream_sub,t.uint32(18).fork()).ldelim(),null!=e.video_fallback_type&&Object.hasOwnProperty.call(e,"video_fallback_type")&&c.webrtc_cmd.VideoStreamFallbackTypeReq.encode(e.video_fallback_type,t.uint32(26).fork()).ldelim(),null!=e.video_change_push&&Object.hasOwnProperty.call(e,"video_change_push")&&c.webrtc_cmd.VideoStreamChangePush.encode(e.video_change_push,t.uint32(34).fork()).ldelim(),null!=e.usr_sei_filter&&Object.hasOwnProperty.call(e,"usr_sei_filter")&&c.webrtc_cmd.UserUnregisteredSEIFilterReq.encode(e.usr_sei_filter,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.WebrtcCmdReqMsg;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.meta_data_push=c.webrtc_cmd.MetadataPush.decode(e,e.uint32());break;case 2:n.video_stream_sub=c.webrtc_cmd.VideoStreamSubscribeReq.decode(e,e.uint32());break;case 3:n.video_fallback_type=c.webrtc_cmd.VideoStreamFallbackTypeReq.decode(e,e.uint32());break;case 4:n.video_change_push=c.webrtc_cmd.VideoStreamChangePush.decode(e,e.uint32());break;case 5:n.usr_sei_filter=c.webrtc_cmd.UserUnregisteredSEIFilterReq.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e}(),n.WebrtcCmdRspMsg=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.meta_data_ack=null,e.prototype.video_stream_sub=null,e.prototype.video_fallback_type=null,e.prototype.video_change_ack=null,e.prototype.usr_sei_filter=null,Object.defineProperty(e.prototype,"body",{get:a.oneOfGetter(t=["meta_data_ack","video_stream_sub","video_fallback_type","video_change_ack","usr_sei_filter"]),set:a.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.meta_data_ack&&Object.hasOwnProperty.call(e,"meta_data_ack")&&c.webrtc_cmd.MetadataAck.encode(e.meta_data_ack,t.uint32(10).fork()).ldelim(),null!=e.video_stream_sub&&Object.hasOwnProperty.call(e,"video_stream_sub")&&c.webrtc_cmd.VideoStreamSubscribeRsp.encode(e.video_stream_sub,t.uint32(18).fork()).ldelim(),null!=e.video_fallback_type&&Object.hasOwnProperty.call(e,"video_fallback_type")&&c.webrtc_cmd.VideoStreamFallbackTypeRsp.encode(e.video_fallback_type,t.uint32(26).fork()).ldelim(),null!=e.video_change_ack&&Object.hasOwnProperty.call(e,"video_change_ack")&&c.webrtc_cmd.VideoStreamChangeAck.encode(e.video_change_ack,t.uint32(34).fork()).ldelim(),null!=e.usr_sei_filter&&Object.hasOwnProperty.call(e,"usr_sei_filter")&&c.webrtc_cmd.UserUnregisteredSEIFilterRsp.encode(e.usr_sei_filter,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.webrtc_cmd.WebrtcCmdRspMsg;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.meta_data_ack=c.webrtc_cmd.MetadataAck.decode(e,e.uint32());break;case 2:n.video_stream_sub=c.webrtc_cmd.VideoStreamSubscribeRsp.decode(e,e.uint32());break;case 3:n.video_fallback_type=c.webrtc_cmd.VideoStreamFallbackTypeRsp.decode(e,e.uint32());break;case 4:n.video_change_ack=c.webrtc_cmd.VideoStreamChangeAck.decode(e,e.uint32());break;case 5:n.usr_sei_filter=c.webrtc_cmd.UserUnregisteredSEIFilterRsp.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e}(),n),e.exports=c},5515:function(e){e.exports=function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[s]={exports:{}};t[s][0].call(u.exports,(function(e){return i(t[s][1][e]||e)}),u,u.exports,e,t,r,n)}return r[s].exports}for(var o=void 0,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";var n=(0,e("./adapter_factory.js").adapterFactory)({window:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=n.log,u=n.detectBrowser(e),l={browserDetails:u,commonShim:c,extractVersion:n.extractVersion,disableLog:n.disableLog,disableWarnings:n.disableWarnings};switch(u.browser){case"chrome":if(!i||!i.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),l;r("adapter.js shimming chrome."),l.browserShim=i,i.shimGetUserMedia(e),i.shimMediaStream(e),i.shimPeerConnection(e),i.shimOnTrack(e),i.shimAddTrackRemoveTrack(e),i.shimGetSendersWithDtmf(e),i.shimGetStats(e),i.shimSenderReceiverGetStats(e),i.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!s||!s.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),l;r("adapter.js shimming firefox."),l.browserShim=s,s.shimGetUserMedia(e),s.shimPeerConnection(e),s.shimOnTrack(e),s.shimRemoveStream(e),s.shimSenderGetStats(e),s.shimReceiverGetStats(e),s.shimRTCDataChannel(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),l;r("adapter.js shimming edge."),l.browserShim=o,o.shimGetUserMedia(e),o.shimGetDisplayMedia(e),o.shimPeerConnection(e),o.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!a||!t.shimSafari)return r("Safari shim is not included in this adapter release."),l;r("adapter.js shimming safari."),l.browserShim=a,a.shimRTCIceServerUrls(e),a.shimCreateOfferLegacy(e),a.shimCallbacksAPI(e),a.shimLocalStreamsAPI(e),a.shimRemoteStreamsAPI(e),a.shimTrackEventTransceiver(e),a.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return l};var n=u(e("./utils")),i=u(e("./chrome/chrome_shim")),o=u(e("./edge/edge_shim")),s=u(e("./firefox/firefox_shim")),a=u(e("./safari/safari_shim")),c=u(e("./common_shim"));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)})),t.stream.getTracks().forEach((function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else s.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===t.kind?e.createDTMFSender(t):null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],s.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}},r.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,n){var i=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof arguments[0]))return t.apply(this,[]);var s=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){o[1](a(s(e)))},arguments[0]]):new Promise((function(e,r){t.apply(i,[function(t){e(a(s(t)))},r])})).then(r,n)}}},r.shimSenderReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,i=void 0;return this.getSenders().forEach((function(e){e.track===t&&(r?i=!0:r=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(n?i=!0:n=e),e.track===t})),i||r&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},r.shimAddTrackRemoveTrackWithNative=a,r.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return a(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var n=u(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return u(e,t)}))}}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=l(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:u(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var r=void 0;Object.keys(this._streams).forEach((function(n){t._streams[n].getTracks().find((function(t){return e.track===t}))&&(r=t._streams[n])})),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function u(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t];r=r.replace(new RegExp(e._streams[n.id].id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}function l(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}},r.shimPeerConnection=function(e){if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}}));var t=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},r.fixNegotiationNeeded=function(e){s.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js"));function a(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),i.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:r.video&&r.video.frameRate||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var r=i.detectBrowser(e),s=function(e){if("object"!==(void 0===e?"undefined":n(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var i="object"===n(e[r])?e[r]:{ideal:e[r]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var s={};"number"==typeof i.ideal?(s[o("min",r)]=i.ideal,t.optional.push(s),(s={})[o("max",r)]=i.ideal,t.optional.push(s)):(s[o("",r)]=i.ideal,t.optional.push(s))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",r)]=i.exact):["min","max"].forEach((function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,r)]=i[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,i){if(r.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===n(e.audio)){var a=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=s(e.audio)}if(e&&"object"===n(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":n(c))?c:{ideal:c});var u=r.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||u)){delete e.video.facingMode;var l=void 0;if("environment"===c.exact||"environment"===c.ideal?l=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(l=["front"]),l)return t.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return l.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&l.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=c.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=s(e.video),o("chrome: "+JSON.stringify(e)),i(e)}))}e.video=s(e.video)}return o("chrome: "+JSON.stringify(e)),i(e)},c=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,n){a(e,(function(e){t.webkitGetUserMedia(e,r,(function(e){n&&n(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return a(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js")),o=i.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),o=i.default.parseCandidate(e.candidate),s=Object.assign(r,o);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,o.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},r.shimMaxMessageSize=function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=o.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=function(e){if(!e||!e.sdp)return!1;var t=i.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=i.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},n=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r},s=function(e){var r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},a=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var o=i.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?n=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r(arguments[0])){var e=n(arguments[0]),t=s(e),i=a(arguments[0],e),o=void 0;o=0===t&&0===i?Number.POSITIVE_INFINITY:0===t||0===i?Math.max(t,i):Math.min(t,i);var u={};Object.defineProperty(u,"maxMessageSize",{get:function(){return o}}),this._sctp=u}return c.apply(this,arguments)}}},r.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},o.wrapPeerConnectionEvent(e,"datachannel",(function(e){return r(e.channel,e.target),e}))}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0];if("open"===e.readyState&&t.sctp&&(n.length||n.size||n.byteLength)>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}},r.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}},r.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),r.apply(this,arguments)}}}};var i=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=(0,a.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},r.shimReplaceTrack=function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils")),s=e("./filtericeservers"),a=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim"))},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&n.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!r?(r=!0,!0):t&&!r})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":n(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(e){var t=s.detectBrowser(e);if("object"===(void 0===e?"undefined":n(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,n){return o.apply(this,[e||null]).then((function(e){if(t.version<53&&!r)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(r,n)}}},r.shimSenderGetStats=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},r.shimReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},r.shimRemoveStream=function(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=i.detectBrowser(e),r=e&&e.navigator,o=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var s=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":n(e))&&"object"===n(e.audio)&&(e=JSON.parse(JSON.stringify(e)),s(e.audio,"autoGainControl","mozAutoGainControl"),s(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return s(e,"mozAutoGainControl","autoGainControl"),s(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var u=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":n(e))&&(e=JSON.parse(JSON.stringify(e)),s(e,"autoGainControl","mozAutoGainControl"),s(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getTracks().forEach((function(n){return t.call(r,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e,r){return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t.call(this,e,r)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}},r.shimRemoteStreamsAPI=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}},r.shimCallbacksAPI=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,i=t.createAnswer,o=t.setLocalDescription,s=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var n=r.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=i.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return t?(r.then(e,t),Promise.resolve()):r};var c=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=c,t.setRemoteDescription=c=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=c=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n}}},r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n(o(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))},r.shimConstraints=o,r.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],o=0;o<e.iceServers.length;o++){var s=e.iceServers[o];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,n.push(s)):n.push(e.iceServers[o])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"));function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:i.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.extractVersion=s,r.wrapPeerConnectionEvent=function(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=r(e);t&&n(t)};return this._eventMap=this._eventMap||{},this._eventMap[n]=o,i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},r.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":n(e))+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},r.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":n(e))+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},r.log=function(){if("object"===("undefined"==typeof window?"undefined":n(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},r.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=s(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=s(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=s(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=s(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r},r.compactObject=function e(t){return"object"!==(void 0===t?"undefined":n(t))?t:Object.keys(t).reduce((function(r,i){var o="object"===n(t[i]),s=o?e(t[i]):t[i],a=o&&!Object.keys(s).length;return void 0===s||a?r:Object.assign(r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},i,s))}),{})},r.walkStats=a,r.filterStats=function(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(r){r.type===n&&r.trackId===t.id&&a(e,r,i)}))})),i};var i=!0,o=!0;function s(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function a(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?a(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((function(t){a(e,e.get(t),r)}))})))}},{}],16:[function(e,t,r){"use strict";var n=e("sdp");function i(e,t,r,i,o){var s=n.writeRtpDescription(e.kind,t);if(s+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":o||"active"),s+="a=mid:"+e.mid+"\r\n",s+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(i?i.id:"-")+" "+a+"\r\n";s+="a="+c,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),s}function o(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},i=function(e,t,r,i){var o=n(e.parameters.apt,r),s=n(t.parameters.apt,i);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(n){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(n.name.toLowerCase()===s.name.toLowerCase()&&n.clockRate===s.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&s.parameters.apt&&!i(n,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(n.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}})),r}function s(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function a(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function c(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}function l(t,r,n,i){var o=new Event("track");o.track=r,o.receiver=n,o.transceiver={receiver:n},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var d=function(r){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof n;return i&&(n=[n]),n=n.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=i?n[0]:n,!!n.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var s=r.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=n.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(d.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(d.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),d.prototype.onicecandidate=null,d.prototype.onaddstream=null,d.prototype.ontrack=null,d.prototype.onremovestream=null,d.prototype.onsignalingstatechange=null,d.prototype.oniceconnectionstatechange=null,d.prototype.onconnectionstatechange=null,d.prototype.onicegatheringstatechange=null,d.prototype.onnegotiationneeded=null,d.prototype.ondatachannel=null,d.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},d.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},d.prototype.getConfiguration=function(){return this._config},d.prototype.getLocalStreams=function(){return this.localStreams},d.prototype.getRemoteStreams=function(){return this.remoteStreams},d.prototype._createTransceiver=function(e,t){var r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var n=this._createIceAndDtlsTransports();r.iceTransport=n.iceTransport,r.dtlsTransport=n.dtlsTransport}return t||this.transceivers.push(r),r},d.prototype.addTrack=function(t,r){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},d.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),n.getTracks().forEach((function(e){r.addTrack(e,n)}))}},d.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw c("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},d.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},d.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},d.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},d.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;i.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},d.prototype._gather=function(t,r){var i=this,o=this.transceivers[r].iceGatherer;if(!o.onlocalcandidate){var s=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&r>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),a.component=1,a.ufrag=o.getLocalParameters().usernameFragment;var u=n.writeCandidate(a);s.candidate=Object.assign(s.candidate,n.parseCandidate(u)),s.candidate.candidate=u,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var l=n.getMediaSections(i._localDescription.sdp);l[s.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",i._localDescription.sdp=n.getDescription(i._localDescription.sdp)+l.join("");var d=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",s),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},d.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},d.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},d.prototype._transceive=function(e,r,i){var s=o(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:n.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),i&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),s.encodings=e.recvEncodingParameters.length?e.recvEncodingParameters:[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},d.prototype.setLocalDescription=function(e){var t,r,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=n.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=n.parseRtpParameters(e);i.transceivers[t].localCapabilities=r})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=n.splitSections(i._remoteDescription.sdp),r=t.shift();var a=n.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var s=i.transceivers[t],c=s.iceGatherer,u=s.iceTransport,l=s.dtlsTransport,d=s.localCapabilities,h=s.remoteCapabilities;if(!(n.isRejected(e)&&0===n.matchPrefix(e,"a=bundle-only").length||s.rejected)){var p=n.getIceParameters(e,r),f=n.getDtlsParameters(e,r);a&&(f.role="server"),i.usingBundle&&0!==t||(i._gather(s.mid,t),"new"===u.state&&u.start(c,p,a?"controlling":"controlled"),"new"===l.state&&l.start(f));var g=o(d,h);i._transceive(s,g.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},i._updateSignalingState("offer"===e.type?"have-local-offer":"stable"),Promise.resolve()},d.prototype.setRemoteDescription=function(i){var d=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!s("setRemoteDescription",i.type,d.signalingState)||d._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+d.signalingState));var h={};d.remoteStreams.forEach((function(e){h[e.id]=e}));var p=[],f=n.splitSections(i.sdp),g=f.shift(),m=n.matchPrefix(g,"a=ice-lite").length>0,_=n.matchPrefix(g,"a=group:BUNDLE ").length>0;d.usingBundle=_;var v=n.matchPrefix(g,"a=ice-options:")[0];return d.canTrickleIceCandidates=!!v&&v.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(s,c){var l=n.splitLines(s),f=n.getKind(s),v=n.isRejected(s)&&0===n.matchPrefix(s,"a=bundle-only").length,y=l[0].substr(2).split(" ")[2],E=n.getDirection(s,g),S=n.parseMsid(s),b=n.getMid(s)||n.generateIdentifier();if(v||"application"===f&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))d.transceivers[c]={mid:b,kind:f,protocol:y,rejected:!0};else{var T,C,R,O,k,I,L,w,A;!v&&d.transceivers[c]&&d.transceivers[c].rejected&&(d.transceivers[c]=d._createTransceiver(f,!0));var N,P,M=n.parseRtpParameters(s);v||(N=n.getIceParameters(s,g),(P=n.getDtlsParameters(s,g)).role="client"),L=n.parseRtpEncodingParameters(s);var D=n.parseRtcpParameters(s),U=n.matchPrefix(s,"a=end-of-candidates",g).length>0,x=n.matchPrefix(s,"a=candidate:").map((function(e){return n.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!v&&_&&c>0&&d.transceivers[c]&&(d._disposeIceAndDtlsTransports(c),d.transceivers[c].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[c].iceTransport=d.transceivers[0].iceTransport,d.transceivers[c].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[c].rtpSender&&d.transceivers[c].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[c].rtpReceiver&&d.transceivers[c].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport)),"offer"!==i.type||v)"answer"!==i.type||v||(C=(T=d.transceivers[c]).iceGatherer,R=T.iceTransport,O=T.dtlsTransport,k=T.rtpReceiver,I=T.sendEncodingParameters,w=T.localCapabilities,d.transceivers[c].recvEncodingParameters=L,d.transceivers[c].remoteCapabilities=M,d.transceivers[c].rtcpParameters=D,x.length&&"new"===R.state&&(!m&&!U||_&&0!==c?x.forEach((function(e){a(T.iceTransport,e)})):R.setRemoteCandidates(x)),_&&0!==c||("new"===R.state&&R.start(C,N,"controlling"),"new"===O.state&&O.start(P)),!o(T.localCapabilities,T.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&T.sendEncodingParameters[0].rtx&&delete T.sendEncodingParameters[0].rtx,d._transceive(T,"sendrecv"===E||"recvonly"===E,"sendrecv"===E||"sendonly"===E),!k||"sendrecv"!==E&&"sendonly"!==E?delete T.rtpReceiver:(A=k.track,S?(h[S.stream]||(h[S.stream]=new e.MediaStream),r(A,h[S.stream]),p.push([A,k,h[S.stream]])):(h.default||(h.default=new e.MediaStream),r(A,h.default),p.push([A,k,h.default]))));else{(T=d.transceivers[c]||d._createTransceiver(f)).mid=b,T.iceGatherer||(T.iceGatherer=d._createIceGatherer(c,_)),x.length&&"new"===T.iceTransport.state&&(!U||_&&0!==c?x.forEach((function(e){a(T.iceTransport,e)})):T.iceTransport.setRemoteCandidates(x)),w=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(w.codecs=w.codecs.filter((function(e){return"rtx"!==e.name}))),I=T.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var B,j=!1;"sendrecv"===E||"sendonly"===E?(j=!T.rtpReceiver,k=T.rtpReceiver||new e.RTCRtpReceiver(T.dtlsTransport,f),j&&(A=k.track,S&&"-"===S.stream||(S?(h[S.stream]||(h[S.stream]=new e.MediaStream,Object.defineProperty(h[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(A,"id",{get:function(){return S.track}}),B=h[S.stream]):(h.default||(h.default=new e.MediaStream),B=h.default)),B&&(r(A,B),T.associatedRemoteMediaStreams.push(B)),p.push([A,k,B]))):T.rtpReceiver&&T.rtpReceiver.track&&(T.associatedRemoteMediaStreams.forEach((function(e){var t=e.getTracks().find((function(e){return e.id===T.rtpReceiver.track.id}));t&&u(t,e)})),T.associatedRemoteMediaStreams=[]),T.localCapabilities=w,T.remoteCapabilities=M,T.rtpReceiver=k,T.rtcpParameters=D,T.sendEncodingParameters=I,T.recvEncodingParameters=L,d._transceive(d.transceivers[c],!1,j)}}})),void 0===d._dtlsRole&&(d._dtlsRole="offer"===i.type?"active":"passive"),d._remoteDescription={type:i.type,sdp:i.sdp},d._updateSignalingState("offer"===i.type?"have-remote-offer":"stable"),Object.keys(h).forEach((function(t){var r=h[t];if(r.getTracks().length){if(-1===d.remoteStreams.indexOf(r)){d.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout((function(){d._dispatchEvent("addstream",n)}))}p.forEach((function(e){r.id===e[2].id&&l(d,e[0],e[1],[r])}))}})),p.forEach((function(e){e[2]||l(d,e[0],e[1],[])})),e.setTimeout((function(){d&&d.transceivers&&d.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},d.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},d.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},d.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},d.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},d.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},d.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=r.transceivers.filter((function(e){return"audio"===e.kind})).length,s=r.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(o=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));o>0||s>0;)o>0&&(r._createTransceiver("audio"),o--),s>0&&(r._createTransceiver("video"),s--);var u=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(i,o){var s=i.track,a=i.kind,c=i.mid||n.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=r._createIceGatherer(o,r.usingBundle));var u=e.RTCRtpSender.getCapabilities(a);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];s&&t>=15019&&"video"===a&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,a)),i.localCapabilities=u,i.sendEncodingParameters=l})),"max-compat"!==r._config.bundlePolicy&&(u+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+n.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},d.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var s=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(s+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=n.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,n){if(!(n+1>a)){if(e.rejected)return"application"===e.kind?s+="DTLS/SCTP"===e.protocol?"m=application 0 DTLS/SCTP 5000\r\n":"m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=o(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=i(e,u,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(u)},d.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!r._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<r.transceivers.length;u++)if(r.transceivers[u].mid===e.sdpMid){s=u;break}var l=r.transceivers[s];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var d=Object.keys(e.candidate).length>0?n.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===s||s>0&&l.iceTransport!==r.transceivers[0].iceTransport)&&!a(l.iceTransport,d))return o(c("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=n.getMediaSections(r._remoteDescription.sdp))[s]+="a="+(d.type?h:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var p=0;p<r.transceivers.length&&(r.transceivers[p].rejected||(r.transceivers[p].iceTransport.addRemoteCandidate({}),(t=n.getMediaSections(r._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));p++);i()}))},d.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw c("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){e[r].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[r]),t.set(r,e[r])})),t}))}}}));var h=["createOffer","createAnswer"];return h.forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(h=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),d}},{sdp:17}],17:[function(e,t,r){"use strict";var n={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},n.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},n.getDescription=function(e){var t=n.splitSections(e);return t&&t[0]},n.getMediaSections=function(e){var t=n.splitSections(e);return t.shift(),t},n.matchPrefix=function(e,t){return n.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},n.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},n.parseIceOptions=function(e){return e.substr(14).split(" ")},n.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},n.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},n.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){n.push(e.parameters[t]?t+"="+e.parameters[t]:t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},n.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},n.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},n.getMid=function(e){var t=n.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},n.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},n.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:n.matchPrefix(e+t,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},n.getIceParameters=function(e,t){var r=n.splitLines(e);return{usernameFragment:(r=r.concat(n.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:r.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=n.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=n.parseRtpMap(s),c=n.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?n.parseFmtp(c[0]):{},a.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(n.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return n.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(n.parseExtmap(e))})),t},n.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){r+=n.writeRtpMap(e),r+=n.writeFmtp(e),r+=n.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=n.writeExtmap(e)})),r},n.parseRtpEncodingParameters=function(e){var t,r=[],i=n.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,u=n.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(n.rtx={ssrc:t}),r.push(n),o&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(n))}})),0===r.length&&c&&r.push({ssrc:c});var l=n.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=l}))),r},n.parseRtcpParameters=function(e){var t={},r=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var i=n.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=n.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},n.parseMsid=function(e){var t,r=n.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var i=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},n.generateSessionId=function(){return Math.random().toString().substr(2,21)},n.writeSessionBoilerplate=function(e,t,r){var i=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||n.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,r,i){var o=n.writeRtpDescription(e.kind,t);if(o+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.direction?"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),o},n.getDirection=function(e,t){for(var r=n.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return t?n.getDirection(t):"sendrecv"},n.getKind=function(e){return n.splitLines(e)[0].split(" ")[0].substr(2)},n.isRejected=function(e){return"0"===e.split(" ",2)[1]},n.parseMLine=function(e){var t=n.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},n.parseOLine=function(e){var t=n.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},n.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=n.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=n)},{}]},{},[1])(1)},9869:function(e){"undefined"!=typeof self&&self,e.exports=function(){return t={23:function(e,t,r){"use strict";var n;r.r(t),(r=n=n||{}).LIVE_SEND_SIGNAL="zm.lv.ssg",r.LIVE_RESPOND_JOIN_LIVE="zm.lv.rjl",r.LIVE_PUSH_SIGNAL="zm.lv.pss",r.SERVICE_PUSH="zm.sv.ps",r.SERVICE_SEND="zm.sv.sd";var i={code:1002014,msg:"room not exist"},o={code:1002099,msg:"room inner error"},s=(a.prototype.resetLiveHandler=function(){this.joinLiveCallbackMap={},this.joinLiveRequestMap={}},a.prototype.getSignalCmdContent=function(e,t,r){return e={request_id:e,room_id:this.room.roomID,from_userid:this.stateCenter.idName,from_username:this.stateCenter.nickName,to_userid:t},null!=r&&(e.result=r),JSON.stringify(e)},a.prototype.requestJoinLive=function(e,t,r,n){var i=this.stateCenter.getRequestId(),o=this.getSignalCmdContent(i,e);return null!=n&&(this.joinLiveCallbackMap[i]=n,this.sendSignalCmd(1001,o,e,t,r),!0)},a.prototype.sendSignalCmd=function(e,t,r,i,s){var a=this;this.room.isLogin()?((this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendSignalCmd({sub_cmd:e,signal_msg:t,dest_id_name:[r]},(function(e){i&&i(e.header.seq)}),(function(e){var t=o;e.header&&e.body?s&&s(a.rtm.getServerError(e.body.err_code),e.header.seq):(e.code&&e.msg&&(t=e),s&&s(t,0))}),this.room),this.logger.info(n.LIVE_SEND_SIGNAL+" call success"+e)):this.logger.error(n.LIVE_SEND_SIGNAL+" state error")},a.prototype.inviteJoinLive=function(e,t,r,n){var i=this.stateCenter.getRequestId(),o=this.getSignalCmdContent(i,e);return null!=n&&(this.joinLiveCallbackMap[i]=n,this.sendSignalCmd(1003,o,e,t,r),!0)},a.prototype.endJoinLive=function(e,t,r){var n=this.stateCenter.getRequestId();return n=this.getSignalCmdContent(n,e),this.sendSignalCmd(1004,n,e,t,r),!0},a.prototype.respondJoinLive=function(e,t,r,i){var o=this.joinLiveRequestMap[e];if(!o)return this.logger.info(n.LIVE_RESPOND_JOIN_LIVE+" no dest id name"),!1;var s=0;return t=this.getSignalCmdContent(e,o,s=!0===t?1:s),this.sendSignalCmd(1002,t,o,r,i),delete this.joinLiveRequestMap[e],!0},a.prototype.handlePushSignalMsg=function(e){var t=JSON.parse(e.body.signal_msg);switch(this.logger.info(n.LIVE_PUSH_SIGNAL+" hpsm= ",t),e.body.sub_cmd){case 11001:this.handlePushJoinLiveRequestMsg(t);break;case 11002:this.handlePushJoinLiveResultMsg(t);break;case 11003:this.handlePushJoinLiveInviteMsg(t);break;case 11004:this.handlePushJoinLiveStopMsg(t)}},a.prototype.handlePushJoinLiveRequestMsg=function(e){var t,r=e.request_id;"string"!=typeof r?this.logger.error(n.LIVE_PUSH_SIGNAL+" no requestId"):"string"!=typeof(t=e.from_userid)?this.logger.error(n.LIVE_PUSH_SIGNAL+" no from user"):(this.joinLiveRequestMap[r]=t,this.onRecvJoinLiveRequest(r,e.from_userid,e.from_username,e.room_id),this.logger.info(n.LIVE_PUSH_SIGNAL+" onRecvJoinLiveRequest "+t))},a.prototype.onRecvJoinLiveRequest=function(e,t,r,n){this.stateCenter.actionListener("recvJoinLiveRequest",e,t,r,n)},a.prototype.handlePushJoinLiveInviteMsg=function(e){var t,r=e.request_id;"string"!=typeof r?this.logger.error(n.LIVE_PUSH_SIGNAL+"no requestId"):"string"!=typeof(t=e.from_userid)?this.logger.error(n.LIVE_PUSH_SIGNAL+" no from user"):(this.joinLiveRequestMap[r]=t,this.onRecvInviteJoinLiveRequest(r,e.from_userid,e.from_username,e.room_id),this.logger.info(n.LIVE_PUSH_SIGNAL+" onRecvInviteJoinLiveRequest "+t))},a.prototype.onRecvInviteJoinLiveRequest=function(e,t,r,n){this.stateCenter.actionListener("recvInviteJoinLiveRequest",e,t,r,n)},a.prototype.handlePushJoinLiveResultMsg=function(e){var t,r,i=e.request_id;"string"!=typeof i?this.logger.error(n.LIVE_PUSH_SIGNAL+" no requestId"):null==(t=e.result)?this.logger.info(n.LIVE_PUSH_SIGNAL+" no result"):(t=1==t,this.joinLiveCallbackMap[i]&&((r=this.joinLiveCallbackMap[i])?(this.logger.info(n.LIVE_PUSH_SIGNAL+" joinLiveRequest/invite result "+t),delete this.joinLiveCallbackMap[i],r(t,e.from_userid,e.from_username)):this.logger.info(n.LIVE_PUSH_SIGNAL+" no callback")))},a.prototype.handlePushJoinLiveStopMsg=function(e){var t=e.request_id;"string"!=typeof t?this.logger.error(n.LIVE_PUSH_SIGNAL+" no requestId"):(this.logger.info(n.LIVE_PUSH_SIGNAL+" onRecvEndJoinLiveCommand "+e.from_userid),this.onRecvEndJoinLiveCommand(t,e.from_userid,e.from_username,e.room_id))},a.prototype.onRecvEndJoinLiveCommand=function(e,t,r,n){this.stateCenter.actionListener("recvEndJoinLiveCommand",e,t,r,n)},a);function a(e,t,r,n,i,o){this.logger=e,this.stateCenter=t,this.service=r,this.liveRoomHandler=n,this.rtm=i,this.room=o,this.joinLiveCallbackMap={},this.joinLiveRequestMap={}}var c={requestJoinLive:function(e,t,r,n,o){return(o=this.getRoomModules(o)||this.stateCenter.roomModulesList[0])?o.liveHandler.requestJoinLive(e,t,r,n):(r&&r(i,0),!1)},inviteJoinLive:function(e,t,r,n,o){return(o=this.getRoomModules(o)||this.stateCenter.roomModulesList[0])?o.liveHandler.inviteJoinLive(e,t,r,n):(r&&r(i,0),!1)},endJoinLive:function(e,t,r,n){return(n=this.getRoomModules(n)||this.stateCenter.roomModulesList[0])?n.liveHandler.endJoinLive(e,t,r):(r&&r(i,0),!1)},respondJoinLive:function(e,t,r,n,o){return(o=this.getRoomModules(o)||this.stateCenter.roomModulesList[0])?o.liveHandler.respondJoinLive(e,t,r,n):(n&&n(i,0),!1)}},u={handlePushSignalMsg:function(e){var t=null==(r=null==e?void 0:e.header)?void 0:r.room_id,r=this.stateCenter.roomModulesList.find((function(e){return e.roomID==t}));r?r.liveHandler.handlePushSignalMsg(e):this.logger.error(n.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}},l={initLiveHandler:function(){this.liveHandler=new s(this.logger,this.stateCenter,this.service,this.liveRoomHandler,this.rtm,this)}};t.default={type:"live",install:function(e,t,r,n){for(var i in c)Object.defineProperty(e.prototype,i,{value:c[i],writable:!1});for(var i in u)Object.defineProperty(r.prototype,i,{value:u[i],writable:!1}),Object.defineProperty(n.prototype,i,{value:u[i],writable:!1});for(var i in l)Object.defineProperty(t.prototype,i,{value:l[i],writable:!1})}}}},r={},e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var i in t)e.d(n,i,function(e){return t[e]}.bind(null,i));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=23);function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var t,r}()},3126:function(e){"undefined"!=typeof self&&self,e.exports=function(){return t={1:function(e,t,r){var n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}function i(e){var t=Math.clz32(e&-e);return e?31-t:t}Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var o={},s={};function a(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=s[e])?n:(r=u(e,0,!0),i&&(s[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=o[e])?n:(r=u(e,e<0?-1:0,!1),i&&(o[e]=r),r)}function c(e,t){if(isNaN(e))return t?v:_;if(t){if(e<0)return v;if(f<=e)return T}else{if(e<=-g)return C;if(g<=e+1)return b}return e<0?c(-e,t).neg():u(e%p|0,e/p|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=c,r.fromBits=u;var l=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if(t="number"==typeof t?(r=t,!1):!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?v:_;if((r=r||10)<2||36<r)throw RangeError("radix");var n;if(0<(n=e.indexOf("-")))throw Error("interior hyphen");if(0===n)return d(e.substring(1),t,r).neg();for(var i=c(l(r,8)),o=_,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),r);o=a<8?(a=c(l(r,a)),o.mul(a).add(c(u))):(o=o.mul(i)).add(c(u))}return o.unsigned=t,o}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?d(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=h;var p=4294967296,f=p*p,g=f/2,m=a(1<<24),_=a(0),v=(r.ZERO=_,a(0,!0)),y=(r.UZERO=v,a(1)),E=(r.ONE=y,a(1,!0)),S=(r.UONE=E,a(-1)),b=(r.NEG_ONE=S,u(-1,2147483647,!1)),T=(r.MAX_VALUE=b,u(-1,-1,!0)),C=(r.MAX_UNSIGNED_VALUE=T,u(0,-2147483648,!1)),R=(r.MIN_VALUE=C,r.prototype);return R.toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},R.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";var t,r;if(this.isNegative())return this.eq(C)?(r=c(e),r=(t=this.div(r)).mul(r).sub(this),t.toString(e)+r.toInt().toString(e)):"-"+this.neg().toString(e);for(var n=c(l(e,6),this.unsigned),i=this,o="";;){var s=i.div(n),a=(i.sub(s.mul(n)).toInt()>>>0).toString(e);if((i=s).isZero())return a+o;for(;a.length<6;)a="0"+a;o=""+a+o}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;0<t&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},R.isZero=function(){return 0===this.high&&0===this.low},R.eqz=R.isZero,R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||0<=this.high},R.isOdd=function(){return 1==(1&this.low)},R.isEven=function(){return 0==(1&this.low)},R.equals=function(e){return n(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},R.eq=R.equals,R.notEquals=function(e){return!this.eq(e)},R.neq=R.notEquals,R.ne=R.notEquals,R.lessThan=function(e){return this.comp(e)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(e){return this.comp(e)<=0},R.lte=R.lessThanOrEqual,R.le=R.lessThanOrEqual,R.greaterThan=function(e){return 0<this.comp(e)},R.gt=R.greaterThan,R.greaterThanOrEqual=function(e){return 0<=this.comp(e)},R.gte=R.greaterThanOrEqual,R.ge=R.greaterThanOrEqual,R.compare=function(e){if(n(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(y)},R.neg=R.negate,R.add=function(e){n(e)||(e=h(e));var t=0,r=0,i=0,o=0;return r+=(i=i+((o+=(65535&this.low)+(65535&e.low))>>>16)+((this.low>>>16)+(e.low>>>16)))>>>16,u((i&=65535)<<16|(o&=65535),((t+=(r+=(65535&this.high)+(65535&e.high))>>>16)+((this.high>>>16)+(e.high>>>16))&65535)<<16|(r&=65535),this.unsigned)},R.subtract=function(e){return n(e)||(e=h(e)),this.add(e.neg())},R.sub=R.subtract,R.multiply=function(e){if(this.isZero())return this;if(n(e)||(e=h(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?v:_;if(this.eq(C))return e.isOdd()?C:_;if(e.eq(C))return this.isOdd()?C:_;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return c(this.toNumber()*e.toNumber(),this.unsigned);var r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,l=e.low>>>16,d=0,p=0,f=0,g=(g=0)+((p=p+((f+=o*(e=65535&e.low))>>>16)+i*e)>>>16)+((p=(65535&p)+o*l)>>>16);return u((p&=65535)<<16|(f&=65535),((d+=(g+=r*e)>>>16)+((g=(65535&g)+i*l)>>>16)+((g=(65535&g)+o*a)>>>16)+((this.high>>>16)*e+r*l+i*a+o*s)&65535)<<16|(g&=65535),this.unsigned)},R.mul=R.multiply,R.divide=function(e){if((e=n(e)?e:h(e)).isZero())throw Error("division by zero");var r,i,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:_;if(this.unsigned){if((e=e.unsigned?e:e.toUnsigned()).gt(this))return v;if(e.gt(this.shru(1)))return E;i=v}else{if(this.eq(C))return e.eq(y)||e.eq(S)?C:e.eq(C)?y:(o=this.shr(1).div(e).shl(1)).eq(_)?e.isNegative()?y:S:(r=this.sub(e.mul(o)),o.add(r.div(e)));if(e.eq(C))return this.unsigned?v:_;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=_}for(r=this;r.gte(e);){o=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(o)/Math.LN2),a=s<=48?1:l(2,s-48),d=c(o),p=d.mul(e);p.isNegative()||p.gt(r);)p=(d=c(o-=a,this.unsigned)).mul(e);d.isZero()&&(d=y),i=i.add(d),r=r.sub(p)}return i},R.div=R.divide,R.modulo=function(e){return n(e)||(e=h(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},R.mod=R.modulo,R.rem=R.modulo,R.not=function(){return u(~this.low,~this.high,this.unsigned)},R.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},R.clz=R.countLeadingZeros,R.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},R.ctz=R.countTrailingZeros,R.and=function(e){return n(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},R.or=function(e){return n(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},R.xor=function(e){return n(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},R.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):u(32===e?this.high:this.high>>>e-32,0,this.unsigned)},R.shru=R.shiftRightUnsigned,R.shr_u=R.shiftRightUnsigned,R.rotateLeft=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?u(this.low<<e|this.high>>>(t=32-e),this.high<<e|this.low>>>t,this.unsigned):u(this.high<<(e-=32)|this.low>>>(t=32-e),this.low<<e|this.high>>>t,this.unsigned)},R.rotl=R.rotateLeft,R.rotateRight=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?u(this.high<<(t=32-e)|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned):u(this.low<<(t=32-(e-=32))|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)},R.rotr=R.rotateRight,R.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},R.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},R.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},e.default=r,"default"in e?e.default:e}({});void 0!==(t=function(){return n}.apply(t,[]))&&(e.exports=t)},22:function(e,t,r){"use strict";function n(e){return e}r.r(t),(a=i=i||{}).RTM_SEND_CUSTOM="zm.scc",a.RTM_SEND_BCM="zm.sbcm",a.RTM_SEND_RLM="zm.srlm",a.RTM_SEND_BRM="zm.sbrm",a.RTM_SEND_RAM="zm.sram",a.MESSAGE_SEND_RELIABLE="zm.msg.sdr",a.MESSAGE_FETCH_RELIABLE="zm.msg.frm",a.MESSAGE_RELIABLE_RSP="zm.msg.rlr",a.MESSAGE_RELIABLE_PUSH="zm.msg.rps",a.MESSAGE_SEND_ROOM_MSG="zm.msg.srm",a.MESSAGE_SEND_CUSTOM_MSG="zm.msg.scm",a.MESSAGE_SEND_BIG_MSG="zm.msg.sbm",a.MESSAGE_BIG_MSG_PUSH="zm.msg.bps",a.MESSAGE_SEND_RELAY_MSG="zm.msg.slm",a.SERVICE_PUSH="zm.sv.ps";var i,o={INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},NOT_LOGIN:{code:1000002,msg:"not login"},IM_CONTENT_NULL:{code:1009001,msg:"message content is empty"},IM_CONTENT_TOO_LONG:{code:1009002,msg:"message content is too long"},IM_SEND_FAILED:{code:1009010,msg:"failed to send message"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},TRANS_FREQUENTLY:{code:1102022,msg:"trans send frequently"},FREQ_LIMITED:{code:1109001,msg:"frequency limited."}},s={kZegoTaskLiveSendRoomBigIM:{event:"/liveroom/send_big_room_message",room_sid:n,error:{INPUT_PARAM:o.INPUT_PARAM,IM_CONTENT_NULL:o.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:o.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:o.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendCustomCommand:{event:"/liveroom/send_custom_command",room_sid:n,error:{INPUT_PARAM:o.INPUT_PARAM,IM_CONTENT_NULL:o.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:o.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:o.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendRoomMessage:{event:"/liveroom/send_room_message",room_sid:n,error:{INPUT_PARAM:o.INPUT_PARAM,IM_CONTENT_NULL:o.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:o.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:o.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendReliableMessage:{event:"/liveroom/send_reliable_message",room_sid:n,error:{INPUT_PARAM:o.INPUT_PARAM,TRANS_FREQUENTLY:o.TRANS_FREQUENTLY,ROOM_NOT_EXIST:o.ROOM_NOT_EXIST}},kZegoTaskLiveGetRoomBigIM:{event:"/liveroom/get_big_room_message"},kZegoTaskLiveRoomGetRoomMessage:{event:"/liveroom/get_room_message",room_sid:n},kZegoTaskLiveRoomGetCustomCommand:{event:"/liveroom/get_custom_command"}},a=r(1),c=r.n(a),u=(l.prototype.loginRsp=function(e){var t,r=this;if(null!=e.body.ret_timestamp&&"string"==typeof e.body.ret_timestamp&&(t=parseFloat(e.body.ret_timestamp),this.serverTimeOffset=0==t?0:e.body.ret_timestamp-(new Date).getTime()),e.body.bigim_time_window&&"number"==typeof e.body.bigim_time_window&&(this.bigimTimeWindow=e.body.bigim_time_window),e.body.dati_time_window&&"number"==typeof e.body.dati_time_window&&(this.datiTimeWindow=e.body.dati_time_window),e.body.trans_seqs)for(var n=0;n<e.body.trans_seqs.length;n++){var i=e.body.trans_seqs[n].trans_channel,o=e.body.trans_seqs[n].trans_seq_array;0<(o=(o=o.filter((function(e){var t=e.trans_type;return e=e.trans_seq,!r.transSeqMap[t]||r.transSeqMap[t].seq<e}))).map((function(e){return{trans_type:e.trans_type,trans_local_seq:e.trans_seq}}))).length&&this.fetchReliableMessage(i,o)}},l.prototype.sendReliableMessage=function(e,t,r,n){var a=this;this.logger.info(i.MESSAGE_SEND_RELIABLE+" call"),this.room.isLogin()?this.isReliable?(this.logger.error(i.MESSAGE_SEND_RELIABLE+" send too often"),n(s.kZegoTaskLiveRoomSendReliableMessage.error.TRANS_FREQUENTLY)):(this.transSeqMap[e]||(this.transSeqMap[e]={seq:0}),t={trans_type:e,trans_data:t,trans_local_seq:this.transSeqMap[e].seq,trans_channel:"clt"},this.isReliable=!0,(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendReliableMessage(t,(function(t){a.transSeqMap[e].seq=t.body.trans_seq,a.logger.info(i.MESSAGE_SEND_RELIABLE+" trans "+e+" seq "+t.body.trans_seq),a.isReliable=!1,r({seq:t.header.seq,errorCode:0})}),(function(e){var t=o.ROOM_INNER_ERROR;e.body&&e.body.err_code?(t=a.rtm.getServerError(e.body.err_code),a.logger.error(i.MESSAGE_SEND_ROOM_MSG+"  "+t.msg)):t=e,a.isReliable=!1,n(t)}),this.room)):(this.logger.error(i.MESSAGE_SEND_RELIABLE+" state error"),n&&n(o.NOT_LOGIN))},l.prototype.fetchReliableMessage=function(e,t){function r(e){n.handleFetchTransRsp(e)}var n=this;(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).fetchReliableMessage({trans_channel:e,fetch_array:t},r,r,this.room),this.logger.info(i.MESSAGE_FETCH_RELIABLE+" call success")},l.prototype.handleFetchTransRsp=function(e){if(e.body&&0!=e.body.err_code)this.logger.error(i.MESSAGE_RELIABLE_RSP+" trans send error "+e.body.err_code);else if(e.header&&e.body){var t=e.body.trans_fetch_results,r=[];if(Array.isArray(t)&&0<t.length){for(var n=0;n<t.length;n++){var o,s,a=t[n];1000001109===a.err_code?this.logger.warn(i.MESSAGE_RELIABLE_RSP+" fetch trans unknown type "+a.err_code):(o=a.trans_type,s=a.trans_seq,1000001110===a.err_code?(this.logger.warn(i.MESSAGE_RELIABLE_RSP+" fetch trans seq is wrong "+a.err_code),this.transSeqMap[o]={seq:s}):!this.transSeqMap[o]||this.transSeqMap[o].seq<s?(this.transSeqMap[o]={seq:s},r.push(a)):this.logger.warn(i.MESSAGE_RELIABLE_RSP+" fetch trans seq wrong"))}0<r.length&&this.onRecvReliableMessage(r)}}else this.logger.error(i.MESSAGE_RELIABLE_RSP+" trans send error "+e)},l.prototype.handlePushTransMsg=function(e){var t,r=e.body.trans_type,n=e.body.trans_seq;!this.transSeqMap[r]||this.transSeqMap[r].seq<n?(this.transSeqMap[r]={seq:n},(null==(t=null==e?void 0:e.body)?void 0:t.trans_idname)!==this.stateCenter.idName?this.onRecvReliableMessage([e.body]):this.logger.warn(i.MESSAGE_RELIABLE_PUSH+" id name same")):this.logger.warn(i.MESSAGE_RELIABLE_PUSH+" trans seq wrong"),this.logger.info(i.MESSAGE_RELIABLE_PUSH+" trans "+r+" seq "+n)},l.prototype.sendRoomMsg=function(e,t,r,n,s,a){var c=this;if(!this.room.isLogin())return this.logger.error(i.MESSAGE_SEND_ROOM_MSG+" state error"),a(o.NOT_LOGIN),!1;var u=Date.parse(new Date+"");return 0<this.sendRoomMsgTime&&this.sendRoomMsgTime+this.sendRoomMsgInterval>u?(this.logger.info(i.MESSAGE_SEND_ROOM_MSG+" freq error"),a&&a(o.FREQ_LIMITED,0,e,n),!1):(this.sendRoomMsgTime=u,(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendRoomMsg({msg_category:e,msg_type:1,msg_priority:1,msg_content:n},(function(e){s({seq:e.header.seq,errorCode:0,messageID:e.body.msg_id})}),(function(e){var t,r,n=o.ROOM_INNER_ERROR;e.header&&e.body?(r=(t=[c.rtm.getServerError(e.body.err_code),e.body.msg_id])[1],c.logger.error(i.MESSAGE_SEND_ROOM_MSG+"  "+(n=t[0]).msg),a({seq:e.header.seq,errorCode:(n=n==o.TIMEOUT?o.IM_SEND_FAILED:n).code,messageID:r})):(e.code&&e.msg&&(n=e),a({seq:0,errorCode:n.code,messageID:0}))}),this.room),this.logger.info(i.MESSAGE_SEND_ROOM_MSG+"  call success"),!0)},l.prototype.handlePushRoomMsg=function(e){var t,r=this,n=this.stateCenter.useNetAgent?this.room.roomSessionID:e.header.session_id,i=this.rtm.getReportSeq(),o=(this.dataReport.newReport(i),this.dataReport.addMsgInfo(i,{room_sid:s.kZegoTaskLiveRoomGetRoomMessage.room_sid(n)}),[]);this.stateCenter.useNetAgent?(t=e.body.msg_data,e.body.msg_data.forEach((function(e){e={fromUser:{userID:e.id_name,userName:e.nick_name},message:e.msg_content,sendTime:e.send_time.toNumber(),messageID:e.msg_id.toNumber()},o.push(e)})),e.body.server_msg_id=e.body.server_msg_id.toNumber(),e.body.ret_msg_id=e.body.ret_msg_id.toNumber()):(t=e.body.chat_data,e.body.chat_data.forEach((function(e){o.push({fromUser:{userID:e.id_name,userName:e.nick_name},message:e.msg_content,sendTime:e.send_time,messageID:e.msg_id}),r.dataReport.addMsgInfo(i,{from_msg_id:e.id_name})}))),this.dataReport.uploadReport(i,s.kZegoTaskLiveRoomGetRoomMessage.event),this.stateCenter.actionListener("IMRecvBroadcastMessage",this.room.roomID,o),this.stateCenter.actionListener("_recvRoomMsg",t,e.body.server_msg_id,e.body.ret_msg_id)},l.prototype.sendCustomCommand=function(e,t,r,n){var s=this;return this.room.isLogin()?(t={from_userid:this.stateCenter.idName,from_username:this.stateCenter.nickName,request_id:this.stateCenter.getRequestId(),custom_content:t||"",room_id:this.room.roomID},e={dest_id_name:e,custom_msg:JSON.stringify(t)},(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendCustomCommand(e,(function(e){r({seq:e.header.seq,errorCode:0})}),(function(e){var t=s.rtm.getServerError(e.body.err_code);s.logger.error(i.MESSAGE_SEND_CUSTOM_MSG+" "+t.msg),n({seq:e.header.seq,errorCode:(t==o.TIMEOUT?o.IM_SEND_FAILED:t).code})}),this.room),this.logger.info(i.MESSAGE_SEND_CUSTOM_MSG+" call success"),!0):(this.logger.error(i.MESSAGE_SEND_CUSTOM_MSG+" state error"),n(o.NOT_LOGIN),!1)},l.prototype.handlePushCustomMsg=function(e){var t=(e=[(e=JSON.parse(e.body.custommsg)).from_userid,e.from_username,e.room_id,e.custom_content])[0],r=e[1],n=e[2],i=(e=e[3],this.rtm.getReportSeq());this.dataReport.newReport(i),this.dataReport.uploadReport(i,s.kZegoTaskLiveRoomGetCustomCommand.event),this.stateCenter.actionListener("IMRecvCustomCommand",n,{userID:t,userName:r},e)},l.prototype.sendBigRoomMessage=function(e,t,r,n,s,a){var c,u,l,d,h=this;this.room.isLogin()?(c=this.bigimTimeWindow,u=this.serverTimeOffset,l=(new Date).getTime()+u,d=this.rtm.getSeq().toString(),this.bigImCallbackMap[d]={success:s,error:a},0==c?this.sendBigRoomMessageInternal([{msg_category:e,msg_type:1,msg_content:n,bigmsg_client_id:d}],(function(e){h.handleBigImMsgRsp(e)}),(function(e){a&&a(e)})):(s=Math.floor(l/c),this.bigImLastTimeIndex<s&&0==this.bigIMmessageList.length?(this.bigImLastTimeIndex=s,this.sendBigRoomMessageInternal([{msg_category:e,msg_type:1,msg_content:n,bigmsg_client_id:d}],(function(e){h.handleBigImMsgRsp(e)}),(function(e){a&&a(e)}))):(this.bigIMmessageList.push({msg_category:e,msg_type:1,msg_content:n,bigmsg_client_id:d}),1==this.bigIMmessageList.length&&this.setBigImTimer(u,c)))):(this.logger.error(i.MESSAGE_SEND_BIG_MSG+" state error"),a&&a(o.NOT_LOGIN))},l.prototype.sendBigRoomMessageInternal=function(e,t,r){(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendBigRoomMessage({msgs:e},(function(e){t(e)}),(function(e){var t=o.ROOM_INNER_ERROR;e.header&&e.body||(e.code&&e.msg&&(t=e),r(t)),r(t)}),this.room),this.logger.info(i.MESSAGE_SEND_BIG_MSG+" sendBigRoomMessage called")},l.prototype.handleBigImMsgRsp=function(e){this.bigimTimeWindow=e.body.bigim_time_window;for(var t=0;t<e.body.msgs.length;t++){var r,n=e.body.msgs[t].bigmsg_client_id;this.bigImCallbackMap[n]&&(null!=(r=this.bigImCallbackMap[n].success)&&r({seq:e.header.seq,errorCode:0,messageID:e.body.msgs[t].bigmsg_id}),delete this.bigImCallbackMap[n])}},l.prototype.setBigImTimer=function(e,t){var r=this;e=t-((new Date).getTime()+e)%t,t=this.rtm.generateRandumNumber(t)+e,this.bigImTimer=setTimeout((function(){r.onBigImTimer()}),t)},l.prototype.onBigImTimer=function(){for(var e=this,t=(new Date).getTime()+this.serverTimeOffset,r=(this.bigImLastTimeIndex=Math.floor(t/this.bigimTimeWindow),[]),n=[],i=0;i<this.bigIMmessageList.length&&!(20<=i);i++){var o=this.bigIMmessageList[i];r.push({msg_category:o.msg_category,msg_type:o.msg_type,msg_content:o.msg_content,bigmsg_client_id:o.bigmsg_client_id}),n.push(o.bigmsg_client_id)}20<this.bigIMmessageList.length?this.bigIMmessageList.splice(0,20):this.bigIMmessageList=[],this.sendBigRoomMessageInternal(r,(function(t){e.handleBigImMsgRsp(t)}),(function(t,r){for(var i=0;i<n.length;i++){var o=n[i],s=e.bigImCallbackMap[o];s&&(null!=s.error&&s.error(t,r),delete e.bigImCallbackMap[o])}})),this.bigImTimer&&clearTimeout(this.bigImTimer),this.bigImTimer=null,0<this.bigIMmessageList.length&&this.setBigImTimer(this.serverTimeOffset,this.bigimTimeWindow)},l.prototype.handlePushMergeMsg=function(e){for(var t=0;t<e.body.messages.length;t++)14001!==e.body.messages[t].sub_cmd&&"/lr/push/bigim_chat"!==e.body.messages[t].sub_cmd||this.handlePushBigRooMsg(e.body.messages[t].msg_body)},l.prototype.handlePushBigRooMsg=function(e){var t;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){return void this.logger.warn(i.MESSAGE_BIG_MSG_PUSH+"parse json error")}else t=e;if(t){e=t.room_id;for(var r=[],n=0;n<t.msg_data.length;n++){var o=t.msg_data[n];o.id_name==this.stateCenter.idName?this.logger.info(i.MESSAGE_BIG_MSG_PUSH+" self message"):r.push({idName:o.id_name,nickName:o.nick_name,messageId:o.bigmsg_id,category:o.msg_category,type:o.msg_type,content:o.msg_content,time:o.send_time||c.a.isLong(o.msg_timestamp)&&o.msg_timestamp.toNumber()})}0==r.length?this.logger.info(i.MESSAGE_BIG_MSG_PUSH+" no other pushData except self"):this.onRecvBigRoomMessage(r,e),this.logger.info(i.MESSAGE_BIG_MSG_PUSH+"call success")}else this.logger.warn(i.MESSAGE_BIG_MSG_PUSH+" cann't find message body")},l.prototype.onRecvBigRoomMessage=function(e,t){var r=this.rtm.getReportSeq(),n=(this.dataReport.newReport(r),[]);e.forEach((function(e){n.push(e={fromUser:{userID:e.idName,userName:e.nickName},message:e.content,sendTime:e.time,messageID:e.messageId})})),this.dataReport.uploadReport(r,s.kZegoTaskLiveGetRoomBigIM.event),this.stateCenter.actionListener("IMRecvBarrageMessage",t,n),this.stateCenter.actionListener("_recvBigRoomMessage",e,t)},l.prototype.resetMessageInfo=function(){this.transSeqMap={},this.realyMessageList=[],this.relayTimer&&(clearTimeout(this.relayTimer),this.relayTimer=null),this.bigImLastTimeIndex=0,this.bigIMmessageList=[],this.bigImCallbackMap={},this.bigImTimer&&(clearTimeout(this.bigImTimer),this.bigImTimer=null),this.serverTimeOffset=0,this.datiTimeWindow=0,this.bigimTimeWindow=0},l.prototype.sendRelayMessage=function(e,t,r,n){var i=this.datiTimeWindow,o=this.serverTimeOffset;0<i?(this.realyMessageList.push({type:e,data:t,success:r,error:n}),1==this.realyMessageList.length&&this.setRelayTimer(o,i)):this.sendRelayMessageInternal(e,t,r,n)},l.prototype.sendRelayMessageInternal=function(e,t,r,n){var s=this;this.logger.info(i.MESSAGE_SEND_RELAY_MSG+" call"),(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendRelayMessage(e={relay_type:e,relay_data:t},(function(e){r&&r(e.header.seq,e.body.relay_result)}),(function(e){var t=o.ROOM_INNER_ERROR;e.header&&e.body?n&&n(s.rtm.getServerError(e.body.err_code),e.header.seq):(e.code&&e.msg&&(t=e),n&&n(t,0))}),t=this.room)},l.prototype.setRelayTimer=function(e,t){var r=this;e=(new Date).getTime()+e,e=this.rtm.generateRandumNumber(2*t-e%t),this.logger.info(i.MESSAGE_SEND_RELAY_MSG+" setTimer "+e),this.relayTimer=setTimeout((function(){r.onRelayTimer()}),e)},l.prototype.onRelayTimer=function(){var e;0==this.realyMessageList.length?this.logger.info(i.MESSAGE_SEND_RELAY_MSG+"  no relay data"):(this.sendRelayMessageInternal((e=this.realyMessageList[0]).type,e.data,e.success,e.error),this.relayTimer&&clearTimeout(this.relayTimer),this.relayTimer=null,this.realyMessageList.splice(0,1),0<this.realyMessageList.length&&this.setRelayTimer(this.serverTimeOffset,this.datiTimeWindow))},l.prototype.getRoomChatInfo=function(e,t,r,n){this.logger.debug("zb.mh.grc call"),this.room.isLogin()?(this.service.sendMessage("zegochat_js.room_im_chat_fetch",e={room_header:{room_id:this.room.roomID,room_sid:this.room.roomSid||"0",room_user_session_id:this.room.roomSessionID||"0"},msg_id:e,msg_count:t},t=function(e,t){0!==e.body.code?n({errorCode:e.body.code,extendData:e.body.message||""}):(e=e.body.msg_data.map((function(e){return{fromUser:{userID:e.user_id,userName:e.user_name},message:e.msg_content,sendTime:e.send_time,messageID:e.msg_id}})),r({chatData:e}))},t),this.logger.info("zb.mh.grc call success")):this.logger.error("zb.mh.srm no enter room")},l);function l(e,t,r,n,i,o,s){var a=this;this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=n,this.liveRoomHandler=i,this.rtm=o,this.room=s,this.sendRoomMsgTime=0,this.sendRoomMsgInterval=500,this.bigImCallbackMap={},this.bigImLastTimeIndex=0,this.bigIMmessageList=[],this.bigImTimer=null,this.relayTimer=null,this.serverTimeOffset=0,this.datiTimeWindow=0,this.bigimTimeWindow=0,this.isReliable=!1,this.transSeqMap={},this.onRecvReliableMessage=function(e){var t=e.map((function(e){return{key:e.trans_type,value:e.trans_data,updateUser:{userID:e.trans_idname,userName:e.trans_nickname},updateTime:c.a.isLong(e.trans_send_time)?e.trans_send_time.toNumber():e.trans_send_time}}));0<t.length&&a.stateCenter.actionListener("roomExtraInfoUpdate",a.room.roomID,t),e.forEach((function(e){a.stateCenter.actionListener("recvReliableMessage",e.trans_type,e.trans_seq,e.trans_data)}))},this.realyMessageList=[]}function d(e,t,r,n){var o=this;return void 0===r&&(r=1),void 0===n&&(n=1),new Promise((function(a,c){var u,l=o.getReportSeq();c=(o.dataReport.newReport(l,s.kZegoTaskLiveRoomSendRoomMessage.event),a=o.proxyRes(o.dataReport,l,a,c)).interResolve,a=a.interReject,"string"!=typeof e||""==e?(o.logger.error(i.RTM_SEND_BCM+" roomid must be string and not empty"),a(s.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param roomID error")):void 0===t||""==t?(o.logger.error(i.RTM_SEND_BCM+" message is empty"),a(s.kZegoTaskLiveRoomSendRoomMessage.error.IM_CONTENT_NULL)):"string"!=typeof t?(o.logger.error(i.RTM_SEND_BCM+" message must be string"),a(s.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param message error")):1024<t.length?(o.logger.error(i.RTM_SEND_BCM+" message too long"),a(s.kZegoTaskLiveRoomSendRoomMessage.error.IM_CONTENT_TOO_LONG)):(u=o.getRoomModules(e))?(o.dataReport.addMsgInfo(l,{room_sid:s.kZegoTaskLiveRoomSendRoomMessage.room_sid(u.sessionID)}),u.messageHandler.sendRoomMsg(r,n,e,t,c,a)):a(s.kZegoTaskLiveRoomSendRoomMessage.error.ROOM_NOT_EXIST)}))}function h(e,t,r){var n=this;return new Promise((function(a,c){var u,l=n.getReportSeq();c=(n.dataReport.newReport(l,s.kZegoTaskLiveRoomSendCustomCommand.event),a=n.proxyRes(n.dataReport,l,a,c)).interResolve,a=a.interReject,"string"!=typeof e||""==e?(n.logger.error(i.RTM_SEND_CUSTOM+" roomid must be string and not empty"),a(o.INPUT_PARAM," param roomID error")):r instanceof Array&&!r.find((function(e){return"string"!=typeof e}))?"string"!=typeof t&&"object"!=typeof t?(n.logger.error(i.RTM_SEND_CUSTOM+" custom content must be a non empty string or object"),a(s.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param command error")):"string"==typeof t&&1024<t.length?(n.logger.error(i.RTM_SEND_CUSTOM+" command too long"),a(s.kZegoTaskLiveRoomSendCustomCommand.error.IM_CONTENT_TOO_LONG)):(u=n.getRoomModules(e))?(n.dataReport.addMsgInfo(l,{room_sid:s.kZegoTaskLiveRoomSendCustomCommand.room_sid(u.sessionID)}),u.messageHandler.sendCustomCommand(r,t,c,a)):a(s.kZegoTaskLiveRoomSendCustomCommand.error.ROOM_NOT_EXIST):(n.logger.error(i.RTM_SEND_CUSTOM+" dstMembers must be string array"),a(s.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param toUserList error"))}))}function p(e,t,r,n){var o=this;return void 0===r&&(r=1),void 0===n&&(n=1),new Promise((function(a,c){var u,l=o.getReportSeq();c=(o.dataReport.newReport(l,s.kZegoTaskLiveSendRoomBigIM.event),a=o.proxyRes(o.dataReport,l,a,c)).interResolve,a=a.interReject,"string"!=typeof e||""==e?(o.logger.error(i.RTM_SEND_BRM+"roomid must be string and not empty"),a(s.kZegoTaskLiveSendRoomBigIM.error.INPUT_PARAM," param roomID error")):void 0===t||""==t?(o.logger.error(i.RTM_SEND_BRM+" message is empty"),a(s.kZegoTaskLiveSendRoomBigIM.error.IM_CONTENT_NULL)):"string"!=typeof t?(o.logger.error(i.RTM_SEND_BRM+" message must be string"),a(s.kZegoTaskLiveSendRoomBigIM.error.INPUT_PARAM," param message error")):1024<t.length?(o.logger.error(i.RTM_SEND_BRM+" message too long"),a(s.kZegoTaskLiveSendRoomBigIM.error.IM_CONTENT_TOO_LONG)):(u=o.getRoomModules(e))?(o.dataReport.addMsgInfo(l,{room_sid:s.kZegoTaskLiveSendRoomBigIM.room_sid(u.sessionID)}),u.messageHandler.sendBigRoomMessage(r,n,e,t,c,a)):a(s.kZegoTaskLiveSendRoomBigIM.error.ROOM_NOT_EXIST)}))}function f(e,t,r){var n=this;return new Promise((function(o,a){var c,u=n.getReportSeq();a=(n.dataReport.newReport(u,s.kZegoTaskLiveRoomSendReliableMessage.event),o=n.proxyRes(n.dataReport,u,o,a)).interResolve,o=o.interReject,"string"!=typeof e||""==e?(n.logger.error(i.RTM_SEND_BCM+" roomid must be string and not empty"),o(s.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param roomID error")):t&&"string"==typeof t?128<t.length?(n.logger.error(i.RTM_SEND_RLM+" type is too long"),o({errorCode:s.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code})):"string"!=typeof r?(n.logger.error(i.RTM_SEND_RLM+" data must be string"),o({errorCode:s.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code})):4096<r.length?(n.logger.error(i.RTM_SEND_RLM+" type is too long"),o({errorCode:s.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code})):(c=n.getRoomModules(e))?(n.dataReport.addMsgInfo(u,{room_sid:s.kZegoTaskLiveRoomSendReliableMessage.room_sid(c.sessionID)}),c.messageHandler.sendReliableMessage(t,r,a,o)):o(s.kZegoTaskLiveRoomSendReliableMessage.error.ROOM_NOT_EXIST):(n.logger.error(i.RTM_SEND_RLM+" type must be string"),o({errorCode:s.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code}))}))}var g={_sendBroadcastMessage:d,sendBroadcastMessage:function(e,t){var r=this;return new Promise((function(n,i){d.call(r,e,t).then((function(e){n({errorCode:e.errorCode,messageID:e.messageID,extendedData:e.extendedData})})).catch((function(e){i(e)}))}))},_sendCustomCommand:h,sendCustomCommand:function(e,t,r){var n=this;return new Promise((function(i,o){h.call(n,e,t,r).then((function(e){i({errorCode:e.errorCode,extendedData:e.extendedData})})).catch((function(e){o(e)}))}))},_sendBarrageMessage:p,sendBarrageMessage:function(e,t){var r=this;return new Promise((function(n,i){p.call(r,e,t).then((function(e){n({errorCode:e.errorCode,messageID:e.messageID,extendedData:e.extendedData})})).catch((function(e){i(e)}))}))},_setRoomExtraInfo:f,setRoomExtraInfo:function(e,t,r){return f.call(this,e,t,r)},sendRelayMessage:function(e,t,r,n,i){(i=this.getRoomModules(i)||this.stateCenter.roomModulesList[0])?i.messageHandler.sendRelayMessage(e,t,r,n):n&&n(o.ROOM_NOT_EXIST,0)}},m={handlePushRoomMsg:function(e){var t=this.handlePushMsg(e);t[0].messageHandler.handlePushRoomMsg(e=t[1])},handlePushCustomMsg:function(e){var t=this.handlePushMsg(e);t[0].messageHandler.handlePushCustomMsg(e=t[1])},handlePushMergeMsg:function(e){var t=null==(t=null==e?void 0:e.header)?void 0:t.room_id;(t=this.rtm.getRoomModules(t))?t.messageHandler.handlePushMergeMsg(e):this.logger.error(i.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))},handlePushTransMsg:function(e){var t=this.handlePushMsg(e);t[0].messageHandler.handlePushTransMsg(e=t[1])},handleBigImMsgRsp:function(e){var t=null==(t=null==e?void 0:e.header)?void 0:t.room_id;(t=this.rtm.getRoomModules(t))?t.messageHandler.handleBigImMsgRsp(e):this.logger.error(i.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))},handlePushMsg:function(e){var t=null==(t=null==e?void 0:e.header)?void 0:t.room_id;if(t=this.rtm.getRoomModules(t))return[t,e];this.logger.error(i.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}},_={initMessageHandler:function(){this.messageHandler=new u(this.logger,this.stateCenter,this.dataReport,this.service,this.liveRoomHandler,this.rtm,this)}};t.default={type:"message",install:function(e,t,r,n){for(var i in g)Object.defineProperty(e.prototype,i,{value:g[i],writable:!1});for(var i in m)Object.defineProperty(r.prototype,i,{value:m[i],writable:!1}),Object.defineProperty(n.prototype,i,{value:m[i],writable:!1});for(var i in _)Object.defineProperty(t.prototype,i,{value:_[i],writable:!1})}}}},r={},e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var i in t)e.d(n,i,function(e){return t[e]}.bind(null,i));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=22);function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var t,r}()},4119:function(e){"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__4119__}},__webpack_module_cache__={};function __nested_webpack_require_1364692__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__nested_webpack_require_1364692__),r.exports}__nested_webpack_require_1364692__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var __webpack_exports__=__nested_webpack_require_1364692__(4780);return __webpack_exports__}()},module.exports=t(__webpack_require__(3068))},3068:function(e,t,r){"undefined"!=typeof self&&self,e.exports=function(e){return r=[function(e,t,r){"use strict";var n,i,o=(r=r(6)).Reader,s=r.Writer,a=r.util,c=r.roots.default||(r.roots.default={});function u(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function l(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function d(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function h(e){if(this.stream_info=[],this.stream_mix_info=[],this.trans_seqs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function p(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function f(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function g(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function m(e){if(this.trans_seq_array=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function _(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function v(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function y(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function E(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function S(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function b(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function T(e){if(this.redirect_server=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function C(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function R(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function O(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function k(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function I(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function L(e){if(this.messages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function w(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function A(e){if(this.messages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function N(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function P(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function M(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function D(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function U(e){if(this.trans_seqs=[],this.user_trans_seqs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function x(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function B(e){if(this.trans_seq_array=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function j(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function H(e){if(this.user_basic_list=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function G(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function z(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function q(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function V(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function F(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Z(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function W(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Y(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Q(e){if(this.stream_info=[],this.stream_mix_info=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function K(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function J(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function X(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function $(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ee(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function te(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function re(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ne(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ie(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function oe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function se(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ae(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ce(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ue(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function le(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function de(e){if(this.msg_data=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function he(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function pe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function fe(e){if(this.stream_info=[],this.stream_mix_info=[],this.trans_seqs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ge(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function me(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function _e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ve(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ye(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ee(e){if(this.room_list=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Se(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function be(e){if(this.stream_list=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Te(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ce(e){if(this.trans_seq_array=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Re(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Oe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ke(e){if(this.fetch_array=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ie(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Le(e){if(this.trans_fetch_results=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function we(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ae(e){if(this.fetch_array=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ne(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Pe(e){if(this.trans_fetch_results=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Me(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function De(e){if(this.msgs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ue(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function xe(e){if(this.msgs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Be(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function je(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function He(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ge(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ze(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function qe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ve(e){if(this.user_list=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Fe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ze(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function We(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ye(e){if(this.stream_id_list=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Qe(e){if(this.stream_info=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ke(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Je(e){if(this.msg_data=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Xe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function $e(e){if(this.msg_data=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function et(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function tt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function rt(e){if(this.trans_array=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function nt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}c.proto_switch=((r={}).CommonRsp=(u.prototype.rsp_head=null,u.create=function(e){return new u(e)},u.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},u.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.CommonRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.proto_switch.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},u),r.RspHead=(l.prototype.code=0,l.prototype.message="",l.create=function(e){return new l(e)},l.encode=function(e,t){return t=t||s.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},l.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.RspHead;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.code=e.uint32();break;case 2:n.message=e.string();break;default:e.skipType(7&i)}}return n},l),r.LoginRoomReq=(d.prototype.app_id=0,d.prototype.id_name=a.newBuffer([]),d.prototype.device_id="",d.prototype.term_type=0,d.prototype.net_type=0,d.prototype.sdk_ver=0,d.prototype.proto_ver=0,d.prototype.nick_name=a.newBuffer([]),d.prototype.client_stamp=a.newBuffer([]),d.prototype.crypt_version=0,d.prototype.k1_sign=a.newBuffer([]),d.prototype.login_token=a.newBuffer([]),d.prototype.relogin_token=a.newBuffer([]),d.prototype.role=0,d.prototype.liveroom_session_id=a.Long?a.Long.fromBits(0,0,!0):0,d.prototype.room_id=a.newBuffer([]),d.prototype.room_name=a.newBuffer([]),d.prototype.biz_type=0,d.prototype.room_create_flag=0,d.prototype.user_state_flag=0,d.prototype.lv_key="",d.prototype.third_token=a.newBuffer([]),d.prototype.cluster_req=0,d.prototype.user_count_limit=0,d.prototype.relate_service="",d.prototype.biz_version="",d.prototype.login_logic=0,d.prototype.sdk_conn_type=0,d.create=function(e){return new d(e)},d.encode=function(e,t){return t=t||s.create(),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(18).bytes(e.id_name),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(26).string(e.device_id),null!=e.term_type&&Object.hasOwnProperty.call(e,"term_type")&&t.uint32(32).int32(e.term_type),null!=e.net_type&&Object.hasOwnProperty.call(e,"net_type")&&t.uint32(40).int32(e.net_type),null!=e.sdk_ver&&Object.hasOwnProperty.call(e,"sdk_ver")&&t.uint32(48).uint32(e.sdk_ver),null!=e.proto_ver&&Object.hasOwnProperty.call(e,"proto_ver")&&t.uint32(56).int32(e.proto_ver),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(66).bytes(e.nick_name),null!=e.client_stamp&&Object.hasOwnProperty.call(e,"client_stamp")&&t.uint32(74).bytes(e.client_stamp),null!=e.crypt_version&&Object.hasOwnProperty.call(e,"crypt_version")&&t.uint32(80).uint32(e.crypt_version),null!=e.k1_sign&&Object.hasOwnProperty.call(e,"k1_sign")&&t.uint32(90).bytes(e.k1_sign),null!=e.login_token&&Object.hasOwnProperty.call(e,"login_token")&&t.uint32(98).bytes(e.login_token),null!=e.relogin_token&&Object.hasOwnProperty.call(e,"relogin_token")&&t.uint32(106).bytes(e.relogin_token),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(112).uint32(e.role),null!=e.liveroom_session_id&&Object.hasOwnProperty.call(e,"liveroom_session_id")&&t.uint32(120).uint64(e.liveroom_session_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(130).bytes(e.room_id),null!=e.room_name&&Object.hasOwnProperty.call(e,"room_name")&&t.uint32(138).bytes(e.room_name),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(144).uint32(e.biz_type),null!=e.room_create_flag&&Object.hasOwnProperty.call(e,"room_create_flag")&&t.uint32(152).uint32(e.room_create_flag),null!=e.user_state_flag&&Object.hasOwnProperty.call(e,"user_state_flag")&&t.uint32(160).uint32(e.user_state_flag),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(170).string(e.lv_key),null!=e.third_token&&Object.hasOwnProperty.call(e,"third_token")&&t.uint32(178).bytes(e.third_token),null!=e.cluster_req&&Object.hasOwnProperty.call(e,"cluster_req")&&t.uint32(184).uint32(e.cluster_req),null!=e.user_count_limit&&Object.hasOwnProperty.call(e,"user_count_limit")&&t.uint32(192).uint32(e.user_count_limit),null!=e.relate_service&&Object.hasOwnProperty.call(e,"relate_service")&&t.uint32(202).string(e.relate_service),null!=e.biz_version&&Object.hasOwnProperty.call(e,"biz_version")&&t.uint32(210).string(e.biz_version),null!=e.login_logic&&Object.hasOwnProperty.call(e,"login_logic")&&t.uint32(216).uint32(e.login_logic),null!=e.sdk_conn_type&&Object.hasOwnProperty.call(e,"sdk_conn_type")&&t.uint32(224).int32(e.sdk_conn_type),t},d.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.LoginRoomReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.app_id=e.uint32();break;case 2:n.id_name=e.bytes();break;case 3:n.device_id=e.string();break;case 4:n.term_type=e.int32();break;case 5:n.net_type=e.int32();break;case 6:n.sdk_ver=e.uint32();break;case 7:n.proto_ver=e.int32();break;case 8:n.nick_name=e.bytes();break;case 9:n.client_stamp=e.bytes();break;case 10:n.crypt_version=e.uint32();break;case 11:n.k1_sign=e.bytes();break;case 12:n.login_token=e.bytes();break;case 13:n.relogin_token=e.bytes();break;case 14:n.role=e.uint32();break;case 15:n.liveroom_session_id=e.uint64();break;case 16:n.room_id=e.bytes();break;case 17:n.room_name=e.bytes();break;case 18:n.biz_type=e.uint32();break;case 19:n.room_create_flag=e.uint32();break;case 20:n.user_state_flag=e.uint32();break;case 21:n.lv_key=e.string();break;case 22:n.third_token=e.bytes();break;case 23:n.cluster_req=e.uint32();break;case 24:n.user_count_limit=e.uint32();break;case 25:n.relate_service=e.string();break;case 26:n.biz_version=e.string();break;case 27:n.login_logic=e.uint32();break;case 28:n.sdk_conn_type=e.int32();break;default:e.skipType(7&i)}}return n},d),r.LoginRoomRsp=(h.prototype.rsp_head=null,h.prototype.room_id=a.newBuffer([]),h.prototype.heartbeat_interval=0,h.prototype.heartbeat_timeout=0,h.prototype.ret_timestamp=a.Long?a.Long.fromBits(0,0,!1):0,h.prototype.crypt_option=0,h.prototype.k2_sign=a.newBuffer([]),h.prototype.liveroom_session_id=a.Long?a.Long.fromBits(0,0,!0):0,h.prototype.liveroom_hb_interval=0,h.prototype.liveroom_hb_timeout=0,h.prototype.anchor_info=null,h.prototype.stream_seq=0,h.prototype.stream_info=a.emptyArray,h.prototype.stream_fetch_flag=0,h.prototype.lv_key="",h.prototype.zp_key="",h.prototype.online_count=0,h.prototype.bigim_time_window=0,h.prototype.dati_time_window=0,h.prototype.cluster_name="",h.prototype.relogin_token=a.newBuffer([]),h.prototype.stream_mix_info=a.emptyArray,h.prototype.userlist_merge_timeout=0,h.prototype.userlist_interval=0,h.prototype.room_session_id=a.Long?a.Long.fromBits(0,0,!0):0,h.prototype.trans_seqs=a.emptyArray,h.prototype.stream_list_push_merge_timeout=0,h.prototype.stream_list_hb_wait_merge_time=0,h.prototype.trans_list_seq=0,h.prototype.token_remain_time=0,h.create=function(e){return new h(e)},h.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.heartbeat_interval&&Object.hasOwnProperty.call(e,"heartbeat_interval")&&t.uint32(24).uint32(e.heartbeat_interval),null!=e.heartbeat_timeout&&Object.hasOwnProperty.call(e,"heartbeat_timeout")&&t.uint32(32).uint32(e.heartbeat_timeout),null!=e.ret_timestamp&&Object.hasOwnProperty.call(e,"ret_timestamp")&&t.uint32(40).int64(e.ret_timestamp),null!=e.crypt_option&&Object.hasOwnProperty.call(e,"crypt_option")&&t.uint32(48).uint32(e.crypt_option),null!=e.k2_sign&&Object.hasOwnProperty.call(e,"k2_sign")&&t.uint32(58).bytes(e.k2_sign),null!=e.liveroom_session_id&&Object.hasOwnProperty.call(e,"liveroom_session_id")&&t.uint32(64).uint64(e.liveroom_session_id),null!=e.liveroom_hb_interval&&Object.hasOwnProperty.call(e,"liveroom_hb_interval")&&t.uint32(72).uint32(e.liveroom_hb_interval),null!=e.liveroom_hb_timeout&&Object.hasOwnProperty.call(e,"liveroom_hb_timeout")&&t.uint32(80).uint32(e.liveroom_hb_timeout),null!=e.anchor_info&&Object.hasOwnProperty.call(e,"anchor_info")&&c.proto_switch.StAnchorInfo.encode(e.anchor_info,t.uint32(90).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(96).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var r=0;r<e.stream_info.length;++r)c.proto_switch.StStreamInfo.encode(e.stream_info[r],t.uint32(106).fork()).ldelim();if(null!=e.stream_fetch_flag&&Object.hasOwnProperty.call(e,"stream_fetch_flag")&&t.uint32(112).uint32(e.stream_fetch_flag),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(122).string(e.lv_key),null!=e.zp_key&&Object.hasOwnProperty.call(e,"zp_key")&&t.uint32(130).string(e.zp_key),null!=e.online_count&&Object.hasOwnProperty.call(e,"online_count")&&t.uint32(136).uint32(e.online_count),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(144).uint32(e.bigim_time_window),null!=e.dati_time_window&&Object.hasOwnProperty.call(e,"dati_time_window")&&t.uint32(152).uint32(e.dati_time_window),null!=e.cluster_name&&Object.hasOwnProperty.call(e,"cluster_name")&&t.uint32(162).string(e.cluster_name),null!=e.relogin_token&&Object.hasOwnProperty.call(e,"relogin_token")&&t.uint32(170).bytes(e.relogin_token),null!=e.stream_mix_info&&e.stream_mix_info.length)for(r=0;r<e.stream_mix_info.length;++r)c.proto_switch.StStreamInfo.encode(e.stream_mix_info[r],t.uint32(178).fork()).ldelim();if(null!=e.userlist_merge_timeout&&Object.hasOwnProperty.call(e,"userlist_merge_timeout")&&t.uint32(184).uint32(e.userlist_merge_timeout),null!=e.userlist_interval&&Object.hasOwnProperty.call(e,"userlist_interval")&&t.uint32(192).uint32(e.userlist_interval),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(200).uint64(e.room_session_id),null!=e.trans_seqs&&e.trans_seqs.length)for(r=0;r<e.trans_seqs.length;++r)c.proto_switch.StTransInfo.encode(e.trans_seqs[r],t.uint32(210).fork()).ldelim();return null!=e.stream_list_push_merge_timeout&&Object.hasOwnProperty.call(e,"stream_list_push_merge_timeout")&&t.uint32(216).uint32(e.stream_list_push_merge_timeout),null!=e.stream_list_hb_wait_merge_time&&Object.hasOwnProperty.call(e,"stream_list_hb_wait_merge_time")&&t.uint32(224).uint32(e.stream_list_hb_wait_merge_time),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(232).uint32(e.trans_list_seq),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(240).uint32(e.token_remain_time),t},h.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.LoginRoomRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.proto_switch.RspHead.decode(e,e.uint32());break;case 2:n.room_id=e.bytes();break;case 3:n.heartbeat_interval=e.uint32();break;case 4:n.heartbeat_timeout=e.uint32();break;case 5:n.ret_timestamp=e.int64();break;case 6:n.crypt_option=e.uint32();break;case 7:n.k2_sign=e.bytes();break;case 8:n.liveroom_session_id=e.uint64();break;case 9:n.liveroom_hb_interval=e.uint32();break;case 10:n.liveroom_hb_timeout=e.uint32();break;case 11:n.anchor_info=c.proto_switch.StAnchorInfo.decode(e,e.uint32());break;case 12:n.stream_seq=e.uint32();break;case 13:n.stream_info&&n.stream_info.length||(n.stream_info=[]),n.stream_info.push(c.proto_switch.StStreamInfo.decode(e,e.uint32()));break;case 14:n.stream_fetch_flag=e.uint32();break;case 15:n.lv_key=e.string();break;case 16:n.zp_key=e.string();break;case 17:n.online_count=e.uint32();break;case 18:n.bigim_time_window=e.uint32();break;case 19:n.dati_time_window=e.uint32();break;case 20:n.cluster_name=e.string();break;case 21:n.relogin_token=e.bytes();break;case 22:n.stream_mix_info&&n.stream_mix_info.length||(n.stream_mix_info=[]),n.stream_mix_info.push(c.proto_switch.StStreamInfo.decode(e,e.uint32()));break;case 23:n.userlist_merge_timeout=e.uint32();break;case 24:n.userlist_interval=e.uint32();break;case 25:n.room_session_id=e.uint64();break;case 26:n.trans_seqs&&n.trans_seqs.length||(n.trans_seqs=[]),n.trans_seqs.push(c.proto_switch.StTransInfo.decode(e,e.uint32()));break;case 27:n.stream_list_push_merge_timeout=e.uint32();break;case 28:n.stream_list_hb_wait_merge_time=e.uint32();break;case 29:n.trans_list_seq=e.uint32();break;case 30:n.token_remain_time=e.uint32();break;default:e.skipType(7&i)}}return n},h),r.StAnchorInfo=(p.prototype.anchor_id_name=a.newBuffer([]),p.prototype.anchor_id=a.Long?a.Long.fromBits(0,0,!0):0,p.prototype.anchor_nick_name=a.newBuffer([]),p.create=function(e){return new p(e)},p.encode=function(e,t){return t=t||s.create(),null!=e.anchor_id_name&&Object.hasOwnProperty.call(e,"anchor_id_name")&&t.uint32(10).bytes(e.anchor_id_name),null!=e.anchor_id&&Object.hasOwnProperty.call(e,"anchor_id")&&t.uint32(16).uint64(e.anchor_id),null!=e.anchor_nick_name&&Object.hasOwnProperty.call(e,"anchor_nick_name")&&t.uint32(26).bytes(e.anchor_nick_name),t},p.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.StAnchorInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.anchor_id_name=e.bytes();break;case 2:n.anchor_id=e.uint64();break;case 3:n.anchor_nick_name=e.bytes();break;default:e.skipType(7&i)}}return n},p),r.StStreamInfo=(f.prototype.stream_id=a.newBuffer([]),f.prototype.stream_sid="",f.prototype.id_name=a.newBuffer([]),f.prototype.nick_name=a.newBuffer([]),f.prototype.create_time=a.Long?a.Long.fromBits(0,0,!1):0,f.prototype.extra_info=a.newBuffer([]),f.prototype.title=a.newBuffer([]),f.prototype.stream_ver=0,f.prototype.stream_attr=a.newBuffer([]),f.prototype.stream_src=0,f.prototype.stream_state=0,f.prototype.stream_type=0,f.prototype.stream_nid=0,f.create=function(e){return new f(e)},f.encode=function(e,t){return t=t||s.create(),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(10).bytes(e.stream_id),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(26).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(41).fixed64(e.create_time),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(50).bytes(e.extra_info),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(58).bytes(e.title),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(64).uint32(e.stream_ver),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(74).bytes(e.stream_attr),null!=e.stream_src&&Object.hasOwnProperty.call(e,"stream_src")&&t.uint32(80).uint32(e.stream_src),null!=e.stream_state&&Object.hasOwnProperty.call(e,"stream_state")&&t.uint32(88).uint32(e.stream_state),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(96).uint32(e.stream_type),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(104).uint32(e.stream_nid),t},f.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.StStreamInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.stream_id=e.bytes();break;case 2:n.stream_sid=e.string();break;case 3:n.id_name=e.bytes();break;case 4:n.nick_name=e.bytes();break;case 5:n.create_time=e.fixed64();break;case 6:n.extra_info=e.bytes();break;case 7:n.title=e.bytes();break;case 8:n.stream_ver=e.uint32();break;case 9:n.stream_attr=e.bytes();break;case 10:n.stream_src=e.uint32();break;case 11:n.stream_state=e.uint32();break;case 12:n.stream_type=e.uint32();break;case 13:n.stream_nid=e.uint32();break;default:e.skipType(7&i)}}return n},f),r.StTransSeqInfo=(g.prototype.trans_type=a.newBuffer([]),g.prototype.trans_seq=0,g.create=function(e){return new g(e)},g.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(16).uint32(e.trans_seq),t},g.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.StTransSeqInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_seq=e.uint32();break;default:e.skipType(7&i)}}return n},g),r.StTransInfo=(m.prototype.trans_channel=a.newBuffer([]),m.prototype.trans_seq_array=a.emptyArray,m.create=function(e){return new m(e)},m.encode=function(e,t){if(t=t||s.create(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(10).bytes(e.trans_channel),null!=e.trans_seq_array&&e.trans_seq_array.length)for(var r=0;r<e.trans_seq_array.length;++r)c.proto_switch.StTransSeqInfo.encode(e.trans_seq_array[r],t.uint32(18).fork()).ldelim();return t},m.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.StTransInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_channel=e.bytes();break;case 2:n.trans_seq_array&&n.trans_seq_array.length||(n.trans_seq_array=[]),n.trans_seq_array.push(c.proto_switch.StTransSeqInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},m),r.LogoutRoomReq=(_.prototype.logout_code=0,_.prototype.logout_check=a.newBuffer([]),_.prototype.liveroom_session_id=a.Long?a.Long.fromBits(0,0,!0):0,_.prototype.room_id=a.newBuffer([]),_.prototype.role=0,_.prototype.nickname=a.newBuffer([]),_.prototype.logout_logic=0,_.create=function(e){return new _(e)},_.encode=function(e,t){return t=t||s.create(),null!=e.logout_code&&Object.hasOwnProperty.call(e,"logout_code")&&t.uint32(8).uint32(e.logout_code),null!=e.logout_check&&Object.hasOwnProperty.call(e,"logout_check")&&t.uint32(18).bytes(e.logout_check),null!=e.liveroom_session_id&&Object.hasOwnProperty.call(e,"liveroom_session_id")&&t.uint32(24).uint64(e.liveroom_session_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(34).bytes(e.room_id),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(40).uint32(e.role),null!=e.nickname&&Object.hasOwnProperty.call(e,"nickname")&&t.uint32(50).bytes(e.nickname),null!=e.logout_logic&&Object.hasOwnProperty.call(e,"logout_logic")&&t.uint32(56).uint32(e.logout_logic),t},_.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.LogoutRoomReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.logout_code=e.uint32();break;case 2:n.logout_check=e.bytes();break;case 3:n.liveroom_session_id=e.uint64();break;case 4:n.room_id=e.bytes();break;case 5:n.role=e.uint32();break;case 6:n.nickname=e.bytes();break;case 7:n.logout_logic=e.uint32();break;default:e.skipType(7&i)}}return n},_),r.LogoutRoomRsp=(v.prototype.rsp_head=null,v.create=function(e){return new v(e)},v.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},v.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.LogoutRoomRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.proto_switch.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},v),r.TcpHbReq=(y.prototype.id_name=a.newBuffer([]),y.create=function(e){return new y(e)},y.encode=function(e,t){return t=t||s.create(),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),t},y.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.TcpHbReq;e.pos<r;){var i=e.uint32();i>>>3==1?n.id_name=e.bytes():e.skipType(7&i)}return n},y),r.TcpHbRsp=(E.prototype.rsp_head=null,E.prototype.heartbeat_interval=0,E.prototype.heartbeat_timeout=0,E.prototype.server_timestamp=a.Long?a.Long.fromBits(0,0,!1):0,E.create=function(e){return new E(e)},E.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.heartbeat_interval&&Object.hasOwnProperty.call(e,"heartbeat_interval")&&t.uint32(16).uint32(e.heartbeat_interval),null!=e.heartbeat_timeout&&Object.hasOwnProperty.call(e,"heartbeat_timeout")&&t.uint32(24).uint32(e.heartbeat_timeout),null!=e.server_timestamp&&Object.hasOwnProperty.call(e,"server_timestamp")&&t.uint32(32).int64(e.server_timestamp),t},E.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.TcpHbRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.proto_switch.RspHead.decode(e,e.uint32());break;case 2:n.heartbeat_interval=e.uint32();break;case 3:n.heartbeat_timeout=e.uint32();break;case 4:n.server_timestamp=e.int64();break;default:e.skipType(7&i)}}return n},E),r.TermType=(i={},(n=Object.create(i))[i[0]="TT_NONE"]=0,n[i[1]="TT_PC"]=1,n[i[2]="TT_IOS"]=2,n[i[3]="TT_ANDROID"]=3,n[i[4]="TT_MAC"]=4,n[i[5]="TT_LINUX"]=5,n[i[6]="TT_WEB"]=6,n[i[7]="TT_MINIPROGRAM"]=7,n[i[32]="TT_UNKNOWN"]=32,n),r.NetType=(i={},(n=Object.create(i))[i[0]="NT_NONE"]=0,n[i[1]="NT_LINE"]=1,n[i[2]="NT_WIFI"]=2,n[i[3]="NT_2G"]=3,n[i[4]="NT_3G"]=4,n[i[5]="NT_4G"]=5,n[i[32]="NT_UNKNOWN"]=32,n),r.ProductType=(i={},(n=Object.create(i))[i[0]="PRODUCT_TYPE_NONE"]=0,n[i[1]="PRODUCT_TYPE_LIVEROOM"]=1,n[i[2]="PRODUCT_TYPE_IM"]=2,n),r.LiveroomProtoVersion=(i={},(n=Object.create(i))[i[0]="PROTO_VERSION_NONE"]=0,n[i[131072]="RPOTO_V020000"]=131072,n),r.SdkConnType=(i={},(n=Object.create(i))[i[0]="SdkConnType_None"]=0,n[i[1]="SdkConnType_Tcp"]=1,n[i[2]="SdkConnType_Websocket"]=2,n),r.Header=(S.prototype.cmd="",S.prototype.seq=0,S.prototype.timestamp=a.Long?a.Long.fromBits(0,0,!1):0,S.prototype.app_id=0,S.prototype.user_id="",S.prototype.session_id=a.Long?a.Long.fromBits(0,0,!1):0,S.prototype.user_nid=a.Long?a.Long.fromBits(0,0,!1):0,S.prototype.controls=a.newBuffer([]),S.prototype.product=0,S.prototype.flags=a.newBuffer([]),S.create=function(e){return new S(e)},S.encode=function(e,t){return t=t||s.create(),null!=e.cmd&&Object.hasOwnProperty.call(e,"cmd")&&t.uint32(10).string(e.cmd),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint32(e.seq),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).int64(e.timestamp),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(32).uint32(e.app_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(42).string(e.user_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(48).int64(e.session_id),null!=e.user_nid&&Object.hasOwnProperty.call(e,"user_nid")&&t.uint32(56).int64(e.user_nid),null!=e.controls&&Object.hasOwnProperty.call(e,"controls")&&t.uint32(66).bytes(e.controls),null!=e.product&&Object.hasOwnProperty.call(e,"product")&&t.uint32(72).int32(e.product),null!=e.flags&&Object.hasOwnProperty.call(e,"flags")&&t.uint32(82).bytes(e.flags),t},S.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.Header;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.cmd=e.string();break;case 2:n.seq=e.uint32();break;case 3:n.timestamp=e.int64();break;case 4:n.app_id=e.uint32();break;case 5:n.user_id=e.string();break;case 6:n.session_id=e.int64();break;case 7:n.user_nid=e.int64();break;case 8:n.controls=e.bytes();break;case 9:n.product=e.int32();break;case 10:n.flags=e.bytes();break;default:e.skipType(7&i)}}return n},S),r.PushKickout=(b.prototype.reason=0,b.prototype.message="",b.prototype.need_relogin=0,b.create=function(e){return new b(e)},b.encode=function(e,t){return t=t||s.create(),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(8).uint32(e.reason),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.need_relogin&&Object.hasOwnProperty.call(e,"need_relogin")&&t.uint32(24).uint32(e.need_relogin),t},b.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.PushKickout;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.reason=e.uint32();break;case 2:n.message=e.string();break;case 3:n.need_relogin=e.uint32();break;default:e.skipType(7&i)}}return n},b),r.PushRedirect2Sdk=(T.prototype.redirect_server=a.emptyArray,T.create=function(e){return new T(e)},T.encode=function(e,t){if(t=t||s.create(),null!=e.redirect_server&&e.redirect_server.length)for(var r=0;r<e.redirect_server.length;++r)t.uint32(10).string(e.redirect_server[r]);return t},T.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.PushRedirect2Sdk;e.pos<r;){var i=e.uint32();i>>>3==1?(n.redirect_server&&n.redirect_server.length||(n.redirect_server=[]),n.redirect_server.push(e.string())):e.skipType(7&i)}return n},T),r.PushReq=(C.prototype.head=null,C.prototype.msg_body=a.newBuffer([]),C.create=function(e){return new C(e)},C.encode=function(e,t){return t=t||s.create(),null!=e.head&&Object.hasOwnProperty.call(e,"head")&&c.proto_switch.PushReqHead.encode(e.head,t.uint32(10).fork()).ldelim(),null!=e.msg_body&&Object.hasOwnProperty.call(e,"msg_body")&&t.uint32(18).bytes(e.msg_body),t},C.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.PushReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.head=c.proto_switch.PushReqHead.decode(e,e.uint32());break;case 2:n.msg_body=e.bytes();break;default:e.skipType(7&i)}}return n},C),r.PushReqHead=(R.prototype.sub_cmd="",R.prototype.sender_user_id="",R.prototype.qos_flag=0,R.prototype.msg_id="",R.prototype.send_time=a.Long?a.Long.fromBits(0,0,!1):0,R.prototype.room_id=a.newBuffer([]),R.prototype.sender_user_nid=a.Long?a.Long.fromBits(0,0,!0):0,R.create=function(e){return new R(e)},R.encode=function(e,t){return t=t||s.create(),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(10).string(e.sub_cmd),null!=e.sender_user_id&&Object.hasOwnProperty.call(e,"sender_user_id")&&t.uint32(18).string(e.sender_user_id),null!=e.qos_flag&&Object.hasOwnProperty.call(e,"qos_flag")&&t.uint32(24).uint32(e.qos_flag),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(34).string(e.msg_id),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(40).int64(e.send_time),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(50).bytes(e.room_id),null!=e.sender_user_nid&&Object.hasOwnProperty.call(e,"sender_user_nid")&&t.uint32(56).uint64(e.sender_user_nid),t},R.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.PushReqHead;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sub_cmd=e.string();break;case 2:n.sender_user_id=e.string();break;case 3:n.qos_flag=e.uint32();break;case 4:n.msg_id=e.string();break;case 5:n.send_time=e.int64();break;case 6:n.room_id=e.bytes();break;case 7:n.sender_user_nid=e.uint64();break;default:e.skipType(7&i)}}return n},R),r.PushRsp=(O.prototype.code=0,O.prototype.message="",O.prototype.sub_cmd="",O.prototype.msg_id="",O.prototype.server_send_time=a.Long?a.Long.fromBits(0,0,!1):0,O.create=function(e){return new O(e)},O.encode=function(e,t){return t=t||s.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(26).string(e.sub_cmd),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(34).string(e.msg_id),null!=e.server_send_time&&Object.hasOwnProperty.call(e,"server_send_time")&&t.uint32(40).int64(e.server_send_time),t},O.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.PushRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.code=e.uint32();break;case 2:n.message=e.string();break;case 3:n.sub_cmd=e.string();break;case 4:n.msg_id=e.string();break;case 5:n.server_send_time=e.int64();break;default:e.skipType(7&i)}}return n},O),r.MergePushHead=(k.prototype.qos_flag=0,k.prototype.send_time=a.Long?a.Long.fromBits(0,0,!1):0,k.prototype.room_id=a.newBuffer([]),k.create=function(e){return new k(e)},k.encode=function(e,t){return t=t||s.create(),null!=e.qos_flag&&Object.hasOwnProperty.call(e,"qos_flag")&&t.uint32(8).uint32(e.qos_flag),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(16).int64(e.send_time),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(26).bytes(e.room_id),t},k.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.MergePushHead;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.qos_flag=e.uint32();break;case 2:n.send_time=e.int64();break;case 3:n.room_id=e.bytes();break;default:e.skipType(7&i)}}return n},k),r.MergePushInfo=(I.prototype.sub_cmd="",I.prototype.sub_seq=0,I.prototype.sender_nid=a.Long?a.Long.fromBits(0,0,!0):0,I.prototype.msg_id=a.newBuffer([]),I.prototype.msg_body=a.newBuffer([]),I.prototype.msg_timestamp=a.Long?a.Long.fromBits(0,0,!1):0,I.create=function(e){return new I(e)},I.encode=function(e,t){return t=t||s.create(),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(10).string(e.sub_cmd),null!=e.sub_seq&&Object.hasOwnProperty.call(e,"sub_seq")&&t.uint32(16).uint32(e.sub_seq),null!=e.sender_nid&&Object.hasOwnProperty.call(e,"sender_nid")&&t.uint32(24).uint64(e.sender_nid),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(34).bytes(e.msg_id),null!=e.msg_body&&Object.hasOwnProperty.call(e,"msg_body")&&t.uint32(42).bytes(e.msg_body),null!=e.msg_timestamp&&Object.hasOwnProperty.call(e,"msg_timestamp")&&t.uint32(48).int64(e.msg_timestamp),t},I.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.MergePushInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sub_cmd=e.string();break;case 2:n.sub_seq=e.uint32();break;case 3:n.sender_nid=e.uint64();break;case 4:n.msg_id=e.bytes();break;case 5:n.msg_body=e.bytes();break;case 6:n.msg_timestamp=e.int64();break;default:e.skipType(7&i)}}return n},I),r.CmdMergePushReq=(L.prototype.head=null,L.prototype.messages=a.emptyArray,L.create=function(e){return new L(e)},L.encode=function(e,t){if(t=t||s.create(),null!=e.head&&Object.hasOwnProperty.call(e,"head")&&c.proto_switch.MergePushHead.encode(e.head,t.uint32(10).fork()).ldelim(),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)c.proto_switch.MergePushInfo.encode(e.messages[r],t.uint32(18).fork()).ldelim();return t},L.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.CmdMergePushReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.head=c.proto_switch.MergePushHead.decode(e,e.uint32());break;case 2:n.messages&&n.messages.length||(n.messages=[]),n.messages.push(c.proto_switch.MergePushInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},L),r.CmdMergePushRspInfo=(w.prototype.sub_cmd="",w.prototype.sub_seq=0,w.prototype.msg_id=a.newBuffer([]),w.create=function(e){return new w(e)},w.encode=function(e,t){return t=t||s.create(),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(10).string(e.sub_cmd),null!=e.sub_seq&&Object.hasOwnProperty.call(e,"sub_seq")&&t.uint32(16).uint32(e.sub_seq),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(26).bytes(e.msg_id),t},w.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.CmdMergePushRspInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sub_cmd=e.string();break;case 2:n.sub_seq=e.uint32();break;case 3:n.msg_id=e.bytes();break;default:e.skipType(7&i)}}return n},w),r.CmdMergePushRsp=(A.prototype.messages=a.emptyArray,A.create=function(e){return new A(e)},A.encode=function(e,t){if(t=t||s.create(),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)c.proto_switch.CmdMergePushRspInfo.encode(e.messages[r],t.uint32(10).fork()).ldelim();return t},A.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.proto_switch.CmdMergePushRsp;e.pos<r;){var i=e.uint32();i>>>3==1?(n.messages&&n.messages.length||(n.messages=[]),n.messages.push(c.proto_switch.CmdMergePushRspInfo.decode(e,e.uint32()))):e.skipType(7&i)}return n},A),r),c.liveroom_cs=((i={}).ReqHead=(N.prototype.room_id="",N.prototype.user_session_id=a.Long?a.Long.fromBits(0,0,!0):0,N.prototype.room_session_id=a.Long?a.Long.fromBits(0,0,!0):0,N.create=function(e){return new N(e)},N.encode=function(e,t){return t=t||s.create(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).string(e.room_id),null!=e.user_session_id&&Object.hasOwnProperty.call(e,"user_session_id")&&t.uint32(16).uint64(e.user_session_id),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(24).uint64(e.room_session_id),t},N.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.ReqHead;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.room_id=e.string();break;case 2:n.user_session_id=e.uint64();break;case 3:n.room_session_id=e.uint64();break;default:e.skipType(7&i)}}return n},N),i.RspHead=(P.prototype.code=0,P.prototype.message="",P.create=function(e){return new P(e)},P.encode=function(e,t){return t=t||s.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},P.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.RspHead;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.code=e.uint32();break;case 2:n.message=e.string();break;default:e.skipType(7&i)}}return n},P),i.CommonRsp=(M.prototype.rsp_head=null,M.create=function(e){return new M(e)},M.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},M.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.CommonRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},M),i.HbReq=(D.prototype.req_head=null,D.prototype.role=0,D.prototype.lv_key="",D.create=function(e){return new D(e)},D.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(16).uint32(e.role),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(26).string(e.lv_key),t},D.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.HbReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.role=e.uint32();break;case 3:n.lv_key=e.string();break;default:e.skipType(7&i)}}return n},D),i.HbRsp=(U.prototype.rsp_head=null,U.prototype.ret_timestamp=a.Long?a.Long.fromBits(0,0,!1):0,U.prototype.hb_interval=0,U.prototype.hb_timeout=0,U.prototype.stream_seq=0,U.prototype.user_seq=a.Long?a.Long.fromBits(0,0,!1):0,U.prototype.online_count=0,U.prototype.bigim_time_window=0,U.prototype.dati_time_window=a.Long?a.Long.fromBits(0,0,!1):0,U.prototype.trans_seqs=a.emptyArray,U.prototype.user_trans_seqs=a.emptyArray,U.prototype.StreamRefresh=0,U.prototype.trans_list_seq=0,U.create=function(e){return new U(e)},U.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.ret_timestamp&&Object.hasOwnProperty.call(e,"ret_timestamp")&&t.uint32(16).int64(e.ret_timestamp),null!=e.hb_interval&&Object.hasOwnProperty.call(e,"hb_interval")&&t.uint32(24).uint32(e.hb_interval),null!=e.hb_timeout&&Object.hasOwnProperty.call(e,"hb_timeout")&&t.uint32(32).uint32(e.hb_timeout),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(40).uint32(e.stream_seq),null!=e.user_seq&&Object.hasOwnProperty.call(e,"user_seq")&&t.uint32(48).int64(e.user_seq),null!=e.online_count&&Object.hasOwnProperty.call(e,"online_count")&&t.uint32(56).uint32(e.online_count),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(64).uint32(e.bigim_time_window),null!=e.dati_time_window&&Object.hasOwnProperty.call(e,"dati_time_window")&&t.uint32(72).int64(e.dati_time_window),null!=e.trans_seqs&&e.trans_seqs.length)for(var r=0;r<e.trans_seqs.length;++r)c.liveroom_cs.StTransChannelSeq.encode(e.trans_seqs[r],t.uint32(82).fork()).ldelim();if(null!=e.user_trans_seqs&&e.user_trans_seqs.length)for(r=0;r<e.user_trans_seqs.length;++r)c.liveroom_cs.StTransChannelSeq.encode(e.user_trans_seqs[r],t.uint32(90).fork()).ldelim();return null!=e.StreamRefresh&&Object.hasOwnProperty.call(e,"StreamRefresh")&&t.uint32(96).uint32(e.StreamRefresh),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(104).uint32(e.trans_list_seq),t},U.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.HbRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.ret_timestamp=e.int64();break;case 3:n.hb_interval=e.uint32();break;case 4:n.hb_timeout=e.uint32();break;case 5:n.stream_seq=e.uint32();break;case 6:n.user_seq=e.int64();break;case 7:n.online_count=e.uint32();break;case 8:n.bigim_time_window=e.uint32();break;case 9:n.dati_time_window=e.int64();break;case 10:n.trans_seqs&&n.trans_seqs.length||(n.trans_seqs=[]),n.trans_seqs.push(c.liveroom_cs.StTransChannelSeq.decode(e,e.uint32()));break;case 11:n.user_trans_seqs&&n.user_trans_seqs.length||(n.user_trans_seqs=[]),n.user_trans_seqs.push(c.liveroom_cs.StTransChannelSeq.decode(e,e.uint32()));break;case 12:n.StreamRefresh=e.uint32();break;case 13:n.trans_list_seq=e.uint32();break;default:e.skipType(7&i)}}return n},U),i.StTransSeq=(x.prototype.trans_type=a.newBuffer([]),x.prototype.trans_seq=0,x.create=function(e){return new x(e)},x.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(16).uint32(e.trans_seq),t},x.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StTransSeq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_seq=e.uint32();break;default:e.skipType(7&i)}}return n},x),i.StTransChannelSeq=(B.prototype.trans_channel=a.newBuffer([]),B.prototype.trans_seq_array=a.emptyArray,B.create=function(e){return new B(e)},B.encode=function(e,t){if(t=t||s.create(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(10).bytes(e.trans_channel),null!=e.trans_seq_array&&e.trans_seq_array.length)for(var r=0;r<e.trans_seq_array.length;++r)c.liveroom_cs.StTransSeq.encode(e.trans_seq_array[r],t.uint32(18).fork()).ldelim();return t},B.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StTransChannelSeq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_channel=e.bytes();break;case 2:n.trans_seq_array&&n.trans_seq_array.length||(n.trans_seq_array=[]),n.trans_seq_array.push(c.liveroom_cs.StTransSeq.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},B),i.UserlistReq=(j.prototype.req_head=null,j.prototype.sort_type=0,j.prototype.user_index=0,j.create=function(e){return new j(e)},j.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.sort_type&&Object.hasOwnProperty.call(e,"sort_type")&&t.uint32(16).uint32(e.sort_type),null!=e.user_index&&Object.hasOwnProperty.call(e,"user_index")&&t.uint32(24).uint32(e.user_index),t},j.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.UserlistReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.sort_type=e.uint32();break;case 3:n.user_index=e.uint32();break;default:e.skipType(7&i)}}return n},j),i.UserlistRsp=(H.prototype.rsp_head=null,H.prototype.server_user_seq=a.Long?a.Long.fromBits(0,0,!0):0,H.prototype.server_user_index=a.Long?a.Long.fromBits(0,0,!1):0,H.prototype.ret_user_index=a.Long?a.Long.fromBits(0,0,!1):0,H.prototype.user_basic_list=a.emptyArray,H.create=function(e){return new H(e)},H.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.server_user_seq&&Object.hasOwnProperty.call(e,"server_user_seq")&&t.uint32(16).uint64(e.server_user_seq),null!=e.server_user_index&&Object.hasOwnProperty.call(e,"server_user_index")&&t.uint32(24).int64(e.server_user_index),null!=e.ret_user_index&&Object.hasOwnProperty.call(e,"ret_user_index")&&t.uint32(32).int64(e.ret_user_index),null!=e.user_basic_list&&e.user_basic_list.length)for(var r=0;r<e.user_basic_list.length;++r)c.liveroom_cs.StUserBasicDef.encode(e.user_basic_list[r],t.uint32(42).fork()).ldelim();return t},H.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.UserlistRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.server_user_seq=e.uint64();break;case 3:n.server_user_index=e.int64();break;case 4:n.ret_user_index=e.int64();break;case 5:n.user_basic_list&&n.user_basic_list.length||(n.user_basic_list=[]),n.user_basic_list.push(c.liveroom_cs.StUserBasicDef.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},H),i.StUserBasicDef=(G.prototype.id_name=a.newBuffer([]),G.prototype.nick_name=a.newBuffer([]),G.prototype.role=0,G.create=function(e){return new G(e)},G.encode=function(e,t){return t=t||s.create(),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),t},G.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StUserBasicDef;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id_name=e.bytes();break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;default:e.skipType(7&i)}}return n},G),i.StreamAddReq=(z.prototype.req_head=null,z.prototype.stream_id=a.newBuffer([]),z.prototype.title=a.newBuffer([]),z.prototype.stream_attr=a.newBuffer([]),z.prototype.extra_info=a.newBuffer([]),z.prototype.client_req_seq=0,z.prototype.nickname=a.newBuffer([]),z.prototype.login_mode=0,z.prototype.stream_type=0,z.prototype.third_token=a.newBuffer([]),z.create=function(e){return new z(e)},z.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(18).bytes(e.stream_id),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(26).bytes(e.title),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(34).bytes(e.stream_attr),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).bytes(e.extra_info),null!=e.client_req_seq&&Object.hasOwnProperty.call(e,"client_req_seq")&&t.uint32(48).uint32(e.client_req_seq),null!=e.nickname&&Object.hasOwnProperty.call(e,"nickname")&&t.uint32(58).bytes(e.nickname),null!=e.login_mode&&Object.hasOwnProperty.call(e,"login_mode")&&t.uint32(64).uint32(e.login_mode),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(72).uint32(e.stream_type),null!=e.third_token&&Object.hasOwnProperty.call(e,"third_token")&&t.uint32(82).bytes(e.third_token),t},z.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamAddReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.stream_id=e.bytes();break;case 3:n.title=e.bytes();break;case 4:n.stream_attr=e.bytes();break;case 5:n.extra_info=e.bytes();break;case 6:n.client_req_seq=e.uint32();break;case 7:n.nickname=e.bytes();break;case 8:n.login_mode=e.uint32();break;case 9:n.stream_type=e.uint32();break;case 10:n.third_token=e.bytes();break;default:e.skipType(7&i)}}return n},z),i.StreamAddRsp=(q.prototype.rsp_head=null,q.prototype.stream_seq=0,q.prototype.stream_sid="",q.prototype.stream_ver=0,q.prototype.stream_nid=0,q.prototype.token_remain_time=0,q.create=function(e){return new q(e)},q.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(26).string(e.stream_sid),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(32).uint32(e.stream_ver),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(40).uint32(e.stream_nid),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(48).uint32(e.token_remain_time),t},q.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamAddRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.stream_seq=e.uint32();break;case 3:n.stream_sid=e.string();break;case 4:n.stream_ver=e.uint32();break;case 5:n.stream_nid=e.uint32();break;case 6:n.token_remain_time=e.uint32();break;default:e.skipType(7&i)}}return n},q),i.StreamDeleteReq=(V.prototype.req_head=null,V.prototype.stream_sid="",V.prototype.stream_id=a.newBuffer([]),V.prototype.client_req_seq=0,V.create=function(e){return new V(e)},V.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).bytes(e.stream_id),null!=e.client_req_seq&&Object.hasOwnProperty.call(e,"client_req_seq")&&t.uint32(32).uint32(e.client_req_seq),t},V.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamDeleteReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.stream_sid=e.string();break;case 3:n.stream_id=e.bytes();break;case 4:n.client_req_seq=e.uint32();break;default:e.skipType(7&i)}}return n},V),i.StreamDeleteRsp=(F.prototype.rsp_head=null,F.prototype.stream_seq=0,F.prototype.stream_ver=0,F.create=function(e){return new F(e)},F.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(24).uint32(e.stream_ver),t},F.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamDeleteRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.stream_seq=e.uint32();break;case 3:n.stream_ver=e.uint32();break;default:e.skipType(7&i)}}return n},F),i.StreamUpdateReq=(Z.prototype.req_head=null,Z.prototype.stream_sid="",Z.prototype.stream_id=a.newBuffer([]),Z.prototype.title=a.newBuffer([]),Z.prototype.stream_attr=a.newBuffer([]),Z.prototype.extra_info=a.newBuffer([]),Z.prototype.client_req_seq=0,Z.prototype.nickname=a.newBuffer([]),Z.create=function(e){return new Z(e)},Z.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).bytes(e.stream_id),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(34).bytes(e.title),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(42).bytes(e.stream_attr),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(50).bytes(e.extra_info),null!=e.client_req_seq&&Object.hasOwnProperty.call(e,"client_req_seq")&&t.uint32(56).uint32(e.client_req_seq),null!=e.nickname&&Object.hasOwnProperty.call(e,"nickname")&&t.uint32(66).bytes(e.nickname),t},Z.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamUpdateReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.stream_sid=e.string();break;case 3:n.stream_id=e.bytes();break;case 4:n.title=e.bytes();break;case 5:n.stream_attr=e.bytes();break;case 6:n.extra_info=e.bytes();break;case 7:n.client_req_seq=e.uint32();break;case 8:n.nickname=e.bytes();break;default:e.skipType(7&i)}}return n},Z),i.StreamUpdateRsp=(W.prototype.rsp_head=null,W.prototype.stream_seq=0,W.prototype.stream_ver=0,W.create=function(e){return new W(e)},W.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(24).uint32(e.stream_ver),t},W.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamUpdateRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.stream_seq=e.uint32();break;case 3:n.stream_ver=e.uint32();break;default:e.skipType(7&i)}}return n},W),i.StreamListReq=(Y.prototype.req_head=null,Y.create=function(e){return new Y(e)},Y.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),t},Y.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamListReq;e.pos<r;){var i=e.uint32();i>>>3==1?n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32()):e.skipType(7&i)}return n},Y),i.StreamListRsp=(Q.prototype.rsp_head=null,Q.prototype.stream_seq=0,Q.prototype.stream_info=a.emptyArray,Q.prototype.stream_refresh=0,Q.prototype.stream_mix_info=a.emptyArray,Q.create=function(e){return new Q(e)},Q.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var r=0;r<e.stream_info.length;++r)c.liveroom_cs.StStreamInfo.encode(e.stream_info[r],t.uint32(26).fork()).ldelim();if(null!=e.stream_refresh&&Object.hasOwnProperty.call(e,"stream_refresh")&&t.uint32(32).uint32(e.stream_refresh),null!=e.stream_mix_info&&e.stream_mix_info.length)for(r=0;r<e.stream_mix_info.length;++r)c.liveroom_cs.StStreamInfo.encode(e.stream_mix_info[r],t.uint32(42).fork()).ldelim();return t},Q.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StreamListRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.stream_seq=e.uint32();break;case 3:n.stream_info&&n.stream_info.length||(n.stream_info=[]),n.stream_info.push(c.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;case 4:n.stream_refresh=e.uint32();break;case 5:n.stream_mix_info&&n.stream_mix_info.length||(n.stream_mix_info=[]),n.stream_mix_info.push(c.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Q),i.StStreamInfo=(K.prototype.stream_sid="",K.prototype.stream_id=a.newBuffer([]),K.prototype.id_name=a.newBuffer([]),K.prototype.nick_name=a.newBuffer([]),K.prototype.extra_info=a.newBuffer([]),K.prototype.title=a.newBuffer([]),K.prototype.stream_ver=0,K.prototype.stream_attr=a.newBuffer([]),K.prototype.create_time=a.Long?a.Long.fromBits(0,0,!1):0,K.prototype.stream_src=0,K.prototype.state=0,K.prototype.stream_type=0,K.prototype.stream_nid=0,K.create=function(e){return new K(e)},K.encode=function(e,t){return t=t||s.create(),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(10).string(e.stream_sid),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(18).bytes(e.stream_id),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(26).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).bytes(e.extra_info),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(50).bytes(e.title),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(56).uint32(e.stream_ver),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(66).bytes(e.stream_attr),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(72).int64(e.create_time),null!=e.stream_src&&Object.hasOwnProperty.call(e,"stream_src")&&t.uint32(80).uint32(e.stream_src),null!=e.state&&Object.hasOwnProperty.call(e,"state")&&t.uint32(88).uint32(e.state),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(96).uint32(e.stream_type),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(104).uint32(e.stream_nid),t},K.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StStreamInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.stream_sid=e.string();break;case 2:n.stream_id=e.bytes();break;case 3:n.id_name=e.bytes();break;case 4:n.nick_name=e.bytes();break;case 5:n.extra_info=e.bytes();break;case 6:n.title=e.bytes();break;case 7:n.stream_ver=e.uint32();break;case 8:n.stream_attr=e.bytes();break;case 9:n.create_time=e.int64();break;case 10:n.stream_src=e.uint32();break;case 11:n.state=e.uint32();break;case 12:n.stream_type=e.uint32();break;case 13:n.stream_nid=e.uint32();break;default:e.skipType(7&i)}}return n},K),i.StDstUser=(J.prototype.id_name=a.newBuffer([]),J.prototype.id=a.Long?a.Long.fromBits(0,0,!0):0,J.create=function(e){return new J(e)},J.encode=function(e,t){return t=t||s.create(),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(16).uint64(e.id),t},J.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StDstUser;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id_name=e.bytes();break;case 2:n.id=e.uint64();break;default:e.skipType(7&i)}}return n},J),i.SignalLiveReq=(X.prototype.req_head=null,X.prototype.push_message=a.newBuffer([]),X.prototype.dst_userlist=a.emptyArray,X.create=function(e){return new X(e)},X.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var r=0;r<e.dst_userlist.length;++r)c.liveroom_cs.StDstUser.encode(e.dst_userlist[r],t.uint32(26).fork()).ldelim();return t},X.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.push_message=e.bytes();break;case 3:n.dst_userlist&&n.dst_userlist.length||(n.dst_userlist=[]),n.dst_userlist.push(c.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},X),i.SignalLiveRsp=($.prototype.rsp_head=null,$.create=function(e){return new $(e)},$.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},$.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},$),i.SignalLiveResultReq=(ee.prototype.req_head=null,ee.prototype.push_message=a.newBuffer([]),ee.prototype.dst_userlist=a.emptyArray,ee.create=function(e){return new ee(e)},ee.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var r=0;r<e.dst_userlist.length;++r)c.liveroom_cs.StDstUser.encode(e.dst_userlist[r],t.uint32(26).fork()).ldelim();return t},ee.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveResultReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.push_message=e.bytes();break;case 3:n.dst_userlist&&n.dst_userlist.length||(n.dst_userlist=[]),n.dst_userlist.push(c.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},ee),i.SignalLiveResulRsp=(te.prototype.rsp_head=null,te.create=function(e){return new te(e)},te.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},te.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveResulRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},te),i.SignalLiveInviteReq=(re.prototype.req_head=null,re.prototype.push_message=a.newBuffer([]),re.prototype.dst_userlist=a.emptyArray,re.create=function(e){return new re(e)},re.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var r=0;r<e.dst_userlist.length;++r)c.liveroom_cs.StDstUser.encode(e.dst_userlist[r],t.uint32(26).fork()).ldelim();return t},re.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveInviteReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.push_message=e.bytes();break;case 3:n.dst_userlist&&n.dst_userlist.length||(n.dst_userlist=[]),n.dst_userlist.push(c.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},re),i.SignalLiveInviteRsp=(ne.prototype.rsp_head=null,ne.create=function(e){return new ne(e)},ne.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},ne.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveInviteRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},ne),i.SignalLiveStopReq=(ie.prototype.req_head=null,ie.prototype.push_message=a.newBuffer([]),ie.prototype.dst_userlist=a.emptyArray,ie.create=function(e){return new ie(e)},ie.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var r=0;r<e.dst_userlist.length;++r)c.liveroom_cs.StDstUser.encode(e.dst_userlist[r],t.uint32(26).fork()).ldelim();return t},ie.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveStopReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.push_message=e.bytes();break;case 3:n.dst_userlist&&n.dst_userlist.length||(n.dst_userlist=[]),n.dst_userlist.push(c.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},ie),i.SignalLiveStopRsp=(oe.prototype.rsp_head=null,oe.create=function(e){return new oe(e)},oe.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},oe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveStopRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},oe),i.SignalLiveCustomReq=(se.prototype.req_head=null,se.prototype.push_message=a.newBuffer([]),se.prototype.dst_userlist=a.emptyArray,se.create=function(e){return new se(e)},se.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var r=0;r<e.dst_userlist.length;++r)c.liveroom_cs.StDstUser.encode(e.dst_userlist[r],t.uint32(26).fork()).ldelim();return t},se.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveCustomReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.push_message=e.bytes();break;case 3:n.dst_userlist&&n.dst_userlist.length||(n.dst_userlist=[]),n.dst_userlist.push(c.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},se),i.SignalLiveCustomRsp=(ae.prototype.rsp_head=null,ae.create=function(e){return new ae(e)},ae.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},ae.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.SignalLiveCustomRsp;e.pos<r;){var i=e.uint32();i>>>3==1?n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32()):e.skipType(7&i)}return n},ae),i.ImChatReq=(ce.prototype.req_head=null,ce.prototype.msg_category=0,ce.prototype.msg_type=0,ce.prototype.msg_priority=0,ce.prototype.msg_content=a.newBuffer([]),ce.prototype.dst_userlist=a.emptyArray,ce.create=function(e){return new ce(e)},ce.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(16).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(24).uint32(e.msg_type),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(32).uint32(e.msg_priority),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(42).bytes(e.msg_content),null!=e.dst_userlist&&e.dst_userlist.length)for(var r=0;r<e.dst_userlist.length;++r)c.liveroom_cs.StDstUser.encode(e.dst_userlist[r],t.uint32(50).fork()).ldelim();return t},ce.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.ImChatReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.msg_category=e.uint32();break;case 3:n.msg_type=e.uint32();break;case 4:n.msg_priority=e.uint32();break;case 5:n.msg_content=e.bytes();break;case 6:n.dst_userlist&&n.dst_userlist.length||(n.dst_userlist=[]),n.dst_userlist.push(c.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},ce),i.ImChatRsp=(ue.prototype.rsp_head=null,ue.prototype.msg_id=a.Long?a.Long.fromBits(0,0,!0):0,ue.create=function(e){return new ue(e)},ue.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(16).uint64(e.msg_id),t},ue.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.ImChatRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.msg_id=e.uint64();break;default:e.skipType(7&i)}}return n},ue),i.ImGethatReq=(le.prototype.req_head=null,le.prototype.msg_priority=0,le.prototype.msg_id=a.Long?a.Long.fromBits(0,0,!0):0,le.prototype.sort_type=0,le.prototype.msg_count=0,le.create=function(e){return new le(e)},le.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(16).uint32(e.msg_priority),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(24).uint64(e.msg_id),null!=e.sort_type&&Object.hasOwnProperty.call(e,"sort_type")&&t.uint32(32).uint32(e.sort_type),null!=e.msg_count&&Object.hasOwnProperty.call(e,"msg_count")&&t.uint32(40).uint32(e.msg_count),t},le.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.ImGethatReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.msg_priority=e.uint32();break;case 3:n.msg_id=e.uint64();break;case 4:n.sort_type=e.uint32();break;case 5:n.msg_count=e.uint32();break;default:e.skipType(7&i)}}return n},le),i.ImGetChatRsp=(de.prototype.rsp_head=null,de.prototype.server_msg_id=a.Long?a.Long.fromBits(0,0,!0):0,de.prototype.ret_msg_id=a.Long?a.Long.fromBits(0,0,!0):0,de.prototype.msg_data=a.emptyArray,de.create=function(e){return new de(e)},de.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.server_msg_id&&Object.hasOwnProperty.call(e,"server_msg_id")&&t.uint32(16).uint64(e.server_msg_id),null!=e.ret_msg_id&&Object.hasOwnProperty.call(e,"ret_msg_id")&&t.uint32(24).uint64(e.ret_msg_id),null!=e.msg_data&&e.msg_data.length)for(var r=0;r<e.msg_data.length;++r)c.liveroom_cs.StMsgData.encode(e.msg_data[r],t.uint32(34).fork()).ldelim();return t},de.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.ImGetChatRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.server_msg_id=e.uint64();break;case 3:n.ret_msg_id=e.uint64();break;case 4:n.msg_data&&n.msg_data.length||(n.msg_data=[]),n.msg_data.push(c.liveroom_cs.StMsgData.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},de),i.StMsgData=(he.prototype.id_name=a.newBuffer([]),he.prototype.nick_name=a.newBuffer([]),he.prototype.role=0,he.prototype.msg_id=a.Long?a.Long.fromBits(0,0,!0):0,he.prototype.msg_category=0,he.prototype.msg_type=0,he.prototype.msg_priority=0,he.prototype.msg_content=a.newBuffer([]),he.prototype.send_time=a.Long?a.Long.fromBits(0,0,!1):0,he.create=function(e){return new he(e)},he.encode=function(e,t){return t=t||s.create(),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(32).uint64(e.msg_id),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(40).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(48).uint32(e.msg_type),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(56).uint32(e.msg_priority),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(66).bytes(e.msg_content),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(72).int64(e.send_time),t},he.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StMsgData;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id_name=e.bytes();break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;case 4:n.msg_id=e.uint64();break;case 5:n.msg_category=e.uint32();break;case 6:n.msg_type=e.uint32();break;case 7:n.msg_priority=e.uint32();break;case 8:n.msg_content=e.bytes();break;case 9:n.send_time=e.int64();break;default:e.skipType(7&i)}}return n},he),i.EnterReq=(pe.prototype.req_head=null,pe.prototype.switch_session_id=a.Long?a.Long.fromBits(0,0,!0):0,pe.prototype.nick_name=a.newBuffer([]),pe.prototype.role=0,pe.prototype.net_type=0,pe.prototype.config=null,pe.prototype.lv_key="",pe.prototype.third_token=a.newBuffer([]),pe.prototype.cluster_req=a.Long?a.Long.fromBits(0,0,!0):0,pe.prototype.user_count_limit=0,pe.prototype.relate_service="",pe.prototype.conn_type=0,pe.prototype.room_name=a.newBuffer([]),pe.create=function(e){return new pe(e)},pe.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.switch_session_id&&Object.hasOwnProperty.call(e,"switch_session_id")&&t.uint32(16).uint64(e.switch_session_id),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(26).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(32).uint32(e.role),null!=e.net_type&&Object.hasOwnProperty.call(e,"net_type")&&t.uint32(40).uint32(e.net_type),null!=e.config&&Object.hasOwnProperty.call(e,"config")&&c.liveroom_cs.StConfigList.encode(e.config,t.uint32(50).fork()).ldelim(),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(58).string(e.lv_key),null!=e.third_token&&Object.hasOwnProperty.call(e,"third_token")&&t.uint32(66).bytes(e.third_token),null!=e.cluster_req&&Object.hasOwnProperty.call(e,"cluster_req")&&t.uint32(72).uint64(e.cluster_req),null!=e.user_count_limit&&Object.hasOwnProperty.call(e,"user_count_limit")&&t.uint32(80).uint32(e.user_count_limit),null!=e.relate_service&&Object.hasOwnProperty.call(e,"relate_service")&&t.uint32(90).string(e.relate_service),null!=e.conn_type&&Object.hasOwnProperty.call(e,"conn_type")&&t.uint32(96).uint32(e.conn_type),null!=e.room_name&&Object.hasOwnProperty.call(e,"room_name")&&t.uint32(106).bytes(e.room_name),t},pe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.EnterReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.switch_session_id=e.uint64();break;case 3:n.nick_name=e.bytes();break;case 4:n.role=e.uint32();break;case 5:n.net_type=e.uint32();break;case 6:n.config=c.liveroom_cs.StConfigList.decode(e,e.uint32());break;case 7:n.lv_key=e.string();break;case 8:n.third_token=e.bytes();break;case 9:n.cluster_req=e.uint64();break;case 10:n.user_count_limit=e.uint32();break;case 11:n.relate_service=e.string();break;case 12:n.conn_type=e.uint32();break;case 13:n.room_name=e.bytes();break;default:e.skipType(7&i)}}return n},pe),i.EnterRsp=(fe.prototype.rsp_head=null,fe.prototype.room_id=a.newBuffer([]),fe.prototype.user_session_id=a.Long?a.Long.fromBits(0,0,!0):0,fe.prototype.room_session_id=a.Long?a.Long.fromBits(0,0,!0):0,fe.prototype.user_id=a.Long?a.Long.fromBits(0,0,!0):0,fe.prototype.ret_timestamp=a.Long?a.Long.fromBits(0,0,!1):0,fe.prototype.bigim_time_window=0,fe.prototype.dati_time_window=a.Long?a.Long.fromBits(0,0,!1):0,fe.prototype.room_id32=0,fe.prototype.hb_interval=0,fe.prototype.hb_timeout=0,fe.prototype.lv_key="",fe.prototype.zp_key="",fe.prototype.online_count=0,fe.prototype.anchor_info=null,fe.prototype.stream_seq=0,fe.prototype.stream_info=a.emptyArray,fe.prototype.stream_mix_info=a.emptyArray,fe.prototype.userlist_merge_timeout=0,fe.prototype.userlist_interval=0,fe.prototype.stream_list_push_merge_timeout=0,fe.prototype.stream_list_hb_wait_merge_time=0,fe.prototype.trans_list_seq=0,fe.prototype.trans_seqs=a.emptyArray,fe.prototype.cluster_name="",fe.prototype.token_remain_time=0,fe.prototype.stream_fetch_flag=0,fe.create=function(e){return new fe(e)},fe.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.user_session_id&&Object.hasOwnProperty.call(e,"user_session_id")&&t.uint32(24).uint64(e.user_session_id),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(32).uint64(e.room_session_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(40).uint64(e.user_id),null!=e.ret_timestamp&&Object.hasOwnProperty.call(e,"ret_timestamp")&&t.uint32(49).fixed64(e.ret_timestamp),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(56).uint32(e.bigim_time_window),null!=e.dati_time_window&&Object.hasOwnProperty.call(e,"dati_time_window")&&t.uint32(64).int64(e.dati_time_window),null!=e.room_id32&&Object.hasOwnProperty.call(e,"room_id32")&&t.uint32(72).uint32(e.room_id32),null!=e.hb_interval&&Object.hasOwnProperty.call(e,"hb_interval")&&t.uint32(80).uint32(e.hb_interval),null!=e.hb_timeout&&Object.hasOwnProperty.call(e,"hb_timeout")&&t.uint32(88).uint32(e.hb_timeout),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(98).string(e.lv_key),null!=e.zp_key&&Object.hasOwnProperty.call(e,"zp_key")&&t.uint32(106).string(e.zp_key),null!=e.online_count&&Object.hasOwnProperty.call(e,"online_count")&&t.uint32(112).uint32(e.online_count),null!=e.anchor_info&&Object.hasOwnProperty.call(e,"anchor_info")&&c.liveroom_cs.StAnchorInfo.encode(e.anchor_info,t.uint32(122).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(128).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var r=0;r<e.stream_info.length;++r)c.liveroom_cs.StStreamInfo.encode(e.stream_info[r],t.uint32(138).fork()).ldelim();if(null!=e.stream_mix_info&&e.stream_mix_info.length)for(r=0;r<e.stream_mix_info.length;++r)c.liveroom_cs.StStreamInfo.encode(e.stream_mix_info[r],t.uint32(146).fork()).ldelim();if(null!=e.userlist_merge_timeout&&Object.hasOwnProperty.call(e,"userlist_merge_timeout")&&t.uint32(152).uint32(e.userlist_merge_timeout),null!=e.userlist_interval&&Object.hasOwnProperty.call(e,"userlist_interval")&&t.uint32(160).uint32(e.userlist_interval),null!=e.stream_list_push_merge_timeout&&Object.hasOwnProperty.call(e,"stream_list_push_merge_timeout")&&t.uint32(168).uint32(e.stream_list_push_merge_timeout),null!=e.stream_list_hb_wait_merge_time&&Object.hasOwnProperty.call(e,"stream_list_hb_wait_merge_time")&&t.uint32(176).uint32(e.stream_list_hb_wait_merge_time),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(184).uint32(e.trans_list_seq),null!=e.trans_seqs&&e.trans_seqs.length)for(r=0;r<e.trans_seqs.length;++r)c.liveroom_cs.StTransInfo.encode(e.trans_seqs[r],t.uint32(194).fork()).ldelim();return null!=e.cluster_name&&Object.hasOwnProperty.call(e,"cluster_name")&&t.uint32(202).string(e.cluster_name),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(208).uint32(e.token_remain_time),null!=e.stream_fetch_flag&&Object.hasOwnProperty.call(e,"stream_fetch_flag")&&t.uint32(216).uint32(e.stream_fetch_flag),t},fe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.EnterRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.room_id=e.bytes();break;case 3:n.user_session_id=e.uint64();break;case 4:n.room_session_id=e.uint64();break;case 5:n.user_id=e.uint64();break;case 6:n.ret_timestamp=e.fixed64();break;case 7:n.bigim_time_window=e.uint32();break;case 8:n.dati_time_window=e.int64();break;case 9:n.room_id32=e.uint32();break;case 10:n.hb_interval=e.uint32();break;case 11:n.hb_timeout=e.uint32();break;case 12:n.lv_key=e.string();break;case 13:n.zp_key=e.string();break;case 14:n.online_count=e.uint32();break;case 15:n.anchor_info=c.liveroom_cs.StAnchorInfo.decode(e,e.uint32());break;case 16:n.stream_seq=e.uint32();break;case 17:n.stream_info&&n.stream_info.length||(n.stream_info=[]),n.stream_info.push(c.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;case 18:n.stream_mix_info&&n.stream_mix_info.length||(n.stream_mix_info=[]),n.stream_mix_info.push(c.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;case 19:n.userlist_merge_timeout=e.uint32();break;case 20:n.userlist_interval=e.uint32();break;case 21:n.stream_list_push_merge_timeout=e.uint32();break;case 22:n.stream_list_hb_wait_merge_time=e.uint32();break;case 23:n.trans_list_seq=e.uint32();break;case 24:n.trans_seqs&&n.trans_seqs.length||(n.trans_seqs=[]),n.trans_seqs.push(c.liveroom_cs.StTransInfo.decode(e,e.uint32()));break;case 25:n.cluster_name=e.string();break;case 26:n.token_remain_time=e.uint32();break;case 27:n.stream_fetch_flag=e.uint32();break;default:e.skipType(7&i)}}return n},fe),i.StAnchorInfo=(ge.prototype.anchor_id_name=a.newBuffer([]),ge.prototype.anchor_id=a.Long?a.Long.fromBits(0,0,!0):0,ge.prototype.anchor_nick_name=a.newBuffer([]),ge.create=function(e){return new ge(e)},ge.encode=function(e,t){return t=t||s.create(),null!=e.anchor_id_name&&Object.hasOwnProperty.call(e,"anchor_id_name")&&t.uint32(10).bytes(e.anchor_id_name),null!=e.anchor_id&&Object.hasOwnProperty.call(e,"anchor_id")&&t.uint32(16).uint64(e.anchor_id),null!=e.anchor_nick_name&&Object.hasOwnProperty.call(e,"anchor_nick_name")&&t.uint32(26).bytes(e.anchor_nick_name),t},ge.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StAnchorInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.anchor_id_name=e.bytes();break;case 2:n.anchor_id=e.uint64();break;case 3:n.anchor_nick_name=e.bytes();break;default:e.skipType(7&i)}}return n},ge),i.QuitReq=(me.prototype.req_head=null,me.prototype.switch_session_id=a.Long?a.Long.fromBits(0,0,!0):0,me.prototype.room_id32=0,me.prototype.nick_name=a.newBuffer([]),me.prototype.role=0,me.prototype.net_type=0,me.prototype.config_list=null,me.create=function(e){return new me(e)},me.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.switch_session_id&&Object.hasOwnProperty.call(e,"switch_session_id")&&t.uint32(16).uint64(e.switch_session_id),null!=e.room_id32&&Object.hasOwnProperty.call(e,"room_id32")&&t.uint32(24).uint32(e.room_id32),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(40).uint32(e.role),null!=e.net_type&&Object.hasOwnProperty.call(e,"net_type")&&t.uint32(48).uint32(e.net_type),null!=e.config_list&&Object.hasOwnProperty.call(e,"config_list")&&c.liveroom_cs.StConfigList.encode(e.config_list,t.uint32(58).fork()).ldelim(),t},me.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.QuitReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.switch_session_id=e.uint64();break;case 3:n.room_id32=e.uint32();break;case 4:n.nick_name=e.bytes();break;case 5:n.role=e.uint32();break;case 6:n.net_type=e.uint32();break;case 7:n.config_list=c.liveroom_cs.StConfigList.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},me),i.StConfigList=(_e.prototype.room_create_flag=0,_e.prototype.user_state_flag=0,_e.create=function(e){return new _e(e)},_e.encode=function(e,t){return t=t||s.create(),null!=e.room_create_flag&&Object.hasOwnProperty.call(e,"room_create_flag")&&t.uint32(8).uint32(e.room_create_flag),null!=e.user_state_flag&&Object.hasOwnProperty.call(e,"user_state_flag")&&t.uint32(16).uint32(e.user_state_flag),t},_e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StConfigList;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.room_create_flag=e.uint32();break;case 2:n.user_state_flag=e.uint32();break;default:e.skipType(7&i)}}return n},_e),i.QuitRsp=(ve.prototype.rsp_head=null,ve.prototype.room_id=a.newBuffer([]),ve.prototype.room_id32=0,ve.create=function(e){return new ve(e)},ve.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.room_id32&&Object.hasOwnProperty.call(e,"room_id32")&&t.uint32(24).uint32(e.room_id32),t},ve.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.QuitRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.room_id=e.bytes();break;case 3:n.room_id32=e.uint32();break;default:e.skipType(7&i)}}return n},ve),i.RoomListReq=(ye.prototype.req_head=null,ye.create=function(e){return new ye(e)},ye.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),t},ye.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.RoomListReq;e.pos<r;){var i=e.uint32();i>>>3==1?n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32()):e.skipType(7&i)}return n},ye),i.RoomListRsp=(Ee.prototype.rsp_head=null,Ee.prototype.room_list=a.emptyArray,Ee.create=function(e){return new Ee(e)},Ee.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_list&&e.room_list.length)for(var r=0;r<e.room_list.length;++r)c.liveroom_cs.StRoomListRoom.encode(e.room_list[r],t.uint32(18).fork()).ldelim();return t},Ee.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.RoomListRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.room_list&&n.room_list.length||(n.room_list=[]),n.room_list.push(c.liveroom_cs.StRoomListRoom.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Ee),i.StRoomListStream=(Se.prototype.stream_id=a.newBuffer([]),Se.create=function(e){return new Se(e)},Se.encode=function(e,t){return t=t||s.create(),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(10).bytes(e.stream_id),t},Se.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StRoomListStream;e.pos<r;){var i=e.uint32();i>>>3==1?n.stream_id=e.bytes():e.skipType(7&i)}return n},Se),i.StRoomListRoom=(be.prototype.room_id=a.newBuffer([]),be.prototype.room_name=a.newBuffer([]),be.prototype.anchor_id_name=a.newBuffer([]),be.prototype.anchor_nick_name=a.newBuffer([]),be.prototype.stream_list=a.emptyArray,be.create=function(e){return new be(e)},be.encode=function(e,t){if(t=t||s.create(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.room_name&&Object.hasOwnProperty.call(e,"room_name")&&t.uint32(18).bytes(e.room_name),null!=e.anchor_id_name&&Object.hasOwnProperty.call(e,"anchor_id_name")&&t.uint32(26).bytes(e.anchor_id_name),null!=e.anchor_nick_name&&Object.hasOwnProperty.call(e,"anchor_nick_name")&&t.uint32(34).bytes(e.anchor_nick_name),null!=e.stream_list&&e.stream_list.length)for(var r=0;r<e.stream_list.length;++r)c.liveroom_cs.StRoomListStream.encode(e.stream_list[r],t.uint32(42).fork()).ldelim();return t},be.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StRoomListRoom;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.room_id=e.bytes();break;case 2:n.room_name=e.bytes();break;case 3:n.anchor_id_name=e.bytes();break;case 4:n.anchor_nick_name=e.bytes();break;case 5:n.stream_list&&n.stream_list.length||(n.stream_list=[]),n.stream_list.push(c.liveroom_cs.StRoomListStream.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},be),i.StTransSeqInfo=(Te.prototype.trans_type=a.newBuffer([]),Te.prototype.trans_seq=0,Te.create=function(e){return new Te(e)},Te.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(16).uint32(e.trans_seq),t},Te.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StTransSeqInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_seq=e.uint32();break;default:e.skipType(7&i)}}return n},Te),i.StTransInfo=(Ce.prototype.trans_channel=a.newBuffer([]),Ce.prototype.trans_seq_array=a.emptyArray,Ce.create=function(e){return new Ce(e)},Ce.encode=function(e,t){if(t=t||s.create(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(10).bytes(e.trans_channel),null!=e.trans_seq_array&&e.trans_seq_array.length)for(var r=0;r<e.trans_seq_array.length;++r)c.liveroom_cs.StTransSeqInfo.encode(e.trans_seq_array[r],t.uint32(18).fork()).ldelim();return t},Ce.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StTransInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_channel=e.bytes();break;case 2:n.trans_seq_array&&n.trans_seq_array.length||(n.trans_seq_array=[]),n.trans_seq_array.push(c.liveroom_cs.StTransSeqInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Ce),i.TransReq=(Re.prototype.req_head=null,Re.prototype.nick_name=a.newBuffer([]),Re.prototype.role=0,Re.prototype.trans_type=a.newBuffer([]),Re.prototype.trans_data=a.newBuffer([]),Re.prototype.trans_local_seq=0,Re.prototype.trans_channel=a.newBuffer([]),Re.create=function(e){return new Re(e)},Re.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(34).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(42).bytes(e.trans_data),null!=e.trans_local_seq&&Object.hasOwnProperty.call(e,"trans_local_seq")&&t.uint32(48).uint32(e.trans_local_seq),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(58).bytes(e.trans_channel),t},Re.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.TransReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;case 4:n.trans_type=e.bytes();break;case 5:n.trans_data=e.bytes();break;case 6:n.trans_local_seq=e.uint32();break;case 7:n.trans_channel=e.bytes();break;default:e.skipType(7&i)}}return n},Re),i.TransRsp=(Oe.prototype.rsp_head=null,Oe.prototype.trans_type=a.newBuffer([]),Oe.prototype.trans_seq=0,Oe.prototype.trans_list_seq=0,Oe.prototype.trans_channel=a.newBuffer([]),Oe.create=function(e){return new Oe(e)},Oe.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(18).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(24).uint32(e.trans_seq),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(32).uint32(e.trans_list_seq),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(42).bytes(e.trans_channel),t},Oe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.TransRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.trans_type=e.bytes();break;case 3:n.trans_seq=e.uint32();break;case 4:n.trans_list_seq=e.uint32();break;case 5:n.trans_channel=e.bytes();break;default:e.skipType(7&i)}}return n},Oe),i.TransFetchReq=(ke.prototype.req_head=null,ke.prototype.trans_channel=a.newBuffer([]),ke.prototype.fetch_array=a.emptyArray,ke.create=function(e){return new ke(e)},ke.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(18).bytes(e.trans_channel),null!=e.fetch_array&&e.fetch_array.length)for(var r=0;r<e.fetch_array.length;++r)c.liveroom_cs.StTransFetch.encode(e.fetch_array[r],t.uint32(26).fork()).ldelim();return t},ke.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.TransFetchReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.trans_channel=e.bytes();break;case 3:n.fetch_array&&n.fetch_array.length||(n.fetch_array=[]),n.fetch_array.push(c.liveroom_cs.StTransFetch.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},ke),i.StTransFetch=(Ie.prototype.trans_type=a.newBuffer([]),Ie.prototype.trans_local_seq=0,Ie.create=function(e){return new Ie(e)},Ie.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_local_seq&&Object.hasOwnProperty.call(e,"trans_local_seq")&&t.uint32(16).uint32(e.trans_local_seq),t},Ie.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StTransFetch;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_local_seq=e.uint32();break;default:e.skipType(7&i)}}return n},Ie),i.TransFetchRsp=(Le.prototype.rsp_head=null,Le.prototype.trans_channel=a.newBuffer([]),Le.prototype.trans_fetch_results=a.emptyArray,Le.prototype.trans_list_seq=0,Le.create=function(e){return new Le(e)},Le.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(18).bytes(e.trans_channel),null!=e.trans_fetch_results&&e.trans_fetch_results.length)for(var r=0;r<e.trans_fetch_results.length;++r)c.liveroom_cs.TransFetchResult.encode(e.trans_fetch_results[r],t.uint32(26).fork()).ldelim();return null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(32).uint32(e.trans_list_seq),t},Le.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.TransFetchRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.trans_channel=e.bytes();break;case 3:n.trans_fetch_results&&n.trans_fetch_results.length||(n.trans_fetch_results=[]),n.trans_fetch_results.push(c.liveroom_cs.TransFetchResult.decode(e,e.uint32()));break;case 4:n.trans_list_seq=e.uint32();break;default:e.skipType(7&i)}}return n},Le),i.TransFetchResult=(we.prototype.trans_type=a.newBuffer([]),we.prototype.trans_data=a.newBuffer([]),we.prototype.trans_idname=a.newBuffer([]),we.prototype.trans_nickname=a.newBuffer([]),we.prototype.trans_role=0,we.prototype.trans_send_time=a.Long?a.Long.fromBits(0,0,!1):0,we.prototype.trans_seq=0,we.prototype.err_code=0,we.create=function(e){return new we(e)},we.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(18).bytes(e.trans_data),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(48).int64(e.trans_send_time),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(56).uint32(e.trans_seq),null!=e.err_code&&Object.hasOwnProperty.call(e,"err_code")&&t.uint32(64).int32(e.err_code),t},we.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.TransFetchResult;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_data=e.bytes();break;case 3:n.trans_idname=e.bytes();break;case 4:n.trans_nickname=e.bytes();break;case 5:n.trans_role=e.uint32();break;case 6:n.trans_send_time=e.int64();break;case 7:n.trans_seq=e.uint32();break;case 8:n.err_code=e.int32();break;default:e.skipType(7&i)}}return n},we),i.UserTransFetchReq=(Ae.prototype.req_head=null,Ae.prototype.nick_name=a.newBuffer([]),Ae.prototype.role=0,Ae.prototype.trans_channel=a.newBuffer([]),Ae.prototype.fetch_array=a.emptyArray,Ae.create=function(e){return new Ae(e)},Ae.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(34).bytes(e.trans_channel),null!=e.fetch_array&&e.fetch_array.length)for(var r=0;r<e.fetch_array.length;++r)c.liveroom_cs.StUserTransFetch.encode(e.fetch_array[r],t.uint32(42).fork()).ldelim();return t},Ae.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.UserTransFetchReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;case 4:n.trans_channel=e.bytes();break;case 5:n.fetch_array&&n.fetch_array.length||(n.fetch_array=[]),n.fetch_array.push(c.liveroom_cs.StUserTransFetch.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Ae),i.StUserTransFetch=(Ne.prototype.trans_type=a.newBuffer([]),Ne.prototype.trans_local_seq=0,Ne.create=function(e){return new Ne(e)},Ne.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_local_seq&&Object.hasOwnProperty.call(e,"trans_local_seq")&&t.uint32(16).uint32(e.trans_local_seq),t},Ne.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StUserTransFetch;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_local_seq=e.uint32();break;default:e.skipType(7&i)}}return n},Ne),i.UserTransFetchRsp=(Pe.prototype.rsp_head=null,Pe.prototype.trans_channel=a.newBuffer([]),Pe.prototype.trans_fetch_results=a.emptyArray,Pe.create=function(e){return new Pe(e)},Pe.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(18).bytes(e.trans_channel),null!=e.trans_fetch_results&&e.trans_fetch_results.length)for(var r=0;r<e.trans_fetch_results.length;++r)c.liveroom_cs.StUserTransFetchResult.encode(e.trans_fetch_results[r],t.uint32(26).fork()).ldelim();return t},Pe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.UserTransFetchRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.trans_channel=e.bytes();break;case 3:n.trans_fetch_results&&n.trans_fetch_results.length||(n.trans_fetch_results=[]),n.trans_fetch_results.push(c.liveroom_cs.StUserTransFetchResult.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Pe),i.StUserTransFetchResult=(Me.prototype.trans_type=a.newBuffer([]),Me.prototype.trans_data=a.newBuffer([]),Me.prototype.trans_idname=a.newBuffer([]),Me.prototype.trans_nickname=a.newBuffer([]),Me.prototype.trans_role=0,Me.prototype.trans_send_time=a.Long?a.Long.fromBits(0,0,!1):0,Me.prototype.trans_seq=0,Me.prototype.err_code=0,Me.create=function(e){return new Me(e)},Me.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(18).bytes(e.trans_data),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(48).int64(e.trans_send_time),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(56).uint32(e.trans_seq),null!=e.err_code&&Object.hasOwnProperty.call(e,"err_code")&&t.uint32(64).int32(e.err_code),t},Me.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StUserTransFetchResult;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_data=e.bytes();break;case 3:n.trans_idname=e.bytes();break;case 4:n.trans_nickname=e.bytes();break;case 5:n.trans_role=e.uint32();break;case 6:n.trans_send_time=e.int64();break;case 7:n.trans_seq=e.uint32();break;case 8:n.err_code=e.int32();break;default:e.skipType(7&i)}}return n},Me),i.BigimChatReq=(De.prototype.req_head=null,De.prototype.nick_name=a.newBuffer([]),De.prototype.role=0,De.prototype.msgs=a.emptyArray,De.create=function(e){return new De(e)},De.encode=function(e,t){if(t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.msgs&&e.msgs.length)for(var r=0;r<e.msgs.length;++r)c.liveroom_cs.StBigimChatData.encode(e.msgs[r],t.uint32(34).fork()).ldelim();return t},De.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.BigimChatReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;case 4:n.msgs&&n.msgs.length||(n.msgs=[]),n.msgs.push(c.liveroom_cs.StBigimChatData.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},De),i.StBigimChatData=(Ue.prototype.msg_category=0,Ue.prototype.msg_type=0,Ue.prototype.msg_content=a.newBuffer([]),Ue.prototype.msg_timestamp=a.Long?a.Long.fromBits(0,0,!1):0,Ue.prototype.bigmsg_client_id=a.newBuffer([]),Ue.create=function(e){return new Ue(e)},Ue.encode=function(e,t){return t=t||s.create(),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(8).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(16).uint32(e.msg_type),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(26).bytes(e.msg_content),null!=e.msg_timestamp&&Object.hasOwnProperty.call(e,"msg_timestamp")&&t.uint32(32).int64(e.msg_timestamp),null!=e.bigmsg_client_id&&Object.hasOwnProperty.call(e,"bigmsg_client_id")&&t.uint32(42).bytes(e.bigmsg_client_id),t},Ue.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StBigimChatData;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.msg_category=e.uint32();break;case 2:n.msg_type=e.uint32();break;case 3:n.msg_content=e.bytes();break;case 4:n.msg_timestamp=e.int64();break;case 5:n.bigmsg_client_id=e.bytes();break;default:e.skipType(7&i)}}return n},Ue),i.BigimChatRsp=(xe.prototype.rsp_head=null,xe.prototype.bigim_time_window=0,xe.prototype.msgs=a.emptyArray,xe.create=function(e){return new xe(e)},xe.encode=function(e,t){if(t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(16).uint32(e.bigim_time_window),null!=e.msgs&&e.msgs.length)for(var r=0;r<e.msgs.length;++r)c.liveroom_cs.StBigimChatRspData.encode(e.msgs[r],t.uint32(26).fork()).ldelim();return t},xe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.BigimChatRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.bigim_time_window=e.uint32();break;case 3:n.msgs&&n.msgs.length||(n.msgs=[]),n.msgs.push(c.liveroom_cs.StBigimChatRspData.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},xe),i.StBigimChatRspData=(Be.prototype.bigmsg_id=a.newBuffer([]),Be.prototype.bigmsg_client_id=a.newBuffer([]),Be.create=function(e){return new Be(e)},Be.encode=function(e,t){return t=t||s.create(),null!=e.bigmsg_id&&Object.hasOwnProperty.call(e,"bigmsg_id")&&t.uint32(10).bytes(e.bigmsg_id),null!=e.bigmsg_client_id&&Object.hasOwnProperty.call(e,"bigmsg_client_id")&&t.uint32(18).bytes(e.bigmsg_client_id),t},Be.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StBigimChatRspData;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.bigmsg_id=e.bytes();break;case 2:n.bigmsg_client_id=e.bytes();break;default:e.skipType(7&i)}}return n},Be),i.RelayReq=(je.prototype.req_head=null,je.prototype.nick_name=a.newBuffer([]),je.prototype.role=0,je.prototype.relay_type=a.newBuffer([]),je.prototype.relay_data=a.newBuffer([]),je.create=function(e){return new je(e)},je.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.relay_type&&Object.hasOwnProperty.call(e,"relay_type")&&t.uint32(34).bytes(e.relay_type),null!=e.relay_data&&Object.hasOwnProperty.call(e,"relay_data")&&t.uint32(42).bytes(e.relay_data),t},je.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.RelayReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;case 4:n.relay_type=e.bytes();break;case 5:n.relay_data=e.bytes();break;default:e.skipType(7&i)}}return n},je),i.RelayRsp=(He.prototype.rsp_head=null,He.prototype.reley_type=a.newBuffer([]),He.prototype.relay_result=a.newBuffer([]),He.create=function(e){return new He(e)},He.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.reley_type&&Object.hasOwnProperty.call(e,"reley_type")&&t.uint32(18).bytes(e.reley_type),null!=e.relay_result&&Object.hasOwnProperty.call(e,"relay_result")&&t.uint32(26).bytes(e.relay_result),t},He.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.RelayRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.reley_type=e.bytes();break;case 3:n.relay_result=e.bytes();break;default:e.skipType(7&i)}}return n},He),i.RenewTokenReq=(Ge.prototype.req_head=null,Ge.prototype.token="",Ge.create=function(e){return new Ge(e)},Ge.encode=function(e,t){return t=t||s.create(),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&c.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(18).string(e.token),t},Ge.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.RenewTokenReq;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.req_head=c.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:n.token=e.string();break;default:e.skipType(7&i)}}return n},Ge),i.RenewTokenRsp=(ze.prototype.rsp_head=null,ze.prototype.token_remain_time=0,ze.create=function(e){return new ze(e)},ze.encode=function(e,t){return t=t||s.create(),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&c.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(16).uint32(e.token_remain_time),t},ze.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.RenewTokenRsp;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.rsp_head=c.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:n.token_remain_time=e.uint32();break;default:e.skipType(7&i)}}return n},ze),i.UserAction=(qe.prototype.action=0,qe.prototype.id_name=a.newBuffer([]),qe.prototype.nick_name=a.newBuffer([]),qe.prototype.role=0,qe.prototype.login_time=a.Long?a.Long.fromBits(0,0,!1):0,qe.create=function(e){return new qe(e)},qe.encode=function(e,t){return t=t||s.create(),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(8).uint32(e.action),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(18).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(26).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(32).uint32(e.role),null!=e.login_time&&Object.hasOwnProperty.call(e,"login_time")&&t.uint32(40).int64(e.login_time),t},qe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.UserAction;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.action=e.uint32();break;case 2:n.id_name=e.bytes();break;case 3:n.nick_name=e.bytes();break;case 4:n.role=e.uint32();break;case 5:n.login_time=e.int64();break;default:e.skipType(7&i)}}return n},qe),i.PushUserInfoUpdated=(Ve.prototype.room_id=a.newBuffer([]),Ve.prototype.server_user_seq=a.Long?a.Long.fromBits(0,0,!1):0,Ve.prototype.user_list=a.emptyArray,Ve.create=function(e){return new Ve(e)},Ve.encode=function(e,t){if(t=t||s.create(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.server_user_seq&&Object.hasOwnProperty.call(e,"server_user_seq")&&t.uint32(16).int64(e.server_user_seq),null!=e.user_list&&e.user_list.length)for(var r=0;r<e.user_list.length;++r)c.liveroom_cs.UserAction.encode(e.user_list[r],t.uint32(26).fork()).ldelim();return t},Ve.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushUserInfoUpdated;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.room_id=e.bytes();break;case 2:n.server_user_seq=e.int64();break;case 3:n.user_list&&n.user_list.length||(n.user_list=[]),n.user_list.push(c.liveroom_cs.UserAction.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Ve),i.PushUserKickout=(Fe.prototype.id_name=a.newBuffer([]),Fe.prototype.room_id=a.newBuffer([]),Fe.prototype.session_id=a.Long?a.Long.fromBits(0,0,!0):0,Fe.prototype.kickout_reason=0,Fe.prototype.custom_reason=a.newBuffer([]),Fe.create=function(e){return new Fe(e)},Fe.encode=function(e,t){return t=t||s.create(),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(24).uint64(e.session_id),null!=e.kickout_reason&&Object.hasOwnProperty.call(e,"kickout_reason")&&t.uint32(32).int32(e.kickout_reason),null!=e.custom_reason&&Object.hasOwnProperty.call(e,"custom_reason")&&t.uint32(42).bytes(e.custom_reason),t},Fe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushUserKickout;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id_name=e.bytes();break;case 2:n.room_id=e.bytes();break;case 3:n.session_id=e.uint64();break;case 4:n.kickout_reason=e.int32();break;case 5:n.custom_reason=e.bytes();break;default:e.skipType(7&i)}}return n},Fe),i.PushUserLogReport=(Ze.create=function(e){return new Ze(e)},Ze.encode=function(e,t){return t||s.create()},Ze.decode=function(e,t){e instanceof o||(e=o.create(e));var r=void 0===t?e.len:e.pos+t;for(t=new c.liveroom_cs.PushUserLogReport;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},Ze),i.PushUserTokenExpire=(We.prototype.room_id=a.newBuffer([]),We.prototype.token="",We.prototype.stop_stream=null,We.create=function(e){return new We(e)},We.encode=function(e,t){return t=t||s.create(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(18).string(e.token),null!=e.stop_stream&&Object.hasOwnProperty.call(e,"stop_stream")&&c.liveroom_cs.StopStream.encode(e.stop_stream,t.uint32(26).fork()).ldelim(),t},We.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushUserTokenExpire;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.room_id=e.bytes();break;case 2:n.token=e.string();break;case 3:n.stop_stream=c.liveroom_cs.StopStream.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},We),i.StopStream=(Ye.prototype.stream_id_list=a.emptyArray,Ye.create=function(e){return new Ye(e)},Ye.encode=function(e,t){if(t=t||s.create(),null!=e.stream_id_list&&e.stream_id_list.length)for(var r=0;r<e.stream_id_list.length;++r)t.uint32(10).bytes(e.stream_id_list[r]);return t},Ye.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StopStream;e.pos<r;){var i=e.uint32();i>>>3==1?(n.stream_id_list&&n.stream_id_list.length||(n.stream_id_list=[]),n.stream_id_list.push(e.bytes())):e.skipType(7&i)}return n},Ye),i.PushStream=(Qe.prototype.room_id=a.newBuffer([]),Qe.prototype.stream_seq=0,Qe.prototype.stream_info=a.emptyArray,Qe.create=function(e){return new Qe(e)},Qe.encode=function(e,t){if(t=t||s.create(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var r=0;r<e.stream_info.length;++r)c.liveroom_cs.StPushStreamInfo.encode(e.stream_info[r],t.uint32(26).fork()).ldelim();return t},Qe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushStream;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.room_id=e.bytes();break;case 2:n.stream_seq=e.uint32();break;case 3:n.stream_info&&n.stream_info.length||(n.stream_info=[]),n.stream_info.push(c.liveroom_cs.StPushStreamInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Qe),i.StPushStreamInfo=(Ke.prototype.stream_id=a.newBuffer([]),Ke.prototype.stream_sid="",Ke.prototype.id_name=a.newBuffer([]),Ke.prototype.nick_name=a.newBuffer([]),Ke.prototype.extra_info=a.newBuffer([]),Ke.prototype.title=a.newBuffer([]),Ke.prototype.third_define_data=a.newBuffer([]),Ke.prototype.create_time=a.Long?a.Long.fromBits(0,0,!1):0,Ke.prototype.req_seq=0,Ke.prototype.stream_ver=0,Ke.prototype.stream_attr=a.newBuffer([]),Ke.prototype.stream_src=0,Ke.prototype.stream_state=0,Ke.prototype.stream_type=0,Ke.prototype.stream_nid=0,Ke.prototype.close_type=0,Ke.create=function(e){return new Ke(e)},Ke.encode=function(e,t){return t=t||s.create(),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(10).bytes(e.stream_id),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(26).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).bytes(e.extra_info),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(50).bytes(e.title),null!=e.third_define_data&&Object.hasOwnProperty.call(e,"third_define_data")&&t.uint32(58).bytes(e.third_define_data),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(64).int64(e.create_time),null!=e.req_seq&&Object.hasOwnProperty.call(e,"req_seq")&&t.uint32(72).uint32(e.req_seq),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(80).uint32(e.stream_ver),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(90).bytes(e.stream_attr),null!=e.stream_src&&Object.hasOwnProperty.call(e,"stream_src")&&t.uint32(96).uint32(e.stream_src),null!=e.stream_state&&Object.hasOwnProperty.call(e,"stream_state")&&t.uint32(104).uint32(e.stream_state),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(112).uint32(e.stream_type),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(120).uint32(e.stream_nid),null!=e.close_type&&Object.hasOwnProperty.call(e,"close_type")&&t.uint32(128).uint32(e.close_type),t},Ke.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StPushStreamInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.stream_id=e.bytes();break;case 2:n.stream_sid=e.string();break;case 3:n.id_name=e.bytes();break;case 4:n.nick_name=e.bytes();break;case 5:n.extra_info=e.bytes();break;case 6:n.title=e.bytes();break;case 7:n.third_define_data=e.bytes();break;case 8:n.create_time=e.int64();break;case 9:n.req_seq=e.uint32();break;case 10:n.stream_ver=e.uint32();break;case 11:n.stream_attr=e.bytes();break;case 12:n.stream_src=e.uint32();break;case 13:n.stream_state=e.uint32();break;case 14:n.stream_type=e.uint32();break;case 15:n.stream_nid=e.uint32();break;case 16:n.close_type=e.uint32();break;default:e.skipType(7&i)}}return n},Ke),i.PushImChat=(Je.prototype.room_id=a.newBuffer([]),Je.prototype.server_msg_id=a.Long?a.Long.fromBits(0,0,!0):0,Je.prototype.ret_msg_id=a.Long?a.Long.fromBits(0,0,!0):0,Je.prototype.msg_data=a.emptyArray,Je.create=function(e){return new Je(e)},Je.encode=function(e,t){if(t=t||s.create(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.server_msg_id&&Object.hasOwnProperty.call(e,"server_msg_id")&&t.uint32(16).uint64(e.server_msg_id),null!=e.ret_msg_id&&Object.hasOwnProperty.call(e,"ret_msg_id")&&t.uint32(24).uint64(e.ret_msg_id),null!=e.msg_data&&e.msg_data.length)for(var r=0;r<e.msg_data.length;++r)c.liveroom_cs.StImChatData.encode(e.msg_data[r],t.uint32(34).fork()).ldelim();return t},Je.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushImChat;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.room_id=e.bytes();break;case 2:n.server_msg_id=e.uint64();break;case 3:n.ret_msg_id=e.uint64();break;case 4:n.msg_data&&n.msg_data.length||(n.msg_data=[]),n.msg_data.push(c.liveroom_cs.StImChatData.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},Je),i.StImChatData=(Xe.prototype.id_name=a.newBuffer([]),Xe.prototype.nick_name=a.newBuffer([]),Xe.prototype.role=0,Xe.prototype.msg_id=a.Long?a.Long.fromBits(0,0,!0):0,Xe.prototype.msg_category=0,Xe.prototype.msg_type=0,Xe.prototype.msg_priority=0,Xe.prototype.msg_content=a.newBuffer([]),Xe.prototype.send_time=a.Long?a.Long.fromBits(0,0,!1):0,Xe.create=function(e){return new Xe(e)},Xe.encode=function(e,t){return t=t||s.create(),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(32).uint64(e.msg_id),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(40).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(48).uint32(e.msg_type),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(56).uint32(e.msg_priority),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(66).bytes(e.msg_content),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(72).int64(e.send_time),t},Xe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StImChatData;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id_name=e.bytes();break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;case 4:n.msg_id=e.uint64();break;case 5:n.msg_category=e.uint32();break;case 6:n.msg_type=e.uint32();break;case 7:n.msg_priority=e.uint32();break;case 8:n.msg_content=e.bytes();break;case 9:n.send_time=e.int64();break;default:e.skipType(7&i)}}return n},Xe),i.PushBigImChat=($e.prototype.app_id=0,$e.prototype.room_id=a.newBuffer([]),$e.prototype.timestamp=a.Long?a.Long.fromBits(0,0,!1):0,$e.prototype.msg_data=a.emptyArray,$e.create=function(e){return new $e(e)},$e.encode=function(e,t){if(t=t||s.create(),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).int64(e.timestamp),null!=e.msg_data&&e.msg_data.length)for(var r=0;r<e.msg_data.length;++r)c.liveroom_cs.StBigImChatData.encode(e.msg_data[r],t.uint32(34).fork()).ldelim();return t},$e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushBigImChat;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.app_id=e.uint32();break;case 2:n.room_id=e.bytes();break;case 3:n.timestamp=e.int64();break;case 4:n.msg_data&&n.msg_data.length||(n.msg_data=[]),n.msg_data.push(c.liveroom_cs.StBigImChatData.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},$e),i.StBigImChatData=(et.prototype.id_name=a.newBuffer([]),et.prototype.nick_name=a.newBuffer([]),et.prototype.role=0,et.prototype.bigmsg_id=a.newBuffer([]),et.prototype.msg_category=0,et.prototype.msg_type=0,et.prototype.msg_content=a.newBuffer([]),et.prototype.msg_timestamp=a.Long?a.Long.fromBits(0,0,!1):0,et.create=function(e){return new et(e)},et.encode=function(e,t){return t=t||s.create(),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.bigmsg_id&&Object.hasOwnProperty.call(e,"bigmsg_id")&&t.uint32(34).bytes(e.bigmsg_id),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(40).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(48).uint32(e.msg_type),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(58).bytes(e.msg_content),null!=e.msg_timestamp&&Object.hasOwnProperty.call(e,"msg_timestamp")&&t.uint32(64).int64(e.msg_timestamp),t},et.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StBigImChatData;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id_name=e.bytes();break;case 2:n.nick_name=e.bytes();break;case 3:n.role=e.uint32();break;case 4:n.bigmsg_id=e.bytes();break;case 5:n.msg_category=e.uint32();break;case 6:n.msg_type=e.uint32();break;case 7:n.msg_content=e.bytes();break;case 8:n.msg_timestamp=e.int64();break;default:e.skipType(7&i)}}return n},et),i.PushTrans=(tt.prototype.app_id=0,tt.prototype.room_id=a.newBuffer([]),tt.prototype.trans_idname=a.newBuffer([]),tt.prototype.trans_nickname=a.newBuffer([]),tt.prototype.trans_role=0,tt.prototype.trans_type=a.newBuffer([]),tt.prototype.trans_data=a.newBuffer([]),tt.prototype.trans_seq=0,tt.prototype.trans_send_time=a.Long?a.Long.fromBits(0,0,!1):0,tt.prototype.trans_channel=a.newBuffer([]),tt.prototype.trans_list_seq=0,tt.create=function(e){return new tt(e)},tt.encode=function(e,t){return t=t||s.create(),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(50).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(58).bytes(e.trans_data),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(64).uint32(e.trans_seq),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(72).int64(e.trans_send_time),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(82).bytes(e.trans_channel),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(88).uint32(e.trans_list_seq),t},tt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushTrans;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.app_id=e.uint32();break;case 2:n.room_id=e.bytes();break;case 3:n.trans_idname=e.bytes();break;case 4:n.trans_nickname=e.bytes();break;case 5:n.trans_role=e.uint32();break;case 6:n.trans_type=e.bytes();break;case 7:n.trans_data=e.bytes();break;case 8:n.trans_seq=e.uint32();break;case 9:n.trans_send_time=e.int64();break;case 10:n.trans_channel=e.bytes();break;case 11:n.trans_list_seq=e.uint32();break;default:e.skipType(7&i)}}return n},tt),i.PushUserTrans=(rt.prototype.app_id=0,rt.prototype.room_id=a.newBuffer([]),rt.prototype.trans_idname=a.newBuffer([]),rt.prototype.trans_nickname=a.newBuffer([]),rt.prototype.trans_role=0,rt.prototype.trans_send_time=a.Long?a.Long.fromBits(0,0,!1):0,rt.prototype.trans_channel=a.newBuffer([]),rt.prototype.trans_array=a.emptyArray,rt.create=function(e){return new rt(e)},rt.encode=function(e,t){if(t=t||s.create(),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(72).int64(e.trans_send_time),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(82).bytes(e.trans_channel),null!=e.trans_array&&e.trans_array.length)for(var r=0;r<e.trans_array.length;++r)c.liveroom_cs.StTransSimple.encode(e.trans_array[r],t.uint32(90).fork()).ldelim();return t},rt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.PushUserTrans;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.app_id=e.uint32();break;case 2:n.room_id=e.bytes();break;case 3:n.trans_idname=e.bytes();break;case 4:n.trans_nickname=e.bytes();break;case 5:n.trans_role=e.uint32();break;case 9:n.trans_send_time=e.int64();break;case 10:n.trans_channel=e.bytes();break;case 11:n.trans_array&&n.trans_array.length||(n.trans_array=[]),n.trans_array.push(c.liveroom_cs.StTransSimple.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},rt),i.StTransSimple=(nt.prototype.trans_type=a.newBuffer([]),nt.prototype.trans_data=a.newBuffer([]),nt.prototype.trans_seq=0,nt.create=function(e){return new nt(e)},nt.encode=function(e,t){return t=t||s.create(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(18).bytes(e.trans_data),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(24).uint32(e.trans_seq),t},nt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.liveroom_cs.StTransSimple;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.trans_type=e.bytes();break;case 2:n.trans_data=e.bytes();break;case 3:n.trans_seq=e.uint32();break;default:e.skipType(7&i)}}return n},nt),i),e.exports=c},function(e,t,r){var n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}function i(e){var t=Math.clz32(e&-e);return e?31-t:t}Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var o={},s={};function a(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=s[e])?n:(r=u(e,0,!0),i&&(s[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=o[e])?n:(r=u(e,e<0?-1:0,!1),i&&(o[e]=r),r)}function c(e,t){if(isNaN(e))return t?v:_;if(t){if(e<0)return v;if(f<=e)return T}else{if(e<=-g)return C;if(g<=e+1)return b}return e<0?c(-e,t).neg():u(e%p|0,e/p|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=c,r.fromBits=u;var l=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if(t="number"==typeof t?(r=t,!1):!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?v:_;if((r=r||10)<2||36<r)throw RangeError("radix");var n;if(0<(n=e.indexOf("-")))throw Error("interior hyphen");if(0===n)return d(e.substring(1),t,r).neg();for(var i=c(l(r,8)),o=_,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),r);o=a<8?(a=c(l(r,a)),o.mul(a).add(c(u))):(o=o.mul(i)).add(c(u))}return o.unsigned=t,o}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?d(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=h;var p=4294967296,f=p*p,g=f/2,m=a(1<<24),_=a(0),v=(r.ZERO=_,a(0,!0)),y=(r.UZERO=v,a(1)),E=(r.ONE=y,a(1,!0)),S=(r.UONE=E,a(-1)),b=(r.NEG_ONE=S,u(-1,2147483647,!1)),T=(r.MAX_VALUE=b,u(-1,-1,!0)),C=(r.MAX_UNSIGNED_VALUE=T,u(0,-2147483648,!1)),R=(r.MIN_VALUE=C,r.prototype);return R.toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},R.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";var t,r;if(this.isNegative())return this.eq(C)?(r=c(e),r=(t=this.div(r)).mul(r).sub(this),t.toString(e)+r.toInt().toString(e)):"-"+this.neg().toString(e);for(var n=c(l(e,6),this.unsigned),i=this,o="";;){var s=i.div(n),a=(i.sub(s.mul(n)).toInt()>>>0).toString(e);if((i=s).isZero())return a+o;for(;a.length<6;)a="0"+a;o=""+a+o}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;0<t&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},R.isZero=function(){return 0===this.high&&0===this.low},R.eqz=R.isZero,R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||0<=this.high},R.isOdd=function(){return 1==(1&this.low)},R.isEven=function(){return 0==(1&this.low)},R.equals=function(e){return n(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},R.eq=R.equals,R.notEquals=function(e){return!this.eq(e)},R.neq=R.notEquals,R.ne=R.notEquals,R.lessThan=function(e){return this.comp(e)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(e){return this.comp(e)<=0},R.lte=R.lessThanOrEqual,R.le=R.lessThanOrEqual,R.greaterThan=function(e){return 0<this.comp(e)},R.gt=R.greaterThan,R.greaterThanOrEqual=function(e){return 0<=this.comp(e)},R.gte=R.greaterThanOrEqual,R.ge=R.greaterThanOrEqual,R.compare=function(e){if(n(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(y)},R.neg=R.negate,R.add=function(e){n(e)||(e=h(e));var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,l=0,d=0,p=0,f=0;return d+=(p=p+((f+=o+(65535&e.low))>>>16)+(i+c))>>>16,u((p&=65535)<<16|(f&=65535),((l+=(d+=r+a)>>>16)+(t+s)&65535)<<16|(d&=65535),this.unsigned)},R.subtract=function(e){return n(e)||(e=h(e)),this.add(e.neg())},R.sub=R.subtract,R.multiply=function(e){if(this.isZero())return this;if(n(e)||(e=h(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?v:_;if(this.eq(C))return e.isOdd()?C:_;if(e.eq(C))return this.isOdd()?C:_;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return c(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,d=e.low>>>16,p=0,f=0,g=0,y=(y=0)+((f=f+((g+=s*(e=65535&e.low))>>>16)+o*e)>>>16)+((f=(65535&f)+s*d)>>>16);return u((f&=65535)<<16|(g&=65535),((p+=(y+=i*e)>>>16)+((y=(65535&y)+o*d)>>>16)+((y=(65535&y)+s*l)>>>16)+(r*e+i*d+o*l+s*a)&65535)<<16|(y&=65535),this.unsigned)},R.mul=R.multiply,R.divide=function(e){if((e=n(e)?e:h(e)).isZero())throw Error("division by zero");var r,i,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:_;if(this.unsigned){if((e=e.unsigned?e:e.toUnsigned()).gt(this))return v;if(e.gt(this.shru(1)))return E;i=v}else{if(this.eq(C))return e.eq(y)||e.eq(S)?C:e.eq(C)?y:(o=this.shr(1).div(e).shl(1)).eq(_)?e.isNegative()?y:S:(r=this.sub(e.mul(o)),o.add(r.div(e)));if(e.eq(C))return this.unsigned?v:_;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=_}for(r=this;r.gte(e);){o=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(o)/Math.LN2),a=s<=48?1:l(2,s-48),d=c(o),p=d.mul(e);p.isNegative()||p.gt(r);)p=(d=c(o-=a,this.unsigned)).mul(e);d.isZero()&&(d=y),i=i.add(d),r=r.sub(p)}return i},R.div=R.divide,R.modulo=function(e){return n(e)||(e=h(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},R.mod=R.modulo,R.rem=R.modulo,R.not=function(){return u(~this.low,~this.high,this.unsigned)},R.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},R.clz=R.countLeadingZeros,R.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},R.ctz=R.countTrailingZeros,R.and=function(e){return n(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},R.or=function(e){return n(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},R.xor=function(e){return n(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},R.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):u(32===e?this.high:this.high>>>e-32,0,this.unsigned)},R.shru=R.shiftRightUnsigned,R.shr_u=R.shiftRightUnsigned,R.rotateLeft=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?u(this.low<<e|this.high>>>(t=32-e),this.high<<e|this.low>>>t,this.unsigned):u(this.high<<(e-=32)|this.low>>>(t=32-e),this.low<<e|this.high>>>t,this.unsigned)},R.rotl=R.rotateLeft,R.rotateRight=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?u(this.high<<(t=32-e)|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned):u(this.low<<(t=32-(e-=32))|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)},R.rotr=R.rotateRight,R.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},R.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},R.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},e.default=r,"default"in e?e.default:e}({});void 0!==(t=function(){return n}.apply(t,[]))&&(e.exports=t)},function(e,t,r){(function(t){var n;e.exports=(n=function(e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),!(n=!(n=!(n="undefined"!=typeof globalThis&&globalThis.crypto?globalThis.crypto:n)&&"undefined"!=typeof window&&window.msCrypto?window.msCrypto:n)&&void 0!==t&&t.crypto?t.crypto:n))try{n=r(16)}catch(s){}var i=Object.create||function(e){return o.prototype=e,e=new o,o.prototype=null,e};function o(){}var s={},a=s.lib={},c=a.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(var a=0;a<i;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")}());return new u.init(t,e)}}),l=s.enc={},d=l.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(r,t/2)}},h=l.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(r,t)}},p=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},f=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,i=n.words,o=n.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s;if(t=e.min(4*c,o),c){for(var l=0;l<c;l+=s)this._doProcessBlock(i,l);r=i.splice(0,c),n.sigBytes-=t}return new u.init(r,t)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),g=(a.Hasher=f.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new g.HMAC.init(e,r).finalize(t)}}}),s.algo={});return s}(Math),n)}).call(this,r(10))},function(e,t,r){e.exports=function(e){for(var t=e,r=t.lib.BlockCipher,n=t.algo,i=[],o=[],s=[],a=[],c=[],u=[],l=[],d=[],h=[],p=[],f=[],g=0;g<256;g++)f[g]=g<128?g<<1:g<<1^283;var m=0,_=0;for(g=0;g<256;g++){var v=_^_<<1^_<<2^_<<3^_<<4;v=v>>>8^255&v^99,i[m]=v,o[v]=m;var y=f[m],E=f[y],S=f[E],b=257*f[v]^16843008*v;s[m]=b<<24|b>>>8,a[m]=b<<16|b>>>16,c[m]=b<<8|b>>>24,u[m]=b,b=16843009*S^65537*E^257*y^16843008*m,l[v]=b<<24|b>>>8,d[v]=b<<16|b>>>16,h[v]=b<<8|b>>>24,p[v]=b,m?(m=y^f[f[f[S^y]]],_^=f[f[_]]):m=_=1}var T=[0,1,2,4,8,16,32,64,128,27,54],C=n.AES=r.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=4*((this._nRounds=r+6)+1),o=this._keySchedule=[],s=0;s<n;s++)s<r?o[s]=t[s]:(u=o[s-1],s%r?r>6&&s%r==4&&(u=i[u>>>24]<<24|i[u>>>16&255]<<16|i[u>>>8&255]<<8|i[255&u]):(u=i[(u=u<<8|u>>>24)>>>24]<<24|i[u>>>16&255]<<16|i[u>>>8&255]<<8|i[255&u],u^=T[s/r|0]<<24),o[s]=o[s-r]^u);for(var a=this._invKeySchedule=[],c=0;c<n;c++){if(s=n-c,c%4)var u=o[s];else u=o[s-4];a[c]=c<4||s<=4?u:l[i[u>>>24]]^d[i[u>>>16&255]]^h[i[u>>>8&255]]^p[i[255&u]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,u,i)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,l,d,h,p,o),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,o,s,a){for(var c=this._nRounds,u=e[t]^r[0],l=e[t+1]^r[1],d=e[t+2]^r[2],h=e[t+3]^r[3],p=4,f=1;f<c;f++){var g=n[u>>>24]^i[l>>>16&255]^o[d>>>8&255]^s[255&h]^r[p++],m=n[l>>>24]^i[d>>>16&255]^o[h>>>8&255]^s[255&u]^r[p++],_=n[d>>>24]^i[h>>>16&255]^o[u>>>8&255]^s[255&l]^r[p++],v=n[h>>>24]^i[u>>>16&255]^o[l>>>8&255]^s[255&d]^r[p++];u=g,l=m,d=_,h=v}g=(a[u>>>24]<<24|a[l>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^r[p++],m=(a[l>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&u])^r[p++],_=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[u>>>8&255]<<8|a[255&l])^r[p++],v=(a[h>>>24]<<24|a[u>>>16&255]<<16|a[l>>>8&255]<<8|a[255&d])^r[p++],e[t]=g,e[t+1]=m,e[t+2]=_,e[t+3]=v},keySize:8});return t.AES=r._createHelper(C),e.AES}(r(2),(r(17),r(4),r(11),r(20)))},function(e,t,r){e.exports=function(e){for(var t=Math,r=e,n=r.lib,i=n.WordArray,o=n.Hasher,s=r.algo,a=[],c=0;c<64;c++)a[c]=4294967296*t.abs(t.sin(c+1))|0;var u=s.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,s=e[t+0],c=e[t+1],u=e[t+2],f=e[t+3],g=e[t+4],m=e[t+5],_=e[t+6],v=e[t+7],y=e[t+8],E=e[t+9],S=e[t+10],b=e[t+11],T=e[t+12],C=e[t+13],R=e[t+14],O=e[t+15],k=o[0],I=o[1],L=o[2],w=o[3];k=l(k,I,L,w,s,7,a[0]),w=l(w,k,I,L,c,12,a[1]),L=l(L,w,k,I,u,17,a[2]),I=l(I,L,w,k,f,22,a[3]),k=l(k,I,L,w,g,7,a[4]),w=l(w,k,I,L,m,12,a[5]),L=l(L,w,k,I,_,17,a[6]),I=l(I,L,w,k,v,22,a[7]),k=l(k,I,L,w,y,7,a[8]),w=l(w,k,I,L,E,12,a[9]),L=l(L,w,k,I,S,17,a[10]),I=l(I,L,w,k,b,22,a[11]),k=l(k,I,L,w,T,7,a[12]),w=l(w,k,I,L,C,12,a[13]),L=l(L,w,k,I,R,17,a[14]),k=d(k,I=l(I,L,w,k,O,22,a[15]),L,w,c,5,a[16]),w=d(w,k,I,L,_,9,a[17]),L=d(L,w,k,I,b,14,a[18]),I=d(I,L,w,k,s,20,a[19]),k=d(k,I,L,w,m,5,a[20]),w=d(w,k,I,L,S,9,a[21]),L=d(L,w,k,I,O,14,a[22]),I=d(I,L,w,k,g,20,a[23]),k=d(k,I,L,w,E,5,a[24]),w=d(w,k,I,L,R,9,a[25]),L=d(L,w,k,I,f,14,a[26]),I=d(I,L,w,k,y,20,a[27]),k=d(k,I,L,w,C,5,a[28]),w=d(w,k,I,L,u,9,a[29]),L=d(L,w,k,I,v,14,a[30]),k=h(k,I=d(I,L,w,k,T,20,a[31]),L,w,m,4,a[32]),w=h(w,k,I,L,y,11,a[33]),L=h(L,w,k,I,b,16,a[34]),I=h(I,L,w,k,R,23,a[35]),k=h(k,I,L,w,c,4,a[36]),w=h(w,k,I,L,g,11,a[37]),L=h(L,w,k,I,v,16,a[38]),I=h(I,L,w,k,S,23,a[39]),k=h(k,I,L,w,C,4,a[40]),w=h(w,k,I,L,s,11,a[41]),L=h(L,w,k,I,f,16,a[42]),I=h(I,L,w,k,_,23,a[43]),k=h(k,I,L,w,E,4,a[44]),w=h(w,k,I,L,T,11,a[45]),L=h(L,w,k,I,O,16,a[46]),k=p(k,I=h(I,L,w,k,u,23,a[47]),L,w,s,6,a[48]),w=p(w,k,I,L,v,10,a[49]),L=p(L,w,k,I,R,15,a[50]),I=p(I,L,w,k,m,21,a[51]),k=p(k,I,L,w,T,6,a[52]),w=p(w,k,I,L,f,10,a[53]),L=p(L,w,k,I,S,15,a[54]),I=p(I,L,w,k,c,21,a[55]),k=p(k,I,L,w,y,6,a[56]),w=p(w,k,I,L,O,10,a[57]),L=p(L,w,k,I,_,15,a[58]),I=p(I,L,w,k,C,21,a[59]),k=p(k,I,L,w,g,6,a[60]),w=p(w,k,I,L,b,10,a[61]),L=p(L,w,k,I,u,15,a[62]),I=p(I,L,w,k,E,21,a[63]),o[0]=o[0]+k|0,o[1]=o[1]+I|0,o[2]=o[2]+L|0,o[3]=o[3]+w|0},_doFinalize:function(){var e=this._data,r=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;r[i>>>5]|=128<<24-i%32;var o=t.floor(n/4294967296),s=n;r[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(r.length+1),this._process();for(var a=this._hash,c=a.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function l(e,t,r,n,i,o,s){var a=e+(t&r|~t&n)+i+s;return(a<<o|a>>>32-o)+t}function d(e,t,r,n,i,o,s){var a=e+(t&n|r&~n)+i+s;return(a<<o|a>>>32-o)+t}function h(e,t,r,n,i,o,s){var a=e+(t^r^n)+i+s;return(a<<o|a>>>32-o)+t}function p(e,t,r,n,i,o,s){var a=e+(r^(t|~n))+i+s;return(a<<o|a>>>32-o)+t}return r.MD5=o._createHelper(u),r.HmacMD5=o._createHmacHelper(u),e.MD5}(r(2))},function(e,t,r){function n(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var i,o;e.exports=(i=[function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.E_CLIENT_TYPE=t.ENUM_LOG_LEVEL=t.ENUM_REMOTE_TYPE=t.ZEGO_ENV=t.ZEGO_BROWSER_TYPE=void 0,(n=t.ZEGO_BROWSER_TYPE||(t.ZEGO_BROWSER_TYPE={}))[n.IE=0]="IE",n[n.FIREFOX=1]="FIREFOX",n[n.CHROME=2]="CHROME",n[n.SAFARI=3]="SAFARI",n[n.OPERA=4]="OPERA",n[n.WEIXIN=5]="WEIXIN",n[n.WEIXINMINI=6]="WEIXINMINI",n[n.UNKOWN=7]="UNKOWN",(n=t.ZEGO_ENV||(t.ZEGO_ENV={}))[n.BROWSER=0]="BROWSER",n[n.WEIXINMINI=1]="WEIXINMINI",(n=t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={}))[n.DISABLE=0]="DISABLE",n[n.WEBSOCKET=1]="WEBSOCKET",n[n.HTTPS=2]="HTTPS",t.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},(n=t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={}))[n.ClientType_None=0]="ClientType_None",n[n.ClientType_H5=1]="ClientType_H5",n[n.ClientType_SmallPragram=2]="ClientType_SmallPragram",n[n.ClientType_Webrtc=3]="ClientType_Webrtc"},function(e,t,r){"use strict";function n(){this._testEnvironment=!0,this._ENV=0,this._debug=!0}Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerStateCenter=void 0,n.getInstance=function(){return n.instance||(n.instance=new n).init(),n.instance},n.prototype.init=function(){},Object.defineProperty(n.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(e){this._testEnvironment=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ENV",{get:function(){return this._ENV},set:function(e){this._ENV=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e},enumerable:!1,configurable:!0}),n.instance=new n,t.LoggerStateCenter=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoWebSocket=t.ZegoWeiXinMiniWebSocket=void 0;var n=r(0),i=(o.prototype.init=function(){var e=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onopen&&(e.onopen(t),e._websocket.onClose((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onclose&&e.onclose(t)})),e._websocket.onMessage((function(t){"function"==typeof e.onmessage&&e.onmessage(t)})))})),this._websocket.onError((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onerror&&e.onerror(t)})))},o.prototype.onopen=function(e){},o.prototype.onerror=function(e){},o.prototype.onclose=function(e){},o.prototype.onmessage=function(e){},o.prototype.send=function(e){this._websocket&&this._websocket.send({data:e})},o.prototype.close=function(){this._websocket&&this._websocket.close()},o);function o(e,t){this.url=e,this.readyState=3,this._websocket=wx.connectSocket({url:e}),this.init()}t.ZegoWeiXinMiniWebSocket=i,t.createZegoWebSocket=function(e,t){return new(t%2===n.ZEGO_ENV.BROWSER?WebSocket:i)(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerStateCenter=t.createZegoWebSocket=t.ZegoDataReport=t.ZegoLogger=void 0;var n=r(1),i=(Object.defineProperty(t,"LoggerStateCenter",{enumerable:!0,get:function(){return n.LoggerStateCenter}}),r(2)),o=(Object.defineProperty(t,"createZegoWebSocket",{enumerable:!0,get:function(){return i.createZegoWebSocket}}),r(4)),s=(Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return o.ZegoDataReport}}),r(5));Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return s.ZegoLogger}})},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=(Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDataReport=void 0,o.prototype.newReport=function(e,t){this.dataStatistics[e]={event_time:Date.now(),time_consumed:0,seq:e,error:0,message:"success",event:t,events:[]}},o.prototype.addMsgExt=function(e,t){this.dataStatistics[e]?this.dataStatistics[e].msg_ext=t:console.warn(e+" not exist")},o.prototype.addMsgInfo=function(e,t){this.dataStatistics[e]?Object.assign(this.dataStatistics[e],t):console.warn(e+" not exist")},o.prototype.eventStart=function(e,t){this.dataStatistics[e]?null!=this.dataStatistics[e].events?this.dataStatistics[e].events.push({event:t,event_time:Date.now(),time_consumed:0}):this.logger.warn("zd.es.0 no events"):this.logger.warn("zd.es.0 no seq match")},o.prototype.eventEnd=function(e,t,r){if(this.dataStatistics[e]){var n=this.dataStatistics[e].events;if(n&&0!==n.length){for(var i=n.length-1;0<=i;i--)if(n[i].event==t&&0==n[i].time_consumed){n[i].time_consumed=Date.now()-n[i].event_time;break}}else this.logger.info("zd.ee.0 no events")}else this.logger.info("zd.ee.0 no seq match")},o.prototype.eventEndWithMsg=function(e,t,r){if(this.dataStatistics[e]){var i=this.dataStatistics[e].events;if(i){for(var o=i.length-1;0<=o;o--)if(i[o].event==t&&0==i[o].time_consumed){i[o].time_consumed=Date.now()-i[o].event_time,null==i[o].msg_ext&&(i[o].msg_ext={}),i[o].msg_ext=n({},r);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},o.prototype.eventEndWithMsgInfo=function(e,t,r){if(this.dataStatistics[e]){var n=this.dataStatistics[e].events;if(n){for(var i=n.length-1;0<=i;i--)if(n[i].event==t&&0==n[i].time_consumed){n[i].time_consumed=Date.now()-n[i].event_time,Object.assign(n[i],r);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},o.prototype.addEventInfo=function(e,t,r,n){if(this.dataStatistics[e]){var i=this.dataStatistics[e].events;if(null!=i){for(var o=i.length-1;0<=o;o--)if(i[o].event==t&&null!=i[o].time_consumed){null==i[o].msg_ext?i[o].msg_ext={}:i[o].msg_ext&&(i[o].msg_ext[r]=n);break}}else this.logger.warn("zd.aei.0 no events")}else this.logger.warn("zd.aei.0 no seq match")},o.prototype.addEventMsg=function(e,t,r,n){if(this.dataStatistics[e]){var i=this.dataStatistics[e].events;if(null!=i){for(var o=i.length-1;0<=o;o--)if(i[o].event==t){i[o][r]=n;break}}else this.logger.warn("zd.aem.0 no events")}else this.logger.warn("zd.aem.0 no seq match")},o.prototype.addEvent=function(e,t,r){this.dataStatistics[e]?this.dataStatistics[e].events&&(r?this.dataStatistics[e].events.push({event:t,event_time:Date.now(),msg_ext:r}):this.dataStatistics[e].events.push({event:t,event_time:Date.now()})):this.logger.warn("zd.ae.0 no seq match")},o.prototype.uploadReport=function(e,t,r,n){var i=this.dataStatistics[e];null!=i&&(t&&(i.event=t),i.time_consumed=Date.now()-i.event_time,r&&this.addMsgInfo(e,{error:r.code,message:r.message||r.msg+" "+(n||"")}),this.logger.report(i),delete this.dataStatistics[e])},o);function o(e){this.dataStatistics={},this.logger=e}t.ZegoDataReport=i},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=(Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLogger=void 0,r(0)),o=r(2),s=r(1),a=r(6);function c(e){this.logLevel=i.ENUM_LOG_LEVEL.INFO,this.logRemoteLevel=0,this.websocket=null,this.logUploadTimer=null,this.logUploadInterval=1e4,this.logCache=[],this.logCacheSend=[],this.logCacheMax=100,this.existUserID=!1,this.stateCenter=s.LoggerStateCenter.getInstance(),this.env=e}c.prototype.setLogLevel=function(e){return void 0!==(e=i.ENUM_LOG_LEVEL[e])&&(this.logLevel=e,!0)},c.prototype.setRemoteLogLevel=function(e){return void 0!==(e=i.ENUM_LOG_LEVEL[e])&&(this.logRemoteLevel=e,!0)},c.prototype.setSessionInfo=function(e,t,r,n,i,o){this.appid=e,this.roomid=t,this.sessionid=r,this.userid=n,this.userName=i,this.version=o},c.prototype.report=function(e){e=this.logReportParamList(i.ENUM_LOG_LEVEL.REPORT,e),this.logLevel!==i.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=i.ENUM_LOG_LEVEL.REPORT&&console.debug(e),this.RemoteLog(i.ENUM_LOG_LEVEL.REPORT,e,!0)},c.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(i.ENUM_LOG_LEVEL.DEBUG,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=i.ENUM_LOG_LEVEL.DEBUG&&console.debug(r),this.log(i.ENUM_LOG_LEVEL.DEBUG,r)},c.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(i.ENUM_LOG_LEVEL.INFO,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=i.ENUM_LOG_LEVEL.INFO&&console.info(r),this.log(i.ENUM_LOG_LEVEL.INFO,r)},c.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(i.ENUM_LOG_LEVEL.WARN,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=i.ENUM_LOG_LEVEL.WARN&&console.warn(r),this.log(i.ENUM_LOG_LEVEL.WARN,r)},c.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.logParamList(i.ENUM_LOG_LEVEL.ERROR,e.join(""));this.logLevel!==i.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=i.ENUM_LOG_LEVEL.ERROR&&(console.error(r),window?this.stateCenter.debug&&window.alert(e.join("").substr(e.join("").indexOf(" ")+1,4500)):wx&&this.stateCenter.debug&&wx.showModal({title:"",content:e.join("").substr(e.join("").indexOf(" ")+1,4500)})),this.log(i.ENUM_LOG_LEVEL.ERROR,r)},c.prototype.log=function(e,t){this.logRemoteLevel!==i.ENUM_LOG_LEVEL.DISABLE&&this.logRemoteLevel<=e&&this.RemoteLog(e,t)},c.prototype.setLogServer=function(e){try{return e.startsWith("wss:")?(this.logType=i.ENUM_REMOTE_TYPE.WEBSOCKET,this.openWebSocketLogServer(e)):e.startsWith("https:")?(this.logType=i.ENUM_REMOTE_TYPE.HTTPS,this.openHttpsLogServer(e)):this.logType=i.ENUM_REMOTE_TYPE.DISABLE,!0}catch(e){return this.error(JSON.stringify(e)),!1}},c.prototype.stopLogServer=function(){this.logType==i.ENUM_REMOTE_TYPE.WEBSOCKET?this.stopWebSocketServer():this.logType==i.ENUM_REMOTE_TYPE.HTTPS&&(this.SendHttpsLog(),this.stopHttpsServer()),this.logType=i.ENUM_REMOTE_TYPE.DISABLE},c.prototype.stopWebSocketServer=function(){this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null)},c.prototype.openHttpsLogServer=function(e){var t=this;(this.url=e)&&(this.stopHttpsServer(),this.logUploadTimer||(this.logUploadTimer=setInterval((function(){t.SendHttpsLog()}),this.logUploadInterval)))},c.prototype.stopHttpsServer=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},c.prototype.RemoteLog=function(e,t,r){if(void 0===r&&(r=!1),""!=this.url)if(this.logType==i.ENUM_REMOTE_TYPE.WEBSOCKET)this.RemoteWebSocketLog(e,t);else if(this.logType==i.ENUM_REMOTE_TYPE.HTTPS)this.RemoteHttpsLog(e,t,r);else if(this.logLevel!==i.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e)for(this.logCacheSend.push(t);this.logCacheSend.length>this.logCacheMax;)this.logCacheSend.shift()},c.prototype.RemoteWebSocketLog=function(e,t){if("string"==typeof t&&4e3<t.length)console.info("log over maximum, ignore");else if(null==this.websocket||2==this.websocket.readyState||3==this.websocket.readyState){var r=this.url;this.url="",this.setLogServer(r),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)}else if(0==this.websocket.readyState)this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(1==this.websocket.readyState)if(0<this.logCacheSend.length){for(var i="",o=0;o<this.logCacheSend.length;o++){4e3<(i+this.logCacheSend[o]).length&&(this.websocket.send(i),i="");var s=JSON.parse(this.logCacheSend[o]);s=n(n({},s),{userid:s.userid||this.userid,roomid:s.roomid||this.roomid,userName:s.roomid||this.userName}),i=i+JSON.stringify(s)+"\n"}t=i+t,this.logCacheSend=[],this.websocket.send(t)}else this.websocket.send(t);else console.warn("wrong socket state:"+this.websocket.readyState),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)},c.prototype.RemoteHttpsLog=function(e,t,r){this.logCacheSend.push(t),(this.logCacheSend.length>=this.logCacheMax||!0===r)&&this.SendHttpsLog()},c.prototype.logParamList=function(e,t){var r={time:r=a.getCurrentTime(),level:e,action:(t=[t.substr(0,t.indexOf(" "))||t,t.substr(t.indexOf(" ")+1,4500)||t])[0],content:t[1],appid:this.appid,roomid:this.roomid,userid:this.userid,userName:this.userName,sessionid:this.sessionid};return JSON.stringify(r)},c.prototype.logReportParamList=function(e,t){var r=a.getCurrentTime();return t=n(n({},t),{time:r,level:e,console:this.env%2===i.ZEGO_ENV.BROWSER?"rtc":"xcx",appid:this.appid,room_id:this.roomid,roomid:this.roomid,userid:this.userid,id_name:this.userid,userName:this.userName,sessionid:this.sessionid,sdk_version:this.version,test_environment:this.stateCenter.testEnvironment,version:this.version,event_id:this.appid+"_"+this.userid+"_"+t.event_time+"_"+t.seq}),JSON.stringify(t)},c.prototype.openWebSocketLogServer=function(e){this.url!=e&&(this.url=e)&&(this.stopWebSocketServer(),this.websocket=o.createZegoWebSocket(e,this.env),this.websocket.onopen=function(){},this.websocket.onclose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn("onclose   websocket error:",e)},this.websocket.onmessage=function(){},this.websocket.onerror=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn("open log websocket error:",e)})},c.prototype.SendHttpsLog=function(){0!=this.logCacheSend.length&&(this.env%2===i.ZEGO_ENV.BROWSER?this.SendHttpsLogWeb():this.SendHttpsLogWeChatMini())},c.prototype.SendHttpsLogWeb=function(){var e=this,t=this.logCacheSend.join("\n"),r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState)if(200==r.status){if(0!=r.responseText.length)try{var t=JSON.parse(r.responseText).interval;"number"==typeof t&&e.logUploadInterval!==t&&(e.timeInterval=t,e.openHttpsLogServer(e.url))}catch(t){console.log("send result failed "+t)}}else console.log("send failed "+r.status)},r.open("POST",this.url,!0),0==this.env?r.send(t):2==this.env&&(r.setRequestHeader("content-type","application/json"),r.send(JSON.stringify({user_id:this.userid,log:t}))),this.logCacheSend=[]},c.prototype.SendHttpsLogWeChatMini=function(){var e=this,t=(!this.existUserID&&this.userid&&this.logCacheSend.forEach((function(t){Array.isArray(t)&&t.forEach((function(r,n){var i=JSON.parse(r);i&&""==JSON.parse(r).userid?(i.userid=e.userid,i.id_name=e.userid,t[n]=JSON.stringify(i)):e.existUserID=!0}))})),this.logCacheSend.join("\n"));t=1==this.env?t:JSON.stringify({user_id:this.userid,log:t}),wx.request({url:this.url,data:t,method:"POST",success:function(t){0!=t.data.length&&"number"==typeof(t=t&&t.data&&t.data.interval)&&e.logUploadInterval!==t&&(e.timeInterval=t,e.openHttpsLogServer(e.url))},fail:function(e){console.log("send failed "+e.statusCode)}}),this.logCacheSend=[]},t.ZegoLogger=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTime=t.getCurrentEnv=t.getBrowser=void 0;var n=r(0),i=(t.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),r=-1!=e.indexOf("Firefox"),i=null!=window.opr,o=e.indexOf("Chrome")&&window.chrome,s=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return e=e.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===e.toLowerCase().match(/MicroMessenger/i)[0],t?n.ZEGO_BROWSER_TYPE.IE:r?n.ZEGO_BROWSER_TYPE.FIREFOX:i?n.ZEGO_BROWSER_TYPE.OPERA:o?n.ZEGO_BROWSER_TYPE.CHROME:s?n.ZEGO_BROWSER_TYPE.SAFARI:e?n.ZEGO_BROWSER_TYPE.WEIXIN:n.ZEGO_BROWSER_TYPE.UNKOWN},t.getCurrentEnv=function(){var e=window.navigator.userAgent;return new Promise((function(t){-1==e.indexOf("MicroMessage")?t(n.ZEGO_ENV.BROWSER):wx.miniProgram.getEnv((function(e){e.miniprogram}))}))},["00","01","02","03","04","05","06","07","08","09"]);t.getCurrentTime=function(){var e=new Date;return[e.getFullYear()+"/",(i[e.getMonth()+1]||e.getMonth()+1)+"/",(i[e.getDate()]||e.getDate())+" ",(i[e.getHours()]||e.getHours())+":",(i[e.getMinutes()]||e.getMinutes())+":",i[e.getSeconds()]||e.getSeconds(),"."+e.getTime()%1e3].join("")}}],o={},n.m=i,n.c=o,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3))},function(t,r){t.exports=e},function(e,t,r){e.exports=r(2).enc.Utf8},function(e,t,r){"use strict";t.byteLength=function(e){return 3*((e=u(e))[0]+(e=e[1]))/4-e},t.toByteArray=function(e){var t,r,n=(s=u(e))[0],s=s[1],a=new o(function(e,t){return 3*(e+t)/4-t}(n,s)),c=0,l=0<s?n-4:n;for(r=0;r<l;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],a[c++]=t>>16&255,a[c++]=t>>8&255,a[c++]=255&t;return 2===s&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,a[c++]=255&t),1===s&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,a[c++]=t>>8&255,a[c++]=255&t),a},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(function(e,t,r){for(var i,o=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(function(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}(i));return o.join("")}(e,s,a<s+16383?a:s+16383));return 1==i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2==i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return t=(e=-1===(e=e.indexOf("="))?t:e)===t?0:4-e%4,[e,t]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t,r){e.exports=r(2).enc.Hex},function(e,t){var r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n,i,o,s,a;e.exports=(e=r(2),r(18),r(19),n=(o=(r=e).lib).Base,i=o.WordArray,s=(o=r.algo).MD5,a=o.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r,n=this.cfg,o=n.hasher.create(),s=i.create(),a=s.words,c=n.keySize,u=n.iterations;a.length<c;){r&&o.update(r),r=o.update(e).finalize(t),o.reset();for(var l=1;l<u;l++)r=o.finalize(r),o.reset();s.concat(r)}return s.sigBytes=4*c,s}}),r.EvpKDF=function(e,t,r){return a.create(r).compute(e,t)},e.EvpKDF)},function(e,t,r){function n(e){if(s[e])return s[e].exports;var t=s[e]={i:e,l:!1,exports:{}};return o[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var i,o,s;e.exports=(i=r(15),s={},n.m=o=[function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_SETTING_ACTION=void 0,(t=t.ZEGO_SETTING_ACTION||(t.ZEGO_SETTING_ACTION={})).CONSTRUCTOR="zs.0",t.SETTING_INIT="zs.ii.0",t.SETTING_FETCH_SETTING="zs.fs.0",t.SETTING__FETCH_SETTING="zs.fs.1",t.SETTING_GET_CLOUD_SETTING="zs.gcs.0",t.SETTING_POLLING_SETTING="zs.ps.0",t.SETTINGCACHEHANDLER_GET_CACHE_SETTING="zs.sch.gcs.0",t.SETTINGCACHEHANDLER_STORE_SETTING="zs.sch.ss.0",t.SETTINGFETCHHANDLER_FETCHSETTING="zs.sfh.fs.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorList=void 0,t.errorList={NOT_INIT:{code:1001,msg:"not init"},FILE_REQUEST_FAIL:{code:1002,msg:"fetch request fail"},INFLATE_DATA_FAIL:{code:1003,msg:"inflate fail"},MULTI_FILE_NOT_EXIST:{code:1004,msg:"get multi file fail"},AUTH_FAIL:{code:1005,msg:"auth failed"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=t.checkValidNumber=t.analyzeKey=t.getCurrentTime=t.getBrowser=void 0,t.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),r=-1!=e.indexOf("Firefox"),n=null!=window.opr,i=e.indexOf("Chrome")&&window.chrome,o=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return e=e.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===e.toLowerCase().match(/MicroMessenger/i)[0],t?"IE":r?"FIREFOX":n?"OPERA":i?"CHROME":o?"SAFARI":e?"WEIXIN":"UNKOWN"};var n=["00","01","02","03","04","05","06","07","08","09"];t.getCurrentTime=function(){var e=new Date;return[e.getFullYear()+"/",(n[e.getMonth()+1]||e.getMonth()+1)+"/",(n[e.getDate()]||e.getDate())+" ",(n[e.getHours()]||e.getHours())+":",(n[e.getMinutes()]||e.getMinutes())+":",n[e.getSeconds()]||e.getSeconds(),"."+e.getTime()%1e3].join("")},t.analyzeKey=function(e){return e=e.split("_"),{level:Number(e[0]),timestamp:e[1],seq:e[2]}},t.checkValidNumber=function(e,t,r){return t=t||1,r=r||1e4,"number"==typeof e&&e%1==0&&t<=e&&e<=r},t.generateUUID=function(e){var t,r;return 0===(e=void 0===e?0:e)?r=localStorage.getItem("z_deviceID"):wx.getStorageSync("z_deviceID"),r||(t=(new Date).getTime(),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(36)})),0===e?localStorage.setItem("z_deviceID",r):wx.setStorageSync("z_deviceID",r)),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSetting=void 0;var n=r(4);Object.defineProperty(t,"ZegoSetting",{enumerable:!0,get:function(){return n.ZegoSetting}})},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var c=[s,a];if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(a){c=[6,a],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSetting=void 0,r(5)),a=r(6),c=r(10),u=r(0),l=r(12),d=r(1),h=r(2);function p(){this.fileList=[],this.publicEnvVariable={},this.proEnvVariable={},this.pollingTimer=null,this.pollingInterval=300,this.inited=!1,this.checkFailCount=0,this.checkFailed=!1,this.log=new s.ZegoLog}Object.defineProperty(p.prototype,"envVariable",{get:function(){return Object.assign({},this.publicEnvVariable,this.proEnvVariable)},enumerable:!1,configurable:!0}),p.prototype.init=function(e){var t=this;return e.pollingFreq&&!h.checkValidNumber(e.pollingFreq)?(this.log.error(u.ZEGO_SETTING_ACTION.SETTING_INIT+" pollingFreq must be integer number"),!1):(this.options=Object.assign({},l.INIT_CONFIG,e),this.getPublicEnvVariable(),this.settingFetchHandler=new c.SettingFetchHandler(this.options,this.log),this.settingFetchHandler.setDataReport(this.options.reportNotify),e=Math.round(60*Math.random()),this.log.info(u.ZEGO_SETTING_ACTION.SETTING_INIT+" delay "+e),this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null),this.options.pollingFreq&&60<=this.options.pollingFreq&&(this.pollingInterval=this.options.pollingFreq),this.delayTimer=setTimeout((function(){t.pollingSetting(1e3*t.pollingInterval)}),1e3*e),this.settingCacheHandler=new a.SettingCacheHandler("setting_"+(this.options.online?"online_":"test_")+this.options.product+"_"+this.options.appID,this.log,this.options.env),this.refreshAuthCheck(),this.inited=!0)},p.prototype.uninit=function(){this.pollingTimer&&(clearTimeout(this.pollingTimer),this.pollingTimer=null)},p.prototype.setEnvVariable=function(e,t){this.proEnvVariable[e]=String(t)},p.prototype.getEnvVariable=function(e){return this.envVariable[e]},p.prototype.setEnvVariables=function(e){var t=this;Object.keys(e).forEach((function(r){"string"!=typeof e[r]&&"number"!=typeof e[r]&&t.log.error("zs.sev env "+r+" type error"),t.proEnvVariable[r]=String(e[r])}))},p.prototype.getEnvVariables=function(){return this.envVariable},p.prototype.enablePolling=function(e,t){var r=this;t?t.forEach((function(t){var n=r.fileList.find((function(e){return e.fileName===t}));n&&(n.needPolling=e)})):this.fileList.forEach((function(t){return t.needPolling=e}))},p.prototype.setToken=function(e){this.token!==e&&this.refreshAuthCheck(),this.token=e},p.prototype.setUserID=function(e){this.userID!==e&&this.refreshAuthCheck(),this.userID=e},p.prototype.getSettingCache=function(e){return i(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(i){switch(i.label){case 0:return this.inited?(t=this.fileList.find((function(t){return t.fileName===e})))?[2,Promise.resolve({setting:t.setting,versions:t.versions})]:[3,1]:[2,Promise.reject(d.errorList.NOT_INIT)];case 1:return r=this._getFileName(e),[4,this.settingCacheHandler.getCacheSetting(r)];case 2:return(r=i.sent())&&(this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:0,needPolling:!1,setting:r.setting,versions:r.versions}),n={setting:r.setting,versions:r.versions}),[2,Promise.resolve(n)]}}))}))},p.prototype.fetchSetting=function(e,t,r){return void 0===t&&(t={}),void 0===r&&(r=!0),this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" call "+e),this.inited?(this.activePolling(),0<Object.keys(t).length?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(e,n(n({},this.envVariable),t))):(t=this.fileList.find((function(t){return t.fileName===e})))?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file exist"),(new Date).getTime()-t.fetchedTime<1e3*this.pollingInterval?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),t.needPolling=r,Promise.resolve({setting:t.setting,versions:t.versions})):this._fetchSetting(e,t,r)):(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file not found"),this._fetchSetting(e,t,r))):Promise.reject(d.errorList.NOT_INIT)},p.prototype.fetchMultiSetting=function(e,t,r){var s=this;return void 0===t&&(t={}),void 0===r&&(r=!0),this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" call"),this.inited?(this.activePolling(),0<Object.keys(t).length?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(e,n(n({},this.envVariable),t))):new Promise((function(t,n){var a={},c=[];if(e.forEach((function(e){return i(s,void 0,void 0,(function(){var t;return o(this,(function(r){return(t=this.fileList.find((function(t){return t.fileName===e})))&&(new Date).getTime()-t.fetchedTime<1e3*this.pollingInterval?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),a[e]={setting:t.setting,versions:t.versions}):c.push(e),[2]}))}))})),!(0<c.length))return t(a);s._getCloudSetting(c,s.envVariable).then((function(e){return s.handleFetchFiles(e,r),Object.assign(a,e),t(a)})).catch((function(e){c.forEach((function(e){return i(s,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return(t=this.fileList.find((function(t){return t.fileName==e})))?t.fetchedTime=(new Date).getTime():this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:r,setting:{},versions:{}}),[4,this.settingCacheHandler.getCacheSetting(e)];case 1:return t=n.sent(),a[e]={setting:t.setting,versions:t.versions},[2]}}))}))})),0<Object.keys(a).length?t(a):n(e)}))}))):(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" not init"),Promise.reject(d.errorList.NOT_INIT))},p.prototype.setOptions=function(e){e&&"boolean"==typeof e.unify&&(this.options.unify=e.unify,this.settingFetchHandler.setOptions(this.options))},p.prototype.setLog=function(e){this.log=e},p.prototype._getCloudSetting=function(e,t){var r=this;return new Promise((function(n,s){return i(r,void 0,void 0,(function(){var r,i,a,c,l;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.checkFailed?(this.log.warn(u.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" check fail"),s(d.errorList.AUTH_FAIL),[2]):(a=e instanceof Array,[4,this.settingFetchHandler.fetchSetting(a?e:[e],t,this.token,this.userID)]);case 1:return c=o.sent(),r=c.data,c=c.polling_interval,this.checkFailCount=0,this.log.info(u.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" suc"),"number"==typeof c&&5<=c&&this.pollingInterval!==60*c&&(this.log.warn(u.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" polling interval change"),this.pollingInterval=60*c,this.uninit(),this.activePolling()),a?(i={},e.forEach((function(e){var t;0==(null==(t=r[e])?void 0:t.code)&&void 0!==(null==(t=r[e])?void 0:t.data)&&(i[e]={setting:null==(t=r[e])?void 0:t.data,versions:null==(e=r[e])?void 0:e.versions})})),0<Object.keys(i).length?n(i):s(d.errorList.MULTI_FILE_NOT_EXIST)):0===(null==(a=r[e])?void 0:a.code)&&null!=(c=r[e])&&c.data?n({setting:null==(c=r[e])?void 0:c.data,versions:null==(c=r[e])?void 0:c.versions}):s({code:null==(l=r[e])?void 0:l.code,msg:null==(l=r[e])?void 0:l.message}),[3,3];case 2:return l=o.sent(),this.log.error(u.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" fail "+JSON.stringify(l)),21002===(null==l?void 0:l.code)&&(this.checkFailCount+=1),2<=this.checkFailCount&&(this.checkFailed=!0),s(l),[3,3];case 3:return[2]}}))}))}))},p.prototype.handleFetchFiles=function(e,t){var r=this;Object.keys(e).forEach((function(n){var i=r.fileList.find((function(e){return e.fileName==n}));i?(i.fetchedTime=(new Date).getTime(),i.setting=e[n].setting,i.versions=e[n].versions,i.needPolling=t):r.fileList.find((function(e){return e.fileName===n}))||r.fileList.push({fileName:n,fetchedTime:(new Date).getTime(),needPolling:t,setting:e[n].setting,versions:e[n].versions}),i=r._getFileName(n),r.settingCacheHandler.storeSetting(i,e[n])}))},p.prototype._fetchSetting=function(e,t,r){var n=this;return new Promise((function(s,a){n.log.info(u.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call"),n._getCloudSetting(e,n.envVariable).then((function(i){t?(t.fetchedTime=(new Date).getTime(),t.setting=i.setting,t.versions=i.versions,t.needPolling=r):n.fileList.find((function(t){return t.fileName===e}))||n.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:r,setting:i.setting,versions:i.versions});var o=n._getFileName(e);n.settingCacheHandler.storeSetting(o,i),s(i),n.log.info(u.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call suc")})).catch((function(c){return i(n,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:t?t.fetchedTime=(new Date).getTime():this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:r,setting:{},versions:{}}),n=this._getFileName(e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.settingCacheHandler.getCacheSetting(n)];case 2:return n=i.sent(),s(n),[3,4];case 3:return i.sent(),a(c),[3,4];case 4:return this.log.info(u.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" setting not contain or fetch file fail"),[2]}}))}))}))}))},p.prototype.getPublicEnvVariable=function(){var e;0==this.options.env?(this.publicEnvVariable.userAgent=navigator.userAgent,this.publicEnvVariable.platform=navigator.platform,this.publicEnvVariable.browser=h.getBrowser(),this.publicEnvVariable.deviceid=h.generateUUID()):1==this.options.env&&(e=wx.getSystemInfoSync(),this.publicEnvVariable.brand=e.brand,this.publicEnvVariable.model=e.model,this.publicEnvVariable.system=e.system,this.publicEnvVariable.platform=e.platform,this.publicEnvVariable.wechatVersion=e.version,this.publicEnvVariable.wechatSDKVersion=e.SDKVersion,this.publicEnvVariable.deviceid=h.generateUUID(this.options.env))},p.prototype.pollingSetting=function(e){return i(this,void 0,void 0,(function(){var t,r,n,s,a=this;return o(this,(function(c){switch(c.label){case 0:return this.log.info(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" call "+e),t=[],this.fileList.forEach((function(e){e.fileName,e.needPolling&&t.push(e.fileName)})),r=e,this.checkFailed?(this.log.warn(u.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" has checked fail"),[3,7]):[3,1];case 1:if(!(0<t.length))return[3,6];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.settingFetchHandler.fetchSetting(t,this.envVariable,this.token,this.userID)];case 3:return s=c.sent(),n=s.data,s=s.polling_interval,this.log.info(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" fetch suc"),this.checkFailCount=0,"number"==typeof s&&5<=s&&this.pollingInterval!==60*s&&(this.log.warn(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" polling interval change"),this.pollingInterval=60*s,r=1e3*this.pollingInterval),this.fileList.forEach((function(e){return i(a,void 0,void 0,(function(){var t,r,i,s;return o(this,(function(o){switch(o.label){case 0:return e.fetchedTime=(new Date).getTime(),t=this._getFileName(e.fileName),n[e.fileName]&&0===n[e.fileName].code&&n[e.fileName].data?(r=JSON.stringify(n[e.fileName].data),i=JSON.stringify(e.setting),s={setting:n[e.fileName].data,versions:null==(s=n[e.fileName])?void 0:s.versions},i!==r&&(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" "+e.fileName+" setting changed"),e.setting=s.setting,e.versions=s.versions,this.options.pollingNotify(e.fileName,s)),[4,this.settingCacheHandler.getCacheSetting(t)]):[3,2];case 1:i=o.sent(),r=JSON.stringify(i),i=JSON.stringify(s),r!==i&&this.settingCacheHandler.storeSetting(t,s),o.label=2;case 2:return[2]}}))}))})),[3,5];case 4:return s=c.sent(),this.log.error(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" fetch fail "+JSON.stringify(s)),21002===(null==s?void 0:s.code)&&(this.checkFailCount+=1),2<=this.checkFailCount&&(this.checkFailed=!0),[3,5];case 5:return[3,7];case 6:this.log.info(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" polling no file"),c.label=7;case 7:return this.pollingTimer&&clearTimeout(this.pollingTimer),this.pollingTimer=setTimeout((function(){a.pollingSetting(r)}),r),[2]}}))}))},p.prototype._getFileName=function(e){return e},p.prototype.activePolling=function(){this.pollingTimer||this.pollingSetting(1e3*this.pollingInterval)},p.prototype.refreshAuthCheck=function(){this.checkFailCount=0,this.checkFailed=!1},t.ZegoSetting=r=p},function(e,t,r){"use strict";function n(){}Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLog=void 0,n.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},t.ZegoLog=n},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r=r||Promise)((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var c=[s,a];if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(a){c=[6,a],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},o=(Object.defineProperty(t,"__esModule",{value:!0}),t.SettingCacheHandler=void 0,r(0)),s=r(7);function a(e,t,r){void 0===r&&(r=0),this.storeName=e,this.log=t,this.store=s.createZegoStore(e,r)}a.prototype.getCacheSetting=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.log.info(o.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_GET_CACHE_SETTING+" call"),[4,this.store.getItem(e)];case 1:return[2,t.sent()||""]}}))}))},a.prototype.storeSetting=function(e,t){return n(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return this.log.info(o.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_STORE_SETTING+" call"),[4,this.store.setItem(e,t)];case 1:return r.sent(),[2]}}))}))},t.SettingCacheHandler=r=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoStore=t.ZegoWechatMiniStore=void 0;var n=r(8),i=r(9),o=(s.prototype.getItem=function(e){var t=this;return new Promise((function(r,n){try{r(wx.getStorageSync(t.keyPrefix+e))}catch(r){n(r)}}))},s.prototype.setItem=function(e,t){var r=this;return new Promise((function(n,i){try{wx.setStorageSync(r.keyPrefix+e,t),n()}catch(n){i(n)}}))},s.prototype.removeItem=function(e){var t=this;return new Promise((function(r,n){try{r(wx.removeStorageSync(t.keyPrefix+e))}catch(r){n(r)}}))},s.prototype.clear=function(){return new Promise((function(e,t){try{wx.clearStorageSync(),e()}catch(e){t(e)}}))},s.prototype.keys=function(){var e=this;return new Promise((function(t,r){try{var n=wx.getStorageInfoSync().keys,i=[];n.forEach((function(t){0==t.indexOf(e.keyPrefix)&&i.push(t.replace(e.keyPrefix,""))})),i.sort(),t(i)}catch(t){r(t)}}))},s);function s(e){this.storeName=e,this.keyPrefix=e+"/",this.storeName}t.ZegoWechatMiniStore=o,t.createZegoStore=function(e,t){return t===i.ZEGO_ENV.BROWSER?n.createInstance({name:e}):new o(e)}},function(e,t){e.exports=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SOCKET_DISCONNECT=t.ENUM_REMOTE_TYPE=t.ZEGO_BROWSER_TYPE=t.ZEGO_ENV=t.PROTO_VERSION=void 0,t.PROTO_VERSION="1.0.5",(n=t.ZEGO_ENV||(t.ZEGO_ENV={}))[n.BROWSER=0]="BROWSER",n[n.WEIXINMINI=1]="WEIXINMINI",(n=t.ZEGO_BROWSER_TYPE||(t.ZEGO_BROWSER_TYPE={}))[n.IE=0]="IE",n[n.FIREFOX=1]="FIREFOX",n[n.CHROME=2]="CHROME",n[n.SAFARI=3]="SAFARI",n[n.OPERA=4]="OPERA",n[n.WEIXIN=5]="WEIXIN",n[n.WEIXINMINI=6]="WEIXINMINI",n[n.UNKOWN=7]="UNKOWN",(n=t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={}))[n.DISABLE=0]="DISABLE",n[n.WEBSOCKET=1]="WEBSOCKET",n[n.HTTPS=2]="HTTPS",t.SOCKET_DISCONNECT=-1},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingFetchHandler=void 0;var i,o,s=r(0),a=r(1),c=r(11),u=r(2);function l(e,t){this.options=e,this.log=t,this.seq=0,this.userID=""}r=i={SERVICE_ClOUD_SETTING:10,10:"SERVICE_ClOUD_SETTING"},r=o={METHOD_UNSET:0,0:"METHOD_UNSET",METHOD_GET:1,1:"METHOD_GET",METHOD_POST:2,2:"METHOD_POST"},l.prototype.setOptions=function(e){this.options=e},l.prototype.setDataReport=function(e){this.reportFunc=e},l.prototype.setUserID=function(e){this.userID=e},l.prototype.fetchSetting=function(e,t,r,i){var o=this;return new Promise((function(a,l){var d,h={product:o.options.product,files:e,param:n(n({},t),{deviceid:void 0}),appid:o.options.appID,token:r,id_name:i,timestamp:(new Date).getTime(),biztype:0,deviceid:t.deviceid||u.generateUUID(o.options.env),compress:!1,mode:o.options.online?"online":"test"},p=o.seq++;o.reportFunc&&o.reportFunc(p,"request_start"),null!=(d=o.options)&&d.unify&&o.options.connection?o.sendCloudRequest(i,h,"/cloud-setting/get",(function(e){var t,r=e.code,n=(e.msg,e.data),i=e.polling_interval;e=e.reportData,o.log.info(s.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" unify "+r),n&&(t=[],Object.keys(n).forEach((function(e){t.push({name:e,error:n[e].code})}))),o.reportFunc&&o.reportFunc(p,"request_end",{code:r,reportData:e,params:h,files:t}),a({data:n,polling_interval:i})}),(function(e){var t=e.code,r=e.msg;e.data,e=e.reportData,o.log.warn(s.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" unify "+t),o.reportFunc&&o.reportFunc(p,"request_end",{code:t,params:h,reportData:e}),l({code:t,msg:r})})):c.fetch(o.options.urls,h,o.options.env||0).then((function(e){var t,r=e.code,n=(e.msg,e.data),i=e.polling_interval;e=e.reportData,o.log.info(s.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+r),n&&(t=[],Object.keys(n).forEach((function(e){t.push({name:e,error:n[e].code})}))),o.reportFunc&&o.reportFunc(p,"request_end",{code:r,reportData:e,params:h,files:t}),a({data:n,polling_interval:i})})).catch((function(e){var t=e.code,r=e.msg;e.data,e=e.reportData,o.log.warn(s.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+t),o.reportFunc&&o.reportFunc(p,"request_end",{code:t,params:h,reportData:e}),l({code:t,msg:r})}))}))},l.prototype.sendCloudRequest=function(e,t,r,s,c,u,l){var d,h=this,p=(void 0===u&&(u=3),void 0===l&&(l=[]),(new Date).getTime());null!=(d=this.options.connection)&&d.startHttpRequest({service:i.SERVICE_ClOUD_SETTING,body:t,ack:!1,idName:e,method_no:o.METHOD_POST,location:r},(function(i){var o,d,f,g,m;200===(null==i?void 0:i.status_code)?(o=(g=JSON.parse(i.body)).code,m=g.message,d=g.data,f=g.polling_interval,g=(new Date).getTime()-p,l.push({timestamp:p,url:r,error:o,duration:g}),0===o?s({code:o,msg:m,data:d,polling_interval:f,reportData:l}):c({code:o,msg:m,reportData:l})):(m=(new Date).getTime()-p,l.push({timestamp:p,url:r,error:null==i?void 0:i.status_code,duration:m}),0<u?(u--,h.sendCloudRequest(e,t,r,s,c,u,l)):c(n(n({},a.errorList.FILE_REQUEST_FAIL),{reportData:l})))}),(function(i){var o=(new Date).getTime()-p;l.push({timestamp:p,url:r,error:i.code,duration:o}),0<u?(u--,h.sendCloudRequest(e,t,r,s,c,u,l)):c(n(n({},a.errorList.FILE_REQUEST_FAIL),{reportData:l}))}),null,{timeout:4e3})},t.SettingFetchHandler=r=l},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=(Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=void 0,r(1));t.fetch=function e(t,r,o,s,a,c){return void 0===s&&(s=5),void 0===a&&(a=0),void 0===c&&(c=[]),new Promise((function(u,l){a=a||(new Date).getTime();var d,h,p,f=(new Date).getTime();0===o?(d=new XMLHttpRequest,h=t[(s+1)%2]||t[0],d.open("post",h),1==r.compress&&(d.responseType="arraybuffer"),d.ontimeout=function(){},d.onreadystatechange=function(){var p,g,m,_,v;4==d.readyState&&(200<=d.status&&d.status<300||304==d.status?(g=void 0,1!=r.compress&&(g=d.responseText),v=(new Date).getTime()-f,p=(m=JSON.parse(g)).code,_=m.message,g=m.data,m=m.polling_interval,c.push({timestamp:f,url:h,error:p,duration:v}),0===p?u({code:p,msg:_,data:g,polling_interval:m,reportData:c}):l({code:p,msg:_,reportData:c})):(_=(new Date).getTime()-f,c.push({timestamp:f,url:h,error:d.status,duration:_}),v=(new Date).getTime()-a,0<s&&v<8e3?e(t,r,o,--s,a,c).then((function(e){u(e)})).catch((function(e){l(e)})):l(n(n({},i.errorList.FILE_REQUEST_FAIL),{reportData:c}))))},d.timeout=8e3,d.send(JSON.stringify(r))):(p=t[(s+1)%2]||t[0],wx.request({url:p,data:r,method:"POST",success:function(d){var h=(_=d.data).code,g=_.message,m=_.data,_=_.polling_interval;void 0!==h?0===h?u({code:h,msg:g,data:m,polling_interval:_,reportData:c}):l({code:h,msg:g,reportData:c}):(g=(new Date).getTime()-f,c.push({timestamp:f,url:p,error:i.errorList.FILE_REQUEST_FAIL.code,msg:d.data,duration:g}),0<s?e(t,r,o,--s,a,c).then((function(e){u(e)})).catch((function(e){l(e)})):l(n(n({},i.errorList.FILE_REQUEST_FAIL),{reportData:c})))},fail:function(d){var h=(new Date).getTime()-f;c.push({timestamp:f,url:p,error:i.errorList.FILE_REQUEST_FAIL.code,msg:d.errMsg,duration:h}),0<s?e(t,r,o,--s,a,c).then((function(e){u(e)})).catch((function(e){l(e)})):l(n(n({},i.errorList.FILE_REQUEST_FAIL),{reportData:c}))}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INIT_CONFIG=void 0,t.INIT_CONFIG={env:0}}],n.c=s,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3))},function(e,t,r){function n(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return s[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var i,o,s,a;e.exports=(i=r(6),o=r(1),s=[function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.typeMap=t.BrokenType=t.ConnectedType=t.DisconnectedType=t.Method=t.ConnectionClosedAction=t.NetWorkState=t.externalErrorList=t.Stick=t.PcConnectState=t.ENUM_CONNECT_STATE=t.DestroyType=t.StreamType=t.ModeMap=t.Mode=t.ZegoconnRunEnv=t.BusinessService=t.AccessHub_Error_Code=t.AccessHubMessageType=t.ENUM_NETWORK_STATE=t.PROTO_VERSION=void 0,t.PROTO_VERSION="1.19.2",(i=t.ENUM_NETWORK_STATE||(t.ENUM_NETWORK_STATE={}))[i.offline=0]="offline",i[i.online=1]="online",(i=t.AccessHubMessageType||(t.AccessHubMessageType={}))[i.MSG_TYPE_STREAM_CLOSED=2]="MSG_TYPE_STREAM_CLOSED",i[i.MSG_TYPE_CLOSE_CONNECTION=3]="MSG_TYPE_CLOSE_CONNECTION",i[i.MSG_TYPE_HTTP_REQUEST=4]="MSG_TYPE_HTTP_REQUEST",i[i.MSG_TYPE_HTTP_RESPONSE=5]="MSG_TYPE_HTTP_RESPONSE",i[i.MSG_TYPE_HB_REQUEST=12]="MSG_TYPE_HB_REQUEST",i[i.MSG_TYPE_HB_RESPONSE=13]="MSG_TYPE_HB_RESPONSE",i[i.MSG_TYPE_GET_CONFIG_REQUEST=14]="MSG_TYPE_GET_CONFIG_REQUEST",i[i.MSG_TYPE_GET_CONFIG_RESPONSE=15]="MSG_TYPE_GET_CONFIG_RESPONSE",i[i.MSG_TYPE_HTTP_REQUEST_ACK=16]="MSG_TYPE_HTTP_REQUEST_ACK",i[i.MSG_TYPE_PC_UPWARD_MESSAGE=17]="MSG_TYPE_PC_UPWARD_MESSAGE",i[i.MSG_TYPE_PC_UPWARD_MESSAGE_ACK=18]="MSG_TYPE_PC_UPWARD_MESSAGE_ACK",i[i.MSG_TYPE_PC_ESTABLISHED=19]="MSG_TYPE_PC_ESTABLISHED",i[i.MSG_TYPE_PC_BROKEN=20]="MSG_TYPE_PC_BROKEN",i[i.MSG_TYPE_PC_DOWNWARD_MESSAGE=21]="MSG_TYPE_PC_DOWNWARD_MESSAGE",i[i.MSG_TYPE_REDIRECT=22]="MSG_TYPE_REDIRECT",i[i.MSG_TYPE_GET_APPCONFIG_REQUEST=23]="MSG_TYPE_GET_APPCONFIG_REQUEST",i[i.MSG_TYPE_GET_APPCONFIG_RESPONSE=24]="MSG_TYPE_GET_APPCONFIG_RESPONSE",i[i.MSG_TYPE_PUSH_APPCONFIG=25]="MSG_TYPE_PUSH_APPCONFIG",i[i.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST=26]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST",i[i.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE=27]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE",i[i.MSG_TYPE_PUSH_EXCEPTION=30]="MSG_TYPE_PUSH_EXCEPTION",(n=i=t.AccessHub_Error_Code||(t.AccessHub_Error_Code={}))[n.ACCESSHUB_INVALID_FRAME=2e4]="ACCESSHUB_INVALID_FRAME",n[n.ACCESSHUB_NEED_ENCRYPT=20001]="ACCESSHUB_NEED_ENCRYPT",n[n.ACCESSHUB_DECRYPT=20002]="ACCESSHUB_DECRYPT",n[n.ACCESSHUB_MSGTYPE=20003]="ACCESSHUB_MSGTYPE",n[n.ACCESSHUB_UNMARSHAL=20004]="ACCESSHUB_UNMARSHAL",n[n.ACCESSHUB_TIMEOUT=20005]="ACCESSHUB_TIMEOUT",n[n.ACCESSHUB_CONNECT=20006]="ACCESSHUB_CONNECT",n[n.ACCESSHUB_BROKEN=20007]="ACCESSHUB_BROKEN",n[n.ACCESSHUB_INTERNAL_ERROR=20008]="ACCESSHUB_INTERNAL_ERROR",n[n.ACCESSHUB_MARSHAL=20009]="ACCESSHUB_MARSHAL",n[n.ACCESSHUB_UNSUPPORTED_SERVICE=20010]="ACCESSHUB_UNSUPPORTED_SERVICE",n[n.ACCESSHUB_TOO_FREQUENTLY=20011]="ACCESSHUB_TOO_FREQUENTLY",n[n.ACCESSHUB_INVALID_APPID=20012]="ACCESSHUB_INVALID_APPID",n[n.ACCESSHUB_HB_TIMEOUT=20013]="ACCESSHUB_HB_TIMEOUT",n[n.ACCESSHUB_INVALID_SIGNATURE=20014]="ACCESSHUB_INVALID_SIGNATURE",(n=t.BusinessService||(t.BusinessService={}))[n.SERVICE_UNSET=0]="SERVICE_UNSET",n[n.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",n[n.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",n[n.SERVICE_MIX=3]="SERVICE_MIX",n[n.SERVICE_ZEUS=4]="SERVICE_ZEUS",n[n.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",n[n.SERVICE_L3=6]="SERVICE_L3",n[n.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",n[n.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",n[n.SERVICE_ZIM=9]="SERVICE_ZIM",n[n.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",n[n.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",n[n.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",n[n.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",n[n.SERVICE_QUALITY=14]="SERVICE_QUALITY",n[n.SERVICE_SECURITY=15]="SERVICE_SECURITY",n[n.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",n[n.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",n[n.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",n[n.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",n[n.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",n[n.SERVICE_CDN=21]="SERVICE_CDN",n[n.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",n[n.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",n[n.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",n[n.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",n[n.SERVICE_ECHO=26]="SERVICE_ECHO",n[n.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",n[n.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR",(n=t.ZegoconnRunEnv||(t.ZegoconnRunEnv={}))[n.ZEGOCONN_RUN_ENV_UNSET=0]="ZEGOCONN_RUN_ENV_UNSET",n[n.ZEGOCONN_RUN_ENV_BROWSER=1]="ZEGOCONN_RUN_ENV_BROWSER",n[n.ZEGOCONN_RUN_ENV_APPLET=2]="ZEGOCONN_RUN_ENV_APPLET",(n=t.Mode||(t.Mode={}))[n.Mode_UNSET=0]="Mode_UNSET",n[n.MODE_ONLINE=1]="MODE_ONLINE",n[n.MODE_TEST=2]="MODE_TEST",n[n.MODE_ALPHA=3]="MODE_ALPHA",t.ModeMap={1:"online",2:"test",3:"alpha"},(n=t.StreamType||(t.StreamType={}))[n.HTTP=0]="HTTP",n[n.PC=1]="PC",n[n.OTHER=2]="OTHER",(n=t.DestroyType||(t.DestroyType={}))[n.NONE=0]="NONE",n[n.BROKEN=1]="BROKEN",n[n.DISCONNECT=2]="DISCONNECT",t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},(n=t.PcConnectState||(t.PcConnectState={}))[n.CONNECTED=0]="CONNECTED",n[n.DISCONNECT=1]="DISCONNECT",n[n.BROKEN=2]="BROKEN",t.Stick={DISPATCH:"zego-action-dispatch",RETRY:"zego-action-retry",ABORT:"zego-action-abort",NEXT_GROUP:"zego-action-next-group",PUSH_APP_CONFIG:"push-app-config:"},t.externalErrorList=[i.ACCESSHUB_INVALID_APPID,i.ACCESSHUB_INVALID_SIGNATURE],(n=t.NetWorkState||(t.NetWorkState={}))[n.offline=0]="offline",n[n.online=1]="online",(i=t.ConnectionClosedAction||(t.ConnectionClosedAction={}))[i.ACTION_RESERVED=0]="ACTION_RESERVED",i[i.ACTION_DISPATCH=1]="ACTION_DISPATCH",i[i.ACTION_RETRY=2]="ACTION_RETRY",i[i.ACTION_NEXT_NODE=3]="ACTION_NEXT_NODE",i[i.ACTION_ABORT=4]="ACTION_ABORT",i[i.ACTION_NEXT_GROUP=5]="ACTION_NEXT_GROUP",(n=t.Method||(t.Method={}))[n.METHOD_UNSET=0]="METHOD_UNSET",n[n.METHOD_GET=1]="METHOD_GET",n[n.METHOD_POST=2]="METHOD_POST",(i=t.DisconnectedType||(t.DisconnectedType={}))[i.CLOSE=0]="CLOSE",i[i.TEMP=1]="TEMP",i[i.TIMEOUT=2]="TIMEOUT",(n=t.ConnectedType||(t.ConnectedType={}))[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL",(i=t.BrokenType||(t.BrokenType={}))[i.EMPTY=0]="EMPTY",i[i.CLOSE=1]="CLOSE",t.typeMap={2:"stream_closed",3:"close_connection",4:"http_request",5:"http_response",12:"hb_request",13:"hb_response",14:"get_config_request",15:"get_config_response",16:"http_request_ack",17:"pc_upward_message",18:"pc_upward_message_ack",19:"pc_established",20:"pc_broken",21:"pc_downward_message",22:"redirect",23:"get_appconfig_request",24:"get_appconfig_response",25:"push_appconfig",26:"accesshub_dispatch_request",27:"accesshub_dispatch_response",30:"push_exception"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APP_CONFIG_KEY=t.NET_ACCESS_SERVERS=t.NET_ACCESS_CONFIG=void 0,r=r(0),t.NET_ACCESS_CONFIG={domains:["accesshub-wss.zego.im"],mode:"online",modeNo:r.Mode.MODE_ONLINE,sdkType:3,connectVer:2,pcEstablishTimeout:15,scheme:"wss",location:"accesshub",wssMessageType:1},t.NET_ACCESS_SERVERS="z_net_access_servers",t.APP_CONFIG_KEY="z_appconfig"},function(e,t){e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},NET_SOCKET_TIMEOUT:{code:1100004,msg:"net agent timeout"},NET_HB_TIMEOUT:{code:1100005,msg:"net hb timeout"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidNum=t.decodeString=t.encodeString=void 0,t.encodeString=function(e){return Uint8Array.from(Array.from(unescape(encodeURIComponent(e))).map((function(e){return e.charCodeAt(0)})))},t.decodeString=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(String,Array.from(e))))},t.uuidNum=function(e,t){var r,n,i="0123456789".split(""),o=[];if(t=i.length,e)for(r=0;r<e;r++)o[r]=i[0|Math.random()*t];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",r=0;r<36;r++)o[r]||(n=0|16*Math.random(),o[r]=i[19==r?3&n|8:n]);return o.join("")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentPCRequest=void 0;var n=r(0),i=r(1),o=r(6),s=r(4),a=[n.BusinessService.SERVICE_WEBRTC_SIGNAL,n.BusinessService.SERVICE_L3_WEBRTC_SIGNAL];function c(e,t,r,i,s){this.logger=e,this.service=t,this.streamManager=r,this.pcEstablishTimeout=i,this.option=s,this.connectState=n.PcConnectState.DISCONNECT,this.lastConnectState=n.PcConnectState.DISCONNECT,this.brokenTimer=null,this.listenerList={connected:[],broken:[]},this.netPcStream=this.streamManager.createStream(n.StreamType.PC),this.eventManager=new o.EventManager,this.netPcStream.onPushEvent=this.onPushEvent.bind(this)}c.prototype.sendRequest=function(e,t,r){var o=this,c=e.payload,u=((a.includes(this.service)||null!=(u=this.option)&&u.encode)&&(c=(0,s.encodeString)(e.payload)),{service_no:this.service,ack:e.ack,payload:c,wss_message_type:i.NET_ACCESS_CONFIG.wssMessageType,wss_path:null==(u=this.option)?void 0:u.path,wss_raw_query:null==(c=this.option)?void 0:c.query,zegoconn_version:i.NET_ACCESS_CONFIG.connectVer});this.netPcStream.isConnect()||(this.logger.info("zn.napr.sr pc is not connect"),this.eventManager.emit("connectStart")),this.netPcStream.sendMessage(n.AccessHubMessageType.MSG_TYPE_PC_UPWARD_MESSAGE,u,(function(){o.logger.info("zn.napr.sr suc"),r&&r()}),(function(e){o.logger.error("zn.napr.sr fail"),t&&t(e)}),null,{isInSendMap:"boolean"==typeof e.isInSendMap&&e.isInSendMap}),this.netPcStream.isFirst=!1},c.prototype.onPushEvent=function(e,t){var r;switch(this.logger.info("zn.napr.ope"+" msgType: ".concat(e)),e){case n.AccessHubMessageType.MSG_TYPE_PC_ESTABLISHED:this.pcEstablished(t);break;case n.AccessHubMessageType.MSG_TYPE_PC_BROKEN:this.pcBroken();break;case n.AccessHubMessageType.MSG_TYPE_PC_DOWNWARD_MESSAGE:var i=t.payload;(a.includes(this.service)||null!=(r=this.option)&&r.encode)&&(i=(0,s.decodeString)(t.payload)),this.eventManager.emit("downLoadMessage",i)}},c.prototype.on=function(e,t){return this.eventManager.addEventHandler(e,t)},c.prototype.off=function(e,t){this.eventManager.removeEventHandler(e,t)},c.prototype.pcEstablished=function(e){this.logger.info("zn.napr.pe call "+JSON.stringify(e)),this.setConnectState(n.PcConnectState.CONNECTED);var t=n.ConnectedType.MANUAL;this.lastConnectState===n.PcConnectState.BROKEN&&this.connectState===n.PcConnectState.CONNECTED&&(t=n.ConnectedType.AUTO),this.eventManager.emit("connected",t),this.eventManager.emit("pcConnectedEvent",{proxy_link_sources:null==e?void 0:e.from}),this.brokenTimer&&clearTimeout(this.brokenTimer)},c.prototype.pcBroken=function(){var e=this;this.logger.info("zn.napr.pb call"),this.setConnectState(n.PcConnectState.BROKEN),this.eventManager.emit("broken"),this.brokenTimer=setTimeout((function(){e.eventManager.emit("disconnected",n.DisconnectedType.TEMP)}),1e3*this.pcEstablishTimeout)},c.prototype.resetBrokenTimer=function(){this.brokenTimer&&clearTimeout(this.brokenTimer)},c.prototype._close=function(e,t){var r;this.logger.info("zn.napr.cr call "+this.service+" "+this.connectState),this.connectState!==n.PcConnectState.DISCONNECT&&(this.netPcStream.closeStream(0,""),this.resetBrokenTimer(),r=this.streamManager.getStreamID(),this.netPcStream.refresh(r),this.eventManager.emit(e,t)),this.setConnectState(n.PcConnectState.DISCONNECT)},c.prototype.closePc=function(){this._close("broken")},c.prototype.closeRequest=function(){this._close("disconnected",n.DisconnectedType.CLOSE)},c.prototype.setConnectState=function(e){this.connectState!==e&&(this.lastConnectState=this.connectState,this.connectState=e)},t.NetAgentPCRequest=c},function(e,t,r){"use strict";function n(){this.handlerListMap={}}Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0,n.prototype.addEventHandler=function(e,t){if(this.handlerListMap[e]||(this.handlerListMap[e]=[]),"function"!=typeof t)throw new Error("Params callBack is not a Function");return this.handlerListMap[e]&&-1==this.handlerListMap[e].indexOf(t)&&this.handlerListMap[e].push(t),!0},n.prototype.removeEventHandler=function(e,t){return!!this.handlerListMap[e]&&(this.handlerListMap[e]=t?this.handlerListMap[e].filter((function(e){return e!==t})):[],!0)},n.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.handlerListMap[e]&&this.handlerListMap[e].forEach((function(r){try{setTimeout((function(){r.apply(void 0,t)}),0)}catch(r){console.error("dispatch "+e+" "+r)}}))},t.EventManager=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentHttpRequest=void 0;var n=r(0),i=r(4),o=r(1);function s(e,t,r){this.logger=e,this.service=t,this.streamManager=r,this.netHttpStream=this.streamManager.createStream(n.StreamType.HTTP)}s.prototype.sendRequest=function(e,t,r,s,a){var c=this;e={service_no:this.service,ack:e.ack,headers:e.headers,body:(0,i.encodeString)(JSON.stringify(e.body)),id_name:e.idName,method_no:e.method_no,stick:e.stick,location:e.location,zegoconn_version:o.NET_ACCESS_CONFIG.connectVer},this.netHttpStream.sendMessage(n.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST,e,(function(e){var r=(null==e?void 0:e.headers).find((function(e){return"Content-Encoding"===(null==e?void 0:e.name)}));"gzip"===(null==r?void 0:r.val)?c.logger.info("zn.nahr.sr gzip"):e.body&&(r=(0,i.decodeString)(e.body),e.body=r),c.logger.info("zn.nahr.sr suc "+JSON.stringify(e)),t&&t(e)}),(function(e,t,n){c.logger.error("zn.nahr.sr fail"),r&&r(n||e)}),(function(e){c.logger.error("zn.nahr.sr ack"),s&&s(e)}),a),this.netHttpStream.isFirst=!1},t.NetAgentHttpRequest=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Method=t.Mode=t.DisconnectedType=t.ConnectedType=t.NET_ACCESS_CONFIG=t.BrokenType=t.BusinessService=t.NetAgentHttpRequest=t.NetAgentPCRequest=t.ZegoConnectionAgent=void 0;var n=r(0),i=(Object.defineProperty(t,"BrokenType",{enumerable:!0,get:function(){return n.BrokenType}}),Object.defineProperty(t,"BusinessService",{enumerable:!0,get:function(){return n.BusinessService}}),Object.defineProperty(t,"ConnectedType",{enumerable:!0,get:function(){return n.ConnectedType}}),Object.defineProperty(t,"DisconnectedType",{enumerable:!0,get:function(){return n.DisconnectedType}}),Object.defineProperty(t,"Mode",{enumerable:!0,get:function(){return n.Mode}}),Object.defineProperty(t,"Method",{enumerable:!0,get:function(){return n.Method}}),r(9)),o=(Object.defineProperty(t,"ZegoConnectionAgent",{enumerable:!0,get:function(){return i.ZegoConnectionAgent}}),r(7)),s=(Object.defineProperty(t,"NetAgentHttpRequest",{enumerable:!0,get:function(){return o.NetAgentHttpRequest}}),r(1)),a=(Object.defineProperty(t,"NET_ACCESS_CONFIG",{enumerable:!0,get:function(){return s.NET_ACCESS_CONFIG}}),r(5));Object.defineProperty(t,"NetAgentPCRequest",{enumerable:!0,get:function(){return a.NetAgentPCRequest}})},function(e,t,r){"use strict";var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},i=(Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoConnectionAgent=void 0,r(0)),o=r(10),s=r(13),a=r(18),c=r(19),u=r(20),l=r(1),d=r(6),h=r(21),p=r(3),f=r(22),g=r(4),m=r(23),_=r(7),v=r(24);function y(){var e=this;this.linkCheckTimer=null,this.connectServers=[],this.specifiedServers=[],this.getAppConfigFailCount=0,this.getAppConfigTime=0,this.inited=!1,this.linkMsgMaxInterval=90,this.linkMsgCheckInterval=5,this.connectedTime=0,this.connectid="",this.reportSeq=0,this.connectSeq=0,this.primaryDomains=[],this.onConnectedEvent=function(t){var r;e.getConfig(),e.stateCenter.specified||(r=e.reportSeq++,e.eventManager.emit("dispatchEvent",r,"start"),e.dispatch().then((function(t){var n=t.servers;t=t.domains,e.eventManager.emit("dispatchEvent",r,"end",{domains:t}),0<n.length&&e.eventManager.emit("dispatchResultUpdate",{servers:n})})).catch((function(e){}))),e.eventManager.emit("connected"),e.connectedTime=(new Date).getTime(),e.connectid=(0,g.uuidNum)(16),e.eventManager.emit("connectedEvent",e.connectSeq,"end",{servers:t,count:t.length,connectid:e.connectid})},this.onConnectingEvent=function(){e.logger.info("zn.zca.oce call")},this.onDisConnectedEvent=function(t){e.logger.info("zn.zca.ode"+" ".concat(t)),t?(e.disConnect(),e.netAgentPCRequestMgr.updateConnectState(i.PcConnectState.BROKEN)):(e.eventManager.emit("disconnected"),e.netAgentPCRequestMgr.updateConnectState(i.PcConnectState.DISCONNECT))},this.onPushEvent=function(t,r,n){switch(r){case i.AccessHubMessageType.MSG_TYPE_REDIRECT:e.redirect(n);break;case i.AccessHubMessageType.MSG_TYPE_CLOSE_CONNECTION:e.connectClosed(n);break;case i.AccessHubMessageType.MSG_TYPE_PC_BROKEN:case i.AccessHubMessageType.MSG_TYPE_PC_ESTABLISHED:case i.AccessHubMessageType.MSG_TYPE_PC_DOWNWARD_MESSAGE:e.streamManager.onPushEvent(t,r,n);break;case i.AccessHubMessageType.MSG_TYPE_PUSH_APPCONFIG:e.businessRequestMgr.decodeConfigMessage(n.data)}}}Object.defineProperty(y.prototype,"clientIP",{get:function(){return this.stateCenter.clientIP},enumerable:!1,configurable:!0}),y.prototype.init=function(){this.logger=new m.ZegoLogger,this.protobuf=new o.AccessHubProtoBuf,this.stateCenter=new f.StateCenter,this.eventManager=new d.EventManager,this.checkLinkMsg(),this.inited=!0},y.prototype.unInit=function(){this.inited=!1},y.prototype.setAppInfo=function(e){this.stateCenter.appInfo=e,this.stateCenter.networkState=!navigator||navigator.onLine?i.ENUM_NETWORK_STATE.online:i.ENUM_NETWORK_STATE.offline,0===e.env?this.bindWindowListener():1===e.env&&this.bindWxListener(),this.zegoLink=new s.ZegoWssLink(e.appID,e.env,this.protobuf,this.logger,this.stateCenter),this.zegoLink.initEvent(this.onConnectedEvent,this.onDisConnectedEvent,this.onConnectingEvent,this.onPushEvent),this.streamManager=new v.StreamManager(this.zegoLink),this.businessRequestMgr=new a.NetAgentBusinessRequestMgr(this.streamManager,this.protobuf,this.logger,this.stateCenter),this.netHeartBeatHandler=new c.NetHeartBeatHandler(this.streamManager,this.logger),this.netAgentPCRequestMgr=new u.NetAgentPCRequestMgr(this.streamManager,this.logger),this.heartBeatHandler()},y.prototype.setUserInfo=function(e){this.stateCenter.userId=e},y.prototype.setNetAgentDefaultServers=function(e){this.connectServers=n([],e,!0)},y.prototype.setNetAgentSpecifiedServers=function(e){this.logger.info("zn.sss.0 "+JSON.stringify(e)),this.stateCenter.specified=!0,this.specifiedServers=n([],e,!0)},y.prototype.setBackupDomains=function(e){this.primaryDomains=e},y.prototype.setDispatchConnectServers=function(e){this.connect(e)},y.prototype.startHttpRequest=function(e,t,r,n,i){var o=this,s=this.reportSeq++;this.eventManager.emit("requestEvent",s,"start"),this.isConnect()||(this.logger.info("zn.shq.0 link is not connect"),this.connectUa()),new _.NetAgentHttpRequest(this.logger,e.service,this.streamManager).sendRequest(e,(function(r){o.eventManager.emit("requestEvent",s,"end",{na_req_location:e.location,status_code:r.status_code,err_code:0}),t&&t(r)}),(function(t){o.eventManager.emit("requestEvent",s,"end",{na_req_location:e.location,err_code:t.code||0}),r&&r(t)}),n,i)},y.prototype.getAppConfigByAgent=function(e,t,r){return this.isConnect()||(this.logger.info("zn.gab.0 link is not connect"),this.connectUa()),this.getAppConfig(e,this.stateCenter.userId,t,r)},y.prototype.getPCRequest=function(e,t){var r=this;return(t=this.netAgentPCRequestMgr.getRequest(e,t)).on("disconnected",(function(t){r.logger.warn("zn.zca.gpr "+e+" disconnect "+t),t===i.DisconnectedType.TEMP&&(r.disConnect(),r.connectStart())})),t.on("connectStart",(function(){r.connectUa()})),t},y.prototype.connectUa=function(){this.logger.info("zn.zca.cua call"),this.retryLinkHandler&&(this.retryLinkHandler.init(),this.connectStart(!1,!0))},y.prototype.destroyConnect=function(){this.logger.info("zn.zca.dc.0 call"),this.resetNetAgent()},y.prototype.isConnect=function(){return this.zegoLink&&this.zegoLink.isConnect()},y.prototype.on=function(e,t){return this.logger.info("zn.zca.o.0 "+e),this.eventManager.addEventHandler(e,t)},y.prototype.off=function(e,t){this.logger.info("zn.zca.o.1 "+e),this.eventManager.removeEventHandler(e,t)},y.prototype.setLogger=function(e){this.logger=e},y.prototype.setAccess=function(e){this.stateCenter.useNetAgent=e},y.prototype.getVersion=function(){return i.PROTO_VERSION},y.prototype.heartBeatHandler=function(){var e=this;this.netHeartBeatHandler.netHbLogout=function(t){e.retryLinkHandler&&([p.errorCodeList.NET_HB_TIMEOUT.code].includes(t.code)?(e.retryLinkHandler.startMaxTime(),e.disConnect(),e.connectStart()):(e.retryLinkHandler.stopMaxTime(),e.retryLinkHandler.invalid(),e.eventManager.emit("disconnected")))}},y.prototype.bindWindowListener=function(){var e=this;window.addEventListener("offline",(function(){e.netOffLineHandle()})),window.addEventListener("online",(function(){e.netOnLineHandle()}))},y.prototype.bindWxListener=function(){var e=this;wx.onNetworkStatusChange((function(t){t.isConnected?e.netOnLineHandle():e.netOffLineHandle()}))},y.prototype.netOnLineHandle=function(){this.logger.info("zn.zca.noh.0 network is online"),this.stateCenter.networkState=i.ENUM_NETWORK_STATE.online,this.stateCenter.useNetAgent&&this.netOnLineHandler()},y.prototype.netOffLineHandle=function(){this.logger.info("zn.zca.noh.1 network is broken"),this.stateCenter.networkState=i.ENUM_NETWORK_STATE.offline,this.stateCenter.useNetAgent&&this.netOffLineHandler()},y.prototype.checkLinkMsg=function(){var e=this;if(this.stateCenter.useNetAgent){if(this.isConnect()){var t=Date.now()-this.zegoLink.updatedMsgTime;if(t>1e3*this.linkMsgMaxInterval)return this.logger.info("zn.zca.clm interval: "+t),void this.resetNetAgent()}this.linkCheckTimer&&clearTimeout(this.linkCheckTimer),this.linkCheckTimer=setTimeout((function(){e.checkLinkMsg()}),1e3*this.linkMsgCheckInterval)}},y.prototype.connect=function(e){var t=this;0<e.length&&(this.connectServers=n([],e,!0)),this.stateCenter.specified&&0<this.specifiedServers.length&&(this.connectServers=this.specifiedServers),this.zegoLink.createSocket(this.connectServers),this.retryLinkHandler||(this.retryLinkHandler=new h.NetRetryLinkHandler(this.logger,this.stateCenter)),this.retryLinkHandler.init(),this.retryLinkHandler.initLink(this.zegoLink),this.retryLinkHandler.onactive=function(e,r){r===p.errorCodeList.NET_SOCKET_TIMEOUT&&(t.eventManager.emit("disconnected",r),t.netAgentPCRequestMgr.updateConnectState(i.PcConnectState.DISCONNECT,i.DisconnectedType.TIMEOUT,r))},this.connectStart(!1,!0)},y.prototype.resetNetAgent=function(){this.netHeartBeatHandler.reset(),this.zegoLink.destroySocket(i.DestroyType.DISCONNECT)},y.prototype.getConfig=function(){function e(e,r,n){n?t.logger.info("zn.zca.gc fail "+JSON.stringify(n)):0===e.code?(t.logger.info("zn.zca.gc suc "+JSON.stringify(e)),t.getConfigSuccess(e)):t.logger.info("zn.zca.gc fail")}var t=this;this.businessRequestMgr.getConfig(e,e)},y.prototype.getConfigSuccess=function(e){var t;this.netHeartBeatHandler.init(e),this.netAgentPCRequestMgr.setEstablishTimeout(e.data.pc_establish_timeout),null!=(t=null==e?void 0:e.data)&&t.client_outer_ip&&(this.stateCenter.clientIP=e.data.client_outer_ip),this.eventManager.emit("clientInfo",{clientIP:this.clientIP})},y.prototype.dispatch=function(){var e=this;return new Promise((function(t,r){e.businessRequestMgr.dispatchURL((function(r){r=r.data.wss_groups;var n=(e.logger.info("zn.nab.du wss_groups: "+JSON.stringify(r)),e.getConnectionDomains(r,e.primaryDomains));n=e.handleWssGroups(n),t({servers:n,domains:r})}),(function(e){r(e)}))}))},y.prototype.handleWssGroups=function(e){return Array.isArray(e)&&0<e.length?e.map((function(e){return l.NET_ACCESS_CONFIG.scheme+"://"+e.host+"/"+l.NET_ACCESS_CONFIG.location})):[]},y.prototype.getConnectionDomains=function(e,t){var r=n([],e,!0);return t.forEach((function(t){e.forEach((function(e){var n;(n=e.main_domain||(n=e.host.split("."))[n.length-2]+"."+n[n.length-1])!==t&&(n=e.host.replace(n,t),r.push({group:e.group,host:n}))}))})),r},y.prototype.getAppConfig=function(e,t,r,n){var o=this;return new Promise((function(s,a){"string"==typeof t&&"string"==typeof r?o.businessRequestMgr.getAppConfig(e,t,r,n).then((function(e){s(e)})).catch((function(n){o.logger.error("zn.zca.gac "+JSON.stringify(n)),-1<i.externalErrorList.indexOf(n.code)?(o.getAppConfigFailCount=0,a(n)):(o.getAppConfigFailCount++,20008===n.code&&o.getAppConfigFailCount<3?o.getAppConfig(e,t,r).then((function(e){return s(e)})).catch((function(e){return a(e)})):(o.getAppConfigFailCount=0,a(n)))})):o.logger.error("zn.zca.gac userID or token must be string")}))},y.prototype.reportDisConnectEvent=function(){var e=(new Date).getTime()-this.connectedTime;this.eventManager.emit("disConnectedEvent",{duration:e,server:this.zegoLink.connectServer})},y.prototype.redirect=function(e){this.logger.info("zn.zca.rd"+" ".concat(JSON.stringify(e.wss_groups))),(e=this.handleWssGroups(e.wss_groups))&&Array.isArray(e)&&0<e.length?(this.disConnect(),this.stateCenter.specified&&(this.logger.info("zn.zca.rd specified"),e=this.specifiedServers),this.zegoLink.createSocket(e),this.connectStart(!1,!0)):this.logger.warn("zn.zca.rd wss_groups null")},y.prototype.connectClosed=function(e){var t=this;switch(this.logger.info("zn.zca.cc"+" ".concat(e.reason," ").concat(e.msg," ").concat(e.action)),e.action){case i.ConnectionClosedAction.ACTION_DISPATCH:var r=this.reportSeq++;this.eventManager.emit("dispatchEvent",r,"start"),this.dispatch().then((function(e){var n=e.servers;e=e.domains,t.eventManager.emit("dispatchEvent",r,"end",{domains:e,reason:"ConnectClosed"}),Array.isArray(n)&&0<n.length&&(t.eventManager.emit("dispatchResultUpdate",{servers:n}),e=t.stateCenter.specified?t.specifiedServers:n,t.disConnect(),t.zegoLink.createSocket(e),t.connectStart(!1,!0))})).catch((function(e){t.logger.info("zn.zca.cc dispatch fail")}));break;case i.ConnectionClosedAction.ACTION_RETRY:this.disConnect(),this.connectStart(!1);break;case i.ConnectionClosedAction.ACTION_NEXT_GROUP:this.netAgentPCRequestMgr.closePCs(),this.eventManager.emit("broken",i.BrokenType.CLOSE),this.connectStart();case i.ConnectionClosedAction.ACTION_ABORT:case i.ConnectionClosedAction.ACTION_RESERVED:}},y.prototype.netOnLineHandler=function(){this.retryLinkHandler&&(this.zegoLink.isConnect()?this.retryLinkHandler.stopMaxTime():this.connectStart())},y.prototype.netOffLineHandler=function(){this.disConnect(),this.retryLinkHandler&&(this.retryLinkHandler.invalid(),this.retryLinkHandler.startMaxTime(),this.zegoLink.setState(i.ENUM_CONNECT_STATE.disconnect))},y.prototype.connectStart=function(e,t){this.retryLinkHandler.active(e,t)&&this.reportConnectEvent()},y.prototype.reportConnectEvent=function(){var e=this.reportSeq++;this.connectSeq=e,this.eventManager.emit("connectedEvent",e,"start")},y.prototype.disConnect=function(){this.netAgentPCRequestMgr.closePCs(),this.eventManager.emit("broken"),this.reportDisConnectEvent()},y.prototype.testConnect=function(){this.startHttpRequest({service:i.BusinessService.SERVICE_ClOUD_SETTING,headers:[],body:{appid:3349318446,biztype:0,deviceid:"27a315ae-ff78-4ded-8581-8b7b7afe6f2e",files:["init","room"],id_name:"sample1647345322471",mode:"online",param:{},product:"Web_SDK",timestamp:1647345362932,token:"eyJ2ZXIiOjEsImhhc2giOiIwOGQxMDYzMzQ0M2EzNjk1ZmE4YTg2ZDNmZGRlNGNiNyIsIm5vbmNlIjoiYWEyZDFmMDJmOGRiYjBlM2Q1YjY5NzA3NzMzOGYyODIiLCJleHBpcmVkIjoxNjQ5OTM3MzI2fQ=="},idName:"sample1647345322471",ack:!0,stick:"zego-action-dispatch",method_no:i.Method.METHOD_POST,location:"/cloud-setting/get"},(function(e){console.warn("suc",e)}),(function(e){console.warn("err",e)}),(function(e){console.warn("suc",e)}))},t.ZegoConnectionAgent=y},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},c=(Object.defineProperty(t,"__esModule",{value:!0}),t.AccessHubProtoBuf=void 0,a(r(11))),u=(s=s(r(2)),r(0)),l=a(r(12));function d(){var e;this.protoInstance=l.default,this.protoMap=((e={})[u.AccessHubMessageType.MSG_TYPE_STREAM_CLOSED]=["proto_accesshub","ConnectionClosed"],e[u.AccessHubMessageType.MSG_TYPE_CLOSE_CONNECTION]=["proto_accesshub","CloseConnection"],e[u.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST]=["proto_accesshub","HTTPRequest"],e[u.AccessHubMessageType.MSG_TYPE_HTTP_RESPONSE]=["proto_accesshub","HTTPResponse"],e[u.AccessHubMessageType.MSG_TYPE_HB_REQUEST]=["proto_accesshub","HBRequest"],e[u.AccessHubMessageType.MSG_TYPE_HB_RESPONSE]=["proto_accesshub","HBResponse"],e[u.AccessHubMessageType.MSG_TYPE_GET_CONFIG_REQUEST]=["proto_accesshub","GetConfigRequest"],e[u.AccessHubMessageType.MSG_TYPE_GET_CONFIG_RESPONSE]=["proto_accesshub","GetConfigResponse"],e[u.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST_ACK]=["proto_accesshub","HBResponse"],e[u.AccessHubMessageType.MSG_TYPE_PC_UPWARD_MESSAGE]=["proto_accesshub","PCUpwardMessage"],e[u.AccessHubMessageType.MSG_TYPE_PC_UPWARD_MESSAGE_ACK]=["proto_accesshub","PCUpwardMessageAck"],e[u.AccessHubMessageType.MSG_TYPE_PC_ESTABLISHED]=["proto_accesshub","PCEstablished"],e[u.AccessHubMessageType.MSG_TYPE_PC_BROKEN]=["proto_accesshub","PCBroken"],e[u.AccessHubMessageType.MSG_TYPE_PC_DOWNWARD_MESSAGE]=["proto_accesshub","PCDownwardMessage"],e[u.AccessHubMessageType.MSG_TYPE_REDIRECT]=["proto_accesshub","Redirect"],e[u.AccessHubMessageType.MSG_TYPE_GET_APPCONFIG_REQUEST]=["proto_accesshub","GetAppConfigRequest"],e[u.AccessHubMessageType.MSG_TYPE_GET_APPCONFIG_RESPONSE]=["proto_accesshub","GetAppConfigResponse"],e[u.AccessHubMessageType.MSG_TYPE_PUSH_APPCONFIG]=["proto_accesshub","PushAppConfig"],e[u.AccessHubMessageType.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST]=["proto_accesshub","AccesshubDispatchRequest"],e[u.AccessHubMessageType.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE]=["proto_accesshub","AccesshubDispatchResponse"],e[u.AccessHubMessageType.MSG_TYPE_PUSH_EXCEPTION]=["proto_accesshub","PushException"],e)}s.util.Long=c.default,s.configure(),d.prototype.encodeRequest=function(e,t,r){var n=(i=this.protoMap[e])[0],i=i[1];return i=(n=this.encode(this.protoInstance[n][i],t)).length,(t=new Uint8Array(13+i))[0]=175,t[1]=0,t[2]=e>>8,t[3]=e-(t[2]<<8),t.set(new Uint8Array(Int32Array.from([i]).buffer).reverse(),4),t.set(new Uint8Array(Int32Array.from([r]).buffer).reverse(),8),t[12]=0,t.set(n,13),t},d.prototype.decodeResponse=function(e){var t=(e[2]<<8)+e[3],r=new DataView(e.buffer).getUint32(8),n=e.slice(13);try{var i=this.protoMap[t],o=i[0],s=i[1];return[r,t,this.decode(this.protoInstance[o][s],n)]}catch(e){return[r,t,{code:1}]}},d.prototype.decodeConfigMessage=function(e){return this.decode(this.protoInstance.proto_initconfig.InitConfig,e)},d.prototype.encode=function(e,t){return e.encode(new e(t)).finish()},d.prototype.decode=function(e,t){return n({},e.decode(t))},t.AccessHubProtoBuf=d},function(e,t){e.exports=o},function(e,t,r){"use strict";r.r(t),r.d(t,"proto_accesshub",(function(){return a})),r.d(t,"proto_initconfig",(function(){return c})),r.d(t,"default",(function(){return s}));var n=(t=r(2)).Reader,i=t.Writer,o=t.util,s=t.roots.default||(t.roots.default={}),a=s.proto_accesshub=function(){var e={};return e.MessageType=function(){var e={},t=Object.create(e);return t[e[0]="MSG_TYPE_EMPTY"]=0,t[e[1]="MSG_TYPE_CONNECTION_CLOSED"]=1,t[e[2]="MSG_TYPE_STREAM_CLOSED"]=2,t[e[3]="MSG_TYPE_CLOSE_CONNECTION"]=3,t[e[4]="MSG_TYPE_HTTP_REQUEST"]=4,t[e[5]="MSG_TYPE_HTTP_RESPONSE"]=5,t[e[6]="MSG_TYPE_HTTP_REQUEST_DROPED"]=6,t[e[7]="MSG_TYPE_PROXY_CONNECT"]=7,t[e[8]="MSG_TYPE_PROXY_CONNECTED"]=8,t[e[9]="MSG_TYPE_PROXY_CONNECTION_CLOSED"]=9,t[e[10]="MSG_TYPE_PROXY_SEND_DATA"]=10,t[e[11]="MSG_TYPE_PROXY_RECV_DATA"]=11,t[e[12]="MSG_TYPE_HB_REQUEST"]=12,t[e[13]="MSG_TYPE_HB_RESPONSE"]=13,t[e[14]="MSG_TYPE_GET_CONFIG_REQUEST"]=14,t[e[15]="MSG_TYPE_GET_CONFIG_RESPONSE"]=15,t[e[16]="MSG_TYPE_HTTP_REQUEST_ACK"]=16,t[e[17]="MSG_TYPE_PC_UPWARD_MESSAGE"]=17,t[e[18]="MSG_TYPE_PC_UPWARD_MESSAGE_ACK"]=18,t[e[19]="MSG_TYPE_PC_ESTABLISHED"]=19,t[e[20]="MSG_TYPE_PC_BROKEN"]=20,t[e[21]="MSG_TYPE_PC_DOWNWARD_MESSAGE"]=21,t[e[22]="MSG_TYPE_REDIRECT"]=22,t[e[23]="MSG_TYPE_GET_APPCONFIG_REQUEST"]=23,t[e[24]="MSG_TYPE_GET_APPCONFIG_RESPONSE"]=24,t[e[25]="MSG_TYPE_PUSH_APPCONFIG"]=25,t[e[26]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST"]=26,t[e[27]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE"]=27,t[e[28]="MSG_TYPE_GET_IM_CONFIG_REQUEST"]=28,t[e[29]="MSG_TYPE_GET_IM_CONFIG_RESPONSE"]=29,t[e[30]="MSG_TYPE_PUSH_EXCEPTION"]=30,t[e[50]="MSG_TYPE_UA_DISPATCH_REQUEST"]=50,t[e[51]="MSG_TYPE_UA_DISPATCH_RESPONSE"]=51,t[e[52]="MSG_TYPE_UA_ECHO_REQUEST"]=52,t[e[53]="MSG_TYPE_UA_ECHO_RESPONSE"]=53,t[e[100]="MSG_TYPE_NODE_REGISTER_REQUEST"]=100,t[e[101]="MSG_TYPE_NODE_REGISTER_RESPONSE"]=101,t[e[102]="MSG_TYPE_NODE_HB_REQUEST"]=102,t[e[103]="MSG_TYPE_NODE_HB_RESPONSE"]=103,t}(),e.ErrorCode=function(){var e={},t=Object.create(e);return t[e[0]="OK"]=0,t[e[1e4]="DISPATCH_NO_AVAILABLE_NODE"]=1e4,t[e[10001]="DISPATCH_INTERNAL_ERROR"]=10001,t[e[10002]="DISPATCH_INVALID_FRAME"]=10002,t[e[10003]="DISPATCH_UNMARSHAL"]=10003,t[e[10004]="DISPATCH_MSGTYPE"]=10004,t[e[10005]="DISPATCH_MARSHAL"]=10005,t[e[10006]="DISPATCH_TOO_FREQUENTLY"]=10006,t[e[2e4]="ACCESSHUB_INVALID_FRAME"]=2e4,t[e[20001]="ACCESSHUB_NEED_ENCRYPT"]=20001,t[e[20002]="ACCESSHUB_DECRYPT"]=20002,t[e[20003]="ACCESSHUB_MSGTYPE"]=20003,t[e[20004]="ACCESSHUB_UNMARSHAL"]=20004,t[e[20005]="ACCESSHUB_TIMEOUT"]=20005,t[e[20006]="ACCESSHUB_CONNECT"]=20006,t[e[20007]="ACCESSHUB_BROKEN"]=20007,t[e[20008]="ACCESSHUB_INTERNAL_ERROR"]=20008,t[e[20009]="ACCESSHUB_MARSHAL"]=20009,t[e[20010]="ACCESSHUB_UNSUPPORTED_SERVICE"]=20010,t[e[20011]="ACCESSHUB_TOO_FREQUENTLY"]=20011,t[e[20012]="ACCESSHUB_INVALID_APPID"]=20012,t[e[20013]="ACCESSHUB_HB_TIMEOUT"]=20013,t[e[20014]="ACCESSHUB_INVALID_SIGNATURE"]=20014,t[e[20015]="ACCESSHUB_AUTH_FAILED"]=20015,t[e[3e4]="ACCESSHUB_GET_STREAM_FAILED"]=3e4,t[e[30001]="ACCESSHUB_GET_CONN_FAILED"]=30001,t[e[30002]="ACCESSHUB_DO_HTTP_REQUEST_FAILED"]=30002,t[e[30003]="ACCESSHUB_UNMARSHAL_HB_FAILED"]=30003,t[e[30004]="ACCESSHUB_DO_BACKEND_DISPATCH_FAILED"]=30004,t}(),e.Mode=function(){var e={},t=Object.create(e);return t[e[0]="Mode_UNSET"]=0,t[e[1]="MODE_ONLINE"]=1,t[e[2]="MODE_TEST"]=2,t[e[3]="MODE_ALPHA"]=3,t}(),e.Service=function(){var e={},t=Object.create(e);return t[e[0]="SERVICE_UNSET"]=0,t[e[1]="SERVICE_MEDIAGW"]=1,t[e[2]="SERVICE_LIVEROOM"]=2,t[e[3]="SERVICE_MIX"]=3,t[e[4]="SERVICE_ZEUS"]=4,t[e[5]="SERVICE_ZPUSH"]=5,t[e[6]="SERVICE_L3"]=6,t[e[7]="SERVICE_TALKLINE"]=7,t[e[8]="SERVICE_EDUSUITE"]=8,t[e[9]="SERVICE_ZIM"]=9,t[e[10]="SERVICE_ClOUD_SETTING"]=10,t[e[11]="SERVICE_ZEUSHB"]=11,t[e[12]="SERVICE_USER_LOGIC"]=12,t[e[13]="SERVICE_UNIFYDISPATCH"]=13,t[e[14]="SERVICE_QUALITY"]=14,t[e[15]="SERVICE_SECURITY"]=15,t[e[16]="SERVICE_KTVCPR"]=16,t[e[17]="SERVICE_SWITCH4LIVEROOM"]=17,t[e[18]="SERVICE_WEBRTC_SIGNAL"]=18,t[e[19]="SERVICE_L3_WEBRTC_SIGNAL"]=19,t[e[20]="SERVICE_VIDEOCPR"]=20,t[e[21]="SERVICE_CDN"]=21,t[e[22]="SERVICE_CLOUDRECORD"]=22,t[e[23]="SERVICE_INNER_ECHO"]=23,t[e[24]="SERVICE_OUTER_ECHO"]=24,t[e[25]="SERVICE_LOCALHOST_ECHO"]=25,t[e[26]="SERVICE_ECHO"]=26,t[e[27]="SERVICE_DOCSERVICE"]=27,t[e[28]="SERVICE_AUTHSVR"]=28,t[e[29]="SERVICE_WEBLIVEROOM"]=29,t[e[30]="SERVICE_WHITEBOARD"]=30,t[e[31]="SERVICE_METAWORLD"]=31,t}(),e.Method=function(){var e={},t=Object.create(e);return t[e[0]="METHOD_UNSET"]=0,t[e[1]="METHOD_GET"]=1,t[e[2]="METHOD_POST"]=2,t}(),e.SdkType=function(){var e={},t=Object.create(e);return t[e[0]="SDK_TYPE_UNSET"]=0,t[e[1]="SDK_TYPE_QUIC_MTCP_NATIVE"]=1,t[e[2]="SDK_TYPE_WSS_NATIVE"]=2,t[e[3]="SDK_TYPE_WSS_WEB"]=3,t}(),e.ZegoconnRunEnv=function(){var e={},t=Object.create(e);return t[e[0]="ZEGOCONN_RUN_ENV_UNSET"]=0,t[e[1]="ZEGOCONN_RUN_ENV_BROWSER"]=1,t[e[2]="ZEGOCONN_RUN_ENV_APPLET"]=2,t}(),e.BackendConnType=function(){var e={},t=Object.create(e);return t[e[0]="BACKEND_CONN_TYPE_UNSET"]=0,t[e[1]="BACKEND_CONN_TYPE_TCP"]=1,t[e[2]="BACKEND_CONN_TYPE_WSS"]=2,t}(),e.ConnectionClosed=(M.prototype.code=0,M.prototype.msg="",M.encode=function(e,t){return t=t||i.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),t},M.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.ConnectionClosed;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.code=e.int32();break;case 2:i.msg=e.string();break;default:e.skipType(7&o)}}return i},M),e.StreamClosed=(P.prototype.code=0,P.prototype.msg="",P.encode=function(e,t){return t=t||i.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),t},P.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.StreamClosed;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.code=e.int32();break;case 2:i.msg=e.string();break;default:e.skipType(7&o)}}return i},P),e.CloseConnection=(N.prototype.reason=0,N.prototype.msg="",N.prototype.action=0,N.encode=function(e,t){return t=t||i.create(),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(8).int32(e.reason),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(24).int32(e.action),t},N.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.CloseConnection;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.reason=e.int32();break;case 2:i.msg=e.string();break;case 3:i.action=e.int32();break;default:e.skipType(7&o)}}return i},N.Action=function(){var e={},t=Object.create(e);return t[e[0]="ACTION_RESERVED"]=0,t[e[1]="ACTION_DISPATCH"]=1,t[e[2]="ACTION_RETRY"]=2,t[e[3]="ACTION_NEXT_NODE"]=3,t[e[4]="ACTION_ABORT"]=4,t[e[5]="ACTION_NEXT_GROUP"]=5,t}(),N),e.HTTPRequest=(w.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,w.prototype.appid=0,w.prototype.biz_type=0,w.prototype.mode="",w.prototype.id_name="",w.prototype.reqid="",w.prototype.stick="",w.prototype.service="",w.prototype.location="",w.prototype.method="",w.prototype.headers=o.emptyArray,w.prototype.body=o.newBuffer([]),w.prototype.ack=!1,w.prototype.mode_no=0,w.prototype.service_no=0,w.prototype.method_no=0,w.prototype.sdk_type=0,w.prototype.zegoconn_run_env=0,w.prototype.zegoconn_version=0,w.encode=function(e,t){if(t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(34).string(e.mode),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.reqid&&Object.hasOwnProperty.call(e,"reqid")&&t.uint32(50).string(e.reqid),null!=e.stick&&Object.hasOwnProperty.call(e,"stick")&&t.uint32(58).string(e.stick),null!=e.service&&Object.hasOwnProperty.call(e,"service")&&t.uint32(66).string(e.service),null!=e.location&&Object.hasOwnProperty.call(e,"location")&&t.uint32(74).string(e.location),null!=e.method&&Object.hasOwnProperty.call(e,"method")&&t.uint32(82).string(e.method),null!=e.headers&&e.headers.length)for(var r=0;r<e.headers.length;++r)s.proto_accesshub.HTTPRequest.HTTPHeader.encode(e.headers[r],t.uint32(90).fork()).ldelim();return null!=e.body&&Object.hasOwnProperty.call(e,"body")&&t.uint32(98).bytes(e.body),null!=e.ack&&Object.hasOwnProperty.call(e,"ack")&&t.uint32(104).bool(e.ack),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(112).int32(e.mode_no),null!=e.service_no&&Object.hasOwnProperty.call(e,"service_no")&&t.uint32(120).int32(e.service_no),null!=e.method_no&&Object.hasOwnProperty.call(e,"method_no")&&t.uint32(128).int32(e.method_no),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(136).int32(e.sdk_type),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(144).int32(e.zegoconn_run_env),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(152).uint32(e.zegoconn_version),t},w.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.HTTPRequest;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.appid=e.uint32();break;case 3:i.biz_type=e.uint32();break;case 4:i.mode=e.string();break;case 5:i.id_name=e.string();break;case 6:i.reqid=e.string();break;case 7:i.stick=e.string();break;case 8:i.service=e.string();break;case 9:i.location=e.string();break;case 10:i.method=e.string();break;case 11:i.headers&&i.headers.length||(i.headers=[]),i.headers.push(s.proto_accesshub.HTTPRequest.HTTPHeader.decode(e,e.uint32()));break;case 12:i.body=e.bytes();break;case 13:i.ack=e.bool();break;case 14:i.mode_no=e.int32();break;case 15:i.service_no=e.int32();break;case 16:i.method_no=e.int32();break;case 17:i.sdk_type=e.int32();break;case 18:i.zegoconn_run_env=e.int32();break;case 19:i.zegoconn_version=e.uint32();break;default:e.skipType(7&o)}}return i},w.HTTPHeader=(A.prototype.name="",A.prototype.val="",A.encode=function(e,t){return t=t||i.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.val&&Object.hasOwnProperty.call(e,"val")&&t.uint32(18).string(e.val),t},A.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.HTTPRequest.HTTPHeader;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 2:i.val=e.string();break;default:e.skipType(7&o)}}return i},A),w),e.HTTPResponse=(L.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,L.prototype.headers=o.emptyArray,L.prototype.status_code=0,L.prototype.body=o.newBuffer([]),L.encode=function(e,t){if(t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.headers&&e.headers.length)for(var r=0;r<e.headers.length;++r)s.proto_accesshub.HTTPRequest.HTTPHeader.encode(e.headers[r],t.uint32(18).fork()).ldelim();return null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(24).int32(e.status_code),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&t.uint32(34).bytes(e.body),t},L.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.HTTPResponse;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.headers&&i.headers.length||(i.headers=[]),i.headers.push(s.proto_accesshub.HTTPRequest.HTTPHeader.decode(e,e.uint32()));break;case 3:i.status_code=e.int32();break;case 4:i.body=e.bytes();break;default:e.skipType(7&o)}}return i},L),e.HTTPRequestAck=(I.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,I.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),t},I.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.HTTPRequestAck;e.pos<r;){var o=e.uint32();o>>>3==1?i.txid=e.uint64():e.skipType(7&o)}return i},I),e.HTTPRequestDroped=(k.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,k.prototype.reason=0,k.prototype.msg="",k.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(16).int32(e.reason),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(26).string(e.msg),t},k.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.HTTPRequestDroped;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.reason=e.int32();break;case 3:i.msg=e.string();break;default:e.skipType(7&o)}}return i},k),e.ProxyConnectionClosed=(O.prototype.code=0,O.prototype.msg="",O.prototype.connected=0,O.encode=function(e,t){return t=t||i.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),null!=e.connected&&Object.hasOwnProperty.call(e,"connected")&&t.uint32(24).int32(e.connected),t},O.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.ProxyConnectionClosed;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.code=e.int32();break;case 2:i.msg=e.string();break;case 3:i.connected=e.int32();break;default:e.skipType(7&o)}}return i},O),e.HBRequest=(R.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,R.prototype.ts=o.Long?o.Long.fromBits(0,0,!1):0,R.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(16).int64(e.ts),t},R.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.HBRequest;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.ts=e.int64();break;default:e.skipType(7&o)}}return i},R),e.HBResponse=(C.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,C.prototype.ts=o.Long?o.Long.fromBits(0,0,!1):0,C.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(16).int64(e.ts),t},C.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.HBResponse;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.ts=e.int64();break;default:e.skipType(7&o)}}return i},C),e.GetConfigRequest=(T.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,T.prototype.appid=0,T.prototype.biz_type=0,T.prototype.mode="",T.prototype.id_name="",T.prototype.reqid="",T.prototype.zegoconn_version=0,T.prototype.sdk_type=0,T.prototype.zegoconn_run_env=0,T.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(34).string(e.mode),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.reqid&&Object.hasOwnProperty.call(e,"reqid")&&t.uint32(50).string(e.reqid),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(56).uint32(e.zegoconn_version),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(64).int32(e.sdk_type),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(72).int32(e.zegoconn_run_env),t},T.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.GetConfigRequest;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.appid=e.uint32();break;case 3:i.biz_type=e.uint32();break;case 4:i.mode=e.string();break;case 5:i.id_name=e.string();break;case 6:i.reqid=e.string();break;case 7:i.zegoconn_version=e.uint32();break;case 8:i.sdk_type=e.int32();break;case 9:i.zegoconn_run_env=e.int32();break;default:e.skipType(7&o)}}return i},T),e.GetConfigResponseData=(b.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,b.prototype.quic_hb_interval=0,b.prototype.quic_hb_timeout=0,b.prototype.logic_hb_interval=0,b.prototype.logic_hb_timeout=0,b.prototype.pc_establish_timeout=0,b.prototype.sdk_link_detect_interval=0,b.prototype.sdk_link_detect_duration=0,b.prototype.client_outer_ip="",b.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.quic_hb_interval&&Object.hasOwnProperty.call(e,"quic_hb_interval")&&t.uint32(16).uint32(e.quic_hb_interval),null!=e.quic_hb_timeout&&Object.hasOwnProperty.call(e,"quic_hb_timeout")&&t.uint32(24).uint32(e.quic_hb_timeout),null!=e.logic_hb_interval&&Object.hasOwnProperty.call(e,"logic_hb_interval")&&t.uint32(32).uint32(e.logic_hb_interval),null!=e.logic_hb_timeout&&Object.hasOwnProperty.call(e,"logic_hb_timeout")&&t.uint32(40).uint32(e.logic_hb_timeout),null!=e.pc_establish_timeout&&Object.hasOwnProperty.call(e,"pc_establish_timeout")&&t.uint32(48).uint32(e.pc_establish_timeout),null!=e.sdk_link_detect_interval&&Object.hasOwnProperty.call(e,"sdk_link_detect_interval")&&t.uint32(56).uint32(e.sdk_link_detect_interval),null!=e.sdk_link_detect_duration&&Object.hasOwnProperty.call(e,"sdk_link_detect_duration")&&t.uint32(64).uint32(e.sdk_link_detect_duration),null!=e.client_outer_ip&&Object.hasOwnProperty.call(e,"client_outer_ip")&&t.uint32(74).string(e.client_outer_ip),t},b.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.GetConfigResponseData;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.quic_hb_interval=e.uint32();break;case 3:i.quic_hb_timeout=e.uint32();break;case 4:i.logic_hb_interval=e.uint32();break;case 5:i.logic_hb_timeout=e.uint32();break;case 6:i.pc_establish_timeout=e.uint32();break;case 7:i.sdk_link_detect_interval=e.uint32();break;case 8:i.sdk_link_detect_duration=e.uint32();break;case 9:i.client_outer_ip=e.string();break;default:e.skipType(7&o)}}return i},b),e.GetConfigResponse=(S.prototype.code=0,S.prototype.message="",S.prototype.data=null,S.encode=function(e,t){return t=t||i.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&s.proto_accesshub.GetConfigResponseData.encode(e.data,t.uint32(26).fork()).ldelim(),t},S.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.GetConfigResponse;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.code=e.int32();break;case 2:i.message=e.string();break;case 3:i.data=s.proto_accesshub.GetConfigResponseData.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},S),e.PCUpwardMessage=(E.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,E.prototype.appid=0,E.prototype.biz_type=0,E.prototype.mode_no=0,E.prototype.id_name="",E.prototype.service_no=0,E.prototype.ack=!1,E.prototype.payload=o.newBuffer([]),E.prototype.sdk_type=0,E.prototype.wss_message_type=0,E.prototype.wss_path="",E.prototype.wss_raw_query="",E.prototype.zegoconn_version=0,E.prototype.zegoconn_run_env=0,E.prototype.backend_conn_type=0,E.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(32).int32(e.mode_no),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.service_no&&Object.hasOwnProperty.call(e,"service_no")&&t.uint32(48).int32(e.service_no),null!=e.ack&&Object.hasOwnProperty.call(e,"ack")&&t.uint32(56).bool(e.ack),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(66).bytes(e.payload),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(72).int32(e.sdk_type),null!=e.wss_message_type&&Object.hasOwnProperty.call(e,"wss_message_type")&&t.uint32(80).uint32(e.wss_message_type),null!=e.wss_path&&Object.hasOwnProperty.call(e,"wss_path")&&t.uint32(90).string(e.wss_path),null!=e.wss_raw_query&&Object.hasOwnProperty.call(e,"wss_raw_query")&&t.uint32(98).string(e.wss_raw_query),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(104).uint32(e.zegoconn_version),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(112).int32(e.zegoconn_run_env),null!=e.backend_conn_type&&Object.hasOwnProperty.call(e,"backend_conn_type")&&t.uint32(120).int32(e.backend_conn_type),t},E.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.PCUpwardMessage;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.appid=e.uint32();break;case 3:i.biz_type=e.uint32();break;case 4:i.mode_no=e.int32();break;case 5:i.id_name=e.string();break;case 6:i.service_no=e.int32();break;case 7:i.ack=e.bool();break;case 8:i.payload=e.bytes();break;case 9:i.sdk_type=e.int32();break;case 10:i.wss_message_type=e.uint32();break;case 11:i.wss_path=e.string();break;case 12:i.wss_raw_query=e.string();break;case 13:i.zegoconn_version=e.uint32();break;case 14:i.zegoconn_run_env=e.int32();break;case 15:i.backend_conn_type=e.int32();break;default:e.skipType(7&o)}}return i},E),e.PCUpwardMessageAck=(y.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,y.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),t},y.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.PCUpwardMessageAck;e.pos<r;){var o=e.uint32();o>>>3==1?i.txid=e.uint64():e.skipType(7&o)}return i},y),e.PCEstablished=(v.prototype.elapse=0,v.prototype.from=0,v.encode=function(e,t){return t=t||i.create(),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(8).uint32(e.elapse),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(16).uint32(e.from),t},v.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.PCEstablished;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.elapse=e.uint32();break;case 2:i.from=e.uint32();break;default:e.skipType(7&o)}}return i},v),e.PCBroken=(_.encode=function(e,t){return t||i.create()},_.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t;for(t=new s.proto_accesshub.PCBroken;e.pos<r;){var i=e.uint32();e.skipType(7&i)}return t},_),e.PCDownwardMessage=(m.prototype.payload=o.newBuffer([]),m.prototype.wss_message_type=0,m.encode=function(e,t){return t=t||i.create(),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(10).bytes(e.payload),null!=e.wss_message_type&&Object.hasOwnProperty.call(e,"wss_message_type")&&t.uint32(16).uint32(e.wss_message_type),t},m.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.PCDownwardMessage;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.payload=e.bytes();break;case 2:i.wss_message_type=e.uint32();break;default:e.skipType(7&o)}}return i},m),e.Redirect=(g.prototype.rand="",g.prototype.secret="",g.prototype.groups=o.emptyArray,g.prototype.opt_ports=o.emptyArray,g.prototype.wss_groups=o.emptyArray,g.encode=function(e,t){if(t=t||i.create(),null!=e.rand&&Object.hasOwnProperty.call(e,"rand")&&t.uint32(10).string(e.rand),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(18).string(e.secret),null!=e.groups&&e.groups.length)for(var r=0;r<e.groups.length;++r)s.proto_accesshub.AccesshubDispatchGroup.encode(e.groups[r],t.uint32(26).fork()).ldelim();if(null!=e.opt_ports&&e.opt_ports.length)for(var n=0;n<e.opt_ports.length;++n)t.uint32(32).uint32(e.opt_ports[n]);if(null!=e.wss_groups&&e.wss_groups.length)for(var o=0;o<e.wss_groups.length;++o)s.proto_accesshub.WssAccesshubDispatchGroup.encode(e.wss_groups[o],t.uint32(42).fork()).ldelim();return t},g.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.Redirect;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.rand=e.string();break;case 2:i.secret=e.string();break;case 3:i.groups&&i.groups.length||(i.groups=[]),i.groups.push(s.proto_accesshub.AccesshubDispatchGroup.decode(e,e.uint32()));break;case 4:if(i.opt_ports&&i.opt_ports.length||(i.opt_ports=[]),2==(7&o))for(var a=e.uint32()+e.pos;e.pos<a;)i.opt_ports.push(e.uint32());else i.opt_ports.push(e.uint32());break;case 5:i.wss_groups&&i.wss_groups.length||(i.wss_groups=[]),i.wss_groups.push(s.proto_accesshub.WssAccesshubDispatchGroup.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},g),e.GetAppConfigRequest=(f.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,f.prototype.appid=0,f.prototype.biz_type=0,f.prototype.mode_no=0,f.prototype.id_name="",f.prototype.config_key="",f.prototype.ts=o.Long?o.Long.fromBits(0,0,!0):0,f.prototype.signature=o.newBuffer([]),f.prototype.lite_sign="",f.prototype.token="",f.prototype.sdk_type=0,f.prototype.zegoconn_version=0,f.prototype.zegoconn_run_env=0,f.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(32).int32(e.mode_no),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.config_key&&Object.hasOwnProperty.call(e,"config_key")&&t.uint32(50).string(e.config_key),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(56).uint64(e.ts),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(66).bytes(e.signature),null!=e.lite_sign&&Object.hasOwnProperty.call(e,"lite_sign")&&t.uint32(74).string(e.lite_sign),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(82).string(e.token),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(88).int32(e.sdk_type),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(96).uint32(e.zegoconn_version),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(104).int32(e.zegoconn_run_env),t},f.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.GetAppConfigRequest;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.appid=e.uint32();break;case 3:i.biz_type=e.uint32();break;case 4:i.mode_no=e.int32();break;case 5:i.id_name=e.string();break;case 6:i.config_key=e.string();break;case 7:i.ts=e.uint64();break;case 8:i.signature=e.bytes();break;case 9:i.lite_sign=e.string();break;case 10:i.token=e.string();break;case 11:i.sdk_type=e.int32();break;case 12:i.zegoconn_version=e.uint32();break;case 13:i.zegoconn_run_env=e.int32();break;default:e.skipType(7&o)}}return i},f),e.GetAppConfigResponseData=(p.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,p.prototype.data=o.newBuffer([]),p.prototype.ts=o.Long?o.Long.fromBits(0,0,!0):0,p.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(24).uint64(e.ts),t},p.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.GetAppConfigResponseData;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.data=e.bytes();break;case 3:i.ts=e.uint64();break;default:e.skipType(7&o)}}return i},p),e.GetAppConfigResponse=(h.prototype.code=0,h.prototype.message="",h.prototype.data=null,h.encode=function(e,t){return t=t||i.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&s.proto_accesshub.GetAppConfigResponseData.encode(e.data,t.uint32(26).fork()).ldelim(),t},h.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.GetAppConfigResponse;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.code=e.int32();break;case 2:i.message=e.string();break;case 3:i.data=s.proto_accesshub.GetAppConfigResponseData.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},h),e.PushAppConfig=(d.prototype.config_key="",d.prototype.data=o.newBuffer([]),d.encode=function(e,t){return t=t||i.create(),null!=e.config_key&&Object.hasOwnProperty.call(e,"config_key")&&t.uint32(10).string(e.config_key),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},d.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.PushAppConfig;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.config_key=e.string();break;case 2:i.data=e.bytes();break;default:e.skipType(7&o)}}return i},d),e.AccesshubDispatchRequest=(l.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,l.prototype.appid=0,l.prototype.biz_type=0,l.prototype.mode_no=0,l.prototype.id_name="",l.prototype.sdk_type=0,l.prototype.zegoconn_version=0,l.prototype.zegoconn_run_env=0,l.encode=function(e,t){return t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(32).int32(e.mode_no),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(48).int32(e.sdk_type),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(56).uint32(e.zegoconn_version),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(64).int32(e.zegoconn_run_env),t},l.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.AccesshubDispatchRequest;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.appid=e.uint32();break;case 3:i.biz_type=e.uint32();break;case 4:i.mode_no=e.int32();break;case 5:i.id_name=e.string();break;case 6:i.sdk_type=e.int32();break;case 7:i.zegoconn_version=e.uint32();break;case 8:i.zegoconn_run_env=e.int32();break;default:e.skipType(7&o)}}return i},l),e.AccesshubDispatchGroup=(u.prototype.group="",u.prototype.quic_nodes=o.emptyArray,u.prototype.mtcp_nodes=o.emptyArray,u.prototype.wss_nodes=o.emptyArray,u.encode=function(e,t){if(t=t||i.create(),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(10).string(e.group),null!=e.quic_nodes&&e.quic_nodes.length)for(var r=0;r<e.quic_nodes.length;++r)t.uint32(18).string(e.quic_nodes[r]);if(null!=e.mtcp_nodes&&e.mtcp_nodes.length)for(var n=0;n<e.mtcp_nodes.length;++n)t.uint32(26).string(e.mtcp_nodes[n]);if(null!=e.wss_nodes&&e.wss_nodes.length)for(var o=0;o<e.wss_nodes.length;++o)t.uint32(34).string(e.wss_nodes[o]);return t},u.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.AccesshubDispatchGroup;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.group=e.string();break;case 2:i.quic_nodes&&i.quic_nodes.length||(i.quic_nodes=[]),i.quic_nodes.push(e.string());break;case 3:i.mtcp_nodes&&i.mtcp_nodes.length||(i.mtcp_nodes=[]),i.mtcp_nodes.push(e.string());break;case 4:i.wss_nodes&&i.wss_nodes.length||(i.wss_nodes=[]),i.wss_nodes.push(e.string());break;default:e.skipType(7&o)}}return i},u),e.WssAccesshubDispatchGroup=(c.prototype.group="",c.prototype.host="",c.prototype.main_domain="",c.encode=function(e,t){return t=t||i.create(),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(10).string(e.group),null!=e.host&&Object.hasOwnProperty.call(e,"host")&&t.uint32(18).string(e.host),null!=e.main_domain&&Object.hasOwnProperty.call(e,"main_domain")&&t.uint32(26).string(e.main_domain),t},c.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.WssAccesshubDispatchGroup;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.group=e.string();break;case 2:i.host=e.string();break;case 3:i.main_domain=e.string();break;default:e.skipType(7&o)}}return i},c),e.AccesshubDispatchResponseData=(a.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,a.prototype.rand="",a.prototype.secret="",a.prototype.groups=o.emptyArray,a.prototype.opt_ports=o.emptyArray,a.prototype.wss_groups=o.emptyArray,a.encode=function(e,t){if(t=t||i.create(),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.rand&&Object.hasOwnProperty.call(e,"rand")&&t.uint32(18).string(e.rand),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(26).string(e.secret),null!=e.groups&&e.groups.length)for(var r=0;r<e.groups.length;++r)s.proto_accesshub.AccesshubDispatchGroup.encode(e.groups[r],t.uint32(34).fork()).ldelim();if(null!=e.opt_ports&&e.opt_ports.length)for(var n=0;n<e.opt_ports.length;++n)t.uint32(40).uint32(e.opt_ports[n]);if(null!=e.wss_groups&&e.wss_groups.length)for(var o=0;o<e.wss_groups.length;++o)s.proto_accesshub.WssAccesshubDispatchGroup.encode(e.wss_groups[o],t.uint32(50).fork()).ldelim();return t},a.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.AccesshubDispatchResponseData;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.txid=e.uint64();break;case 2:i.rand=e.string();break;case 3:i.secret=e.string();break;case 4:i.groups&&i.groups.length||(i.groups=[]),i.groups.push(s.proto_accesshub.AccesshubDispatchGroup.decode(e,e.uint32()));break;case 5:if(i.opt_ports&&i.opt_ports.length||(i.opt_ports=[]),2==(7&o))for(var a=e.uint32()+e.pos;e.pos<a;)i.opt_ports.push(e.uint32());else i.opt_ports.push(e.uint32());break;case 6:i.wss_groups&&i.wss_groups.length||(i.wss_groups=[]),i.wss_groups.push(s.proto_accesshub.WssAccesshubDispatchGroup.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},a),e.AccesshubDispatchResponse=(r.prototype.code=0,r.prototype.message="",r.prototype.data=null,r.encode=function(e,t){return t=t||i.create(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&s.proto_accesshub.AccesshubDispatchResponseData.encode(e.data,t.uint32(26).fork()).ldelim(),t},r.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.AccesshubDispatchResponse;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.code=e.int32();break;case 2:i.message=e.string();break;case 3:i.data=s.proto_accesshub.AccesshubDispatchResponseData.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},r),e.PushException=(t.prototype.reason=0,t.prototype.msg="",t.prototype.txid=o.Long?o.Long.fromBits(0,0,!0):0,t.encode=function(e,t){return t=t||i.create(),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(8).int32(e.reason),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(24).uint64(e.txid),t},t.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_accesshub.PushException;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.reason=e.int32();break;case 2:i.msg=e.string();break;case 3:i.txid=e.uint64();break;default:e.skipType(7&o)}}return i},t),e;function t(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function a(e){if(this.groups=[],this.opt_ports=[],this.wss_groups=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function c(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function u(e){if(this.quic_nodes=[],this.mtcp_nodes=[],this.wss_nodes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function l(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function d(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function h(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function p(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function f(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function g(e){if(this.groups=[],this.opt_ports=[],this.wss_groups=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function m(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function _(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function v(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function y(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function E(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function S(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function b(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function T(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function C(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function R(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function O(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function k(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function I(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function L(e){if(this.headers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function w(e){if(this.headers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function A(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function N(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function P(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function M(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}}(),c=s.proto_initconfig=function(){var e,t={};return t.ResourceType=function(){var e={},t=Object.create(e);return t[e[0]="CDN"]=0,t[e[1]="RTC"]=1,t[e[2]="L3"]=2,t}(),t.ProtocolType=function(){var e={},t=Object.create(e);return t[e[0]="UDP"]=0,t[e[1]="RTMP"]=1,t[e[2]="FLV"]=2,t[e[3]="HLS"]=3,t[e[4]="WEBRTC"]=4,t}(),t.ResolveType=function(){var e={},t=Object.create(e);return t[e[0]="LOCAL_DNS"]=0,t[e[1]="DISPATCH"]=1,t}(),t.AppConfig=(p.prototype.test_id=null,p.prototype.domain=null,p.prototype.flexible_domain=null,p.prototype.replace_flexible_domain=null,Object.defineProperty(p.prototype,"_test_id",{get:o.oneOfGetter(e=["test_id"]),set:o.oneOfSetter(e)}),Object.defineProperty(p.prototype,"_domain",{get:o.oneOfGetter(e=["domain"]),set:o.oneOfSetter(e)}),Object.defineProperty(p.prototype,"_flexible_domain",{get:o.oneOfGetter(e=["flexible_domain"]),set:o.oneOfSetter(e)}),Object.defineProperty(p.prototype,"_replace_flexible_domain",{get:o.oneOfGetter(e=["replace_flexible_domain"]),set:o.oneOfSetter(e)}),p.encode=function(e,t){return t=t||i.create(),null!=e.test_id&&Object.hasOwnProperty.call(e,"test_id")&&t.uint32(8).int32(e.test_id),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(18).string(e.domain),null!=e.flexible_domain&&Object.hasOwnProperty.call(e,"flexible_domain")&&t.uint32(26).string(e.flexible_domain),null!=e.replace_flexible_domain&&Object.hasOwnProperty.call(e,"replace_flexible_domain")&&t.uint32(34).string(e.replace_flexible_domain),t},p.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.AppConfig;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.test_id=e.int32();break;case 2:i.domain=e.string();break;case 3:i.flexible_domain=e.string();break;case 4:i.replace_flexible_domain=e.string();break;default:e.skipType(7&o)}}return i},p),t.SpeedlogConfig=(h.prototype.report_count=null,h.prototype.report_retry_interval=null,h.prototype.push_quality_sample_count=null,h.prototype.pull_quality_sample_count=null,h.prototype.hardware_report_cycle=null,h.prototype.room_user_max_count=null,h.prototype.room_stream_max_count=null,h.prototype.charge_info_report_cycle=null,h.prototype.charge_info_report_mode=null,h.prototype.disable_report_pull=o.emptyArray,h.prototype.report_max_bytes=null,h.prototype.push_quality_report_freq=null,h.prototype.pull_quality_report_freq=null,h.prototype.charge_info_report_no_playing=null,Object.defineProperty(h.prototype,"_report_count",{get:o.oneOfGetter(e=["report_count"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_report_retry_interval",{get:o.oneOfGetter(e=["report_retry_interval"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_push_quality_sample_count",{get:o.oneOfGetter(e=["push_quality_sample_count"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_pull_quality_sample_count",{get:o.oneOfGetter(e=["pull_quality_sample_count"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_hardware_report_cycle",{get:o.oneOfGetter(e=["hardware_report_cycle"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_room_user_max_count",{get:o.oneOfGetter(e=["room_user_max_count"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_room_stream_max_count",{get:o.oneOfGetter(e=["room_stream_max_count"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_charge_info_report_cycle",{get:o.oneOfGetter(e=["charge_info_report_cycle"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_charge_info_report_mode",{get:o.oneOfGetter(e=["charge_info_report_mode"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_report_max_bytes",{get:o.oneOfGetter(e=["report_max_bytes"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_push_quality_report_freq",{get:o.oneOfGetter(e=["push_quality_report_freq"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_pull_quality_report_freq",{get:o.oneOfGetter(e=["pull_quality_report_freq"]),set:o.oneOfSetter(e)}),Object.defineProperty(h.prototype,"_charge_info_report_no_playing",{get:o.oneOfGetter(e=["charge_info_report_no_playing"]),set:o.oneOfSetter(e)}),h.encode=function(e,t){if(t=t||i.create(),null!=e.report_count&&Object.hasOwnProperty.call(e,"report_count")&&t.uint32(8).int32(e.report_count),null!=e.report_retry_interval&&Object.hasOwnProperty.call(e,"report_retry_interval")&&t.uint32(16).int32(e.report_retry_interval),null!=e.push_quality_sample_count&&Object.hasOwnProperty.call(e,"push_quality_sample_count")&&t.uint32(24).int32(e.push_quality_sample_count),null!=e.pull_quality_sample_count&&Object.hasOwnProperty.call(e,"pull_quality_sample_count")&&t.uint32(32).int32(e.pull_quality_sample_count),null!=e.hardware_report_cycle&&Object.hasOwnProperty.call(e,"hardware_report_cycle")&&t.uint32(40).int32(e.hardware_report_cycle),null!=e.room_user_max_count&&Object.hasOwnProperty.call(e,"room_user_max_count")&&t.uint32(48).int32(e.room_user_max_count),null!=e.room_stream_max_count&&Object.hasOwnProperty.call(e,"room_stream_max_count")&&t.uint32(56).int32(e.room_stream_max_count),null!=e.charge_info_report_cycle&&Object.hasOwnProperty.call(e,"charge_info_report_cycle")&&t.uint32(64).int32(e.charge_info_report_cycle),null!=e.charge_info_report_mode&&Object.hasOwnProperty.call(e,"charge_info_report_mode")&&t.uint32(72).int32(e.charge_info_report_mode),null!=e.disable_report_pull&&e.disable_report_pull.length){t.uint32(82).fork();for(var r=0;r<e.disable_report_pull.length;++r)t.int32(e.disable_report_pull[r]);t.ldelim()}return null!=e.report_max_bytes&&Object.hasOwnProperty.call(e,"report_max_bytes")&&t.uint32(88).int32(e.report_max_bytes),null!=e.push_quality_report_freq&&Object.hasOwnProperty.call(e,"push_quality_report_freq")&&t.uint32(96).int32(e.push_quality_report_freq),null!=e.pull_quality_report_freq&&Object.hasOwnProperty.call(e,"pull_quality_report_freq")&&t.uint32(104).int32(e.pull_quality_report_freq),null!=e.charge_info_report_no_playing&&Object.hasOwnProperty.call(e,"charge_info_report_no_playing")&&t.uint32(112).int32(e.charge_info_report_no_playing),t},h.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.SpeedlogConfig;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.report_count=e.int32();break;case 2:i.report_retry_interval=e.int32();break;case 3:i.push_quality_sample_count=e.int32();break;case 4:i.pull_quality_sample_count=e.int32();break;case 5:i.hardware_report_cycle=e.int32();break;case 6:i.room_user_max_count=e.int32();break;case 7:i.room_stream_max_count=e.int32();break;case 8:i.charge_info_report_cycle=e.int32();break;case 9:i.charge_info_report_mode=e.int32();break;case 10:if(i.disable_report_pull&&i.disable_report_pull.length||(i.disable_report_pull=[]),2==(7&o))for(var a=e.uint32()+e.pos;e.pos<a;)i.disable_report_pull.push(e.int32());else i.disable_report_pull.push(e.int32());break;case 11:i.report_max_bytes=e.int32();break;case 12:i.push_quality_report_freq=e.int32();break;case 13:i.pull_quality_report_freq=e.int32();break;case 14:i.charge_info_report_no_playing=e.int32();break;default:e.skipType(7&o)}}return i},h),t.MediaServiceProtocolInfo=(d.prototype.config_id=null,d.prototype.protocol=null,d.prototype.url_template=null,d.prototype.resolve_type=null,d.prototype.push_cdn_authentication=null,d.prototype.cdn_quic_version=o.emptyArray,Object.defineProperty(d.prototype,"_config_id",{get:o.oneOfGetter(e=["config_id"]),set:o.oneOfSetter(e)}),Object.defineProperty(d.prototype,"_protocol",{get:o.oneOfGetter(e=["protocol"]),set:o.oneOfSetter(e)}),Object.defineProperty(d.prototype,"_url_template",{get:o.oneOfGetter(e=["url_template"]),set:o.oneOfSetter(e)}),Object.defineProperty(d.prototype,"_resolve_type",{get:o.oneOfGetter(e=["resolve_type"]),set:o.oneOfSetter(e)}),Object.defineProperty(d.prototype,"_push_cdn_authentication",{get:o.oneOfGetter(e=["push_cdn_authentication"]),set:o.oneOfSetter(e)}),d.encode=function(e,t){if(t=t||i.create(),null!=e.config_id&&Object.hasOwnProperty.call(e,"config_id")&&t.uint32(10).string(e.config_id),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).int32(e.protocol),null!=e.url_template&&Object.hasOwnProperty.call(e,"url_template")&&t.uint32(26).string(e.url_template),null!=e.resolve_type&&Object.hasOwnProperty.call(e,"resolve_type")&&t.uint32(32).int32(e.resolve_type),null!=e.push_cdn_authentication&&Object.hasOwnProperty.call(e,"push_cdn_authentication")&&t.uint32(40).int32(e.push_cdn_authentication),null!=e.cdn_quic_version&&e.cdn_quic_version.length){t.uint32(50).fork();for(var r=0;r<e.cdn_quic_version.length;++r)t.int32(e.cdn_quic_version[r]);t.ldelim()}return t},d.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.MediaServiceProtocolInfo;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.config_id=e.string();break;case 2:i.protocol=e.int32();break;case 3:i.url_template=e.string();break;case 4:i.resolve_type=e.int32();break;case 5:i.push_cdn_authentication=e.int32();break;case 6:if(i.cdn_quic_version&&i.cdn_quic_version.length||(i.cdn_quic_version=[]),2==(7&o))for(var a=e.uint32()+e.pos;e.pos<a;)i.cdn_quic_version.push(e.int32());else i.cdn_quic_version.push(e.int32());break;default:e.skipType(7&o)}}return i},d),t.MediaResourceInfo=(l.prototype.resource_type=null,l.prototype.service_info=o.emptyArray,Object.defineProperty(l.prototype,"_resource_type",{get:o.oneOfGetter(e=["resource_type"]),set:o.oneOfSetter(e)}),l.encode=function(e,t){if(t=t||i.create(),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(8).int32(e.resource_type),null!=e.service_info&&e.service_info.length)for(var r=0;r<e.service_info.length;++r)s.proto_initconfig.MediaServiceProtocolInfo.encode(e.service_info[r],t.uint32(18).fork()).ldelim();return t},l.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.MediaResourceInfo;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.resource_type=e.int32();break;case 2:i.service_info&&i.service_info.length||(i.service_info=[]),i.service_info.push(s.proto_initconfig.MediaServiceProtocolInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},l),t.MediaPublishConfig=(u.prototype.resource_info=o.emptyArray,u.encode=function(e,t){if(t=t||i.create(),null!=e.resource_info&&e.resource_info.length)for(var r=0;r<e.resource_info.length;++r)s.proto_initconfig.MediaResourceInfo.encode(e.resource_info[r],t.uint32(18).fork()).ldelim();return t},u.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.MediaPublishConfig;e.pos<r;){var o=e.uint32();o>>>3==2?(i.resource_info&&i.resource_info.length||(i.resource_info=[]),i.resource_info.push(s.proto_initconfig.MediaResourceInfo.decode(e,e.uint32()))):e.skipType(7&o)}return i},u),t.MediaPlayConfig=(c.prototype.resource_info=o.emptyArray,c.encode=function(e,t){if(t=t||i.create(),null!=e.resource_info&&e.resource_info.length)for(var r=0;r<e.resource_info.length;++r)s.proto_initconfig.MediaResourceInfo.encode(e.resource_info[r],t.uint32(42).fork()).ldelim();return t},c.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.MediaPlayConfig;e.pos<r;){var o=e.uint32();o>>>3==5?(i.resource_info&&i.resource_info.length||(i.resource_info=[]),i.resource_info.push(s.proto_initconfig.MediaResourceInfo.decode(e,e.uint32()))):e.skipType(7&o)}return i},c),t.MediaConfig=(a.prototype.play_config=null,a.prototype.publish_config=null,Object.defineProperty(a.prototype,"_play_config",{get:o.oneOfGetter(e=["play_config"]),set:o.oneOfSetter(e)}),Object.defineProperty(a.prototype,"_publish_config",{get:o.oneOfGetter(e=["publish_config"]),set:o.oneOfSetter(e)}),a.encode=function(e,t){return t=t||i.create(),null!=e.play_config&&Object.hasOwnProperty.call(e,"play_config")&&s.proto_initconfig.MediaPlayConfig.encode(e.play_config,t.uint32(10).fork()).ldelim(),null!=e.publish_config&&Object.hasOwnProperty.call(e,"publish_config")&&s.proto_initconfig.MediaPublishConfig.encode(e.publish_config,t.uint32(18).fork()).ldelim(),t},a.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.MediaConfig;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.play_config=s.proto_initconfig.MediaPlayConfig.decode(e,e.uint32());break;case 2:i.publish_config=s.proto_initconfig.MediaPublishConfig.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},a),t.InitConfig=(r.prototype.app_config=null,r.prototype.speedlog_config=null,r.prototype.media_config=null,Object.defineProperty(r.prototype,"_app_config",{get:o.oneOfGetter(e=["app_config"]),set:o.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_speedlog_config",{get:o.oneOfGetter(e=["speedlog_config"]),set:o.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_media_config",{get:o.oneOfGetter(e=["media_config"]),set:o.oneOfSetter(e)}),r.encode=function(e,t){return t=t||i.create(),null!=e.app_config&&Object.hasOwnProperty.call(e,"app_config")&&s.proto_initconfig.AppConfig.encode(e.app_config,t.uint32(10).fork()).ldelim(),null!=e.speedlog_config&&Object.hasOwnProperty.call(e,"speedlog_config")&&s.proto_initconfig.SpeedlogConfig.encode(e.speedlog_config,t.uint32(34).fork()).ldelim(),null!=e.media_config&&Object.hasOwnProperty.call(e,"media_config")&&s.proto_initconfig.MediaConfig.encode(e.media_config,t.uint32(42).fork()).ldelim(),t},r.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new s.proto_initconfig.InitConfig;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.app_config=s.proto_initconfig.AppConfig.decode(e,e.uint32());break;case 4:i.speedlog_config=s.proto_initconfig.SpeedlogConfig.decode(e,e.uint32());break;case 5:i.media_config=s.proto_initconfig.MediaConfig.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},r),t;function r(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function a(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function c(e){if(this.resource_info=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function u(e){if(this.resource_info=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function l(e){if(this.service_info=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function d(e){if(this.cdn_quic_version=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function h(e){if(this.disable_report_pull=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function p(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}}()},function(e,t,r){"use strict";var n,i,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},c=(Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWssLink=void 0,r(14)),u=r(0),l=r(15),d=r(16),h=r(3),p=r(1);function f(e,t,r,n,o){var s=i.call(this)||this;return s.appID=e,s.env=t,s.protobuf=r,s.logger=n,s.stateCenter=o,s.socketService=new d.NetSocketService(s.env),s.urlIndex=0,s.updatedMsgTime=0,s.unUpdateMsgTimeTypes=[u.AccessHubMessageType.MSG_TYPE_HB_REQUEST,u.AccessHubMessageType.MSG_TYPE_HB_RESPONSE,u.AccessHubMessageType.MSG_TYPE_GET_CONFIG_REQUEST,u.AccessHubMessageType.MSG_TYPE_GET_CONFIG_RESPONSE],s.netLinkState=u.ENUM_CONNECT_STATE.disconnect,s.sendCommandList=new c.LinkedList,s.unSendCommandList=new c.LinkedList,s.sendCommandMap={},s.unSendCommandMap={},s.sendDataCheckOnceCount=100,s.sendDataDropTimeout=1e4,s.sendDataCheckInterval=2e3,s.timeout=5e3,s.connectInterval=1e4,s.connectTimer=null,s.connectRsp={},s.unlogTypes=[12,13],s.tryServers=[],s.updatedMsgTime=Date.now(),s}o(f,i=l.ZegoLink),f.prototype.initEvent=function(e,t,r,n){this.onConnectedEvent=e,this.onDisConnectedEvent=t,this.onConnectingEvent=r,this.onPushEvent=n},f.prototype.createSocket=function(e){this.servers=e,this.urlIndex=0},f.prototype.destroySocket=function(e){this.logger.info("zn.wl.ds.0 call "+e),this.socketService.closeSocket(),this.netLinkState=u.ENUM_CONNECT_STATE.disconnect,e!==u.DestroyType.NONE&&this.onDisConnectedEvent&&this.onDisConnectedEvent(e===u.DestroyType.BROKEN),this.resetConnect()},f.prototype.refreshServers=function(e){this.servers=a(a([],e,!0),this.servers,!0)},f.prototype.connectSocket=function(e,t,r){var n=this,i=(void 0===e&&(e=!0),this.logger.info("zn.wl.cs.0 call"),this.connectRsp.suc=t,!1);return this.connectRsp.fail=function(){r&&(i?n.logger.info("zn.wl.cs.0 fail cb has exec"):(r(),i=!0))},e&&(this.urlIndex=(this.urlIndex+1)%this.servers.length),t=this.servers[this.urlIndex],this.connectServer=t,this.logger.info("zn.wl.cs.0 server "+t),this.tryServers.push(t),this.closeSocket(),this.netLinkState=u.ENUM_CONNECT_STATE.connecting,this.socketService.createSocket(t),this.onConnectingEvent&&this.onConnectingEvent(!0),this.bindSocketEvent(),this.connectTimer=setTimeout((function(){n.logger.info("zn.wl.cs.0 timeout"),n.connectRsp.fail&&n.connectRsp.fail()}),this.connectInterval),!0},f.prototype.bindSocketEvent=function(){var e=this;this.openHandler((function(){e.logger.info("zn.wl.bse open"),e.resetConnect(),e.connectRsp.suc&&e.connectRsp.suc(),e.netLinkState=u.ENUM_CONNECT_STATE.connected,e.onConnectedEvent&&e.onConnectedEvent(e.tryServers),e.checkUnSendMsgs(e.unSendCommandList),e.startCheck()})),this.closeHandler((function(t){e.logger.warn("zn.wl.bse close "+JSON.stringify(t.code||t)),e.resetConnect(),e.connectRsp.fail&&e.connectRsp.fail(),e.onDisConnectedEvent&&e.onDisConnectedEvent(!0),e.netLinkState=u.ENUM_CONNECT_STATE.disconnect})),this.errorHandler((function(t){e.logger.warn("zn.wl.bse error "+JSON.stringify(t.code||t)),e.resetConnect(),e.connectRsp.fail&&e.connectRsp.fail(),e.onDisConnectedEvent&&e.onDisConnectedEvent(!0),e.netLinkState=u.ENUM_CONNECT_STATE.disconnect})),this.onMessage()},f.prototype.closeSocket=function(){this.logger.info("zn.wl.cs.1 call"),this.socketService.closeSocket(),this.netLinkState=u.ENUM_CONNECT_STATE.disconnect},f.prototype.resetConnect=function(){this.connectTimer&&(clearTimeout(this.connectTimer),this.connectTimer=null),this.stopCheck()},f.prototype.isConnect=function(){return this.netLinkState===u.ENUM_CONNECT_STATE.connected},f.prototype.isDisConnect=function(){return!this.socketService||this.socketService.isDisConnect()},f.prototype.isConnecting=function(){return this.netLinkState===u.ENUM_CONNECT_STATE.connecting},f.prototype.setState=function(e){this.netLinkState=e},f.prototype.closeHandler=function(e){this.socketService.closeHandler(e)},f.prototype.openHandler=function(e){this.socketService.openHandler(e)},f.prototype.errorHandler=function(e){this.socketService.errorHandler(e)},f.prototype.updateMsgTime=function(){this.updatedMsgTime=Date.now()},f.prototype.sendMessage=function(e,t,r,n,i,o,a,c){void 0===n&&(n=!0),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===(c=void 0===c?{}:c).timeout&&(c.timeout=5e3),void 0===c.isInSendMap&&(c.isInSendMap=!0),this.txid++,n={appid:this.appID,biz_type:0,mode_no:(null==(n=this.stateCenter.appInfo)?void 0:n.mode)||p.NET_ACCESS_CONFIG.modeNo,id_name:this.stateCenter.userId,sdk_type:p.NET_ACCESS_CONFIG.sdkType,zegoconn_run_env:0===this.env?u.ZegoconnRunEnv.ZEGOCONN_RUN_ENV_BROWSER:u.ZegoconnRunEnv.ZEGOCONN_RUN_ENV_APPLET},r={data:n=s(s({txid:this.txid},n),r),txid:this.txid,sendTime:Date.now(),streamID:t,type:e,timeOut:c.timeout||this.timeout,ack:r.ack,success:i,error:o,ackFunc:a,isSend:!0,isCheck:e!==u.AccessHubMessageType.MSG_TYPE_PC_UPWARD_MESSAGE},c.isInSendMap&&(i=this.sendCommandList.push(r),this.sendCommandMap[this.txid]=i),this.unUpdateMsgTimeTypes.includes(e)||(this.updatedMsgTime=Date.now()),-1===this.unlogTypes.indexOf(e)&&this.logger.info("zn.wl.sm type: "+e+"-"+u.typeMap[e]+" streamID: "+t+" txid: "+this.txid),this.isConnect()?this.sendUint8Data(e,n,t):(r.isSend=!1,o=this.unSendCommandList.push(r),this.unSendCommandMap[this.txid]=o)},f.prototype.checkUnSendMsgs=function(e){for(var t,r=e.getFirst();null!=r;)e.remove(r),r._data&&!1===(null==(t=r._data)?void 0:t.isSend)&&r._data.type&&r._data.streamID&&r._data.data&&(this.sendUint8Data(r._data.type,r._data.data,r._data.streamID),r._data.isSend=!0),r=e.getFirst()},f.prototype.sendUint8Data=function(e,t,r){e=this.protobuf.encodeRequest(e,t,r),this.socketService.sendMessage(e)},f.prototype.onMessage=function(){var e=this;this.socketService.onMessage=function(t){t=new Uint8Array(t);var r,n=(t=e.protobuf.decodeResponse(t))[0],i=t[1];t=t[2],e.unUpdateMsgTimeTypes.includes(i)||(e.updatedMsgTime=Date.now()),-1===e.unlogTypes.indexOf(i)&&e.logger.info("zn.wl.om"+" streamID: ".concat(n,", msgType: ").concat(i,"-").concat(u.typeMap[i])),(null!=t&&t.txid||null!=(r=null==t?void 0:t.data)&&r.txid)&&e.isRspMsg((null==t?void 0:t.txid)||(null==(r=null==t?void 0:t.data)?void 0:r.txid))?e.handleSendCommandMsgRsp(n,i,(null==t?void 0:t.txid)||(null==(r=null==t?void 0:t.data)?void 0:r.txid),t):e.onPushEvent(n,i,t)}},f.prototype.isRspMsg=function(e){return void 0!==this.sendCommandMap[e]},f.prototype.startCheck=function(){var e=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){e.startCheck()}),this.sendDataCheckInterval)},f.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},f.prototype.checkMessageListTimeout=function(e,t){for(var r,n=e.getFirst(),i=Date.now(),o=0,s=this;null!=n&&"break"!==function(){return n._data&&n._data.sendTime+n._data.timeOut>i?"break":(n._data&&delete t[n._data.data.txid],e.remove(n),n._data&&null==n._data.error||n._data&&n._data.sendTime+s.sendDataDropTimeout<i||(a=n&&n._data&&n._data.error,c=n&&n._data&&n._data.txid,u=n&&n._data&&(null==(r=n._data)?void 0:r.isCheck),setTimeout((function(){u&&a&&a({},c,h.errorCodeList.TIMEOUT)}),0)),++o>=s.sendDataCheckOnceCount?"break":void(n=e.getFirst()));var a,c,u}(););},f.prototype.checkSendMessageList=function(e){for(var t,r=e.getFirst();null!=r&&r._data;)!function(){var n,i,o;e.remove(r),r._data.isSend&&r._data.error&&(n=r&&r._data&&r._data.error,i=r&&r._data&&r._data.txid,o=r&&r._data&&(null==(t=r._data)?void 0:t.isCheck),setTimeout((function(){o&&n&&n({},i,h.errorCodeList.TIMEOUT)}),0)),r=e.getFirst()}()},f.prototype.handleSendCommandMsgRsp=function(e,t,r,n){var i,o=this.sendCommandMap[r];null!=o&&(null!=(i=o._data)&&i.ack||(delete this.sendCommandMap[r],this.sendCommandList.remove(o)),n.code&&0!==n.code?i&&null!=i.error&&i.error(n,r):t===u.AccessHubMessageType.MSG_TYPE_PUSH_EXCEPTION?(n.code=n.reason,n.message=n.msg,i&&null!=i.error&&i.error(n,r)):t===u.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST_ACK?i&&null!=i.ackFunc&&i.ackFunc(n,r):i&&null!=i.success&&i.success(n,r))},r=f,t.ZegoWssLink=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedList=t.ListNode=void 0,Object.defineProperty(i.prototype,"id",{get:function(){return this._id||null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),i.prototype.hasNext=function(){return this.next&&this.next.id},i.prototype.hasPrev=function(){return this.prev&&this.prev.id};var n=i;function i(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.next=null,this.prev=null,this._id=e,this._data=t}function o(){this.start=new n,this.end=new n,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}t.ListNode=n,o.prototype.insertBefore=function(e,t){return(t=new n(this._idCounter,t)).next=e,t.prev=e.prev,e.prev&&(e.prev.next=t),e.prev=t,++this._idCounter,++this._numNodes,t},o.prototype.addLast=function(e){return this.insertBefore(this.end,e)},o.prototype.add=function(e){return this.addLast(e)},o.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},o.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},o.prototype.size=function(){return this._numNodes},o.prototype.getFromFirst=function(e){var t=0,r=this.start.next;if(0<=e)for(;t<e&&null!==r;)r=r.next,++t;else r=null;if(null===r)throw"Index out of bounds.";return r},o.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},o.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},o.prototype.removeFirst=function(){var e=null;return 0<this._numNodes&&this.start.next?this.remove(this.start.next):e},o.prototype.removeLast=function(){var e=null;return 0<this._numNodes&&this.end.prev?this.remove(this.end.prev):e},o.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},o.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},o.prototype.find=function(e){for(var t=this.start,r=!1,n=null;t.hasNext()&&!r;)e(t=t.next)&&(n=t,r=!0);return n},o.prototype.map=function(e){for(var t=this.start,r=[];t.hasNext();)e(t=t.next)&&r.push(t);return r},o.prototype.push=function(e){return this.addLast(e)},o.prototype.unshift=function(e){0<this._numNodes?this.insertBefore(this.start.next,e):this.insertBefore(this.end,e)},o.prototype.pop=function(){return this.removeLast()},o.prototype.shift=function(){return this.removeFirst()},t.LinkedList=o},function(e,t,r){"use strict";function n(){this.txid=0,this.linkRetryTime=60,this.updatedMsgTime=0,this.connectServer=""}Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLink=void 0,n.prototype.createSocket=function(e){},n.prototype.setState=function(e){},n.prototype.initEvent=function(e,t,r,n){},n.prototype.sendMessage=function(e,t,r,n,i,o,s,a){void 0===n&&(n=!0),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null)},t.ZegoLink=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetSocketService=void 0;var n=r(17);function i(e){this.socket=null,this.ENV=e}i.prototype.createSocket=function(e){this.socket=(0,n.createZegoWebSocket)(e,this.ENV%2)},i.prototype.openHandler=function(e){var t=this;this.socket&&(this.socket.onopen=function(r){t.socket.binaryType="arraybuffer",t.responseHandler(),e(r)})},i.prototype.responseHandler=function(){var e=this;this.socket&&(this.socket.onmessage=function(t){t="string"==typeof t.data?JSON.parse(t.data):t.data,e.onMessage(t)})},i.prototype.onMessage=function(e){},i.prototype.closeHandler=function(e){this.socket&&(this.socket.onclose=function(t){e(t)})},i.prototype.errorHandler=function(e){this.socket&&(this.socket.onerror=e)},i.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},i.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},i.prototype.sendMessage=function(e){this.isDisConnect()||this.socket&&this.ENV%2!=1&&this.socket.send(e)},t.NetSocketService=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoWebSocket=t.ZegoWeiXinMiniWebSocket=t.ZEGO_ENV=void 0,(i=n=t.ZEGO_ENV||(t.ZEGO_ENV={}))[i.BROWSER=0]="BROWSER",i[i.WEIXINMINI=1]="WEIXINMINI",s.prototype.init=function(){var e=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onopen&&(e.onopen(t),e._websocket.onClose((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onclose&&e.onclose(t)})),e._websocket.onMessage((function(t){"function"==typeof e.onmessage&&e.onmessage(t)})))})),this._websocket.onError((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onerror&&e.onerror(t)})))},s.prototype.onopen=function(e){},s.prototype.onerror=function(e){},s.prototype.onclose=function(e){},s.prototype.onmessage=function(e){},s.prototype.send=function(e){this._websocket&&this._websocket.send({data:e})},s.prototype.close=function(){this._websocket&&this._websocket.close()};var n,i,o=s;function s(e,t){this.url=e,this.readyState=3,this._websocket=wx.connectSocket({url:e}),this.init()}t.ZegoWeiXinMiniWebSocket=o,t.createZegoWebSocket=function(e,t){return new(t%2===n.BROWSER?WebSocket:o)(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentBusinessRequestMgr=void 0;var n=r(0),i=r(1);function o(e,t,r,n){this.streamManager=e,this.protobuf=t,this.logger=r,this.stateCenter=n}o.prototype.getConfig=function(e,t){var r;this.logger.info("zn.nab.gc call"),this.streamManager.createStream(n.StreamType.OTHER).sendMessage(n.AccessHubMessageType.MSG_TYPE_GET_CONFIG_REQUEST,{zegoconn_version:i.NET_ACCESS_CONFIG.connectVer,mode:n.ModeMap[(null==(r=this.stateCenter.appInfo)?void 0:r.mode)||i.NET_ACCESS_CONFIG.modeNo]},e,t)},o.prototype.dispatchURL=function(e,t){var r=this;this.logger.info("zn.nab.du call"),this.streamManager.createStream(n.StreamType.OTHER).sendMessage(n.AccessHubMessageType.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST,{},(function(t){r.logger.info("zn.nab.du suc "),e&&e(t)}),(function(e,n,i){r.logger.info("zn.nab.du fail"),t&&t(i||e)}))},o.prototype.getAppConfig=function(e,t,r,o){var s=this;return new Promise((function(a,c){function u(e,t,r){r?(s.logger.error("zn.nab.gac fail "+JSON.stringify(r)),c(r)):0===e.code?(s.logger.info("zn.nab.gac suc"),r=s.decodeConfigMessage(e.data.data),a({code:0,data:r})):(s.logger.error("zn.nab.gac fail "+e.code),c({code:e.code}))}s.logger.info("zn.nab.gac call");var l={id_name:t,config_key:e,token:r,mode_no:(null==(l=s.stateCenter.appInfo)?void 0:l.mode)||i.NET_ACCESS_CONFIG.modeNo};s.streamManager.createStream(n.StreamType.OTHER).sendMessage(n.AccessHubMessageType.MSG_TYPE_GET_APPCONFIG_REQUEST,l,u,u,null,{timeout:o})}))},o.prototype.decodeConfigMessage=function(e){return this.protobuf.decodeConfigMessage(e)},t.NetAgentBusinessRequestMgr=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetHeartBeatHandler=void 0;var n=r(3),i=r(0);function o(e,t){this.streamManager=e,this.logger=t,this.hbTimer=null,this.hbInterval=5,this.hbTimeout=10,this.hbTimeoutMaxCount=0,this.tryHbCount=0}o.prototype.init=function(e){var t=this;this.logger.info("zn.nhb.ii call"),this.hbStream||(this.hbStream=this.streamManager.createStream(i.StreamType.OTHER)),1<=e.data.logic_hb_interval&&e.data.logic_hb_interval<=10&&(this.hbInterval=e.data.logic_hb_interval),3<=e.data.logic_hb_timeout&&e.data.logic_hb_timeout<=30&&(this.hbTimeout=e.data.logic_hb_timeout),this.tryHbCount=0,this.hbTimeoutMaxCount=this.hbTimeout/this.hbInterval,this.hbTimer&&clearTimeout(this.hbTimer),this.hbTimer=setTimeout((function(){t.start()}),1e3*this.hbInterval)},o.prototype.start=function(){var e,t,r,o=this;this.logger.debug("zn.nhb.s call "),this.tryHbCount++>this.hbTimeoutMaxCount?(this.logger.error("zn.nhb.s come to try limit"),this.reset(),this.netHbLogout(n.errorCodeList.NET_HB_TIMEOUT)):(e=(new Date).getTime(),t=function(t,r,n){o.logger.debug("zn.nhb.s hb callback "+((new Date).getTime()-e)),n&&0!==(null==n?void 0:n.code)?o.logger.info("zn.nhb.s fail "+JSON.stringify(n)):o.tryHbCount=0},r={ts:Date.now()},this.hbStream.sendMessage(i.AccessHubMessageType.MSG_TYPE_HB_REQUEST,r,t,t,null),this.hbTimer&&clearTimeout(this.hbTimer),this.hbTimer=setTimeout((function(){o.start()}),1e3*this.hbInterval))},o.prototype.netHbLogout=function(e){},o.prototype.reset=function(){this.hbTimer&&(clearTimeout(this.hbTimer),this.hbTimer=null),this.tryHbCount=0},t.NetHeartBeatHandler=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentPCRequestMgr=void 0;var n=r(0),i=r(1),o=r(5);function s(e,t){this.streamManager=e,this.logger=t,this.pcStreamRequests=[],this.pcEstablishTimeout=i.NET_ACCESS_CONFIG.pcEstablishTimeout}s.prototype.getRequest=function(e,t){return e=new o.NetAgentPCRequest(this.logger,e,this.streamManager,this.pcEstablishTimeout,t),this.pcStreamRequests.push(e),e},s.prototype.updateConnectState=function(e,t,r){this.pcStreamRequests.forEach((function(i){e===n.PcConnectState.BROKEN?i.eventManager.emit("broken"):e===n.PcConnectState.DISCONNECT&&i.eventManager.emit("disconnected",t,r)}))},s.prototype.closePCs=function(){this.pcStreamRequests.forEach((function(e){e.closePc()}))},s.prototype.setEstablishTimeout=function(e){this.pcEstablishTimeout=e},t.NetAgentPCRequestMgr=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetRetryLinkHandler=void 0;var n=r(3),i=r(0);function o(e,t){this.logger=e,this.stateCenter=t,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.retryActiveCount=1,this.retryNetCount=0,this.retryNetMaxTimes=3,this.isOverTime=!1,this.RETRY_MAX_TIME=90}o.prototype.initLink=function(e){this.link=e},o.prototype.startMaxTime=function(){var e=this;this.logger.info("zn.rlh.sm call"),this.maxTimer||(this.logger.info("zn.rlh.sm start max timer"),this.maxTimer=setTimeout((function(){e.logger.warn("zn.rlh.sm"+" over max time ".concat(e.RETRY_MAX_TIME,"s, stop retry")),e.isOverTime=!0,e.link.destroySocket(i.DestroyType.NONE),e.stopMaxTime(),e.invalid(),e.onactive(!1,n.errorCodeList.NET_SOCKET_TIMEOUT)}),1e3*this.RETRY_MAX_TIME))},o.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},o.prototype.active=function(e,t,r){var n=this;if(void 0===r&&(r=!1),this.logger.info("zn.rlh.at call "+e+" "+(t=void 0!==t&&t)),this.retryTimer)return this.logger.info("zn.rlh.at has actived, ignore"),!1;var o=this.stateCenter.networkState==i.ENUM_NETWORK_STATE.offline;if(o){if(this.logger.info("zn.rlh.at  check if really offline. "+this.retryNetCount),this.retryNetCount>=this.retryNetMaxTimes)return this.logger.warn("zn.rlh.at network is broken, stop retry"),!1}else this.retryNetCount=0;return this.link.isConnecting()&&!r?(this.logger.info("zn.rlh.at link is connecting, ignore"),!1):this.isOverTime?(this.logger.info("zn.rlh.at retry over time, stop retry"),!1):(1==this.retryActiveCount?this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL):(r=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1)),this.retryActiveInterval=r>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:r),this.logger.info("zn.rlh.at interval "+this.retryActiveInterval),this.retryTimer=setTimeout((function(){n.link.destroySocket(i.DestroyType.BROKEN),n.link.connectSocket(e,(function(){n.logger.info("zn.rlh.at suc"),n.stateCenter.networkState=i.ENUM_NETWORK_STATE.online,n.stopMaxTime(),n.invalid(),n.onactive(!0)}),(function(){n.logger.info("zn.rlh.at fail"),n.maxTimer||n.startMaxTime(),n.active(!0,!1,!0)})),n.retryTimer&&clearTimeout(n.retryTimer),n.retryTimer=null,o?n.retryNetCount++:n.retryActiveCount++}),t?0:1e3*this.retryActiveInterval),!0)},o.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},o.prototype.init=function(e,t,r,n){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof r&&(this.RETRY_CONTINUE_COUNT=r),"number"==typeof n&&(this.RETRY_MAX_TIME_INTERVAL=n)},o.prototype.invalid=function(){this.logger.info("zn.rlh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryActiveCount=1,this.retryNetCount=0},t.NetRetryLinkHandler=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateCenter=void 0;var n=r(0);t.StateCenter=function(){this.networkState=n.ENUM_NETWORK_STATE.online,this.useNetAgent=!0,this.specified=!1,this.clientIP=""}},function(e,t,r){"use strict";function n(){}Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLogger=void 0,n.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.join(" ");console.log(r)},n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.join(" ");console.debug(r)},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.join(" ");console.info(r)},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.join(" ");console.warn(r)},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.join(" ");console.error(r)},t.ZegoLogger=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;var n=r(0),i=r(25);function o(e){this.zegoLink=e,this.streamID=1,this.httpStreams=[],this.pcStreams=[]}o.prototype.createStream=function(e){return e!==n.StreamType.HTTP&&e===n.StreamType.PC?(t=new i.ZegoLinkStream(e,this.streamID++,this.zegoLink),this.pcStreams.push(t),t):this.getStream(e,this.httpStreams);var t},o.prototype.getStream=function(e,t){return t=t.find((function(e){return!0===e.isFree})),t?(t.isFree=!1,t.isFirst=!1,t):(t=new i.ZegoLinkStream(e,this.streamID++,this.zegoLink),this.httpStreams.push(t),t)},o.prototype.onPushEvent=function(e,t,r){var n=this.pcStreams.find((function(t){return t.StreamID===e}));n&&n.onPushEvent(t,r)},o.prototype.getStreamID=function(){return this.streamID++},t.StreamManager=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLinkStream=void 0;var n=r(0);function i(e,t,r){this.type=e,this.streamID=t,this.zegoLink=r,this.isFree=!1,this.isFirst=!0}Object.defineProperty(i.prototype,"StreamID",{get:function(){return this.streamID},enumerable:!1,configurable:!0}),i.prototype.refresh=function(e){this.streamID=e},i.prototype.sendMessage=function(e,t,r,i,o,s){var a=this;void 0===r&&(r=null),void 0===i&&(i=null),this.zegoLink.sendMessage(e,this.streamID,t,this.isFirst,(function(e){a.type!==n.StreamType.PC&&(a.isFree=!0),r&&r(e)}),(function(e,t,r){a.type!==n.StreamType.PC&&(a.isFree=!0),i&&i(e,t,r)}),o=void 0===o?null:o,s=void 0===s?{timeout:5e3,isInSendMap:!0}:s)},i.prototype.onPushEvent=function(e,t){},i.prototype.closeStream=function(e,t){this.zegoLink.sendMessage(n.AccessHubMessageType.MSG_TYPE_STREAM_CLOSED,this.streamID,{code:e,msg:t})},i.prototype.isConnect=function(){return this.zegoLink.isConnect()},t.ZegoLinkStream=i}],a={},n.m=s,n.c=a,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8))},function(e,t,r){var n;e.exports=(n=r(2),function(){var e,t;"function"==typeof ArrayBuffer&&(e=n.lib.WordArray,t=e.init,(e.init=function(e){if((e=(e=e instanceof ArrayBuffer?new Uint8Array(e):e)instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e)instanceof Uint8Array){for(var r=e.byteLength,n=[],i=0;i<r;i++)n[i>>>2]|=e[i]<<24-i%4*8;t.call(this,n,r)}else t.apply(this,arguments)}).prototype=e)}(),n.lib.WordArray)},function(e,t,r){(function(t){e.exports=function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}c=r[s]={exports:{}},t[s][0].call(c.exports,(function(e){return i(t[s][1][e]||e)}),c,c.exports,e,t,r,n)}return r[s].exports}for(var o=!1,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,r,n){(function(e){"use strict";var t,n,i,o,s=e.MutationObserver||e.WebKitMutationObserver,a=s?(t=0,s=new s(u),n=e.document.createTextNode(""),s.observe(n,{characterData:!0}),function(){n.data=t=++t%2}):e.setImmediate||void 0===e.MessageChannel?"document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)}:((i=new e.MessageChannel).port1.onmessage=u,function(){i.port2.postMessage(0)}),c=[];function u(){o=!0;for(var e,t,r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}o=!1}r.exports=function(e){1!==c.push(e)||o||a()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";var n=e(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){n((function(){var n;try{n=t(r)}catch(n){return o.reject(e,n)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var r=!1;function n(t){r||(r=!0,o.reject(e,t))}function i(t){r||(r=!0,o.resolve(e,t))}var s=f((function(){t(i,n)}));"error"===s.status&&n(s.value)}function f(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=u).prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var r=new this.constructor(i);return this.state!==c?d(r,this.state===a?e:t,this.outcome):this.queue.push(new l(r,e,t)),r},l.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){o.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var r=f(h,t);if("error"===r.status)return o.reject(e,r.value);if(r=r.value)p(e,r);else{e.state=a,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return o.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var s=new Array(r),a=0,c=-1,u=new this(i);++c<r;)!function(e,i){t.resolve(e).then((function(e){s[i]=e,++a!==r||n||(n=!0,o.resolve(u,s))}),(function(e){n||(n=!0,o.reject(u,e))}))}(e[c],c);return u},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var s=-1,a=new this(i);++s<r;)!function(e){t.resolve(e).then((function(e){n||(n=!0,o.resolve(a,e))}),(function(e){n||(n=!0,o.reject(a,e))}))}(e[s]);return a}},{1:1}],3:[function(e,r,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){try{return"undefined"!=typeof indexedDB?indexedDB:"undefined"!=typeof webkitIndexedDB?webkitIndexedDB:"undefined"!=typeof mozIndexedDB?mozIndexedDB:"undefined"!=typeof OIndexedDB?OIndexedDB:"undefined"!=typeof msIndexedDB?msIndexedDB:void 0}catch(e){}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var s=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function u(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d="local-forage-detect-blob-support",h=void 0,p={},f=Object.prototype.toString,g="readonly",m="readwrite";function _(e){return"boolean"==typeof h?s.resolve(h):(t=e,new s((function(e){var r=t.transaction(d,m),n=o([""]);r.objectStore(d).put(n,"key"),r.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},r.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);e(r||!t||43<=parseInt(t[1],10))}})).catch((function(){return!1})).then((function(e){return h=e})));var t}function v(e){e=p[e.name];var t={};t.promise=new s((function(e,r){t.resolve=e,t.reject=r})),e.deferredOperations.push(t),e.dbReady?e.dbReady=e.dbReady.then((function(){return t.promise})):e.dbReady=t.promise}function y(e){(e=p[e.name].deferredOperations.pop())&&(e.resolve(),e.promise)}function E(e,t){if(e=p[e.name].deferredOperations.pop())return e.reject(t),e.promise}function S(e,t){return new s((function(r,n){if(p[e.name]=p[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);v(e),e.db.close()}var o=[e.name],s=(t&&o.push(e.version),i.open.apply(i,o));t&&(s.onupgradeneeded=function(t){var r=s.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore(d)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),n(s.error)},s.onsuccess=function(){r(s.result),y(e)}}))}function b(e){return S(e,!1)}function T(e){return S(e,!0)}function C(e,t){if(!e.db)return 1;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,i=e.version>e.db.version;return n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),(i||r)&&(r&&(n=e.db.version+1)>e.version&&(e.version=n),1)}function R(e){return o([function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),i=0;i<t;i++)n[i]=e.charCodeAt(i);return r}(atob(e.data))],{type:e.type})}function O(e){return e&&e.__local_forage_encoded_blob}function k(e){var t=this,r=t._initReady().then((function(){var e=p[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(r,e,e),r}function I(e,t,r,n){void 0===n&&(n=1);try{var i=e.db.transaction(e.storeName,t);r(null,i)}catch(i){if(0<n&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return s.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),T(e)})).then((function(){return function(e){v(e);for(var t=p[e.name],r=t.forages,n=0;n<r.length;n++){var i=r[n];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,b(e).then((function(t){return e.db=t,C(e)?T(e):t})).then((function(n){e.db=t.db=n;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=n})).catch((function(t){throw E(e,t),t}))}(e).then((function(){I(e,t,r,n-1)}))})).catch(r);r(i)}}e={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var i=p[r.name],o=(i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},p[r.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=k),[]);function a(){return s.resolve()}for(var c=0;c<i.forages.length;c++){var u=i.forages[c];u!==t&&o.push(u._initReady().catch(a))}var l=i.forages.slice(0);return s.all(o).then((function(){return r.db=i.db,b(r)})).then((function(e){return r.db=e,C(r,t._defaultConfig.version)?T(r):e})).then((function(e){r.db=i.db=e,t._dbInfo=r;for(var n=0;n<l.length;n++){var o=l[n];o!==t&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}}))},_support:function(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=new s((function(t,n){r.ready().then((function(){I(r._dbInfo,g,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var r,n=s.result;n?(O(r=n.value)&&(r=R(r)),void 0!==(r=e(r,n.key,a++))?t(r):n.continue()):t()},s.onerror=function(){n(s.error)}}catch(i){n(i)}}))})).catch(n)}));return a(n,t),n},getItem:function(e,t){var r=this,n=(e=u(e),new s((function(t,n){r.ready().then((function(){I(r._dbInfo,g,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;O(e=void 0===e?null:e)&&(e=R(e)),t(e)},s.onerror=function(){n(s.error)}}catch(i){n(i)}}))})).catch(n)})));return a(n,t),n},setItem:function(e,t,r){var n=this,i=(e=u(e),new s((function(r,i){var o;n.ready().then((function(){return o=n._dbInfo,"[object Blob]"===f.call(t)?_(o.db).then((function(e){return e?t:(r=t,new s((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){t=btoa(t.target.result||""),e({__local_forage_encoded_blob:!0,data:t,type:r.type})},n.readAsBinaryString(r)})));var r})):t})).then((function(t){I(n._dbInfo,m,(function(o,s){if(o)return i(o);try{var a=s.objectStore(n._dbInfo.storeName),c=(null===t&&(t=void 0),a.put(t,e));s.oncomplete=function(){r(t=void 0===t?null:t)},s.onabort=s.onerror=function(){var e=c.error||c.transaction.error;i(e)}}catch(o){i(o)}}))})).catch(i)})));return a(i,r),i},removeItem:function(e,t){var r=this,n=(e=u(e),new s((function(t,n){r.ready().then((function(){I(r._dbInfo,m,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(s.error)},o.onabort=function(){var e=s.error||s.transaction.error;n(e)}}catch(i){n(i)}}))})).catch(n)})));return a(n,t),n},clear:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){I(t._dbInfo,m,(function(n,i){if(n)return r(n);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error||o.transaction.error;r(e)}}catch(n){r(n)}}))})).catch(r)}));return a(r,e),r},length:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){I(t._dbInfo,g,(function(n,i){if(n)return r(n);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){r(o.error)}}catch(n){r(n)}}))})).catch(r)}));return a(r,e),r},key:function(e,t){var r=this,n=new s((function(t,n){e<0?t(null):r.ready().then((function(){I(r._dbInfo,g,(function(i,o){if(i)return n(i);try{var s=o.objectStore(r._dbInfo.storeName),a=!1,c=s.openKeyCursor();c.onsuccess=function(){var r=c.result;r?0===e||a?t(r.key):(a=!0,r.advance(e)):t(null)},c.onerror=function(){n(c.error)}}catch(i){n(i)}}))})).catch(n)}));return a(n,t),n},keys:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){I(t._dbInfo,g,(function(n,i){if(n)return r(n);try{var o=i.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){r(o.error)}}catch(n){r(n)}}))})).catch(r)}));return a(r,e),r},dropInstance:function(e,t){t=l.apply(this,arguments);var r=this.config();return(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName),a(r=e.name?(r=e.name===r.name&&this._dbInfo.db?s.resolve(this._dbInfo.db):b(e).then((function(t){var r=p[e.name],n=r.forages;r.db=t;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=t;return t})),e.storeName?r.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1,n=(v(e),p[e.name]),o=n.forages;t.close();for(var a=0;a<o.length;a++){var c=o[a];c._dbInfo.db=null,c._dbInfo.version=r}return new s((function(t,n){var o=i.open(e.name,r);o.onerror=function(e){o.result.close(),n(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<o.length;t++){var r=o[t];r._dbInfo.db=e,y(r._dbInfo)}})).catch((function(t){throw(E(e,t)||s.resolve()).catch((function(){})),t}))}})):r.then((function(t){v(e);var r=p[e.name],n=r.forages;t.close();for(var o=0;o<n.length;o++)n[o]._dbInfo.db=null;return new s((function(t,r){var n=i.deleteDatabase(e.name);n.onerror=n.onblocked=function(e){var t=n.result;t&&t.close(),r(e)},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<n.length;t++)y(n[t]._dbInfo)})).catch((function(t){throw(E(e,t)||s.resolve()).catch((function(){})),t}))}))):s.reject("Invalid arguments"),t),r}};var L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=/^~~local_forage_type~([^~]+)~/,A="__lfsc__:",N=A.length,P=N+"arbf".length,M=Object.prototype.toString;function D(e){for(var t,r,n,i,o=.75*e.length,s=e.length,a=0,c=("="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--),o=new ArrayBuffer(o),new Uint8Array(o)),u=0;u<s;u+=4)t=L.indexOf(e[u]),r=L.indexOf(e[u+1]),n=L.indexOf(e[u+2]),i=L.indexOf(e[u+3]),c[a++]=t<<2|r>>4,c[a++]=(15&r)<<4|n>>2,c[a++]=(3&n)<<6|63&i;return o}function U(e){for(var t=new Uint8Array(e),r="",n=0;n<t.length;n+=3)r=(r=(r=(r+=L[t[n]>>2])+L[(3&t[n])<<4|t[n+1]>>4])+L[(15&t[n+1])<<2|t[n+2]>>6])+L[63&t[n+2]];return t.length%3==2?r=r.substring(0,r.length-1)+"=":t.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var x={serialize:function(e,t){var r="";if(e&&(r=M.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===M.call(e.buffer))){var n,i=A;e instanceof ArrayBuffer?(n=e,i+="arbf"):(n=e.buffer,"[object Int8Array]"===r?i+="si08":"[object Uint8Array]"===r?i+="ui08":"[object Uint8ClampedArray]"===r?i+="uic8":"[object Int16Array]"===r?i+="si16":"[object Uint16Array]"===r?i+="ur16":"[object Int32Array]"===r?i+="si32":"[object Uint32Array]"===r?i+="ui32":"[object Float32Array]"===r?i+="fl32":"[object Float64Array]"===r?i+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(i+U(n))}else if("[object Blob]"===r)(i=new FileReader).onload=function(){var r="~~local_forage_type~"+e.type+"~"+U(this.result);t(A+"blob"+r)},i.readAsArrayBuffer(e);else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}},deserialize:function(e){if(e.substring(0,N)!==A)return JSON.parse(e);var t,r=e.substring(P),n=e.substring(N,P),i=("blob"===n&&w.test(r)&&(t=(e=r.match(w))[1],r=r.substring(e[0].length)),D(r));switch(n){case"arbf":return i;case"blob":return o([i],{type:t});case"si08":return new Int8Array(i);case"ui08":return new Uint8Array(i);case"uic8":return new Uint8ClampedArray(i);case"si16":return new Int16Array(i);case"ur16":return new Uint16Array(i);case"si32":return new Int32Array(i);case"ui32":return new Uint32Array(i);case"fl32":return new Float32Array(i);case"fl64":return new Float64Array(i);default:throw new Error("Unkown type: "+n)}},stringToBuffer:D,bufferToString:U};function B(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function j(e,t,r,n,i,o){e.executeSql(r,n,i,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,s):B(e,t,(function(){e.executeSql(r,n,i,o)}),o)}),o):o(e,s)}),o)}function H(e,t,r,n){var i=this,o=(e=u(e),new s((function(o,s){i.ready().then((function(){var a=t=void 0===t?null:t,c=i._dbInfo;c.serializer.serialize(t,(function(t,u){u?s(u):c.db.transaction((function(r){j(r,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){s(t)}))}),(function(t){t.code===t.QUOTA_ERR&&(0<n?o(H.apply(i,[e,a,r,n-1])):s(t))}))}))})).catch(s)})));return a(o,r),o}var G={_driver:"webSQLStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var i=new s((function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction((function(i){B(i,r,(function(){t._dbInfo=r,e()}),(function(e,t){n(t)}))}),n)}));return r.serializer=x,i},_support:"function"==typeof openDatabase,iterate:function(e,t){var r=this,n=new s((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){j(r,i,"SELECT * FROM "+i.storeName,[],(function(r,n){for(var o=n.rows,s=o.length,a=0;a<s;a++){var c=o.item(a),u=(u=c.value)&&i.serializer.deserialize(u);if(void 0!==(u=e(u,c.key,a+1)))return void t(u)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,t),n},getItem:function(e,t){var r=this,n=(e=u(e),new s((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){j(r,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,r){r=(r=r.rows.length?r.rows.item(0).value:null)&&i.serializer.deserialize(r),t(r)}),(function(e,t){n(t)}))}))})).catch(n)})));return a(n,t),n},setItem:function(e,t,r){return H.apply(this,[e,t,r,1])},removeItem:function(e,t){var r=this,n=(e=u(e),new s((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){j(r,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)})));return a(n,t),n},clear:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){j(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,e),r},length:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){j(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,r){r=r.rows.item(0).c,e(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,e),r},key:function(e,t){var r=this,n=new s((function(t,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){j(r,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,r){r=r.rows.length?r.rows.item(0).key:null,t(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,t),n},keys:function(e){var t=this,r=new s((function(e,r){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){j(t,n,"SELECT key FROM "+n.storeName,[],(function(t,r){for(var n=[],i=0;i<r.rows.length;i++)n.push(r.rows.item(i).key);e(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,e),r},dropInstance:function(e,t){t=l.apply(this,arguments);var r=this.config(),n=((e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName),this),i=e.name?new s((function(t){var i,o=e.name===r.name?n._dbInfo.db:openDatabase(e.name,"","",0);e.storeName?t({db:o,storeNames:[e.storeName]}):t((i=o,new s((function(e,t){i.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(t,r){for(var n=[],o=0;o<r.rows.length;o++)n.push(r.rows.item(o).name);e({db:i,storeNames:n})}),(function(e,r){t(r)}))}),(function(e){t(e)}))}))))})).then((function(e){return new s((function(t,r){e.db.transaction((function(n){for(var i=[],o=0,a=e.storeNames.length;o<a;o++)i.push(function(e){return new s((function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){r(t)}))}))}(e.storeNames[o]));s.all(i).then((function(){t()})).catch((function(e){r(e)}))}),(function(e){r(e)}))}))})):s.reject("Invalid arguments");return a(i,t),i}};function z(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function q(e,t){for(var r,n,i=e.length,o=0;o<i;){if((r=e[o])===(n=t)||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return 1;o++}}var V={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=z(e,this._defaultConfig),!function(){var e="_localforage_support_test";try{localStorage.setItem(e,!0),localStorage.removeItem(e)}catch(e){return 1}}()||0<localStorage.length?((this._dbInfo=t).serializer=x,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=r.ready().then((function(){for(var t=r._dbInfo,n=t.keyPrefix,i=n.length,o=localStorage.length,s=1,a=0;a<o;a++){var c=localStorage.key(a);if(0===c.indexOf(n)){var u=(u=localStorage.getItem(c))&&t.serializer.deserialize(u);if(void 0!==(u=e(u,c.substring(i),s++)))return u}}}));return a(n,t),n},getItem:function(e,t){var r=this,n=(e=u(e),r.ready().then((function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&t.serializer.deserialize(n)})));return a(n,t),n},setItem:function(e,t,r){var n=this,i=(e=u(e),n.ready().then((function(){var r=t=void 0===t?null:t;return new s((function(i,o){var s=n._dbInfo;s.serializer.serialize(t,(function(t,n){if(n)o(n);else try{localStorage.setItem(s.keyPrefix+e,t),i(r)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}}))}))})));return a(i,r),i},removeItem:function(e,t){var r=this,n=(e=u(e),r.ready().then((function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)})));return a(n,t),n},clear:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;0<=r;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return a(r,e),r},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var r=this,n=r.ready().then((function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(n){t=null}return t&&t.substring(n.keyPrefix.length)}));return a(n,t),n},keys:function(e){var t=this,r=t.ready().then((function(){for(var e=t._dbInfo,r=localStorage.length,n=[],i=0;i<r;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return a(r,e),r},dropInstance:function(e,t){t=l.apply(this,arguments),(e="function"!=typeof e&&e||{}).name||(n=this.config(),e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r=this,n=e.name?new s((function(t){e.storeName?t(z(e,r._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;0<=t;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}})):s.reject("Invalid arguments");return a(n,t),n}},F=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Z={},W={},Y={INDEXEDDB:e,WEBSQL:G,LOCALSTORAGE:V},Q=(e=[Y.INDEXEDDB._driver,Y.WEBSQL._driver,Y.LOCALSTORAGE._driver],["dropInstance"]),K=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Q),J={description:"",driver:e.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function X(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];if(r)for(var n in r)r.hasOwnProperty(n)&&(F(r[n])?e[n]=r[n].slice():e[n]=r[n])}return e}function $(e){var t,r,n;if(!(this instanceof $))throw new TypeError("Cannot call a class as a function");for(t in Y)Y.hasOwnProperty(t)&&(n=(r=Y[t])._driver,this[t]=n,Z[n]||this.defineDriver(r));this._defaultConfig=X({},J),this._config=X({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}$.prototype.config=function(e){if("object"!==(void 0===e?"undefined":n(e)))return"string"==typeof e?this._config[e]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)},$.prototype.defineDriver=function(e,t,r){var n=new s((function(t,r){try{var n=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(e._driver){for(var o=K.concat("_initStorage"),c=0,u=o.length;c<u;c++){var l=o[c];if((!q(Q,l)||e[l])&&"function"!=typeof e[l])return void r(i)}for(var d=0,h=Q.length;d<h;d++){var p=Q[d];e[p]||(e[p]=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver");return a(t=s.reject(t),arguments[arguments.length-1]),t}}(p))}var f=function(r){Z[n]&&console.info("Redefining LocalForage driver: "+n),Z[n]=e,W[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(f,r):f(!!e._support):f(!0)}else r(i)}catch(i){r(i)}}));return c(n,t,r),n},$.prototype.driver=function(){return this._driver||null},$.prototype.getDriver=function(e,t,r){return c(e=Z[e]?s.resolve(Z[e]):s.reject(new Error("Driver not found.")),t,r),e},$.prototype.getSerializer=function(e){var t=s.resolve(x);return c(t,e),t},$.prototype.ready=function(e){var t=this,r=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(r,e,e),r},$.prototype.setDriver=function(e,t,r){var n=this,i=(F(e)||(e=[e]),this._getSupportedDrivers(e));function o(){n._config.driver=n.driver()}function a(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}return e=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve(),this._driverSet=e.then((function(){var e=i[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){var t=0;return function r(){for(;t<e.length;){var i=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(i).then(a).catch(r)}o();var c=new Error("No available storage method found.");return n._driverSet=s.reject(c),n._driverSet}()}}(i)}))})).catch((function(){o();var e=new Error("No available storage method found.");return n._driverSet=s.reject(e),n._driverSet})),c(this._driverSet,t,r),this._driverSet},$.prototype.supports=function(e){return!!W[e]},$.prototype._extend=function(e){X(this,e)},$.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];this.supports(i)&&t.push(i)}return t},$.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=K.length;e<t;e++)!function(e,t){e[t]=function(){var r=arguments;return e.ready().then((function(){return e[t].apply(e,r)}))}}(this,K[e])},$.prototype.createInstance=function(e){return new $(e)},G=new $,t.exports=G},{3:3}]},{},[4])(4)}).call(this,r(10))},function(e,t){},function(e,t,r){var n;e.exports=(e=r(2),n=e.lib.WordArray,e.enc.Base64={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=this._map,i=(e.clamp(),[]),o=0;o<r;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<r;a++)i.push(n.charAt(s>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,r=this._map;if(!(i=this._reverseMap))for(var i=this._reverseMap=[],o=0;o<r.length;o++)i[r.charCodeAt(o)]=o;var s=r.charAt(64);return s&&-1!==(s=e.indexOf(s))&&(t=s),function(e,t,r){for(var i,o,s=[],a=0,c=0;c<t;c++)c%4&&(i=r[e.charCodeAt(c-1)]<<c%4*2,o=r[e.charCodeAt(c)]>>>6-c%4*2,s[a>>>2]|=(i|o)<<24-a%4*8,a++);return n.create(s,a)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},e.enc.Base64)},function(e,t,r){var n,i,o,s;e.exports=(e=r(2),s=(r=e).lib,n=s.WordArray,i=s.Hasher,s=r.algo,o=[],s=s.SHA1=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],s=r[2],a=r[3],c=r[4],u=0;u<80;u++){u<16?o[u]=0|e[t+u]:(l=o[u-3]^o[u-8]^o[u-14]^o[u-16],o[u]=l<<1|l>>>31);var l=(n<<5|n>>>27)+c+o[u];l+=u<20?1518500249+(i&s|~i&a):u<40?1859775393+(i^s^a):u<60?(i&s|i&a|s&a)-1894007588:(i^s^a)-899497514,c=a,a=s,s=i<<30|i>>>2,i=n,n=l}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+s|0,r[3]=r[3]+a|0,r[4]=r[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(64+n>>>9<<4)]=Math.floor(r/4294967296),t[15+(64+n>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=i._createHelper(s),r.HmacSHA1=i._createHmacHelper(s),e.SHA1)},function(e,t,r){var n;e.exports=(e=r(2),r=e.lib.Base,n=e.enc.Utf8,void(e.algo.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));for(var r=e.blockSize,i=4*r,o=((t=t.sigBytes>i?e.finalize(t):t).clamp(),e=this._oKey=t.clone(),t=this._iKey=t.clone(),e.words),s=t.words,a=0;a<r;a++)o[a]^=1549556828,s[a]^=909522486;e.sigBytes=t.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})))},function(e,t,r){var n,i,o,s,a,c,u,l,d,h,p,f;e.exports=(e=r(2),r(11),void(e.lib.Cipher||(r=e.lib,n=r.Base,i=r.WordArray,o=r.BufferedBlockAlgorithm,(d=e.enc).Utf8,s=d.Base64,a=e.algo.EvpKDF,c=r.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?f:h}return function(t){return{encrypt:function(r,n,i){return e(n).encrypt(t,r,n,i)},decrypt:function(r,n,i){return e(n).decrypt(t,r,n,i)}}}}()}),r.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),d=e.mode={},u=r.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),d=d.CBC=function(){var e=u.extend();function t(e,t,r){var n,i=this._iv;i?(n=i,this._iv=void 0):n=this._prevBlock;for(var o=0;o<r;o++)e[t+o]^=n[o]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize;t.call(this,e,r,i),n.encryptBlock(e,r),this._prevBlock=e.slice(r,r+i)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize,o=e.slice(r,r+i);n.decryptBlock(e,r),t.call(this,e,r,i),this._prevBlock=o}}),e}(),p=(e.pad={}).Pkcs7={pad:function(e,t){for(var r=(t*=4)-e.sigBytes%t,n=r<<24|r<<16|r<<8|r,o=[],s=0;s<r;s+=4)o.push(n);t=i.create(o,r),e.concat(t)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.BlockCipher=c.extend({cfg:c.cfg.extend({mode:d,padding:p}),reset:function(){c.reset.call(this);var e,t=(r=this.cfg).iv,r=r.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,t&&t.words):(this._mode=e.call(r,this,t&&t.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),l=r.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),d=(e.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return(e=(e=e.salt)?i.create([1398893684,1701076831]).concat(e).concat(t):t).toString(s)},parse:function(e){var t,r=(e=s.parse(e)).words;return 1398893684==r[0]&&1701076831==r[1]&&(t=i.create(r.slice(2,4)),r.splice(0,4),e.sigBytes-=16),l.create({ciphertext:e,salt:t})}},h=r.SerializableCipher=n.extend({cfg:n.extend({format:d}),encrypt:function(e,t,r,n){n=this.cfg.extend(n),t=(i=e.createEncryptor(r,n)).finalize(t);var i=i.cfg;return l.create({ciphertext:t,key:r,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),p=(e.kdf={}).OpenSSL={execute:function(e,t,r,n){return n=n||i.random(8),e=a.create({keySize:t+r}).compute(e,n),r=i.create(e.words.slice(t),4*r),e.sigBytes=4*t,l.create({key:e,iv:r,salt:n})}},f=r.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:p}),encrypt:function(e,t,r,n){return r=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize),n.iv=r.iv,(e=h.encrypt.call(this,e,t,r.key,n)).mixIn(r),e},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),r=n.kdf.execute(r,e.keySize,e.ivSize,t.salt),n.iv=r.iv,h.decrypt.call(this,e,t,r.key,n)}}))))},function(e,t,r){"use strict";r.r(t),r.d(t,"ZegoExpressWebRTMEngine",(function(){return Ke})),r.d(t,"getReportSeq",(function(){return m})),r.d(t,"getSeq",(function(){return g})),r.d(t,"ZegoLogger",(function(){return c.ZegoLogger})),r.d(t,"ZegoDataReport",(function(){return c.ZegoDataReport})),r.d(t,"ZegoExpressWebRTM",(function(){return Fe})),r.d(t,"BusinessService",(function(){return R})),r.d(t,"NetConnection",(function(){return L}));var n,i,o,s,a,c=r(5),u={debug:0,info:1,warn:2,error:3,report:99,disable:100};(t=n=n||{})[t.TT_NONE=0]="TT_NONE",t[t.TT_PC=1]="TT_PC",t[t.TT_IOS=2]="TT_IOS",t[t.TT_ANDROID=3]="TT_ANDROID",t[t.TT_MAC=4]="TT_MAC",t[t.TT_LINUX=5]="TT_LINUX",t[t.TT_WEB=6]="TT_WEB",t[t.TT_MINIPROGRAM=7]="TT_MINIPROGRAM",t[t.TT_UNKNOWN=32]="TT_UNKNOWN",(t=i=i||{})[t.logout=0]="logout",t[t.trylogin=1]="trylogin",t[t.login=2]="login",(t=o=o||{})[t.offline=0]="offline",t[t.online=1]="online",(t=s=s||{})[t.NT_NONE=0]="NT_NONE",t[t.NT_LINE=1]="NT_LINE",t[t.NT_WIFI=2]="NT_WIFI",t[t.NT_2G=3]="NT_2G",t[t.NT_3G=4]="NT_3G",t[t.NT_4G=5]="NT_4G",t[t.NT_UNKNOWN=32]="NT_UNKNOWN",(t=a=a||{})[t.ClientType_None=0]="ClientType_None",t[t.ClientType_H5=1]="ClientType_H5",t[t.ClientType_SmallProgram=2]="ClientType_SmallProgram",t[t.ClientType_Webrtc=3]="ClientType_Webrtc";var l,d,h="eventStart",p="eventEndWithMsgInfo",f="addEventMsg",g=function(){return l++},m=(d=l=1,function(){return d++}),_=(Object.defineProperty(v.prototype,"id",{get:function(){return this._id||null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),v.prototype.hasNext=function(){return this.next&&this.next.id},v.prototype.hasPrev=function(){return this.prev&&this.prev.id},v);function v(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.next=null,this.prev=null,this._id=e,this._data=t}E.prototype.insertBefore=function(e,t){return(t=new _(this._idCounter,t)).next=e,t.prev=e.prev,e.prev&&(e.prev.next=t),e.prev=t,++this._idCounter,++this._numNodes,t},E.prototype.addLast=function(e){return this.insertBefore(this.end,e)},E.prototype.add=function(e){return this.addLast(e)},E.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},E.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},E.prototype.size=function(){return this._numNodes},E.prototype.getFromFirst=function(e){var t=0,r=this.start.next;if(0<=e)for(;t<e&&null!==r;)r=r.next,++t;else r=null;if(null===r)throw"Index out of bounds.";return r},E.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},E.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},E.prototype.removeFirst=function(){var e=null;return 0<this._numNodes&&this.start.next?this.remove(this.start.next):e},E.prototype.removeLast=function(){var e=null;return 0<this._numNodes&&this.end.prev?this.remove(this.end.prev):e},E.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},E.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},E.prototype.find=function(e){for(var t=this.start,r=!1,n=null;t.hasNext()&&!r;)e(t=t.next)&&(n=t,r=!0);return n},E.prototype.map=function(e){for(var t=this.start,r=[];t.hasNext();)e(t=t.next)&&r.push(t);return r},E.prototype.push=function(e){return this.addLast(e)},E.prototype.unshift=function(e){0<this._numNodes?this.insertBefore(this.start.next,e):this.insertBefore(this.end,e)},E.prototype.pop=function(){return this.removeLast()},E.prototype.shift=function(){return this.removeFirst()};var y=E;function E(){this.start=new _,this.end=new _,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}var S,b,T,C,R,O,k="\u672a\u5f15\u5165\u6d88\u606f\u6a21\u5757",I=r(13),L=(w.prototype.init=function(){var e;null!=(e=this.connection)&&e.init()},w.prototype.unInit=function(){var e;null!=(e=this.connection)&&e.unInit()},w.prototype.setAppInfo=function(e){var t;null!=(t=this.connection)&&t.setAppInfo(e)},w.prototype.setUserInfo=function(e){var t;null!=(t=this.connection)&&t.setUserInfo(e)},w.prototype.setNetAgentDefaultServers=function(e){var t;null!=(t=this.connection)&&t.setNetAgentDefaultServers(e)},w.prototype.setBackupDomains=function(e){var t;null!=(t=this.connection)&&t.setBackupDomains(e)},w.prototype.setDispatchConnectServers=function(e){var t;null!=(t=this.connection)&&t.setDispatchConnectServers(e)},w.prototype.setNetAgentSpecifiedServers=function(e){var t;null!=(t=this.connection)&&t.setNetAgentSpecifiedServers(e)},w.prototype.startHttpRequest=function(e,t,r,n,i){var o;null!=(o=this.connection)&&o.startHttpRequest(e,t,r,n,i)},w.prototype.getAppConfigByAgent=function(e,t,r){var n;return null==(n=this.connection)?void 0:n.getAppConfigByAgent(e,t,r)},w.prototype.getPCRequest=function(e,t){var r;return(null==(r=this.connection)?void 0:r.getPCRequest(e,t))||null},w.prototype.connectUa=function(){var e;null!=(e=this.connection)&&e.connectUa()},w.prototype.destroyConnect=function(){var e;null!=(e=this.connection)&&e.destroyConnect()},w.prototype.isConnect=function(){return!!this.connection&&this.connection.isConnect()},w.prototype.on=function(e,t){var r;return(null==(r=this.connection)?void 0:r.on(e,t))||!0},w.prototype.off=function(e,t){var r;return null==(r=this.connection)?void 0:r.off(e,t)},w.prototype.setLogger=function(e){var t;return null==(t=this.connection)?void 0:t.setLogger(e)},w.prototype.setAccess=function(e){var t;return null==(t=this.connection)?void 0:t.setAccess(e)},w);function w(){this.isLoad=!1,this.callBackList=[],this.connection=new I.ZegoConnectionAgent}(t=S=S||{})[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",(t=b=b||{})[t.EMPTY=0]="EMPTY",t[t.CLOSE=1]="CLOSE",(t=T=T||{})[t.Mode_UNSET=0]="Mode_UNSET",t[t.MODE_ONLINE=1]="MODE_ONLINE",t[t.MODE_TEST=2]="MODE_TEST",t[t.MODE_ALPHA=3]="MODE_ALPHA",(t=C=C||{})[t.CLOSE=0]="CLOSE",t[t.TEMP=1]="TEMP",t[t.TIMEOUT=2]="TIMEOUT",(t=R=R||{})[t.SERVICE_UNSET=0]="SERVICE_UNSET",t[t.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",t[t.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",t[t.SERVICE_MIX=3]="SERVICE_MIX",t[t.SERVICE_ZEUS=4]="SERVICE_ZEUS",t[t.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",t[t.SERVICE_L3=6]="SERVICE_L3",t[t.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",t[t.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",t[t.SERVICE_ZIM=9]="SERVICE_ZIM",t[t.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",t[t.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",t[t.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",t[t.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",t[t.SERVICE_QUALITY=14]="SERVICE_QUALITY",t[t.SERVICE_SECURITY=15]="SERVICE_SECURITY",t[t.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",t[t.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",t[t.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",t[t.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",t[t.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",t[t.SERVICE_CDN=21]="SERVICE_CDN",t[t.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",t[t.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",t[t.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",t[t.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",t[t.SERVICE_ECHO=26]="SERVICE_ECHO",t[t.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",t[t.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR",(t=O=O||{}).Logining="LOGINING",t.Logined="LOGINED",t.LoginFailed="LOGIN_FAILED",t.Reconnecting="RECONNECTING",t.Reconnected="RECONNECTED",t.ReconnectFailed="RECONNECT_FAILED",t.Kickout="KICKOUT",t.Logout="LOGOUT",t.LogoutFailed="LOGOUT_FAILED";var A={SERVER:{code:0,msg:"liverooom cmd error"},SUCCESS:{code:0,msg:"success."},INIT:{code:2000000001,msg:"init sdk wrong"},NOT_LOGIN:{code:1000002,msg:"not login"},APPID_INVALID:{code:1001004,msg:"appid invalid"},NETWORK_BROKEN:{code:1000017,msg:"network is broken"},INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},NET_SOCKET_TIMEOUT:{code:1100004,msg:"net agent timeout"},NET_HB_TIMEOUT:{code:1100005,msg:"net hb timeout"},INIT_SDK_WRONG:{code:1101e3,msg:"init sdk wrong"},ROOM_COUNT_EXCEED:{code:1002001,msg:"login rooms exceeds the upper limit"},USER_ID_NULL:{code:1002005,msg:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,msg:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,msg:"user ID is too long"},USER_NAME_NULL:{code:1002008,msg:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,msg:"username is too long"},ROOM_ID_NULL:{code:1002011,msg:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,msg:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,msg:"room ID is too long"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},LOGIN_TIMEOUT:{code:1002031,msg:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,msg:"users logging into the room exceeds the maximum number"},MULTI_ROOM_UNABLE:{code:1002036,msg:"multi room unable"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,msg:"kickout may be the same user ID login other"},NETWORK_RECOVERY:{code:1002051,msg:"network recovery"},ROOM_RETRY_TIMEOUT:{code:1002053,msg:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,msg:"server has sent a signal to kick out"},REPEATEDLY_LOGIN:{code:1002056,msg:"user repeatedly login"},REPEATEDLY_ENTER_ROOM:{code:1002057,msg:"user repeatedly enter room"},ALREADY_LOGIN:{code:1002058,msg:"user already logged in"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,msg:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,msg:"parse json error."},LOGIN_PROCESSING:{code:1102012,msg:"login is processing."},LIVEROMM_REQUEST_ERROR:{code:1102013,msg:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,msg:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,msg:"user login state is wrong."},TOKEN_ERROR:{code:1102016,msg:"token error"},DIAPATCH_ERROR:{code:1102017,msg:"dispatch error"},TOKEN_EXPIRED:{code:1102018,msg:"token expired"},SUBCMD_ERROR:{code:1102019,msg:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,msg:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,msg:"biz channel error."}},N=(P.base64encode=function(e){for(var t,r,n,i=e.length,o=0,s="";o<i;){if(t=255&e.charCodeAt(o++),o==i){s=(s+=P.base64EncodeChars.charAt(t>>2))+P.base64EncodeChars.charAt((3&t)<<4)+"==";break}if(r=e.charCodeAt(o++),o==i){s=(s=(s+=P.base64EncodeChars.charAt(t>>2))+P.base64EncodeChars.charAt((3&t)<<4|(240&r)>>4))+P.base64EncodeChars.charAt((15&r)<<2)+"=";break}n=e.charCodeAt(o++),s=(s=(s=(s+=P.base64EncodeChars.charAt(t>>2))+P.base64EncodeChars.charAt((3&t)<<4|(240&r)>>4))+P.base64EncodeChars.charAt((15&r)<<2|(192&n)>>6))+P.base64EncodeChars.charAt(63&n)}return s},P.base64decode=function(e){for(var t,r,n,i,o=e.length,s=0,a="";s<o;){for(;t=P.base64DecodeChars[255&e.charCodeAt(s++)],s<o&&-1==t;);if(-1==t)break;for(;r=P.base64DecodeChars[255&e.charCodeAt(s++)],s<o&&-1==r;);if(-1==r)break;a+=String.fromCharCode(t<<2|(48&r)>>4);do{if(61==(n=255&e.charCodeAt(s++)))return a}while(n=P.base64DecodeChars[n],s<o&&-1==n);if(-1==n)break;a+=String.fromCharCode((15&r)<<4|(60&n)>>2);do{if(61==(i=255&e.charCodeAt(s++)))return a}while(i=P.base64DecodeChars[i],s<o&&-1==i);if(-1==i)break;a+=String.fromCharCode((3&n)<<6|i)}return a},P.utf16to8=function(e){for(var t,r="",n=e.length,i=0;i<n;i++)1<=(t=e.charCodeAt(i))&&t<=127?r+=e.charAt(i):r=2047<t?(r=(r+=String.fromCharCode(224|t>>12&15))+String.fromCharCode(128|t>>6&63))+String.fromCharCode(128|t>>0&63):(r+=String.fromCharCode(192|t>>6&31))+String.fromCharCode(128|t>>0&63);return r},P.utf8to16=function(e){for(var t,r,n,i="",o=e.length,s=0;s<o;)switch((t=e.charCodeAt(s++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=e.charAt(s-1);break;case 12:case 13:r=e.charCodeAt(s++),i+=String.fromCharCode((31&t)<<6|63&r);break;case 14:r=e.charCodeAt(s++),n=e.charCodeAt(s++),i+=String.fromCharCode((15&t)<<12|(63&r)<<6|(63&n)<<0)}return i},P.base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P.base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],P);function P(){}t=r(3);var M=r.n(t),D=(t=r(7),r.n(t)),U=function(){return(U=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},x=(B.checkConfigParam=function(e,t,r){return e&&"number"==typeof e&&this.checkInteger(e)?!(!t||"string"!=typeof t&&!Array.isArray(t)||""==t)||(r.error("ccp.0 server must be string or string array and not empty"),!1):(r.error("ccp.0 appid must be positive integer number and not empty"),!1)},B.checkPriConfigParam=function(e,t,r,n,i){return e&&"number"==typeof e&&this.checkInteger(e)?t&&"string"==typeof t?"object"!=typeof r||"string"!=typeof r.deviceID?(i.error("ccp.0 deviceID must be string and not empty"),!1):1===n||0===n||(i.error("ccp.0 anType must be 0 or 1"),!1):(i.error("ccp.0 dispatchServer must be string and not empty"),!1):(i.error("ccp.0 appid must be positive integer number and not empty"),!1)},B.checkIllegalCharacters=function(e){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(e)&&/^[^:/]*$/g.test(e)},B.isUrl=function(e){return!!(e.startsWith("rtmp://")||e.startsWith("https://")&&e.endsWith(".flv")||e.startsWith("https://")&&e.endsWith(".m3u8"))},B.registerCallback=function(e,t,r){var n;t.success&&(n=t.success,r[e+"SuccessCallback"]=n),t.error&&(n=t.error,r[e+"ErrorCallback"]=n)},B.actionErrorCallback=function(e,t){return t[e+"ErrorCallback"]},B.actionSuccessCallback=function(e,t){return t[e+"SuccessCallback"]},B.logReportCallback=function(e,t,r,n){B.registerCallback(e,{success:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];B.dataReportEvent(t,r,e,n,i)}},n)},B.proxyRes=function(e,t,r,n){return{interResolve:function(n){e.uploadReport(t),r(n)},interReject:function(r,i){var o;void 0===i&&(i=""),(o=r.code<2e9&&1e9<r.code?B.decodeServerError(r.code,r.msg):{code:r.code,message:r.msg})&&e.addMsgInfo(t,{error:o.code,message:o.message+i}),e.uploadReport(t),n({errorCode:r.code||r.errorCode})}}},B.getServerError=function(e){var t={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",1010:"token expired",1011:"token format error",2002:"biz channel error",1e9:"liveroom cmd error, code:",1000002001:"need relogin",1000002002:"third token auth error",1000002003:"token nonce type should be int64",1000002004:"token appid type  should be uint32",1000002005:"token timeout type should be int64",1000002006:"token user_id type should be string",1000002007:"token room_id type should be string",1000002008:"token format error",1000002009:"token privilege type should be map",1000002010:"token expire_time type should be int64",1000002011:"token user_id type should be string",1000002012:"token not exist",1000002013:"token update error",1000002014:"token not need to check"};if(0===e)return A.SUCCESS;var r,n=U({},A.ROOM_INNER_ERROR);return n.code=e,n.msg=1e9<e?(r=t[e])?"liveroom cmd error, code: "+e+", message: "+r:t[1e9]+e:t[e]?t[e]+" code:"+e:"unknown error code:"+e,n},B.unregisterCallback=function(e,t){delete t[e+"SuccessCallback"],delete t[e+"ErrorCallback"]},B.decodeServerError=function(e,t){var r={code:-1,message:"server error"};return r.code=1e9<e?e-1e9+52e6:e+2002e6,t&&(r.message=t),r},B.getLiveRoomError=function(e,t){var r={1016:"MULTI_ROOM_UNABLE",1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:"TOKEN_ERROR",2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:"TOKEN_ERROR",5022:"ROOM_COUNT_EXCEED"};return t?2e5<e&&e<3e5?r[e-2e5]:e<2e5?{50116:"TOKEN_ERROR",50117:"TOKEN_EXPIRED",50118:"TOKEN_ERROR",50119:"TOKEN_ERROR",50120:"TOKEN_ERROR",50121:"TOKEN_ERROR",50122:"TOKEN_ERROR",50123:"TOKEN_EXPIRED",50124:"TOKEN_ERROR",50125:"TOKEN_ERROR",50126:"TOKEN_ERROR",50127:"TOKEN_ERROR",50128:"TOKEN_ERROR"}[e]||r[e]||"ROOM_INNER_ERROR":r[e]||"ROOM_INNER_ERROR":1e9<e?r[e-1e9]||"":{1:"PARSE_JSON_ERROR",1001:"LOGIN_PROCESSING",1002:"LIVEROMM_REQUEST_ERROR",1003:"ZPUSH_REQUEST_FAIL",1004:"ZPUSH_REQUEST_FAIL",1005:"ZPUSH_REQUEST_FAIL",1006:"LOGIN_STATE_WRONG",1007:"ZPUSH_REQUEST_FAIL",1008:"TOKEN_ERROR",1009:"DIAPATCH_ERROR",1010:"TOKEN_EXPIRED",1011:"TOKEN_ERROR",1012:"SUBCMD_ERROR",1101:"ZEGO_AUTH_ERROR",2001:"BIZ_CHANNEL_ERROR",2002:"BIZ_CHANNEL_ERROR"}[e]||"ROOM_INNER_ERROR"},B.getKickoutError=function(e,t){var r={code:e,message:"kickout reason = "+e};if(t)switch(e){case 1:r.code=63000001,r.message="zpush multiple login kickout",r.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:r.code=63000002,r.message="zpush manual kickout",r.name="MANUAL_KICKOUT";break;case 4:r.code=63000005,r.message="zpush token expired",r.name="TOKEN_EXPIRED";break;default:r.code=e,r.message="kickout reason = "+e}else switch(e){case 1:r.code=63000001,r.message="zpush multiple login kickout",r.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:r.code=63000002,r.message="zpush manual kickout",r.name="MANUAL_KICKOUT";break;case 3:r.code=63000003,r.message="kickout reason = "+e;break;case 4:r.code=63000004,r.message="zpush multiple login kickout",r.name="MULTIPLE_LOGIN_KICKOUT";break;case 5:r.code=63000005,r.message="zpush token expired",r.name="TOKEN_EXPIRED";break;default:r.code=e,r.message="kickout reason = "+e}return r},B.dataReportEvent=function(e,t,r,n,i){switch(r){case"eventStart":e.eventStart(t,n);break;case"eventEndWithMsgInfo":e.eventEndWithMsgInfo(t,n,i[0]);break;case"addEventMsg":e.addEventMsg(t,n,i[0],i[1]);break;case"addEvent":e.addEvent(t,n);break;case"eventEnd":e.eventEnd(t,n);break;case"addMsgInfo":e.addMsgInfo(t,i[0])}},B.isKeepTryLogin=function(e){switch(e){case 1002:case 1003:return!0;default:return!1}},B.mergeUserList=function(e,t,r,n){e.debug("msl.0 call");var i=[],o=[];r=r||[];for(var s=0;s<r.length;s++){for(var a=!1,c=0;c<t.length;c++)if(r[s].userID===t[c].userID){a=!0;break}a||i.push(r[s])}for(var u=0;u<t.length;u++){a=!1;for(var l=0;l<r.length;l++)if(t[u].userID===r[l].userID){a=!0;break}a||o.push(t[u])}for(t.splice(0),s=0;s<r.length;s++)t.push(t[s]);n(i,o),e.debug("msl.0 call success")},B.checkInteger=function(e,t){return 0==t?"number"==typeof e&&e%1==0&&0<=e:"number"==typeof e&&e%1==0&&0<e},B.checkValidNumber=function(e,t,r){return t=t||1,r=r||1e4,"number"==typeof e&&e%1==0&&t<=e&&e<=r},B.generateRandumNumber=function(e){return parseInt(Math.random()*(e+1)+"",10)},B.uuid=function(e,t){var r,n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(t=t||i.length,e)for(r=0;r<e;r++)o[r]=i[0|Math.random()*t];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",r=0;r<36;r++)o[r]||(n=0|16*Math.random(),o[r]=i[19==r?3&n|8:n]);return o.join("")},B.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var r=Math.max(e.length,t.length);e.length<r;)e.push("0");for(;t.length<r;)t.push("0");for(var n=0;n<r;n++){var i=parseInt(e[n]),o=parseInt(t[n]);if(o<i)return 1;if(i<o)return-1}return 0},B.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),r=-1!=e.indexOf("Firefox"),n=null!=window.opr,i=e.indexOf("Chrome")&&window.chrome;return e=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version"),t?"IE":r?"Firefox":n?"Opera":i?"Chrome":e?"Safari":"Unkown"},B.isTestEnv=function(e){return!(!e.startsWith("wss")||-1===e.indexOf("test")||!e.endsWith("ws"))},B.getLogLevel=function(e){return u[e]},B.getUint64=function(e,t,r){var n=r.getUint32(e,t);return r=r.getUint32(e+4,t),e=t?n+Math.pow(2,32)*r:Math.pow(2,32)*n+r,Number.isSafeInteger(e)||console.warn(e,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),e},B.decodeTokenExpire=function(e){try{var t,r=Uint8Array.from(N.base64decode(e),(function(e){return e.charCodeAt(0)})),n=new DataView(r.buffer);return 0<(t="function"==typeof n.getBigInt64?n.getBigUint64(0):B.getUint64(0,!1,n))?Number(t):Number(n.getBigUint64(0,!0))}catch(e){console.error("token error")}return-1},B.bin2hex=function(e){for(var t,r="",n=0,i=(e+="").length;n<i;n++)r+=(t=e.charCodeAt(n).toString(16)).length<2?"0"+t:t;return r},B.getCanvasFingerprint=function(e){var t=document.createElement("canvas"),r=((r=t.getContext("2d")).textBaseline="top",r.font="14px 'Arial'",r.fillStyle="#f60",r.fillRect(125,1,62,20),r.fillStyle="#069",r.fillText(e,2,15),r.fillStyle="rgba(102, 204, 0, 0.7)",r.fillText(e,4,17),t.toDataURL().replace("data:image/png;base64,",""));return e=atob(r),this.bin2hex(e.slice(-16,-12))},B.generateUUID=function(e){var t,r;return 0===(e=void 0===e?0:e)?r=localStorage.getItem("z_deviceID"):wx.getStorageSync("z_deviceID"),r||(t=(new Date).getTime(),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(36)})),0===e?(e=this.getCanvasFingerprint("hello, zego")+r.slice(8),localStorage.setItem("z_deviceID",e)):wx.setStorageSync("z_deviceID",r),r)},B.getNetType=function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return((null==e?void 0:e.effectiveType)||(null==e?void 0:e.type)||"unknwon").toUpperCase()},B.getNetTypeNum=function(){var e;return-1<(e=((null==(e=navigator.connection||navigator.mozConnection||navigator.webkitConnection)?void 0:e.effectiveType)||(null==e?void 0:e.type)||"unknwon").toUpperCase()).indexOf("4G")?s.NT_4G:-1<e.indexOf("2G")?s.NT_2G:-1<e.indexOf("3G")?s.NT_3G:-1<e.indexOf("WIFI")?s.NT_WIFI:-1<e.indexOf("LINE")?s.NT_LINE:-1<e.indexOf("NONE")?s.NT_NONE:s.NT_UNKNOWN},B.encryptStores=function(e,t){return M.a.encrypt(e,t).toString()},B.decryptStores=function(e,t){try{return M.a.decrypt(e,t).toString(D.a)}catch(e){return""}},B);function B(){}var j,H={product:"Web_SDK",URL:["https://cloud-setting-api.zego.im/cloud-setting/get","https://cloud-setting-api.zegocloud.com/cloud-setting/get"],ONLINE:!1},G="init",z="0c9e6e0f8c0a8f4e",q="z_net_access_servers",V="z_appconfig",F={domains:["accesshub-wss.zego.im","accesshub-wss.coolzcloud.com","accesshub-wss.zegocloud.com"],primaryDomains:["zego.im","coolzcloud.com","zegocloud.com"],mode:"online",modeNo:T.MODE_ONLINE,sdkType:3,connectVer:4,pcEstablishTimeout:15,scheme:"wss",location:"accesshub",wssMessageType:1};function Z(e,t){this.logger=e,this.stateCenter=t,this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1}Z.prototype.init=function(e,t,r,n){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof r&&(this.RETRY_CONTINUE_COUNT=r),"number"==typeof n&&(this.RETRY_MAX_TIME_INTERVAL=n)},Z.prototype.invalid=function(){this.logger.info("zm.rh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},t=Z,(Te=j=j||{}).RTM_CONSTRUCTOR="zm.0",Te.RTM_BIND_WINDOW_LISTENER="zm.wl",Te.RTM_SET_LOG_CONFIG="zm.slf",Te.RTM_SET_DEBUG_VERBOSE="zm.sdv",Te.RTM_LOGIN_ROOM="zm.lg",Te.RTM_LOGOUT_ROOM="zm.lo",Te.RTM_GET_SETTING_UNIFY="zm.gsu",Te.RTM_FETCH_APP_CONFIG="zm.fac",Te.RTM_SET_ACCESS="zm.sa",Te.RTM_CREATENETAGENT="zm.cna",Te.RTM_GETSTOREAPPCONFIG="zm.gsac",Te.LIVEROOMMODULES_BINDROOMHANDLER="zm.lrm.brh",Te.RTM_SET_CLOUD_SETTING_URLS="zm.scsu",Te.RTM_ON="zm.on",Te.RTM_OFF="zm.off",Te.RTM_RENEWTOKEN="zm.rntk",Te.RTM_RESETTOKENTIMER="zm.rstt",Te.RTM_ENABLE_MULTI_ROOM="zm.emr",Te.RTM_SEND_PB="zm.spb",Te.RTM_GET_HEADER="zm.gh",Te.ROOM_LOGIN_ROOM="zm.rm.lg",Te.ROOM_TRY_LOGIN="zm.rm.tl",Te.ROOM_OPEN_HANDLER="zm.rm.op",Te.ROOM_HANDLE_LOGINRSP="zm.rm.lgr",Te.ROOM_CLOSEHANDLER="zm.rm.clh",Te.ROOM_LOGOUT="zm.rm.lo",Te.ROOM_RESET_ROOM="zm.rm.rr",Te.ROOM_DISCONNECT="zm.rm.dcn",Te.ROOM_KICK_OUT="zm.rm.kco",Te.ROOM_STATUS_CALLBACK="zm.rm.scb",Te.ROOM_RESETTOKEN_TIMER="zm.rm.rst",Te.ROOM_HANDLE_Hb_LOGOUT="zm.hhl",Te.HEARTBEAT_START="zm.hb.st",Te.HEARTBEAT_HEARTBEAT_RSP="zm.hb.rsp",Te.HEARTBEAT_RESET="zm.hb.rst",Te.SERVICE_START_CHECK="zm.sc.0",Te.SERVICE_STOP_CHECK="zm.sc.1",Te.SERVICE_PUSH="zm.sv.ps",Te.SERVICE_SEND="zm.sv.sd",Te.RETRYROOMHANDLER_HANDLE_LOGIN_FINISH="zm.rrh.hlf",Te.RETRYROOMHANDLER_HANDLE_ERROR="zm.rrh.he",Te.USER_LOGIN_RSP="zm.us.lgr",Te.USER_FETCH_USER="zm.us.ftu",Te.USER_FETCH_USER_RSP="zm.us.urp",Te.USER_USER_PUSH="zm.us.uph",Te.USER_MERGE_SEQ="zm.us.mg",Te.USER_MERGE_TIMEOUT="zm.us.mto",Te.USER_MERGE="zm.us.mg",Te.USER_HB_PATCH="zm.us.pt",Te.STATE_ACTION="zm.st.at",Te.ON_LISTENER="ON_LISTENER",Te.LIVEROOMHANDLER_SENDMESSAGE="zm.lrh.sm",Te.LIVEROOMHANDLER_HANDLEPUSH="zm.lrh.hp",Te.LIVEROOMHANDLER_HANDLESWITCHPUSH="zm.lrh.hsp",Te.LIVEROOMHANDLER_PUSHUSERUPDATE="zm.lrh.puu",Te.LIVEROOMHANDLER_PUSHKICKOUT="zm.lrh.pk",Te.LIVEROOMHANDLER_GETSTREAMLIST="zm.lrh.gs",Te.LIVEROOMHANDLER_LOGIN="zm.lrh.lgi",Te.LIVEROOMHANDLER_FETCH_USER_LIST="zm.lrh.ful",Te.LIVEROOMHANDLER_LOGOUT="zm.lrh.lgo",Te.LIVEROOMHANDLER_SENDSTREAMUPDATE="zm.lrh.sru",Te.LIVEROOMHANDLER_RENEW_TOKEN="zm.lrh.rt",Te.LIVEROOMHANDLER_SENDSIGNALCMD="zm.lrh.ssc",Te.LIVEROOMHANDLER_SENDBIGROOMMESSAGE="zm.lrh.sbrm",Te.LIVEROOMHANDLER_SENDCUSTOMCOMMAND="zm.lrh.scc",Te.LIVEROOMHANDLER_FETCHRELIABLEMESSAGE="zm.lrh.frm",Te.LIVEROOMHANDLER_SENDRELIABLEMESSAGE="zm.lrh.srm.0",Te.LIVEROOMHANDLER_SENDROOMMSG="zm.lrh.srm.1",Te.LIVEROOMHANDLER_HANDLEDISCONNECTED="zm.lrh.hd",Te.LIVEROOMHANDLER_HANDLEBROKEN="zm.lrh.hb",Te.LIVEROOMHANDLER_HANDLECONNECTED="zm.lrh.hc",Te.LIVEROOMHANDLER_RESET="zm.lrh.r.0",W=function(e,t){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}W(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(J,Y=t),J.prototype.renewLocalToken=function(e,t){this.token=e,this.room.token=this.token;var r=(new Date).getTime(),n=void 0;t&&"number"==typeof t?n=1e3*t:["03","04"].includes(e.substring(0,2))&&(n=1e3*x.decodeTokenExpire(e.substring(2))-r),n&&this.roomHandler.resetTokenTimer(n-this.stateCenter.local_time_deviation),this.stateCenter.actionListener("_tokenRenewed",e,this.room.roomID)},J.prototype.initRoom=function(e,t,r,n,i,o,s){this.roomHandler=e,this.roomID=t,this.renewLocalToken(r),this.user=n,this.server=i,this.serverBak=o||i,this.config=s},J.prototype.active=function(e){var t=this;if(void 0===e&&(e=!1),this.logger.info(j.ROOM_LOGIN_ROOM+" retry call"),this.roomHandler.setRunState(i.trylogin),this.room.isMulti&&(null==(r=this.stateCenter.roomModulesList.find((function(e){return!e.isMulti})))?void 0:r.runState)!==i.login)this.logger.info(j.ROOM_LOGIN_ROOM+" service is disconnected, multi room stop retry");else if(this.retryTimer)this.logger.info(j.ROOM_LOGIN_ROOM+" has actived, ignore");else{var r,n=this.stateCenter.networkState==o.offline;if(n){if(this.logger.info(j.ROOM_LOGIN_ROOM+" check if really offline. "+this.retryNetCount),this.retryNetCount>=this.retryNetMaxTimes)return void this.logger.warn(j.ROOM_LOGIN_ROOM+" network is broken, stop retry")}else this.retryNetCount=0;this.isOverTime?this.logger.info(j.ROOM_LOGIN_ROOM+" retry over time, stop retry"):(1==this.retryActiveCount?this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL):(r=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1)),this.retryActiveInterval=r>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:r),this.retryTimer=setTimeout((function(){t.roomHandler.login(t.retryActiveCount%2==1?t.server:t.serverBak,t.roomID,t.token,t.user,t.config,(function(e){t.stateCenter.networkState=o.online,t.handleLoginFinish(e)}),(function(e,r){t.handleLoginFinish(!1,e,r)})),t.retryTimer&&clearTimeout(t.retryTimer),t.retryTimer=null,n?t.retryNetCount++:t.retryActiveCount++}),e?0:1e3*this.retryActiveInterval))}},J.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.logger.info(j.ROOM_LOGIN_ROOM+" start max timer"),this.maxTimer=setTimeout((function(){e.logger.info(j.ROOM_LOGIN_ROOM+" over max time "+e.RETRY_MAX_TIME+"s, stop retry"),e.isOverTime=!0,e.roomHandler.resetRoom(),e.stopMaxTime(),e.invalid(),e.onactive(!1,A.LOGIN_TIMEOUT),e.loginRoomCallback.fail&&(e.loginRoomCallback.fail(A.LOGIN_TIMEOUT),e.roomHandler.disconnectedHandle(A.LOGIN_TIMEOUT),e.resetCallBack())}),1e3*this.RETRY_MAX_TIME))},J.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},J.prototype.onactive=function(e,t){},J.prototype.handleError=function(e,t){if(this.RETRY_MAX_TIME<3)return!1;if(t){t=void 0;var r=void 0,n=void 0,o=(this.stateCenter.useNetAgent?(t=["202002","205030","205035","50116","50117","50118","50119","50120","50121","50122","50123","50124","50125","50126","50127","50128"],r=["40001","40100"],n=["201002","30019"]):(t=["1000002002","1000005030","1000005035","1010","1011","1013","1014","1015","1016","1017","1018","1019","1020","1021","1023"],r=["1100040001","1100040100"]),e.code+"");if(this.stateCenter.useNetAgent){if(10015===e.code)return this.room.retryConnect(),!0;if(40001<=e.code&&e.code<=40100||50200<=e.code&&e.code<=50299||null!=n&&n.includes(o))return this.room.resetSessionInfo(),!0}return!t.includes(o)&&(!!r.includes(o)||this.room.lastRunState==i.login&&(this.logger.warn(j.RETRYROOMHANDLER_HANDLE_ERROR+" reset"),this.room.sessionID="0",this.invalid(),!0))}return!0},J.prototype.setLoginRoomCallback=function(e,t){this.loginRoomCallback.success=e,this.loginRoomCallback.fail=t},J.prototype.loginFail=function(e){this.roomHandler.resetRoom(),this.stopMaxTime(),this.invalid(),this.onactive(!1,e),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(e),this.roomHandler.disconnectedHandle(e),this.resetCallBack())},J.prototype.handleLoginFinish=function(e,t,r){this.logger.info(j.RETRYROOMHANDLER_HANDLE_LOGIN_FINISH+" "+e+" "+JSON.stringify(t)),t?this.handleError(t,r)?(this.maxTimer||this.startMaxTime(),this.active()):(this.roomHandler.resetRoom(),this.stopMaxTime(),this.invalid(),this.onactive(e,t),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(t),this.roomHandler.disconnectedHandle(t),this.resetCallBack())):(this.stopMaxTime(),this.invalid(),this.onactive(e,{code:0,msg:""}),this.loginRoomCallback.success&&(this.loginRoomCallback.success(e),this.resetCallBack()))},J.prototype.invalid=function(){this.logger.info("zm.rh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryActiveCount=1,this.retryNetCount=0},J.prototype.resetCallBack=function(){this.loginRoomCallback.success=void 0,this.loginRoomCallback.fail=void 0};var W,Y,Q,K=J;function J(e,t,r){var n=Y.call(this,e,t)||this;return n.logger=e,n.stateCenter=t,n.room=r,n.retryNetCount=0,n.retryNetMaxTimes=3,n.loginRoomCallback={},n}(Te=Q=Q||{}).NOT_EMPTY="NOT_EMPTY",Te.ILLEGAL_CHARACTERS="ILLEGAL_CHARACTERS",Te.TYPE_STRING="TYPE_STRING",Te.TYPE_INTEGER="TYPE_INTEGER",Te.TYPE_OBJECT="TYPE_OBJECT",Te.MAX_LENGTH_10="MAX_LENGTH_10",Te.MAX_LENGTH_64="MAX_LENGTH_64",Te.MAX_LENGTH_100="MAX_LENGTH_100",Te.MAX_LENGTH_128="MAX_LENGTH_128",Te.MAX_LENGTH_256="MAX_LENGTH_256",Te.MAX_LENGTH_1024="MAX_LENGTH_1024";var X={error:{code:0,msg:"suc"}},$={NOT_EMPTY:function(e,t,r,n,i){return void 0===t||""===t||null===t?(n.error(r+" "+e+" is empty"),i):X},ILLEGAL_CHARACTERS:function(e,t,r,n,i){return x.checkIllegalCharacters(t)?X:(n.error(r+" "+e+" contains illegal characters"),i)},TYPE_STRING:function(e,t,r,n,i){return"string"!=typeof t?(n.error(r+" "+e+" must be string"),i):X},TYPE_INTEGER:function(e,t,r,n,i){return x.checkInteger(t,!1)?X:(n.error(r+" "+e+"  must be integer number"),i)},TYPE_OBJECT:function(e,t,r,n,i){return t&&"object"==typeof t?X:(n.error(r+" "+e+"  must be object"),i)},MAX_LENGTH_10:function(e,t,r,n,i){return 10<t.length?(n.error(r+" "+e+" is too long"),i):X},MAX_LENGTH_64:function(e,t,r,n,i){return 64<t.length?(n.error(r+" "+e+" is too long"),i):X},MAX_LENGTH_100:function(e,t,r,n,i){return 100<t.length?(n.error(r+" "+e+" is too long"),i):X},MAX_LENGTH_128:function(e,t,r,n,i){return 128<t.length?(n.error(r+" "+e+" is too long"),i):X},MAX_LENGTH_256:function(e,t,r,n,i){return 256<t.length?(n.error(r+" "+e+" is too long"),i):X},MAX_LENGTH_1024:function(e,t,r,n,i){return 1024<t.length?(n.error(r+" "+e+" is too long"),i):X}};function ee(e){return e}function te(e){return e}var re={kZegoTaskInitSetting:{event:"/sdk/init",error:{kInvalidParamError:A.INPUT_PARAM},system_info:navigator?navigator.appVersion:""},kZegoTaskSetDebug:{event:"/sdk/set_debug",debug:ee},kZegoTaskSetLog:{event:"/sdk/set_log_config",error:{kInvalidParamError:A.INPUT_PARAM},log_level:function(e){return e},remote_log_level:ee,log_url:ee},kZegoTaskLoginRoom:{event:"/sdk/login",user_update:ee,max_member_count:ee,message:ee,token:ee,use_na:ee,error:{ROOM_ID_NULL:A.ROOM_ID_NULL,INPUT_PARAM:A.INPUT_PARAM,ROOM_ID_TOO_LONG:A.ROOM_ID_TOO_LONG,ROOM_ID_INVALID_CHARACTER:A.ROOM_ID_INVALID_CHARACTER,USER_ID_NULL:A.USER_ID_NULL,USER_ID_TOO_LONG:A.USER_ID_TOO_LONG,USER_ID_INVALID_CHARACTER:A.USER_ID_INVALID_CHARACTER,USER_NAME_NULL:A.USER_NAME_NULL,USER_NAME_TOO_LONG:A.USER_NAME_TOO_LONG,REPEATEDLY_LOGIN:A.REPEATEDLY_LOGIN,LOGIN_TIMEOUT:A.LOGIN_TIMEOUT,INNER_ERROR:A.ROOM_INNER_ERROR,NETWORK_BROKEN:A.NETWORK_BROKEN},subEvent:{create_socket:{event:"create_socket",server:ee,try_cnt:ee},liveroom_login:{event:"liveroom_login",server:ee,respond_info:ee}}},kZegoTaskReNewToken:{event:"/sdk/reNewToken",error:{INPUT_PARAM:A.INPUT_PARAM,NOT_LOGIN:A.NOT_LOGIN}},kZegoTaskLogoutRoom:{event:"/sdk/logout",error:{INPUT_PARAM:A.INPUT_PARAM,ROOM_NOT_EXIST:A.ROOM_NOT_EXIST}},kZegoTaskReLoginRoom:{event:"/sdk/relogin",error:{ROOM_ID_NULL:A.ROOM_ID_NULL,ROOM_DISCONNECT:A.NETWORK_BROKEN},subEvent:{create_socket:{event:"create_socket",server:ee,try_cnt:ee},liveroom_login:{event:"liveroom_login",server:ee,respond_info:ee}}},kZegoTaskKickout:{event:"/sdk/kickout",user_id:ee,error:{}},kZegoTaskRoomKickout:{event:"/sdk/room_kickout",user_id:ee,room_id:ee,message:ee},kZegoTaskLiveRoomHB:{event:"/liveroom/hb",room_sid:ee,error:{NOT_LOGIN:A.NOT_LOGIN,HB_TIMEOUT:A.TIMEOUT}},kZegoTaskLiveRoomGetUserUpdateInfo:{event:"/liveroom/get_user_update_info",user_update_type:ee},kZegoListener:{event:"/sdk/listener"},kZegoEnableMultiRoom:{event:"sdk/enable_multi_room",error:{kInvalidParamError:A.INPUT_PARAM,kAlreadyLoginError:A.ALREADY_LOGIN}},kZegoTaskCloudSettingCache:{event:"/cloud_setting/cache"},kZegoTaskCloudSettingRefresh:{event:"/cloud_setting/refresh"},kZegoTaskCloudSettingRequest:{event:"/cloud_setting/request"},kZegoConnConnect:{event:"/zegoconn/connect",request_count:te,svr_env:ee,server_list:ee},kZegoConnDisConnect:{event:"/zegoconn/disconnect",server:ee},kZegoConnDispatch:{event:"/zegoconn/auto_dispatch",trigger_reason:ee,domain_list:function(e){return e}},kZegoRequest:{event:"/zegoconn/request",na_req_location:ee},kZegoSDKConfigInit:{event:"/sdk_config/init",trigger_reason:ee},kZegoSDKProxyConnect:{event:"/zegoconn/proxy_connect",proxy_link_sources:te,recv_time:te}},ne=(Object.defineProperty(ie.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e,c.LoggerStateCenter.getInstance().debug=e},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(e){this._testEnvironment=e,c.LoggerStateCenter.getInstance().testEnvironment=e},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"ENV",{get:function(){return this._env},set:function(e){this._env=e,c.LoggerStateCenter.getInstance().ENV=e},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"roomid",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].roomID:""},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"serverTimeOffset",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].messageHandler.serverTimeOffset:0},enumerable:!1,configurable:!0}),ie.prototype.getRequestId=function(){return this.idName+"-"+g()},ie.prototype.actionListener=function(e){for(var t,r=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];this.listenerList[e]&&(t=m(),this.dataReport.newReport(t,re.kZegoListener.event),this.dataReport.addMsgInfo(t,{listener:e,params:n}),this.dataReport.uploadReport(t)),["roomStateChanged","tokenWillExpire"].includes(e)&&this.logger.info("zm.al "+e+" "+JSON.stringify(n)),this.listenerList[e]&&this.listenerList[e].forEach((function(t){try{t.apply(void 0,n)}catch(t){r.logger.error(j.STATE_ACTION+" ",e," ",JSON.stringify(t))}}))},ie.prototype.onListener=function(e,t){return this.listenerList[e]?"function"!=typeof t?(this.logger.error(j.ON_LISTENER+" listener callBack must be funciton"),!1):(-1==this.listenerList[e].indexOf(t)&&this.listenerList[e].push(t),!0):(this.logger.error(j.ON_LISTENER+" event "+e+" no found"),!1)},Object.defineProperty(ie.prototype,"sdKVersion",{get:function(){return this._sdkVersion},set:function(e){this._sdkVersion=e},enumerable:!1,configurable:!0}),ie);function ie(e,t){this.logger=e,this.dataReport=t,this._debug=!1,this.appConfigFetched=!1,this.requestList={},this.mode=T.MODE_ONLINE,this.connectState="connected",this._testEnvironment=!1,this._env=0,this.type="PUBLIC",this.debugCustom=!1,this.configOK=!1,this.role=2,this.relateService=[],this.maxMemberCount=0,this.roomCreateFlag=1,this.local_time_deviation=0,this.callbackList={},this.listenerList={roomUserUpdate:[],roomOnlineUserCountUpdate:[],getAnchorInfo:[],_getAnchorInfo:[],IMRecvCustomCommand:[],IMRecvBroadcastMessage:[],recvReliableMessage:[],roomExtraInfoUpdate:[],IMRecvBarrageMessage:[],recvJoinLiveRequest:[],recvInviteJoinLiveRequest:[],recvEndJoinLiveCommand:[],roomLoginResponse:[],_roomLogin:[],_appConfigRsp:[],_connectChanged:[],HBResponse:[],roomStateUpdate:[],_roomStateUpdate:[],_getTotalUserList:[],_userStateUpdate:[],_recvBigRoomMessage:[],_recvRoomMsg:[],_kickout:[],tokenWillExpire:[],_tokenExpired:[],roomStateChanged:[],hallStateUpdate:[],_hallStateUpdate:[],roomTokenWillExpire:[],_tokenRenewed:[],_protobufResponse:[],_cloudSettingNotify:[],_settingCanFetch:[]},this.reportList={},this.reportSeqList={login:0,relogin:0},this.networkState=o.online,this.roomRetryTime=300,this.roomModulesList=[],this.isMultiRoom=!1,this.setMultiRoom=!1,this.protoFormat="json",this.settingFetched=!1,this.useNetAgent=!0,this.netHasSet=!1,this.configRoomAuth=!1,this.configCheckToken=!1,this._sdkVersion="unknown",this.mode=F.modeNo}se.prototype.init=function(e){var t=this,r=e.body.hearbeat_interval<3e3?3e3:e.body.hearbeat_interval;this.tryHeartbeatCount=0,this.heartbeatTimer&&clearTimeout(this.heartbeatTimer),this.loginHeartbeatTimer=setTimeout((function(){t.start(r)}),r),this.initCount++},se.prototype.start=function(e){var t,r=this,n=(this.logger.info(j.HEARTBEAT_START+" call"),m());this.dataReport.newReport(n,re.kZegoTaskLiveRoomHB.event),this.dataReport.addMsgInfo(n,{room_sid:re.kZegoTaskLiveRoomHB.room_sid(this.room.sessionID)}),this.room.isLogin()?3<++this.tryHeartbeatCount?(this.logger.error(j.HEARTBEAT_START+" come to try limit"),this.dataReport.addMsgInfo(n,{error:re.kZegoTaskLiveRoomHB.error.HB_TIMEOUT.code,message:re.kZegoTaskLiveRoomHB.error.HB_TIMEOUT.msg}),this.dataReport.uploadReport(n),this.hbLogout(A.HEARTBEAT_TIMEOUT)):((this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).heartBeat(t=function(e,t){var i=e.body&&e.body.err_code;e.header&&e.body?0!==i&&(i=x.decodeServerError(e.body.err_code||e.body.code,e.body.err_message||e.body.message),r.dataReport.addMsgInfo(n,{error:i.code,message:i.message+e.body.err_code})):r.dataReport.addMsgInfo(n,{error:(0<e.code?e:A.ROOM_INNER_ERROR).code,message:e.msg||A.ROOM_INNER_ERROR}),r.dataReport.uploadReport(n),r.handleHeartbeatRsp(e,t)},t,this.room),this.heartbeatInterval=e,t=this.heartbeatInterval,2<=this.initCount?(t=Math.round(Math.random()*(this.heartbeatInterval+1)),this.initCount=1):t=this.heartbeatInterval,this.heartbeatTimer=setTimeout((function(){r.start(r.heartbeatInterval)}),t),this.logger.info(j.HEARTBEAT_START+" call success")):(this.logger.error(j.HEARTBEAT_START+" state error"),this.dataReport.addMsgInfo(n,{error:re.kZegoTaskLiveRoomHB.error.NOT_LOGIN.code,message:re.kZegoTaskLiveRoomHB.error.NOT_LOGIN.msg}),this.dataReport.uploadReport(n))},se.prototype.handleHeartbeatRsp=function(e,t){if(e.body&&e.body.err_code&&0!==e.body.err_code)return this.logger.error(j.HEARTBEAT_HEARTBEAT_RSP+" disconnect, server error=",e.body.err_code),1000000152==e.body.err_code?void this.hbLogout(A.HEARTBEAT_TIMEOUT):void this.hbLogout(x.getServerError(e.body.err_code));e.header&&e.body?((this.tryHeartbeatCount=0)!==e.body.hearbeat_interval&&(this.heartbeatInterval=e.body.hearbeat_interval,this.heartbeatInterval<3e3&&(this.heartbeatInterval=3e3)),this.heartbeatRspNotiFy(e),this.logger.info(j.HEARTBEAT_HEARTBEAT_RSP+" call success")):(this.logger.error(j.HEARTBEAT_HEARTBEAT_RSP+" disconnect, error=",JSON.stringify(e)+", seq = "+t),this.hbLogout(e))},se.prototype.heartbeatRspNotiFy=function(e){},se.prototype.hbLogout=function(e){},se.prototype.resetHeartbeat=function(){clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null,clearTimeout(this.loginHeartbeatTimer),this.loginHeartbeatTimer=null,this.tryHeartbeatCount=0,this.initCount=0,this.logger.info(j.HEARTBEAT_RESET+" call success")};var oe=se;function se(e,t,r,n,i,o){this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=n,this.liveRoomHandler=i,this.room=o,this.tryHeartbeatCount=0,this.heartbeatTimer=null,this.loginHeartbeatTimer=null,this.initCount=0}ce.prototype.resetTokenTimer=function(e){var t=this;this.logger.info(j.ROOM_RESETTOKEN_TIMER+"  call: "+(e=2147483647<(e=(e-=3e4)<0?0:e)?2147483647:e)),this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=setTimeout((function(){t.stateCenter.actionListener("tokenWillExpire",t.room.roomID),t.stateCenter.actionListener("roomTokenWillExpire",t.room.roomID)}),e)},ce.prototype.stopTokenTimer=function(){this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=null},ce.prototype.setRunState=function(e){this.room.runState!==e&&(this.room.lastRunState=this.room.runState,this.room.runState=e)},ce.prototype.resetTryLogin=function(){this.tryLoginTimer&&clearTimeout(this.tryLoginTimer),this.tryLoginTimer=null},ce.prototype.resetRoom=function(e){var t=this;this.logger.info(j.ROOM_RESET_ROOM+" call"),1<this.stateCenter.roomModulesList.length&&!e&&(this.room.isMulti=!0),this.resetTryLogin(),"0"===this.room.sessionID||this.room.runState===i.logout||this.room.isDisConnect()||(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).logout(this.room,e=function(e){t.handleLogoutRsp(e,!t.room.isMulti)},e),this.setRunState(i.logout),this.room.sessionID="0",this.room.roomSessionID="0",this.room.isMulti||(this.stateCenter.userid="",this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.sessionID,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),this.stateCenter.useNetAgent?null!=(e=this.liveRoomHandler)&&e.reset():this.service.closeSocket()),this.resetRoomCallBack(),this.stateCenter.roomModulesList=this.stateCenter.roomModulesList.filter((function(e){return e!==t.room})),(e=this.stateCenter.roomModulesList[0])&&(e.isMulti=!1,e.runState!==i.login&&e.roomTryHandler&&(e.roomTryHandler.startMaxTime(),e.roomTryHandler.active())),this.logger.info(j.ROOM_RESET_ROOM+" call success")},ce.prototype.resetRoomCallBack=function(){},ce.prototype.loginSuccessCallBack=function(e,t){},ce.prototype.handlePushKickout=function(e,t,r){var n,o=this;this.logger.info(j.ROOM_KICK_OUT+"  call "+JSON.stringify(e)),r||this.room.sessionID===e.header.session_id||this.room.sessionID===e.body.session_id?(r=m(),this.dataReport.newReport(r,re.kZegoTaskKickout.event),this.dataReport.addMsgInfo(r,{user_id:re.kZegoTaskKickout.user_id(this.stateCenter.idName)}),n=x.getKickoutError(e.body.reason||e.body.kickout_reason,this.stateCenter.useNetAgent),this.dataReport.addMsgInfo(r,{error:n.code,message:n.message}),this.dataReport.uploadReport(r),(r=this.room.roomTryHandler)?(r.onactive=function(e,t){o.disconnectedHandle(t),o.stateCenter.actionListener("_kickout",t)},e.body.need_relogin&&1==e.body.need_relogin?(this.room.sessionID="0",r.startMaxTime(),r.active()):(this.setRunState(i.logout),this.resetRoom(t),r={},e&&e.body.custom_reason?r.custom_kickout_message=e.body.custom_reason:n.name&&A[n.name]&&(t=e.body.reason||e.body.kickout_reason,r.custom_kickout_message=A[n.name].msg+"; kickout reason: "+t),n.name&&A[n.name]?this.disconnectedHandle(A[n.name],{extendedData:JSON.stringify(r),isKickout:!0}):this.disconnectedHandle(A.ROOM_INNER_ERROR,{extendedData:JSON.stringify(r),isKickout:!0}),this.stateCenter.actionListener("_kickout",{code:A.MANUAL_KICKOUT.code,msg:A.MANUAL_KICKOUT.msg+e.body.reason||e.body.kickout_reason}))):this.logger.info(j.ROOM_KICK_OUT+" try handler no found")):this.logger.info(j.ROOM_KICK_OUT+" session id wrong, ignore")},ce.prototype.handleHbLogout=function(e){var t=this,r=this.room.roomTryHandler;r&&(r.onactive=function(e,r){t.disconnectedHandle(r)},[A.HEARTBEAT_TIMEOUT,A.SOCKET_CLOSE].includes(e)||[105,152,2001].includes(null==e?void 0:e.code)||e.msg.endsWith("1000002001")||e.msg.endsWith("1000000152")||e.msg.endsWith("1000000105")?(r.startMaxTime(),r.active()):[A.TIMEOUT].includes(e)?this.logger.warn(j.ROOM_HANDLE_Hb_LOGOUT+" timeout"):(this.logger.warn(j.ROOM_HANDLE_Hb_LOGOUT+" unexpected error: "+JSON.stringify(e)),r.stopMaxTime(),r.invalid(),this.resetRoom(),this.disconnectedHandle(e)))},ce.prototype.onDisconnect=function(e){var t,r=this;this.logger.error(j.ROOM_DISCONNECT+" "+e.msg),"string"==typeof e.code&&"Error.Network"===e.code?this.dataReport.addMsgInfo(this.stateCenter.reportSeqList.relogin,{error:re.kZegoTaskReLoginRoom.error.ROOM_DISCONNECT.code,message:re.kZegoTaskReLoginRoom.error.ROOM_DISCONNECT.msg}):"number"==typeof e.code&&(t=e.code<2e9&&1e9<e.code||e.code<1e6?x.decodeServerError(e.code,e.msg):{code:e.code,message:e.msg})&&this.dataReport.addMsgInfo(this.stateCenter.reportSeqList.relogin,{error:t.code,message:t.message}),this.dataReport.uploadReport(this.stateCenter.reportSeqList.relogin),this.stateCenter.reportSeqList.relogin=0,x.unregisterCallback(re.kZegoTaskReLoginRoom.event,this.stateCenter.reportList),(e=this.room.roomTryHandler)?(e.onactive=function(e,t){t&&0!==t.code?r.roomStateHandle("DISCONNECTED",O.ReconnectFailed,t):r.roomStateHandle("CONNECTED",O.Reconnected,t)},e.startMaxTime(),e.active()):this.logger.error(j.ROOM_DISCONNECT+" try handler no found")},ce.prototype.onConnecting=function(e){this.roomStateHandle("CONNECTING",O.Logining,e)},ce.prototype.disconnectedHandle=function(e,t){var r;e&&0!==e.code?(this.stopTokenTimer(),r=null!=t&&t.isKickout?O.Kickout:O.ReconnectFailed,this.roomStateHandle("DISCONNECTED",r,e,null==t?void 0:t.extendedData)):this.roomStateHandle("CONNECTED",O.Reconnected,e,null==t?void 0:t.extendedData)},ce.prototype.roomStateHandle=function(e,t,r,n,i){var o;t&&t==O.Reconnecting&&(this.reconectTimes++,1==this.reconectTimes)||(this.logger.info(j.ROOM_STATUS_CALLBACK+" "+e+" "+JSON.stringify(r)),["CONNECTED","DISCONNECTED"].includes(e)&&(this.reconectTimes=0),(t=(t=t&&[O.LoginFailed,O.ReconnectFailed].includes(t)?null!=(o=this.room.roomTryHandler)&&o.loginRoomCallback.fail?O.LoginFailed:O.ReconnectFailed:t)&&[O.Logined,O.Reconnected].includes(t)?null!=(o=this.room.roomTryHandler)&&o.loginRoomCallback.success?O.Logined:O.Reconnected:t)&&[O.Logining,O.Reconnecting].includes(t)&&(t=null!=(o=this.room.roomTryHandler)&&o.loginRoomCallback.success?O.Logining:O.Reconnecting),this.room.lastRoomState=this.room.roomState,this.room.roomState=e,this.room.roomState!==this.room.lastRoomState&&(this.stateCenter.actionListener("_roomStateUpdate",this.room.roomID,e,r?r.code:0,n,i),i||(this.stateCenter.actionListener("roomStateUpdate",this.room.roomID,e,r?r.code:0,n),this.stateCenter.actionListener("roomStateChanged",this.room.roomID,t,r?r.code:0,n))))},ce.prototype.login=function(e,t,r,n,o,s,a){this.logger.info(j.ROOM_LOGIN_ROOM+" call:"+t+" "+r),this.room.isMulti||this.logger.setSessionInfo(this.stateCenter.appid,t,"",n.userID,"",this.stateCenter.sdKVersion),o&&(o.userUpdate&&"boolean"==typeof o.userUpdate&&(this.stateCenter.userStateUpdate=o.userUpdate),o.maxMemberCount&&"number"==typeof o.maxMemberCount&&(this.room.maxMemberCount=o.maxMemberCount)),this.stateCenter.configOK?(this.room.runState!==i.trylogin&&this.setRunState(i.trylogin),this.room.roomID=t,this.room.token=r,this.room.thirdToken=r,this.stateCenter.idName=n.userID,this.stateCenter.nickName=n.userName||n.userID,this.loginCallback.success=s,this.loginCallback.fail=a,0===this.stateCenter.reportSeqList.login&&(o=m(),this.stateCenter.reportSeqList.relogin=o,this.dataReport.newReport(o,re.kZegoTaskReLoginRoom.event),this.dataReport.addMsgInfo(o,{server:e}),x.logReportCallback(re.kZegoTaskReLoginRoom.event,this.dataReport,o,this.stateCenter.reportList)),this.resetTryLogin(),this.onConnecting({code:0,msg:""}),this.tryLogin(e),this.logger.info(j.ROOM_LOGIN_ROOM+" call success")):(this.logger.error(j.ROOM_LOGIN_ROOM+" init sdk wrong"),a(A.INIT))},ce.prototype.tryLogin=function(e){var t,r=this;if(this.room.runState!==i.trylogin)this.logger.error("zb.rh.tl state error");else{var n=(0!==this.stateCenter.reportSeqList.login?re.kZegoTaskLoginRoom:re.kZegoTaskReLoginRoom).event;if(this.stateCenter.useNetAgent)this.room.isMulti&&this.room.isDisConnect()?this.logger.warn(j.ROOM_TRY_LOGIN+" liveroom is not connected"):(o=function(e,t){r.handleLoginRsp(e,t)},null!=(t=this.liveRoomHandler)&&t.isUaConnect()?this.liveRoomHandler.login(this.room,o,o):(this.tryLoginTimer=setTimeout((function(){r.logger.info(j.ROOM_TRY_LOGIN+" over time no response, login timeout"),r.loginCallback.fail&&r.loginCallback.fail(re.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT)}),this.tryLoginInterval),this.logger.warn(j.ROOM_TRY_LOGIN+" ua is not connected")));else{if(this.service.isDisConnect())try{this.service.closeSocket(),this.logger.debug(j.ROOM_TRY_LOGIN+" new websocket"),x.actionSuccessCallback(n,this.stateCenter.reportList)&&(1<this.tryLoginCount&&x.actionSuccessCallback(n,this.stateCenter.reportList)("eventEnd",re.kZegoTaskLoginRoom.subEvent.create_socket.event),x.actionSuccessCallback(n,this.stateCenter.reportList)(h,re.kZegoTaskLoginRoom.subEvent.create_socket.event),x.actionSuccessCallback(n,this.stateCenter.reportList)(f,re.kZegoTaskLoginRoom.subEvent.create_socket.event,re.kZegoTaskLoginRoom.subEvent.create_socket.server("server"),e)),this.service.createSocket(e),this.service.openHandler((function(){r.openHandler()})),this.service.closeHandler((function(e){r.logger.error(j.ROOM_TRY_LOGIN+" close "+JSON.stringify(e.code||e)),r.service.closeSocket(),r.closeHandler(e)})),this.service.errorHandler((function(e){r.logger.error(j.ROOM_TRY_LOGIN+" error "+JSON.stringify(e.code||e)),r.service.closeSocket(),r.closeHandler(e)}))}catch(e){this.logger.error(j.ROOM_TRY_LOGIN+"  websocket err:"+JSON.stringify(e))}else{this.logger.info(j.ROOM_TRY_LOGIN+" use current websocket and sent login"),x.actionSuccessCallback(n,this.stateCenter.reportList)&&x.actionSuccessCallback(n,this.stateCenter.reportList)(h,re.kZegoTaskLoginRoom.subEvent.liveroom_login.event);var o=function(e,t){r.handleLoginRsp(e,t)};this.service.login(this.room,o,o)}this.tryLoginTimer=setTimeout((function(){r.logger.info(j.ROOM_TRY_LOGIN+" over time no response, login timeout"),r.loginCallback.fail&&r.loginCallback.fail(re.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT)}),this.tryLoginInterval),this.logger.info(j.ROOM_TRY_LOGIN+" call success")}}},ce.prototype.openHandler=function(){function e(e,r){t.handleLoginRsp(e,r)}var t=this,r=(this.logger.info(j.ROOM_OPEN_HANDLER+" websocket.onpen call"),(0!==this.stateCenter.reportSeqList.login?re.kZegoTaskLoginRoom:re.kZegoTaskReLoginRoom).event);x.actionSuccessCallback(r,this.stateCenter.reportList)&&x.actionSuccessCallback(r,this.stateCenter.reportList)(p,re.kZegoTaskLoginRoom.subEvent.create_socket.event,{try_cnt:this.tryLoginCount}),this.service.onPush(),x.actionSuccessCallback(r,this.stateCenter.reportList)&&x.actionSuccessCallback(r,this.stateCenter.reportList)(h,re.kZegoTaskLoginRoom.subEvent.liveroom_login.event),this.service.login(this.room,e,e)},ce.prototype.handleLoginRsp=function(e,t){this.logger.info(j.ROOM_HANDLE_LOGINRSP+" seq: "+t+" "+JSON.stringify(e));var r=(0!==this.stateCenter.reportSeqList.login?re.kZegoTaskLoginRoom:re.kZegoTaskReLoginRoom).event;x.actionSuccessCallback(r,this.stateCenter.reportList)&&x.actionSuccessCallback(r,this.stateCenter.reportList)(p,re.kZegoTaskLoginRoom.subEvent.liveroom_login.event),this.room.runState!==i.trylogin?this.logger.error(j.ROOM_HANDLE_LOGINRSP+" state error"):e.header&&e.body?e.header.seq!==t&&0==this.room.isMulti?this.logger.error(j.ROOM_HANDLE_LOGINRSP+" in wrong seq, local=",t+"",",recv=",e.header.seq):0!==e.body.err_code?(this.logger.error(j.ROOM_HANDLE_LOGINRSP+" server error=",e.body.err_code),this.handleLoginFail(e)):(this.logger.info(j.ROOM_HANDLE_LOGINRSP+" call success."),this.handleLoginSuccess(e)):(this.logger.error(j.ROOM_HANDLE_LOGINRSP+" "+JSON.stringify(e)),this.handleLoginFail(e))},ce.prototype.handleLoginFail=function(e){this.resetTryLogin();var t=re.kZegoTaskLoginRoom.error.INNER_ERROR;e.header&&e.body?t=x.getServerError(e.body.err_code):e.code&&e.msg&&(t=e),this.loginCallback.fail&&this.loginCallback.fail(t,!0)},ce.prototype.handleLoginSuccess=function(e){var t,r={},n=this.room.lastRunState,o=(this.setRunState(i.login),this.stateCenter.userid=e.body.user_id,this.room.sessionID=e.body.session_id,this.room.roomSessionID=e.body.room_session_id,this.room.lvKey=e.body.lv_key,null==(o=null==e?void 0:e.body)?void 0:o.token_remain_time),s=(this.stateCenter.configRoomAuth=0<o,e.body.ret_timestamp&&["03","04"].includes(this.room.token.substring(0,2))&&(t=(s=(new Date).getTime())-e.body.ret_timestamp,this.stateCenter.local_time_deviation=t<5e3?0:t,t=0<o?1e3*o:1e3*x.decodeTokenExpire(this.room.token.substring(2))-s,this.resetTokenTimer(t-this.stateCenter.local_time_deviation)),this.room.isMulti||this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.sessionID,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),this.stateCenter.useNetAgent||(e.body.config_info&&(o=this.stateCenter.settingConfig.getSetting("remote_log_level",!0)||e.body.config_info.log_level,this.logger.setRemoteLogLevel(o),r.log_level=o,""==e.body.config_info.log_url||this.logger.url||(this.logger.setLogServer(e.body.config_info.log_url),r.log_url=e.body.config_info.log_url)),e.body.cluster_env&&1===e.body.cluster_env&&(this.stateCenter.testEnvironment=!0,r.test_environment="true",this.stateCenter.debugCustom||(this.stateCenter.debug=!0))),(0!==this.stateCenter.reportSeqList.login?re.kZegoTaskLoginRoom:re.kZegoTaskReLoginRoom).event);x.actionSuccessCallback(s,this.stateCenter.reportList)&&x.actionSuccessCallback(s,this.stateCenter.reportList)(f,re.kZegoTaskLoginRoom.subEvent.liveroom_login.event,re.kZegoTaskLoginRoom.subEvent.liveroom_login.respond_info("respond_info"),r),this.resetTryLogin(),this.loginSuccessCallBack(n,e),this.roomStateHandle("CONNECTED",O.Logined,{code:0,msg:""}),this.loginCallback.success&&this.loginCallback.success(!0)},ce.prototype.closeHandler=function(e){this.logger.error(j.ROOM_CLOSEHANDLER+" room websocket close "+JSON.stringify(e.code||e)),this.room.runState!==i.logout?this.room.runState===i.trylogin?(this.resetTryLogin(),this.loginCallback.fail&&this.loginCallback.fail(1006==e.code?re.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT:e)):this.room.runState===i.login&&(this.logger.info(j.ROOM_CLOSEHANDLER+" is called because of network broken"),this.resetTryLogin(),this.onDisconnect(re.kZegoTaskLoginRoom.error.NETWORK_BROKEN)):this.logger.info(j.ROOM_CLOSEHANDLER+" onclose logout flow call websocket.close")},ce.prototype.logout=function(e,t){this.logger.info(j.ROOM_LOGOUT+" call"),this.room.runState===i.logout?this.logger.warn("zb.rh.lo at logout"):(this.resetRoom(e),this.roomStateHandle("DISCONNECTED",O.Logout,{code:0,msg:""},void 0,t),this.stopTokenTimer(),this.logger.info(j.ROOM_LOGOUT+" call success"))},ce.prototype.handleLogoutRsp=function(e,t){this.logger.info(j.ROOM_LOGOUT+" result=",e.body&&e.body.err_code?e.body.err_code:"-1"),this.stateCenter.useNetAgent&&t&&null!=(e=this.liveRoomHandler)&&e.closeRequest()};var ae=ce;function ce(e,t,r,n,i,o){this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=n,this.room=i,this.liveRoomHandler=o,this.tryLoginTimer=null,this.tryLoginCount=0,this.tryLoginInterval=1e4,this.tokenTimer=null,this.beforeExpire=30,this.reconectTimes=0,this.loginCallback={}}var ue=function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},le=(de.prototype.loginRsp=function(e,t){this.anchor_info=e.body.anchor_info||this.anchor_info,this.userListInterval=e.body.userlist_interval||this.userListInterval,this.userListMergeInterval=e.body.userlist_merge_timeout||this.userListMergeInterval,e.body.anchor_info&&(this.stateCenter.actionListener("getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name),this.stateCenter.actionListener("_getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name)),e.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,e.body.online_count),this.logger.info(j.USER_LOGIN_RSP+"  userStateUpdate "+this.stateCenter.userStateUpdate),this.stateCenter.userStateUpdate&&this.fetchUserList(t)},de.prototype.patchUserList=function(e){var t=this;e.body.server_user_seq!==this.userSeq&&this.stateCenter.userStateUpdate&&!this.userSeqMergeMap&&(this.logger.info(j.USER_HB_PATCH+" call update user "+this.userSeq+" server "+e.body.server_user_seq),this.userSeqMergeMap||(this.userSeqMergeMap={}),this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){t.handleMergeTimeout()}),this.userListMergeInterval)),this.minUserSeq=e.body.server_user_seq,null!=e.body.online_count&&0!=e.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,e.body.online_count)},de.prototype.resetUserHandler=function(){this.userQuerying=!1,this.lastUserQueryTime=0,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=void 0,this.userSeqMergeMap={},this.userSeqMergeTimer=void 0,this.userQueryTimer=void 0,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}},de.prototype.fetchUserList=function(e){this.userQuerying?this.logger.warn(j.USER_FETCH_USER+" is already querying"):(this.userQuerying=!0,this.userTempList=[],this.fetchUserListWithPage(0,e||0),this.logger.info(j.USER_FETCH_USER+" the first time call"))},de.prototype.fetchUserListWithPage=function(e,t){function r(e){n.handleFetchUserListRsp(e,t)}var n=this;(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).fetchUserList({user_index:e,sort_type:0},r,r,this.room)},de.prototype.handleFetchUserListRsp=function(e,t){var r=this;if(e.body&&0!=e.body.err_code)this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.logger.info(j.USER_FETCH_USER_RSP+" fetch error "+e.body.err_code);else if(e.header&&e.body){if(this.stateCenter.userStateUpdate){this.userTempList=ue(ue([],this.userTempList),e.body.user_baseinfos);var n=e.body.ret_user_index;if(n!=e.body.server_user_index)this.logger.info(j.USER_FETCH_USER_RSP+" fetch another page"),this.fetchUserListWithPage(n+1,t);else{this.userSeq=e.body.server_user_seq;for(var o=[],s=[],a=0;a<this.userTempList.length;a++){var c={userID:this.userTempList[a].id_name,userName:this.userTempList[a].nick_name,role:this.userTempList[a].role};o.push(c),s.push({idName:this.userTempList[a].id_name,nickName:this.userTempList[a].nick_name,role:this.userTempList[a].role})}this.stateCenter.actionListener("_getTotalUserList",this.room.roomID,s),t==i.login?(this.userList&&x.mergeUserList(this.logger,this.userList,o,(function(e,t){0!==e.length&&r.onUserStateUpdate(r.room.roomID,"ADD",e),0!==t.length&&r.onUserStateUpdate(r.room.roomID,"DELETE",t)})),this.userList=o):0!==(this.userList=o).length&&this.onUserStateUpdate(this.room.roomID,"ADD",o),this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.userTempList=[],this.logger.info(j.USER_FETCH_USER_RSP+" call success user_list "+o+" count "+o.length)}}}else this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.logger.info(j.USER_FETCH_USER_RSP+" fetch error "+e)},de.prototype.handlePushUserStateUpdateMsg=function(e){if(this.logger.info(j.USER_USER_PUSH+" call"),this.stateCenter.userStateUpdate)if(this.userSeq===e.body.user_list_seq)this.logger.warn(j.USER_USER_PUSH+" user_list_seq is the same with local seq");else if(this.userSeq+e.body.user_actions.length!==e.body.user_list_seq)this.mergeUserByUserSeq(e.body.user_list_seq,e.body.user_actions);else{this.userSeq=e.body.user_list_seq;for(var t=[],r=0;r<e.body.user_actions.length;r++){var n={action:e.body.user_actions[r].Action,idName:e.body.user_actions[r].IdName,nickName:e.body.user_actions[r].NickName,role:e.body.user_actions[r].Role,loginTime:e.body.user_actions[r].LoginTime};t.push(n)}this.stateCenter.actionListener("_userStateUpdate",e.body.room_id,t);var i=[],o=[];t.forEach((function(e){1==e.action?i.push({userID:e.idName,userName:e.nickName,role:e.role}):2==e.action&&o.push({userID:e.idName,userName:e.nickName,role:e.role})})),this.userList&&(this.userList=this.userList.concat(i).filter((function(e){return!o.some((function(t){return t.userID==e.userID}))}))),0!==i.length&&this.onUserStateUpdate(e.body.room_id||e.body.room_pushheader.room_id,"ADD",i),0!==o.length&&this.onUserStateUpdate(e.body.room_id||e.body.room_pushheader.room_id,"DELETE",o),this.logger.info(j.USER_USER_PUSH+" call success")}else this.logger.info(j.USER_USER_PUSH+" userStateUpdate is false")},de.prototype.onUserStateUpdate=function(e,t,r){var n=this,i=m();this.dataReport.newReport(i,re.kZegoTaskLiveRoomGetUserUpdateInfo.event),r=r.filter((function(e){return e.userID!==n.stateCenter.idName})),0!=r.length&&(r=r.map((function(e){return{userID:e.userID,userName:e.userName}})),this.stateCenter.actionListener("roomUserUpdate",e,t,r),this.dataReport.addMsgInfo(i,{user_update_type:"ADD"==t?re.kZegoTaskLiveRoomGetUserUpdateInfo.user_update_type("added"):re.kZegoTaskLiveRoomGetUserUpdateInfo.user_update_type("deleted")}),this.dataReport.uploadReport(i))},de.prototype.mergeUserByUserSeq=function(e,t){var r=this;this.userSeqMergeMap||(this.logger.warn(j.USER_MERGE_SEQ+" new merge userlist "+this.userSeq+" server "+e),this.userSeqMergeMap={},this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){r.handleMergeTimeout()}),this.userListMergeInterval)),this.userSeqMergeMap[e]=t,this.logger.warn(j.USER_MERGE_SEQ+"  merge userlist "+this.userSeq+" server "+e+" userlist "+t.length)},de.prototype.mergeUser=function(e){var t=this,r=(this.logger.info(j.USER_MERGE+" merge userlist "+this.userSeq+" userSeqList "+e.join(",")),this.userSeq=e[e.length-1],this.lastUserQueryTime=Date.now()+this.userListInterval,{}),n=((e.forEach((function(e){t.userSeqMergeMap&&t.userSeqMergeMap[e].forEach((function(e){r[e.IdName]=e}))})),this.userSeqMergeMap=null,e=Object.values(r).map((function(e){return{action:e.Action,idName:e.IdName,nickName:e.NickName,role:e.Role,loginTime:e.LoginTime?String(e.LoginTime):""}}))).sort((function(e,t){return e.loginTime.localeCompare(t.loginTime)})),[]),i=[];e.forEach((function(e){1==e.action?n.push({userID:e.idName,userName:e.nickName,role:e.role}):2==e.action&&i.push({userID:e.idName,userName:e.nickName,role:e.role})})),this.userList=this.userList&&this.userList.concat(n).filter((function(e){return!i.some((function(t){return t.userID==e.userID}))})),0!==n.length&&this.onUserStateUpdate(this.room.roomID,"ADD",n),0!==i.length&&this.onUserStateUpdate(this.room.roomID,"DELETE",i),this.stateCenter.actionListener("_userStateUpdate",this.room.roomID,e)},de.prototype.handleMergeTimeout=function(){var e,t=this,r=Object.keys(this.userSeqMergeMap).map((function(e){return+e})).sort((function(e,t){return e-t}));r[r.length-1]-r[0]+1===r.length||r[r.length-1]>=this.minUserSeq?this.mergeUser(r):(this.userSeqMergeMap=null,e=this.lastUserQueryTime-Date.now(),this.logger.info(j.USER_MERGE_TIMEOUT+"  fetch merge userlist "+this.userSeq+" userSeqList "+r.join(",")+" wait "+e),0<e?(this.userQueryTimer&&clearTimeout(this.userQueryTimer),this.userQueryTimer=setTimeout((function(){t.fetchUserList()}),e)):this.fetchUserList())},de.prototype.loginPrivateRsp=function(e){this.logger.info(j.USER_FETCH_USER," userStateUpdate "+this.stateCenter.userStateUpdate),this.stateCenter.userStateUpdate&&this.fetchUserList()},de);function de(e,t,r,n,i,o){this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=n,this.liveRoomHandler=i,this.room=o,this.userQuerying=!1,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=[],this.userSeqMergeMap=null,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}}pe.prototype.initMessageHandler=function(){},pe.prototype.initLiveHandler=function(){},pe.prototype.init=function(){this.bindHeatBeatHandler(),this.bindRoomHandler(),this.bindMessageHandler(),this.bindLiveHandler()},pe.prototype.bindHeatBeatHandler=function(){var e=this;this.heartBeatHandler.hbLogout=function(t){e.roomHandler.handleHbLogout(t)},this.heartBeatHandler.heartbeatRspNotiFy=function(t){e.messageHandler&&e.messageHandler.loginRsp(t),e.userHandler.patchUserList(t),e.HBResponse(t)}},pe.prototype.bindRoomHandler=function(){var e=this;this.roomHandler.loginSuccessCallBack=function(t,r){e.logger.info(j.LIVEROOMMODULES_BINDROOMHANDLER+" login suc "+t),e.heartBeatHandler.init(r),e.stateCenter.useNetAgent?e.liveRoomHandler.startCheck():(e.service.stopCheck(),e.service.startCheck()),e.userHandler.loginRsp(r,t),e.messageHandler&&e.messageHandler.loginRsp(r),e.isMulti||e.handleMultiRoom(),e.roomLoginResponse(r)},this.roomHandler.resetRoomCallBack=function(){e.heartBeatHandler.resetHeartbeat(),e.liveHandler&&e.liveHandler.resetLiveHandler(),e.messageHandler&&e.messageHandler.resetMessageInfo(),e.stateCenter.useNetAgent&&e.liveRoomHandler&&e.liveRoomHandler.stopCheck(),e.userHandler.resetUserHandler(),e.service.stopCheck(),e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.stopMaxTime())}},pe.prototype.bindUserHandler=function(){},pe.prototype.bindMessageHandler=function(){},pe.prototype.bindLiveHandler=function(){},pe.prototype.HBResponse=function(e){this.stateCenter.actionListener("HBResponse",e)},pe.prototype.roomLoginResponse=function(e){this.stateCenter.actionListener("roomLoginResponse",e)},pe.prototype.handleMultiRoom=function(){var e=this;this.stateCenter.roomModulesList.forEach((function(t){t.runState!==i.login&&t.roomTryHandler&&1==t.isMulti&&(t.roomTryHandler.onactive=function(r,n){var i;n&&0!==n.code?(0!==n.code&&(i=x.getLiveRoomError(n.code,e.stateCenter.useNetAgent))&&A[i]&&(n=A[i]),t.roomHandler.roomStateHandle("DISCONNECTED",O.ReconnectFailed,n,n.msg)):t.roomHandler.roomStateHandle("CONNECTED",O.Reconnected,n)},t.roomTryHandler.startMaxTime(),t.roomTryHandler.active())}))},pe.prototype.isLogin=function(){return this.runState===i.login},pe.prototype.isLogout=function(){return this.runState===i.logout},pe.prototype.isTryLogin=function(){return this.runState===i.trylogin},pe.prototype.isDisConnect=function(){return(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).isDisConnect()},pe.prototype.retryConnect=function(){this.logger.info("zm.lrm.rc call"),this.stateCenter.useNetAgent&&(this.resetSessionInfo(),this.liveRoomHandler.closeRequest())},pe.prototype.retryRoom=function(){this.logger.info("zm.lrm.rr.0 call"),this.roomTryHandler&&this.rtm.netAgent.isConnect()&&(this.sessionID="0",this.roomSessionID="0",this.roomTryHandler.active(!0))},pe.prototype.resetSessionInfo=function(){var e;this.logger.info("zm.lrm.rsi call"),this.sessionID="0",this.roomSessionID="0",null!=(e=this.liveRoomHandler)&&e.reset()};var he=pe;function pe(e,t,r,n,o,s,a){this.roomID=e,this.stateCenter=t,this.logger=r,this.dataReport=n,this.service=o,this.rtm=s,this.liveRoomHandler=a,this.runState=i.logout,this.lastRunState=i.logout,this.lastRoomState="DISCONNECTED",this.roomState="DISCONNECTED",this.roomSessionID="0",this.sessionID="0",this.isMulti=!1,this.token="",this.thirdToken="",this.maxMemberCount=0,this.lvKey="",this.roomName="",this.roomHandler=new ae(this.logger,this.stateCenter,this.dataReport,this.service,this,a),this.heartBeatHandler=new oe(this.logger,this.stateCenter,this.dataReport,this.service,this.liveRoomHandler,this),this.userHandler=new le(this.logger,this.stateCenter,this.dataReport,this.service,this.liveRoomHandler,this),this.initMessageHandler(),this.initLiveHandler(),this.init()}ge.prototype.createSocket=function(e){this.socket=Object(c.createZegoWebSocket)(e,this.ENV%2)},ge.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},ge.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},ge.prototype.sendMessage=function(e,t,r,n,i){return void 0===r&&(r=null),void 0===n&&(n=null),void 0===i&&(i={timeOut:6e3}),i={data:t={header:e,body:t},seq:e.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeOut:i.timeOut,success:r,error:n},r=this.sendCommandList.push(i),this.sendCommandMap[i.seq]=r,this.socket&&this.socket.send(JSON.stringify(t)),e.seq},ge.prototype.sendPB=function(e){return this.socket&&this.socket.send(e),!0},ge.prototype.checkSendMessageList=function(e){for(var t=e.getFirst();null!=t;)!function(){var r,n,i;e.remove(t),t&&t._data&&(r=t._data.error,n=t._data.seq,i=t._data.data.body.custom_msg,setTimeout((function(){r&&r(A.TIMEOUT,n,i)}),0)),t=e.getFirst()}()},ge.prototype.checkMessageListTimeout=function(e,t){for(var r=e.getFirst(),n=Date.parse(new Date+""),i=0,o=this;null!=r&&"break"!==function(){return r._data&&r._data.sendTime+r._data.timeOut>n?"break":(r._data&&delete t[r._data.data.header.seq],e.remove(r),r._data&&null==r._data.error||r._data&&r._data.sendTime+o.sendDataDropTimeout<n||r&&r._data&&(s=r._data.error,a=r._data.seq,c=r._data.data.body.custom_msg,setTimeout((function(){s&&s(A.TIMEOUT,a,c)}),0)),++i>=o.sendDataCheckOnceCount?"break":void(r=e.getFirst()));var s,a,c}(););},ge.prototype.startCheck=function(){var e=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){e.startCheck()}),this.sendDataCheckInterval)},ge.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),this.sendCommandMap={},clearTimeout(this.sendDataCheckTimer)},ge.prototype.openHandler=function(e){var t=this;this.socket&&(this.socket.onopen=function(r){t.socket.binaryType="arraybuffer",t.responseHandler(),e(r)})},ge.prototype.responseHandler=function(){var e=this;this.socket&&(this.socket.onmessage=function(t){t="string"==typeof t.data?JSON.parse(t.data):t.data,e.onMessage(t)})},ge.prototype.closeHandler=function(e){this.socket&&(this.socket.onclose=function(t){e(t)})},ge.prototype.errorHandler=function(e){this.socket&&(this.socket.onerror=e)},ge.prototype.onMessage=function(e){};var fe=ge;function ge(e){this.socket=null,this.sendCommandList=new y,this.sendCommandMap={},this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=1e4,this.sendDataCheckInterval=2e3,this.ENV=e}var me=function(){return(me=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},_e=(ve.prototype.checkResponse=function(e){return 0!=this.stateCenter.roomModulesList.filter((function(e){return e.runState!==i.logout})).length&&(e.header.appid!==this.stateCenter.appid||e.header.user_id!==this.stateCenter.userid)},ve.prototype.handleSendCommandMsgRsp=function(e){var t,r=this,n=this.service.sendCommandMap[e.header.seq];null!=n&&(t=n._data,delete this.service.sendCommandMap[e.header.seq],this.service.sendCommandList.remove(n),0===e.body.err_code?setTimeout((function(){t&&null!=t.success&&t.success(e,r.cmdSeq)}),0):setTimeout((function(){t&&null!=t.error&&t.error(e,r.cmdSeq)}),0))},ve.prototype.onPush=function(){var e=this;this.service.onMessage=function(t){t instanceof ArrayBuffer?e.stateCenter.actionListener("_protobufResponse",t):t.header?(0!==t.body.err_code?t.body.err_message&&e.logger.error(j.SERVICE_PUSH+" cmd="+t.header.cmd+", err_code="+t.body.err_code+", err_message="+t.body.err_message+" "):e.logger.info(j.SERVICE_PUSH+" cmd="+t.header.cmd+", msg="+JSON.stringify(t)+" "),-1<["login","logout"].indexOf(t.header.cmd)?e.handleSendCommandMsgRsp(t):e.checkResponse(t)?e.logger.error(j.SERVICE_PUSH+"  check session fail."):(e.logger.info(j.SERVICE_PUSH+" cmd="+t.header.cmd+",function="+!!e.responseRouters[t.header.cmd]),e.handleSendCommandMsgRsp(t),e.responseRouters[t.header.cmd]&&e.responseRouters[t.header.cmd](t,e.cmdSeq))):e.logger.error(j.SERVICE_PUSH+" msg type error ")}},ve.prototype.handlePushKickout=function(e){var t,r;void 0===(null==(r=null==e?void 0:e.body)?void 0:r.protocol)||1===(null==(r=null==e?void 0:e.body)?void 0:r.protocol)?function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e}([],this.stateCenter.roomModulesList).forEach((function(t){return t.roomHandler.handlePushKickout(e,!0)})):(t=null==(r=null==e?void 0:e.header)?void 0:r.room_id,(r=this.stateCenter.roomModulesList.find((function(e){return e.roomID==t})))?r.roomHandler.handlePushKickout(e):this.logger.error(j.SERVICE_PUSH+" room no found ignore "+JSON.stringify(null==(r=e.header)?void 0:r.room_id)))},ve.prototype.handlePushCustomMsg=function(e){},ve.prototype.handlePushRoomMsg=function(e){},ve.prototype.handlePushUserStateUpdateMsg=function(e){var t=null==(r=null==e?void 0:e.header)?void 0:r.room_id,r=this.stateCenter.roomModulesList.find((function(e){return e.roomID==t}));r?r.userHandler.handlePushUserStateUpdateMsg(e):this.logger.error(j.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))},ve.prototype.handlePushMergeMsg=function(e){},ve.prototype.handlePushTransMsg=function(e){},ve.prototype.handleBigImMsgRsp=function(e){},ve.prototype.handlePushSignalMsg=function(e){},ve.prototype.handlePushTokenExpire=function(e){this.stateCenter.actionListener("_tokenExpired",e)},ve.prototype.closeHandler=function(e){this.service.closeHandler(e)},ve.prototype.openHandler=function(e){this.service.openHandler(e)},ve.prototype.errorHandler=function(e){this.service.errorHandler(e)},ve.prototype.getHeader=function(e,t,r,n){return{Protocol:"req",cmd:e,appid:this.stateCenter.appid,seq:++this.cmdSeq,user_id:this.stateCenter.userid,session_id:t||"",room_id:r||"",room_session_id:n||"",biz_version:this.stateCenter.bizVersion||""}},ve.prototype.startCheck=function(){this.logger.info(j.SERVICE_START_CHECK+" start"),this.service.startCheck()},ve.prototype.stopCheck=function(){this.logger.info(j.SERVICE_STOP_CHECK+" stop"),this.service.stopCheck()},ve.prototype.isDisConnect=function(){return!this.service||this.service.isDisConnect()},ve.prototype.createSocket=function(e){var t=this;this.service.createSocket(e),this.responseRouters=me(me({},this.responseRouters),{push_kickout:function(e){t.handlePushKickout(e)},push_custommsg:function(e){t.handlePushCustomMsg(e)},push_im_chat:function(e){t.handlePushRoomMsg(e)},push_userlist_update:function(e){t.handlePushUserStateUpdateMsg(e)},push_merge_message:function(e){t.handlePushMergeMsg(e)},push_trans:function(e){t.handlePushTransMsg(e)},push_signal:function(e){t.handlePushSignalMsg(e)},push_token_expire:function(e){t.handlePushTokenExpire(e)}})},ve.prototype.closeSocket=function(){this.service.closeSocket()},ve.prototype.sendMessage=function(e,t,r,n,i,o){var s,a;return this.service.isDisConnect()?(this.logger.error(j.SERVICE_SEND+" socket is disconnect"),n(A.SOCKET_CLOSE),0):(s=null!=o&&o.roomID?o.roomID:null==(s=this.stateCenter.roomModulesList[0])?void 0:s.roomID,a=null!=o&&o.roomSessionID?o.roomSessionID:null==(a=this.stateCenter.roomModulesList[0])?void 0:a.roomSessionID,o=null!=o&&o.sessionID?o.sessionID:null==(o=this.stateCenter.roomModulesList[0])?void 0:o.sessionID,i=i||this.getHeader(e,o,s,a),this.logger.info(j.SERVICE_SEND+" sendMsg:"+JSON.stringify({header:i,body:t})),this.service.sendMessage(i,t,r,n))},ve.prototype.on=function(e,t){this.responseRouters[e]=t},ve.prototype.login=function(e,t,r){var n=this.getHeader(e.isMulti?"enter":"login",e.sessionID,e.roomID,e.roomSessionID);return e={id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,role:this.stateCenter.role,token:e.token,version:this.stateCenter.sdKVersion,room_name:e.roomID,user_state_flag:this.stateCenter.userStateUpdate?1:0,room_create_flag:this.stateCenter.roomCreateFlag,client_type:0===this.stateCenter.ENV?a.ClientType_Webrtc:a.ClientType_SmallProgram,third_token:e.thirdToken,user_count_limit:e.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",login_logic:this.stateCenter.isMultiRoom?3:1,proto_format:this.stateCenter.protoFormat},this.sendMessage("",e,t,r,n)},ve.prototype.logout=function(e,t,r){var n=e.isMulti?"quit":"logout",i={reserve:0};return"logout"==n&&(i.login_logic=this.stateCenter.isMultiRoom?3:1),this.sendMessage(n,i,t,r,void 0,{sessionID:e.sessionID,roomID:e.roomID,roomSessionID:e.roomSessionID})},ve.prototype.heartBeat=function(e,t,r){return this.sendMessage("hb",{reserve:0},e,t,void 0,r)},ve.prototype.fetchUserList=function(e,t,r,n){return this.sendMessage("user_list",e,t,r,void 0,n)},ve.prototype.fetchUserListV2=function(e,t,r,n){return this.sendMessage("user_list_v2",e,t,r,void 0,n)},ve.prototype.fetchReliableMessage=function(e,t,r,n){return this.sendMessage("trans_fetch",e,t,r,void 0,n)},ve.prototype.sendReliableMessage=function(e,t,r,n){return this.sendMessage("trans",e,t,r,void 0,n)},ve.prototype.sendRoomMsg=function(e,t,r,n){return this.sendMessage("im_chat",e,t,r,void 0,n)},ve.prototype.sendCustomCommand=function(e,t,r,n){return this.sendMessage("custommsg",e,t,r,void 0,n)},ve.prototype.sendBigRoomMessage=function(e,t,r,n){return this.sendMessage("bigim_chat",e,t,r,void 0,n)},ve.prototype.sendRelayMessage=function(e,t,r,n){return this.sendMessage("relay",e,t,r,void 0,n)},ve.prototype.sendSignalCmd=function(e,t,r,n){return this.sendMessage("signal",e,t,r,void 0,n)},ve.prototype.sendPB=function(e){return this.service.isDisConnect()||this.stateCenter.networkState==o.offline?(this.logger.error(j.RTM_SEND_PB+" socket is disconnected"),!1):this.service.sendPB(e)},ve);function ve(e,t,r){this.stateCenter=e,this.logger=t,this.rtm=r,this.service=new fe(this.stateCenter.ENV),this.cmdSeq=0,this.responseRouters={}}Ee.getInstance=function(){return Ee.instance=Ee.instance?Ee.instance:new Ee},Ee.prototype.setSetting=function(e,t){var r,n,i=Array.isArray(t)&&0<t.length;for(r in e)if("number"==typeof e[r].ctrlmode&&[1,2].includes(e[r].ctrlmode))this.setting[r]=e[r],this.setting[r+"_ctrlmode"]=e[r].ctrlmode;else for(var o in e[r])o.endsWith("_ctrlmode")||i&&-1==t.indexOf(o)||(1===(n=e[r][o+"_ctrlmode"])||2===n?this.setting[o]=e[r][o]:this.defaultSetting[o]&&(this.setting[o]=this.defaultSetting[o]),"number"==typeof n&&(this.setting[o+"_ctrlmode"]=e[r][o+"_ctrlmode"]))},Ee.prototype.getSetting=function(e,t){return(t=void 0!==t&&t)&&2!=this.setting[e+"_ctrlmode"]?void 0:this.setting[e]};var ye=Ee;function Ee(){this.defaultSetting={remote_log_level:"info"},this.requestList={},this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}var Se=r(0),be=r.n(Se),Te=(t=r(6),r(8)),Ce=r.n(Te),Re=(Te=r(9),r.n(Te)),Oe=(Te=r(14),r.n(Te)),ke=(Te=r(4),r.n(Te)),Ie={d:function(e,t){for(var r in t)Ie.o(t,r)&&!Ie.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},Le=(function(e,t,r){function n(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function i(e,t){return e&t}function o(e,t){return e|t}function s(e,t){return e^t}function a(e,t){return e&~t}r.d(t,{default:function(){return oe}});var c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function l(e){for(var t,r="",n=0;n+3<=e.length;n+=3)t=parseInt(e.substring(n,n+3),16),r+=u.charAt(t>>6)+u.charAt(63&t);for(n+1==e.length?(t=parseInt(e.substring(n,n+1),16),r+=u.charAt(t<<2)):n+2==e.length&&(t=parseInt(e.substring(n,n+2),16),r+=u.charAt(t>>2)+u.charAt((3&t)<<4));0<(3&r.length);)r+="=";return r}function d(e){for(var t="",r=0,i=0,o=0;o<e.length&&"="!=e.charAt(o);++o){var s=u.indexOf(e.charAt(o));s<0||(r=0==r?(t+=n(s>>2),i=3&s,1):1==r?(t+=n(i<<2|s>>4),i=15&s,2):2==r?(t=(t+=n(i))+n(s>>2),i=3&s,3):(t=(t+=n(i<<2|s>>4))+n(15&s),0))}return 1==r&&(t+=n(i<<2)),t}var h,p={decode:function(e){if(void 0===h){var t="= \f\n\r\t\xa0\u2028\u2029";for(h=Object.create(null),o=0;o<64;++o)h["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o)]=o;for(h["-"]=62,h._=63,o=0;o<t.length;++o)h[t.charAt(o)]=-1}for(var r=[],n=0,i=0,o=0;o<e.length;++o){var s=e.charAt(o);if("="==s)break;if(-1!=(s=h[s])){if(void 0===s)throw new Error("Illegal character at offset "+o);n|=s,4<=++i?(r[r.length]=n>>16,r[r.length]=n>>8&255,r[r.length]=255&n,i=n=0):n<<=6}}switch(i){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:r[r.length]=n>>10;break;case 3:r[r.length]=n>>16,r[r.length]=n>>8&255}return r},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(e){var t=p.re.exec(e);if(t)if(t[1])e=t[1];else{if(!t[2])throw new Error("RegExp out of sync");e=t[2]}return p.decode(e)}},f=(_.prototype.mulAdd=function(e,t){for(var r,n=this.buf,i=n.length,o=0;o<i;++o)(r=n[o]*e+t)<1e13?t=0:r-=1e13*(t=0|r/1e13),n[o]=r;0<t&&(n[o]=t)},_.prototype.sub=function(e){for(var t,r=this.buf,n=r.length,i=0;i<n;++i)e=(t=r[i]-e)<0?(t+=1e13,1):0,r[i]=t;for(;0===r[r.length-1];)r.pop()},_.prototype.toString=function(e){if(10!=(e||10))throw new Error("only base 10 is supported");for(var t=this.buf,r=t[t.length-1].toString(),n=t.length-2;0<=n;--n)r+=(1e13+t[n]).toString().substring(1);return r},_.prototype.valueOf=function(){for(var e=this.buf,t=0,r=e.length-1;0<=r;--r)t=1e13*t+e[r];return t},_.prototype.simplify=function(){var e=this.buf;return 1==e.length?e[0]:this},_),g=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,m=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function _(e){this.buf=[+e||0]}function v(e,t){return e.length>t?e.substring(0,t)+"\u2026":e}U.prototype.get=function(e){if((e=void 0===e?this.pos++:e)>=this.enc.length)throw new Error("Requesting byte offset "+e+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(e):this.enc[e]},U.prototype.hexByte=function(e){return this.hexDigits.charAt(e>>4&15)+this.hexDigits.charAt(15&e)},U.prototype.hexDump=function(e,t,r){for(var n="",i=e;i<t;++i)if(n+=this.hexByte(this.get(i)),!0!==r)switch(15&i){case 7:n+="  ";break;case 15:n+="\n";break;default:n+=" "}return n},U.prototype.isASCII=function(e,t){for(var r=e;r<t;++r){var n=this.get(r);if(n<32||176<n)return!1}return!0},U.prototype.parseStringISO=function(e,t){for(var r="",n=e;n<t;++n)r+=String.fromCharCode(this.get(n));return r},U.prototype.parseStringUTF=function(e,t){for(var r="",n=e;n<t;){var i=this.get(n++);r+=i<128?String.fromCharCode(i):191<i&&i<224?String.fromCharCode((31&i)<<6|63&this.get(n++)):String.fromCharCode((15&i)<<12|(63&this.get(n++))<<6|63&this.get(n++))}return r},U.prototype.parseStringBMP=function(e,t){for(var r,n,i="",o=e;o<t;)r=this.get(o++),n=this.get(o++),i+=String.fromCharCode(r<<8|n);return i},U.prototype.parseTime=function(e,t,r){return e=this.parseStringISO(e,t),(t=(r?g:m).exec(e))?(r&&(t[1]=+t[1],t[1]+=+t[1]<70?2e3:1900),e=t[1]+"-"+t[2]+"-"+t[3]+" "+t[4],t[5]&&(e+=":"+t[5],t[6]&&(e+=":"+t[6],t[7]&&(e+="."+t[7]))),t[8]&&(e+=" UTC","Z"!=t[8]&&(e+=t[8],t[9]&&(e+=":"+t[9]))),e):"Unrecognized time: "+e},U.prototype.parseInteger=function(e,t){for(var r,n=this.get(e),i=127<n,o=i?255:0,s="";n==o&&++e<t;)n=this.get(e);if(0==(r=t-e))return i?-1:0;if(4<r){for(s=n,r<<=3;0==(128&(+s^o));)s=+s<<1,--r;s="("+r+" bit)\n"}i&&(n-=256);for(var a=new f(n),c=e+1;c<t;++c)a.mulAdd(256,this.get(c));return s+a.toString()},U.prototype.parseBitString=function(e,t,r){for(var n=this.get(e),i="("+((t-e-1<<3)-n)+" bit)\n",o="",s=e+1;s<t;++s){for(var a=this.get(s),c=s==t-1?n:0,u=7;c<=u;--u)o+=a>>u&1?"1":"0";if(o.length>r)return i+v(o,r)}return i+o},U.prototype.parseOctetString=function(e,t,r){if(this.isASCII(e,t))return v(this.parseStringISO(e,t),r);var n=t-e,i="("+n+" byte)\n";n>(r/=2)&&(t=e+r);for(var o=e;o<t;++o)i+=this.hexByte(this.get(o));return r<n&&(i+="\u2026"),i},U.prototype.parseOID=function(e,t,r){for(var n="",i=new f,o=0,s=e;s<t;++s){var a=this.get(s);if(i.mulAdd(128,127&a),o+=7,!(128&a)){if(""===n?n=(i=i.simplify())instanceof f?(i.sub(80),"2."+i.toString()):(a=i<80?i<40?0:1:2)+"."+(i-40*a):n+="."+i.toString(),n.length>r)return v(n,r);i=new f,o=0}}return 0<o&&(n+=".incomplete"),n};var y=U,E=(D.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},D.prototype.content=function(e){if(void 0!==this.tag){void 0===e&&(e=1/0);var t=this.posContent(),r=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+r,e);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(t)?"false":"true";case 2:return this.stream.parseInteger(t,t+r);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(t,t+r,e);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+r,e);case 6:return this.stream.parseOID(t,t+r,e);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return v(this.stream.parseStringUTF(t,t+r),e);case 18:case 19:case 20:case 21:case 22:case 26:return v(this.stream.parseStringISO(t,t+r),e);case 30:return v(this.stream.parseStringBMP(t,t+r),e);case 23:case 24:return this.stream.parseTime(t,t+r,23==this.tag.tagNumber)}}return null},D.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},D.prototype.toPrettyString=function(e){var t=(e=void 0===e?"":e)+this.typeName()+" @"+this.stream.pos;if(0<=this.length&&(t+="+"),t+=this.length,this.tag.tagConstructed?t+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(t+=" (encapsulates)"),t+="\n",null!==this.sub){e+="  ";for(var r=0,n=this.sub.length;r<n;++r)t+=this.sub[r].toPrettyString(e)}return t},D.prototype.posStart=function(){return this.stream.pos},D.prototype.posContent=function(){return this.stream.pos+this.header},D.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},D.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},D.decodeLength=function(e){var t=127&(r=e.get());if(t==r)return t;if(6<t)throw new Error("Length over 48 bits not supported at position "+(e.pos-1));if(0==t)return null;for(var r=0,n=0;n<t;++n)r=256*r+e.get();return r},D.prototype.getHexStringValue=function(){var e=this.toHexString(),t=2*this.header,r=2*this.length;return e.substr(t,r)},D.decode=function(e){function t(){var e=[];if(null!==i){for(var t=o+i;r.pos<t;)e[e.length]=D.decode(r);if(r.pos!=t)throw new Error("Content size is not correct for container starting at offset "+o)}else try{for(;;){var n=D.decode(r);if(n.tag.isEOC())break;e[e.length]=n}i=o-r.pos}catch(e){throw new Error("Exception while decoding undefined length content: "+e)}return e}var r=e instanceof y?e:new y(e,0),n=(e=new y(r),new S(r)),i=D.decodeLength(r),o=r.pos,s=o-e.pos,a=null;if(n.tagConstructed)a=t();else if(n.isUniversal()&&(3==n.tagNumber||4==n.tagNumber))try{if(3==n.tagNumber&&0!=r.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");a=t();for(var c=0;c<a.length;++c)if(a[c].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(e){a=null}if(null===a){if(null===i)throw new Error("We can't skip over an invalid tag with undefined length at offset "+o);r.pos=o+Math.abs(i)}return new D(e,s,i,n,a)},D),S=(M.prototype.isUniversal=function(){return 0===this.tagClass},M.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},M),b=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],T=(1<<26)/b[b.length-1],C=(P.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,i=(1<<t)-1,o=!1,s="",a=this.t,c=this.DB-a*this.DB%t;if(0<a--)for(c<this.DB&&0<(r=this[a]>>c)&&(o=!0,s=n(r));0<=a;)c<t?(r=(this[a]&(1<<c)-1)<<t-c,r|=this[--a]>>(c+=this.DB-t)):(r=this[a]>>(c-=t)&i,c<=0&&(c+=this.DB,--a)),(o=0<r||o)&&(s+=n(r));return o?s:"0"},P.prototype.negate=function(){var e=x();return P.ZERO.subTo(this,e),e},P.prototype.abs=function(){return this.s<0?this.negate():this},P.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;0<=--r;)if(0!=(t=this[r]-e[r]))return t;return 0},P.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+V(this[this.t-1]^this.s&this.DM)},P.prototype.mod=function(e){var t=x();return this.abs().divRemTo(e,null,t),this.s<0&&0<t.compareTo(P.ZERO)&&e.subTo(t,t),t},P.prototype.modPowInt=function(e,t){return t=new(e<256||t.isEven()?O:k)(t),this.exp(e,t)},P.prototype.clone=function(){var e=x();return this.copyTo(e),e},P.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},P.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},P.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},P.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},P.prototype.toByteArray=function(){var e=this.t,t=[];t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(0<e--)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);0<=e;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(0<i||r!=this.s)&&(t[i++]=r);return t},P.prototype.equals=function(e){return 0==this.compareTo(e)},P.prototype.min=function(e){return this.compareTo(e)<0?this:e},P.prototype.max=function(e){return 0<this.compareTo(e)?this:e},P.prototype.and=function(e){var t=x();return this.bitwiseTo(e,i,t),t},P.prototype.or=function(e){var t=x();return this.bitwiseTo(e,o,t),t},P.prototype.xor=function(e){var t=x();return this.bitwiseTo(e,s,t),t},P.prototype.andNot=function(e){var t=x();return this.bitwiseTo(e,a,t),t},P.prototype.not=function(){for(var e=x(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},P.prototype.shiftLeft=function(e){var t=x();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},P.prototype.shiftRight=function(e){var t=x();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},P.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+function(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}(this[e]);return this.s<0?this.t*this.DB:-1},P.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=function(e){for(var t=0;0!=e;)e&=e-1,++t;return t}(this[r]^t);return e},P.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},P.prototype.setBit=function(e){return this.changeBit(e,o)},P.prototype.clearBit=function(e){return this.changeBit(e,a)},P.prototype.flipBit=function(e){return this.changeBit(e,s)},P.prototype.add=function(e){var t=x();return this.addTo(e,t),t},P.prototype.subtract=function(e){var t=x();return this.subTo(e,t),t},P.prototype.multiply=function(e){var t=x();return this.multiplyTo(e,t),t},P.prototype.divide=function(e){var t=x();return this.divRemTo(e,t,null),t},P.prototype.remainder=function(e){var t=x();return this.divRemTo(e,null,t),t},P.prototype.divideAndRemainder=function(e){var t=x(),r=x();return this.divRemTo(e,t,r),[t,r]},P.prototype.modPow=function(e,t){var r=e.bitLength(),n=q(1);if(r<=0)return n;var i=r<18?1:r<48?3:r<144?4:r<768?5:6,o=new(r<8?O:t.isEven()?I:k)(t),s=[],a=3,c=i-1,u=(1<<i)-1;if(s[1]=o.convert(this),1<i){var l=x();for(o.sqrTo(s[1],l);a<=u;)s[a]=x(),o.mulTo(l,s[a-2],s[a]),a+=2}var d,h,p=e.t-1,f=!0,g=x();for(r=V(e[p])-1;0<=p;){for(c<=r?d=e[p]>>r-c&u:(d=(e[p]&(1<<r+1)-1)<<c-r,0<p&&(d|=e[p-1]>>this.DB+r-c)),a=i;0==(1&d);)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--p),f)s[d].copyTo(n),f=!1;else{for(;1<a;)o.sqrTo(n,g),o.sqrTo(g,n),a-=2;0<a?o.sqrTo(n,g):(h=n,n=g,g=h),o.mulTo(g,s[d],n)}for(;0<=p&&0==(e[p]&1<<r);)o.sqrTo(n,g),h=n,n=g,g=h,--r<0&&(r=this.DB-1,--p)}return o.revert(n)},P.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return P.ZERO;for(var r=e.clone(),n=this.clone(),i=q(1),o=q(0),s=q(0),a=q(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);0<=r.compareTo(n)?(r.subTo(n,r),t&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),t&&s.subTo(i,s),a.subTo(o,a))}return 0!=n.compareTo(P.ONE)?P.ZERO:0<=a.compareTo(e)?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a},P.prototype.pow=function(e){return this.exp(e,new R)},P.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone(),n=(t.compareTo(r)<0&&(e=t,t=r,r=e),t.getLowestSetBit());if((e=r.getLowestSetBit())<0)return t;for(0<(e=n<e?n:e)&&(t.rShiftTo(e,t),r.rShiftTo(e,r));0<t.signum();)0<(n=t.getLowestSetBit())&&t.rShiftTo(n,t),0<(n=r.getLowestSetBit())&&r.rShiftTo(n,r),0<=t.compareTo(r)?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return 0<e&&r.lShiftTo(e,r),r},P.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=b[b.length-1]){for(t=0;t<b.length;++t)if(r[0]==b[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<b.length;){for(var n=b[t],i=t+1;i<b.length&&n<T;)n*=b[i++];for(n=r.modInt(n);t<i;)if(n%b[t++]==0)return!1}return r.millerRabin(e)},P.prototype.copyTo=function(e){for(var t=this.t-1;0<=t;--t)e[t]=this[t];e.t=this.t,e.s=this.s},P.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,0<e?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},P.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;0<=--n;){var s=8==r?255&+e[n]:z(e,n);s<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==o?this[this.t++]=s:o+r>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&+e[0])&&(this.s=-1,0<o&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&P.ZERO.subTo(this,this)},P.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t},P.prototype.dlShiftTo=function(e,t){for(var r=this.t-1;0<=r;--r)t[r+e]=this[r];for(r=e-1;0<=r;--r)t[r]=0;t.t=this.t+e,t.s=this.s},P.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},P.prototype.lShiftTo=function(e,t){for(var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(e/this.DB),s=this.s<<r&this.DM,a=this.t-1;0<=a;--a)t[a+o+1]=this[a]>>n|s,s=(this[a]&i)<<r;for(a=o-1;0<=a;--a)t[a]=0;t[o]=s,t.t=this.t+o+1,t.s=this.s,t.clamp()},P.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&o)<<i,t[s-r]=this[s]>>n;0<n&&(t[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},P.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:0<n&&(t[r++]=n),t.t=r,t.clamp()},P.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;0<=--i;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&P.ZERO.subTo(t,t)},P.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;0<=--r;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}0<e.t&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},P.prototype.divRemTo=function(e,t,r){if(!((u=e.abs()).t<=0)){var n=this.abs();if(n.t<u.t)null!=t&&t.fromInt(0),null!=r&&this.copyTo(r);else{null==r&&(r=x());var i=x(),o=this.s,s=(e=e.s,this.DB-V(u[u.t-1])),a=(0<s?(u.lShiftTo(s,i),n.lShiftTo(s,r)):(u.copyTo(i),n.copyTo(r)),i.t),c=i[a-1];if(0!=c){var u=c*(1<<this.F1)+(1<a?i[a-2]>>this.F2:0),l=this.FV/u,d=(1<<this.F1)/u,h=1<<this.F2,p=r.t,f=p-a,g=null==t?x():t;for(i.dlShiftTo(f,g),0<=r.compareTo(g)&&(r[r.t++]=1,r.subTo(g,r)),P.ONE.dlShiftTo(a,g),g.subTo(i,i);i.t<a;)i[i.t++]=0;for(;0<=--f;){var m=r[--p]==c?this.DM:Math.floor(r[p]*l+(r[p-1]+h)*d);if((r[p]+=i.am(0,m,r,f,0,a))<m)for(i.dlShiftTo(f,g),r.subTo(g,r);r[p]<--m;)r.subTo(g,r)}null!=t&&(r.drShiftTo(a,t),o!=e&&P.ZERO.subTo(t,t)),r.t=a,r.clamp(),0<s&&r.rShiftTo(s,r),o<0&&P.ZERO.subTo(r,r)}}}},P.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return 0<(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)?this.DV-t:-t},P.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},P.prototype.exp=function(e,t){if(4294967295<e||e<1)return P.ONE;var r,n=x(),i=x(),o=t.convert(this),s=V(e)-1;for(o.copyTo(n);0<=--s;)t.sqrTo(n,i),0<(e&1<<s)?t.mulTo(i,o,n):(r=n,n=i,i=r);return t.revert(n)},P.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},P.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||36<e)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=q(r),i=x(),o=x(),s="";for(this.divRemTo(n,i,o);0<i.signum();)s=(r+o.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(e)+s},P.prototype.fromRadix=function(e,t){this.fromInt(0);for(var r=this.chunkSize(t=null==t?10:t),n=Math.pow(t,r),i=!1,o=0,s=0,a=0;a<e.length;++a){var c=z(e,a);c<0?"-"==e.charAt(a)&&0==this.signum()&&(i=!0):(s=t*s+c,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),s=o=0))}0<o&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),i&&P.ZERO.subTo(this,this)},P.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(P.ONE.shiftLeft(e-1),o,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(P.ONE.shiftLeft(e-1),this);else{var n=7&e;(r=[]).length=1+(e>>3),t.nextBytes(r),0<n?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}},P.prototype.bitwiseTo=function(e,t,r){for(var n,i=Math.min(e.t,this.t),o=0;o<i;++o)r[o]=t(this[o],e[o]);if(e.t<this.t){for(n=e.s&this.DM,o=i;o<this.t;++o)r[o]=t(this[o],n);r.t=this.t}else{for(n=this.s&this.DM,o=i;o<e.t;++o)r[o]=t(n,e[o]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},P.prototype.changeBit=function(e,t){return e=P.ONE.shiftLeft(e),this.bitwiseTo(e,t,e),e},P.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,0<n?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},P.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},P.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},P.prototype.multiplyLowerTo=function(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;0<n;)r[--n]=0;for(var i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()},P.prototype.multiplyUpperTo=function(e,t,r){var n=r.t=this.t+e.t- --t;for(r.s=0;0<=--n;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},P.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(0<this.t)if(0==t)r=this[0]%e;else for(var n=this.t-1;0<=n;--n)r=(t*r+this[n])%e;return r},P.prototype.millerRabin=function(e){var t=this.subtract(P.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>b.length&&(e=b.length);for(var i=x(),o=0;o<e;++o){i.fromInt(b[Math.floor(Math.random()*b.length)]);var s=i.modPow(n,this);if(0!=s.compareTo(P.ONE)&&0!=s.compareTo(t)){for(var a=1;a++<r&&0!=s.compareTo(t);)if(0==(s=s.modPowInt(2,this)).compareTo(P.ONE))return!1;if(0!=s.compareTo(t))return!1}}return!0},P.prototype.square=function(){var e=x();return this.squareTo(e),e},P.prototype.gcda=function(e,t){var r,n=this.s<0?this.negate():this.clone(),i=e.s<0?e.negate():e.clone(),o=(n.compareTo(i)<0&&(e=n,n=i,i=e),n.getLowestSetBit()),s=i.getLowestSetBit();s<0?t(n):(0<(s=o<s?o:s)&&(n.rShiftTo(s,n),i.rShiftTo(s,i)),r=function(){0<(o=n.getLowestSetBit())&&n.rShiftTo(o,n),0<(o=i.getLowestSetBit())&&i.rShiftTo(o,i),0<=n.compareTo(i)?(n.subTo(i,n),n.rShiftTo(1,n)):(i.subTo(n,i),i.rShiftTo(1,i)),0<n.signum()?setTimeout(r,0):(0<s&&i.lShiftTo(s,i),setTimeout((function(){t(i)}),0))},setTimeout(r,10))},P.prototype.fromNumberAsync=function(e,t,r,n){var i,s,a;"number"==typeof t?e<2?this.fromInt(1):(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(P.ONE.shiftLeft(e-1),o,this),this.isEven()&&this.dAddOffset(1,0),i=this,s=function(){i.dAddOffset(2,0),i.bitLength()>e&&i.subTo(P.ONE.shiftLeft(e-1),i),i.isProbablePrime(t)?setTimeout((function(){n()}),0):setTimeout(s,0)},setTimeout(s,0)):(r=7&e,(a=[]).length=1+(e>>3),t.nextBytes(a),0<r?a[0]&=(1<<r)-1:a[0]=0,this.fromString(a,256))},P),R=(N.prototype.convert=function(e){return e},N.prototype.revert=function(e){return e},N.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},N.prototype.sqrTo=function(e,t){e.squareTo(t)},N),O=(A.prototype.convert=function(e){return e.s<0||0<=e.compareTo(this.m)?e.mod(this.m):e},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},A.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},A),k=(w.prototype.convert=function(e){var t=x();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&0<t.compareTo(C.ZERO)&&this.m.subTo(t,t),t},w.prototype.revert=function(e){var t=x();return e.copyTo(t),this.reduce(t),t},w.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),0<=e.compareTo(this.m)&&e.subTo(this.m,e)},w.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},w.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},w),I=(L.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=x();return e.copyTo(t),this.reduce(t),t},L.prototype.revert=function(e){return e},L.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)},L.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},L.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},L);function L(e){this.m=e,this.r2=x(),this.q3=x(),C.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e)}function w(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function A(e){this.m=e}function N(){}function P(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function M(e){var t=e.get();if(this.tagClass=t>>6,this.tagConstructed=0!=(32&t),this.tagNumber=31&t,31==this.tagNumber){for(var r=new f;t=e.get(),r.mulAdd(128,127&t),128&t;);this.tagNumber=r.simplify()}}function D(e,t,r,n,i){if(!(n instanceof S))throw new Error("Invalid tag value.");this.stream=e,this.header=t,this.length=r,this.tag=n,this.sub=i}function U(e,t){this.hexDigits="0123456789ABCDEF",e instanceof U?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=t)}function x(){return new C(null)}function B(e,t){return new C(e,t)}t=(r="undefined"!=typeof navigator)&&"Microsoft Internet Explorer"==navigator.appName?(C.prototype.am=function(e,t,r,n,i,o){for(var s=32767&t,a=t>>15;0<=--o;){var c=32767&this[e],u=this[e++]>>15,l=a*c+u*s;i=((c=s*c+((32767&l)<<15)+r[n]+(1073741823&i))>>>30)+(l>>>15)+a*u+(i>>>30),r[n++]=1073741823&c}return i},30):r&&"Netscape"!=navigator.appName?(C.prototype.am=function(e,t,r,n,i,o){for(;0<=--o;){var s=t*this[e++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i},26):(C.prototype.am=function(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;0<=--o;){var c=16383&this[e],u=this[e++]>>14,l=a*c+u*s;i=((c=s*c+((16383&l)<<14)+r[n]+i)>>28)+(l>>14)+a*u,r[n++]=268435455&c}return i},28),C.prototype.DB=t,C.prototype.DM=(1<<t)-1,C.prototype.DV=1<<t,C.prototype.FV=Math.pow(2,52),C.prototype.F1=52-t,C.prototype.F2=2*t-52;for(var j=[],H="0".charCodeAt(0),G=0;G<=9;++G)j[H++]=G;for(H="a".charCodeAt(0),G=10;G<36;++G)j[H++]=G;for(H="A".charCodeAt(0),G=10;G<36;++G)j[H++]=G;function z(e,t){return null==(e=j[e.charCodeAt(t)])?-1:e}function q(e){var t=x();return t.fromInt(e),t}function V(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}C.ZERO=q(0),C.ONE=q(1),Y.prototype.init=function(e){for(var t,r,n=0;n<256;++n)this.S[n]=n;for(n=t=0;n<256;++n)t=t+this.S[n]+e[n%e.length]&255,r=this.S[n],this.S[n]=this.S[t],this.S[t]=r;this.i=0,this.j=0},Y.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var F,Z=Y,W=null;function Y(){this.i=0,this.j=0,this.S=[]}W=[];var Q=0,K=void 0;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var J=new Uint32Array(256);for(window.crypto.getRandomValues(J),K=0;K<J.length;++K)W[Q++]=255&J[K]}te.prototype.nextBytes=function(e){for(var t=0;t<e.length;++t)e[t]=function(){if(null==F){for(F=new Z;Q<256;){var e=Math.floor(65536*Math.random());W[Q++]=255&e}for(F.init(W),Q=0;Q<W.length;++Q)W[Q]=0;Q=0}return F.next()}()};var X=te,$=(ee.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},ee.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},ee.prototype.setPublic=function(e,t){null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=B(e,16),this.e=parseInt(t,16)):console.error("Invalid RSA public key")},ee.prototype.encrypt=function(e){var t=this.n.bitLength()+7>>3;if(e=function(e,t){if(t<e.length+11)return console.error("Message too long for RSA"),null;for(var r=[],n=e.length-1;0<=n&&0<t;){var i=e.charCodeAt(n--);i<128?r[--t]=i:127<i&&i<2048?(r[--t]=63&i|128,r[--t]=i>>6|192):(r[--t]=63&i|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var o=new X,s=[];2<t;){for(s[0]=0;0==s[0];)o.nextBytes(s);r[--t]=s[0]}return r[--t]=2,r[--t]=0,new C(r)}(e,t),null==e)return null;if(null==(e=this.doPublic(e)))return null;for(var r=e.toString(16),n=r.length,i=0;i<2*t-n;i++)r="0"+r;return r},ee.prototype.setPrivate=function(e,t,r){null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=B(e,16),this.e=parseInt(t,16),this.d=B(r,16)):console.error("Invalid RSA private key")},ee.prototype.setPrivateEx=function(e,t,r,n,i,o,s,a){null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=B(e,16),this.e=parseInt(t,16),this.d=B(r,16),this.p=B(n,16),this.q=B(i,16),this.dmp1=B(o,16),this.dmq1=B(s,16),this.coeff=B(a,16)):console.error("Invalid RSA private key")},ee.prototype.generate=function(e,t){var r=new X,n=e>>1;this.e=parseInt(t,16);for(var i=new C(t,16);;){for(;this.p=new C(e-n,1,r),0!=this.p.subtract(C.ONE).gcd(i).compareTo(C.ONE)||!this.p.isProbablePrime(10););for(;this.q=new C(n,1,r),0!=this.q.subtract(C.ONE).gcd(i).compareTo(C.ONE)||!this.q.isProbablePrime(10););this.p.compareTo(this.q)<=0&&(o=this.p,this.p=this.q,this.q=o);var o=this.p.subtract(C.ONE),s=this.q.subtract(C.ONE),a=o.multiply(s);if(0==a.gcd(i).compareTo(C.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(a),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}},ee.prototype.decrypt=function(e){if(e=B(e,16),null==(e=this.doPrivate(e)))return null;for(var t=this.n.bitLength()+7>>3,r=e.toByteArray(),n=0;n<r.length&&0==r[n];)++n;if(r.length-n!=t-1||2!=r[n])return null;for(++n;0!=r[n];)if(++n>=r.length)return null;for(var i="";++n<r.length;){var o=255&r[n];o<128?i+=String.fromCharCode(o):191<o&&o<224?(i+=String.fromCharCode((31&o)<<6|63&r[n+1]),++n):(i+=String.fromCharCode((15&o)<<12|(63&r[n+1])<<6|63&r[n+2]),n+=2)}return i},ee.prototype.generateAsync=function(e,t,r){var n=new X,i=e>>1,o=(this.e=parseInt(t,16),new C(t,16)),s=this,a=function t(){var a=function(){s.p.compareTo(s.q)<=0&&(e=s.p,s.p=s.q,s.q=e);var e=s.p.subtract(C.ONE),n=s.q.subtract(C.ONE),i=e.multiply(n);0==i.gcd(o).compareTo(C.ONE)?(s.n=s.p.multiply(s.q),s.d=o.modInverse(i),s.dmp1=s.d.mod(e),s.dmq1=s.d.mod(n),s.coeff=s.q.modInverse(s.p),setTimeout((function(){r()}),0)):setTimeout(t,0)},c=function e(){s.q=x(),s.q.fromNumberAsync(i,1,n,(function(){s.q.subtract(C.ONE).gcda(o,(function(t){0==t.compareTo(C.ONE)&&s.q.isProbablePrime(10)?setTimeout(a,0):setTimeout(e,0)}))}))};setTimeout((function t(){s.p=x(),s.p.fromNumberAsync(e-i,1,n,(function(){s.p.subtract(C.ONE).gcda(o,(function(e){0==e.compareTo(C.ONE)&&s.p.isProbablePrime(10)?setTimeout(c,0):setTimeout(t,0)}))}))}),0)};setTimeout(a,0)},ee.prototype.sign=function(e,t,r){return r=function(e,t){if(t<e.length+22)return console.error("Message too long for RSA"),null;for(var r=t-e.length-6,n="",i=0;i<r;i+=2)n+="ff";return B("0001"+n+"00"+e,16)}(($[r]||"")+t(e).toString(),this.n.bitLength()/4),null==r||null==(t=this.doPrivate(r))?null:0==(1&(e=t.toString(16)).length)?e:"0"+e},ee.prototype.verify=function(e,t,r){return t=B(t,16),null==(t=this.doPublic(t))?null:function(e){for(var t in $)if($.hasOwnProperty(t)){var r=(t=$[t]).length;if(e.substr(0,r)==t)return e.substr(r)}return e}(t.toString(16).replace(/^1f+00/,""))==r(e).toString()},r=ee,{md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"});function ee(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function te(){}(t={}).lang={extend:function(e,t,r){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");function n(){}if(n.prototype=t.prototype,e.prototype=new n,(e.prototype.constructor=e).superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),r){for(var i in r)e.prototype[i]=r[i];t=function(){};var o=["toString","valueOf"];try{"undefined"!=typeof navigator&&/MSIE/.test(navigator.userAgent)&&(t=function(e,t){for(i=0;i<o.length;i+=1){var r=o[i],n=t[r];"function"==typeof n&&n!=Object.prototype[r]&&(e[r]=n)}})}catch(e){}t(e.prototype,r)}}};var re={};void 0!==re.asn1&&re.asn1||(re.asn1={}),re.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){return(e=e.toString(16)).length%2==1?"0"+e:e},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var r=t.substr(1).length;r%2==1?r+=1:t.match(/^[0-7]/)||(r+=2);for(var n="",i=0;i<r;i++)n+="f";t=new C(n,16).xor(e).add(C.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return hextopem(e,t)},this.newObject=function(e){var t,r=(t=re.asn1).DERBoolean,n=t.DERInteger,i=t.DERBitString,o=t.DEROctetString,s=t.DERNull,a=t.DERObjectIdentifier,c=t.DEREnumerated,u=t.DERUTF8String,l=t.DERNumericString,d=t.DERPrintableString,h=t.DERTeletexString,p=t.DERIA5String,f=t.DERUTCTime,g=t.DERGeneralizedTime,m=t.DERSequence,_=t.DERSet,v=t.DERTaggedObject,y=t.ASN1Util.newObject;if(1!=(t=Object.keys(e)).length)throw"key of param shall be only one.";if(t=t[0],-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+t+":"))throw"undefined key: "+t;if("bool"==t)return new r(e[t]);if("int"==t)return new n(e[t]);if("bitstr"==t)return new i(e[t]);if("octstr"==t)return new o(e[t]);if("null"==t)return new s(e[t]);if("oid"==t)return new a(e[t]);if("enum"==t)return new c(e[t]);if("utf8str"==t)return new u(e[t]);if("numstr"==t)return new l(e[t]);if("prnstr"==t)return new d(e[t]);if("telstr"==t)return new h(e[t]);if("ia5str"==t)return new p(e[t]);if("utctime"==t)return new f(e[t]);if("gentime"==t)return new g(e[t]);if("seq"==t){for(var E=e[t],S=[],b=0;b<E.length;b++){var T=y(E[b]);S.push(T)}return new m({array:S})}if("set"==t){for(E=e[t],S=[],b=0;b<E.length;b++)T=y(E[b]),S.push(T);return new _({array:S})}if("tag"==t){if(r=e[t],"[object Array]"===Object.prototype.toString.call(r)&&3==r.length)return n=y(r[2]),new v({tag:r[0],explicit:r[1],obj:n});if(i={},void 0!==r.explicit&&(i.explicit=r.explicit),void 0!==r.tag&&(i.tag=r.tag),void 0===r.obj)throw"obj shall be specified for 'tag'.";return i.obj=y(r.obj),new v(i)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},re.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",r=parseInt(e.substr(0,2),16),n=(t=Math.floor(r/40)+"."+r%40,""),i=2;i<e.length;i+=2){var o=("00000000"+parseInt(e.substr(i,2),16).toString(2)).slice(-8);n+=o.substr(1,7),"0"==o.substr(0,1)&&(t=t+"."+new C(n,2).toString(10),n="")}return t},re.asn1.ASN1Util.oidIntToHex=function(e){function t(e){return 1==(e=e.toString(16)).length?"0"+e:e}if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var r="",n=e.split(".");r+=t(e=40*parseInt(n[0])+parseInt(n[1])),n.splice(0,2);for(var i=0;i<n.length;i++)r+=function(e){var r="",n=new C(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(n=o+n,s=0;s<n.length-1;s+=7){var a=n.substr(s,7);s!=n.length-7&&(a="1"+a),r+=t(parseInt(a,2))}return r}(n[i]);return r},re.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var r=t.length/2;if(15<r)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+t},this.getEncodedHex=function(){return null!=this.hTLV&&!this.isModified||(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},re.asn1.DERAbstractString=function(e){re.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(this.s)},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},t.lang.extend(re.asn1.DERAbstractString,re.asn1.ASN1Object),re.asn1.DERAbstractTime=function(e){re.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){return utc=e.getTime()+6e4*e.getTimezoneOffset(),new Date(utc)},this.formatDate=function(e,t,r){var n=this.zeroPadding,i=(e=this.localDateToUTC(e),String(e.getFullYear()));return t=(i="utc"==t?i.substr(2,2):i)+n(String(e.getMonth()+1),2)+n(String(e.getDate()),2)+n(String(e.getHours()),2)+n(String(e.getMinutes()),2)+n(String(e.getSeconds()),2),(t=!0===r&&0!=(i=e.getMilliseconds())?t+"."+n(String(i),3).replace(/[0]+$/,""):t)+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(e)},this.setByDateValue=function(e,t,r,n,i,o){e=new Date(Date.UTC(e,t-1,r,n,i,o,0)),this.setByDate(e)},this.getFreshValueHex=function(){return this.hV}},t.lang.extend(re.asn1.DERAbstractTime,re.asn1.ASN1Object),re.asn1.DERAbstractStructured=function(e){re.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},t.lang.extend(re.asn1.DERAbstractStructured,re.asn1.ASN1Object),re.asn1.DERBoolean=function(){re.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},t.lang.extend(re.asn1.DERBoolean,re.asn1.ASN1Object),re.asn1.DERInteger=function(e){re.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=re.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){e=new C(String(e),10),this.setByBigInteger(e)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},t.lang.extend(re.asn1.DERInteger,re.asn1.ASN1Object),re.asn1.DERBitString=function(e){var t;void 0!==e&&void 0!==e.obj&&(t=re.asn1.ASN1Util.newObject(e.obj),e.hex="00"+t.getEncodedHex()),re.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;e="0"+e,this.hTLV=null,this.isModified=!0,this.hV=e+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var r=0;r<=t;r++)e+="0";var n="";for(r=0;r<e.length-1;r+=8){var i=e.substr(r,8);n+=i=1==(i=parseInt(i,2).toString(16)).length?"0"+i:i}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",r=0;r<e.length;r++)1==e[r]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},t.lang.extend(re.asn1.DERBitString,re.asn1.ASN1Object),re.asn1.DEROctetString=function(e){var t;void 0!==e&&void 0!==e.obj&&(t=re.asn1.ASN1Util.newObject(e.obj),e.hex=t.getEncodedHex()),re.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},t.lang.extend(re.asn1.DEROctetString,re.asn1.DERAbstractString),re.asn1.DERNull=function(){re.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},t.lang.extend(re.asn1.DERNull,re.asn1.ASN1Object),re.asn1.DERObjectIdentifier=function(e){var t=function(e){return 1==(e=e.toString(16)).length?"0"+e:e};re.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var r="",n=e.split(".");e=40*parseInt(n[0])+parseInt(n[1]),r+=t(e),n.splice(0,2);for(var i=0;i<n.length;i++)r+=function(e){var r="",n=new C(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(n=o+n,s=0;s<n.length-1;s+=7){var a=n.substr(s,7);s!=n.length-7&&(a="1"+a),r+=t(parseInt(a,2))}return r}(n[i]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(e){var t=re.asn1.x509.OID.name2oid(e);if(""===t)throw"DERObjectIdentifier oidName undefined: "+e;this.setValueOidString(t)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e):void 0!==e.oid?this.setValueOidString(e.oid):void 0!==e.hex?this.setValueHex(e.hex):void 0!==e.name&&this.setValueName(e.name))},t.lang.extend(re.asn1.DERObjectIdentifier,re.asn1.ASN1Object),re.asn1.DEREnumerated=function(e){re.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=re.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){e=new C(String(e),10),this.setByBigInteger(e)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},t.lang.extend(re.asn1.DEREnumerated,re.asn1.ASN1Object),re.asn1.DERUTF8String=function(e){re.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},t.lang.extend(re.asn1.DERUTF8String,re.asn1.DERAbstractString),re.asn1.DERNumericString=function(e){re.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},t.lang.extend(re.asn1.DERNumericString,re.asn1.DERAbstractString),re.asn1.DERPrintableString=function(e){re.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},t.lang.extend(re.asn1.DERPrintableString,re.asn1.DERAbstractString),re.asn1.DERTeletexString=function(e){re.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},t.lang.extend(re.asn1.DERTeletexString,re.asn1.DERAbstractString),re.asn1.DERIA5String=function(e){re.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},t.lang.extend(re.asn1.DERIA5String,re.asn1.DERAbstractString),re.asn1.DERUTCTime=function(e){re.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},t.lang.extend(re.asn1.DERUTCTime,re.asn1.DERAbstractTime),re.asn1.DERGeneralizedTime=function(e){re.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},t.lang.extend(re.asn1.DERGeneralizedTime,re.asn1.DERAbstractTime),re.asn1.DERSequence=function(e){re.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].getEncodedHex();return this.hV=e,this.hV}},t.lang.extend(re.asn1.DERSequence,re.asn1.DERAbstractStructured),re.asn1.DERSet=function(e){re.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},t.lang.extend(re.asn1.DERSet,re.asn1.DERAbstractStructured),re.asn1.DERTaggedObject=function(e){re.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,r){this.hT=t,this.isExplicit=e,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.tag&&(this.hT=e.tag),void 0!==e.explicit&&(this.isExplicit=e.explicit),void 0!==e.obj&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},t.lang.extend(re.asn1.DERTaggedObject,re.asn1.ASN1Object),ne=function(e,t){return(ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};var ne,ie=function(e){function t(r){var n=e.call(this)||this;return r&&("string"==typeof r?n.parseKey(r):(t.hasPrivateKeyProperty(r)||t.hasPublicKeyProperty(r))&&n.parsePropertiesFrom(r)),n}var r=t,n=e;if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=r}return ne(r,n),r.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i),t.prototype.parseKey=function(e){try{var t=0,r=0,n=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(e)?function(e){if(void 0===c){var t="0123456789ABCDEF",r=" \f\n\r\t\xa0\u2028\u2029";for(c={},s=0;s<16;++s)c[t.charAt(s)]=s;for(t=t.toLowerCase(),s=10;s<16;++s)c[t.charAt(s)]=s;for(s=0;s<r.length;++s)c[r.charAt(s)]=-1}for(var n=[],i=0,o=0,s=0;s<e.length;++s){var a=e.charAt(s);if("="==a)break;if(-1!=(a=c[a])){if(void 0===a)throw new Error("Illegal character at offset "+s);i|=a,2<=++o?(n[n.length]=i,o=i=0):i<<=4}}if(o)throw new Error("Hex encoding incomplete: 4 bits missing");return n}(e):p.unarmor(e),i=E.decode(n);if(9===(i=3===i.sub.length?i.sub[2].sub[0]:i).sub.length){t=i.sub[1].getHexStringValue(),this.n=B(t,16),r=i.sub[2].getHexStringValue(),this.e=parseInt(r,16);var o=i.sub[3].getHexStringValue(),s=(this.d=B(o,16),i.sub[4].getHexStringValue()),a=(this.p=B(s,16),i.sub[5].getHexStringValue()),u=(this.q=B(a,16),i.sub[6].getHexStringValue()),l=(this.dmp1=B(u,16),i.sub[7].getHexStringValue()),d=(this.dmq1=B(l,16),i.sub[8].getHexStringValue());this.coeff=B(d,16)}else{if(2!==i.sub.length)return!1;var h=i.sub[1].sub[0];t=h.sub[0].getHexStringValue(),this.n=B(t,16),r=h.sub[1].getHexStringValue(),this.e=parseInt(r,16)}return!0}catch(e){return!1}},t.prototype.getPrivateBaseKey=function(){var e={array:[new re.asn1.DERInteger({int:0}),new re.asn1.DERInteger({bigint:this.n}),new re.asn1.DERInteger({int:this.e}),new re.asn1.DERInteger({bigint:this.d}),new re.asn1.DERInteger({bigint:this.p}),new re.asn1.DERInteger({bigint:this.q}),new re.asn1.DERInteger({bigint:this.dmp1}),new re.asn1.DERInteger({bigint:this.dmq1}),new re.asn1.DERInteger({bigint:this.coeff})]};return new re.asn1.DERSequence(e).getEncodedHex()},t.prototype.getPrivateBaseKeyB64=function(){return l(this.getPrivateBaseKey())},t.prototype.getPublicBaseKey=function(){var e=new re.asn1.DERSequence({array:[new re.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new re.asn1.DERNull]}),t=new re.asn1.DERSequence({array:[new re.asn1.DERInteger({bigint:this.n}),new re.asn1.DERInteger({int:this.e})]});return t=new re.asn1.DERBitString({hex:"00"+t.getEncodedHex()}),new re.asn1.DERSequence({array:[e,t]}).getEncodedHex()},t.prototype.getPublicBaseKeyB64=function(){return l(this.getPublicBaseKey())},t.wordwrap=function(e,t){return e?(t="(.{1,"+(t=t||64)+"})( +|$\n?)|(.{1,"+t+"})",e.match(RegExp(t,"g")).join("\n")):e},t.prototype.getPrivateKey=function(){return"-----BEGIN RSA PRIVATE KEY-----\n"+t.wordwrap(this.getPrivateBaseKeyB64())+"\n-----END RSA PRIVATE KEY-----"},t.prototype.getPublicKey=function(){return"-----BEGIN PUBLIC KEY-----\n"+t.wordwrap(this.getPublicBaseKeyB64())+"\n-----END PUBLIC KEY-----"},t.hasPublicKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")},t.hasPrivateKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")&&e.hasOwnProperty("d")&&e.hasOwnProperty("p")&&e.hasOwnProperty("q")&&e.hasOwnProperty("dmp1")&&e.hasOwnProperty("dmq1")&&e.hasOwnProperty("coeff")},t.prototype.parsePropertiesFrom=function(e){this.n=e.n,this.e=e.e,e.hasOwnProperty("d")&&(this.d=e.d,this.p=e.p,this.q=e.q,this.dmp1=e.dmp1,this.dmq1=e.dmq1,this.coeff=e.coeff)},t}(r);se.prototype.setKey=function(e){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new ie(e)},se.prototype.setPrivateKey=function(e){this.setKey(e)},se.prototype.setPublicKey=function(e){this.setKey(e)},se.prototype.decrypt=function(e){try{return this.getKey().decrypt(d(e))}catch(e){return!1}},se.prototype.encrypt=function(e){try{return l(this.getKey().encrypt(e))}catch(e){return!1}},se.prototype.sign=function(e,t,r){try{return l(this.getKey().sign(e,t,r))}catch(e){return!1}},se.prototype.verify=function(e,t,r){try{return this.getKey().verify(e,d(t),r)}catch(e){return!1}},se.prototype.getKey=function(e){if(!this.key){if(this.key=new ie,e&&"[object Function]"==={}.toString.call(e))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},se.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},se.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},se.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},se.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},se.version="3.2.1";var oe=se;function se(e){this.default_key_size=(e=(e=void 0===e?{}:e)||{}).default_key_size?parseInt(e.default_key_size,10):1024,this.default_public_exponent=e.default_public_exponent||"010001",this.log=e.log||!1,this.key=null}}(0,Te={},Ie),Te.default),we=(Object.defineProperty(Ae.prototype,"publicKey",{get:function(){return"-----BEGIN PUBLIC KEY-----\n        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxtEM51skf+Bg29Mdb+WN\n        IkgbGDZ/wOP4MTntlut65WpPpXOkg2m9EKscmzfE6kUNLYnYV77fZGFSjr+Wkmoz\n        VK1lJ3seswBNyP6X5LUszkf1WoeEyBbfegTf3XkHEeWJ5BlD9syurlA2Fh+cTaNO\n        RNlAGBZO7SdgTHPYAcHu0fAnJZwCZ9+ZZkVnjyTBqQckovMttKqvtoUKcp7NgGve\n        w0OJxFKwIITu1keGdZ+yN9wBul4qJfTy8otOcwGL4bnoABMhCNvJc3xA70BuaaF0\n        fvhxA8diV/2W+qg+LAzdqajLaNciuDHIY5Y+z5kZI1eBa3J3aqUASse4YzzTYv48\n        7wIDAQAB\n        -----END PUBLIC KEY-----"},enumerable:!1,configurable:!0}),Ae.prototype.encrypt=function(e){return e=M.a.encrypt(this.uint8Array2WordArray(e),this.key2,{iv:this.iv2}).toString(),Ce.a.toByteArray(e)},Ae.prototype.decrypt=function(e){return this.wordArray2Uint8Array(M.a.decrypt(Ce.a.fromByteArray(e),this.key2,{iv:this.iv2}))},Ae.prototype.generateK1Sign=function(){var e=this.generateNonce(),t=((this.key1=D.a.parse(e),this.iv1=Re.a.parse(ke()(e).toString().toLowerCase()),t=new Le).setPublicKey(this.publicKey),t.getKey().encrypt(e));return this.wordArray2Uint8Array(Re.a.parse(t))},Ae.prototype.decryptK2Sign=function(e){try{this.key2=M.a.decrypt(Ce.a.fromByteArray(e),this.key1,{iv:this.iv1}),this.iv2=ke()(this.key2)}catch(e){}},Ae.prototype.generateNonce=function(){var e=Math.random().toString().substr(2,16);return e.length<16&&(e+=e.substr(0,16-e.length)),e},Ae.prototype.md5=function(e){return ke()(e).toString()},Ae.prototype.md5Bytes=function(e){return this.wordArray2Uint8Array(ke()(this.uint8Array2WordArray(e)))},Ae.prototype.wordArray2Uint8Array=function(e){for(var t=e.words,r=e.sigBytes,n=new Uint8Array(r),i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n[i]=o}return n},Ae.prototype.uint8Array2WordArray=function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e[n])<<24-n%4*8;return Oe.a.create(r,t)},Ae);function Ae(){}function Ne(e){return Uint8Array.from(Array.from(unescape(encodeURIComponent(e))).map((function(e){return e.charCodeAt(0)})))}function Pe(e){return decodeURIComponent(escape(String.fromCharCode.apply(String,Array.from(e))))}var Me={"/lr/login_room_rsp":"LoginRoomRsp","/lr/logout_room_rsp":"LogoutRoomRsp","/sw/push_kickout":"PushKickout","/sw/push":"PushReq","/sw/merge_push":"CmdMergePushReq","/lr/room/hb_rsp":"HbRsp","/lr/userlist/userlist_rsp":"UserlistRsp","/lr/stream/add_rsp":"StreamAddRsp","/lr/stream/delete_rsp":"StreamDeleteRsp","/lr/stream/update_rsp":"StreamUpdateRsp","/lr/stream/list_rsp":"StreamListRsp","/lr/push/stream_add":"PushStream","/lr/push/stream_delete":"PushStream","/lr/push/stream_update":"PushStream","/lr/signal/liverequest_rsp":"SignalLiveRsp","/lr/signal/liverresult_rsp":"SignalLiveResulRsp","/lr/signal/liveinvite_rsp":"SignalLiveInviteRsp","/lr/signal/livestop_rsp":"SignalLiveStopRsp","/lr/signal/livescustom_rsp":"SignalLiveCustomRsp","/lr/im/chat_rsp":"ImChatRsp","/lr/room/enter_rsp":"EnterRsp","/lr/room/quit_rsp":"QuitRsp","/lr/trans/trans_rsp":"TransRsp","/lr/trans/transfetch_rsp":"TransFetchRsp","/lr/bigim/chat_rsp":"BigimChatRsp","/lr/relay_rsp":"RelayRsp","/lr/token/renew_token_rsp":"RenewTokenRsp","/lr/push/user_updated":"PushUserInfoUpdated","/lr/push/user_token_expire":"PushUserTokenExpire","/lr/push/im_chat":"PushImChat","/lr/push/bigim_chat":"PushBigImChat","/lr/push/trans":"PushTrans","/lr/push/user_kickout":"PushUserKickout","/lr/push/user_logreport":"PushUserLogReport","/lr/push/usertrans":"PushUserTrans"},De=(Te=r(1),r.n(Te)),Ue=function(){return(Ue=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};t.util.Long=De.a,t.configure();var xe,Be=((Te=xe=xe||{})[Te.disconnected=0]="disconnected",Te[Te.broken=1]="broken",Te[Te.connected=2]="connected",Object.defineProperty(je.prototype,"nickName",{get:function(){return Ne(this.stateCenter.nickName)},enumerable:!1,configurable:!0}),je.prototype.isDisConnect=function(){return this.state!==xe.connected},je.prototype.getHeader=function(e){e={cmd:e,seq:++this.seq,timestamp:(new Date).getTime(),session_id:this.switchSessionID,controls:this.controls,flags:this.flags};var t=Se.proto_switch.Header.create(e);return t=Se.proto_switch.Header.encode(t).finish(),[e.seq,t]},je.prototype.isUaConnect=function(){return this.ua.isConnect()},je.prototype.sendMessage=function(e,t,r,n,i,o,s){var a=this;if(void 0===i&&(i={timeout:6e3}),void 0===o&&(o=!0),this.logger.info(j.LIVEROOMHANDLER_SENDMESSAGE+" call"),"/lr/login_room"!==e&&this.state!==xe.connected)return this.logger.warn(j.LIVEROOMHANDLER_SENDMESSAGE+" state "+this.state),-1;var c=this.getHeader(e),u=c[1],l=t;return!this.unEncryptCmdList.includes(e)&&this.isEncrypt&&(l=this.crypto.encrypt(t)),t=this.getHead(u.length,l.length),t=new Uint8Array(Array.from(t).concat(Array.from(u)).concat(Array.from(l))),o&&(u={seq:this.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeout:i.timeout,success:r,error:function(e,t,r){var i;if(a.logger.info(j.LIVEROOMHANDLER_SENDMESSAGE+" seq: "+t+" "+JSON.stringify(e)+" "+JSON.stringify(r)),"/lr/login_room_rsp"!==(null==(i=null==e?void 0:e.header)?void 0:i.cmd)&&-1<[1002,105].indexOf(null==(i=null==e?void 0:e.body)?void 0:i.err_code))return null!=r&&r.roomID?(i=a.stateCenter.roomModulesList.find((function(e){return e.roomID==r.roomID})))?void i.retryRoom():void a.logger.error(j.LIVEROOMHANDLER_SENDMESSAGE+" room no found ignore "):void a.rtm.retryRoom();[207,208].indexOf(null==(i=null==e?void 0:e.body)?void 0:i.err_code),n&&n(e,t)},params:s},l=this.sendCommandList.push(u),this.sendCommandMap[u.seq]=l),this.logger.info(j.LIVEROOMHANDLER_SENDMESSAGE+" seq: "+c[0]+" cmd: "+e),o="/lr/login_room"===e,null!=(i=this.liveroomRequest)&&i.sendRequest({payload:t,ack:o},(function(e){a.logger.info(j.LIVEROOMHANDLER_SENDMESSAGE+" fail")}),(function(){a.logger.info(j.LIVEROOMHANDLER_SENDMESSAGE+" ack")})),c[0]},je.prototype.getHead=function(e,t){var r=new Uint8Array(7);return r[0]=33,r[1]=e>>8,r[2]=e-(r[1]<<8),r.set(new Uint8Array(Int32Array.from([t]).buffer).reverse(),3),r},je.prototype.handlePush=function(e,t){if(void 0===t&&(t=!1),33===(r=e[0])){var r=(e[1]<<8)+e[2],n=Se.proto_switch.Header.decode(e.slice(7,7+r)),i=r=e.slice(7+r);if(!this.unEncryptCmdList.includes(n.cmd)&&this.isEncrypt){if(!this.hasCryptSign)return this.logger.warn(j.LIVEROOMHANDLER_HANDLEPUSH+" decrypt early "+n.cmd),void this.waitDecryptCmdList.push(e);try{i=this.crypto.decrypt(r)}catch(e){this.logger.warn(j.LIVEROOMHANDLER_HANDLEPUSH+" decrypt fail "+n.cmd)}}if(Me[n.cmd]){if(e=this.decodeResponseBody(n,i),this.swPushCmdList.includes(n.cmd))return t&&"/lr/push/user_updated"===(null==(r=null==e?void 0:e.head)?void 0:r.sub_cmd)?void this.logger.info(j.LIVEROOMHANDLER_HANDLEPUSH+" ignore user updated"):void this.handleSwitchPush(n,e);this.logger.info(j.LIVEROOMHANDLER_HANDLEPUSH+" down "+n.cmd+" "+JSON.stringify(this.transBuf(e))),t={header:this.transHeader(n),body:this.transRsp(e)},this.handleSendCommandMsgRsp(t)}else this.logger.info(j.LIVEROOMHANDLER_HANDLEPUSH+" cmd is not rtc"),this.onSwitchMessage(n,i)}},je.prototype.handleSwitchPush=function(e,t){if("/sw/push"===e.cmd){var r=(a=this.transRsp(t.head)).room_id;if(this.stateCenter.roomModulesList.find((function(e){return e.roomID==r}))){var n=void 0,i={header:a,body:n=this.unStructCmdList.includes(t.head.sub_cmd)?{signal_msg:Pe(t.msg_body),sub_cmd:this.joinLiveMap[t.head.sub_cmd]}:"/lr/push/signal_custom"===t.head.sub_cmd?{custommsg:Pe(t.msg_body)}:Me[t.head.sub_cmd]?this.transRsp(this.decode(Se.liveroom_cs[Me[t.head.sub_cmd]],t.msg_body)):{}};if(this.logger.info(j.LIVEROOMHANDLER_HANDLESWITCHPUSH+" push "+JSON.stringify(this.transBuf(i))),this.whiteboardPushCmdList.includes(t.head.sub_cmd))this.logger.info(j.LIVEROOMHANDLER_HANDLESWITCHPUSH+" white "),this.onSwitchMessage(e,t);else switch(t.head.sub_cmd){case"/lr/push/user_updated":this.handlePushUserStateUpdateMsg(i);break;case"/lr/push/user_kickout":this.handlePushKickout(i,!1);break;case"/lr/push/trans":this.handlePushTransMsg(i);break;case"/lr/push/im_chat":this.handlePushRoomMsg(i);break;case"/lr/push/signal_custom":this.handlePushCustomMsg(i);break;case"/lr/push/stream_add":case"/lr/push/stream_delete":case"/lr/push/stream_update":this.handlePushStreamMsg(i);break;case"/lr/push/joinlive_request":case"/lr/push/joinlive_result":case"/lr/push/joinlive_invite":case"/lr/push/joinlive_stop":this.handlePushSignalMsg(i);break;case"/lr/push/user_token_expire":this.handlePushTokenExpire(i)}1==t.head.qos_flag&&(c={code:0,message:"",sub_cmd:t.head.sub_cmd,msg_id:t.head.msg_id,server_send_time:t.head.send_time},u=Se.proto_switch.PushRsp.create(c),l=Se.proto_switch.PushRsp.encode(u).finish(),this.sendMessage("/sw/push_rsp",l,void 0,void 0))}else this.logger.warn(j.LIVEROOMHANDLER_HANDLESWITCHPUSH+" room no found ignore ")}else{var o,s,a,c,u,l;"/sw/merge_push"===e.cmd?(o=(a=this.transRsp(t.head)).room_id,this.stateCenter.roomModulesList.find((function(e){return e.roomID==o}))?(s=[],t.messages.forEach((function(e){var t;s.push({sub_cmd:e.sub_cmd,sub_seq:e.sub_seq,msg_id:e.msg_id}),"/lr/push/bigim_chat"===e.sub_cmd&&(t=Se.liveroom_cs.PushBigImChat.decode(e.msg_body),e.msg_body=t)})),delete(a={header:(n=this.transRsp(t)).head,body:n}).body.head,this.handlePushMergeMsg(a),1==t.head.qos_flag&&(u=Se.proto_switch.CmdMergePushRsp.create(c={messages:s}),l=Se.proto_switch.CmdMergePushRsp.encode(u).finish(),this.sendMessage("/sw/merge_push_rsp",l,void 0,void 0))):this.logger.warn(j.LIVEROOMHANDLER_HANDLESWITCHPUSH+" room no found ignore ")):"/sw/push_kickout"===e.cmd&&(n={reason:900<t.reason?t.reason-900:t.reason,msg:t.message,need_relogin:void 0!==t.need_relogin?t.need_relogin:0},this.handlePushKickout({header:e,body:n},!0))}},je.prototype.handlePushTokenExpire=function(e){},je.prototype.handlePushKickout=function(e,t){},je.prototype.handlePushStreamMsg=function(e){},je.prototype.handlePushSignalMsg=function(e){},je.prototype.handlePushMergeMsg=function(e){},je.prototype.handlePushCustomMsg=function(e){},je.prototype.handlePushRoomMsg=function(e){},je.prototype.handlePushTransMsg=function(e){},je.prototype.onSwitchMessage=function(e,t){},je.prototype.decodeResponseBody=function(e,t){var r=this.onSwitchCmdList.includes(e.cmd)?"proto_switch":"liveroom_cs";return this.decode(this.protoInstance[r][Me[e.cmd]],t)},je.prototype.handleWaitDecryptCmdList=function(){var e=this;this.waitDecryptCmdList.forEach((function(t){e.handlePush(t,!0)})),this.waitDecryptCmdList=[]},je.prototype.handlePushUserStateUpdateMsg=function(e){},je.prototype.login=function(e,t,r){var i,o,s,a,c=this,u=(this.state==xe.disconnected&&(this.logger.info(j.LIVEROOMHANDLER_LOGIN+" state disconnect"),this.closeRequest()),(new Date).getTime()+"");e.isMulti?(s={req_head:this.getReqHead(e),switch_session_id:this.switchSessionID,nick_name:this.nickName,role:this.stateCenter.role,net_type:x.getNetTypeNum(),config:{room_create_flag:this.stateCenter.roomCreateFlag,user_state_flag:this.stateCenter.userStateUpdate?1:0},lv_key:e.lvKey,third_token:Ne(e.token),user_count_limit:e.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",conn_type:2,room_name:Ne(e.roomName)},o=Ue(Ue({},s),{room_name:e.roomName,third_token:e.token}),this.logger.info(j.LIVEROOMHANDLER_LOGIN+" enter "+JSON.stringify(o)),s=Se.liveroom_cs.EnterReq.create(s),a=Se.liveroom_cs.EnterReq.encode(s).finish(),this.sendMessage("/lr/room/enter",a,(function(e,r){c.longToStringNumber(e.body,["user_session_id","room_session_id","ret_timestamp"],"toString"),c.transKeysName(e.body,[["user_session_id","session_id"],["hb_interval","hearbeat_interval"]]),c.keysExist(e.body,["token_remain_time","stream_seq"]),t&&t(e,r)}),(function(e,t){r&&r(e,t)}),void 0,void 0,{roomID:e.roomID})):(i={app_id:this.stateCenter.appid,id_name:Ne(this.stateCenter.idName),device_id:this.stateCenter.deviceID,term_type:this.stateCenter.ENV%2==0?n.TT_WEB:n.TT_MINIPROGRAM,net_type:x.getNetTypeNum(),sdk_ver:parseInt(this.rtm.version.replace(/\./g,"")),proto_ver:131072,nick_name:this.nickName,client_stamp:Ne(u),crypt_version:1,k1_sign:this.crypto.generateK1Sign(),relogin_token:this.switchSessionID.notEquals(De.a.fromInt(0))?Ne(this.reloginToken):"",role:this.stateCenter.role,liveroom_session_id:De.a.fromString(e.sessionID),room_id:Ne(e.roomID),room_name:Ne(e.roomName),biz_type:0,room_create_flag:this.stateCenter.roomCreateFlag,user_state_flag:this.stateCenter.userStateUpdate?1:0,lv_key:e.lvKey,third_token:Ne(e.token),user_count_limit:e.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",biz_version:this.stateCenter.bizVersion||"",login_logic:this.stateCenter.isMultiRoom?3:1,sdk_conn_type:2},o=Ue(Ue({},i),{id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,client_stamp:u,k1_sign:void 0,relogin_token:this.reloginToken,liveroom_session_id:e.sessionID,room_id:e.roomID,room_name:e.roomName,third_token:e.token}),this.logger.info(j.LIVEROOMHANDLER_LOGIN+" login "+JSON.stringify(o)),this.k1SignLogoutBuffer=this.crypto.md5Bytes(i.k1_sign),s=Se.proto_switch.LoginRoomReq.create(i),a=Se.proto_switch.LoginRoomReq.encode(s).finish(),this.sendMessage("/lr/login_room",a,(function(e,r){c.switchSessionID=e.header.session_id,c.reloginToken=e.body.relogin_token,c.logger.info(j.LIVEROOMHANDLER_LOGIN+" login rsp"),c.crypto.decryptK2Sign(e.body.k2_sign),1===e.body.crypt_option?c.isEncrypt=!1:void 0===e.body.crypt_option&&(c.isEncrypt=!0),c.hasCryptSign=!0,c.waitDecryptTimer=setTimeout((function(){c.handleWaitDecryptCmdList()}),0),c.longToStringNumber(e.body,["liveroom_session_id","room_session_id","ret_timestamp"],"toString"),delete e.body.heartbeat_interval,delete e.body.heartbeat_timeout,c.transKeysName(e.body,[["liveroom_session_id","session_id"],["liveroom_hb_interval","hearbeat_interval"]]),c.keysExist(e.body,["token_remain_time","stream_seq"]),t&&t(e,r)}),(function(e,t){r&&r(e,t)})))},je.prototype.transKeysName=function(e,t){t.forEach((function(t){e[t[1]]=e[t[0]],delete e[t[0]]}))},je.prototype.keysExist=function(e,t){t.forEach((function(t){void 0===e[t]&&(e[t]=0)}))},je.prototype.longToStringNumber=function(e,t,r){t.forEach((function(t){De.a.isLong(e[t])&&(e[t]=e[t][r]())}))},je.prototype.logout=function(e,t,r){var n,i,o,s;return e.isMulti?(n={req_head:this.getReqHead(e),switch_session_id:this.switchSessionID,nick_name:this.nickName,role:this.stateCenter.role,config_list:{room_create_flag:this.stateCenter.roomCreateFlag,user_state_flag:this.stateCenter.userStateUpdate?1:0}},i=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_LOGOUT+" quit "+JSON.stringify(i)),o=Se.liveroom_cs.QuitReq.create(n),s=Se.liveroom_cs.QuitReq.encode(o).finish(),this.sendMessage("/lr/room/quit",s,t,r)):(n={logout_code:0,logout_check:this.crypto.md5Bytes(Ne(e.token)),liveroom_session_id:De.a.fromString(e.sessionID),room_id:Ne(e.roomID),role:this.stateCenter.role,nickname:this.nickName,logout_logic:this.stateCenter.isMultiRoom?3:1},i=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_LOGOUT+" logout "+JSON.stringify(i)),o=Se.proto_switch.LogoutRoomReq.create(n),s=Se.proto_switch.LogoutRoomReq.encode(o).finish(),this.sendMessage("/lr/logout_room",s,t,r))},je.prototype.checkSendMessageList=function(e){for(var t=e.getFirst();null!=t;)e.remove(t),t._data&&t._data.error&&setTimeout((function(){t&&t._data&&t._data.error&&t._data.error(A.TIMEOUT,t._data.seq)}),0),t=e.getFirst()},je.prototype.checkMessageListTimeout=function(e,t){for(var r=e.getFirst(),n=Date.parse(new Date+""),i=0,o=this;null!=r&&"break"!==function(){return r._data&&r._data.sendTime+r._data.timeout>n?"break":(r._data&&delete t[r._data.seq],e.remove(r),r._data&&null==r._data.error||r._data&&r._data.sendTime+o.sendDataDropTimeout<n||(s=r&&r._data&&r._data.error,a=r&&r._data&&r._data.seq,setTimeout((function(){s&&s(A.TIMEOUT,a)}),0)),++i>=o.sendDataCheckOnceCount?"break":void(r=e.getFirst()));var s,a}(););},je.prototype.startCheck=function(){var e=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){e.startCheck()}),this.sendDataCheckInterval)},je.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},je.prototype.handleSendCommandMsgRsp=function(e){var t,r,n=this,i=this.sendCommandMap[e.header.seq];null!=i&&(t=i._data,r=null==t?void 0:t.params,delete this.sendCommandMap[e.header.seq],this.sendCommandList.remove(i),0===e.body.err_code?setTimeout((function(){t&&null!=t.success&&t.success(e,n.seq)}),0):setTimeout((function(){t&&null!=t.error&&t.error(e,n.seq,r)}),0))},je.prototype.getReqHead=function(e){return{room_id:e.roomID,user_session_id:De.a.fromString(e.sessionID),room_session_id:De.a.fromString(e.roomSessionID)}},je.prototype.heartBeat=function(e,t,r){var n=this;r={req_head:this.getReqHead(r),role:this.stateCenter.role,lv_key:r.lvKey},r=Se.liveroom_cs.HbReq.create(r),r=Se.liveroom_cs.HbReq.encode(r).finish(),this.sendMessage("/lr/room/hb",r,(function(t){n.transKeysName(t.body,[["hb_interval","hearbeat_interval"],["hb_timeout","hearbeat_timeout"]]),t.body.server_user_seq=t.body.user_seq.toNumber(),n.longToStringNumber(t.body,["dati_time_window"],"toNumber"),e&&e(t)}),t)},je.prototype.fetchUserList=function(e,t,r,n){var i=this;return n=this.getReqHead(n),n=Ue({req_head:n},e),e=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_FETCH_USER_LIST+" "+JSON.stringify(e)),e=Se.liveroom_cs.UserlistReq.create(n),n=Se.liveroom_cs.UserlistReq.encode(e).finish(),this.sendMessage("/lr/userlist/userlist",n,(function(e,r){i.logger.info(j.LIVEROOMHANDLER_FETCH_USER_LIST+" suc "+r),i.transKeysName(e.body,[["user_basic_list","user_baseinfos"]]),i.longToStringNumber(e.body,["server_user_seq","server_user_index","ret_user_index"],"toNumber"),t&&t(e,r)}),r)},je.prototype.sendRoomMsg=function(e,t,r,n){var i=this;return n={req_head:this.getReqHead(n),msg_category:e.msg_category,msg_priority:e.msg_priority,msg_type:e.msg_type,msg_content:Ne(e.msg_content)},e=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_SENDROOMMSG+" "+JSON.stringify(e)),e=Se.liveroom_cs.ImChatReq.create(n),n=Se.liveroom_cs.ImChatReq.encode(e).finish(),this.sendMessage("/lr/im/chat",n,(function(e){i.longToStringNumber(e.body,["msg_id"],"toNumber"),t&&t(e)}),r)},je.prototype.sendReliableMessage=function(e,t,r,n){return n={req_head:this.getReqHead(n),role:this.stateCenter.role,nick_name:this.nickName,trans_type:Ne(e.trans_type),trans_data:Ne(e.trans_data),trans_local_seq:e.trans_local_seq,trans_channel:Ne(e.trans_channel)},e=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_SENDRELIABLEMESSAGE+" "+JSON.stringify(e)),e=Se.liveroom_cs.TransReq.create(n),n=Se.liveroom_cs.TransReq.encode(e).finish(),this.sendMessage("/lr/trans/trans",n,t,r)},je.prototype.fetchReliableMessage=function(e,t,r,n){n=this.getReqHead(n);var i=e.fetch_array.map((function(e){return{trans_type:Ne(e.trans_type),trans_local_seq:e.trans_seq}}));return n={req_head:n,trans_channel:Ne(e.trans_channel),fetch_array:i},e=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_FETCHRELIABLEMESSAGE+" "+JSON.stringify(e)),i=Se.liveroom_cs.TransFetchReq.create(n),e=Se.liveroom_cs.TransFetchReq.encode(i).finish(),this.sendMessage("/lr/trans/transfetch",e,t,r)},je.prototype.sendCustomCommand=function(e,t,r,n){var i=this,o=(n=this.getReqHead(n),e.dest_id_name.map((function(e){return{id_name:Ne(e)}})));return n=Ue({req_head:n,dst_userlist:o,push_message:Ne(e.custom_msg)},e),o=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_SENDCUSTOMCOMMAND+" "+JSON.stringify(o)),e=Se.liveroom_cs.SignalLiveReq.create(n),o=Se.liveroom_cs.SignalLiveReq.encode(e).finish(),this.sendMessage("/lr/signal/livescustom",o,(function(e){t&&t(i.transRsp(e))}),(function(e){r&&r(i.transRspHead(e.rsp_head))}))},je.prototype.sendBigRoomMessage=function(e,t,r,n){return n=this.getReqHead(n),e=e.msgs.map((function(e){return{msg_category:e.msg_category,msg_type:e.msg_type,msg_timestamp:De.a.fromNumber(Date.now()),msg_content:Ne(e.msg_content),bigmsg_client_id:Ne(e.bigmsg_client_id)}})),n={req_head:n,nick_name:this.nickName,role:this.stateCenter.role,msgs:e},e=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_SENDBIGROOMMESSAGE+" "+JSON.stringify(e)),e=Se.liveroom_cs.BigimChatReq.create(n),n=Se.liveroom_cs.BigimChatReq.encode(e).finish(),this.sendMessage("/lr/bigim/chat",n,t,r)},je.prototype.sendRelayMessage=function(e,t,r,n){return n={req_head:this.getReqHead(n),nick_name:this.nickName,role:this.stateCenter.role,relay_type:Ne(e.relay_type),relay_data:Ne(e.relay_data)},e=Se.liveroom_cs.RelayReq.create(n),n=Se.liveroom_cs.RelayReq.encode(e).finish(),this.sendMessage("/lr/relay",n,t,r)},je.prototype.sendSignalCmd=function(e,t,r,n){var i="",o="";switch(e.sub_cmd){case 1003:i="/lr/signal/liveinvite",o="SignalLiveInviteReq";break;case 1001:i="/lr/signal/liverequest",o="SignalLiveReq";break;case 1002:i="/lr/signal/liverresult",o="SignalLiveResultReq";break;case 1004:i="/lr/signal/livestop",o="SignalLiveStopReq"}n=this.getReqHead(n);var s=e.dest_id_name.map((function(e){return{id_name:Ne(e)}}));return n={req_head:n,push_message:Ne(e.signal_msg),dst_userlist:s},e=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_SENDSIGNALCMD+" "+JSON.stringify(e)),s=Se.liveroom_cs[o].create(n),e=Se.liveroom_cs[o].encode(s).finish(),Se.liveroom_cs[o].decode(e),this.sendMessage(i,e,t,r)},je.prototype.sendStreamUpdate=function(e,t,r,n){var i,o=this;try{i=JSON.parse(e.stream_msg)}catch(e){}var s,a,c="",u=(this.logger.info(j.LIVEROOMHANDLER_SENDSTREAMUPDATE+" "+JSON.stringify(e)),this.stateCenter.roomModulesList.find((function(e){return e.roomID==n.roomID})));if(!u)return this.logger.error(j.LIVEROOMHANDLER_SENDSTREAMUPDATE+" room no found ignore "),-1;switch(e.sub_cmd){case 2001:c="/lr/stream/add",s="StreamAddReq",a={req_head:this.getReqHead(u),stream_id:Ne(i.stream_id),extra_info:Ne(i.extra_info),client_req_seq:this.seq+1,login_mode:1,third_token:Ne(e.third_token||"")};break;case 2002:c="/lr/stream/delete",s="StreamDeleteReq",a={req_head:this.getReqHead(u),stream_id:Ne(i.stream_id),stream_sid:i.stream_sid,client_req_seq:this.seq+1};break;case 2003:c="/lr/stream/update",s="StreamUpdateReq",a={req_head:this.getReqHead(u),stream_id:Ne(i.stream_id),stream_sid:i.stream_sid,client_req_seq:this.seq+1,extra_info:Ne(i.extra_info)}}var l=this.transBuf(a);return this.logger.info(j.LIVEROOMHANDLER_SENDSTREAMUPDATE+" "+JSON.stringify(l)),l=Se.liveroom_cs[s].create(a),l=Se.liveroom_cs[s].encode(l).finish(),this.sendMessage(c,l,(function(e){o.logger.info(j.LIVEROOMHANDLER_SENDSTREAMUPDATE+" suc "+c+" "+JSON.stringify(e)),e.header.room_id=u.roomID,t&&t(e)}),(function(e){o.logger.info(j.LIVEROOMHANDLER_SENDSTREAMUPDATE+" fail "+c+" "+JSON.stringify(e)),r&&r(e)}))},je.prototype.getStreamList=function(e,t,r,n){var i,o=this.stateCenter.roomModulesList.find((function(e){return e.roomID==n.roomID}));o?(o={req_head:this.getReqHead(o)},i=this.transBuf(o),this.logger.info(j.LIVEROOMHANDLER_GETSTREAMLIST+" "+JSON.stringify(i)),i=Se.liveroom_cs.StreamListReq.create(o),o=Se.liveroom_cs.StreamListReq.encode(i).finish(),this.sendMessage("/lr/stream/list",o,(function(e){t&&t(e)}),(function(e){r&&r(e)}))):this.logger.error(j.LIVEROOMHANDLER_GETSTREAMLIST+" room no found ignore "+n.roomID)},je.prototype.transBuf=function(e){var t=this,r={};return Object.keys(e).forEach((function(n){["logout_check","k2_sign","k1_sign"].includes(n)?r[n]=e[n]:t.transReqBytes(r,e,n)})),r},je.prototype.transReqBytes=function(e,t,r){var n=this;if(De.a.isLong(t[r]))e[r]=t[r].toString();else if("[object Object]"===Object.prototype.toString.call(t[r]))e[r]={},Object.keys(t[r]).forEach((function(i){return n.transReqBytes(e[r],t[r],i)}));else if("[object Array]"===Object.prototype.toString.call(t[r])&&"[object Object]"===Object.prototype.toString.call(t[r][0])){e[r]=[];for(var i=0;i<t[r].length;i++)!function(i){var o={};Object.keys(t[r][i]).forEach((function(e){n.transReqBytes(o,t[r][i],e)})),e[r].push(o)}(i)}else"[object Uint8Array]"===Object.prototype.toString.call(t[r])?e[r]=Pe(t[r]):e[r]=t[r]},je.prototype.transHeader=function(e){return e.timestamp=De.a.isLong(e.timestamp)?e.timestamp.toString():e.timestamp,e},je.prototype.transRsp=function(e){var t=this,r=e&&e.rsp_head?this.transRspHead(e.rsp_head):{},n=Ue(Ue({},e),r),i=(delete n.rsp_head,{});return Object.keys(n).forEach((function(e){"k2_sign"===e?i[e]=n[e]:t.transBytes(i,n,e)})),i},je.prototype.transBytes=function(e,t,r){var n=this;if(De.a.isLong(t[r]))e[r]=t[r];else if("[object Object]"===Object.prototype.toString.call(t[r]))e[r]={},Object.keys(t[r]).forEach((function(i){return n.transBytes(e[r],t[r],i)}));else if("[object Array]"===Object.prototype.toString.call(t[r])&&"[object Object]"===Object.prototype.toString.call(t[r][0])){e[r]=[];for(var i=0;i<t[r].length;i++)!function(i){var o={};Object.keys(t[r][i]).forEach((function(e){n.transBytes(o,t[r][i],e)})),e[r].push(o)}(i)}else"[object Uint8Array]"===Object.prototype.toString.call(t[r])?e[r]=Pe(t[r]):e[r]=t[r]},je.prototype.transRspHead=function(e){return e?{err_code:e.code||0,err_message:e.message}:{}},je.prototype.decode=function(e,t){return Ue({},e.decode(t))},je.prototype.handleDisconnected=function(e,t){var r=this;this.logger.info(j.LIVEROOMHANDLER_HANDLEDISCONNECTED+" call"),this.state=xe.disconnected,this.resetWaitCmd(),this.stateCenter.useNetAgent&&e===C.TIMEOUT&&this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(r.ua.isConnect()?(r.logger.info(j.LIVEROOMHANDLER_HANDLEDISCONNECTED+" ua is connect"),e.roomTryHandler.active()):(r.logger.info(j.LIVEROOMHANDLER_HANDLEDISCONNECTED+" ua is disconnect"),r.ua.connectUa()))}))},je.prototype.handleBroken=function(){this.logger.info(j.LIVEROOMHANDLER_HANDLEBROKEN+" call"),this.state=xe.broken,this.stateCenter.useNetAgent&&this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.onactive=function(t,r){e.roomHandler.disconnectedHandle(r)},e.roomTryHandler.startMaxTime(),e.roomHandler.roomStateHandle("CONNECTING",O.Reconnecting,A.NETWORK_BROKEN))}))},je.prototype.handleConnected=function(e){var t=this;this.logger.info(j.LIVEROOMHANDLER_HANDLECONNECTED+" call "+e),this.state=xe.connected,this.hasCryptSign=!1,this.resetWaitCmd(),this.stateCenter.useNetAgent&&(e===S.AUTO?this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&t.ua.isConnect()&&e.roomTryHandler.active()})):this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.stopMaxTime(),e.roomTryHandler.invalid())})))},je.prototype.resetWaitCmd=function(){this.waitDecryptCmdList=[],clearTimeout(this.waitDecryptTimer),this.waitDecryptTimer=null},je.prototype.renewToken=function(e,t,r,n){var i=this;n={req_head:this.getReqHead(n),token:e.token},e=Se.liveroom_cs.RenewTokenReq.create(n),e=Se.liveroom_cs.RenewTokenReq.encode(e).finish(),n=this.transBuf(n),this.logger.info(j.LIVEROOMHANDLER_RENEW_TOKEN+" "+JSON.stringify(n)),this.sendMessage("/lr/token/renew_token",e,(function(e,r){i.keysExist(e.body,["token_remain_time"]),t&&t(e,r)}),r)},je.prototype.reset=function(){this.logger.info(j.LIVEROOMHANDLER_RESET+" call "),this.state=xe.disconnected,this.switchSessionID=De.a.fromInt(0),this.sendDataCheckTimer&&clearTimeout(this.sendDataCheckTimer)},je.prototype.closeRequest=function(){var e;null!=(e=this.liveroomRequest)&&e.closeRequest()},je.prototype.resetSessionInfo=function(){this.switchSessionID=De.a.fromInt(0)},je);function je(e,t,r,n,i){var o=this;this.logger=e,this.stateCenter=t,this.ua=r,this.dataReport=n,this.rtm=i,this.seq=0,this.controls=new Uint8Array(1),this.flags=new Uint8Array(1),this.sendCommandList=new y,this.sendCommandMap={},this.isEncrypt=!1,this.hasCryptSign=!1,this.waitDecryptCmdList=[],this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=1e4,this.sendDataCheckInterval=2e3,this.protoInstance=be.a,this.swPushCmdList=["/sw/push","/sw/merge_push","/sw/push_kickout","/sw/push_redirect"],this.onSwitchCmdList=["/lr/login_room_rsp","/lr/logout_room_rsp","/sw/push_kickout","/sw/push","/sw/merge_push"],this.unEncryptCmdList=["/lr/login_room","/lr/login_room_rsp"],this.whiteboardPushCmdList=["/edu/push/set_room","/edu/push/set_user","/edu/push/joinlive","/edu/push/set_mod","/edu/push/draw_graphics","/edu/push/clear_graphics","/edu/push/draw_page_graphics","/edu/push/clear_page_graphics","/edu/push/clear_user_graphic_list","/edu/push/qaa","/edu/push/set_user_auth","/edu/push/set_room_auth"],this.state=xe.disconnected,this.unStructCmdList=["/lr/push/joinlive_request","/lr/push/joinlive_result","/lr/push/joinlive_invite","/lr/push/joinlive_stop"],this.joinLiveMap={"/lr/push/joinlive_request":11001,"/lr/push/joinlive_result":11002,"/lr/push/joinlive_invite":11003,"/lr/push/joinlive_stop":11004},this.reloginToken="",this.crypto=new we,this.liveroomRequest=this.ua.getPCRequest(R.SERVICE_SWITCH4LIVEROOM),this.switchSessionID=De.a.fromInt(0),null!=(e=this.liveroomRequest)&&e.on("connected",(function(e){o.handleConnected(e)})),null!=(t=this.liveroomRequest)&&t.on("broken",(function(){o.handleBroken()})),null!=(r=this.liveroomRequest)&&r.on("disconnected",(function(e,t){o.handleDisconnected(e,t)})),null!=(n=this.liveroomRequest)&&n.on("downLoadMessage",(function(e){o.handlePush(e)})),null!=(i=this.liveroomRequest)&&i.on("pcConnectedEvent",(function(e){var t=m();o.dataReport.newReport(t,re.kZegoSDKProxyConnect.event),o.dataReport.addMsgInfo(t,{recv_time:(new Date).getTime(),proxy_link_sources:e.proxy_link_sources}),o.dataReport.uploadReport(t)}))}var He=(Ge.prototype.listenCallBack=function(){var e=this;this.roomServicer.handlePushCustomMsg=function(t){e.handlePushCustomMsg(t)},this.roomServicer.handlePushTokenExpire=function(t){var r,n=null==(n=null==(n=null==t?void 0:t.body)?void 0:n.stop_stream)?void 0:n.stream_id_list.map(Pe);null!=(r=null==(r=null==t?void 0:t.body)?void 0:r.stop_stream)&&(r.stream_id_list=n),e.stateCenter.actionListener("_tokenExpired",t)},this.roomServicer.handlePushKickout=function(t,r){var n;r?function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e}([],e.stateCenter.roomModulesList).forEach((function(e){e.roomHandler.handlePushKickout(t,!0,!0)})):(n=null==(r=null==t?void 0:t.header)?void 0:r.room_id,r=e.stateCenter.roomModulesList.find((function(e){return e.roomID==n})),e.roomServicer.longToStringNumber(t.body,["session_id"],"toString"),r?r.roomHandler.handlePushKickout(t):e.logger.error(j.LIVEROOMHANDLER_PUSHKICKOUT+" room no found ignore "+JSON.stringify(null==(r=t.header)?void 0:r.room_id)))},this.roomServicer.handlePushStreamMsg=function(t){e.handlePushStreamMsg(t)},this.roomServicer.handlePushSignalMsg=function(t){e.handlePushSignalMsg(t)},this.roomServicer.handlePushMergeMsg=function(t){e.handlePushMergeMsg(t)},this.roomServicer.handlePushRoomMsg=function(t){e.handlePushRoomMsg(t)},this.roomServicer.handlePushTransMsg=function(t){e.handlePushTransMsg(t)},this.roomServicer.onSwitchMessage=function(t,r){e.onSwitchMessage(t,r)},this.roomServicer.handlePushUserStateUpdateMsg=function(t){var r,n=null==(i=null==t?void 0:t.header)?void 0:i.room_id,i=e.stateCenter.roomModulesList.find((function(e){return e.roomID==n}));i?(r={body:{user_actions:t.body.user_list.map((function(e){return{Action:e.action,IdName:e.id_name,NickName:e.nick_name,Role:e.role,LoginTime:e.login_time.toString()}})),user_list_seq:t.body.server_user_seq.toNumber(),room_id:t.body.room_id}},i.userHandler.handlePushUserStateUpdateMsg(r)):e.logger.error(j.LIVEROOMHANDLER_PUSHUSERUPDATE+" room no found ignore "+JSON.stringify(t))}},Ge.prototype.isDisConnect=function(){return!!this.roomServicer&&this.roomServicer.isDisConnect()},Ge.prototype.isUaConnect=function(){var e;return null==(e=this.roomServicer)?void 0:e.isUaConnect()},Ge.prototype.sendMessage=function(e,t,r,n,i,o){var s;return null==(s=this.roomServicer)?void 0:s.sendMessage(e,t,r,n,i)},Ge.prototype.handlePushTokenExpire=function(e){},Ge.prototype.handlePushKickout=function(e,t){},Ge.prototype.handlePushStreamMsg=function(e){},Ge.prototype.handlePushSignalMsg=function(e){},Ge.prototype.handlePushMergeMsg=function(e){},Ge.prototype.handlePushCustomMsg=function(e){},Ge.prototype.handlePushRoomMsg=function(e){},Ge.prototype.handlePushTransMsg=function(e){},Ge.prototype.onSwitchMessage=function(e,t){},Ge.prototype.handlePushUserStateUpdateMsg=function(e){},Ge.prototype.login=function(e,t,r){var n;null!=(n=this.roomServicer)&&n.login(e,t,r)},Ge.prototype.logout=function(e,t,r){var n;return null==(n=this.roomServicer)?void 0:n.logout(e,t,r)},Ge.prototype.startCheck=function(){var e;null!=(e=this.roomServicer)&&e.startCheck()},Ge.prototype.stopCheck=function(){var e;null!=(e=this.roomServicer)&&e.stopCheck()},Ge.prototype.getReqHead=function(e){var t;return null==(t=this.roomServicer)?void 0:t.getReqHead(e)},Ge.prototype.heartBeat=function(e,t,r){var n;null!=(n=this.roomServicer)&&n.heartBeat(e,t,r)},Ge.prototype.fetchUserList=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.fetchUserList(e,t,r,n)},Ge.prototype.sendRoomMsg=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.sendRoomMsg(e,t,r,n)},Ge.prototype.sendReliableMessage=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.sendReliableMessage(e,t,r,n)},Ge.prototype.fetchReliableMessage=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.fetchReliableMessage(e,t,r,n)},Ge.prototype.sendCustomCommand=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.sendCustomCommand(e,t,r,n)},Ge.prototype.sendBigRoomMessage=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.sendBigRoomMessage(e,t,r,n)},Ge.prototype.sendRelayMessage=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.sendRelayMessage(e,t,r,n)},Ge.prototype.sendSignalCmd=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.sendSignalCmd(e,t,r,n)},Ge.prototype.sendStreamUpdate=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.sendStreamUpdate(e,t,r,n)},Ge.prototype.getStreamList=function(e,t,r,n){var i;return null==(i=this.roomServicer)?void 0:i.getStreamList(e,t,r,n)},Ge.prototype.renewToken=function(e,t,r,n){var i;null!=(i=this.roomServicer)&&i.renewToken(e,t,r,n)},Ge.prototype.reset=function(){var e;null!=(e=this.roomServicer)&&e.reset()},Ge.prototype.closeRequest=function(){var e;null!=(e=this.roomServicer)&&e.closeRequest()},Ge);function Ge(e,t,r,n,i){this.logger=e,this.stateCenter=t,this.ua=r,this.dataReport=n,this.rtm=i,this.roomServicer=new Be(e,t,r,n,i),this.listenCallBack()}var ze=function(e,t,r,n){return new(r=r||Promise)((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},qe=function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var c=[s,a];if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,(c=i?[2&c[0],i.value]:c)[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(a){c=[6,a],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}},Ve=function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},Fe=(Object.defineProperty(Ze.prototype,"modules",{get:function(){return{service:this.service}},enumerable:!1,configurable:!0}),Ze.prototype.getSettingUnify=function(e){var t=this.stateCenter.settingConfig.getSetting("unify",e=void 0!==e&&e);return this.logger.info(j.RTM_GET_SETTING_UNIFY+" "+e+" "+JSON.stringify(t)),t?(e=t.enable,t=t.sdk_conn_ver,!!(e&&t<=F.connectVer)):this.stateCenter.useNetAgent},Ze.prototype.initCallback=function(){this.proxyRes=x.proxyRes,this.actionSuccessCallback=x.actionSuccessCallback,this.actionErrorCallback=x.actionErrorCallback,this.getServerError=x.getServerError,this.generateRandumNumber=x.generateRandumNumber,this.unregisterCallback=x.unregisterCallback,this.logReportCallback=x.logReportCallback,this.registerCallback=x.registerCallback},Ze.prototype.getStoreAppConfig=function(){this.logger.info(j.RTM_GETSTOREAPPCONFIG+" call");var e=localStorage.getItem(V+"_"+this.getAppID()+"_"+(this.stateCenter.mode||F.modeNo));if(e)try{var t=x.decryptStores(e,z);t?(this.stateCenter.appConfig=JSON.parse(t),this.stateCenter.actionListener("_appConfigRsp"),this.handleLogUpload()):localStorage.removeItem(V+"_"+this.getAppID()+"_"+(this.stateCenter.mode||F.modeNo))}catch(e){this.logger.warn(j.RTM_GETSTOREAPPCONFIG+" "+JSON.stringify(e))}else this.logger.info(j.RTM_GETSTOREAPPCONFIG+" no store config")},Ze.prototype.createNetAgent=function(){var e=this,t=(this.logger.info(j.RTM_CREATENETAGENT+" call"),this.netAgent.on("disconnected",(function(t){e.logger.info(j.RTM_CREATENETAGENT+" netAgent disconnect")})),this.netAgent.on("connected",(function(){e.logger.info(j.RTM_CREATENETAGENT+" netAgent connect"),e.stateCenter.useNetAgent?(e.fetchAppConfig(),e.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&e.netAgent.isConnect()&&t.roomTryHandler.active(!0)}))):e.logger.info(j.RTM_CREATENETAGENT+" unify false")})),this.netAgent.on("broken",(function(t){e.logger.info(j.RTM_CREATENETAGENT+" netAgent broken"),t===b.CLOSE&&e.stateCenter.roomModulesList.forEach((function(e){e.resetSessionInfo()}))})),this.netAgent.on("dispatchEvent",(function(t,r,n){var i;e.logger.info(j.RTM_CREATENETAGENT+" dispatch"),"start"===r?(i=m(),e.dataReport.newReport(i,re.kZegoConnDispatch.event),e.stateCenter.requestList[t]=i):"end"===r&&(i=e.stateCenter.requestList[t])&&(r="",r=null!=n&&n.reason?n.reason:e.dispatchServers?"UpdateDispatchResult":"NoDispatchResult",e.dataReport.addMsgInfo(i,{domain_list:re.kZegoConnDispatch.domain_list(n.domains),trigger_reason:re.kZegoConnDispatch.trigger_reason(r)}),e.dataReport.uploadReport(i))})),this.netAgent.on("dispatchResultUpdate",(function(t){t=t.servers,e.logger.info(j.RTM_CREATENETAGENT+" dispatchResult "+JSON.stringify(t)),t=x.encryptStores(JSON.stringify(t),z),localStorage.setItem(q+"_"+e.stateCenter.appid+"_"+(e.stateCenter.mode||F.modeNo),t)})),this.netAgent.on("connectedEvent",(function(t,r,n){var i;e.logger.info(j.RTM_CREATENETAGENT+" connect"),"start"===r?(i=m(),e.dataReport.newReport(i,re.kZegoConnConnect.event),e.stateCenter.requestList[t]=i):"end"===r&&(i=e.stateCenter.requestList[t])&&(e.dataReport.addMsgInfo(i,{server_list:re.kZegoConnConnect.server_list(n.servers),request_count:n.count,connect_id:n.connectid}),e.dataReport.uploadReport(i))})),this.netAgent.on("requestEvent",(function(t,r,n){var i;e.logger.info(j.RTM_CREATENETAGENT+" request"),"start"===r?(i=m(),e.dataReport.newReport(i,re.kZegoRequest.event),e.stateCenter.requestList[t]=i):"end"===r&&(i=e.stateCenter.requestList[t])&&(e.dataReport.addMsgInfo(i,{req_location:re.kZegoRequest.na_req_location(n.na_req_location),http_code:n.status_code,error:n.err_code}),e.dataReport.uploadReport(i))})),this.netAgent.on("disConnectedEvent",(function(t){var r=t.duration,n=t.server,i=(t=t.connectid,e.logger.info(j.RTM_CREATENETAGENT+" disconnect"),m());e.dataReport.newReport(i,re.kZegoConnDisConnect.event),e.dataReport.addMsgInfo(i,{server:re.kZegoConnDisConnect.server(n),connect_duration:r,connect_id:t}),e.dataReport.uploadReport(i)})),(null!=(t=this.options)&&t.accessDomains&&0<(null==(t=this.options)?void 0:t.accessDomains.length)?null==(t=this.options)?void 0:t.accessDomains:F.domains).map((function(e){return"wss://"+e+"/accesshub"})));this.netAgent.setBackupDomains(F.primaryDomains),this.netAgent.setNetAgentDefaultServers(t),null!=(t=this.options)&&t.customDomain&&this.netAgent.setNetAgentSpecifiedServers(["wss://accesshub-wss."+this.options.customDomain+"/accesshub"]),this.dispatchServers=this.getDispatchUrl(),this.netAgent.setDispatchConnectServers(this.dispatchServers)},Ze.prototype.getDispatchUrl=function(){var e=localStorage.getItem(q+"_"+this.stateCenter.appid+"_"+(this.stateCenter.mode||F.modeNo));if(e&&(e=x.decryptStores(e,z)))try{return JSON.parse(e)}catch(e){}return[]},Ze.prototype.bindWindowListener=function(){var e=this,t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),r=x.getBrowser(),n=t?"pagehide":"Firefox"===r?"beforeunload":"unload";window.addEventListener(n,(function(){e.logger.info(j.RTM_BIND_WINDOW_LISTENER+" "+n),e.logoutRoom()})),window.addEventListener("offline",(function(){e.netOffLineHandle()})),window.addEventListener("online",(function(){e.netOnLineHandle()}))},Ze.prototype.bindWxListener=function(){var e=this;wx.onNetworkStatusChange((function(t){t.isConnected?e.netOnLineHandle():e.netOffLineHandle()}))},Ze.prototype.retryRoom=function(){var e=this;this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&e.netAgent.isConnect()&&(t.resetSessionInfo(),t.roomTryHandler.active(!0))}))},Ze.prototype.netOnLineHandle=function(){var e=this;this.logger.info(j.RTM_BIND_WINDOW_LISTENER+" network is online"),this.stateCenter.networkState=o.online,this.stateCenter.useNetAgent||this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&e.service.isDisConnect()?t.roomTryHandler.active():t.roomTryHandler&&(t.roomTryHandler.stopMaxTime(),t.roomHandler.roomStateHandle("CONNECTED",O.Reconnected,{code:0,msg:""}))}))},Ze.prototype.netOffLineHandle=function(){this.logger.info(j.RTM_BIND_WINDOW_LISTENER+" network is broken"),this.stateCenter.networkState=o.offline,this.stateCenter.useNetAgent||this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.onactive=function(t,r){e.roomHandler.disconnectedHandle(r)},e.roomTryHandler.startMaxTime(),e.roomHandler.roomStateHandle("CONNECTING",O.Reconnecting,A.NETWORK_BROKEN))}))},Ze.prototype.setLogConfig=function(e){this.logger.info(j.RTM_SET_LOG_CONFIG+" call");var t=m();if(this.dataReport.newReport(t),e.logLevel&&["debug","info","warn","error","report","disable"].includes(e.logLevel)&&(this.logger.setLogLevel(e.logLevel),this.dataReport.addMsgInfo(t,{log_level:re.kZegoTaskSetLog.log_level(e.logLevel)})),e.remoteLogLevel&&["debug","info","warn","error","report","disable"].includes(e.remoteLogLevel)&&this.dataReport.addMsgInfo(t,{remote_log_level:re.kZegoTaskSetLog.remote_log_level(e.remoteLogLevel)}),"string"==typeof e.logURL&&(e.logURL.startsWith("wss://")||e.logURL.startsWith("https://")))this.logger.setLogServer(e.logURL),this.dataReport.addMsgInfo(t,{log_url:re.kZegoTaskSetLog.log_url(e.logURL)}),this.dataReport.uploadReport(t,re.kZegoTaskSetLog.event);else if(e.logURL)return this.logger.error(j.RTM_SET_LOG_CONFIG+"log url must be a wss or https url"),this.dataReport.addMsgInfo(t,re.kZegoTaskSetLog.error.kInvalidParamError),this.dataReport.uploadReport(t,re.kZegoTaskSetLog.event),!1;return this.logger.info(j.RTM_SET_LOG_CONFIG+" call success"),!0},Ze.prototype.setDebugVerbose=function(e){var t=m();this.dataReport.newReport(t),"boolean"==typeof e&&(this.stateCenter.debug=e,this.stateCenter.debugCustom=!0,this.dataReport.addMsgInfo(t,{debug:re.kZegoTaskSetDebug.debug(e?"true":"false")})),this.dataReport.uploadReport(t,re.kZegoTaskSetDebug.event),this.logger.info(j.RTM_SET_DEBUG_VERBOSE+" call success")},Ze.prototype.setDebug=function(e){"string"==typeof e&&-1<e.indexOf("wss")?this.stateCenter.debug=x.isTestEnv(e):Array.isArray(e)&&0<e.length&&e.every((function(e){return"string"==typeof e&&-1<e.indexOf("wss")}))?this.stateCenter.debug=x.isTestEnv(e[0]):this.logger.info(j.RTM_CONSTRUCTOR+" server wrong"),this.stateCenter.testEnvironment=this.stateCenter.debug},Ze.prototype.renewToken=function(e,t){var r,n=this,i=m();if(this.dataReport.newReport(i),void 0!==t&&("string"!=typeof t||""==t))return this.logger.error(j.RTM_RENEWTOKEN+" roomID must be string and no empty"),!1;var o,s,a=this.getRoomModules(t)||this.stateCenter.roomModulesList[0];return a?"string"==typeof e&&a.roomTryHandler?(e===a.roomTryHandler.token?this.logger.info(j.RTM_RENEWTOKEN+" token has not changed"):this.stateCenter.configRoomAuth?(o=function(t){var r;null!=(r=a.roomTryHandler)&&r.renewLocalToken(e,null==(r=null==t?void 0:t.body)?void 0:r.token_remain_time),n.cloudSetting.setToken(e),n.stateCenter.configCheckToken=!0,n.logger.info(j.RTM_RENEWTOKEN+" "+JSON.stringify(t))},s=function(t){var r=null==(r=null==t?void 0:t.body)?void 0:r.err_code;!r||1000002014!==r&&2014!==r?n.logger.error(j.RTM_RENEWTOKEN+" "+JSON.stringify(t)):(n.stateCenter.configCheckToken=!1,null!=(r=a.roomTryHandler)&&r.renewLocalToken(e),n.cloudSetting.setToken(e),n.logger.warn(j.RTM_RENEWTOKEN+" "+JSON.stringify(t)))},this.stateCenter.useNetAgent?null!=(r=this.liveRoomHandler)&&r.renewToken({token:e},o,s,a):this.service.sendMessage("renew_token",{token:e},o,s,void 0,{sessionID:a.sessionID,roomID:t,roomSessionID:a.roomSessionID})):(null!=(r=a.roomTryHandler)&&r.renewLocalToken(e),this.cloudSetting.setToken(e)),this.dataReport.uploadReport(i,re.kZegoTaskReNewToken.event),!0):("string"!=typeof e||a.roomTryHandler?(this.logger.error(j.RTM_RENEWTOKEN+" token must be string and not empty"),this.dataReport.addMsgInfo(i,{error:re.kZegoTaskReNewToken.error.INPUT_PARAM.code,message:re.kZegoTaskReNewToken.error.INPUT_PARAM.msg+" param token error"})):(this.logger.error(j.RTM_RENEWTOKEN+" calling must after loginRoom"),this.dataReport.addMsgInfo(i,{error:re.kZegoTaskReNewToken.error.NOT_LOGIN.code,message:re.kZegoTaskReNewToken.error.NOT_LOGIN.msg})),this.dataReport.uploadReport(i,re.kZegoTaskReNewToken.event),!1):(this.logger.error(j.RTM_RENEWTOKEN+" calling must after loginRoom"),this.dataReport.addMsgInfo(i,{error:re.kZegoTaskReNewToken.error.NOT_LOGIN.code,message:re.kZegoTaskReNewToken.error.NOT_LOGIN.msg}),this.dataReport.uploadReport(i,re.kZegoTaskReNewToken.event),!1)},Ze.prototype.setCloudSettingURLs=function(e){var t=this;this.logger.info(j.RTM_SET_CLOUD_SETTING_URLS+" call "),Array.isArray(e)&&0<e.length&&e.every((function(e){return"string"==typeof e&&-1<e.indexOf("http")}))&&this.cloudSetting.init({product:H.product,appID:this.stateCenter.appid,urls:e,env:this.stateCenter.ENV,pollingNotify:function(e,r){t.logger.info(j.RTM_SET_CLOUD_SETTING_URLS," setting file changed "+e+" "+JSON.stringify(r)),t.stateCenter.actionListener("_cloudSettingNotify",e,r)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment,unify:this.stateCenter.useNetAgent,connection:this.netAgent})},Ze.prototype.loginRoom=function(e,t,r,n){var s=this;return this.logger.info(j.RTM_LOGIN_ROOM+" call by user "+(null==r?void 0:r.userID)+" "+e),new Promise((function(a,c){return ze(s,void 0,void 0,(function(){var s,u,l,d,h=this;return qe(this,(function(p){switch(p.label){case 0:return 1!==this.stateCenter.ENV?[3,2]:[4,new Promise((function(e){wx.getNetworkType({success:function(t){h.stateCenter.networkState="none"===t.networkType?o.offline:o.online,e()},fail:function(t){h.logger.error(j.RTM_CONSTRUCTOR+" network "+JSON.stringify(t)),h.stateCenter.networkState=o.online,e()}})}))];case 1:p.sent(),p.label=2;case 2:return s=this.loginReport(a,c,t,n),l=s.interResolve,s=s.interReject,(n=n||{}).maxMemberCount||(n.maxMemberCount=0),this.netAgent&&(this.stateCenter.idName=r.userID,this.netAgent.setUserInfo(r.userID),this.stateCenter.actionListener("_roomLogin",e,t),this.netAgent.isConnect()&&this.fetchAppConfig(t)),this.cloudSetting.setUserID(r.userID),this.cloudSetting.setToken(t),this.cloudSetting.activePolling(),this.stateCenter.onListener("roomLoginResponse",(function(e){h.stateCenter.settingFetched||(h.getCloudSetting(),h.stateCenter.actionListener("_settingCanFetch"),h.stateCenter.settingFetched=!0)})),u=this.getRoomModules(e),d=re.kZegoTaskLoginRoom.error,u?(this.logger.setSessionInfo(this.stateCenter.appid,e,"",r.userID,"",this.stateCenter.sdKVersion),s(d.REPEATEDLY_LOGIN)):((u=new he(e,this.stateCenter,this.logger,this.dataReport,this.service,this,this.liveRoomHandler)).roomTryHandler||(u.roomTryHandler=new K(this.logger,this.stateCenter,u)),u.roomTryHandler.init(this.stateCenter.roomRetryTime),u.roomTryHandler.initRoom(u.roomHandler,e,t,r,this.stateCenter.server,this.stateCenter.serverBak,n),u.roomTryHandler.setLoginRoomCallback(l,s),u.roomHandler.roomStateHandle("CONNECTING",O.Logining,{code:0,msg:""}),(l=function(e,t){var r,n,i=[],o={};for(r in e)o[e[r].order]=e[r],e[r].key=r;for(n in o)i.push(o[n]);for(var s=0;s<i.length;s++)for(var a=i[s].rules,c=0;c<a.length;c++){var u={key:i[s].key,value:i[s].value,action:t.action,logger:t.logger},l=u.value,d=a[c].name?""+a[c].name:"";if((void 0===l&&d===Q.NOT_EMPTY||void 0!==l)&&$[d]&&(d=$[d](u.key,l,u.action,u.logger,a[c]))!=X)return d}return X}({roomID:{order:0,value:e,rules:[{name:Q.NOT_EMPTY,error:d.ROOM_ID_NULL},{name:Q.TYPE_STRING,error:d.INPUT_PARAM,extMsg:"roomID must be string"},{name:Q.MAX_LENGTH_128,error:d.ROOM_ID_TOO_LONG},{name:Q.ILLEGAL_CHARACTERS,error:d.ROOM_ID_INVALID_CHARACTER}]},token:{order:1,value:t,rules:[{name:Q.NOT_EMPTY,error:d.INPUT_PARAM},{name:Q.TYPE_STRING,error:d.INPUT_PARAM}]},user:{order:2,value:r,rules:[{name:Q.NOT_EMPTY,error:d.INPUT_PARAM,extMsg:" param user error."},{name:Q.TYPE_OBJECT,error:d.INPUT_PARAM,extMsg:" param user error."}]},"user.userID":{order:3,value:r.userID,rules:[{name:Q.NOT_EMPTY,error:d.USER_ID_NULL,extMsg:" param user error."},{name:Q.TYPE_STRING,error:d.INPUT_PARAM,extMsg:" param userID error."},{name:Q.MAX_LENGTH_64,error:d.USER_ID_TOO_LONG},{name:Q.ILLEGAL_CHARACTERS,error:d.USER_ID_INVALID_CHARACTER}]},"user.userName":{order:4,value:r.userName,rules:[{name:Q.TYPE_STRING,error:d.INPUT_PARAM,extMsg:" userName must be string."},{name:Q.MAX_LENGTH_256,error:d.USER_NAME_TOO_LONG}]},config:{order:5,value:n,rules:[]},"config.maxMemberCount":{order:6,value:n.maxMemberCount,rules:[{name:Q.TYPE_INTEGER,error:d.INPUT_PARAM,extMsg:" maxMemberCount must be integer number."}]}},{action:j.RTM_LOGIN_ROOM,logger:this.logger}))!==X?(u.roomHandler.roomStateHandle("DISCONNECTED",O.LoginFailed,l.error,l.extMsg),s(l.error,l.extMsg)):(0<this.stateCenter.roomModulesList.length&&1==this.stateCenter.isMultiRoom?u.isMulti=!0:Ve([],this.stateCenter.roomModulesList).forEach((function(e){return e.roomHandler.logout()})),n&&(u.config=n),this.stateCenter.roomModulesList.push(u),d=this.stateCenter.settingConfig.getSetting("room_server",!0),Array.isArray(d)&&0<d.length&&(this.logger.info(j.RTM_LOGIN_ROOM," setting room_server "+d),this.stateCenter.server=d[0],this.stateCenter.serverBak=d[1]||d[0]),this.stateCenter.setMultiRoom=!0,u.roomTryHandler.startMaxTime(),this.stateCenter.useNetAgent&&!this.netAgent.isConnect()?(this.logger.info(j.RTM_LOGIN_ROOM," us is not connected"),u.roomHandler.setRunState(i.trylogin),this.netAgent.connectUa()):(this.stateCenter.useNetAgent&&(this.stateCenter.networkState=o.online),u.roomTryHandler.active(!0)))),[2]}}))}))}))},Ze.prototype.handleLogUpload=function(){var e=this.stateCenter.appConfig.app_config.domain;e&&(this.stateCenter.logDomain="weblogger"+this.stateCenter.appid+"-api."+e,e="",e=0===this.stateCenter.ENV?"wss://"+this.stateCenter.logDomain+"/log":"https://"+this.stateCenter.logDomain+"/httplog",this.logger.setLogServer(e))},Ze.prototype.fetchAppConfig=function(e){return ze(this,void 0,void 0,(function(){var t,r,n,i,o,s;return qe(this,(function(a){switch(a.label){case 0:if(this.stateCenter.appConfigFetched)return this.logger.warn(j.RTM_FETCH_APP_CONFIG+" config fetched"),[2];if(!this.getUserID())return this.logger.warn(j.RTM_FETCH_APP_CONFIG+" user not exist"),[2];if(t="",e)t=e;else{if(!(0<this.stateCenter.roomModulesList.length))return this.logger.warn(j.RTM_FETCH_APP_CONFIG+" token not exist"),[2];t=this.getToken()}r=m(),this.dataReport.newReport(r,re.kZegoSDKConfigInit.event),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.netAgent.getAppConfigByAgent("init",t,5e3)];case 2:return n=a.sent(),i=n.code,n=n.data,this.dataReport.addMsgInfo(r,{trigger_reason:"refresh"}),this.dataReport.uploadReport(r),this.stateCenter.appConfigFetched=!0,this.logger.info(j.RTM_LOGIN_ROOM+" initConfig code:"+i+" data: "+JSON.stringify(n)),i=n.app_config,s=n.media_config,o=s.publish_config,s=s.play_config,n=n.speedlog_config.charge_info_report_no_playing,this.stateCenter.appConfig={app_config:i,media_config:{publish_config:o,play_config:s},speedlog_config:{charge_info_report_no_playing:n||0}},i=JSON.stringify(this.stateCenter.appConfig),o=x.encryptStores(i,z),localStorage.setItem(V+"_"+this.getAppID()+"_"+(this.stateCenter.mode||F.modeNo),o),this.handleLogUpload(),this.stateCenter.appConfig||this.stateCenter.actionListener("_appConfigRsp"),[3,4];case 3:return s=a.sent(),this.logger.error(j.RTM_LOGIN_ROOM+" fail "+JSON.stringify(s)),this.dataReport.addMsgInfo(r,{trigger_reason:"refresh"}),this.dataReport.uploadReport(r),[20012,20008].includes(null==s?void 0:s.code)&&this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&e.roomTryHandler.loginFail(A.APPID_INVALID)})),[3,4];case 4:return[2]}}))}))},Ze.prototype.getCloudSetting=function(){var e=this;this.cloudSetting.fetchMultiSetting([G,"room"]).then((function(t){var r,n;e.logger.info(j.RTM_LOGIN_ROOM," settingConfig "+JSON.stringify(t)),t&&(e.stateCenter.settingConfig.setSetting(null==(t=null==t?void 0:t.init)?void 0:t.setting,["remote_log_level"]),(t=e.stateCenter.settingConfig.getSetting("remote_log_level",!0))&&(e.logger.info(j.RTM_LOGIN_ROOM+"  setting remote_log_level "+t),e.logger.setRemoteLogLevel(t)),(t=e.stateCenter.settingConfig.getSetting("unify",e.stateCenter.netHasSet))&&(e.logger.info(j.RTM_LOGIN_ROOM+" unify "+JSON.stringify(t)),r=t.enable,t=t.sdk_conn_ver,n=!!(r&&t<=F.connectVer),!0===e.stateCenter.useNetAgent&&!1===n&&(e.cloudSetting.setOptions({unify:!1}),"connecting"!==e.stateCenter.connectState&&(e.stateCenter.connectState="connecting",e.stateCenter.actionListener("_connectChanged","connecting")),r=Ve([],e.stateCenter.roomModulesList),Ve([],e.stateCenter.roomModulesList).forEach((function(e){e.roomHandler.logout(!0,!0)})),e.stateCenter.useNetAgent=n,r.forEach((function(t){var r;e.stateCenter.roomModulesList.push(t),t.roomTryHandler||(t.roomTryHandler=new K(e.logger,e.stateCenter,t)),t.roomTryHandler.init(e.stateCenter.roomRetryTime),t.roomTryHandler.initRoom(t.roomHandler,t.roomID,t.token,{userID:e.stateCenter.idName,userName:e.stateCenter.nickName},e.stateCenter.server,e.stateCenter.serverBak,t.config),null!=(r=t.roomTryHandler)&&r.startMaxTime(),t.roomTryHandler.onactive=function(r,n){r?"connected"!==e.stateCenter.connectState&&(e.stateCenter.connectState="connected",e.stateCenter.actionListener("_connectChanged","connected",{roomID:t.roomID})):t.roomHandler.disconnectedHandle(n)},null!=(r=t.roomTryHandler)&&r.active()})))))})).catch((function(t){e.logger.warn(j.RTM_LOGIN_ROOM," settingConfig "+JSON.stringify(t))})),this.stateCenter.onListener("_cloudSettingNotify",(function(t,r){var n=m(),i=(e.dataReport.newReport(n,re.kZegoTaskCloudSettingRefresh.event),e.cloudSetting.getEnvVariables());e.dataReport.addMsgInfo(n,{params:i,files:[{name:t,content:r.setting,versions:r.versions}]}),e.dataReport.uploadReport(n),t===G&&(e.stateCenter.settingConfig.setSetting(null==r?void 0:r.setting,["remote_log_level"]),(i=e.stateCenter.settingConfig.getSetting("remote_log_level"))&&(e.logger.info(j.RTM_LOGIN_ROOM," setting remote_log_level "+i),e.logger.setRemoteLogLevel(i)))}))},Ze.prototype.cloudReportNotify=function(e,t,r){var n;"request_start"===t?(n=m(),this.dataReport.newReport(n,re.kZegoTaskCloudSettingRequest.event),this.stateCenter.settingConfig.requestList[e]=n):"request_end"===t&&(n=this.stateCenter.settingConfig.requestList[e])&&(this.dataReport.addMsgInfo(n,{request_detail:null==r?void 0:r.reportData,files:null==r?void 0:r.files,error:null==r?void 0:r.code,request_params:null==r?void 0:r.params}),this.dataReport.uploadReport(n))},Ze.prototype.loginReport=function(e,t,r,n){var i=this,o=m(),s=(this.stateCenter.reportSeqList.login=o,re.kZegoTaskLoginRoom),a=(this.dataReport.newReport(o,s.event),this.cloudSetting.getEnvVariable("deviceid"));return this.dataReport.addMsgInfo(o,{deviceid:a,use_na:this.stateCenter.useNetAgent?1:0}),"string"==typeof r&&this.dataReport.addMsgInfo(o,{token:s.token(r),isMulti:this.stateCenter.isMultiRoom}),n&&(n.userUpdate&&"boolean"==typeof n.userUpdate&&this.dataReport.addMsgInfo(o,{user_update:s.user_update(n.userUpdate+"")}),n.maxMemberCount&&"number"==typeof n.maxMemberCount&&this.dataReport.addMsgInfo(o,{max_member_count:s.max_member_count(n.maxMemberCount+"")})),x.logReportCallback(s.event,this.dataReport,o,this.stateCenter.reportList),{interResolve:function(t){i.dataReport.uploadReport(o),i.stateCenter.reportSeqList.login=0,x.unregisterCallback(s.event,i.stateCenter.reportList),e(t)},interReject:function(e,r){var n,a;void 0===r&&(r=""),e.code<2e9&&1e9<e.code||e.code<1e6?(n=x.decodeServerError(e.code,e.msg),a=x.getLiveRoomError(e.code,i.stateCenter.useNetAgent)):n={code:e.code,message:e.msg},n&&i.dataReport.addMsgInfo(o,{error:n.code,message:n.message+r}),i.dataReport.uploadReport(o),i.stateCenter.reportSeqList.login=0,x.unregisterCallback(s.event,i.stateCenter.reportList),a&&A[a]&&(e.code=A[a].code),e.code&&e.msg&&""!==r?t({code:e.code,msg:e.msg+r}):t(e)}}},Ze.prototype.logoutRoom=function(e){var t=this,r=(this.logger.info(j.RTM_LOGOUT_ROOM+" call by user "+e),m());this.dataReport.newReport(r),this.dataReport.addMsgInfo(r,{roomid:e,isMulti:this.stateCenter.isMultiRoom}),void 0===e?(Ve([],this.stateCenter.roomModulesList).forEach((function(e){e.roomHandler.logout(!0),t.dataReport.addMsgInfo(r,{roomid:null==e?void 0:e.roomID,isMulti:t.stateCenter.isMultiRoom}),t.dataReport.uploadReport(r,re.kZegoTaskLogoutRoom.event)})),this.cloudSetting.uninit()):("string"!=typeof e||""==e?(this.logger.error(j.RTM_LOGOUT_ROOM+" roomID must be string and not empty"),this.dataReport.addMsgInfo(r,{error:re.kZegoTaskLogoutRoom.error.INPUT_PARAM.code,message:re.kZegoTaskLogoutRoom.error.INPUT_PARAM.msg+" param roomID error"})):(e=this.getRoomModules(e))?(e.roomHandler.logout(),0===this.stateCenter.roomModulesList.length&&this.cloudSetting.uninit()):(this.logger.error(j.RTM_LOGOUT_ROOM+" room not exist"),this.dataReport.addMsgInfo(r,{error:re.kZegoTaskLogoutRoom.error.ROOM_NOT_EXIST.code,message:re.kZegoTaskLogoutRoom.error.ROOM_NOT_EXIST.msg})),this.dataReport.uploadReport(r,re.kZegoTaskLogoutRoom.event))},Ze.prototype.loginHall=function(e,t,r){var n=this;return new Promise((function(e,t){return ze(n,void 0,void 0,(function(){return qe(this,(function(e){return[2]}))}))}))},Ze.prototype.loginHallReport=function(e,t,r,n){},Ze.prototype.logoutHall=function(){},Ze.prototype.enterRoom=function(e,t){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype.leaveRoom=function(){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype.sendCustomCommand=function(e,t,r){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype._sendCustomCommand=function(e,t,r){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype.sendBroadcastMessage=function(e,t){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype._sendBroadcastMessage=function(e,t,r,n){return void 0===r&&(r=1),void 0===n&&(n=1),new Promise((function(e,t){console.error(k),t()}))},Ze.prototype.setRoomExtraInfo=function(e,t,r){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype._setRoomExtraInfo=function(e,t,r){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype.sendBarrageMessage=function(e,t){return new Promise((function(e,t){console.error(k),t()}))},Ze.prototype._sendBarrageMessage=function(e,t,r,n){return void 0===r&&(r=1),void 0===n&&(n=1),new Promise((function(e,t){console.error(k),t()}))},Ze.prototype.sendRelayMessage=function(e,t,r,n,i){console.error(k)},Ze.prototype.requestJoinLive=function(e,t,r,n,i){return console.error(k),!1},Ze.prototype.inviteJoinLive=function(e,t,r,n,i){return console.error(k),!1},Ze.prototype.endJoinLive=function(e,t,r,n){return console.error(k),!1},Ze.prototype.respondJoinLive=function(e,t,r,n,i){return console.error(k),!1},Ze.prototype.getVersion=function(){return this.version},Ze.prototype.setSdkBizVersion=function(e){"string"==typeof e&&""!==e&&(this.stateCenter.bizVersion=e)},Ze.prototype.on=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error(j.RTM_ON+" listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error(j.RTM_ON+" event "+e+" no found"),!1)},Ze.prototype.off=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error(j.RTM_OFF+" listener no found"),!1;var r=this.stateCenter.listenerList[e];return t?r.splice(r.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},Ze.prototype._on=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error(j.RTM_ON+" listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error(j.RTM_ON+" event "+e+" no found"),!1)},Ze.prototype._off=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error(j.RTM_OFF+" listener no found"),!1;var r=this.stateCenter.listenerList[e];return t?r.splice(r.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},Ze.prototype.isTestEnvironment=function(){return this.stateCenter.testEnvironment},Ze.prototype.isLogin=function(e){return!!(e=this.getRoomModules(e)||this.stateCenter.roomModulesList[0])&&e.isLogin()},Ze.prototype.getMultiRoom=function(){return this.stateCenter.isMultiRoom},Ze.prototype.getAppID=function(){return this.stateCenter.appid},Ze.prototype.getUserID=function(){return this.stateCenter.idName},Ze.prototype.getUseNetAgent=function(){return this.stateCenter.useNetAgent},Ze.prototype.getToken=function(e){return(this.getRoomModules(e)||this.stateCenter.roomModulesList[0]).token},Ze.prototype.setRoomCreateFlag=function(e){this.stateCenter.roomCreateFlag=e},Ze.prototype.setRole=function(e){this.stateCenter.role=e},Ze.prototype.getSessionId=function(e){return(e=this.getRoomModules(e)||this.stateCenter.roomModulesList[0])?e.sessionID:"0"},Ze.prototype.getRoomSessionID=function(e){return(e=this.getRoomModules(e)||this.stateCenter.roomModulesList[0])?e.roomSessionID:"0"},Ze.prototype.getAppConfig=function(){return this.stateCenter.appConfig},Ze.prototype.setAccess=function(e){this.stateCenter.netHasSet=!0,this.stateCenter.useNetAgent=e,this.stateCenter.useNetAgent=this.getSettingUnify(!0),this.netAgent.setAccess(this.stateCenter.useNetAgent),this.cloudSetting.setOptions({unify:this.stateCenter.useNetAgent})},Ze.prototype.enableMultiRoom=function(e){var t=m();return this.dataReport.newReport(t,re.kZegoEnableMultiRoom.event),this.dataReport.addMsgInfo(t,{isMulti:e}),"boolean"!=typeof e?(this.logger.error(j.RTM_ENABLE_MULTI_ROOM+" param must be boolean"),this.dataReport.uploadReport(t,void 0,re.kZegoEnableMultiRoom.error.kAlreadyLoginError),!1):0<this.stateCenter.roomModulesList.length||this.stateCenter.setMultiRoom?(this.logger.error(j.RTM_ENABLE_MULTI_ROOM+" multi room can only be set once before first login"),this.dataReport.uploadReport(t,void 0,re.kZegoEnableMultiRoom.error.kAlreadyLoginError),!1):(this.dataReport.uploadReport(t),this.stateCenter.isMultiRoom=e,this.stateCenter.setMultiRoom=!0)},Ze.prototype.getRoomModules=function(e){return this.stateCenter.roomModulesList.find((function(t){return t.roomID==e}))},Ze.use=function(e){switch(e.type){case"message":case"live":e.install(Ze,he,_e,He)}},Ze.prototype.resetRoomTokenTimer=function(e,t){(e=this.getRoomModules(e)||this.stateCenter.roomModulesList[0])&&t&&0<t&&e.roomHandler.resetTokenTimer(1e3*t-this.stateCenter.local_time_deviation)},Ze.prototype.isDisConnect=function(){return(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).isDisConnect()},Ze.prototype.sendMessage=function(e,t,r,n){(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendMessage(e,t,r,n)},Ze.prototype.setProtoFormat=function(e){if(!["json","pb"].includes(e=void 0===e?"json":e))throw new Error("Failed to execute 'setProtoFormat': Arguments 'format' must be 'json' or 'pb'.");this.stateCenter.protoFormat=e},Ze.prototype.setSdkLoginRelateService=function(e){Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))&&(this.stateCenter.relateService=e)},Ze.prototype.sendMessageByService=function(e,t,r,n,i,o){return this.service.sendMessage(e,t,r,n,i,o)},Ze.prototype.getHeader=function(e){var t,r,n=this.stateCenter.roomModulesList[0];if(n&&n.isLogin())return t=n.roomID,r=n.sessionID,n=n.roomSessionID,this.service.getHeader(e,r,t,n);this.logger.error(j.RTM_GET_HEADER+" room no found or no login")},Ze.prototype.sendPB=function(e){return e instanceof Uint8Array?this.service.sendPB(e):(this.logger.error(j.RTM_SEND_PB+" type error"),!1)},Ze.prototype.onPushBizChannel=function(e){e&&this.service.on("push_biz_channel",e)},Ze.prototype.getRoomID=function(){return this.stateCenter.roomid},Ze.prototype.getServerTimeOffset=function(){return this.stateCenter.serverTimeOffset},Ze.prototype.isUseNetAgent=function(){return this.stateCenter.useNetAgent},Ze.prototype.getReqHead=function(e){return e="string"==typeof e&&""!==e&&this.getRoomModules(e)||this.stateCenter.roomModulesList[0],this.liveRoomHandler.getReqHead(e)},Ze.prototype.sendSwitchMessage=function(e,t){return"string"==typeof e&&t?this.liveRoomHandler.sendMessage(e,t,void 0,void 0,void 0,!1):-1},Ze.prototype.onSwitchMessage=function(e){e&&this.liveRoomHandler&&(this.liveRoomHandler.onSwitchMessage=e)},Ze);function Ze(e,t,r,n,i,s,a,c){var u=this;if(this.logger=r,this.dataReport=n,this.cloudSetting=i,this.version=s,this.options=c,this.stateCenter=new ne(this.logger,this.dataReport),this.stateCenter.ENV=a,this.getReportSeq=m,this.getSeq=g,this.initCallback(),r=m(),this.dataReport.newReport(r),0!=a&&1!=a||this.setDebug(t),x.checkConfigParam(e,t,this.logger)){this.stateCenter.appid=e,this.stateCenter.configOK=!0,this.stateCenter.sdKVersion=this.version,this.stateCenter.testEnvironment&&(this.stateCenter.mode=T.MODE_TEST),this.netAgent=new L,this.logger.setSessionInfo(this.stateCenter.appid,"","","","",this.version),this.netAgent.init(),this.netAgent.setLogger(this.logger),this.netAgent.setAppInfo({appID:this.stateCenter.appid,env:this.stateCenter.ENV,mode:this.stateCenter.mode}),this.liveRoomHandler=new He(this.logger,this.stateCenter,this.netAgent,this.dataReport,this),this.service=new _e(this.stateCenter,this.logger,this),this.stateCenter.deviceID=x.generateUUID(a),this.stateCenter.settingConfig=new ye,this.cloudSetting.setLog(this.logger),this.cloudSetting.init({product:H.product,appID:e,urls:H.URL,env:a,pollingNotify:function(e,t){u.logger.info(j.RTM_CONSTRUCTOR," setting file changed "+e+" "+JSON.stringify(t)),u.stateCenter.actionListener("_cloudSettingNotify",e,t)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment,unify:this.stateCenter.useNetAgent,connection:this.netAgent}),(n=this.stateCenter.settingConfig.getSetting("remote_log_level"))&&(this.logger.info(j.RTM_CONSTRUCTOR+" setting remote_log_level default "+n),this.logger.setRemoteLogLevel(n)),i="",0===a?i="rtc":1===a&&(i="xcx"),this.cloudSetting.setEnvVariable("environment",i),s=this.cloudSetting.getSettingCache(G),c=this.cloudSetting.getSettingCache("room");var l=!1,d=setTimeout((function(){u.logger.warn(j.RTM_CONSTRUCTOR+" time out, get cache settings failed!"),u.stateCenter.useNetAgent=!0,l=!0,u.createNetAgent(),u.getStoreAppConfig()}),3e3);if(Promise.all([s,c]).then((function(e){d&&clearTimeout(d);var t=null==e?void 0:e[0],r=(u.stateCenter.settingConfig.setSetting(null==t?void 0:t.setting),u.stateCenter.useNetAgent=u.getSettingUnify(u.stateCenter.netHasSet),u.cloudSetting.setOptions({unify:u.stateCenter.useNetAgent}),u.stateCenter.useNetAgent&&!l&&(u.createNetAgent(),u.getStoreAppConfig()),(r=u.stateCenter.settingConfig.getSetting("remote_log_level",!0))&&(u.logger.info(j.RTM_CONSTRUCTOR+"  setting remote_log_level "+r),u.logger.setRemoteLogLevel(r)),null==e?void 0:e[1]);u.stateCenter.settingConfig.setSetting(null==r?void 0:r.setting),e=m(),u.dataReport.newReport(e,re.kZegoTaskCloudSettingCache.event),u.dataReport.addMsgInfo(e,{files:[{name:G,content:null==t?void 0:t.setting,versions:null==t?void 0:t.versions},{name:"room",content:null==r?void 0:r.setting,versions:null==r?void 0:r.versions}]}),u.dataReport.uploadReport(e)})).catch((function(e){d&&clearTimeout(d),u.logger.warn(j.RTM_CONSTRUCTOR+"  initConfig "+JSON.stringify(e))})),"string"==typeof t?(this.stateCenter.server=t,this.stateCenter.serverBak=t):Array.isArray(t)&&0<t.length&&(this.stateCenter.server=t[0],this.stateCenter.serverBak=t[1]||t[0]),0==a||2==a)this.bindWindowListener(),this.logger.info(j.RTM_CONSTRUCTOR+"  "+navigator.appVersion),this.stateCenter.networkState=!navigator||navigator.onLine?o.online:o.offline,this.dataReport.addMsgInfo(r,{system_info:re.kZegoTaskInitSetting.system_info});else if(1==a||3==a){this.bindWxListener();try{var h=wx.getSystemInfoSync(),p={brand:h.brand,model:h.model,system:h.system,platform:h.platform,version:h.version,SDKVersion:h.SDKVersion};this.dataReport.addMsgInfo(r,{system_info:p}),this.logger.warn(j.RTM_CONSTRUCTOR+" "+JSON.stringify(p))}catch(e){this.logger.warn(j.RTM_CONSTRUCTOR+" get system info error")}}}else this.logger.error(j.RTM_CONSTRUCTOR+" init sdk error"),this.dataReport.addMsgInfo(r,re.kZegoTaskInitSetting.error.kInvalidParamError);this.dataReport.uploadReport(r,re.kZegoTaskInitSetting.event)}var We=r(12),Ye=(Qe.prototype.setLog=function(e){this.zegoSetting.setLog(e)},Qe.prototype.init=function(e){this.zegoSetting.init(e)},Qe.prototype.setEnvVariable=function(e,t){this.zegoSetting.setEnvVariable(e,t)},Qe.prototype.getEnvVariables=function(){return this.zegoSetting.getEnvVariables()},Qe.prototype.fetchSetting=function(e,t,r){return this.zegoSetting.fetchSetting(e,t,r)},Qe.prototype.fetchMultiSetting=function(e,t,r){return this.zegoSetting.fetchMultiSetting(e,t,r)},Qe.prototype.setOptions=function(e){return this.zegoSetting.setOptions(e)},Qe.prototype.getSettingCache=function(e){return this.zegoSetting.getSettingCache(e)},Qe.prototype.setToken=function(e){this.zegoSetting.setToken(e)},Qe.prototype.setUserID=function(e){this.zegoSetting.setUserID(e)},Qe.prototype.activePolling=function(){this.zegoSetting.activePolling()},Qe.prototype.uninit=function(){var e;null!=(e=this.zegoSetting)&&e.uninit()},Qe.prototype.getEnvVariable=function(e){this.zegoSetting.getEnvVariable(e)},Qe);function Qe(){this.isLoad=!1,this.callBackList=[],this.zegoSetting=new We.ZegoSetting}Je.prototype.enableMultiRoom=function(e){return this.zegoWebRTM.enableMultiRoom(e)},Je.prototype.loginRoom=function(e,t,r,n){return this.zegoWebRTM.loginRoom(e,t,r,n)},Je.prototype.logoutRoom=function(e){return this.zegoWebRTM.logoutRoom(e)},Je.prototype.renewToken=function(e,t){return this.zegoWebRTM.renewToken(e,t)},Je.prototype.sendBarrageMessage=function(e,t){return this.zegoWebRTM.sendBarrageMessage(e,t)},Je.prototype.sendBroadcastMessage=function(e,t){return this.zegoWebRTM.sendBroadcastMessage(e,t)},Je.prototype.sendCustomCommand=function(e,t,r){return this.zegoWebRTM.sendCustomCommand(e,t,r)},Je.prototype.setRoomExtraInfo=function(e,t,r){return this.zegoWebRTM.setRoomExtraInfo(e,t,r)},Je.prototype.setLogConfig=function(e){return this.zegoWebRTM.setLogConfig(e)},Je.prototype.setDebugVerbose=function(e){return this.zegoWebRTM.setDebugVerbose(e)},Je.prototype.on=function(e,t){return this.zegoWebRTM.on(e,t)},Je.prototype.getVersion=function(){return this.zegoWebRTM.getVersion()},Je.prototype.off=function(e,t){return this.zegoWebRTM.off(e,t)},Je.prototype.loginHall=function(e,t,r){return this.zegoWebRTM.loginHall(e,t,r)},Je.prototype.logoutHall=function(){return this.zegoWebRTM.logoutHall()},Je.prototype.enterRoom=function(e,t){return this.zegoWebRTM.enterRoom(e,t)},Je.prototype.leaveRoom=function(){return this.zegoWebRTM.leaveRoom()},Je.use=function(e){Fe.use(e)},Je.version="1.19.2";var Ke=Je;function Je(e,t,r,n){this.logger=new c.ZegoLogger(r=void 0===r?0:r),this.dataReport=new c.ZegoDataReport(this.logger),this.cloudSetting=new Ye,this.zegoWebRTM=new Fe(e,t,this.logger,this.dataReport,this.cloudSetting,Je.version,r,n)}}],n={},t.m=r,t.c=n,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(t){return e[t]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=21);function t(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return r[e].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r,n}(r(5459))},5459:function(e,t,r){"use strict";e.exports=r(259)},259:function(e,t,r){"use strict";var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(1513),n.BufferWriter=r(2601),n.Reader=r(8859),n.BufferReader=r(475),n.util=r(9131),n.rpc=r(7126),n.roots=r(8731),n.configure=i,i()},8859:function(e,t,r){"use strict";e.exports=c;var n,i=r(9131),o=i.LongBits,s=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},l=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new n(e):u(e)})(e)}:u};function d(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=l(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=l(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},475:function(e,t,r){"use strict";e.exports=o;var n=r(8859);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9131);function o(e){n.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},8731:function(e){"use strict";e.exports={}},7126:function(e,t,r){"use strict";t.Service=r(2925)},2925:function(e,t,r){"use strict";e.exports=i;var n=r(9131);function i(e,t,r){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return n.asPromise(e,a,t,r,i,o);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)}))}catch(c){return a.emit("error",c,t),void setTimeout((function(){s(c)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},8685:function(e,t,r){"use strict";e.exports=i;var n=r(9131);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"===typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?o:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},9131:function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=r(7214),n.base64=r(734),n.EventEmitter=r(7875),n.float=r(249),n.inquire=r(6858),n.utf8=r(248),n.pool=r(7423),n.LongBits=r(8685),n.isNode=Boolean("undefined"!==typeof r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"===typeof e||e instanceof String},n.isObject=function(e){return e&&"object"===typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!==typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"===typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},1513:function(e,t,r){"use strict";e.exports=d;var n,i=r(9131),o=i.LongBits,s=i.base64,a=i.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var h=function(){return i.Buffer?function(){return(d.create=function(){return new n})()}:function(){return new d}};function p(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}d.create=h(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},d.prototype.bool=function(e){return this._push(p,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var _=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(i.isString(e)){var r=d.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(_,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},d.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){n=e,d.create=h(),n._configure()}},2601:function(e,t,r){"use strict";e.exports=o;var n=r(1513);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9131);function o(){n.call(this)}function s(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},5550:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHwAAABYBAMAAADFDY6tAAAAAXNSR0IArs4c6QAAAC1QTFRFAAAA////////////////////////////////////////////////////////oUirmwAAAA90Uk5TAAEEBQYPEhUiJiguMDEzKAwKUAAAANJJREFUWMPt2L0JAkEQBeAHJ7Yg1mBykbEF2IGJYAU2YAMHgg3YgQaCYLSRVRiY+rM4NVzgmpyCe/OM5E047AfH7jEDD+htzFmnOVCszV23Ev04g7OGYYXFDu4aXLCd+nn3jnPp58UDBnSqxpXsMbGvrcMIMBgwbp6NCBmtY+LLtxeBZbSuiQcfj4mbj5u4uLh4Ox58o/I1rDKm8ufWk/vrF5z8ePLq9NOKi4try2jLaMuIi4v/3ZxvF32QwQsZ+zChExl5kYEbGfeRYSMZdXJBaw1shYOUZpCypwAAAABJRU5ErkJggg=="},1636:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHwAAABYBAMAAADFDY6tAAAAAXNSR0IArs4c6QAAAC1QTFRFAAAA////////////////////////////////////////////////////////oUirmwAAAA90Uk5TAAEEBQYPEhUiJiguMDEzKAwKUAAAAMtJREFUWMNjYBBf+45McKuQgYF53juywUsDBsnXyQxkArN9ExnqNjGQDbSfM6xLIF872yuGewbka2d+y/COgYGlm6iA2soQjczd4cAA1AzU7kNcOL9m2IfCPwLV3kdkPDGgcl9Ate8jT/trqPZ35Gl/N6p9VPuo9lHtNNK+j7LCKhqt4CZROwagq3YKHU9h0I0m2lHto9pHtY/WMqO1zGgtM6p9VPuo9kGqncKhDwoHXigc9qFk0InCIS8KB9woHO6jcLCRwqFOygZaAdDuZUmBDjBXAAAAAElFTkSuQmCC"},2480:function(){}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,r){return __webpack_require__.f[r](e,t),t}),[]))},__webpack_require__.u=function(e){return"static/js/"+e+".6b8eaea0.chunk.js"},__webpack_require__.miniCssF=function(e){},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="zegocloud_client_sdk_web:";__webpack_require__.l=function(r,n,i,o){if(e[r])e[r].push(n);else{var s,a;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var l=c[u];if(l.getAttribute("src")==r||l.getAttribute("data-webpack")==t+i){s=l;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,__webpack_require__.nc&&s.setAttribute("nonce",__webpack_require__.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[n];var d=function(t,n){s.onerror=s.onload=null,clearTimeout(h);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(n)})),t)return t(n)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),a&&document.head.appendChild(s)}}}(),__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="./",function(){var e={179:0};__webpack_require__.f.j=function(t,r){var n=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var i=new Promise((function(r,i){n=e[t]=[r,i]}));r.push(n[2]=i);var o=__webpack_require__.p+__webpack_require__.u(t),s=new Error;__webpack_require__.l(o,(function(r){if(__webpack_require__.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,n[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var n,i,o=r[0],s=r[1],a=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in s)__webpack_require__.o(s,n)&&(__webpack_require__.m[n]=s[n]);if(a)a(__webpack_require__)}for(t&&t(r);c<o.length;c++)i=o[c],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkzegocloud_client_sdk_web=self.webpackChunkzegocloud_client_sdk_web||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var __webpack_exports__={};!function(){"use strict";var e=__webpack_require__(9867),t=__webpack_require__(8192);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(){n=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(I){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),s=new R(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return k()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=b(s,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=d(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,s),o}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(I){return{type:"throw",arg:I}}}e.wrap=l;var h={};function p(){}function f(){}function g(){}var m={};u(m,s,(function(){return this}));var _=Object.getPrototypeOf,v=_&&_(_(O([])));v&&v!==t&&i.call(v,s)&&(m=v);var y=g.prototype=p.prototype=Object.create(m);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(o,s,a,c){var u=d(e[o],e,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==r(h)&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=d(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function O(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=g,u(y,"constructor",g),u(g,"constructor",f),f.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},E(S.prototype),u(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new S(l(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},E(y),u(y,c,"Generator"),u(y,s,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=O,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:O(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}function i(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(error){return void r(error)}a.done?t(c):Promise.resolve(c).then(n,i)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var s=e.apply(t,r);function a(e){i(s,n,o,a,c,"next",e)}function c(e){i(s,n,o,a,c,"throw",e)}a(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var i=d(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}__webpack_require__(3248);var g,m,_,v,y,E,S={app:"App_app__GuJBs",nav:"App_nav__n5Po7",LOGO:"App_LOGO__LLW1y",link:"App_link__hUoGZ",link_item:"App_link_item__09zJ7",icon__doc:"App_icon__doc__xCJSV",icon__github:"App_icon__github__AZGLq",icon_settings:"App_icon_settings__PTvHv",myMeeting:"App_myMeeting__LJOlm",serviceTips:"App_serviceTips__TQAWH",pcServiceTips:"App_pcServiceTips__yU6jx",pcSettingsModel:"App_pcSettingsModel__CSfYO",settingsWrapper:"App_settingsWrapper__cu58X",settingsHeader:"App_settingsHeader__sfrGZ",settingsClose:"App_settingsClose__TZaqB",settingsBody:"App_settingsBody__KZ568",settingsMode:"App_settingsMode__EMqkU",settingsModeItem:"App_settingsModeItem__yP7EC",settingsModeItemSelected:"App_settingsModeItemSelected__hdEZa",settingsBtn:"App_settingsBtn__h5yaD",mobileApp:"App_mobileApp__QvcBL",mobileNav:"App_mobileNav__k4qfq",mobileLOGO:"App_mobileLOGO__AKgip",mobileLink:"App_mobileLink__HY6NQ",mobileMeeting:"App_mobileMeeting__M3bcz",mobileServiceTips:"App_mobileServiceTips__zvV8R",mobileSettingsModel:"App_mobileSettingsModel__T6Kbz"};function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t){if(e){if("string"===typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(e,t):void 0}}function k(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){console.log("\u3010ZEGOCLOUD\u3011Async: Copying to clipboard was successful!")}),(function(e){console.error("\u3010ZEGOCLOUD\u3011 Async: Could not copy text: ",e)})):function(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var r=document.execCommand("copy")?"successful":"unsuccessful";console.log("\u3010ZEGOCLOUD\u3011 Fallback: Copying text command was "+r)}catch(n){console.error("\u3010ZEGOCLOUD\u3011Fallback: Oops, unable to copy",n)}document.body.removeChild(t)}(e)}function L(e){return/^http:\/\//.test(e)?e.replace(/http:/,"https:"):e}!function(e){e.Host="Host",e.Cohost="Cohost",e.Audience="Audience"}(g||(g={})),function(e){e.OneONoneCall="OneONoneCall",e.GroupCall="GroupCall",e.VideoConference="VideoConference",e.LiveStreaming="LiveStreaming"}(m||(m={})),function(e){e._180P="180p",e._360P="360p",e._480P="480p",e._720P="720p"}(_||(_={})),function(e){e.StandardLive="StandardLive",e.PremiumLive="PremiumLive",e.RealTimeLive="RealTimeLive"}(v||(v={})),function(e){e[e.main=0]="main",e[e.media=1]="media",e[e.screensharing=2]="screensharing"}(y||(y={})),function(e){e[e.notSupportCDNLive=10001]="notSupportCDNLive",e[e.notSupportStandardLive=10002]="notSupportStandardLive"}(E||(E={}));var w=__webpack_require__(1998);function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(c){a=!0,i=c}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var N=__webpack_require__(6686),P=__webpack_require__.n(N);function M(e){var t,r="",n="123456789",i=n.length;for(e=e||5,t=0;t<e;t++)r+=n.charAt(Math.floor(Math.random()*i));return Number.parseInt(r)}function D(){var e=navigator.platform,t={win:0===e.indexOf("Win"),mac:0===e.indexOf("Mac")};return"yes"!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PATH:"video_conference",REACT_APP_ENV:"prd"}.REACT_APP_MOBILE&&(t.win||t.mac)}function U(){return!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}function x(){var e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Adr")>-1}function B(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)}function j(){return!!navigator.userAgent.match(/firefox|fxios/i)}function H(){var e=navigator.userAgent.toLowerCase().indexOf("safari/")>-1,t=navigator.userAgent.match("CriOS"),r=navigator.userAgent.match("FxiOS"),n=navigator.userAgent.match(/iPhone OS .*?(?= )/),i=0;if(n&&n.length>0)try{var o=n[0].split(" ")[n[0].split(" ").length-1].split("_")[0];i=Number.parseInt(o)}catch(error){console.error("\u3010ZEGOCLOUD\u3011get safari version failed",error)}return e&&!t&&!r&&i<14}function G(e,t){var r=new Date(e),n={"M+":r.getMonth()+1+"","d+":r.getDate()+"","h+":r.getHours()>=12?r.getHours()-12+"":r.getHours()+"","m+":r.getMinutes()+"","s+":r.getSeconds()+"","q+":Math.floor((r.getMonth()+3)/3)+"",S:r.getMilliseconds()+""};return Object.entries(n).forEach((function(e){var r=A(e,2),n=r[0],i=r[1];new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i:("00"+i).substr((""+i).length)))})),t}var z={};function q(e){var t=["#557BFF","#1FAD40","#06A1E5","#E9473A","#BB9B21","#B755FF","#10BD8E","#FF2F5F"];return z[e]||(z[e]=t[Object.keys(z).length%t.length]),z[e]}function V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=e.split("?")[1];return new URLSearchParams(t)}function F(e){var t=640,r=360,n=400;return"180p"===e?(t=320,r=180,n=140):"360p"===e?(t=640,r=360,n=400):"480p"===e?(t=640,r=480,n=500):"720p"===e&&(t=1280,r=720,n=1130),{width:t,height:r,bitrate:n,frameRate:15}}var Z=function(e,t){var r=!0;return function(){var n=arguments,i=this;r&&(r=!1,setTimeout((function(){e.apply(i,n),r=!0}),t))}};function W(e){var t=55296,r=127995,n=127999,i=[776,2359,2359,2367,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520];function o(e,i){var o=i[e];if(!function(e){return e&&h(e[0].charCodeAt(0),t,56319)}(o)||e===i.length-1)return 1;var a=o+i[e+1],c=i.substring(e+2,e+5);return s(a)&&s(c)||function(e){return h(d(e),r,n)}(c)?4:2}function s(e){return h(d(e),127462,127487)}function a(e){return"string"===typeof e&&h(e.charCodeAt(0),65024,65039)}function c(e){return"string"===typeof e&&h(e.charCodeAt(0),8400,8447)}function u(e){return"string"===typeof e&&-1!==i.indexOf(e.charCodeAt(0))}function l(e){return"string"===typeof e&&8205===e.charCodeAt(0)}function d(e){return(e.charCodeAt(0)-t<<10)+(e.charCodeAt(1)-56320)+65536}function h(e,t,r){return e>=t&&e<=r}if("string"!==typeof e)throw new Error("string cannot be undefined or null");for(var p=[],f=0,g=0;f<e.length;)u(e[f+(g+=o(f+g,e))])&&g++,a(e[f+g])&&g++,c(e[f+g])&&g++,l(e[f+g])?g++:(p.push(e.substring(f,f+g)),f+=g,g=0);return p}function Y(e){return W(e).shift()||""}var Q=function(){function e(t){s(this,e),this.zg=t,this.showNonVideo=!0,this.showOnlyAudioUser=!1,this.screenNumber=D()?6:10,this.sidebarEnabled=!1,this.remoteUserList=[],this.remoteScreenStreamList=[],this.scenario=m.OneONoneCall,this.role=g.Host,this.liveStreamingMode=v.RealTimeLive,this.userOrderList=[],this.waitingPullStreams=[],this.isLive=0}return c(e,[{key:"isL3Live",get:function(){return this.scenario===m.LiveStreaming&&this.role===g.Audience&&this.liveStreamingMode===v.PremiumLive}},{key:"setPin",value:function(e,t){this.remoteUserList=this.remoteUserList.map((function(t){return t.userID===e?t.pin=!t.pin:t.pin=!1,t}))}},{key:"setShowNonVideo",value:function(e){return this.showNonVideo=e,this.updateStream()}},{key:"setMaxScreenNum",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.screenNumber=t,e.next=3,this.updateStream();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setSidebarLayOut",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sidebarEnabled=t,e.next=3,this.updateStream();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateStream",value:function(){var e=o(n().mark((function e(){var t,r,i,o,s,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.remoteUserList.length){e.next=2;break}return e.abrupt("return",!0);case 2:t=0,r=[],i=this.remoteUserList.filter((function(e){return a.showNonVideo?e:a.showOnlyAudioUser?e.streamList.length>0&&("OPEN"===e.streamList[0].micStatus||"OPEN"===e.streamList[0].cameraStatus):e.streamList.length>0&&"OPEN"===e.streamList[0].cameraStatus})),this.sidebarEnabled?((o=i.findIndex((function(e){return e.pin})))>-1?(r=this.remoteUserList.filter((function(e){return!e.pin})),this.openVideo(this.remoteUserList[o])):(r=i.slice(0,i.length-1),this.openVideo(i[i.length-1])),t++):r=i,s=0;case 6:if(!(s<r.length)){e.next=19;break}if(!(this.showNonVideo||r[s].streamList.length>0&&("OPEN"===r[s].streamList[0].cameraStatus||r[s].overScreenMuteVideo))){e.next=16;break}if(!(++t>this.screenNumber||t===this.screenNumber&&r[s+1]&&r[s+1].streamList.length>0&&("OPEN"===r[s+1].streamList[0].cameraStatus||"OPEN"===r[s+1].streamList[0].micStatus))){e.next=14;break}return e.next=12,this.muteVideo(r[s]);case 12:e.next=16;break;case 14:return e.next=16,this.openVideo(r[s]);case 16:s++,e.next=6;break;case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"openVideo",value:function(){var e=o(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.streamList.length){e.next=16;break}r=0;case 2:if(!(r<t.streamList.length)){e.next=16;break}if(!t.overScreenMuteVideo){e.next=13;break}return e.prev=4,e.next=7,this.zg.mutePlayStreamVideo(t.streamList[r].streamID,!1);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error("\u3010ZEGOCLOUD\u3011openVideo failed:",e.t0);case 12:t.overScreenMuteVideo=!1;case 13:r++,e.next=2;break;case 16:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"muteVideo",value:function(){var e=o(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.streamList.length){e.next=16;break}r=0;case 2:if(!(r<t.streamList.length)){e.next=16;break}if(t.overScreenMuteVideo){e.next=13;break}return e.prev=4,e.next=7,this.zg.mutePlayStreamVideo(t.streamList[r].streamID,!0);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error("muteVideo failed:",e.t0);case 12:t.overScreenMuteVideo=!0;case 13:r++,e.next=2;break;case 16:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"userUpdate",value:function(){var e=o(n().mark((function e(t,r,i){var o,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"ADD"===r?(this.userOrderList=[].concat(k(this.userOrderList),k(i.map((function(e){return e.userID})))),i.forEach((function(e){s.remoteUserList.some((function(t){return t.userID===e.userID}))?(s.remoteUserList.sort((function(e,t){return s.userOrderList.findIndex((function(e){return e===t.userID}))-s.userOrderList.findIndex((function(t){return t===e.userID}))})),console.error("\u3010ZEGOCLOUD\u3011 repeat u ser add!!")):s.remoteUserList.unshift({userID:e.userID,userName:e.userName,streamList:[],pin:!1})}))):"DELETE"===r&&i.forEach((function(e){var t=s.remoteUserList.findIndex((function(t){return t.userID===e.userID}));t>-1&&s.remoteUserList.splice(t,1),(t=s.userOrderList.findIndex((function(t){return t===e.userID})))>-1&&s.userOrderList.splice(t,1)})),console.warn("\u3010ZEGOCLOUD\u3011userUpdate",r,this.remoteUserList),e.next=4,this.updateStream();case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"mainStreamUpdate",value:function(){var e=o(n().mark((function e(t,r){var i,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.filter((function(e){if(e&&e.streamID&&e.streamID.includes("_main"))return!0;console.error("\u3010ZEGOCLOUD\u3011mainStreamUpdate stream empty",e)})).forEach((function(e){if(console.warn("\u3010ZEGOCLOUD\u3011mainStreamUpdate",t,r),o.remoteUserList.some((function(t){return t.userID===e.fromUser.userID}))){var n=o.remoteUserList.findIndex((function(t){return t.userID===e.fromUser.userID})),i=o.remoteUserList[n].streamList.findIndex((function(t){return t.streamID===e.streamID}));"ADD"===t?o.remoteUserList[n].streamList.push(e):"DELETE"===t&&i>-1?(o.remoteUserList[n].streamList.splice(i,1),0!=o.remoteUserList[n].streamList.length||o.userOrderList.some((function(e){return e===o.remoteUserList[n].userID}))||o.remoteUserList.splice(n,1)):"UPDATE"===t&&i>-1&&(o.remoteUserList[n].streamList[i]=e)}else"ADD"===t&&o.remoteUserList.push({userID:e.fromUser.userID,userName:e.fromUser.userName,streamList:[e],pin:!1})})),e.next=3,this.updateStream();case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"screenStreamUpdate",value:function(e,t){var r=this;t.filter((function(e){if(e&&e.streamID&&e.streamID.includes("_screensharing"))return!0})).forEach((function(t){if(r.remoteScreenStreamList.some((function(e){return e.userID===t.fromUser.userID}))){var n=r.remoteScreenStreamList.findIndex((function(e){return e.userID===t.fromUser.userID})),i=r.remoteScreenStreamList[n].streamList.findIndex((function(e){return e.streamID===t.streamID}));"ADD"===e?r.remoteScreenStreamList[n].streamList.push(t):"DELETE"===e&&i>-1?r.remoteScreenStreamList.splice(n,1):"UPDATE"===e&&i>-1&&(r.remoteScreenStreamList[n].streamList[i]=t)}else"ADD"===e&&r.remoteScreenStreamList.push({userID:t.fromUser.userID,userName:t.fromUser.userName,streamList:[t],pin:!1})}))}},{key:"setLiveStates",value:function(){var e=o(n().mark((function e(t){var r,i,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scenario!==m.LiveStreaming||this.role!==g.Audience){e.next=14;break}if(this.isLive=t,1!==t){e.next=12;break}r=n().mark((function e(t){var r,i,s,a,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.zg.startPlayingStream(o.waitingPullStreams[t].streamID,{resourceMode:o.isL3Live?2:0});case 3:r=e.sent,o.waitingPullStreams[t].streamID.includes("_screensharing")?(i=o.remoteScreenStreamList.findIndex((function(e){return e.userID===o.waitingPullStreams[t].userID})),s=o.remoteScreenStreamList[i].streamList.findIndex((function(e){return e.streamID===o.waitingPullStreams[t].streamID})),o.remoteScreenStreamList[i].streamList[s].media=r):(a=o.remoteUserList.findIndex((function(e){return e.userID===o.waitingPullStreams[t].userID})),c=o.remoteUserList[a].streamList.findIndex((function(e){return e.streamID===o.waitingPullStreams[t].streamID})),o.remoteUserList[a].streamList[c].media=r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn("\u3010ZEGOCLOUD\u3011 playStream failed ,ignore continue !!");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),i=0;case 5:if(!(i<this.waitingPullStreams.length)){e.next=10;break}return e.delegateYield(r(i),"t0",7);case 7:i++,e.next=5;break;case 10:e.next=14;break;case 12:this.remoteUserList=this.remoteUserList.map((function(e){return e.streamList=e.streamList.map((function(e){return e.media&&o.zg.stopPlayingStream(e.streamID),o.waitingPullStreams.some((function(t){return t.streamID===e.streamID}))||o.waitingPullStreams.push({streamID:e.streamID,userID:e.fromUser.userID}),e.media=void 0,e})),e})),this.remoteScreenStreamList=this.remoteScreenStreamList.map((function(e){return e.streamList=e.streamList.map((function(e){return e.media&&o.zg.stopPlayingStream(e.streamID),o.waitingPullStreams.some((function(t){return t.streamID===e.streamID}))||o.waitingPullStreams.push({streamID:e.streamID,userID:e.fromUser.userID}),e.media=void 0,e})),e}));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startPullStream",value:function(){var e=o(n().mark((function e(t,r){var i,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.scenario!==m.LiveStreaming||this.role!==g.Audience){e.next=13;break}if(1!==this.isLive){e.next=8;break}return e.next=4,this.zg.startPlayingStream(r,{resourceMode:this.isL3Live?2:0});case 4:return i=e.sent,e.abrupt("return",i);case 8:if(0!==this.isLive){e.next=11;break}return this.waitingPullStreams.push({streamID:r,userID:t}),e.abrupt("return",void 0);case 11:e.next=17;break;case 13:return e.next=15,this.zg.startPlayingStream(r,{resourceMode:this.isL3Live?2:0});case 15:return o=e.sent,e.abrupt("return",o);case 17:return e.abrupt("return",void 0);case 18:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"stopPullStream",value:function(e,t){if(this.scenario===m.LiveStreaming&&this.role===g.Audience){if(1===this.isLive)this.zg.stopPlayingStream(t);else if(0===this.isLive){var r=this.waitingPullStreams.findIndex((function(e){return e.streamID===t}));r>-1&&this.waitingPullStreams.splice(r,1)}}else this.zg.stopPlayingStream(t)}},{key:"reset",value:function(){this.remoteUserList=[],this.waitingPullStreams=[],this.isLive=0,this.screenNumber=0,this.sidebarEnabled=!1,this.remoteUserList=[],this.remoteScreenStreamList=[]}},{key:"updateUserInfo",value:function(e,t,r){this.remoteUserList.some((function(n){return n.userID===e&&(n[t]=r,!0)})),this.remoteScreenStreamList.some((function(n){return n.userID===e&&(n[t]=r,!0)}))}},{key:"updateStreamInfo",value:function(e,t,r,n){this.remoteUserList.some((function(i){return i.userID===e&&i.streamList.some((function(e){return e.streamID===t&&(e[r]=n,!0)})),!1})),this.remoteScreenStreamList.some((function(i){return i.userID===e&&i.streamList.some((function(e){return e.streamID===t&&(e[r]=n,!0)})),!1}))}}]),e}(),K=function(){function e(){var t=this;s(this,e),this.zum=void 0,this._expressConfig=void 0,this.status={loginRsp:!1,videoRefuse:!1,audioRefuse:!1},this.remoteStreamMap={},this.waitingHandlerStreams={add:[],delete:[]},this._config={container:void 0,preJoinViewConfig:{title:"Join Room",invitationLink:window.location.href},showPreJoinView:!0,turnOnMicrophoneWhenJoining:!0,turnOnCameraWhenJoining:!0,showMyCameraToggleButton:!0,showMyMicrophoneToggleButton:!0,showAudioVideoSettingsButton:!0,showTextChat:!0,showUserList:!0,lowerLeftNotification:{showUserJoinAndLeave:!0,showTextChat:!0},branding:{logoURL:""},showLeavingView:!0,maxUsers:2,layout:"Auto",showNonVideoUser:!0,showOnlyAudioUser:!1,useFrontFacingCamera:!0,onJoinRoom:function(){},onLeaveRoom:function(){},onUserJoin:function(e){},onUserLeave:function(e){},onUserAvatarSetter:function(e){},sharedLinks:[],showScreenSharingButton:!0,scenario:{mode:m.OneONoneCall,config:{role:g.Host,liveStreamingMode:void 0}},facingMode:"user",joinRoomCallback:function(){},leaveRoomCallback:function(){},userUpdateCallback:function(){},showLayoutButton:!0,showPinButton:!0,videoResolutionList:[]},this._currentPage="BrowserCheckPage",this.extraInfoKey="extra_info",this._roomExtraInfo={live_status:{v:0,u:"xxx",r:0}},this.NetworkStatusTimer=null,this.subscribeUserListCallBack=void 0,this.subscribeScreenStreamCallBack=void 0,this.onRemoteMediaUpdateCallBack=function(){var e=o(n().mark((function e(r,i){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.zum.mainStreamUpdate(r,i);case 2:return e.next=4,t.zum.screenStreamUpdate(r,i);case 4:t.subscribeUserListCallBack&&t.subscribeUserListCallBack(k(t.zum.remoteUserList)),t.subscribeScreenStreamCallBack&&t.subscribeScreenStreamCallBack(k(t.zum.remoteScreenStreamList));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this.onNetworkStatusQualityCallBack=void 0,this.onRemoteUserUpdateCallBack=void 0,this.onSoundLevelUpdateCallBack=void 0,this.onRoomLiveStateUpdateCallBack=void 0,this.onRoomMessageUpdateCallBack=void 0,this.onScreenSharingEndedCallBack=void 0,this.onNetworkStatusCallBack=void 0,this.coreErrorCallback=void 0}return c(e,[{key:"isCDNLive",get:function(){var e,t;return(null===(e=this._config.scenario)||void 0===e?void 0:e.mode)===m.LiveStreaming&&(null===(t=this._config.scenario.config)||void 0===t?void 0:t.role)===g.Audience&&this._config.scenario.config.liveStreamingMode===v.StandardLive}},{key:"setConfig",value:function(e){var t,r,n,i,o,s,a;if(e.scenario&&e.scenario.mode===m.LiveStreaming){if(!0===e.showNonVideoUser)return console.error("\u3010ZEGOCLOUD\u3011 showNonVideoUser have be false scenario.mode is LiveStreaming!!"),!1;if(e.showNonVideoUser=!1,e.showOnlyAudioUser=!0,e.scenario.config&&e.scenario.config.role===g.Host){if(!1===e.turnOnMicrophoneWhenJoining&&!1===e.turnOnCameraWhenJoining&&!1===e.showMyCameraToggleButton&&!1===e.showAudioVideoSettingsButton)return console.error("\u3010ZEGOCLOUD\u3011 Host could turn on at least one of the camera and the microphone!!"),!1}else if(e.scenario.config&&e.scenario.config.role===g.Audience&&(!0===e.turnOnMicrophoneWhenJoining||!0===e.turnOnCameraWhenJoining||!0===e.showMyCameraToggleButton||!0===e.showMyMicrophoneToggleButton||!0===e.showAudioVideoSettingsButton||!0===e.showScreenSharingButton||!0===e.useFrontFacingCamera||e.layout&&"Grid"!==e.layout))return console.error("\u3010ZEGOCLOUD\u3011 Audience cannot configure camera and microphone related params"),!1;e.maxUsers||(e.maxUsers=5e3),e.scenario.config&&e.scenario.config.role===g.Audience&&(e.turnOnMicrophoneWhenJoining=!1,e.turnOnCameraWhenJoining=!1,e.showMyCameraToggleButton=!1,e.showMyMicrophoneToggleButton=!1,e.showAudioVideoSettingsButton=!1,e.showScreenSharingButton=!1,e.useFrontFacingCamera=!1,e.useFrontFacingCamera=!1,e.showUserList=void 0!==e.showUserList&&e.showUserList,e.showPinButton=!1,e.showLayoutButton=!1,e.layout="Grid",e.lowerLeftNotification={showTextChat:!1,showUserJoinAndLeave:!1})}(e.scenario&&e.scenario.mode===m.OneONoneCall&&(e.maxUsers||(e.maxUsers=2),e.showLayoutButton=!1,e.showPinButton=!1),e.scenario&&e.scenario.mode===m.GroupCall&&(e.maxUsers||(e.maxUsers=50)),e.facingMode&&(e.useFrontFacingCamera="user"===e.facingMode),e.joinRoomCallback&&(e.onJoinRoom=e.joinRoomCallback),e.leaveRoomCallback&&(e.onLeaveRoom=e.leaveRoomCallback),e.userUpdateCallback&&(e.onUserJoin=function(t){e.userUpdateCallback&&e.userUpdateCallback("ADD",t)},e.onUserLeave=function(t){e.userUpdateCallback&&e.userUpdateCallback("DELETE",t)}),e.preJoinViewConfig&&e.preJoinViewConfig.invitationLink&&(e.sharedLinks=[{name:"Share the link",url:e.preJoinViewConfig.invitationLink}]),e.videoResolutionDefault)&&(e.videoResolutionList||(e.videoResolutionList=[]),null===(a=e.videoResolutionList)||void 0===a||a.unshift(e.videoResolutionDefault));if(e.videoResolutionList&&e.videoResolutionList.length>0){var c=Array.from(new Set(e.videoResolutionList)).filter((function(e){return e===_._180P||e===_._360P||e===_._480P||e===_._720P}));e.videoResolutionList=c.length>0?c:[_._360P]}else e.videoResolutionList=[_._360P];return e.preJoinViewConfig&&(e.preJoinViewConfig=C(C({},this._config.preJoinViewConfig),e.preJoinViewConfig)),e.scenario&&e.scenario.config&&(e.scenario.config=C(C({},null===(t=this._config.scenario)||void 0===t?void 0:t.config),e.scenario.config)),this._config=C(C({},this._config),e),this.zum.scenario=(null===(r=this._config.scenario)||void 0===r?void 0:r.mode)||m.OneONoneCall,this.zum.role=(null===(n=this._config.scenario)||void 0===n||null===(i=n.config)||void 0===i?void 0:i.role)||g.Host,this.zum.liveStreamingMode=(null===(o=this._config.scenario)||void 0===o||null===(s=o.config)||void 0===s?void 0:s.liveStreamingMode)||v.RealTimeLive,this.zum.showOnlyAudioUser=!!this._config.showOnlyAudioUser,this.zum.setShowNonVideo(!!this._config.showNonVideoUser),!0}},{key:"checkWebRTC",value:function(){var t=o(n().mark((function t(){var r,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isCDNLive){t.next=8;break}return t.next=3,e._zg.checkSystemRequirements("webRTC");case 3:return r=t.sent,t.next=6,e._zg.checkSystemRequirements("H264");case 6:return i=t.sent,t.abrupt("return",!!r.result&&!!i.result);case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setPin",value:function(e,t,r){this.zum.setPin(e,t),r||this.subscribeUserListCallBack&&this.subscribeUserListCallBack(k(this.zum.remoteUserList))}},{key:"setMaxScreenNum",value:function(){var e=o(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.zum.setMaxScreenNum(t);case 2:r||this.subscribeUserListCallBack&&this.subscribeUserListCallBack(k(this.zum.remoteUserList));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setSidebarLayOut",value:function(){var e=o(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.zum.setSidebarLayOut(t);case 2:r||this.subscribeUserListCallBack&&this.subscribeUserListCallBack(k(this.zum.remoteUserList));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setShowNonVideo",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.zum.setShowNonVideo(t);case 2:this.subscribeUserListCallBack&&this.subscribeUserListCallBack(k(this.zum.remoteUserList));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCurrentPage",value:function(e){this._currentPage=e}},{key:"getCameras",value:function(){return e._zg.getCameras()}},{key:"useVideoDevice",value:function(t,r){return e._zg.useVideoDevice(t,r)}},{key:"getMicrophones",value:function(){return e._zg.getMicrophones()}},{key:"getSpeakers",value:function(){return e._zg.getSpeakers()}},{key:"setVolume",value:function(e,t){e.volume=t}},{key:"createStream",value:function(){var t=o(n().mark((function t(r){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.createStream(r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"setVideoConfig",value:function(){var t=o(n().mark((function t(r,i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.setVideoConfig(r,i));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"stopPublishingStream",value:function(t){return e._zg.stopPublishingStream(t)}},{key:"destroyStream",value:function(t){e._zg.destroyStream(t)}},{key:"useCameraDevice",value:function(t,r){return e._zg.useVideoDevice(t,r)}},{key:"useMicrophoneDevice",value:function(t,r){return e._zg.useAudioDevice(t,r)}},{key:"useSpeakerDevice",value:function(){var t=o(n().mark((function t(r,i){var o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.srcObject){t.next=2;break}return t.abrupt("return",Promise.resolve({errorCode:-1}));case 2:return t.prev=2,t.next=5,e._zg.useAudioOutputDevice(r,i);case 5:return o=t.sent,t.abrupt("return",{errorCode:o?0:-1});case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",{errorCode:-1});case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"enableVideoCaptureDevice",value:function(){var t=o(n().mark((function t(r,i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.enableVideoCaptureDevice(r,i));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"mutePublishStreamVideo",value:function(){var t=o(n().mark((function t(r,i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.mutePublishStreamVideo(r,i));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"mutePublishStreamAudio",value:function(){var t=o(n().mark((function t(r,i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.mutePublishStreamAudio(r,i));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"muteMicrophone",value:function(){var t=o(n().mark((function t(r){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.muteMicrophone(r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"roomExtraInfo",get:function(){return this._roomExtraInfo},set:function(e){var t=this;"Room"===this._currentPage?(this._roomExtraInfo=e,this.zum.setLiveStates(this._roomExtraInfo.live_status.v),this.onRoomLiveStateUpdateCallBack&&this.onRoomLiveStateUpdateCallBack(this._roomExtraInfo.live_status.v)):"BrowserCheckPage"!==this._currentPage&&"RejoinRoom"!==this._currentPage||setTimeout((function(){t.roomExtraInfo=e}),1e3)}},{key:"setLive",value:function(){var t=o(n().mark((function t(r){var i,o,s,a,c,u;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=C(C({},this._roomExtraInfo),{live_status:{v:"live"===r?1:0,u:e._instance._expressConfig.userID,r:(null===(i=e._instance._config.scenario)||void 0===i||null===(o=i.config)||void 0===o?void 0:o.role)===g.Host?1:(null===(s=e._instance._config.scenario)||void 0===s||null===(a=s.config)||void 0===a?void 0:a.role)===g.Audience?2:3}}),t.next=3,e._zg.setRoomExtraInfo(e._instance._expressConfig.roomID,"extra_info",JSON.stringify(c));case 3:return 0===(u=t.sent).errorCode&&(this.roomExtraInfo=c),t.abrupt("return",0===u.errorCode);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"enterRoom",value:function(){var t=o(n().mark((function t(){var r,i=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.status.loginRsp){t.next=2;break}return t.abrupt("return",Promise.resolve(0));case 2:return e._zg.off("roomExtraInfoUpdate"),e._zg.off("roomStreamUpdate"),e._zg.off("remoteCameraStatusUpdate"),e._zg.off("remoteMicStatusUpdate"),e._zg.off("playerStateUpdate"),e._zg.off("roomUserUpdate"),e._zg.off("IMRecvBroadcastMessage"),e._zg.off("roomStateUpdate"),e._zg.off("publisherStateUpdate"),e._zg.off("publishQualityUpdate"),e._zg.off("soundLevelUpdate"),e._zg.on("roomStreamUpdate",function(){var e=o(n().mark((function e(t,r,o,s){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"ADD"===r?(i.waitingHandlerStreams.add=[].concat(k(i.waitingHandlerStreams.add),k(o)),i.waitingHandlerStreams.delete=i.waitingHandlerStreams.delete.filter((function(e){return!o.some((function(t){return t.streamID===e.streamID}))}))):(a=[],i.waitingHandlerStreams.add=i.waitingHandlerStreams.add.filter((function(e){return!o.some((function(t){return t.streamID===e.streamID&&(a.push(t.streamID),!0)}))})),o=o.filter((function(e){return!a.some((function(t){return t==e.streamID}))})),i.waitingHandlerStreams.delete=[].concat(k(i.waitingHandlerStreams.delete),k(o))),console.error("roomStreamUpdate",i.waitingHandlerStreams);case 2:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()),e._zg.on("roomExtraInfoUpdate",(function(e,t){t.forEach((function(e){e.key===i.extraInfoKey&&(i.roomExtraInfo=JSON.parse(e.value))}))})),e._zg.on("remoteCameraStatusUpdate",(function(e,t){i.remoteStreamMap[e]&&(i.remoteStreamMap[e].cameraStatus=t,i.onRemoteMediaUpdateCallBack&&i.onRemoteMediaUpdateCallBack("UPDATE",[i.remoteStreamMap[e]]))})),e._zg.on("remoteMicStatusUpdate",(function(e,t){i.remoteStreamMap[e]&&(i.remoteStreamMap[e].micStatus=t,i.onRemoteMediaUpdateCallBack&&i.onRemoteMediaUpdateCallBack("UPDATE",[i.remoteStreamMap[e]]))})),e._zg.on("playerStateUpdate",(function(e){console.warn("\u3010ZEGOCLOUD\u3011",e),i.remoteStreamMap[e.streamID]&&(i.remoteStreamMap[e.streamID].state=e.state,i.onRemoteMediaUpdateCallBack&&i.onRemoteMediaUpdateCallBack("UPDATE",[i.remoteStreamMap[e.streamID]])),1104038===e.errorCode&&i.coreErrorCallback(E.notSupportStandardLive,e.extendedData)})),e._zg.on("roomUserUpdate",(function(e,t,r){console.warn("\u3010ZEGOCLOUD\u3011roomUserUpdate",t,r),i.onRemoteUserUpdateCallBack&&i.onRemoteUserUpdateCallBack(e,t,r),setTimeout((function(){var e=r.map((function(e){return e.setUserAvatar=function(t){t&&"string"===typeof t&&i.zum.updateUserInfo(e.userID,"avatar",t)},e}));"ADD"===t?(i._config.onUserAvatarSetter&&i._config.onUserAvatarSetter(e),i._config.onUserJoin&&i._config.onUserJoin(r)):i._config.onUserLeave&&i._config.onUserLeave(r)}),0)})),e._zg.on("IMRecvBroadcastMessage",(function(e,t){i.onRoomMessageUpdateCallBack&&i.onRoomMessageUpdateCallBack(e,t)})),e._zg.on("publisherStateUpdate",(function(t){var r="DISCONNECTED";"PUBLISHING"===t.state?r="CONNECTED":"NO_PUBLISH"===t.state?r="DISCONNECTED":"PUBLISH_REQUESTING"===t.state&&(r="CONNECTING"),i.onNetworkStatusCallBack&&i.onNetworkStatusCallBack(e._instance._expressConfig.roomID,"STREAM",r)})),e._zg.on("playQualityUpdate",(function(e,t){i.onNetworkStatusQualityCallBack&&i.onNetworkStatusQualityCallBack(e,Math.max(t.video.videoQuality,t.audio.audioQuality))})),e._zg.on("publishQualityUpdate",(function(e,t){i.onNetworkStatusQualityCallBack&&i.onNetworkStatusQualityCallBack(e,Math.max(t.video.videoQuality,t.audio.audioQuality))})),e._zg.on("soundLevelUpdate",(function(e){i.onSoundLevelUpdateCallBack&&i.onSoundLevelUpdateCallBack(e)})),e._zg.on("screenSharingEnded",(function(e){i.onScreenSharingEndedCallBack&&i.onScreenSharingEndedCallBack(e)})),this.isCDNLive&&e._zg.on("streamExtraInfoUpdate",(function(e,t){e===i._expressConfig.roomID&&(console.warn("streamExtraInfoUpdate",t),i.streamExtraInfoUpdateCallBack(t))})),t.next=28,new Promise(function(){var t=o(n().mark((function t(r,o){var s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._zg.on("roomStateUpdate",(function(e,t,n,o){i.onNetworkStatusCallBack&&i.onNetworkStatusCallBack(e,"ROOM",t),"CONNECTED"!==t&&"DISCONNECTED"!==t||(i.status.loginRsp=0===n,r(n))})),t.next=3,e._zg.loginRoom(e._instance._expressConfig.roomID,e._instance._expressConfig.token,{userID:e._instance._expressConfig.userID,userName:e._instance._expressConfig.userName},{userUpdate:!0,maxMemberCount:e._instance._config.maxUsers});case 3:s={userID:e._instance._expressConfig.userID,userName:e._instance._expressConfig.userName,setUserAvatar:function(e){e&&"string"===typeof e&&(i._expressConfig.avatar=e)}},i._config.onUserAvatarSetter&&i._config.onUserAvatarSetter([s]);case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}());case 28:return r=t.sent,e._zg.setSoundLevelDelegate(!0,300),this.streamUpdateTimer(this.waitingHandlerStreams),t.abrupt("return",r);case 32:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"streamUpdateTimer",value:function(){var e=o(n().mark((function e(t){var r,i,o,s,a,c,u,l,d=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status.loginRsp){e.next=3;break}return console.warn("\u3010ZEGOCLOUD\u3011logoutRoom,stop streamUpdateTimer"),e.abrupt("return");case 3:if("Room"!==this._currentPage){e.next=49;break}if(r=[],!(t.add.length>0)){e.next=31;break}i=0;case 7:if(!(i<t.add.length)){e.next=30;break}if(o=t.add[i],e.prev=9,!this.isCDNLive){e.next=16;break}o.urlsFLV||this.coreErrorCallback(E.notSupportCDNLive,"urlsFLV is empty"),s=JSON.parse(o.extraInfo),this.remoteStreamMap[o.streamID]={fromUser:o.user,media:void 0,micStatus:s.isMicrophoneOn?"OPEN":"MUTE",cameraStatus:s.isCameraOn?"OPEN":"MUTE",state:"PLAYING",streamID:o.streamID,urlsHttpsFLV:L(o.urlsHttpsFLV||o.urlsFLV),urlsHttpsHLS:L(o.urlsHttpsHLS||o.urlsHLS),hasAudio:s.hasAudio,hasVideo:s.hasVideo},e.next=20;break;case 16:return e.next=18,this.zum.startPullStream(o.user.userID,o.streamID);case 18:a=e.sent,this.remoteStreamMap[o.streamID]={fromUser:o.user,media:a,micStatus:a&&a.getAudioTracks().length>0?"OPEN":"MUTE",cameraStatus:a&&a.getVideoTracks().length>0?"OPEN":"MUTE",state:"PLAYING",streamID:o.streamID};case 20:r.push(this.remoteStreamMap[o.streamID]),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(9),console.warn("\u3010ZEGOCLOUD\u3011startPlayingStream error:",e.t0),110438===(null===e.t0||void 0===e.t0?void 0:e.t0.errorCode)&&this.coreErrorCallback(E.notSupportStandardLive,null===e.t0||void 0===e.t0?void 0:e.t0.extendedData);case 27:i++,e.next=7;break;case 30:this.onRemoteMediaUpdateCallBack&&r.length>0&&this.onRemoteMediaUpdateCallBack("ADD",r);case 31:if(!(t.delete.length>0)){e.next=44;break}r=[],c=0;case 34:if(!(c<t.delete.length)){e.next=43;break}return u=t.delete[c],this.remoteStreamMap[u.streamID]&&r.push(this.remoteStreamMap[u.streamID]),e.next=39,this.zum.stopPullStream(u.user.userID,u.streamID);case 39:delete this.remoteStreamMap[u.streamID];case 40:c++,e.next=34;break;case 43:this.onRemoteMediaUpdateCallBack&&r.length>0&&this.onRemoteMediaUpdateCallBack("DELETE",r);case 44:l={add:this.waitingHandlerStreams.add.filter((function(e){return!t.add.some((function(t){return t.streamID===e.streamID}))})),delete:this.waitingHandlerStreams.delete.filter((function(e){return!t.delete.some((function(t){return t.streamID===e.streamID}))}))},this.waitingHandlerStreams=l,setTimeout((function(){d.streamUpdateTimer(d.waitingHandlerStreams)}),700),e.next=50;break;case 49:"BrowserCheckPage"!==this._currentPage&&"RejoinRoom"!==this._currentPage||setTimeout((function(){d.streamUpdateTimer(t)}),1e3);case 50:case"end":return e.stop()}}),e,this,[[9,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"publishLocalStream",value:function(t,r){if(!t)return!1;var n,i,o,s=(n=this._expressConfig.userID,i=this._expressConfig.roomID,o=(o=r)||"main","".concat(i,"_").concat(n,"_").concat(o));return e._zg.startPublishingStream(s,t)&&s}},{key:"replaceTrack",value:function(){var t=o(n().mark((function t(r,i){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.replaceTrack(r,i));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"subscribeUserList",value:function(e){this.subscribeUserListCallBack=e}},{key:"subscribeScreenStream",value:function(e){this.subscribeScreenStreamCallBack=e}},{key:"onNetworkStatusQuality",value:function(e){this.onNetworkStatusQualityCallBack=e}},{key:"onRemoteUserUpdate",value:function(e){var t=this;this.onRemoteUserUpdateCallBack=function(){var r=o(n().mark((function r(i,o,s){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("BrowserCheckPage"!==t._currentPage&&"RejoinRoom"!==t._currentPage){r.next=4;break}setTimeout((function(){t.onRemoteUserUpdateCallBack(i,o,s)}),1e3),r.next=9;break;case 4:if("Room"!==t._currentPage){r.next=9;break}return e(i,o,s),r.next=8,t.zum.userUpdate(i,o,s);case 8:setTimeout((function(){console.warn("\u3010ZEGOCLOUD\u3011roomUserUpdate",k(t.zum.remoteUserList),k(t.zum.remoteUserList).length),t.subscribeUserListCallBack&&t.subscribeUserListCallBack(k(t.zum.remoteUserList))}),0);case 9:case"end":return r.stop()}}),r)})));return function(e,t,n){return r.apply(this,arguments)}}()}},{key:"onSoundLevelUpdate",value:function(e){this.onSoundLevelUpdateCallBack=e}},{key:"onRoomLiveStateUpdate",value:function(e){this.onRoomLiveStateUpdateCallBack=e}},{key:"sendRoomMessage",value:function(t){return e._zg.sendBroadcastMessage(e._instance._expressConfig.roomID,t)}},{key:"onRoomMessageUpdate",value:function(e){this.onRoomMessageUpdateCallBack=e}},{key:"onScreenSharingEnded",value:function(e){this.onScreenSharingEndedCallBack=e}},{key:"onNetworkStatus",value:function(e){var t=this;this.onNetworkStatusCallBack=function(r,n,i){"CONNECTING"===i?!t.NetworkStatusTimer&&(t.NetworkStatusTimer=setTimeout((function(){e(r,n,"DISCONNECTED")}),6e4)):t.NetworkStatusTimer&&(clearTimeout(t.NetworkStatusTimer),t.NetworkStatusTimer=null),e(r,n,i)}}},{key:"streamExtraInfoUpdateCallBack",value:function(e){var t=this;e.forEach((function(e){var r=JSON.parse(e.extraInfo);console.warn("extraInfo",r),void 0!==r.isCameraOn&&t.zum.updateStreamInfo(e.user.userID,e.streamID,"cameraStatus",r.isCameraOn?"OPEN":"MUTE"),void 0!==r.isMicrophoneOn&&t.zum.updateStreamInfo(e.user.userID,e.streamID,"micStatus",r.isMicrophoneOn?"OPEN":"MUTE"),void 0!==r.hasVideo&&t.zum.updateStreamInfo(e.user.userID,e.streamID,"hasVideo",!!r.hasVideo),void 0!==r.hasAudio&&t.zum.updateStreamInfo(e.user.userID,e.streamID,"hasAudio",!!r.hasAudio)})),this.subscribeUserListCallBack&&this.subscribeUserListCallBack(k(this.zum.remoteUserList)),this.subscribeScreenStreamCallBack&&this.subscribeScreenStreamCallBack(k(this.zum.remoteScreenStreamList))}},{key:"onCoreError",value:function(e){this.coreErrorCallback=e}},{key:"leaveRoom",value:function(){var t=this;if(this.status.loginRsp){for(var r in e._zg.off("streamExtraInfoUpdate"),e._zg.off("roomExtraInfoUpdate"),e._zg.off("roomStreamUpdate"),e._zg.off("remoteCameraStatusUpdate"),e._zg.off("remoteMicStatusUpdate"),e._zg.off("playerStateUpdate"),e._zg.off("roomUserUpdate"),e._zg.off("IMRecvBroadcastMessage"),e._zg.off("roomStateUpdate"),e._zg.off("publisherStateUpdate"),e._zg.off("publishQualityUpdate"),e._zg.off("soundLevelUpdate"),e._zg.off("screenSharingEnded"),e._zg.setSoundLevelDelegate(!1),this.onNetworkStatusCallBack=function(){},this.onRemoteMediaUpdateCallBack=function(){var e=o(n().mark((function e(r,i){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.zum.mainStreamUpdate(r,i);case 2:return e.next=4,t.zum.screenStreamUpdate(r,i);case 4:t.subscribeUserListCallBack&&t.subscribeUserListCallBack(k(t.zum.remoteUserList)),t.subscribeScreenStreamCallBack&&t.subscribeScreenStreamCallBack(k(t.zum.remoteScreenStreamList));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this.onRemoteUserUpdateCallBack=function(){},this.onRoomMessageUpdateCallBack=function(){},this.onRoomLiveStateUpdateCallBack=function(){},this.subscribeUserListCallBack=function(){},this.zum.reset(),this.remoteStreamMap)e._zg.stopPlayingStream(r);this.remoteStreamMap={},this.waitingHandlerStreams={add:[],delete:[]},e._zg.logoutRoom(),this.status.loginRsp=!1}}},{key:"setStreamExtraInfo",value:function(t,r){return e._zg.setStreamExtraInfo(t,r)}}],[{key:"getInstance",value:function(t){var r=function(e){if(e.split("#").length>1){var t=JSON.parse(window.atob(e.split("#")[1]));return{appID:1*t.appID,userID:t.userID,userName:t.userName,roomID:t.roomID,token:e.split("#")[0]}}console.error("\u3010ZEGOCLOUD\u3011kitToken error")}(t);return!e._instance&&r&&(e._instance=new e,e._instance._expressConfig=r,e._zg=new w.ZegoExpressEngine(e._instance._expressConfig.appID,"wss://webliveroom"+e._instance._expressConfig.appID+"-api.zegocloud.com/ws"),e._instance.zum=new Q(e._zg)),e._instance}}]),e}();K._instance=void 0,K._zg=void 0;var J="ZegoBrowserCheck_support__sbd6B",X="ZegoBrowserCheck_supportWrapper__r3z77",$="ZegoBrowserCheck_videoWrapper__NOFS1",ee="ZegoBrowserCheck_video__VbfN7",te="ZegoBrowserCheck_videoTip__dWf-m",re="ZegoBrowserCheck_noCamera__9xMxX",ne="ZegoBrowserCheck_toolsWrapper__hEq27",ie="ZegoBrowserCheck_buttonTip__ykVWM",oe="ZegoBrowserCheck_audioButton__v0Onk",se="ZegoBrowserCheck_close__4hHbt",ae="ZegoBrowserCheck_videoButton__UqONc",ce="ZegoBrowserCheck_settingsButton__FvRs3",ue="ZegoBrowserCheck_joinScreenWrapper__SJkEy",le="ZegoBrowserCheck_title__Jctj4",de="ZegoBrowserCheck_joinFormWrapper__psYI6",he="ZegoBrowserCheck_userName__Zr9FC",pe="ZegoBrowserCheck_joinRoomButtonWrapper__zH-ZS",fe="ZegoBrowserCheck_joinRoomButton__7qzWa",ge="ZegoBrowserCheck_joinRoomButtonLoading__sImQI",me="ZegoBrowserCheck_joinRoomButtonTip__lUHG3",_e="ZegoBrowserCheck_shareLinkWrapper__tZYY3",ve="ZegoBrowserCheck_inviteLinkWrapper__RKXdK",ye="ZegoBrowserCheck_inviteLinkWrapperLeft__L8o4j",Ee="ZegoBrowserCheck_inviteLink__7dJaM",Se="ZegoBrowserCheck_copyLinkButton__vjpz3",be="ZegoBrowserCheck_smallSize__ms+Oy",Te="zegoSetting_whiteTheme__nMYCQ",Ce="zegoSetting_blackTheme__W-0Rh",Re="zegoSetting_right__ChTSN",Oe="zegoSetting_closeIcon__IM7U7",ke="zegoSetting_leftAudioTab__CPmPO",Ie="zegoSetting_leftVideoTab__QsgcJ",Le="zegoSetting_left__HUrZ0",we="zegoSetting_tabActive__6qZku",Ae="zegoSetting_volumeWrapper__7p4if",Ne="zegoSetting_micIcon__cs4Lb",Pe="zegoSetting_micIconAcitve__9VAir",Me="zegoSetting_speakerIcon__gaTQ2",De="zegoSetting_speakerIconAcitve__a2xCn",Ue="zegoSetting_frame__bRXcp",xe="zegoSetting_noFrame__JF8+8",Be="zegoSetting_body__nPp9h",je="zegoSetting_header__DE0rs",He="zegoSetting_content__n9L7P",Ge="zegoSetting_device__bNog8",ze="zegoSetting_volume__ZFHP1",qe="zegoSetting_volumeActive__EPWiF",Ve="zegoSetting_speakerTestButton__gfrL3",Fe="zegoSetting_checkboxWrapper__m8qGj",Ze="zegoSetting_checkbox__XUpkO",We="zegoSetting_selected__1a7Tf",Ye="zegoSetting_rightAudio__ECjhV",Qe="zegoSetting_rightVideo__2Nu0p",Ke="zegoSetting_previewVideo__9PTWS",Je="zegoSelect_whiteTheme__6evPM",Xe="zegoSelect_blackTheme__EdSmj",$e="zegoSelect_optionsWrapper__RLuSr",et="zegoSelect_selectInputWrapper__S+JmA",tt="zegoSelect_inputActived__7jVHQ",rt="zegoSelect_selectWrapper__1yY13",nt="zegoSelect_selectLabel__8uA0F",it="zegoSelect_noOptions__tWxy7",ot="zegoSelect_showList__d7WlK",st="zegoSelect_option__gVcDM",at="zegoSelect_optionSelected__9xBog",ct=__webpack_require__(2834),ut=function(t){l(n,t);var r=f(n);function n(){var t;s(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).state={value:"",name:"",showList:!1},t.listRef=e.createRef(),t.selectRef=e.createRef(),t.onCloseList=function(e){var r,n;t.listRef.current===e.target||null!==(r=t.listRef.current)&&void 0!==r&&r.contains(e.target)||t.selectRef.current===e.target||null!==(n=t.selectRef.current)&&void 0!==n&&n.contains(e.target)||t.setState({showList:!1})},t}return c(n,[{key:"handleChange",value:function(e){this.state.value!==e.value&&(this.setState(C({},e)),this.props.onChange&&this.props.onChange(e.value)),this.setState({showList:!1})}},{key:"handleClickInput",value:function(){var e;null!==(e=this.props.options)&&void 0!==e&&e.length&&this.setState({showList:!this.state.showList})}},{key:"setInitValue",value:function(){var e,t=this;if(null!==(e=this.props.options)&&void 0!==e&&e.length)if(this.props.initValue){var r=this.props.options.filter((function(e){return e.value===t.props.initValue}));this.setState(C({},r[0]))}else this.setState(C({},this.props.options[0]))}},{key:"componentDidMount",value:function(){this.setInitValue(),document.addEventListener("click",this.onCloseList)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onCloseList)}},{key:"componentDidUpdate",value:function(e){var t,r;(null===(t=this.props.options)||void 0===t?void 0:t.length)!==(null===(r=e.options)||void 0===r?void 0:r.length)&&this.setInitValue()}},{key:"render",value:function(){var e,t=this;return(0,ct.jsxs)("div",{className:"".concat(rt," ").concat("black"===this.props.theme?Xe:Je),children:[(0,ct.jsx)("label",{className:nt,children:this.props.label}),(0,ct.jsxs)("div",{ref:this.selectRef,className:"".concat(et," ").concat(this.state.showList&&tt),onClick:function(){t.handleClickInput()},children:[(0,ct.jsx)("p",{className:this.state.name?"":it,children:this.state.name||this.props.placeholder}),(0,ct.jsx)("span",{})]}),(0,ct.jsx)("div",{ref:this.listRef,className:"".concat($e," ").concat(this.state.showList&&ot),children:null===(e=this.props.options)||void 0===e?void 0:e.map((function(e){return(0,ct.jsx)("div",{className:"".concat(st," ").concat(t.state.value===e.value&&at),onClick:function(){t.handleChange(e)},children:e.name},e.value)}))})]})}}]),n}(e.Component),lt="data:audio/mpeg;base64,SUQzBAAAAAAAOlRFTkMAAAANAAADTGF2ZjUxLjEyLjIAVFNTRQAAAA8AAANMYXZmNTguMjAuMTAwAAAAAAAAAAAAAAD/80DEABBhwqRzSCgABEQQCFxcXPgOAFAaUKChiIiIju9/8kJ5PQnyf5znOc//t1Oc53///kIQhBAjCYAAQOEcIATB8H//5cP///iMH+J1ABArrStslttbICCrZfSLE4HoS5nr7xPzI//zQsQZGoIq2l2PKADTVXzjdnVou6lIMQFVlOat3QrM9LMojChx3IQOpMYRRRrqei3mkJo1Ru/hMFp8rf1HM9GXFmxwkn0Ztxz6hE6ouSe5gpqNOfblH3IbD//t/5YAKoPy+thBUdShuP/zQMQLFyLC0l/PUACJL9c3LJxWvItHOfG5/n71/LZTTy6pNnOjGtIiiGKctjBcLYKixytRzzVJrmWRfq5j/U4pU//+pZkOLGHu//0ob5py6/c3/z//U7cppeuMOeGFADskskbaSUEp//NCxAkWOyrmXmHLCgY8NuTy8fPKC4N0vIaTDiSIw9LL/tairSmyOuxRlfRTC4Qx3y91HVZ0/ZSD/JKzEIP/+lhaLsp6zf/vzo496v7O/v4o4x9P6J+TUn9G8YDMUucslaEnDEhEzGOJ//NAxAwWkx7RtsMKX8+4A7EVJdRF6NnsQLK3ReteUMFpWt4MLPvr4pvaKPsfpr0PUTVAVPP9oxxNZOpUUW/rp9v5WeNppX//2AZRbf3jv+z00f/jV/506fh1nKoAWRIpmtjMQaNgFez/80LEDBZS3s58ewRVZYp0n0QlHlWhWx1hvuw9XtsCihrCVjO3SAjEMIVWDOZCvwQMBFzGerfwwsEVPqEenUd8rf+ijCbAIunL//yHAg4l/t/2+n/JBkhPjPoqJFalkj0iSVHYwsoZNNP/80DEDhei3uJeeoT+VWGTpUKpq1T+NmNti9YBsU4n8mRBk8xzhrNb5ppASNd/ox8hPcZCd+oML6zRkWRihbp+geEpZihMrNz/71fnHIVvogpvy/6o3nrr1BYq/+IKbWtZ4dr7I5MIPv/zQsQKE+M7Bn5SSh4XyQho78QjR+o1cZarhD8gNEiygfLTggd0RjI4/9GOZFeT+Jhxwwlx/9P7rP9fozmMsZlb/9///kOPf6Nl+3/ZPX///zjqBF0OJmbtk9OIEUSUMpJW51rQtD5Ocf/zQMQWE7pW3n5ZiwS7lZMtZLRh/FQ8JRsuEN2jzIpl+348zHK+V9CPpskS+v6JKdxmhGr/q/+z/swTDO7/PB7ZTo6iZV0Mes3l3tzVTY8QVJ2kIdMOpXBrzY6nzecbKyGaZhABrV0X//NCxCIT0gbWfnoEeH0yy0h38N1BPJq+X8gMwoX33ON+Lb/+hUM0Fa9v+pRb8p6w1p3/zdKZmJQ155UAatbSfpAkMHAEzAFhiDe0pF2/3BdW1CfFZQmdWFa0tSGbvZ2ge48o5f8ilCBW//NAxC4UScK+VHrElPivpEGjN/X6mT//wb1Cxs5W6aUg8S6hKN9D3N019hYP1uoKqgB7mmYj6MxyDQuD+xv5N+50kfh7b3NptJ2xdxlB3E5a6fSNWuDcgS3ee4MAmf1b6GD5f4J/spn/80LENxQaWtZ+YYUEXb/+r1V7ro3//f6zTYhuTKLtdsU7lD3kMnUM+VnlV9kSag6SEs8G6sKrFg6HBE380hprsnH1iSFGr6UWOzKaw50wL0zuziWVf/OWj/wT/hllb/+tSBhMp4a/xI//80DEQhO5ws5+ewQc5kQOkM3ErtVmlX8EWCzrJbbZGkVBiYjFMOEq3ngqEaK2s9ju5EV/ExqXagJc9nKigNWs0Cqd9hMqOtOZ1RUHixJH+o+/81//05Vkuz2r/1+q2/9v///7O30qUf/zQsROFFLq3l5iTnbZ7UaqMThESJZY2wQOMRjGmJLRmyT1AvZsWr5IP/dLnj4Oj1dQhB//bD04bYOnHu9vE4kD/r+ysKsnepX+hTv//0PGwiTVb6pISdQBb/8qI/JeoAWOduay/6iqNP/zQMRYE+m+ux57CsjatNgtc9cCdH2QAQBLz8H5vPtGUg6OLOwXf5N3M0cZzlN0I4g1G/+5Dg/53t0qRn+39n9E7p/RtNeN4d1eujKnXi+hNmYVbtrstskhoDVC5cuQEMRJsjYaDiCF//NCxGMTUi7SVnpEciHtDnxAKCZCfjLHpWOhCXXMqUW0vH5bsACBgFZGsvcxlHOnn46putNuTyLAKwI9ryRQellqa5bgcQPiWudw+MToiAmXAfA2Zkw4BopsiEM2ZNPMNJCm3XZacbYL//NAxHEkiZLmXM4YeuWjQ/JY8IZ90p1ylTAgsTAlquoN4IBbBwTAmDgWXaaiRqoiaGTbbS1CsPmnQlYgEDAgu6/RQeLSmhwCowQsxRVCYXjJIBFRLi7YKdF4AqgUCqRRIomiHq9zCtT/80LEOSBJWtL8y9Lw2vqkFKrR7IUpDJhNrLdTsTbGZ9r7g2KpRLgkKOhHUhaoau4uRHeroGiQJTFaAloc15cRkgwGAwrrSx7vZhWA1vNMrDH+IOIHVRl+U8JgS0QiKNXIDInVISLOuRL/80DEExcjMtROYJseiBMHfUFyIcUWI+KTgLZApcU7tBamW6CipfUtmRNVkoy1azTJRyfp61otUW7J/6+VH8xs3UYt/Tb//mQ7ief/lB/+Ymy0ViYgV2WAN/qTmHsjrcpy21Q6MxLLcv/zQsQRFVj+zPZ5huDMKq6QmEz/OvkqX6Mu2AZiviyljJM2QiUs26FGMMGiTHJucHWXj1u6cUJGkpVcsNVMEsRVMPSwciFxIY2dxLBp/kPSo8oIUAx92LUuS9EfqMqDVI0ylRZi0ejcBv/zQMQXFTm2tEzDxFicqerBv4x0FOk5Yz3wugfnE/LBA3KY6r7d3avcxgS5HbbRNLrUlv/6jPiau3QnUEiezpqnuVAgcH7dPm1NKYAEEOnbXe23j2x8Rs4Mc7yrvViZxnw/wYU5F7mn//NCxB0T4yrefkvKyJi2QDWt+zVqgbdLamu1v+qGVauV9Kv0qVCmdv9ujInSlXv//paqeiv9uuX/5c3/p/+PdYAK9LdLG5R/H2ND/BOQyfGbyhGGJC5pevgDCQNNT9CPi2+600pISlYq//NAxCkUAd7FvkjFKLV2h9PDEn7ZKP/y5qjKdpn/u7PAYRF9wVr/iR3o9k/wrez+iig8BOCYIi5ff3Xfib/Msuai5iOFH0ypXnEs/mguEAoeqo1IwT81fFSmEiJrhloOiMuzgl/NfoT/80LENBMbKtp+YEU8l/+QyAElkre6/+ZL/jX76//s7v///d8UyoACFWHW7R12isn+TI6DUgeagf9kB1slcpnxxkzG1NTdGrTdrxXv48n2KW2CyE+VgahDF/BjfRgEVI/Imh7qVsYj4oH/80DEQxP5bsJ+S8TIi/ENXvU/sBnBryFcR4AAHK5G0E5xcWOmeUTAVMRHmmmNXK5ggq9saE/GQKFqFD2qZ/gYGbtmEBiwD60M0pIWcJ/8064wPhSZUAHZMPyfp0oVeV/UcmM/6gEEf//zQsROFHEetl5LxoxX/xE9gAbqoCpBUqo+YpjiNhiIGWZD+DmPGWy0SIfNrJJsz639dZqRMsj/Z8vvI////v+XKf/B5F708f6NpgPf/5REPHKBR5atMBEP4ho/FpmAiuLWLSFp88WqiP/zQMRYFYs+wZZoTT+GHdrLW25RK8+Srg70nLQTo6goW/8eC0BVK4qnS4BnOOG8mYd+RkT5ZT9ov/Y/3X8VcQ3Ipz2T//mRev12/zLP/M33o/HsJNyt8rGIDg2ICh33S2NuQKu5Wgg9//NCxFwTuzraXkhLP/iLwsEGeGxkzMrptQ0ITzveQpBj03aseAoake3ORX/99Am1v8gYYW84Ugv//qVuqLt0ft16G6L+K/1/Zl/xAXWMBgIhmksjT4zn6upsaIPCIC6pY7YUAS2v6R9E//NAxGkTIlbSXjsKWnshNleY4n+ak1SXJ88jf/oRzu/boIl2QxVH/b7uriKmUdngn//6Pon6AHb2kvQ6v/EQZDcRKrUqVeHff27Wj1usmPx2IzMrBF0h8lRR6Klia2pZU4Uhotd3opz/80LEdxRKWrZ+esR0aVbo5Q12po/tJGmHFG+ji2d6LGjevnVe2b0P5jav/nFyJd0Pb5QFq+PvlCbpL0t/u4eqsSpR4Z/9ZbaOE3bwBmURiuCnVH4yqNvZqMymlqcQeG/361bruqvhU9L/80DEgRXSgup+S07KwTvVXR2R9wAQ4Db6FFvbRioDV+dv3tRFS2mf/+5QaV/BET2/8b9tH+f/CN/B1RAGHbbY203B5OPMMUEg4phHKRAGxC+dbmA1K26MowCD9q3E8LXpOviTXHwv1f/zQsSEFYsm4n5CxH5OI+VzVTryD/Tir9m7UMDKcOfKh/TtT+pV1/QDO/TSvoN/yE//z5a8Y6oMiCWW2RtuUf7U9woZhkszR4GkuVZC3pf/pyCW5kVS+rPc/woSCtDbTb/woU4oK3fdP//zQMSJFYsqwl5SxH5mk+rfSzVKZVTTbtRvWoW1n+b/t07aNLoddW/+n+UMuqAABs5WQWYV8auBoUE6P8LdB3HHn6aHKTVJSMglgbDbeissJCcVnqVFawYgQMVBA60e1DZzns0aOdJr//NCxI0UYyrKXliNeskYpz9Xo75CfXX/53/prQ3/f6fXb3fSw//+/9fkauAEmVVNBCjIqEiByU6DjsiQmszC8U9Hlp45A76M+BQOR19ahAOypM+0fP25a7em0syQGgWUujsFEhPo5lfq//NAxJcWElquXMJEtKQymDE2fRQnks/K/o1KzHIz60/VvetqaDVPR3BspEDln6gwPHQHicgX1F9BCqk6tttv9t7xkCUF3EhzjlmrWxfFfM0eDFcEnet1N8etKZ90n1E9KUN/R9nVWij/80LEmRqiPqVi2wSszZn6KvfL9P9tuvUvrq/Sjei//ylr2YGN/7+j/9P4p2SqAAhjklkkltFBCWAxQnC3Ch0bibkTsIJwsSzUGfcRHYROHlpRZdQzGyWsMP8Z+XdW/ydDXP/+j3V1diP/80DEihOTJwZeekQe5Em+X+luTfS3neryNZR33tQNb/yat/FB1QCGbcbbjo0FKYQsaTMVON5uRjtgr274lI45ngI/bSKry4xKBj0qhWZWdIwwtqSqWKN6aZ+RjSf/6p9Heif1+7oVuv/zQsSWFNsq2l5iisK9eevENHWisqP/yft/X+oGBA+qBd1sut1t2GNh8ZFdNlN6K5ho5gaokGdRCS3HQ+E46987SDUWwZXOi7vB+itU39M3ilMXadH0MtlOU7GVFf/1b8xfT///1+fzDP/zQMSeFQsuxZ55yqbeTt4M5rMVA8Vc320s2FRAxgiaC6n2o7kcjW5BLib5XRD4rl+Pm/z8fkgltMrwod0LqRofGqoffwS0MEP1+/e/HEG22anFDt7/Xzoa9Zz+3bKH8xZW7kA2AKrt//NCxKQT2wLlvllE4tv9vt9xK3DXvYyBMhemNC9LYMj0mVwHErqmP0EOjPNoJTuFTjakdIn+M14gdRcK/VvnOqGY3GJ9GQXjPb/5R3rt8jdwK/n//9fH+lfd//jnACil2+11uuED0YJm//NAxLAUOXK9vnlG6AujCKZQ55GXykfHDt5ADW5+Sy8kSHg0/L15KztgsR+iMGKGp+LEfZwcE3/6mK//8gyBjh0WelP9W9aMXRFbUwCj4a/1lzko/Z8kZhlJLZJJHRkWeCIkXbB1YbL/80LEuhTDLu5eYorODGaJZs+izPG/H650xehXJxHR55QvY1xMG6DWhKQbrSJ9edyjKN9G+pXb/+o0OGFnybPdi2+pR3D9C2J9Dqv/I0m5G0knhUTAmZvJJGDpgI+FDrL6eSHuJ8Ir/H//80DEwxWyWuJeWI9Wmf+ngfFPNnbZW8CNk4QKpjCzye38mKL+jfv/5/lm//5/oRvJv+jf/5CdTrcTdEIyPeQjc708tpQTLQ4AQNCuqtep+gHbddbbJLxJZEdFni3nZ1NLPuPd0Qr0ev/zQsTHE/m6yR55xPKOqqL7or1H7vnDbLV9WrlYF9Qpoyrqj7Urn/Qqor7tZm/lQ3/dG7tX6/2p///DsUZGOMPOzK4P984lTyUt4DEmVR6E8ZkJpCWMoXHUKuQNYfUss2OI5xmB5LQNzf/zQMTTF6tOwH55WV7KJxdcEAv8bYoIrZMuwqeEi/C2oLBL+3wkxxhCmNYvWqsyZT6gq8ilQ+f+RDUgdnbaxpiPegLnftpddJRzsfHm37Veb0knw7p7tG4v44om/4jRWuJqQ662lf0o//NCxM8WG0blvmiTX/sf6LYCAlZv1+oNwzgm//OgZf/mR2RCqVtmKG/Df0dRxEnltHq/2fyy1wBI5ftrdbbhpLSk6r5htHw0aE4jJtSE2Mf/0JbvH/fh73VUZYnz29lr+XGGtHbY1Cj4//NAxNIT6L6UKtKEpKI/yc1GV5h31/UFEHMr/+IqJAmujsqt//mV+b0MJN/+v/2z6WL/b6ah2J6FBMj1+/211vEsnLqFGn69TpwvRzsCsuhIzYKw+2cIo5lzeXTk8s09hijeziquMEn/80LE3RP6Jtm+ekTq/0ppioOUWZR31b6mVi/O37Id1XXt+3+6nff8jff9X/9LN5v/9OYwiDauGHtfa29nhzCO8Vh3Ox9ZTrZHcW6lvBPKIrfsQNA79MNpqfzaco1424v/8yZdXiilChj/80DE6RdjKtZeY8rOOf7lDt0UAdFXR9W+zEz+jfsgxCyOVW/kb+HKHFcvkLA8KpnjA35r1Jft5vr//r6HeL2Iy9WACt1QyYO7aB04cA5bjmT57zRnDWVKrJ2bHVt/+wqAWnUkp8kc/v/zQMTmFntG3l5jSs5jEJJm1ZmL/Wr+eTzn6+30eqFP/6KyHf2vMQv/Uoa6v/lAb0WaMgpZ+W/4cyoBSEYRBSckcsrlct9YDZFGm6NCeB2zilyDaFAQ47kv6n7A8xMOAEB6xvEV5Dh+//NCxOcZS06cfniVVHEpZMQzQsIUd4e1dI6ZVMCDy+kio00UdvDyUIIkLFysF3tprUFoUHY0YNzz96s/BsczpDJfJOPyNxui+1h4OUi/i9h76IclvNO7z3yiSHOmW1M/Vdvhtfxbf9mz//NAxN0VAlKRF09QAKr9m7/lN/DP4Ycx7v+SAUm22ytvpLVRUBUK4ldSKRMPPXDcvd2ect0DRU+CcCaHg1LAIy9A4JiObKE4Q3GjDQCchTig2pIZMp77Aek0dBhQ8wojT3v/tDXs8SD/80LE5CXDBpJdmFgAdiyvduWhjmVf5UuZq3SVFUGqstuFJ9lb/ZWzTXHejKTkYVk5LU3x6633HX/Ff19+nexrqe+p4Xhq0sIlhMcOf+t3/NqW9RttyNyUTp/p6uSf50u1QLpyG1lddqn/80DEqSQq1tDLmFgASaCI3NmljRswuHiKIeaVHRaayWLmlKnt2E4UJpQxWPuRKDcUGKeazFWaPGHsVNNyNXMf6dzWmVeh5vNmMl2v++VbQ59C+c5d/3f/zHZalPXuNd5UUPXCQISFRP/zQsRzG1su/b/MOAJ0mQSAph5i76L6yHtOMg26YTaxBOj6tvmA5NFawXz0ENrAYCJY3dmQy8UVUyhh5M1b6rQzUzNVaVuhU65nyzodkq8yPOklWUCzouv55vr30ZZk8s1/Igz0FIGFP//zQMRhGUMSxYZ4xRD8GJ4aQ0R8dkskvHiZ51QawDpnzIHP2KU3FYLf8HnCQiNI0BtqO3Z+1YkjTXUYmpUQG2Yza5jXfSXKQVM7HsVTJ/6llzOW9+uqGq+/95WXf/6ffRWfq3/6p8Ev//NCxFcWI0LZvkhFINBlwAABqKtFQDyoBm6UkgR0AdUnUkLt01KLJlLbs4rDELKScqlYW/i+OoYk0QHCyz0SODUXUd13wRCwyKL44i2Vvt7uzBurdbljU8kBQ+qIWEDyVty3gS0fLk5k//NAxFoTGLLCVmJK5E646gNFJNPCh+N093q6gaLQHPElYhE2og8PLPFSQEnAMJgQWlJ7HmC2vDWR6dSc5hoNa9Z1ETYi1aO7kYAh+TWM9yxBOEvLwR5WlfTqPxGRXo5ye0U7GzTYD+L/80LEaBJAkspeYdjAWrRYpxbR7VdkfyOc+rY9L0pfrZv/qv3f/Trv/Vk7ff0f//9AH/RvI3nn//CTyVWAIGEZz5RnymYsuKqQpMzwnBea2L4PId1U36fHA2OZvD5xQFfEyk4xEZp63/r/80DEexNLMrTuewpWg8LnC3CPfKqW4qstDolVdpZpEn+hqKpZlJPJn/qdt3+UP4LK4kasbkkklF1XsSMagZIpJ//HuPRjwOkChNIVIEecZ2W9X0lb9gVrqjo82t6nd6qj0VytP9EzNP/zQsSIFBkanPTDBlQ/buben/zs3ZH9GO3Z5fL/Z/R///7aG4J6tesVoZvtttsMreBi0+OBIhRQx/kLXOzNpkyGw9KrXdX05YflJ4jbOEkM/snw8sM8xYlT7OynjR6rQJ9wgcRdv3VvqP/zQMSTE+M6zb5JxMbk/sEDu8QOoL4Ylw/VDQTVX4SbcrJQvXB9Fo+3taQN1Vb/873UKSmL8wChfYMM2pyefVc1l+ZbXWr/4JuZu39T9vdpkZG//D/WfWA9pfGnVBwLCEOoPCoViRIC//NCxJ4TyRryfjMGVjVSgZn5ywoSxxCqfK9Ui6WTgx+KdydFP3WrJOoVO0OGM1FcqEMy3+9G+2PRnsWu6G+R/0VvfO3M7TPq2jZqf/zKX6to6dW/+FOV30+WcWqRSOXa26W20R408Gpz//NAxKoTOlKYQnhFEMLLQSK/UthP9ulSM09YFTnenfbm7irrrzLRjGPo/OzFEAjFdgvKwr/v18r5TlBENWvOOShCztjvDr/v9K3PqV/mKgrJJG5HQ2zDQhJwoHslOKcOcg+0ZAwHaY7/80LEuBPixpR0ewRUYENgslMd+NIp7q4Rv4KBoMyoJA2mCCLKzpppOJHJiASheVEb8o7kRK8selG+p1eu3vmfVE4wKlIhUzlVlkcdw/1lsfs2Fczq2VJvP48SZl+M30UWCWHFhWv3s4v/80DExBORutJeMwTKhHttn1bJb/0e1w27SlZN+9kWAOr3l1X10Bq0v/RWuYJ6I/XvJn56tRyuvUV/1y/0TK8vqd6eb/g3Qu0xIx4p4+3m2w/2CA1Hm8xwOs1xSsK61KlfiEIMDDnn0//zQsTQFDDulH5ChqSTaOWWZLRBEJVH3Y7NgRqPZBpX3MOB970NkdpH2IIMJj//SjHX0Pf95kIRXKheY82tRrpfDDeWlyOVcx3ycPozZ3y3SKyMTlVUZP/ClYtojktO1PK3Ovs5ulUMF//zQMTbF6smkd55hQ0tYqsK1noqx4uioHK8HKqaCwuldjMsTxbiE2DYKW8xX1WGEndUMQ0hP/NnQr6ERgQlCNBpQMxnW042INoZ4F93yCzHvmQ71NPSUpQOCcZMrjkg7T73DL+bBqMZ//NCxNcXqlaefjMKkL6Kjn8NIm01Nz7nzuNNtJoEHVlHGMV7mOcUDh2ipDvHyDyMVGxx0dGHKHkHJ25ypRjxATOcw18ifXVvVnjWce2z/xtUZCIVaZ9duhFb+iaPJ70/nPxI9NUoUCMW//NAxNQaQoaFvmIFLIEFYrFIpNYDIA5uULTBrQSGQ1XXihbCEyfTkQIy55GUYkqI2MseoXQZHAkCaUw/jCD9fDnnDQ2GDGDJceFXLjFwuGgXc3GEHgUWs11GibnjN0y6SixhSmXhhb//80LExhmLGn5dTygA8vubvT4yyEbl53N2eeVXr9lpoM5oyZohVRN0EZqmieXV//+bvTdkPqQakkm5kZgAYCIr///1KlP7vr9yUMhaH4ghuqW2KQniI2oEVmOAe1x9nTC3zJnMswsUyEf/80DEuyVK9q5fmGgAeCUUjQxjJN0TsYpXvmoZ1ZzOXNNKVX9q/M62r+96q9HsVtSlN+vo+Y3VCpdPVneZJyOVGjanqrAzUY1SCeSqApb0s220vGMBlF2sh0ISw7FecYo6BFtLqtW6/f/zQsSAGNMq4ZfMEAKtb3FtH02T657MvOU9AnvaMqwVIUisrmUBKLONXSiGdyosjmS//YGjS1kM8hrB01fVZioCNVkv5urfzWoZ7/R5bGC0M1a06G7ahSegIaoshpqyoF/zdGJUABa1A//zQMR4GlNCxb7DBFyAdtxaRrLrsdQhhQ1KaxDHjQ9VSnDtSyeuHtdxB+JsUMYCcfMNeIs/I/5I3iz42GKpA0idOCyHT7Qqaby2OUaIvN44176kZ9AK2J73v9yVcHTVNQGQq405JJR1//NCxGkYGSKcVMsQcA4pMYkSrQDnAmeDVFQirK6im8tffUv2WLg/lRzE7VO/PPAIsRNa0N7jz1kcy+o/mf/dHXZUWyN6pySTtF+5j2cWvoq/fpRT+riiADkd11m22/E1DZkmcp1KkNo1//NAxGQUabbFvsMOPkcU6gl+WVdtjJv3a1pdHXu9jCxvWtTbUFZgV8fT4jcQtT1Ict1AqYyJVWed1oM3HpD7KH8l2f3J7QKVJJJJJgBkUwLk5AjLweXNxtUjtfcMbw53faXU1poprFz/80LEbRLBHuZeYkReoBBWoIaooa9I4fSmN+IAjWTojHAOQVoObdaGNW51LRvXq7+/LP+X9v9la8/1EUUBtSOR2Wz0VHsP9iG3OGOm7yF5Til5OFW7pTX7oOIN4Ux7kw81D+CcadVQHWz/80DEfhQqUsW+egTvNbl1Q3DD3R/k/vTN1f+jaac30/f/X9H////mDg3xD/RtVFq1E6cl2k224HfCJn+dmVq71U4cDHm5WtCx4uqET4yH+Ba3efdZ6AdxR6Tzl1RuNJodp/Ufqhub///zQsSIFCMazb57Cjq31FPVe9H7V/qw3X//tm/Rf/f//qG5LqeVfwCxZ/qEAgI7QjZAEaC8jBTwixFy2iQoNtaUgEzFNN4HW8zkjSAxOnybb0gDIvGi3jQGfSX+EKjYRvlJiiv3JfheNv/zQMSTFALG1b56yn5qdTch9D1v6vU7uT2f/0IGgInLaJoqRQAQAELk48PFmdCaLX8KeyAHjaiOf+4X/f//6f3Rf2/9VO6EV7E5PV2PzkeiqEbkV1fVnp8jThBqADhBF1OjK4AxgASL//NCxJ4UaR6AANvQVCGalTkM7HrnOymEBhKJf4KExP4kaZUZDYGcQkuQTTB50j0cSC+pAI9bCtb1CF+z6vqBunVP99Ldf76f//VjfZfbrMbqORK2a/lb8i87/VTGQxv1VhpAaDmIjP16//NAxKgWeyqwXsGESc8hAEjdtktrsmHSAoaoDSF+dXKSEvLdNNb7vco1pbXRV3tVJHXvsC5ppV+EupzcT/kehi8A/p/p+n7//+27lWi5SGr/+Cfbiz/rBU75Z/vIB9UD52WS3S24VGn/80LEqRPyxpgA0spUJmEu8nRl6mrvW6eT1aMSUOpq1KQFbz7ldvUi2u0bd4zdw9tD1+QR5OQDsn/yLVBJ+d/R/9/6ehsy27I6/9xat3qf/FTv1CEqYQBG3trdtf+BUwga8dLc5+3TpNX/80DEtRPSUtJeecUGUL47Uw9v6hklWTRGuvtQppIIe8EwxmZfnqg7NErbjatOgfj5YgWwwSHfT87qWVj5B+1/qXdU/Vyoteh3Gqj7zhsY8qV/LEoc/+s6AFhUdcskuAGCe4u8+6uKqP/zQsTAFHJWyb56ywZI28ZsAxDJTzi88ib0pOW5Y00C6EOlu9Ds1aOLn4MZdu/mxc9/cpOqBhjD24+Eh8UqRZSIuX/81+Tq8r7f3MfmlSuxxyv8edD1h1Yb1Mw/E9UAgLfp4hMoR45q6f/zQMTKF3pSyl57TyJQIZcGuwZirx4wYKjKj0WT3cmH+xNm1WB8xQP9vNEnuWyqJBLQfIxILnV9Mzhf5bVsy+zYDcQD9E9iJCxcdwX/9BiNVKr9S/41+xRr0dDP/+OZ9iC/hArc4J2A//NCxMcYCgquXsvOXkb/b/9SUlgDDw0xXpP8KDFh4DAQqLiJCDhcoFlPqbtZbvP6yaO4ltvZejNNXowwqwlGYGs+58S5BJR02zATVK5x9y9ui/NqlO1TG369yNZPlrp//sp5H1NzlZLL//NAxMIaqoZ9jt4KXi2SvV7P+fv+fwagUU+pqgIp08je2MQhiGCccRlT1zt516A4apmiZqUy+U1kcxJp9Q8C+brUTkluSKgvZTVsdTRlN3cd48wkYmZT0/Wikb2TJdNyXJM3Jf/WaNT/80LEshUZHngtW2gAU3QdzM3NS/Jcvub1fv1LWb71Xsycvl9zMvpp5QT//+/+/y4MIYkui6BqkXD6BoXzf//////+OcIVDyv3esT8CZBGCYEGJGWMe6nQtksm5ZGIuKHeWC2jkUKNCXD/80DEuSVTxupfmGgDRAYmQigVIUhipsopTN1eDbBxEihNS0WkcRESkyqKCs3rRrPOsIlu1aVp5SaqH+lsl4sfPLzWxEu6Df9Wz/CryWXknJf1HvX/XvFV4xfRJF0Ud/zQptmvzOlZhP/zQsR+IQJayMvPSAFU3/CirwpCba/+bnHo9yFU/eMik+H8uZo8mJsh/6MjyIqWyuy2uWDv8s0lCX8el/xhzyzTqnI10MDTlR0HQpCS//2r37fZ9svZ+32nZJX/2+nsg3NeX60A0SYCd//zQMRWFDK+9ZZJhNbORVBMORlSEwSwa6ryXKI+exL+wfUElWhw20RQ+bDaTYLIF0jXh2s6NLmAMJZIKEAg0qVEqMVHbCSuOUmdSc7j2v6+RnQ5iR3WGflwIoUU3E5JZbtxqgneTR/Y//NCxGAUaLLEBlvSDq6mSV/Mref1a6BUcjZrQH9EE22uhl36+14IyvQFCUctEVm+2a65jSyOTM61dW/7On99xg/b/8QfiDeoj////+NBmqkm5NbbtdtxR09XNKcpSzrNxpPbrsb6JAbF//NAxGoT8zsCXliK9qamSyx2id6q33mevGxyHlrezv3Ogh8uSOylG0zTCovne37xCJXSpgafuSmXc+us987/n/rDVYAG5V7dw95UwYKyJ9Lnjh/5+M7u+CIuDa9GuHZOs5GK9H0wRKP/80LEdRPZawZeSsbqJGvH/TdtNU9LpbsqmRSu3//fTOV/5f5jU5qohqOVv0fT//6f/hAfxg7BBdSW5bJbbrhU3FsfR7KxkTcsherWA0SE0pTszxDi6gZ/ugzTUtpBirtyK1K6oWZ0yoz/80DEgRPjGtEWSsqWj6HxXaVPKWXZn8v/p/eT5OrEHr8qeq9Py4HdxCqACuuvboEKbNKhNoKrHKNNM6sWvrq1/NPhYJFI2GkcBsKM+gMg7TCxk5WrumnRrv37bzs//tGtV3lfmU1NDf/zQsSME1pS6b5SROr/3/9PerZG2/oP9dHCYeqoqO36227bAe67G1z9MWSGfGEHBY52yJpvHugSwuTYjHpL45fbR3yO1XcR0i7uInVnz1qhKQtvoTNeKMjlK+f+TqGgQWIMPJemaKu/Q//zQMSaEyKmwZYTCh7XqD3BmuOQWWWYZ4lAhWlWhQKBQDR+44nrkX2LnDUepUMtHrnb2//9WQz+oH/8h8EpCFO7f9X//RffhKuMjyddCVHYhCEJ+3vX//9RYtRZABofwINckdLaWE2o//NAxKgT+NbqXjPGki3oX6OZ+YdabTAZIufYhg4H3dbJFzEP8WZacjf9MvbUisdUV3Qan/0fendP7XpfZ1dlq2i6V9v/l//f2VLXalPZf+UpCg4oUNUQwSNx2S/Pn2TFVwgozVXTSAL/80LEsxPDPuG+CkSOPr0ytywLLBa/xHwrN6t/W17Ri3rvzX/981Q0WhCDi+JeaB8dF1xdfFw0F0OVx7t+V7dNfT75WJn4xMJX/1hNgIMskmiMYHzT7iX2MCqsW2CeDRjCei0/g6up0Yr/80DEwBRjTrm+K8osSDV+3lK+H/PLd1vyX+EdBmT+dSeVLQHcEAXYU4wdcKFCvT8bX///gFwdyvOrGArs/eloCB3XXfWbgcxwf8f3EQ8KjhTkUoKiFvdyD9Grj2iHqEU0Ep90ikzt1P/zQsTJFDGiwbxrEFJhQ9BOktu5iZGCyRMGmpk76zw7WOfatziWv9l3///6fu0VNbv/5kfIQjqXVzG+an+QdSnbja9Q1jqxOxCWvuahKqEVSDQR0oOkGy1IfhZNFbnLX5t1n7W8cs6X1v/zQMTUE8GGub54yy6e/y/ztESOueBCWD2dpvTQ70zGQOQfBH4cbAZliucRo6P/0HuT91ab/yqIP8QFWKIsKjs5SiQt+rI83+KP4a/7lSTaiaj4+VReWQ0z9iTPDK2mLiwsmewtoMkf//NCxOAWoxrKXltFFnBCg0SE2zXdPol7PUFN7ey6yUG8616akU+I2rndgugpO7jtTXaMOphExrmQiiMwqxSmf8Y/mUhmQhhj+dRlUb02935BUuanv/r3yP+VAIEjztlmgH6vfYlWN0Q1//NAxOEaksaAXtDLLMwVV0gW5t7YuCownWqTyr5oVm5Lwa0xCPnQ7dahW8gUCUMJXKEOhDkmipXOuCYzkMg/oZ72sj1OjPZvqzqY/VMurfzcO/oKdtAt/+RVkMTcbjkcoEIAlAX8hD3/80LE0RnCPnhe08qwKmcq4ucKcY0VQM8BtjMl1pzeN76JuQfTmr4Go+4hr1PuRDvDoQ6OEyGToy+j3q89daj/6f89yf/9f2sy1oT//brUjcjP0ZT7agadZYIMQwOU6MMTInQ8oNe3AwL/80DExhbSPoW+y8SsKAaQaKo8TYCweo0gqkWtJDJivc667F2SWMVnAZXEO6cQnBUegjAOauKNEZQtFz7j6q02gwXDcIF5eGoKz3oo8hGiQLyUQiRu1nPhP1nnVlFa51kTfL9PBCIgM//zQsTFFmMKqb4rxD8nPdT99EQ0LKA2oc/n/Yz//0n7bDx8ADD0kdtxf2OGa1mwIYAAWaFvOjg80MgEkQsjQ6kJ6AwSDZCSg3+gp1oAblAY1Ecq7fqsJlutS7VqQ4SqX0QalaQ9FFogZP/zQMTHI3JGkADSRxUZzN0/Bp1YhpSWTX1qww9KgPY3+kdcB/Y5/8/h2TbOnl7ccs9rS2sYUbHw/ArKvD7fZ+tDh9X9SCkOqBBS+oKDDYJiVWQJA/gl/zDTKkAoZbZrrrbxgRR8m5ds//NCxJQhSz6hlNGHET5GaG7EbcsFm5lnAQjZgnEKvy5Cvh+cdxhqjt6KLZ3oiuT7QZjx9jJ7+f0KDdCgd2p/K036L2hrrcjy2Ipa3WE31QAabrdvt7/x0Z1Fj0VzSKPRsEPSHxKm6gSI//NAxGoTyTLqXnsKWqE5eMvJRoO6PlWdgRVi2PubpKGGHASLcdPusTHb/I/f+0qRNaqN9fb//r++UNMplSyf6yIt9dImAIbtkcmmwHJq1g6Dcdo2VGypijfSTvzGPp3m47c6xqE3nVv/80LEdRSCRupeS07C0msjZP2JPPAmyWxgV0epyHp6IvrV8M23xT/+j5xh9A7uW/7sMigsBZR3/Ij3fjkAhOWyS67gQhHjAFhGxEtlJQ3ziu/br6smWPxZLfOrSrGssz8RaV5NFdW66xb/80DEfxRxrsm+egUiPRU7lmB3rx1YB8tR8G2b4bPkJ1386r9hassdAjk+vh+yj91aTbkT3dAFCQvdIXOtJTg++J6pEW6l3m+Q8vk76B1tFofz2WuFaeBLNdD3UnYuDCuxOcqzGZN8p//zQsSIFClaxb54jUpdXxe3+Pm9l7DA0v+RlxKJTuF/6uHa6gnHJP4ABDRvYAVM+zAuSTQBzitgAElw4K8sFb0rwoAfsNBasGpc5pc/Dljq7A4oWsd9UjUQGuxCaVexyOpyIIxbOeVawv/zQMSTE1GutH7D1DoS//bnlejsE3/9+6oAhOyWTfYAQymN0eBmuCjw53gz4c5PRpmifkyxrXNUSjDQesDked5HKTxQXVybyr6r0its3tsX/0Rj2U7zDEW5Q/SNC39vnn555x5557j7//NCxKAUEW6YfsvOdPPZaozGG1ItFodDotFotUMyGhcnMSiqKZUMDIfMubNhoJxGvSMjh+Yg1EUTK42BvHwsEhYZjqGuA2AXG4uIaTOYDYIQBcBsblVci7XYxihIIsG8Q4sFiNrJ+6up//NAxKsUYh7Jv084AiN0HhgtsefRVNd3Rpn6ERgtkcL8RZO2e7F1d5ntYzdN9vNUjLpkZx4X4L43LP+y7Jp///8eDEdBoP/6aomso0oio3Ngqolm4GSkdripTOSpKp1aWfD2tWgpSqX/80LEtCUTfv5fj1ACSpYuJVbm5StefOmj1S1Lt9bKjuRrr//vSiov1z9PRcjZKo/Rfdl1/n/7K///I0nCmm0qfWap7KssKy+GOHzbWLQRLjQ0WUy+mY78YjBkWpmepMFVLqjawVNAzFH/80DEexPzMvJfyxAA71pATgMUHj3WVhoBJS/EOCqZ6103e5YaKtkAJ57U/oO+HPEpmWNV0lu1tstttuHXqyCiJRiljT0oJCiadIKfUFoLNZn7iIh6CWX/7zYyoCJlj1Z61PopyZGBrv/zQsSGFFj63jRiBmxR75G1504Ylq5u/Wx/uLXa8UbWY5XS9ogWDKrARleK4iYBZgiZFRMG1YGkpUJm1ckklbW5FFJ+hh+4iAXYcZSpGOoqNM2EbHkgqBXiwdO2np29yoFI2kqzwPeGQ//zQMSQE4k7Cl4xRsoKfTJFtz/y5+gokRWankkTasB3EispQWrHBE9nilkjky2quRjCpnqN3Knqbm7rJjYQhGLRT4u2wogYZMXVv5pPiXI1vf4kuOvksvtujUhRzORj5VQ6rUDP/W6J//NCxJwUgOK1gkpGcEiIqom2pZLJI3JB7CHKpe8NDbqNcq7eROqq3AboCbSkjpwMooQAwhT23njq9eEZJdTJf9Rr9CrdF3mjqP7CXtv12da2FlAAMX8NRCInfeeP9IgqQAoJX1VQlhaW//NAxKYTEj61rkhFHELxsAw2cjfOCnU42cjjG1KyFQX6mGzJR7yt0HirfDKEBK8rKAxFX6WmWNNXGnIFWGlkiNrNbCoa2zFTjS/reCriSXfs6iUoAYsD6KYoRfSSIA3qO2WWZSG2YKT/80LEtBPRRtpeMwYyCkABI5D1XwxwAJZ1DJ8z8UCNDgUNjx4sjNnzglLSrXhJBZQQNTyxU2ddDBZvBx1dlKmv/kTM+oF25aX+QZAFlJFsIBWb1gYa5jAgtAriGELMtaLYcFewJwt5Czr/80DEwBO4+pQmYkZQ37+O8XJCxYDIq/T6jHg4HjuWfCQiWnzolaUgoZ9YwGii48hJwQHLf8H8oRo//KKBnsgcxO1FFswQtaSQKL8MQ3DyylOK2qCFxlknaGP5bJRvNLsxoN00fX69pf/zQsTMFHDajEQTxhDyk6fMGbz0veJ0mX8+ur0+2W8RdnFEZr5H+t6yE9LVj2baAWSlbjklnGA8wVpJJZuYKYTm4xhovDOxXxhPd8QQzFZ7NWAGp95JFQztOn3tqp1FIdo6EyZKuKFnDf/zQMTWE2kesZDD0FTGpXazW7X1bqIxI3lf37eN0zOb9Dfg34T5n//yG6ldCav0FMb6BjgLVUi1GrZZbt8BpVlad+m1HLTueUykmsWwuU48lWlPigXKwelQJmxCXPJWzyy0lq/A5t3+//NCxOMTYQq8wsGK6J+J8RFCBka8ejGu/V+3q6CvoEH6PM76hb9EM5P8efyDB+R///+M2h0vDqoRem3JdeJQ+0aaFhBCSshdXrw0TNrn5TWUr7tu6DmZGBnvrJ2LIXUmUbkubImdloBM//NAxPEYiy7hvmHFRrpUW+cOLikipKa81C/V1LmnZvqPOKvoNi35EzqWG3TQf/1F2g8Pk35Rv//6DZv4s////gLD2gU61HLLrxkmKbQ6Id9z6RFpFEub27VDfI/cqTZn4M8LEmTZvxD/80LE6RcKuvZeesq2JC9I7GfjD1Gzjwu5oCw2fv/UvER4wWjHiSD/MEyFFH/UOxAW9BrfoZuM/WZ/Wy+phF+VuQ6f/43+j////oAg8TFKWuNyb/CMEAB5AuWNPkELmLetLoyVK0vdXMb/80DE6BmzStD+e08K0otvI88MSFxtJj9H2TfgW/1tWkMZnSM1vMg6Ae7VmkR4NfRhQ9SoalmHns4ufzWYJf/KB7T8df/Px0Hxvoc/8cGjmtx4Rn/0KjVv6+sexKG/nirv/kQVCUuHWP/zQsTcGaNO1R55yybL+o1UJMEhiZPN0KzLxE20kKHGlEYEYaJDgCNwOFoUKFFJgkyaRJaXT8WAwR4cNtjsbmWKRd5M5LS85F/lTttniU3GP+ssaLY4SmxTF6l4mOFLZoacat7rx0vQ4f/zQMTRHEK+vF5513Zml0+X0PMetlNkkO6t/T9TP6Fv/yR7//qbrgoKMtoAjKUjsuuuw02eJMws9AzRxIqjTfPz2qTFmoF+ns56Uck8y3X/rTk9GMJRl3E0zY2Y2tYVT2rSMDO8+c6j//NCxLseck6ADt4Ofui/1vzh7YTCLX3PFPjQXfHt46G1D0PRW4UlbjtOTXZKTKA+z65W3Ix6i02VW5r5LijSQo3S2VYlDp55rDCmUzDZ+RHDP15Um76A2z/Ssvk05664BYOqp9K4jhfi//NAxJ0ZcgqcXsNRLjn/5L+PU+yHt/jiX5IMSEFKmaSb5INoO3zm3DfNtHJV6Bi4Ovf7I2guTvYxJAwlMgZbKEigoTMLORvEA4jOE5QUORgoMk6RR4oi+F0XDDJ8KCxOpyRJldYkTbL/80LEkiTLNpQWwhL+FFUoObbCxQCyh+GkSlPKszH67VLdTO5DXlfb1f9riWGZqS/LZ9Yv+Ci7oy5p8L8v//+/d5XksySkxhFYY3Emj0t0fcA0vIBWQz84dPjRBRDhWSYkdo9EvWKUJpz/80DEWiTTTqgeeNj81fC9TsY5YTHjlccERAVnho/GduFts6OT+EtAdEp1ynLTphSZn5PXiAqHk2UJnbHYUHxotTPsnbyzVQm6+iSKH6Un6SDEbiOugH46UR7hFiaRjTgabBHUFsVcxf/zQsQhE/oOpPRiCpDs+7vZIRXLmspbP/qjyOpjIZS3/a6NL8v/3qh6OfBWFtbv+ecRz1fJWlTK5Y83Kh043LGvgpMyFZHG6M4cdIwxqZ4/9oRiiRyjzJYhlQiaWPJvSDtQcOiD61Zh8v/zQMQtFCk+sRxK0KbrHcR9D9Vkp9/diUKZbXpChoKEzIZetv+d5U7qDVC3km2ysS0cuRyXT8Ki8BkRc8LItKNJnn+TbZqsbk0Olad7Q+WQUXjW+C2heIcFSHj0qLqp9Vupeoi+G5sV//NCxDcUiZ6pHErQjoSBW5q6EE6K/e7KPvYR5VUWnhEz/yPr7rDni6pHbbb3WgdebQ/0inXJjP2SE4nWXRkfkn8n9Bx+tj92FnU4muMZykX3NuPsFY3T75yu7etbEk6Zbkfoaj+pwyO///NAxEAUSgKQfnpEfK1f9zPbxKPvy7PWK/qS75YOVQEYnI/gewDcAbDrQBPA9Eyhx3g0W2H2tHWR22re+b0BC73ROFsi38/gak02q4Qfa6DyM7uRWtqx2r182yX6uruKjDjId6Udz33/80LESRRBmnR8eYroslrCVdf/Z+4AhzS3bf0AUPd/eRsX5GfrllIyq2TqmCoY8MfMiCCURNDodDFKFs4DGb9YBIt4sBBYxFi4qmwg5wiIfMjXA0IqzmwJuoElKw4V/Z1KCLjku2wYEY3/80DEVBLY1oW+ekaM0vQLFnV8BNIzvVEoTzg5y0PGXe3mLsB9I4xEARxJmcrCpRIaRZGynqxmVJbJulqImejmpP5W5u6vM+dmV/6CRziv/VyLjC//6dcVqqqeWqquqkiQPcreNAC4wf/zQsRjFHo2eR9PKAABsMjX075nCVtUyXmTIf1e8+KWWK+IFNBwDTLIyRMIFk6pQcsHdAHZ42Ws3SxYyYYqMZLWgiaIMybk+YHuvboLzUvoGZMGguCz+t/q44BwDliyyJpGjC4+l7/fZP/zQMRtIkJefZWYiAK/WZm5uqYE4xocRIoRS/XtQPz+YieQ4YZ/9H+UgEARUAZEAgDAgEBgADDgN0Po4R9hFnYeQ7cBqXBPrZ0O4aJAqFh4K4tEpBQBOQCJHpEYVhTCwpOTEpxyozio//NCxD8i08rKX49QAFjziQbMaPmdakIizmC4HB+QnuimnlETeg3JCcgYxZIXKtzl03ncwuQNU9zGY9HOazU83djfMrjxpjEhGT0Y+fp1Tqm/+n///////+VVjIARD4wKWSrP0Ag1bSIV//NAxA8UQP6sAdkYAJyzGMymfhq7t8vjd6pdxtaxeyrRLhFWcbB0zjOpHqqa0gQ7yYaPZUydUKrALrnbsVT5hNhhin+7O+/5YsJQ79X1mQhcxoClJvIMW4OCN3EMcFlQAEoa+ja/bef/80DEGRZ5Dpgq29BsnIjlMhrE4PiZs9uvuIs5ph0MRMoQqyNAc2saXinwMGfC18nUi4VNGaCtFMu4qNth3knVnYa/zuc/DmSYeyr5XzIIKJEpWMQTRUukQwoN28wXDDJCWAcDZ0jVjv/zQsQaFZoOsR7DBF4Ec2kqf0YO3KRySoVDl4609dSvyTaT09AZaHbi6qo/KqIzl6MubZKvrI0MJECexzv+j/k4Ydn/kuU///PVAucskku24HSIlF8t2k5tWRT21R3L8u6NuVG6rz1dqf/zQMQfE2IW1b56BO6yEV1a8SUbHARcVdLUhb5L1aEO4W7rDft7oqHo2upaK9xDcGG//oEX4Zv/8Gfh9QPjbLJbtsBz8DzFFTEP/qo4lcstzlBpLA9PNNEquSnbkuYXb0pvyUPtBzI3//NCxCwUAf7RvnpK6nvBLKIm4dorvxHlI0rKd0yZvP0M40crezc3+rCRdB7/1P87kQBK3bf7v8mw2rpD8LjsKaDvQJQJb9xQ9+pvXalQo1xgi9+FeYrQUUHA5AfRn0YnvncRAB/IFxcj//NAxDgTgcbaWHsKmqODulHegUmLivqplDxy4h/jB341OOcDoqyNyfgAVUdhdcNhwr6qemMP+h6zcTo6OpivMUll+aCc95OHIANCegBpHaNc5ekJKu7NXNw1xxqSCyhj8Vt/m83p9+j/80LERRP5trm+ww56zypJnKjV0A1+n9IG5roAFgRgQ18m+BrDykpLEuuxMkZcSQtYQWn3T1r6XqY1lB41tVfNIUT1gFLW37uZQAdqDtBXRF4cb//1f/ty85P/IQihIcgQ/6iTKIVjA7v/80DEURNqNqBW08peTemiqQZVKagi/dsmRclWZ53gilBuA4G5ANdlNSwWBhhwhFXEWphhlXD+U6Dt81MvLb/6yWl5IZv+fEDlB9h+n/yZQED/5/4OOdRh9SEC1ENCJsTkui2UoBpTS//zQsReE6D6jADWThQuUfRGEmJSsx1NC1elxyvYt/BdPEJp7//p7f////LZtl/92+5nRiIv3vWsrej7ORwpSG/KimsNHCKVPWeR4mNDxMoAOJy2W3yyUTAGqJJhDpWYh3nr2mZI4jPvA//zQMRrFBrOpEzKRFTxrRgEctgjzijbiP0M1INs9Zupzcl6dfn8bP4OEv8YDLCQmFwg9nlTvysr9AudWdIyf+Gw1QBYnbrb9/sBIsDVg+47tAd48lsmXwf6yAXfAVl+Zm4h+80OjPy1//NCxHUTqWrWXmpOHkXUMFsraG85+X1fwbZM5b1qYcj//rKt1e//+inEosyR7/+Hf7Mu6HaFAtMcSktsoEySsCNwEl3aBS7Q9XKR3KlZflHatljh5mGCbeeuyxbzQ8tYs1TcIeraF/0K//NAxIITogbWXlvU5pbQv4RL/9T25/UwtJ93tUpUt9f7NbPpu+l1CgRGlXHY7tsBi5ROmw9QKVordg5tWJJAbk1XCSwJ2W9axQUvuQlFvsdZpj1QWXyhJqAsfYqflREf4XBONwv/8Av/80LEjhNZgrG+w84+I6W2bUW6EKIDL9X2aZgh2Nn8//6/g8ys66VIciRyPysAKRgBVAw7HT2JsMDiEHT1nBqA3r0MSipfyM7t0Dm0t6HBLtMlVMGEMtzkCdjnVad4BotjPjMsO8oLOf7/80DEnBf6arJeyoUKkBv/nMl+JP9Bc0eQtoIE//PbkH0poSBgHHcioOAIDPiICKBhK7uye60Yxkf4ACNwMwzbEpciS7KzYSC6ABtAh+qZgPq8U+Htj32MzeYhGrbemcOPeaovWfJF///zQsSXGTGSbB7mDpRlNn/BO2N3qnUcdUFke8J5t/nI+S+f5z6OzpJJyIW65ySOng+CdYdQBEiTmktv+AHqNj5F0O1LFq080+8NK7f+EUnLk/hc3IuZ4xKcnzcEaN5cBsDLQNBoJSgiJP/zQMSOFnm+fN7b1Fwdc4f1q/qWmxmttzA//+XnFz1VUaahE41+uD5ouJmcjY8AQjYUjIaDYaHYjEUjM/3A7SVtgcBxwhA2MbygrIaR0J1wG5ZQAAqE4AYig8V3Egqcw+LHuwPgDFAe//NCxI8VQVa6X1hoAiMcds2LwCwIhMRmx479yw3QuYYNFIDxAaol/4hCdweFhEIg7FqZZTHt//CgSA8Fh4OBECQbESYjnOdY1GPMQ2v//mFzBuKxeYjHlnGhMfJzOia2X///88cIf9BW//NAxJYlc37iX484AIvq779twc4l0pFWttoWID8e0jTS87/OQDBCY45E5IkHVMzMJqqG1RDLUvZK1d3V2R6qioy+T9NVptS+S+jtedKfZn22rL61P/+u6Vf1z//9R9UE4ZXjnqmQnR//80LEWxRLIwmXySgCUWsqLPo2N7juaC6dEKqQpQbZnLoG+HItDzOQyWNLaqeOJf1zXNdjn/cEaUXu+dBIDPaEomgooNsyz3XB8trDv5ZX+mR5JQmHCr4xrtQV4cMVXTiD1M5KWgo1UK7/80DEZROhTtAGeYasjYtv3MNhLgb0dJ64YS0UgAEp3Ui0jrwimWWexgngIcGzotIvMgY0rK1DRQQs2zv2qiiaXRX8Ih2Apin03G3QIS7OYcDtHDQFSMAwMV8PPd1b9gKjP//4kYqlhf/zQsRxE4EiyCx6BuTlUIFo3x7J/sKaxlurJf7Igg6K6r3/s61mpqjd9W8vU33p7fY3/4py/U7wwVWERGv/boGqdiCDEtkqEDNUynJ00vs/QPF3+6x+nku74X29p/l0xxa3Csu2trUtTP/zQMR/E9La6j5iRHYQFraaDdZujWH5ZfMJZfy1hWkbKd5h/+bTf1BNZIBEXmpOgfTRSMT5B4j2IwtHy6xK3IJEor8QijKiu1BbyNabFSyFgVq6A0CmXX0v41adWtLrsVNyyapzbqn///NCxIoS+srZllhFk6aMVP19J9StlLdH8GyVOu+H+iqAZWdp8eSws6iJZguGBUzaM/sXbKxVNnX9Q97F6Ybb3eY4Lm1MmfNadHWxDGMShwwk9YLp1U5F9Fwo4QCGJKP+ysle6D5wutbt//NAxJoUEoLFlnoEsr+S5ZFCDhfkpzwgQIsknErHZGUBgGjxghRUeBORTOd1+2iysUyhbhU8U5bwZyvp/ZLf71T2+r6dVlZzrVOKCgzLNU+95QikwpI+T53T0cYv21UP/RonaoAIESr/80LEpBQA0qSswxCoWWaa0Na7noCz6aJqmFBPMeNR64YngCLc5vCpvLEw4LEEbSkBTD3nRKITqe+Te2jW3+jHf2y/Luv/p/8tUFBOLk2GlgFois2WVkv8nOWAi5l5qlaNBKhrsjqOJlf/80DEsBPRLpgAwkbsM+U1MUWUCUGrsCHFLuVtUf75VWnfoqL9aoiGSjfN+nro3//sav/Rf+7FI9f9j1Rqo30K5HIHh1AGdPe5+ojCUeeCaIoSsskjdcFEuFKsDFlsD2HaKooGdz/pSf/zQsS7FCo6vl5gyrAVtupJwAaoNDbuvfEputLe2tVzTZkxX6+iyjDKy9/T7/v/T9SMcU/WEwEXJeL1vrSMZyWZLbEsJvtt9brh83kZH+JpLHgDrI/Zgmjtb6CwkBhVj2IkgrGkbUdyYv/zQMTGFCrKrNROBC1B08G8vz59/uCMStVzYjag9QNd/8Yykers/s1zSc5XrO2/2XdwXZCqFtbbrr9h2t7iY5sbJ69M1KqNVuvIqZ5/8YcyBlYqZIOLn7zKrmatTYPu1xN6tY6tXoCL//NCxNATekrSXjpKOscUU7AkwxRm/XnbM3wQXXcqsy+2//6hjVm1EONgZ/KYY/mgdi1VmraqAIKqkdlm0H3beHZmMzQ5FHywjMwa/96qSkAs8qk52/ZUadbXbWAw8DPZu8zVZW9p4kgD//NAxN4TMYrmXkjLLhnRnu1LkqQ0PHKcx3o07QdMVSZEfZKM3kZ8U60WlG7tR42yPit9TO0tRX5vN//U3UQ/I4iqcJgl2+222+Hpjbbb5OeMpWlZQuP4Z5I1sg63+kY7liPjTHGBBWz/80LE7BdKZtJeeIc6Yny3M8VmlzbFYBBjGBNmCXw0IbeiPmDM3KJZU0PVnXdqU2KxFQbpVG/xzO3TwFFfj6VZnZTPr//xh2IOXd6gUPpOomyaHdNdb99h5H0ZuZfUtHqkTYcBTLvr6gj/80DE6hnS7pG+ywqwHDsnTZSRy1KYSAgkY1G2IVMSMw8yXdM7a5sKqM1I04STadXZ5konWntM7lowFZB5ShwXUOsJHGtf5uhJx3EAR/Hdd71D1w5/4j//ydVAgxuSSSW8fcx1jb7cS//zQsTdGjKyyl54y07pco5TNkpudvDzSca8tVcRQmazTMnLANzDrpse1zh4tqpKUjtk0bv4ielymyrKpStoJzHIUTnkWZWurcpZJZKurbUko7m4K/q+QdU4P3b/1O3Hx8//rQhIm5I3Lf/zQMTQGUp6vl56yroTn4jC/lzVbYyHbReZE48edINDOz32JOeRkQ2k/zTT5zqt48VjyfWbv38eR4xq+f5fv37+rGzz4y/f31eHe8fFX9HkTUPdX79wu/f7pT0hv2NRs79Xv7vGtkJq//NCxMUY8tKhvsLEunf5G5/+r/qcXZUJOc8DPagQlCK5FbueKEiZP4TnlvUtHV0G5Ch07IyeU1HN0ogRstIIrX5KQMsDKUewYkrWNfVGRPWtBesnhMfhhYIDDju3aoQCMjTI7GRs1ze2//NAxL0kaza5HniTy4NhWfH8EHJWL88kmrXc0UUw25gbVit9jIg6qxU2hSdafujmtR8sOIWrenepb/XRyhsfcwO3et+OhlB5ajEavijt4ENLfMOxpAurfTnmQw4O2VA4QQR9uUYI5bj/80LEhiRrMqQ0yxCxNBcgiUODInxgAAA1pDOKCp56DDjy6SNxnpWu7aaTTILikplzKw0YMgxtAaddeNv9IpK63HJ6ljQz03t0V2NUuraN/ib/Qz+yb69H/mlonV/p6oft/9n7//Vu2wn/80DEUBYS/qAAykqsVNGMJAJ6r4lVAKqst23/23HRKDtYT2q5cWO4C1DJQkG58FW6KWyqiUe+jTS+CKxqohVVKISoV3JUdKEQxDiZWugCaoq5cSRHRSIlDf8z/5v0X4yS5X2/lSSpb//zQsRSFUo67l5Jys6ElROqAAgclsk3n2HIyijLXay2VXrLmq4c4fyfVom+I45e2sdZ1hsoVrfv5e1j0lJQHGUqnXTu3TbGt/gOZ5WHvtE2xgkt3LlslGf//6flwiE39f/mJYRHk9S2df/zQMRYFgpG0l56yyJVAMktul3v4FiePyHHfWtWu7bO2bg9qZZ2PWzbcf9eE/30jorpdQKx+TqxIGqYbCo/ZjUfB+lBtv+G9GVOr8hqlDPgyN//9ur/MOoLAf2f8jQpAIauRS3UCCDT//NCxFoUMj7VvnoFJgzQkAbJts8ceDjItHZEp10L96qs7ANepuO5BGisqpkLuIxLGkiQl048TKKD85dsY//+37+vX2X8rIv/aFv8UlgzEgBcaI+R9ioAGGOTWT/AAVITIDpdJdso+RR6//NAxGUUSjq5nnqKzjkeyMauxjqPEnGW4qMeX+tt7f0R9Jv4k2l1GcxkKfc5lSM/UK7aPhL/gyixilexSssUmuR4l0f//yfCJPi9AZU2t2/wAGB3Hwi0Q5KWEpYa4/mvptRlnvyJu47/80LEbhQqOspeeEtC5dx6mpJARkouCS8WRC/LpwHHe3UU0RdzIwoOxFti5keFzQODB38spv/yL46kNwJ/Q3RllS+ajjtAlIVdoR94VKxAGkwNJSqo2szQe4BEzxt8frT/vyS/q/n/Cnz/80DEeRQRos2+eg8qVfZryImoVY4ou34v6LPHVVw1PtmTL/Pf792/X8z//0/bMpmN9G6knee+Vc5sLiCLg+qTLd22wpjs4KpEKBGBCAFliCC71PHDs38xk1RpbkGMAVp30p7ad9G/Zf/zQsSDFsK6qF7L1D52VGfsqWiuYqMq3dKH/Z2vBOe0l8bRpGQ3SjCbdZS6MgDAgHFCRy8m1wuf50NjAk1swjn133yCZcn1QxO15IDpY835pwLrZC5riMTwLowuiJBAIQLUI0clGWW0b//zQMSEJLNKoB7B0r2sX2lCOZQhHiSYUJgwRjEJqSNNySQUJcyiggrIJu0hlfHTh+hol+xSTi6iKmeDpfQN10rRPp/fK7Zf2/07qQxVapXK9SoaZDCZClYWjBI1uVOZDTK3+pSoY4Dj//NCxEwY6z7JHnqKN9+VlMoxXKrKZZXFWfDwo414kd10MYwjUgP5dtvvtrhwVSQnYjnkXVbVenQjFUzm6AYZ/TsaGtJh42K8hkXoCedo+ffxuQGykdS+UtU3//nPQWlBuMiJZ77QVLzL//NAxEQT4ZrdvkrOxqr/xJEX7GMqfV2++gKEpNtvfvhYgDEV6/s67ywGxpYdrjOJwJvBLi5WbK8idFA8eePdB2eS6NcS/ypmHg4vzqoTcp/MQ4v//7I2hxxzuQpR////1b//nMIWPi3/80LETxU60s2+eJR2zhVsqe4tAITbt134wDCCnMEOphQYhENgs1WancLMjiWjfWCVdvIe1JXNkK6I/i/UbNQvjmUMZwIE0jbKjGIwYzP45zW53eExc5//pPN+PK0s+///+0i3PArQAdb/80DEVhT5/rm+e06y7Lrt+ABpElpYshkDrLB3a/zFIVDkp5W5bZzcrIH5G1/gqSFS9auywN+tHXrWY2UttxOnXkd0o5aoXKKIIkoPXsImVCjCE6clfX+h+c0lLIX/lOjckJ5RZAt8Uv/zQMRdFzICtb7D1H4B1yzbX/gASALxuCAkY2RrKzq7ie2HWetQjl/DTSu/7KUMiLVw8bc/xFi4jQ6EZ1RwE08X0jXmZ+AzLdhOp/hFtf4u3/UU3F9BNyOTpOMDZO4B1OSS//gAeOHf//NCxFsUQa65vnrLRgQra8/C0d3Keb7GqKJfLaS3Fu+u2X578gEABCt5KVL5fawjkmIl/9XKwuSfJXkYsHmCIPPjBPyTlvVkKtlIqn6CZwgo9ctMquXS3//f/f0CjUCgAGDA6M2dx49V//NAxGYUAZ61v1hQAox4iDsBt5ZRCiDaqnbK2kPKCEBRBTjwZbDBp8coOEfCyYWEUuAvo8EXBqYn4XGanyHB2SZnSDjHjsIQcocp0jp4bpTKh0jCHIDYPkEGk50jGaQQtMTDF9h4dBT/80LEcSWLGs5fmZACdPv///l83c3yv//Wf5xvzBjS5uggZm9jP/////sZn6HucQNFm9UADBBiCDDDDDAuZoFxF8tAMpJJw5VC3NNY5JbKNsVwvjQJpqJ7KUmLHF5ZVJ3UKA87aMsRYvv/80DENiGSHtmVj2AAONvnlV9b67S8r18qJ9ylD+j21fpl836O99H7/M+s7LxX6Z2Zys2vu07qUu/7b/07/nJ6lOh48oRFEE11BAEHwfB82OXjGgallmfLn/+Wf/oVkcTYdQCGgFEFW//zQsQKFKFC1AHMGADMRrSN7WtIl2Sz0uEoSJq0QEFErJGzfDNlAfPobc47flrwqnzgIBnSwHYjc4JIiy5xT5V1gxygZCo8oVtM8YGCL38V9brFncGVQ5rqqknRwYqKDi+bgdNEAo0s/P/zQMQTE2i67ZYzBladIHdeZFB2axtN0qgpcTBzWMQwGAaAGVWCM0kDrUkVmblmSVBIBUc6u6mlf1DkHmEdRXziXQ1KfRvqQgIAlRxrOyO0XBQWNCrGzQakcF2nLw9Bn4KoooMvC08t//NCxCAUGI7NlErYIAWLioiMmgaYBQE+aqMLXJBQOikUWfJuWT+9ikLtJmo2ugx1Cui90o/Xrd5qJqCh4nV9fJKD4fW0dqG5Jnc7cFXZyBLNsu5LIdj6u+385ANuDt505DOvGc/7ylSM//NAxCsT0TLENnsGVLI15gwAKlg0GhVbKCz7lRGVIus9T/Az5AgSOQao0+t3/nnriFWAABmabeG6fHy8AwDj8DC0JfERlVI6TMoOhT3gdTM93CbVFA4WSPeGxEGTTJ0VGnaYqoVO2PD/80LENhSYjrmWYlZokEHljuh2fcwlfKkn+gJRC7I1CwFyKn65ap5z8mrCRfqrbjFnU/ZKSwJh6xO2O+z+IGet95xptRrHooLwqJ5+1QTIw2YVbx+lEqdoFfI/PrzDsTs5mz/uufbzZs3/80DEPxMDEsmWSEUz//r+Y3///92yHxbj8sFTfjckt41ja3H4tHocr+VlM1lDMD3H5vk4VnBOXoHBZY1qdgWSSwens/MpDWLGNq9rs+i5a/Syu0rF7/ojaS3VS//VPUvmC+oYBIk9Tv/zQsROFFJmtZ5gxPDyL+Xq0Au+NtyuDaMkUMxJjLG145yypNvs4KG0tQeXCG21Kgkijs4eapyMMmpl6smXRJ7auzIj3cuvp/90e7PKfqKd0Yzqnv9E/qHwMVQe+xnyPhqJJKOySSSWUP/zQMRYFAKSxZ5AywrUS55Nek6Kwv861nrzX/A8cOnrvONjds8ZuZKT739b+zisCVH86L7y5Wf5SU16zISn/X4/mMVeR99bjIx/XL5SW1//iZ1wBBlaUWPd9C0OSBk8RMIT8pH4XH+r//NCxGMTw0bWXjBHeuQtn9jngxLc5Yp4KykfptzR9Fdgr///kNkS17f596JlPq3//v+rLCLRzGaarGNYx2RaOzrOhlqZvyzEHipOJVYBmHHjFOYB1choFDbppFrXbAuphvkOa19UsiOr//NAxHAUM0KgVEhFDfNmaTImYEBNtsm6oa51RNzrrsxKKdbN9/60/srIuv/3b9P3rtXvT/c3q9Oz5G0OJjEejngQMqc/D2qULeiVaxJbEk15lb9uGrHY5BHDQko2Z9BCpL2niZZhFOb/80LEehOzOph0CwQcJlet3Ey8LxG0f3kQZHq38rPKq//9Pt/a9trZHpMK5Vy7yVUh9R2WS3bASLB5JNbrHUshw+9Gbo5etie2D0w9Zf7MErGVOaxQbmdBo1k2HJsbcaxq5QX3NTAyTiX/80DEhxNK3ohMeET85QUNMM7XhWoRZUwirQ488XRRHA7O99oiDAEjkcl1lsGKzw6Lo1d3fEyjzIlLzEwcbWZqesAhWYYoQ2xE7qmCMOvWz67G9UaHDehqgRj5upHFDHRxGVUemDJcIP/zQsSUFEDinb4LBhhJZkEJY/vdtunhYNSbXHXWihuaJPBUqfrneQUB22JuVV24eZzmhOeYJAIBALSKgCRNgLH0MVT41AdjZmqkzGzHsdVYxqJVSaMzMzf0Kv/sa+x/w/1/qw1h3Vfqif/zQMSfF2Fakl4LBhghmS1A0/2RF/KuK1nSroNZH5UZ0olG4AqkyEhcVMgIWFWGfYK6H+LCuoXZu//ULs/1X///29f9Quz9Yo00sVVMQU1FMy4xMDBVVVVVVVVVVVVVVVVVVVVVVVVV//NCxJwUwdaBvjJGwFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//NAxKULIAH0XghGAlVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",dt=function(){function e(){var t=this;s(this,e),this.context=void 0,this.instant=0,this.slow=0,this.clip=0,this.type="",this.script={},this.mic=void 0,window.AudioContext=window.AudioContext||window.webkitAudioContext,this.context=new AudioContext,this.script=this.context.createScriptProcessor(4096,1,1),this.script.onaudioprocess=function(e){var r,n=e.inputBuffer.getChannelData(0),i=0,o=0;for(r=0;r<n.length;++r)i+=n[r]*n[r],Math.abs(n[r])>.99&&(o+=1);t.instant=Math.sqrt(i/n.length),t.slow=.95*t.slow+.05*t.instant,t.clip=o/n.length}}return c(e,[{key:"connectToStreamSource",value:function(e,t){console.log("SoundMeter connecting");try{this.type="Stream",this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),"undefined"!==typeof t&&t(null)}catch(r){console.error(r),"undefined"!==typeof t&&t(r)}}},{key:"connectToElementSource",value:function(e,t){console.log("SoundMeter connecting");try{this.type="Element",this.mic||(this.mic=this.context.createMediaElementSource(e)),this.mic.connect(this.script),this.script.connect(this.context.destination),"undefined"!==typeof t&&t(null)}catch(r){console.error(r),"undefined"!==typeof t&&t(r)}}},{key:"stop",value:function(){var e,t,r,n;(console.log("SoundMeter stopping"),"Element"===this.type)?(null===(e=this.mic)||void 0===e||e.disconnect(this.script),null===(t=this.script)||void 0===t||t.disconnect(this.context.destination)):(null===(r=this.mic)||void 0===r||r.disconnect(),null===(n=this.script)||void 0===n||n.disconnect());this.instant=0,this.slow=0,this.clip=0}}]),e}(),ht=function(t){l(i,t);var r=f(i);function i(){var t;s(this,i);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).state={visible:!0,selectTab:"AUDIO",selectMic:void 0,selectSpeaker:void 0,selectCamera:void 0,micDevices:[],speakerDevices:[],cameraDevices:[],localVideoStream:void 0,localAudioStream:void 0,selectVideoResolution:"360p",audioVolume:0,speakerVolume:0,isSpeakerPlaying:!1,renderAudio:!1,showNonVideo:t.props.initDevices.showNonVideoUser},t.videoRef=e.createRef(),t.speakerTimer=null,t.micTimer=null,t.micSounder=new dt,t.speakerSounder=new dt,t.solutionList=t.sortResolution(t.props.core._config.videoResolutionList),t}return c(i,[{key:"componentDidMount",value:function(){var e=o(n().mark((function e(){var t,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDevices();case 2:t=e.sent,this.setState(C({},t),(function(){r.createVideoStream(),r.createAudioStream()})),document.querySelector("#speakerAudioTest").addEventListener("ended",this.onTestMusicEnded.bind(this));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.state.isSpeakerPlaying&&(this.speakerTimer&&clearTimeout(this.speakerTimer),this.speakerSounder.stop()),this.state.localAudioStream&&(this.state.localAudioStream.getAudioTracks().forEach((function(e){e.stop()})),this.micTimer&&clearTimeout(this.micTimer),this.micSounder.stop()),this.state.localVideoStream&&this.props.core.destroyStream(this.state.localVideoStream);var e=document.querySelector("#speakerAudioTest");null===e||void 0===e||e.removeEventListener("ended",this.onTestMusicEnded.bind(this))}},{key:"getDevices",value:function(){var e=o(n().mark((function e(){var t,r,i,o,s,a,c,u,l,d,h,p,f=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.core.getMicrophones();case 2:return c=e.sent,e.next=5,this.props.core.getSpeakers();case 5:return u=e.sent,e.next=8,this.props.core.getCameras();case 8:return l=e.sent,u.length||(/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)||/Firefox/.test(navigator.userAgent))&&u.push({deviceID:"default",deviceName:"Default speaker"}),d=c.filter((function(e){return e.deviceID===f.props.initDevices.mic})),h=l.filter((function(e){return e.deviceID===f.props.initDevices.cam})),p=u.filter((function(e){return e.deviceID===f.props.initDevices.speaker})),e.abrupt("return",{micDevices:c.filter((function(e){return e.deviceID})),speakerDevices:u.filter((function(e){return e.deviceID})),cameraDevices:l.filter((function(e){return e.deviceID})),selectMic:(null===(t=d[0])||void 0===t?void 0:t.deviceID)||(null===(r=c[0])||void 0===r?void 0:r.deviceID)||void 0,selectSpeaker:(null===(i=p[0])||void 0===i?void 0:i.deviceID)||(null===(o=u[0])||void 0===o?void 0:o.deviceID)||void 0,selectCamera:(null===(s=h[0])||void 0===s?void 0:s.deviceID)||(null===(a=l[0])||void 0===a?void 0:a.deviceID)||void 0,selectVideoResolution:this.props.initDevices.videoResolve||void 0});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createVideoStream",value:function(){var e=o(n().mark((function e(){var t,r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=F(this.state.selectVideoResolution),r={camera:C({video:!0,audio:!1,videoInput:this.state.selectCamera,videoQuality:4},t)},e.next=5,this.props.core.createStream(r);case 5:return i=e.sent,this.setState({localVideoStream:i}),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(0),console.error("\u3010ZEGOCLOUD\u3011settings/localVideoStream failed !!",JSON.stringify(e.t0)),this.props.core._config.turnOnCameraWhenJoining=!1,e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"createAudioStream",value:function(){var e=o(n().mark((function e(){var t,r,i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={camera:{video:!1,audio:!0,audioInput:this.state.selectMic}},e.next=4,this.props.core.createStream(t);case 4:return r=e.sent,this.setState({localAudioStream:r},(function(){i.captureMicVolume()})),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(0),console.error("\u3010ZEGOCLOUD\u3011settings/localAudioStream failed !!",JSON.stringify(e.t0)),this.props.core._config.turnOnMicrophoneWhenJoining=!1,e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"toggleTab",value:function(e){e!==this.state.selectTab&&("AUDIO"===e?this.captureMicVolume():(this.state.localAudioStream&&(this.micSounder.stop(),this.micTimer&&clearTimeout(this.micTimer),this.setState({audioVolume:0})),this.state.isSpeakerPlaying&&(this.speakerTimer&&clearTimeout(this.speakerTimer),this.speakerSounder.stop(),this.setState({isSpeakerPlaying:!1,speakerVolume:0}))),this.setState({selectTab:e}))}},{key:"toggleMic",value:function(){var e=o(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.localAudioStream){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.core.useMicrophoneDevice(this.state.localAudioStream,t);case 4:r=e.sent,this.micSounder.stop(),this.micTimer&&clearTimeout(this.micTimer),this.captureMicVolume(),0===r.errorCode&&(this.setState({selectMic:t}),this.props.onMicChange(t));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleSpeaker",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({selectSpeaker:t}),this.props.onSpeakerChange(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleCamera",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.localVideoStream){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.core.useCameraDevice(this.state.localVideoStream,t);case 4:0===e.sent.errorCode&&(this.setState({selectCamera:t}),this.props.onCameraChange(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleVideoResolution",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.createVideoStream(),this.setState({selectVideoResolution:t}),this.props.onVideoResolutionChange(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleSpeakerTest",value:function(){var e=this;this.state.speakerDevices.length&&(this.speakerTimer&&clearTimeout(this.speakerTimer),this.setState({isSpeakerPlaying:!this.state.isSpeakerPlaying},o(n().mark((function t(){var r,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=document.querySelector("#speakerAudioTest"),i=document.querySelector("#speakerAudio"),!r.paused){t.next=12;break}if(t.t0=null===i||void 0===i?void 0:i.setSinkId,!t.t0){t.next=7;break}return t.next=7,null===i||void 0===i?void 0:i.setSinkId(e.state.selectSpeaker||"");case 7:i.play(),r.play(),e.speakerSounder.connectToElementSource(r,(function(t){t&&console.error("[zegocloud] captureSpeakerVolume!!!",JSON.stringify(t)),e.speakerTimer=setInterval((function(){e.setState({speakerVolume:100*e.speakerSounder.instant})}))})),t.next=17;break;case 12:r.pause(),r.currentTime=0,i.pause(),i.currentTime=0,e.setState({speakerVolume:0});case 17:case"end":return t.stop()}}),t)})))))}},{key:"close",value:function(){sessionStorage.setItem("selectMic",this.state.selectMic||""),sessionStorage.setItem("selectCamera",this.state.selectCamera||""),sessionStorage.setItem("selectSpeaker",this.state.selectSpeaker||""),sessionStorage.setItem("selectVideoResolution",this.state.selectVideoResolution||""),this.setState({visible:!1}),this.props.closeCallBack&&this.props.closeCallBack()}},{key:"captureMicVolume",value:function(){var e=this;this.state.localAudioStream&&this.micSounder.connectToStreamSource(this.state.localAudioStream,(function(t){t&&console.error("[zegocloud] captureMicVolume!!!",JSON.stringify(t)),e.micTimer=setInterval((function(){e.setState({audioVolume:1e3*e.micSounder.instant/5})}))}))}},{key:"onTestMusicEnded",value:function(){var e=document.querySelector("#speakerAudio");e.pause(),e.currentTime=0,this.speakerSounder.stop(),this.speakerTimer&&(clearTimeout(this.speakerTimer),this.speakerTimer=null),this.setState({isSpeakerPlaying:!1,speakerVolume:0})}},{key:"handleShowNonVideo",value:function(){var e;null===(e=this.props)||void 0===e||e.onShowNonVideoChange(!this.state.showNonVideo),this.setState({showNonVideo:!this.state.showNonVideo})}},{key:"sortResolution",value:function(e){return e.sort((function(e,t){return Number(e.replace("p",""))-Number(t.replace("p",""))})).map((function(e){return{name:e,value:e}}))}},{key:"render",value:function(){var e,t,r=this;return(0,ct.jsx)("div",{className:"".concat(this.state.visible?Ue:xe," ").concat("black"===this.props.theme?Ce:Te," settings_audio"),children:(0,ct.jsxs)("div",{className:Be,children:[(0,ct.jsxs)("div",{className:je,children:[(0,ct.jsx)("div",{children:"Settings"}),(0,ct.jsx)("div",{onClick:function(){r.close()},className:Oe})]}),(0,ct.jsxs)("div",{className:He,children:[(0,ct.jsxs)("div",{className:Le,children:[(0,ct.jsx)("div",{className:"".concat(ke," ").concat("AUDIO"===this.state.selectTab&&we),onClick:function(){r.toggleTab("AUDIO")},children:"Audio"}),(0,ct.jsx)("div",{className:"".concat(Ie," ").concat("VIDEO"===this.state.selectTab&&we),onClick:function(){r.toggleTab("VIDEO")},children:"Video"})]}),(0,ct.jsxs)("div",{className:"".concat(Re," "),children:["AUDIO"===this.state.selectTab&&(0,ct.jsxs)("div",{className:Ye,children:[(0,ct.jsxs)("div",{className:Ge,children:[(0,ct.jsx)(ut,{label:"Microphone",options:this.state.micDevices.map((function(e){return{name:e.deviceName,value:e.deviceID}})),onChange:function(e){r.toggleMic(e)},initValue:this.state.selectMic,placeholder:"No microphone detected",theme:this.props.theme}),(0,ct.jsxs)("div",{className:Ae,children:[(0,ct.jsx)("span",{className:"".concat(Ne," ").concat(this.state.localAudioStream?Pe:"")}),Array(20).fill(1).map((function(e,t){return(0,ct.jsx)("span",{className:"".concat(r.state.audioVolume>=t+1?qe:""," ").concat(ze)},t)}))]})]}),(0,ct.jsxs)("div",{className:Ge,children:[(0,ct.jsx)(ut,{label:"Speakers",options:this.state.speakerDevices.map((function(e){return{name:e.deviceName,value:e.deviceID}})),onChange:function(e){r.toggleSpeaker(e)},initValue:this.state.selectSpeaker,placeholder:"No speaker detected",theme:this.props.theme}),(0,ct.jsxs)("div",{className:Ae,children:[(0,ct.jsx)("span",{className:"".concat(Me," ").concat(this.state.isSpeakerPlaying?De:"")}),Array(16).fill(1).map((function(e,t){return(0,ct.jsx)("span",{className:"".concat(r.state.speakerVolume>=t+1?qe:""," ").concat(ze)},t)})),(0,ct.jsx)("div",{className:Ve,onClick:function(){r.toggleSpeakerTest()},children:this.state.isSpeakerPlaying?"Stop":"Test"})]})]})]}),"VIDEO"===this.state.selectTab&&(0,ct.jsxs)("div",{className:Qe,children:[(0,ct.jsx)("div",{className:Ge,children:(0,ct.jsx)(ut,{label:"Camera",options:this.state.cameraDevices.map((function(e){return{name:e.deviceName,value:e.deviceID}})),onChange:function(e){r.toggleCamera(e)},initValue:this.state.selectCamera,placeholder:"No camera detected",theme:this.props.theme})}),(0,ct.jsxs)("div",{className:Ge,children:[(0,ct.jsx)("label",{children:"Preview"}),(0,ct.jsx)("video",{muted:!0,autoPlay:!0,className:Ke,ref:function(e){e&&r.state.localVideoStream&&e.srcObject!==r.state.localVideoStream&&(e.srcObject=r.state.localVideoStream)}})]}),(0,ct.jsx)("div",{className:Ge,children:(0,ct.jsx)(ut,{label:"Send resolution",options:this.solutionList,onChange:function(e){r.toggleVideoResolution(e)},initValue:this.state.selectVideoResolution,placeholder:"",theme:this.props.theme})}),(null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)!==m.LiveStreaming&&(null===(t=this.props.core._config.scenario)||void 0===t?void 0:t.mode)!==m.OneONoneCall&&(0,ct.jsx)("div",{className:Ge,children:(0,ct.jsxs)("div",{className:Fe,onClick:function(){return r.handleShowNonVideo()},children:[(0,ct.jsx)("span",{className:"".concat(Ze," ").concat(this.state.showNonVideo&&We)}),(0,ct.jsx)("p",{children:"Show non-video participant"})]})})]})]})]}),(0,ct.jsx)("audio",{style:{width:"1px",height:"1px"},id:"speakerAudioTest",src:lt}),(0,ct.jsx)("audio",{style:{width:"1px",height:"1px"},id:"speakerAudio",src:lt})]})})}}]),i}(e.Component),pt="zegoModel_ZegoBrowserCheckNotSupport__mP9Pj",ft="zegoModel_content__TaXHc",gt="zegoModel_tipsHeader__Qy0YW",mt="zegoModel_tipsText__TTuQ7",_t="zegoModel_buttonWrapper__NZPG5",vt="zegoModel_okButton__VnzTo",yt="zegoModel_cancelButton__qhqAM",Et=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){var e=this.props,t=e.header,r=e.contentText,n=e.okText,i=e.cancelText,o=e.onOk,s=e.onCancel;return(0,ct.jsx)("div",{className:pt,children:(0,ct.jsxs)("div",{className:ft,children:[(0,ct.jsx)("p",{className:gt,children:t}),(0,ct.jsx)("p",{className:mt,children:r}),(0,ct.jsxs)("div",{className:_t,children:[i&&(0,ct.jsx)("button",{className:yt,onClick:function(){s&&s()},children:i}),n&&(0,ct.jsx)("button",{className:vt,onClick:function(){o&&o(),s&&s(!1)},children:n})]})]})})}}]),r}(e.Component),St=function(e,r){var n=document.createElement("div");(r||document.body).appendChild(n);var i=t.createRoot(n);i.render((0,ct.jsx)(Et,C(C({},e),{},{onCancel:function(t){i.unmount(),!t&&e.onCancel&&e.onCancel()}})))},bt=function(t){l(i,t);var r=f(i);function i(t){var n,o;return s(this,i),(o=r.call(this,t)).state={localStream:void 0,localVideoStream:void 0,localAudioStream:void 0,userName:"xxx",videoOpen:!0,audioOpen:!0,isVideoOpening:!0,isCopied:!1,isJoinRoomFailed:!1,joinRoomErrorTip:"Failed to join the room.",showDeviceAuthorAlert:!1,selectMic:void 0,selectSpeaker:void 0,selectCamera:void 0,selectVideoResolution:o.props.core._config.videoResolutionList[0],isJoining:!1,showNonVideo:o.props.core._config.showNonVideoUser,sharedLinks:null===(n=o.props.core._config.sharedLinks)||void 0===n?void 0:n.map((function(e){return{name:e.name,url:e.url,copied:!1}})),showZegoSettings:!1,isSmallSize:!1},o.videoRef=void 0,o.inviteRef=void 0,o.audioRefuse=o.props.core.status.audioRefuse,o.videoRefuse=o.props.core.status.videoRefuse,o.throttleResize=Z(o.onResize.bind(h(o)),300),o.videoRef=e.createRef(),o.inviteRef=e.createRef(),o}return c(i,[{key:"componentDidMount",value:function(){var e=o(n().mark((function e(){var t,r,i,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.onResize(),window.addEventListener("resize",this.throttleResize.bind(this),!1),this.setState({userName:this.props.core._expressConfig.userName}),t=!!this.props.core._config.turnOnCameraWhenJoining,r=!!this.props.core._config.turnOnMicrophoneWhenJoining,!t&&!r){e.next=12;break}return e.next=8,this.getDevices();case 8:i=e.sent,this.setState(C({},i),o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t&&!r){e.next=5;break}return e.next=3,s.createStream(t,r);case 3:e.next=6;break;case 5:s.setState({audioOpen:r,videoOpen:t});case 6:case"end":return e.stop()}}),e)})))),e.next=13;break;case 12:this.setState({audioOpen:r,videoOpen:t,isVideoOpening:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.throttleResize.bind(this),!1),this.state.localVideoStream&&this.props.core.destroyStream(this.state.localVideoStream),this.state.localAudioStream&&this.props.core.destroyStream(this.state.localAudioStream)}},{key:"onResize",value:function(){this.props.core._config.container.offsetWidth<960||this.props.core._config.container.offsetHeight<=530?this.setState({isSmallSize:!0}):this.setState({isSmallSize:!1})}},{key:"getDevices",value:function(){var e=o(n().mark((function e(){var t,r,i,o,s,a,c,u,l,d,h,p;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.core.getMicrophones();case 2:return c=e.sent,e.next=5,this.props.core.getSpeakers();case 5:return u=e.sent,e.next=8,this.props.core.getCameras();case 8:return l=e.sent,u.length||(/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)||/Firefox/.test(navigator.userAgent))&&u.push({deviceID:"default",deviceName:"efault speaker"}),d=c.filter((function(e){return e.deviceID===sessionStorage.getItem("selectMic")})),h=l.filter((function(e){return e.deviceID===sessionStorage.getItem("selectCamera")})),p=u.filter((function(e){return e.deviceID===sessionStorage.getItem("selectSpeaker")})),e.abrupt("return",{selectMic:(null===(t=d[0])||void 0===t?void 0:t.deviceID)||(null===(r=c[0])||void 0===r?void 0:r.deviceID)||void 0,selectSpeaker:(null===(i=p[0])||void 0===i?void 0:i.deviceID)||(null===(o=u[0])||void 0===o?void 0:o.deviceID)||void 0,selectCamera:(null===(s=h[0])||void 0===s?void 0:s.deviceID)||(null===(a=l[0])||void 0===a?void 0:a.deviceID)||void 0,selectVideoResolution:sessionStorage.getItem("selectVideoResolution")||this.props.core._config.videoResolutionList[0]});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createStream",value:function(){var e=o(n().mark((function e(t,r){var i,o,s,a,c,u,l=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=new MediaStream,e.prev=1,!t){e.next=10;break}return this.setState({isVideoOpening:!0}),c=F(this.state.selectVideoResolution),e.next=7,this.props.core.createStream({camera:C({video:!0,audio:!1,videoInput:this.state.selectCamera,videoQuality:4},c)});case 7:i=e.sent,null===(a=i)||void 0===a||a.getVideoTracks().map((function(e){s.addTrack(e)})),this.setState({localVideoStream:i});case 10:e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),this.videoRefuse=!0,this.setState({isVideoOpening:!1}),console.error("\u3010ZEGOCLOUD\u3011toggleStream/createStream failed !!",JSON.stringify(e.t0));case 17:if(e.prev=17,!r){e.next=24;break}return e.next=21,this.props.core.createStream({camera:{video:!1,audio:!0,audioInput:this.state.selectMic}});case 21:o=e.sent,null===(u=o)||void 0===u||u.getAudioTracks().map((function(e){s.addTrack(e)})),this.setState({localAudioStream:o});case 24:e.next=30;break;case 26:e.prev=26,e.t1=e.catch(17),this.audioRefuse=!0,console.error("\u3010ZEGOCLOUD\u3011toggleStream/createStream failed !!",JSON.stringify(e.t1));case 30:return this.setState({localStream:s,audioOpen:r&&!this.audioRefuse,videoOpen:t&&!this.videoRefuse,isVideoOpening:!1},(function(){l.videoRef.current&&s&&(l.videoRef.current.srcObject=s)})),e.abrupt("return",s);case 32:case"end":return e.stop()}}),e,this,[[1,12],[17,26]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"toggleStream",value:function(){var e=o(n().mark((function e(t){var r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("video"!==t){e.next=16;break}if(!this.videoRefuse){e.next=4;break}return St({header:"Equipment authorization",contentText:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",okText:"Okay"},document.querySelector(".".concat(J))),e.abrupt("return");case 4:if(r=!this.state.videoOpen,this.state.localVideoStream){e.next=10;break}return e.next=8,this.createStream(r,this.state.audioOpen);case 8:e.next=13;break;case 10:this.props.core.destroyStream(this.state.localVideoStream),this.setState({localVideoStream:void 0}),/Firefox/.test(navigator.userAgent)&&this.videoRef.current&&this.state.localStream&&(this.videoRef.current.srcObject=this.videoRef.current.srcObject);case 13:this.setState({videoOpen:r}),e.next=28;break;case 16:if("audio"!==t){e.next=28;break}if(!this.audioRefuse){e.next=20;break}return St({header:"Equipment authorization",contentText:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",okText:"Okay"},document.querySelector(".".concat(J))),e.abrupt("return");case 20:if(i=!this.state.audioOpen,this.state.localAudioStream){e.next=26;break}return e.next=24,this.createStream(this.state.videoOpen,i);case 24:e.next=27;break;case 26:this.props.core.muteMicrophone(this.state.audioOpen);case 27:this.setState({audioOpen:i});case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"joinRoom",value:function(){var e=o(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.userName.length){e.next=2;break}return e.abrupt("return");case 2:if(!this.state.isJoining){e.next=4;break}return e.abrupt("return");case 4:this.setState({isJoining:!0},o(n().mark((function e(){var r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.props.core._expressConfig.userName=t.state.userName,t.props.core._config.turnOnMicrophoneWhenJoining=t.state.audioOpen&&!t.audioRefuse,t.props.core._config.turnOnCameraWhenJoining=t.state.videoOpen&&!t.videoRefuse,t.props.core.status.audioRefuse=t.audioRefuse,t.props.core.status.videoRefuse=t.videoRefuse,t.props.core.status.micDeviceID=t.state.selectMic,t.props.core.status.cameraDeviceID=t.state.selectCamera,t.props.core.status.speakerDeviceID=t.state.selectSpeaker,t.props.core.status.videoResolution=t.state.selectVideoResolution,t.props.core._config.showNonVideoUser=t.state.showNonVideo,e.next=12,t.props.core.enterRoom();case 12:r=e.sent,i="",0===r?(t.state.localAudioStream&&t.props.core.destroyStream(t.state.localAudioStream),t.state.localVideoStream&&t.props.core.destroyStream(t.state.localVideoStream),t.props.joinRoom&&t.props.joinRoom()):i=1002034===r?"Failed to join the room, the number of people in the room has reached the maximum.(2 people)":[1002031,1002053].includes(r)?"There's something wrong with your network. Please check it and try again.":[1102018,1102016,1102020].includes(r)?"Failed to join the room, token authentication error.":1002056===r?"You are on a call in another room, please leave that room first.":"Failed to join the room, please try again.(error code:"+r+")",t.setState({isJoinRoomFailed:!!i,joinRoomErrorTip:i,isJoining:!1});case 16:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){this.setState({userName:e.target.value.trim().substring(0,255)})}},{key:"openSettings",value:function(){this.setState({showZegoSettings:!0})}},{key:"render",value:function(){var e,t,r,n,i,o=this;return(0,ct.jsxs)("div",{className:"".concat(J," ").concat(this.state.isSmallSize?be:""),children:[(0,ct.jsxs)("div",{className:X,children:[(0,ct.jsxs)("div",{className:$,children:[(0,ct.jsx)("video",{className:ee,autoPlay:!0,muted:!0,ref:this.videoRef}),!this.props.core._config.showMyCameraToggleButton&&!this.props.core._config.turnOnCameraWhenJoining&&(0,ct.jsx)("div",{className:re,children:this.state.userName.substring(0,1)||this.props.core._expressConfig.userName.substring(0,1)||"Z"}),(this.props.core._config.showMyCameraToggleButton||this.props.core._config.turnOnCameraWhenJoining)&&!this.state.videoOpen&&!this.state.isVideoOpening&&(0,ct.jsx)("div",{className:te,children:"Camera is off"}),this.state.isVideoOpening&&(0,ct.jsx)("div",{className:te,children:"Camera is starting\u2026"}),(0,ct.jsxs)("div",{className:ne,children:[this.props.core._config.showMyMicrophoneToggleButton&&(0,ct.jsx)("div",{className:"".concat(oe," ").concat(!this.state.audioOpen&&se),onClick:function(){o.toggleStream("audio")},children:(0,ct.jsx)("span",{className:ie,children:this.state.audioOpen?"Turn off microphone":"Turn on microphone"})}),this.props.core._config.showMyCameraToggleButton&&(0,ct.jsx)("div",{className:"".concat(ae," ").concat(!this.state.videoOpen&&se),onClick:function(){o.toggleStream("video")},children:(0,ct.jsx)("span",{className:ie,children:this.state.videoOpen?"Turn off camera":"Turn on camera"})}),this.props.core._config.showAudioVideoSettingsButton&&(0,ct.jsx)("div",{className:ce,onClick:function(){o.openSettings()},children:(0,ct.jsx)("span",{className:ie,children:"Settings"})})]})]}),(0,ct.jsxs)("div",{className:ue,children:[(0,ct.jsxs)("div",{className:de,children:[(0,ct.jsx)("div",{className:le,children:null===(e=this.props.core._config.preJoinViewConfig)||void 0===e?void 0:e.title}),(0,ct.jsx)("input",{className:he,placeholder:"Your Name",value:this.state.userName,onChange:function(e){o.handleChange(e)}}),(0,ct.jsxs)("div",{className:pe,children:[(0,ct.jsxs)("button",{className:fe,disabled:!this.state.userName.length,onClick:function(){o.joinRoom()},children:[this.state.isJoining&&(0,ct.jsx)("span",{className:ge}),"Join"]}),this.state.isJoinRoomFailed&&(0,ct.jsx)("div",{className:me,children:this.state.joinRoomErrorTip})]})]}),(null===(t=this.state)||void 0===t?void 0:t.sharedLinks)&&(null===(r=this.state)||void 0===r||null===(n=r.sharedLinks)||void 0===n?void 0:n.length)>0&&(0,ct.jsxs)("div",{className:_e,children:[(0,ct.jsx)("div",{className:le,children:"Share the link"}),null===(i=this.state.sharedLinks)||void 0===i?void 0:i.map((function(e){return(0,ct.jsxs)("div",{className:ve,children:[(0,ct.jsxs)("div",{className:ye,children:[(0,ct.jsx)("h3",{children:e.name}),(0,ct.jsx)("input",{className:Ee,placeholder:"inviteLink",readOnly:!0,value:e.url})]}),(0,ct.jsx)("button",{className:Se,disabled:e.copied,onClick:function(){e&&e.url&&I(e.url),o.setState((function(t){return{sharedLinks:t.sharedLinks.map((function(t){return t.name===e.name&&(t.copied=!0),t}))}})),setTimeout((function(){o.setState((function(t){return{sharedLinks:t.sharedLinks.map((function(t){return t.name===e.name&&(t.copied=!1),t}))}}))}),5e3)}})]},e.name)}))]})]})]}),this.state.showDeviceAuthorAlert&&(0,ct.jsx)(Et,{header:"Equipment authorization",contentText:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",okText:"Okay",onOk:function(){o.setState({showDeviceAuthorAlert:!1})}}),this.state.showZegoSettings&&(0,ct.jsx)(ht,{core:this.props.core,initDevices:{mic:this.state.selectMic,cam:this.state.selectCamera,speaker:this.state.selectSpeaker,videoResolve:this.state.selectVideoResolution,showNonVideoUser:this.state.showNonVideo},closeCallBack:function(){o.setState({showZegoSettings:!1})},onMicChange:function(e){o.setState({selectMic:e},(function(){o.createStream(o.state.videoOpen,o.state.audioOpen)}))},onCameraChange:function(e){o.setState({selectCamera:e},(function(){o.createStream(o.state.videoOpen,o.state.audioOpen)}))},onSpeakerChange:function(e){o.setState({selectSpeaker:e})},onVideoResolutionChange:function(e){o.setState({selectVideoResolution:e},(function(){o.createStream(o.state.videoOpen,o.state.audioOpen)}))},onShowNonVideoChange:function(e){o.setState({showNonVideoUser:e})}})]})}}]),i}(e.Component),Tt="ZegoBrowserCheckMobile_ZegoBrowserCheckSupport__soE24",Ct="ZegoBrowserCheckMobile_videoScree__hoQ0N",Rt="ZegoBrowserCheckMobile_video__pB1iu",Ot="ZegoBrowserCheckMobile_hideVideo__1dOOj",kt="ZegoBrowserCheckMobile_videoTip__5JOT-",It="ZegoBrowserCheckMobile_noCamera__UxlxJ",Lt="ZegoBrowserCheckMobile_handler__M4Ye-",wt="ZegoBrowserCheckMobile_micOpen__OAbJf",At="ZegoBrowserCheckMobile_micClose__hp19c",Nt="ZegoBrowserCheckMobile_cameraOpen__8QvUV",Pt="ZegoBrowserCheckMobile_cameraClose__J1cGc",Mt="ZegoBrowserCheckMobile_joinScreen__pahlk",Dt="ZegoBrowserCheckMobile_joinRoom__veDLB",Ut="ZegoBrowserCheckMobile_focus__hJoBf",xt="ZegoBrowserCheckMobile_active__C0P1n",Bt="ZegoBrowserCheckMobile_inviteLink__Pgdq8",jt="ZegoBrowserCheckMobile_inviteLinkWrapperLeft__DaemB",Ht="ZegoBrowserCheckMobile_copied__0FRwg",Gt="zegoToast_ZegoToast__0ps1P",zt="zegoToast_content__0MB-Z",qt="zegoToast_show__MEIJH",Vt=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){return(0,ct.jsx)("div",{className:"".concat(Gt," ").concat(qt),children:(0,ct.jsx)("div",{className:zt,children:this.props.content})})}}]),r}(e.Component),Ft=function(){var e,r,n=document.createElement("div");return document.body.appendChild(n),function(i){r&&clearTimeout(r),r=setTimeout((function(){var t;i&&i.closeCallBack&&i.closeCallBack(),null===(t=e)||void 0===t||t.unmount(),e=null}),(null===i||void 0===i?void 0:i.duration)||3e3),e&&(e.unmount(),i&&i.closeCallBack&&i.closeCallBack()),(e=t.createRoot(n)).render((0,ct.jsx)(Vt,{closeCallBack:function(){},content:(null===i||void 0===i?void 0:i.content)||"",duration:(null===i||void 0===i?void 0:i.duration)||3}))}}(),Zt="zegoConfirm_ZegoConfirm__b1eY8",Wt="zegoConfirm_content__Mq2KD",Yt="zegoConfirm_tipsHeader__oCjFA",Qt="zegoConfirm_tipsText__mP4ap",Kt="zegoConfirm_handler__K6vHc",Jt=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){var e=this;return(0,ct.jsx)("div",{className:Zt,children:(0,ct.jsxs)("div",{className:Wt,children:[(0,ct.jsx)("p",{className:Yt,children:this.props.title}),(0,ct.jsx)("p",{className:Qt,children:this.props.content}),(0,ct.jsxs)("div",{className:Kt,children:[this.props.cancel&&(0,ct.jsx)("button",{onClick:function(){e.props.closeCallBack(!1)},children:this.props.cancel}),this.props.confirm&&(0,ct.jsx)("button",{onClick:function(){e.props.closeCallBack(!0)},children:this.props.confirm})]})]})})}}]),r}(e.Component),Xt=function(e){var r=document.createElement("div");document.body.appendChild(r);var n=t.createRoot(r);n.render((0,ct.jsx)(Jt,{closeCallBack:function(t){n.unmount(),e&&e.closeCallBack&&e.closeCallBack(t)},title:(null===e||void 0===e?void 0:e.title)||"",content:(null===e||void 0===e?void 0:e.content)||"",confirm:(null===e||void 0===e?void 0:e.confirm)||"",cancel:(null===e||void 0===e?void 0:e.cancel)||""}))},$t="ZegoLoading_container__30IEp",er="ZegoLoading_loading__wFDPM",tr=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){return(0,ct.jsxs)("div",{className:$t,children:[(0,ct.jsx)("i",{className:er}),(0,ct.jsx)("p",{children:this.props.content})]})}}]),r}(e.Component),rr=function(t){l(i,t);var r=f(i);function i(){var t,n;s(this,i);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(n=r.call.apply(r,[this].concat(a))).state={localStream:void 0,localVideoStream:void 0,localAudioStream:void 0,userName:"xxx",videoOpen:!0,audioOpen:!0,copied:!1,isVideoOpening:!0,isJoining:!1,sharedLinks:null===(t=n.props.core._config.sharedLinks)||void 0===t?void 0:t.map((function(e){return{name:e.name,url:e.url,copied:!1}}))},n.videoRef=e.createRef(),n.inviteRef=e.createRef(),n.nameInputRef=e.createRef(),n.audioRefuse=n.props.core.status.audioRefuse,n.videoRefuse=n.props.core.status.videoRefuse,n.isAndroid=x(),n.isIOS=U(),n.clientHeight=0,n.onResize=function(){var e=document.documentElement.clientHeight||document.body.clientHeight;n.clientHeight<=e&&setTimeout((function(){n.nameInputRef.current.scrollIntoView({block:"start"})}),20)},n}return c(i,[{key:"componentDidMount",value:function(){var e=o(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({userName:this.props.core._expressConfig.userName}),t=!!this.props.core._config.turnOnCameraWhenJoining,r=!!this.props.core._config.turnOnMicrophoneWhenJoining,!t&&!r){e.next=8;break}return e.next=6,this.createStream(t,r);case 6:e.next=9;break;case 8:this.setState({audioOpen:r,videoOpen:t,isVideoOpening:!1});case 9:this.clientHeight=document.documentElement.clientHeight||document.body.clientHeight,this.isAndroid&&window.addEventListener("resize",this.onResize,{passive:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.state.localVideoStream&&this.props.core.destroyStream(this.state.localVideoStream),this.state.localAudioStream&&this.props.core.destroyStream(this.state.localAudioStream),window.removeEventListener("resize",this.onResize)}},{key:"createStream",value:function(){var e=o(n().mark((function e(t,r){var i,o,s,a,c,u=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=new MediaStream,e.prev=1,!t||!r){e.next=7;break}return this.setState({isVideoOpening:!0}),e.next=6,this.props.core.createStream({camera:{video:!0,audio:!0,facingMode:this.props.core._config.facingMode}});case 6:s=e.sent;case 7:e.next=39;break;case 9:if(e.prev=9,e.t0=e.catch(1),e.prev=11,!t){e.next=19;break}return this.setState({isVideoOpening:!0}),e.next=16,this.props.core.createStream({camera:{video:!0,audio:!1,facingMode:this.props.core._config.facingMode}});case 16:i=e.sent,null===(a=i)||void 0===a||a.getVideoTracks().map((function(e){s.addTrack(e)})),this.setState({localVideoStream:i});case 19:e.next=26;break;case 21:e.prev=21,e.t1=e.catch(11),this.videoRefuse=!0,this.setState({isVideoOpening:!1}),console.error("\u3010ZEGOCLOUD\u3011toggleStream/createStream failed !!",JSON.stringify(e.t1));case 26:if(e.prev=26,!r){e.next=33;break}return e.next=30,this.props.core.createStream({camera:{video:!1,audio:!0}});case 30:o=e.sent,null===(c=o)||void 0===c||c.getAudioTracks().map((function(e){s.addTrack(e)})),this.setState({localAudioStream:o});case 33:e.next=39;break;case 35:e.prev=35,e.t2=e.catch(26),this.audioRefuse=!0,console.error("\u3010ZEGOCLOUD\u3011toggleStream/createStream failed !!",JSON.stringify(e.t2));case 39:return this.setState({localStream:s,audioOpen:r&&!this.audioRefuse,videoOpen:t&&!this.videoRefuse,isVideoOpening:!1},(function(){u.videoRef.current&&s&&(u.videoRef.current.srcObject=s)})),e.abrupt("return",s);case 41:case"end":return e.stop()}}),e,this,[[1,9],[11,21],[26,35]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"toggleStream2",value:function(){var e=o(n().mark((function e(t){var r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("video"!==t){e.next=15;break}if(!this.videoRefuse){e.next=4;break}return Xt({title:"Equipment authorization",content:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",confirm:"Okay"}),e.abrupt("return");case 4:if(r=!this.state.videoOpen,this.state.localVideoStream){e.next=10;break}return e.next=8,this.createStream(r,this.state.audioOpen);case 8:e.next=12;break;case 10:this.state.localVideoStream.getTracks().reverse().forEach((function(e){return e.stop()})),this.setState({localVideoStream:void 0});case 12:this.setState({videoOpen:r}),e.next=27;break;case 15:if("audio"!==t){e.next=27;break}if(!this.audioRefuse){e.next=19;break}return Xt({title:"Equipment authorization",content:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",confirm:"Okay"}),e.abrupt("return");case 19:if(i=!this.state.audioOpen,this.state.localAudioStream){e.next=25;break}return e.next=23,this.createStream(this.state.videoOpen,i);case 23:e.next=26;break;case 25:this.props.core.muteMicrophone(i);case 26:this.setState({audioOpen:i});case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleStream1",value:function(){var e=o(n().mark((function e(t){var r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"video"===t&&this.state.localStream?(r=!this.state.videoOpen,this.state.localStream.getVideoTracks().map((function(e){e.enabled=r})),this.setState({videoOpen:r})):"audio"===t&&this.state.localStream&&(i=!this.state.audioOpen,this.state.localStream.getAudioTracks().map((function(e){e.enabled=i})),this.setState({audioOpen:i}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleStream",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.videoOpen&&this.state.audioOpen&&this.state.localStream&&!this.state.localAudioStream&&!this.state.localVideoStream?this.toggleStream1(t):this.toggleStream2(t);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"joinRoom",value:function(){var e=o(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.userName.length){e.next=2;break}return e.abrupt("return");case 2:if(!this.state.isJoining){e.next=4;break}return e.abrupt("return");case 4:this.setState({isJoining:!0},o(n().mark((function e(){var r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.props.core._expressConfig.userName=t.state.userName,t.props.core._config.turnOnMicrophoneWhenJoining=t.state.audioOpen&&!t.audioRefuse,t.props.core._config.turnOnCameraWhenJoining=t.state.videoOpen&&!t.videoRefuse,t.props.core.status.audioRefuse=t.audioRefuse,t.props.core.status.videoRefuse=t.videoRefuse,e.next=7,t.props.core.enterRoom();case 7:r=e.sent,i="",0===r?(t.state.localStream&&t.props.core.destroyStream(t.state.localStream),t.props.joinRoom&&t.props.joinRoom()):i=1002034===r?"Failed to join the room, the number of people in the room has reached the maximum.(2 people)":[1002031,1002053].includes(r)?"There's something wrong with your network. Please check it and try again.":[1102018,1102016,1102020].includes(r)?"Failed to join the room, token authentication error.":1002056===r?"You are on a call in another room, please leave that room first.":"Failed to join the room, please try again.(error code:"+r+")",t.setState({isJoining:!1},(function(){i&&Ft({content:i})}));case 11:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){this.setState({userName:e.target.value.trim().substring(0,255)})}},{key:"render",value:function(){var e,t=this;return(0,ct.jsxs)("div",{className:Tt,children:[(0,ct.jsxs)("div",{className:Ct,children:[(0,ct.jsx)("video",{playsInline:!0,className:"".concat(Rt," ").concat(this.state.videoOpen?"":Ot),autoPlay:!0,muted:!0,ref:this.videoRef}),!this.props.core._config.showMyCameraToggleButton&&!this.props.core._config.turnOnCameraWhenJoining&&(0,ct.jsx)("div",{className:It,children:this.state.userName.substring(0,1)||this.props.core._expressConfig.userName.substring(0,1)||"Z"}),(this.props.core._config.showMyCameraToggleButton||this.props.core._config.turnOnCameraWhenJoining)&&!this.state.videoOpen&&!this.state.isVideoOpening&&(0,ct.jsx)("div",{className:kt,children:"Camera is off"}),this.state.isVideoOpening&&(0,ct.jsx)("div",{className:kt,children:"Camera is starting\u2026"}),(0,ct.jsxs)("div",{className:Lt,children:[this.props.core._config.showMyMicrophoneToggleButton&&(0,ct.jsx)("a",{className:this.state.audioOpen?wt:At,onClick:function(){t.toggleStream("audio")}}),this.props.core._config.showMyCameraToggleButton&&(0,ct.jsx)("a",{className:this.state.videoOpen?Nt:Pt,onClick:function(){t.toggleStream("video")}})]})]}),(0,ct.jsxs)("div",{className:Mt,children:[(0,ct.jsxs)("div",{className:"".concat(Dt," ").concat(Ut),children:[this.state.userName&&(0,ct.jsx)("label",{children:"Your Name"}),(0,ct.jsx)("input",{placeholder:"Your Name",ref:this.nameInputRef,value:this.state.userName,className:this.state.userName!=this.props.core._expressConfig.userName?Ut:"",onChange:function(e){t.handleChange(e)},onFocus:function(e){t.isIOS&&setTimeout((function(){e.target.scrollIntoView({block:"start"})}),50)},onBlur:function(e){t.isAndroid&&setTimeout((function(){e.target.scrollIntoView({block:"start"})}),100)}}),(0,ct.jsx)("button",{className:this.state.userName&&xt,onClick:function(){t.joinRoom()},children:"Join"})]}),null===(e=this.state.sharedLinks)||void 0===e?void 0:e.map((function(e){return(0,ct.jsxs)("div",{className:Bt,children:[(0,ct.jsxs)("div",{className:jt,children:[(0,ct.jsx)("h3",{children:e.name}),(0,ct.jsx)("input",{placeholder:"inviteLink",readOnly:!0,value:e.url})]}),(0,ct.jsx)("button",{className:e.copied?Ht:"",onClick:function(){e&&e.url&&I(e.url),t.setState((function(t){return{sharedLinks:t.sharedLinks.map((function(t){return t.name===e.name&&(t.copied=!0),t}))}})),setTimeout((function(){t.setState((function(t){return{sharedLinks:t.sharedLinks.map((function(t){return t.name===e.name&&(t.copied=!1),t}))}}))}),5e3)}})]},e.name)}))]}),this.state.isJoining&&(0,ct.jsx)(tr,{content:"Loading..."})]})}}]),i}(e.Component),nr="ZegoRoom_ZegoRoom__D979t",ir="ZegoRoom_header__UuKp0",or="ZegoRoom_headerLeft__liwb3",sr="ZegoRoom_logo__vzpoi",ar="ZegoRoom_liveState__nqCOt",cr="ZegoRoom_goLive__D86a+",ur="ZegoRoom_goLiveEnabled__5klT7",lr="ZegoRoom_content__EMPv3",dr="ZegoRoom_contentLeft__xCJxU",hr="ZegoRoom_network__3PQN8",pr="ZegoRoom_reconnect__vOtg-",fr="ZegoRoom_countDown__9YcvK",gr="ZegoRoom_contentRight__Gr9vm",mr="ZegoRoom_listHeader__ed8Zh",_r="ZegoRoom_listHeaderClose__J4CgM",vr="ZegoRoom_listContent__5Hf8r",yr="ZegoRoom_footer__aqbcT",Er="ZegoRoom_handlerMiddle__FuV1X",Sr="ZegoRoom_leaveButton__2gDUd",br="ZegoRoom_liveLeaveButton__BD0Lu",Tr="ZegoRoom_handlerRight__VvZdV",Cr="ZegoRoom_inviteButton__lBRAX",Rr="ZegoRoom_micButton__QSw1y",Or="ZegoRoom_close__Sv-h6",kr="ZegoRoom_cameraButton__cauag",Ir="ZegoRoom_screenButton__GYHLm",Lr="ZegoRoom_sharing__RYQ3l",wr="ZegoRoom_moreButton__hKcHy",Ar="ZegoRoom_memberButton__FAU4K",Nr="ZegoRoom_memberNum__5EFf5",Pr="ZegoRoom_msgButton__mnheu",Mr="ZegoRoom_msgButtonRed__zUox0",Dr="ZegoRoom_settingsButtonModel__93ksx",Ur="ZegoRoom_notify__bx35O",xr="ZegoRoom_notifyContent__X9XD7",Br="ZegoRoom_nowrap__nVv2K",jr="ZegoRoom_layoutSettingsMask__QLfUS",Hr="ZegoRoom_layoutSettingsWrapper__A8i88",Gr="ZegoRoom_layoutSettingsHeader__oAvfz",zr="ZegoRoom_layoutSettingsCloseIcon__uK7jh",qr="ZegoRoom_layoutSettingsContent__OFGrl",Vr="ZegoRoom_layoutSettingsItemRow__cifZz",Fr="ZegoRoom_layoutSettingsItemIcon__ti3if",Zr="ZegoRoom_layoutSettingsItemChecked__zlirT",Wr="ZegoRoom_layoutSettingsItemLoading__gxzYi",Yr="ZegoRoom_screenBottomBar__37-ld",Qr="ZegoRoom_screenBottomBarLeft__+nHay",Kr="ZegoRoom_screenBottomBarRight__mAF90",Jr="ZegoRoom_liveNotStart__-Nvm8",Xr="ZegoRoom_noOneStreaming__6MbWU",$r=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={time:0},e}return c(r,[{key:"startTimer",value:function(){var e=this;setTimeout((function(){e.setState((function(e){return{time:++e.time}}),(function(){e.startTimer()}))}),1e3)}},{key:"componentDidMount",value:function(){this.startTimer()}},{key:"render",value:function(){return(0,ct.jsx)("div",{children:(e=this.state.time,[e/3600,e/60,e%60].map((function(e){return(e<10?"0":"")+Math.floor(e)})).join(":"))});var e}}]),r}(e.PureComponent),en="zegoOne2One_bigVideo__uvBFD",tn="zegoOne2One_smallVideo__zu-hy",rn=e.createContext({showPinButton:!0,speakerId:"default",userInfo:{userID:""},show:function(){}}),nn="zegoVideoPlayer_videoPlayerWrapper__IihXv",on="zegoVideoPlayer_name__QUTXW",sn="zegoVideoPlayer_nameTag__19ufN",an="zegoVideoPlayer_micIcon__yghiv",cn="zegoVideoPlayer_close__IdJBj",un="zegoVideoPlayer_cameraMask__nfMLJ",ln="zegoVideoPlayer_moreWrapperMask__OYB5R",dn="zegoVideoPlayer_moreMenu__GjC1j",hn="zegoVideoPlayer_moreWrapper__S-YPA",pn="zegoVideoPlayer_moreIcon__XTYsc",fn="zegoVideoPlayer_moreMenuItem__pfu+I",gn="zegoVideoPlayer_moreMenuPinIcon__-4u35",mn="zegoVideoPlayer_videoCommon__rsC5C",_n=__webpack_require__(9518),vn=__webpack_require__.n(_n),yn="zegoMedia_video__eeXLG",En="zegoMedia_videoPlayBtn__dzA-x",Sn="zegoMedia_mobile__EEAXX",bn="zegoMedia_mirror__qKkUZ",Tn=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).context=void 0,e.videoRef=null,e.flvPlayer=null,e.timer=null,e.loadTimer=null,e.lastDecodedFrame=0,e.retryTime=0,e.retryTimer=null,e.state={isPaused:!1},e.onloadedmetadata=function(){e.loadTimer=setTimeout((function(){var t;null===(t=e.videoRef)||void 0===t||t.load()}),5e3)},e}return c(r,[{key:"componentDidMount",value:function(){this.initVideo(this.videoRef)}},{key:"componentDidUpdate",value:function(e){this.initVideo(this.videoRef)}},{key:"initVideo",value:function(e){var t=this;if(e){var r,n,i,o,s,a,c,u,l,d,h,p,f,g,m,_;if(!this.videoRef&&(this.videoRef=e),e.muted!==this.props.muted&&(e.muted=this.props.muted),(null===e||void 0===e?void 0:e.sinkId)!==(null===(r=this.context)||void 0===r?void 0:r.speakerId))null===e||void 0===e||null===(u=(l=e).setSinkId)||void 0===u||u.call(l,(null===(d=this.context)||void 0===d?void 0:d.speakerId)||"");if(null!==(n=this.props.userInfo)&&void 0!==n&&null!==(i=n.streamList)&&void 0!==i&&null!==(o=i[0])&&void 0!==o&&o.media){if(e.srcObject!==(null===(h=this.props.userInfo)||void 0===h||null===(p=h.streamList)||void 0===p||null===(f=p[0])||void 0===f?void 0:f.media))e.srcObject=null===(g=this.props.userInfo)||void 0===g||null===(m=g.streamList)||void 0===m||null===(_=m[0])||void 0===_?void 0:_.media}else if(null!==(s=this.props.userInfo)&&void 0!==s&&null!==(a=s.streamList)&&void 0!==a&&null!==(c=a[0])&&void 0!==c&&c.urlsHttpsFLV){var v,y,E,S,b;if(B()){if(e.src!==(null===(v=this.props.userInfo)||void 0===v||null===(y=v.streamList)||void 0===y||null===(E=y[0])||void 0===E?void 0:E.urlsHttpsHLS)){var T,C,R;e.onloadedmetadata=this.onloadedmetadata,e.src=null===(T=this.props.userInfo)||void 0===T||null===(C=T.streamList)||void 0===C||null===(R=C[0])||void 0===R?void 0:R.urlsHttpsHLS,e.load();var O=e.play();void 0!==O&&O.catch((function(e){console.error("play",e),t.setState({isPaused:!0})})).then((function(){t.setState({isPaused:!1})}))}}else this.initFLVPlayer(e,null===(S=this.props.userInfo.streamList)||void 0===S||null===(b=S[0])||void 0===b?void 0:b.urlsHttpsFLV)}}}},{key:"initFLVPlayer",value:function(e,t){var r,n,i,o,s,a,c,u,l,d,h,p,f=this;this.flvPlayer||vn().isSupported()&&(this.flvPlayer=vn().createPlayer({type:"flv",isLive:!0,url:t,cors:!0,hasAudio:void 0===(null===(r=this.props.userInfo.streamList)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.hasAudio)?"OPEN"===(null===(i=this.props.userInfo.streamList)||void 0===i||null===(o=i[0])||void 0===o?void 0:o.micStatus):null===(s=this.props.userInfo.streamList)||void 0===s||null===(a=s[0])||void 0===a?void 0:a.hasAudio,hasVideo:void 0===(null===(c=this.props.userInfo.streamList)||void 0===c||null===(u=c[0])||void 0===u?void 0:u.hasVideo)?"OPEN"===(null===(l=this.props.userInfo.streamList)||void 0===l||null===(d=l[0])||void 0===d?void 0:d.cameraStatus):null===(h=this.props.userInfo.streamList)||void 0===h||null===(p=h[0])||void 0===p?void 0:p.hasVideo}),this.flvPlayer.on(vn().Events.LOADING_COMPLETE,(function(){var e;null===(e=f.flvPlayer)||void 0===e||e.play()})),this.flvPlayer.on(vn().Events.ERROR,(function(e){console.error(vn().Events.ERROR,e)})),this.flvPlayer.on("statistics_info",(function(e){if(0===f.lastDecodedFrame)return f.lastDecodedFrame=e.decodedFrames,void(f.retryTime=0);f.lastDecodedFrame!==e.decodedFrames?(f.lastDecodedFrame=e.decodedFrames,f.retryTime=0):(f.retryTime+=1,f.retryTimer||(f.retryTimer=setTimeout((function(){f.lastDecodedFrame=0,f.flvPlayer&&(f.flvPlayer.unload(),f.flvPlayer.load())}),5e3)),f.retryTime%10===0&&(f.lastDecodedFrame=0,f.flvPlayer&&(f.flvPlayer.unload(),f.flvPlayer.load(),clearTimeout(f.retryTimer),f.retryTimer=null,console.error("retryTimer"))))})),this.flvPlayer.attachMediaElement(e),this.flvPlayer.load())}},{key:"componentWillUnmount",value:function(){var e,t;this.flvPlayer?(this.flvPlayer.pause(),this.flvPlayer.unload(),this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy(),this.flvPlayer=null):((null===(e=this.videoRef)||void 0===e?void 0:e.srcObject)&&(this.videoRef.srcObject=null),(null===(t=this.videoRef)||void 0===t?void 0:t.src)&&(this.videoRef.src=""));this.timer&&clearInterval(this.timer),this.loadTimer&&(this.videoRef.onloadedmetadata=null,clearTimeout(this.loadTimer),this.loadTimer=null)}},{key:"render",value:function(){var e,t,r,n=this;return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)("video",{autoPlay:!0,className:"".concat(yn,"  ").concat(this.context.userInfo.userID===this.props.userInfo.userID&&null!==(e=this.props.userInfo.streamList)&&void 0!==e&&null!==(t=e[0])&&void 0!==t&&null!==(r=t.streamID)&&void 0!==r&&r.includes("_main")?bn:""," ").concat(this.props.classList),playsInline:!0,ref:function(e){!n.videoRef&&(n.videoRef=e)},onPause:function(){console.error("paused"),n.setState({isPaused:!0}),n.props.onPause&&n.props.onPause()},onCanPlay:function(){var e;n.loadTimer&&(n.videoRef.onloadedmetadata=null,clearTimeout(n.loadTimer),n.loadTimer=null),null===(e=n.videoRef)||void 0===e||e.play().then((function(e){console.error("autoplay success",e),n.setState({isPaused:!1})})).catch((function(e){console.error("autoplay failed",e),n.setState({isPaused:!0})})),n.props.onCanPlay&&n.props.onCanPlay()},onPlaying:function(){console.error("onPlay"),n.setState({isPaused:!1})}}),this.state.isPaused&&(B()||U())&&(0,ct.jsx)("div",{className:"".concat(En," ").concat(D()?"":Sn),onClick:function(){var e,t;null===(e=n.videoRef)||void 0===e||e.load(),null===(t=n.videoRef)||void 0===t||t.play(),n.setState({isPaused:!1})}})]})}}]),r}(e.PureComponent);Tn.contextType=rn;var Cn=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).context=void 0,e.state={hovered:!1},e}return c(r,[{key:"render",value:function(){var e,t,r,n,i,o,s,a,c,u,l,d,h,p,f,g,m,_,v=this,y=null===(e=this.props.volume)||void 0===e?void 0:e[null===(t=this.props.userInfo)||void 0===t||null===(r=t.streamList)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.streamID],E=void 0===y?5:Math.ceil(7*y/100),S=this.context.showPinButton;return(0,ct.jsxs)("div",{className:" ".concat(nn," ").concat(this.props.myClass),onMouseEnter:function(){v.setState({hovered:!0})},onMouseLeave:function(){v.setState({hovered:!1})},children:[(0,ct.jsx)(Tn,{muted:this.props.muted,classList:mn,userInfo:this.props.userInfo,onPause:function(){v.props.onPause&&v.props.onPause()},onCanPlay:function(){v.props.onCanPlay&&v.props.onCanPlay()}}),(0,ct.jsxs)("div",{className:un,style:{display:"OPEN"===(null===(i=this.props.userInfo)||void 0===i||null===(o=i.streamList)||void 0===o||null===(s=o[0])||void 0===s?void 0:s.cameraStatus)?"none":"flex"},children:[this.props.userInfo.avatar&&(0,ct.jsx)("img",{src:this.props.userInfo.avatar,onError:function(e){e.target.style.display="none"},alt:""}),(0,ct.jsx)("div",{style:{color:q(null===(a=this.props.userInfo)||void 0===a?void 0:a.userName)},children:Y((null===(c=this.props.userInfo)||void 0===c?void 0:c.userName)||"")})]}),!this.props.hiddenName&&(0,ct.jsxs)("div",{className:on,children:[!(null!==(u=this.props.userInfo)&&void 0!==u&&null!==(l=u.streamList)&&void 0!==l&&null!==(d=l[0])&&void 0!==d&&d.urlsHttpsFLV)&&(0,ct.jsx)("span",{className:"".concat(an," ").concat("OPEN"!==(null===(h=this.props.userInfo)||void 0===h||null===(p=h.streamList)||void 0===p||null===(f=p[0])||void 0===f?void 0:f.micStatus)&&cn),children:"OPEN"===(null===(g=this.props.userInfo)||void 0===g||null===(m=g.streamList)||void 0===m||null===(_=m[0])||void 0===_?void 0:_.micStatus)&&(0,ct.jsx)("span",{style:{height:E+"px"}})}),(0,ct.jsx)("p",{className:this.props.userInfo.overScreenMuteVideo?"muteVideo":"unmuteVideo",children:this.props.userInfo.userName}),this.props.muted&&(0,ct.jsx)("span",{className:sn,children:"(You)"})]}),!this.props.hiddenMore&&S&&this.state.hovered&&(0,ct.jsx)("div",{className:ln,children:(0,ct.jsxs)("div",{className:hn,children:[(0,ct.jsx)("span",{className:pn}),(0,ct.jsx)("div",{className:dn,children:(0,ct.jsxs)("div",{className:fn,onClick:function(){v.props.handlePin&&v.props.handlePin(v.props.userInfo.userID)},children:[(0,ct.jsx)("span",{className:gn}),(0,ct.jsx)("p",{children:this.props.userInfo.pin?"Remove Pin":"Pin"})]})})]})})]})}}]),r}(e.PureComponent);Cn.contextType=rn;var Rn=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"getVideoScreen",value:function(){var e=this;return this.props.userList.length>1?(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)(Cn,{myClass:en,userInfo:this.props.userList[1],muted:!1,handlePin:function(){e.props.handleSetPin(e.props.userList[1].userID)},volume:this.props.soundLevel[this.props.userList[1].userID]||{}}),(0,ct.jsx)(Cn,{onPause:function(){e.props.selfInfo.userID===e.props.userList[0].userID&&e.props.onLocalStreamPaused()},myClass:tn,userInfo:this.props.userList[0],muted:this.props.selfInfo.userID===this.props.userList[0].userID,handlePin:function(){e.props.handleSetPin(e.props.userList[0].userID)},volume:this.props.soundLevel[this.props.userList[0].userID]||{}})]}):this.props.userList.length>0?(0,ct.jsx)(Cn,{myClass:en,onPause:function(){e.props.selfInfo.userID===e.props.userList[0].userID&&e.props.onLocalStreamPaused()},userInfo:this.props.userList[0],handlePin:function(){return e.props.handleSetPin(e.props.userList[0].userID)},muted:this.props.selfInfo.userID===this.props.userList[0].userID,volume:this.props.soundLevel[this.props.userList[0].userID]||{}}):null}},{key:"render",value:function(){return(0,ct.jsx)(ct.Fragment,{children:this.getVideoScreen()})}}]),r}(e.PureComponent),On="zegoMessage_msgContentWrapper__B6Nvg",kn="zegoMessage_msgList__RjYQu",In="zegoMessage_self__UUtPK",Ln="zegoMessage_msgNameWrapper__x0JXV",wn="zegoMessage_loading__0nmiK",An="zegoMessage_error__yXTnR",Nn="zegoMessage_name__fFi6P",Pn="zegoMessage_sendTime__2zfPA",Mn="zegoMessage_sendWrapper__YNNhA",Dn="zegoToast_ZegoToast__zKpnB",Un="zegoToast_content__5Ms4l",xn=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){return(0,ct.jsx)("div",{className:"".concat(Dn," \n        "),children:(0,ct.jsx)("div",{className:Un,children:this.props.content})})}}]),r}(e.Component),Bn=function(){var e,r,n=document.createElement("div");return document.body.appendChild(n),function(i){r&&clearTimeout(r),r=setTimeout((function(){var t;i&&i.closeCallBack&&i.closeCallBack(),null===(t=e)||void 0===t||t.unmount(),e=null}),(null===i||void 0===i?void 0:i.duration)||3e3),e||(e=t.createRoot(n)),e.render((0,ct.jsx)(xn,{closeCallBack:function(){},content:(null===i||void 0===i?void 0:i.content)||"",duration:(null===i||void 0===i?void 0:i.duration)||3}))}}(),jn=function(t){l(n,t);var r=f(n);function n(){var t;s(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).state={message:""},t.sendTime=0,t.msgListRef=e.createRef(),t}return c(n,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(e){e.messageList.length!==this.props.messageList.length&&this.scrollToBottom()}},{key:"handleSend",value:function(){if(this.state.message.length){var e=(new Date).getTime();if(this.sendTime>0&&this.sendTime+900>e)return Bn({content:"Message sent too fast, please send again later"}),!1;this.props.sendMessage(this.state.message),this.setState({message:""}),this.sendTime=e}}},{key:"scrollToBottom",value:function(){this.msgListRef.current.scrollTop=this.msgListRef.current.scrollHeight}},{key:"messageInput",value:function(e){this.setState({message:e.target.value.substring(0,300)})}},{key:"render",value:function(){var e=this;return(0,ct.jsxs)("div",{className:On,children:[(0,ct.jsx)("div",{className:kn,ref:this.msgListRef,children:this.props.messageList.map((function(t){return(0,ct.jsxs)("div",{className:t.fromUser.userID===e.props.selfUserID?In:"",children:[(0,ct.jsxs)("div",{className:Ln,children:[(0,ct.jsx)("span",{className:Nn,children:t.fromUser.userName}),(0,ct.jsx)("span",{className:Pn,children:"".concat(new Date(t.sendTime).getHours()>=12?"PM":"AM","  ").concat(G(t.sendTime,"hh:mm"))})]}),(0,ct.jsx)("p",{className:"".concat("SENDING"===t.status&&wn," ").concat("FAILED"===t.status&&An),children:t.message})]},t.messageID)}))}),(0,ct.jsxs)("div",{className:Mn,children:[(0,ct.jsx)("input",{value:this.state.message,onChange:function(t){e.messageInput(t)},placeholder:"Send a message to everyone",onKeyPress:function(t){"Enter"===t.key&&e.handleSend()}}),(0,ct.jsx)("button",{disabled:!this.state.message.length,onClick:function(){e.handleSend()}})]})]})}}]),n}(e.PureComponent),Hn="zegoGridLayout_gridWrapper__pWcb0",Gn="zegoGridLayout_double__-u3eL",zn="zegoGridLayout_three__KMbPH",qn="zegoGridLayout_six__t9XID",Vn="zegoGridLayout_night__GoYWa",Fn="zegoGridLayout_twoRow__wRVxO",Zn="zegoGridLayout_twoRowFourCol__TUEJ0",Wn="zegoGridLayout_twoRowThreeCol__FSUz1",Yn="zegoGridLayout_twoRowTwoCol__0d5R-",Qn="zegoGridLayout_twoRowOneCol__2UU5W",Kn="zegoGridLayout_singleRow__ZgcOn";function Jn(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=Jn(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}var Xn=function(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=Jn(e))&&(n&&(n+=" "),n+=t);return n},$n={otherVideoWrapper:"zegoOthersVideo_otherVideoWrapper__5zb1v",nameWrapper:"zegoOthersVideo_nameWrapper__LylW-",nameCircle:"zegoOthersVideo_nameCircle__LbvK4",othersNumber:"zegoOthersVideo_othersNumber__e07x2"},ei=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){return(0,ct.jsxs)("div",{children:[(0,ct.jsx)("video",{muted:!0,className:$n.videoCommon}),(0,ct.jsxs)("div",{className:$n.otherVideoWrapper,children:[(0,ct.jsx)("div",{className:$n.nameWrapper,children:this.props.users.map((function(e,t){return(0,ct.jsxs)("div",{className:$n.nameCircle,style:{color:q(e.userName)},children:[Y(e.userName),e.avatar&&(0,ct.jsx)("img",{src:e.avatar,onError:function(e){e.target.style.display="none"},alt:""})]},e.userID)}))}),this.props.others>0&&(0,ct.jsxs)("p",{className:$n.othersNumber,children:[this.props.others," others"]})]})]})}}]),r}(e.PureComponent),ti=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).context=void 0,e.audioRef=null,e.flvPlayer=void 0,e}return c(r,[{key:"initAudio",value:function(e){if(e){var t,r,n,i,o,s,a,c,u,l,d,h,p,f,g,m;if(!this.audioRef&&(this.audioRef=e),(null===e||void 0===e?void 0:e.sinkId)!==(null===(t=this.context)||void 0===t?void 0:t.speakerId))null===e||void 0===e||null===(c=(u=e).setSinkId)||void 0===c||c.call(u,(null===(l=this.context)||void 0===l?void 0:l.speakerId)||"");if(null!==(r=this.props.userInfo)&&void 0!==r&&null!==(n=r.streamList)&&void 0!==n&&null!==(i=n[0])&&void 0!==i&&i.media)e.srcObject!==(null===(d=this.props.userInfo)||void 0===d||null===(h=d.streamList)||void 0===h||null===(p=h[0])||void 0===p?void 0:p.media)&&(e.srcObject=null===(f=this.props.userInfo)||void 0===f||null===(g=f.streamList)||void 0===g||null===(m=g[0])||void 0===m?void 0:m.media);else if(null!==(o=this.props.userInfo)&&void 0!==o&&null!==(s=o.streamList)&&void 0!==s&&null!==(a=s[0])&&void 0!==a&&a.urlsHttpsFLV){var _,v,y,E,S,b,T,C;if(this.isSafari())e.src!==(null===(_=this.props.userInfo)||void 0===_||null===(v=_.streamList)||void 0===v||null===(y=v[0])||void 0===y?void 0:y.urlsHttpsHLS)&&(e.src=null===(E=this.props.userInfo)||void 0===E||null===(S=E.streamList)||void 0===S||null===(b=S[0])||void 0===b?void 0:b.urlsHttpsHLS);else this.initFLVPlayer(e,null===(T=this.props.userInfo.streamList)||void 0===T||null===(C=T[0])||void 0===C?void 0:C.urlsHttpsFLV)}}}},{key:"initFLVPlayer",value:function(e,t){var r=this;vn().isSupported()&&(this.flvPlayer||(this.flvPlayer=vn().createPlayer({type:"flv",isLive:!0,url:t,cors:!0,hasAudio:!0,hasVideo:!1}),this.flvPlayer.on(vn().Events.LOADING_COMPLETE,(function(){console.error("LOADING_COMPLETE"),r.flvPlayer.play()})),this.flvPlayer.attachMediaElement(e),this.flvPlayer.load()))}},{key:"isSafari",value:function(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)}},{key:"componentWillUnmount",value:function(){var e,t;this.flvPlayer?(this.flvPlayer.pause(),this.flvPlayer.unload(),this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy(),this.flvPlayer=null):((null===(e=this.audioRef)||void 0===e?void 0:e.srcObject)&&(this.audioRef.srcObject=null),(null===(t=this.audioRef)||void 0===t?void 0:t.src)&&(this.audioRef.src=""))}},{key:"render",value:function(){return(0,ct.jsx)("audio",{autoPlay:!0,style:{width:"1px",height:"1px"},muted:this.props.muted||!1,className:this.props.classList,ref:this.initAudio.bind(this),onCanPlay:function(e){e.target.play()}})}}]),r}(e.PureComponent);ti.contextType=rn;var ri=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"wrapClassName",get:function(){var e,t;if(3===this.props.gridRowNumber)return Xn((b(t={},Hn,!0),b(t,Gn,this.props.userList.length<=2),b(t,zn,4===this.props.userList.length||3===this.props.userList.length),b(t,qn,6===this.props.userList.length||5===this.props.userList.length),b(t,Vn,this.props.userList.length>=7),t));if(2===this.props.gridRowNumber){var r,n=this.props.videoShowNumber/2,i=Math.ceil(this.props.userList.length/2),o=this.props.userList.length>=this.props.videoShowNumber?n:i;return Xn((b(r={},Hn,!0),b(r,Fn,5===o),b(r,Zn,4===o),b(r,Wn,3===o),b(r,Yn,2===o),b(r,Qn,this.props.userList.length<=2),r))}return Xn((b(e={},Hn,!0),b(e,Kn,!0),e))}},{key:"render",value:function(){var e=this;return(0,ct.jsx)(ct.Fragment,{children:(0,ct.jsx)("div",{className:this.wrapClassName,children:this.props.userList.map((function(t,r,n){if(n.length>e.props.videoShowNumber){if(r===e.props.videoShowNumber-1)return(0,ct.jsx)(ei,{users:[n[r],n[r+1]],others:n.length-e.props.videoShowNumber+1},t.userID);if(r>e.props.videoShowNumber-1)return(0,ct.jsx)(ti,{muted:!1,userInfo:t},t.userID)}return(0,ct.jsx)(Cn,{userInfo:t,muted:t.userID===e.props.selfInfo.userID,handlePin:function(){e.props.handleSetPin(t.userID)},volume:e.props.soundLevel[t.userID]||{}},t.userID)}))})})}}]),r}(e.PureComponent),ni="zegoSidebarLayout_sidebarWrapper__dc1Nl",ii="zegoSidebarLayout_bigVideo__zdqpe",oi="zegoSidebarLayout_rightWrapper__C7g64",si="zegoSidebarLayout_fiveRow__ohmuO",ai="zegoSidebarLayout_fourRow__mOUTv",ci="zegoSidebarLayout_threeRow__hT4xT",ui="zegoSidebarLayout_twoRow__W79-9",li="zegoSidebarLayout_oneRow__TSPfI",di="zegoSidebarLayout_fullScreen__C15sS",hi="zegoSidebarLayout_bigVideoWrapper__QkEsL",pi="zegoSidebarLayout_fullScreenBtn__Vi0Yx",fi="zegoSidebarLayout_screenVideo__uQyzj",gi="zegoSidebarLayout_screenVideoLoading__2L69U",mi="zegoSidebarLayout_expend__nC09p",_i="zegoSidebarLayout_screenTipWrapper__AoMpL",vi="zegoSidebarLayout_bottomWrapper__8piz4",yi=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"pinUser",get:function(){var e=this.props.userList.findIndex((function(e){return e.pin}));return this.props.userList[e>-1?e:this.props.userList.length-1]}},{key:"render",value:function(){var e,t=this,r=Xn((b(e={},oi,!0),b(e,si,5===this.props.videoShowNumber),b(e,ai,4===this.props.videoShowNumber),b(e,ci,3===this.props.videoShowNumber),b(e,ui,2===this.props.videoShowNumber),b(e,li,1===this.props.videoShowNumber),e));return(0,ct.jsxs)("div",{className:ni,children:[(0,ct.jsx)(Cn,{myClass:ii,userInfo:this.pinUser,handlePin:function(){t.props.handleSetPin(t.pinUser.userID)},muted:this.pinUser.userID===this.props.selfInfo.userID,volume:this.props.soundLevel[this.pinUser.userID]||{}},this.pinUser.userID),(0,ct.jsx)("div",{className:r,children:this.props.userList.filter((function(e){return e.userID!==t.pinUser.userID})).map((function(e,r,n){if(n.length>t.props.videoShowNumber){if(r===t.props.videoShowNumber-1)return(0,ct.jsxs)("div",{children:[(0,ct.jsx)(ei,{users:[n[r],n[r+1]],others:n.length-t.props.videoShowNumber+1}),(0,ct.jsx)(ti,{muted:e.userID===t.props.selfInfo.userID,userInfo:e})]},"container_"+e.userID);if(r>t.props.videoShowNumber-1)return(0,ct.jsx)(ti,{muted:e.userID===t.props.selfInfo.userID,userInfo:e},e.userID)}return(0,ct.jsx)(Cn,{userInfo:e,muted:e.userID===t.props.selfInfo.userID,handlePin:function(){t.props.handleSetPin(e.userID)},volume:t.props.soundLevel[e.userID]||{}},e.userID)}))})]})}}]),r}(e.PureComponent),Ei="zegoRoomInvite_inviteLinkWrapper__7OR9j",Si="zegoRoomInvite_title__f6ZuN",bi="zegoRoomInvite_inviteLink__tUeB-",Ti="zegoRoomInvite_copyLinkButton__18WiF",Ci=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"handleCopy",value:function(e){I(e),Bn({content:"Copied"})}},{key:"render",value:function(){var e,t=this;return null===(e=this.props.core._config.sharedLinks)||void 0===e?void 0:e.map((function(e){return(0,ct.jsxs)("div",{className:Ei,children:[(0,ct.jsx)("div",{className:Si,children:e.name}),(0,ct.jsxs)("div",{className:bi,children:[(0,ct.jsx)("input",{placeholder:"inviteLink",readOnly:!0,value:e.url}),(0,ct.jsx)("div",{className:Ti,onClick:function(){e&&e.url&&t.handleCopy(e.url)}})]})]},e.name)}))}}]),r}(e.PureComponent),Ri="zegoUserList_memberListWrapper__54dbu",Oi="zegoUserList_member__BzXub",ki="zegoUserList_memberMenuShow__7Ye38",Ii="zegoUserList_memberMenuWrapper__HvgUi",Li="zegoUserList_memberNameWrapper__YI8+i",wi="zegoUserList_memberGuestNameWrapper__buoiq",Ai="zegoUserList_selfStatusWrapper__O8QZr",Ni="zegoUserList_memberStatusWrapper__mfu5W",Pi="zegoUserList_memberMicIcon__l3ust",Mi="zegoUserList_memberMicIconOpen__y+4cu",Di="zegoUserList_memberCameraIcon__DNcxO",Ui="zegoUserList_memberCameraIconOpen__X0Oks",xi="zegoUserList_memberPinIcon__Qo7hp",Bi="zegoUserList_memberPinIconOpen__-kkcD",ji="zegoUserList_memberMenuItem__3lXAe",Hi=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).context=void 0,e}return c(r,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onBodyClick.bind(this))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onBodyClick.bind(this))}},{key:"onBodyClick",value:function(e){var t=document.querySelector(".".concat(Oi,".").concat(ki));t&&!t.contains(e.target)&&t.classList.remove("".concat(ki))}},{key:"expandMemberMenu",value:function(e){document.querySelectorAll(".".concat(Oi)).forEach((function(t){(null===t||void 0===t?void 0:t.dataset.id)===e?t.classList.toggle("".concat(ki)):t.classList.remove("".concat(ki))}))}},{key:"getHeight",value:function(e,t){var r,n=null===(r=this.props.soundLevel[e])||void 0===r?void 0:r[t];return void 0===n?5:Math.ceil(9*n/100)}},{key:"isShownPin",value:function(e){var t;return(null===(t=this.props.core._config.scenario)||void 0===t?void 0:t.mode)!==m.OneONoneCall&&(this.context.showPinButton&&!!(this.props.core._config.showNonVideoUser||e.streamList&&e.streamList[0]&&"OPEN"===e.streamList[0].cameraStatus||e.streamList&&e.streamList[0]&&"OPEN"===e.streamList[0].micStatus&&this.props.core._config.showOnlyAudioUser))}},{key:"render",value:function(){var e=this;return(0,ct.jsx)("div",{className:Ri,children:this.props.userList.map((function(t){var r,n,i,o,s,a,c,u;return(0,ct.jsxs)("div",{className:Oi,onClick:function(){e.isShownPin(t)&&e.expandMemberMenu(t.userID)},"data-id":t.userID,children:[(0,ct.jsxs)("div",{className:"".concat(Li," ").concat(wi),children:[t.avatar&&(0,ct.jsx)("img",{src:t.avatar,onError:function(e){e.target.style.display="none"},alt:""}),(0,ct.jsx)("span",{style:{color:q(t.userName||"")},children:Y(t.userName||"")}),(0,ct.jsx)("p",{children:t.userName}),t.userID===e.props.selfUserID&&"(You)"]}),t.userID===e.props.selfUserID?e.isShownPin(t)&&(0,ct.jsxs)("div",{className:Ai,children:[(0,ct.jsx)("span",{}),(0,ct.jsx)("span",{}),(0,ct.jsx)("span",{})]}):(0,ct.jsxs)("div",{className:Ni,children:[(0,ct.jsx)("span",{className:"".concat(Pi," ").concat("OPEN"===(null===(r=t.streamList)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.micStatus)&&Mi),children:"OPEN"===(null===t||void 0===t||null===(i=t.streamList)||void 0===i||null===(o=i[0])||void 0===o?void 0:o.micStatus)&&(0,ct.jsx)("span",{style:{height:e.getHeight(t.userID,null===t||void 0===t||null===(s=t.streamList)||void 0===s||null===(a=s[0])||void 0===a?void 0:a.streamID)+"px"}})}),(0,ct.jsx)("span",{className:"".concat(Di," ").concat("OPEN"===(null===(c=t.streamList)||void 0===c||null===(u=c[0])||void 0===u?void 0:u.cameraStatus)&&Ui)}),e.isShownPin(t)&&(0,ct.jsx)("span",{className:"".concat(xi," ").concat(t.pin&&Bi)})]}),(0,ct.jsx)("div",{className:Ii,children:(0,ct.jsx)("div",{className:ji,onClick:function(){return e.props.handleSetPin(t.userID)},children:t.pin?"Remove Pin":"Pin"})})]},t.userID)}))})}}]),r}(e.PureComponent);Hi.contextType=rn;var Gi=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={fullScreen:!1,loadingMask:!1,showBottomTip:!1},e}return c(r,[{key:"componentDidMount",value:function(){var e=sessionStorage.getItem("screen_bottom_tip_".concat(this.props.roomID,"_").concat(this.props.selfInfo.userID));this.props.screenSharingUser.userID===this.props.selfInfo.userID&&!e&&this.setState({showBottomTip:!0})}},{key:"onCanPlay",value:function(){this.setState({loadingMask:!1})}},{key:"handleIgnore",value:function(){this.setState({showBottomTip:!1}),sessionStorage.setItem("screen_bottom_tip_".concat(this.props.roomID,"_").concat(this.props.selfInfo.userID),"1")}},{key:"render",value:function(){var e,t=this,r=Xn((b(e={},oi,!0),b(e,si,5===this.props.videoShowNumber),b(e,ai,4===this.props.videoShowNumber),b(e,ci,3===this.props.videoShowNumber),b(e,ui,2===this.props.videoShowNumber),b(e,li,1===this.props.videoShowNumber),b(e,di,this.state.fullScreen&&this.props.userList.length>0||0===this.props.userList.length),e));return(0,ct.jsxs)("div",{className:ni,children:[(0,ct.jsxs)("div",{className:hi,children:[(0,ct.jsx)(Cn,{myClass:fi,userInfo:this.props.screenSharingUser,handlePin:function(){t.props.handleSetPin(t.props.screenSharingUser.userID)},muted:this.props.screenSharingUser.userID===this.props.selfInfo.userID,volume:{},hiddenMore:!0,hiddenName:!0,onCanPlay:this.onCanPlay.bind(this)},"screen_"+this.props.screenSharingUser.userID),this.state.loadingMask&&(0,ct.jsxs)("div",{className:gi,children:[(0,ct.jsx)("i",{}),(0,ct.jsx)("p",{children:this.props.screenSharingUser.userID===this.props.selfInfo.userID?"You are presenting your screen":"".concat(this.props.screenSharingUser.userName," is presenting the screen")})]}),(0,ct.jsx)("div",{className:"".concat(pi," ").concat(this.state.fullScreen?mi:""),onClick:function(){t.props.handleFullScreen&&t.props.handleFullScreen(!t.state.fullScreen),t.setState({fullScreen:!t.state.fullScreen})},children:(0,ct.jsx)("p",{children:this.state.fullScreen?"Exit full screen":"Full screen"})}),this.state.showBottomTip&&(0,ct.jsx)("div",{className:_i,children:(0,ct.jsxs)("div",{className:vi,children:[(0,ct.jsx)("p",{children:"To avoid an infinity mirror, we suggest you not to share your entire screen or browser window."}),(0,ct.jsx)("div",{onClick:this.handleIgnore.bind(this),children:"Ignore"})]})})]}),(0,ct.jsx)("div",{className:r,children:this.props.userList.map((function(e,r,n){if(n.length>t.props.videoShowNumber){if(r===t.props.videoShowNumber-1)return(0,ct.jsxs)("div",{children:[(0,ct.jsx)(ei,{users:[n[r],n[r+1]],others:n.length-t.props.videoShowNumber+1}),(0,ct.jsx)(ti,{muted:e.userID===t.props.selfInfo.userID,userInfo:e})]},"screen_container_"+e.userID);if(r>t.props.videoShowNumber-1)return(0,ct.jsx)(ti,{muted:e.userID===t.props.selfInfo.userID,userInfo:e},e.userID)}return(0,ct.jsx)(Cn,{userInfo:e,muted:e.userID===t.props.selfInfo.userID,handlePin:function(){t.props.handleSetPin(e.userID)},volume:t.props.soundLevel[e.userID]||{}},e.userID)}))})]})}}]),r}(e.PureComponent),zi=function(t){l(i,t);var r=f(i);function i(){var t;s(this,i);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r.call.apply(r,[this].concat(o))).state={localStream:void 0,layOutStatus:"ONE_VIDEO",zegoCloudUserList:[],messageList:[],notificationList:[],micOpen:!!t.props.core._config.turnOnMicrophoneWhenJoining,cameraOpen:!!t.props.core._config.turnOnCameraWhenJoining,showSettings:!1,isNetworkPoor:!1,connecting:!1,firstLoading:!0,selectMic:t.props.core.status.micDeviceID,selectSpeaker:t.props.core.status.speakerDeviceID,selectCamera:t.props.core.status.cameraDeviceID,selectVideoResolution:t.props.core.status.videoResolution||t.props.core._config.videoResolutionList[0],videoShowNumber:9,gridRowNumber:3,layout:t.props.core._config.layout||"Auto",showLayoutSettingsModel:!1,isLayoutChanging:!1,soundLevel:{},showNonVideoUser:t.props.core._config.showNonVideoUser,liveCountdown:-1,liveStatus:0,isScreenSharingBySelf:!1,screenSharingStream:void 0,screenSharingUserList:[],showZegoSettings:!1,haveUnReadMsg:!1},t.settingsRef=e.createRef(),t.moreRef=e.createRef(),t.micStatus=t.props.core._config.turnOnMicrophoneWhenJoining?1:0,t.cameraStatus=t.props.core._config.turnOnCameraWhenJoining?1:0,t.notifyTimer=void 0,t.msgDelayed=!0,t.localUserPin=!1,t.localStreamID="",t.screenSharingStreamID="",t.isCreatingScreenSharing=!1,t.fullScreen=!1,t.showNotSupported=0,t.notSupportMultipleVideoNotice=0,t.userUpdateCallBack=function(){},t.onOpenSettings=function(e){var r,n;t.settingsRef.current===e.target||null!==(r=t.settingsRef.current)&&void 0!==r&&r.contains(e.target)||t.moreRef.current===e.target||null!==(n=t.moreRef.current)&&void 0!==n&&n.contains(e.target)||t.setState({showSettings:!1})},t.onWindowResize=Z(t.computeByResize.bind(h(t)),500),t}return c(i,[{key:"isCDNLive",get:function(){var e,t;return(null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)===m.LiveStreaming&&(null===(t=this.props.core._config.scenario.config)||void 0===t?void 0:t.role)===g.Audience&&this.props.core._config.scenario.config.liveStreamingMode===v.StandardLive}},{key:"componentDidMount",value:function(){var e,t,r,n=this;this.setAllSinkId(this.state.selectSpeaker||""),this.computeByResize(),setTimeout((function(){n.msgDelayed=!1}),5e3),this.initSDK(),document.addEventListener("click",this.onOpenSettings),window.addEventListener("resize",this.onWindowResize.bind(this)),(null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)===m.LiveStreaming&&(null===(t=this.props.core._config.scenario)||void 0===t||null===(r=t.config)||void 0===r?void 0:r.role)===g.Audience&&this.toggleLayOut("MESSAGE")}},{key:"componentDidUpdate",value:function(e,t){var r=this;(t.notificationList.length>0&&this.state.notificationList.length>0&&t.notificationList[t.notificationList.length-1].messageID!==this.state.notificationList[this.state.notificationList.length-1].messageID||0===t.notificationList.length&&this.state.notificationList.length>0)&&(this.notifyTimer&&clearTimeout(this.notifyTimer),this.notifyTimer=setTimeout((function(){r.setState({notificationList:[]})}),3e3)),t.layout===this.state.layout&&t.isScreenSharingBySelf===this.state.isScreenSharingBySelf||this.computeByResize(),t.videoShowNumber!==this.state.videoShowNumber&&t.zegoCloudUserList===this.state.zegoCloudUserList&&this.userUpdateCallBack()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onOpenSettings),window.removeEventListener("resize",this.onWindowResize.bind(this)),this.state.isScreenSharingBySelf&&this.closeScreenSharing(),this.state.localStream&&this.props.core.destroyStream(this.state.localStream)}},{key:"initSDK",value:function(){var e=o(n().mark((function e(){var t,r,i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.core.onNetworkStatusQuality((function(e,t){i.setState({isNetworkPoor:t>2})})),this.props.core.onNetworkStatus((function(e,t,r){"DISCONNECTED"===r&&"ROOM"===t?(i.setState({connecting:!1,firstLoading:!1}),i.leaveRoom()):"CONNECTING"===r&&"STREAM"!==t?i.setState({connecting:!0}):i.setState({connecting:!1,firstLoading:!1})})),this.props.core.onRemoteUserUpdate((function(e,t,r){var n,o=[];null!==(n=i.props.core._config.lowerLeftNotification)&&void 0!==n&&n.showUserJoinAndLeave&&r.forEach((function(e){o.push({content:e.userName+" "+("ADD"===t?"enter":"quite")+" the room",type:"USER",userName:e.userName,messageID:M(5)})})),i.setState((function(e){return{notificationList:[].concat(k(e.notificationList),o)}})),i.computeByResize()})),this.props.core.onRoomMessageUpdate((function(e,t){i.setState((function(e){var r,n=[];return"MESSAGE"!==i.state.layOutStatus&&null!==(r=i.props.core._config.lowerLeftNotification)&&void 0!==r&&r.showTextChat&&(n=[].concat(k(e.notificationList),k(t.map((function(e){return{content:e.message,type:"MSG",userName:e.fromUser.userName,messageID:e.messageID}}))))),{messageList:[].concat(k(e.messageList),k(t)),notificationList:n,haveUnReadMsg:"MESSAGE"!=i.state.layOutStatus}}))})),this.props.core.subscribeUserList((function(e){if(i.userUpdateCallBack(),i.isCDNLive){var t=JSON.parse(JSON.stringify(e)),r=t.filter((function(e){return e.streamList.length>0&&("OPEN"===e.streamList[0].cameraStatus||"OPEN"===e.streamList[0].micStatus)})).length,n=i.state.screenSharingUserList.length>0?5:6;if(B()&&(n=1),r>n){var o=0,s=t.reverse().map((function(e){return e.streamList.length>0&&("OPEN"===e.streamList[0].cameraStatus||"OPEN"===e.streamList[0].micStatus)&&(o>=n?e.streamList=[]:o++),e}));return i.setState({zegoCloudUserList:s.reverse()}),void(B()&&0===i.notSupportMultipleVideoNotice&&(i.notSupportMultipleVideoNotice=1,St({header:"Notice",contentText:"Your current browser does not support the display of multiple video screens during the live streaming.",okText:"Okay"},document.querySelector(".".concat(nr)))))}}i.setState({zegoCloudUserList:e})})),this.props.core.onRoomLiveStateUpdate((function(e){i.setState((function(t){return{liveStatus:e,liveCountdown:-1===t.liveCountdown||0==t.liveCountdown?1===e?0:-1:t.liveCountdown}}))})),this.props.core.subscribeScreenStream((function(e){i.isCDNLive&&B()&&i.state.zegoCloudUserList.filter((function(e){return e.streamList.length>0&&("OPEN"===e.streamList[0].cameraStatus||"OPEN"===e.streamList[0].micStatus)})).length>0?i.setState({screenSharingUserList:[]},(function(){i.computeByResize()})):i.setState({screenSharingUserList:e},(function(){i.computeByResize()}))})),this.props.core.onSoundLevelUpdate((function(e){var t={};e.forEach((function(e){var r=e.streamID.split("_")[1];t[r]?t[r][e.streamID]=Math.floor(e.soundLevel):t[r]=b({},e.streamID,Math.floor(e.soundLevel))})),i.setState({soundLevel:t})})),this.props.core.onScreenSharingEnded((function(e){e===i.state.screenSharingStream&&i.closeScreenSharing()})),this.props.core.onCoreError((function(e,t){if(e===E.notSupportStandardLive||e===E.notSupportCDNLive){if(i.showNotSupported)return;i.showNotSupported=1,St({header:"Notice",contentText:"The service is not available, please contact the live streaming service provider to resolve.",okText:"Okay"},document.querySelector(".".concat(nr)))}})),e.next=12,this.props.core.enterRoom();case 12:if(t=e.sent,r="",0!==t){e.next=19;break}return this.createStream(),e.abrupt("return");case 19:r=1002034===t?"Failed to join the room, the number of people in the room has reached the maximum.(2 people)":[1002031,1002053].includes(t)?"There's something wrong with your network. Please check it and try again.":[1102018,1102016,1102020].includes(t)?"Failed to join the room, token authentication error.":1002056===t?"You are on a call in another room, please leave that room first.":"Failed to join the room, please try again.(error code:"+t+")";case 20:St({header:"Login room Failed",contentText:r,okText:"OK"},document.querySelector(".".concat(nr)));case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createStream",value:function(){var e=o(n().mark((function e(){var t,r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.core._config.turnOnCameraWhenJoining||this.props.core._config.turnOnMicrophoneWhenJoining||this.props.core._config.showMyCameraToggleButton||this.props.core._config.showMyMicrophoneToggleButton){e.next=2;break}return e.abrupt("return",!1);case 2:if(this.props.core.status.videoRefuse&&this.props.core.status.audioRefuse){e.next=22;break}return e.prev=3,t=F(this.state.selectVideoResolution),e.next=7,this.props.core.createStream({camera:C({video:!this.props.core.status.videoRefuse,audio:!this.props.core.status.audioRefuse,videoInput:this.state.selectCamera,audioInput:this.state.selectMic,videoQuality:4},t)});case 7:return r=e.sent,this.props.core.enableVideoCaptureDevice(r,!!this.props.core._config.turnOnCameraWhenJoining),this.props.core.muteMicrophone(!this.props.core._config.turnOnMicrophoneWhenJoining),this.setState({localStream:r}),!1!==(i=this.props.core.publishLocalStream(r))&&(this.localStreamID=i,this.props.core.setStreamExtraInfo(i,JSON.stringify({isCameraOn:!!this.props.core._config.turnOnCameraWhenJoining,isMicrophoneOn:this.props.core._config.turnOnMicrophoneWhenJoining,hasVideo:!this.props.core.status.videoRefuse,hasAudio:!this.props.core.status.audioRefuse}))),e.abrupt("return",!0);case 16:return e.prev=16,e.t0=e.catch(3),console.error("\u3010ZEGOCLOUD\u3011createStream or publishLocalStream failed,Reason: ",JSON.stringify(e.t0)),e.abrupt("return",!1);case 20:e.next=23;break;case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,this,[[3,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"toggleMic",value:function(){var e=o(n().mark((function e(){var t,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.core.status.audioRefuse){e.next=3;break}return St({header:"Equipment authorization",contentText:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",okText:"Okay"},document.querySelector(".".concat(nr))),e.abrupt("return");case 3:if(-1!==this.micStatus){e.next=5;break}return e.abrupt("return");case 5:if(this.micStatus=-1,!(this.state.localStream&&this.state.localStream.getAudioTracks().length>0)){e.next=11;break}return e.next=9,this.props.core.muteMicrophone(this.state.micOpen);case 9:t=e.sent,this.props.core.setStreamExtraInfo(this.localStreamID,JSON.stringify({isCameraOn:this.state.cameraOpen,isMicrophoneOn:!this.state.micOpen,hasVideo:!this.props.core.status.videoRefuse,hasAudio:!this.props.core.status.audioRefuse}));case 11:this.micStatus=this.state.micOpen?0:1,t&&(Bn({content:"The microphone is "+(this.micStatus?"on":"off")}),t&&this.setState({micOpen:!!this.micStatus},(function(){r.computeByResize(r.state.cameraOpen||r.state.micOpen)})));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleCamera",value:function(){var e=o(n().mark((function e(){var t,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.core.status.videoRefuse){e.next=3;break}return St({header:"Equipment authorization",contentText:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",okText:"Okay"},document.querySelector(".".concat(nr))),e.abrupt("return",Promise.resolve(!1));case 3:if(-1!==this.cameraStatus){e.next=5;break}return e.abrupt("return",Promise.resolve(!1));case 5:if(this.cameraStatus=-1,!(this.state.localStream&&this.state.localStream.getVideoTracks().length>0)){e.next=11;break}return e.next=9,this.props.core.enableVideoCaptureDevice(this.state.localStream,!this.state.cameraOpen);case 9:t=e.sent,this.props.core.setStreamExtraInfo(this.localStreamID,JSON.stringify({isCameraOn:!this.state.cameraOpen,isMicrophoneOn:this.state.micOpen,hasVideo:!this.props.core.status.videoRefuse,hasAudio:!this.props.core.status.audioRefuse}));case 11:return this.cameraStatus=this.state.cameraOpen?0:1,t&&(Bn({content:"The camera is "+(this.cameraStatus?"on":"off")}),t&&this.setState({cameraOpen:!!this.cameraStatus},(function(){r.computeByResize(r.state.cameraOpen||r.state.micOpen)}))),e.abrupt("return",!!t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleScreenSharing",value:function(){var e=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.isScreenSharingBySelf?this.closeScreenSharing():this.createScreenSharing();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createScreenSharing",value:function(){var e=o(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.screenSharingUserList.length>0)){e.next=3;break}return Bn({content:"".concat(this.state.screenSharingUserList[0].userName," is presenting now. You cannot share your screen.")}),e.abrupt("return");case 3:if(!this.isCreatingScreenSharing){e.next=5;break}return e.abrupt("return");case 5:return this.isCreatingScreenSharing=!0,e.prev=6,e.next=9,this.props.core.createStream({screen:{videoQuality:2,bitRate:1500,frameRate:15,audio:!j()}});case 9:t=e.sent,(r=this.props.core.publishLocalStream(t,"screensharing"))&&(this.screenSharingStreamID=r),this.props.core.setStreamExtraInfo(r,JSON.stringify({isCameraOn:!0,isMicrophoneOn:!0,hasVideo:t.getVideoTracks().length>0,hasAudio:t.getAudioTracks()[0].enabled})),this.setState({isScreenSharingBySelf:!0,screenSharingStream:t}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),1103043===(null===e.t0||void 0===e.t0?void 0:e.t0.code)?St({header:"Notice",contentText:"Your browser does not support screen sharing.",okText:"Okay"},document.querySelector(".".concat(nr))):1103010===(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&null!==e.t0&&void 0!==e.t0&&e.t0.msg.includes("Permission")?St({header:"Grant access to share your screen",contentText:"Your system does not have access to share a screen from the browser. Please grant access to share your screen on your system settings.",okText:"Okay"},document.querySelector(".".concat(nr))):1103042!==(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&Bn({content:"Failed to present your screen. error code: ".concat((null===e.t0||void 0===e.t0?void 0:e.t0.code)||-1)});case 19:this.isCreatingScreenSharing=!1;case 20:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"closeScreenSharing",value:function(){try{this.screenSharingStreamID&&this.props.core.stopPublishingStream(this.screenSharingStreamID),this.state.screenSharingStream&&this.props.core.destroyStream(this.state.screenSharingStream),this.setState({isScreenSharingBySelf:!1})}catch(error){console.error(error)}}},{key:"toggleLayOut",value:function(e){var t=this;this.setState((function(t){return{layOutStatus:t.layOutStatus===e?"ONE_VIDEO":e}}),(function(){t.computeByResize()}))}},{key:"sendMessage",value:function(){var e=o(n().mark((function e(t){var r,i,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=M(5),this.setState((function(e){return{messageList:[].concat(k(e.messageList),[{fromUser:{userID:o.props.core._expressConfig.userID,userName:o.props.core._expressConfig.userName},message:t,sendTime:Date.now(),messageID:r,status:"SENDING"}])}})),i={},e.prev=3,e.next=6,this.props.core.sendRoomMessage(t);case 6:i=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("\u3010ZEGOCLOUD\u3011sendMessage failed!",JSON.stringify(e.t0));case 12:this.setState((function(e){var t=e.messageList.map((function(e){var t;e.messageID===r&&(e.status=0===(null===(t=i)||void 0===t?void 0:t.errorCode)?"SENDED":"FAILED");return e}));return console.log(t),{messageList:t}}));case 13:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"openSettings",value:function(){this.setState({showSettings:!this.state.showSettings})}},{key:"handleSetting",value:function(){this.setState({showZegoSettings:!0})}},{key:"handleLeave",value:function(){var e=this;St({header:"Leave the room",contentText:"Are you sure to leave the room?",okText:"Confirm",cancelText:"Cancel",onOk:function(){e.props.core._config.turnOnCameraWhenJoining=e.state.cameraOpen,e.props.core._config.turnOnMicrophoneWhenJoining=e.state.micOpen,e.props.core.status.micDeviceID=e.state.selectMic,e.props.core.status.cameraDeviceID=e.state.selectCamera,e.props.core.status.speakerDeviceID=e.state.selectSpeaker,e.props.core.status.videoResolution=e.state.selectVideoResolution,e.leaveRoom()}},document.querySelector(".".concat(nr)))}},{key:"leaveRoom",value:function(){this.state.isScreenSharingBySelf&&this.closeScreenSharing(),this.state.localStream&&this.props.core.destroyStream(this.state.localStream),this.props.core.leaveRoom(),this.props.leaveRoom&&this.props.leaveRoom()}},{key:"showSelf",get:function(){return!!this.props.core._config.showNonVideoUser||(this.props.core._config.showOnlyAudioUser?this.localStreamID&&(this.state.micOpen||this.state.cameraOpen):this.localStreamID&&this.state.cameraOpen)}},{key:"computeByResize",value:function(){var e=o(n().mark((function e(){var t,r,i,o,s,a,c,u,l,d,h,p,f,g,m,_,v,y,E=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=E.length>0&&void 0!==E[0]&&E[0],r=Math.max(this.props.core._config.container.clientWidth,640),i=Math.max(this.props.core._config.container.clientHeight,328),o=0,s=0,!(this.getScreenSharingUser.length>0)){e.next=22;break}if(c=i-(null!==(a=this.props.core._config.branding)&&void 0!==a&&a.logoURL?64:0)-84-38,u=parseInt(String(c/124))||1,o=Math.min(124*u+10*(u-1)<=c?u:u-1||1,5),e.t0=!t,!e.t0){e.next=12;break}return e.next=12,this.props.core.setSidebarLayOut(!1);case 12:if(!this.fullScreen){e.next=18;break}return this.setState({videoShowNumber:0}),e.next=16,this.props.core.setMaxScreenNum(0);case 16:e.next=21;break;case 18:return this.setState({videoShowNumber:o}),e.next=21,this.props.core.setMaxScreenNum(this.showSelf?o-1:o);case 21:case 34:case 44:return e.abrupt("return");case 22:if("Sidebar"!==this.state.layout){e.next=35;break}if(d=i-(null!==(l=this.props.core._config.branding)&&void 0!==l&&l.logoURL?64:0)-84,h=parseInt(String(d/124))||1,o=Math.min(124*h+10*(h-1)<=d?h:h-1||1,5),p=!this.state.cameraOpen&&!this.state.micOpen||!this.localUserPin,e.t1=!t,!e.t1){e.next=31;break}return e.next=31,this.props.core.setSidebarLayOut(p);case 31:return this.setState({videoShowNumber:o}),e.next=34,this.props.core.setMaxScreenNum(this.showSelf?o:o+1);case 35:if("Grid"!==this.state.layout&&"Auto"!==this.state.layout){e.next=45;break}if(i<406-(null!==(f=this.props.core._config.branding)&&void 0!==f&&f.logoURL?0:64)?(m=r-32-("ONE_VIDEO"===this.state.layOutStatus?0:350),_=parseInt(String(m/160)),o=Math.min(160*_+10*(_-1)<=m?_:_-1,10),s=1):i<540-(null!==(g=this.props.core._config.branding)&&void 0!==g&&g.logoURL?0:64)?(v=r-32-("ONE_VIDEO"===this.state.layOutStatus?0:350),y=parseInt(String(v/124)),o=Math.min(124*y+10*(y-1)<=v?2*y:2*(y-1),10),s=2):(o=9,s=3),e.t2=!t,!e.t2){e.next=41;break}return e.next=41,this.props.core.setSidebarLayOut(!1);case 41:return this.setState({videoShowNumber:o,gridRowNumber:s}),e.next=44,this.props.core.setMaxScreenNum(this.showSelf?o-1:o);case 45:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showLayoutSettings",value:function(e){this.setState({showLayoutSettingsModel:e})}},{key:"changeLayout",value:function(){var e=o(n().mark((function e(t){var r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.isLayoutChanging){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e,n){r.userUpdateCallBack=function(){r.setState({isLayoutChanging:!1}),e(!0)},"Grid"!==t&&"Auto"!==t||(r.props.core.setPin(),r.localUserPin=!1),r.setState({isLayoutChanging:!0,layout:t}),r.props.core.setSidebarLayOut("Sidebar"===t),setTimeout((function(){r.setState({isLayoutChanging:!1}),e(!1)}),5e3)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllUser",value:function(){return[{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName,pin:this.localUserPin,avatar:this.props.core._expressConfig.avatar,streamList:[{media:this.state.localStream,fromUser:{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName},micStatus:this.state.micOpen?"OPEN":"MUTE",cameraStatus:this.state.cameraOpen?"OPEN":"MUTE",state:"PLAYING",streamID:this.localStreamID}]}].concat(k(this.state.zegoCloudUserList))}},{key:"getShownUser",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.getAllUser().filter((function(r){return!(!e.props.core._config.showNonVideoUser&&!t)||!!(r.streamList&&r.streamList[0]&&(r.streamList[0].media||r.streamList[0].urlsHttpsFLV||r.streamList[0].urlsHttpsHLS))&&("OPEN"===r.streamList[0].cameraStatus||!(!e.props.core._config.showOnlyAudioUser||"OPEN"!==r.streamList[0].micStatus))}));return r}},{key:"getScreenSharingUser",get:function(){return this.state.isScreenSharingBySelf?[{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName,avatar:this.props.core._expressConfig.avatar,pin:!1,streamList:[{media:this.state.screenSharingStream,fromUser:{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName},micStatus:"OPEN",cameraStatus:"OPEN",state:"PLAYING",streamID:this.screenSharingStreamID}]}]:this.state.screenSharingUserList}},{key:"getHiddenUser",value:function(){var e=this,t=this.getAllUser().filter((function(t){return!(e.props.core._config.showNonVideoUser||!t.streamList||!t.streamList[0]||!(t.streamList[0].media||t.streamList[0].urlsHttpsFLV||t.streamList[0].urlsHttpsHLS)||"OPEN"===t.streamList[0].cameraStatus||e.props.core._config.showOnlyAudioUser||"OPEN"!==t.streamList[0].micStatus)}));return(0,ct.jsx)(ct.Fragment,{children:t.map((function(t){return(0,ct.jsx)(ti,{muted:t.userID===e.props.core._expressConfig.userID,userInfo:t},t.userID+"_hiddenAudio")}))})}},{key:"showScreenShareBottomTip",get:function(){var e,t,r;return((null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)!==m.LiveStreaming||(null===(t=this.props.core._config.scenario)||void 0===t||null===(r=t.config)||void 0===r?void 0:r.role)!==g.Audience||1===this.state.liveStatus)&&this.getScreenSharingUser.length>0}},{key:"getLayoutScreen",value:function(){var e,t,r,i,s=this;return(null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)===m.LiveStreaming&&(null===(t=this.props.core._config.scenario)||void 0===t||null===(r=t.config)||void 0===r?void 0:r.role)===g.Audience&&1!==this.state.liveStatus?(0,ct.jsxs)("div",{className:Jr,children:[(0,ct.jsx)("i",{}),(0,ct.jsx)("span",{children:"The Live has not started yet"})]}):[].concat(k(this.getAllUser()),k(this.getScreenSharingUser)).some((function(e){return!!e.streamList&&e.streamList.some((function(e){return"OPEN"===e.cameraStatus||"OPEN"===e.micStatus}))}))||(null===(i=this.props.core._config.scenario)||void 0===i?void 0:i.mode)!==m.LiveStreaming?this.getScreenSharingUser.length>0?(0,ct.jsx)(ct.Fragment,{children:(0,ct.jsx)(Gi,{handleSetPin:function(e){s.handleSetPin(e)},userList:this.getShownUser(),videoShowNumber:this.state.videoShowNumber,selfInfo:{userID:this.props.core._expressConfig.userID},screenSharingUser:this.getScreenSharingUser[0],soundLevel:this.state.soundLevel,handleFullScreen:this.handleFullScreen.bind(this),roomID:this.props.core._expressConfig.roomID})}):"Auto"===this.state.layout&&this.getShownUser().length<3||this.getShownUser().length<2?(0,ct.jsx)(Rn,{onLocalStreamPaused:o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.props.core.enableVideoCaptureDevice(s.state.localStream,!s.state.cameraOpen);case 2:s.props.core.enableVideoCaptureDevice(s.state.localStream,s.state.cameraOpen);case 3:case"end":return e.stop()}}),e)}))),selfInfo:{userID:this.props.core._expressConfig.userID},handleSetPin:function(e){s.handleSetPin(e)},userList:this.getShownUser(),soundLevel:this.state.soundLevel}):"Grid"===this.state.layout&&this.getShownUser().length>1||"Auto"===this.state.layout&&this.getShownUser().length>2?(0,ct.jsx)(ri,{userList:this.getShownUser(),videoShowNumber:this.state.videoShowNumber,gridRowNumber:this.state.gridRowNumber,selfInfo:{userID:this.props.core._expressConfig.userID},handleSetPin:function(e){s.handleSetPin(e)},soundLevel:this.state.soundLevel}):"Sidebar"===this.state.layout&&this.getShownUser().length>1?(0,ct.jsx)(yi,{handleSetPin:function(e){s.handleSetPin(e)},userList:this.getShownUser(),videoShowNumber:this.state.videoShowNumber,selfInfo:{userID:this.props.core._expressConfig.userID},soundLevel:this.state.soundLevel}):(0,ct.jsx)(ct.Fragment,{}):(0,ct.jsxs)("div",{className:Xr,children:[(0,ct.jsx)("i",{}),(0,ct.jsx)("span",{children:"No one has turned on the camera or microphone yet."})]})}},{key:"handleSetPin",value:function(e){e===this.props.core._expressConfig.userID?(this.localUserPin=!this.localUserPin,this.props.core.setPin()):(this.localUserPin=!1,this.props.core.setPin(e)),this.props.core.setSidebarLayOut(!(this.getScreenSharingUser.length>0)&&!1===this.localUserPin),this.setState({layout:"Sidebar"})}},{key:"handleFullScreen",value:function(e){this.fullScreen=e,this.computeByResize()}},{key:"setLive",value:function(){var e=o(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===this.state.liveCountdown?St({header:"Stop broadcast",contentText:"Are you sure to stop broadcasting?",okText:"Stop",cancelText:"Cancel",onOk:function(){var e=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.core.setLive("stop");case 2:e.sent,t.setState({liveCountdown:-1});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},document.querySelector(".".concat(nr))):-1===this.state.liveCountdown&&this.setState({liveCountdown:3},(function(){setTimeout((function(){t.liveCountdownTimer()}),1e3)}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"liveCountdownTimer",value:function(){var e=this;this.setState((function(e){return{liveCountdown:e.liveCountdown-1}}),o(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.state.liveCountdown){t.next=6;break}return t.next=3,e.props.core.setLive("live");case 3:t.sent,t.next=7;break;case 6:setTimeout((function(){e.liveCountdownTimer()}),1e3);case 7:case"end":return t.stop()}}),t)}))))}},{key:"setAllSinkId",value:function(e){var t=document.querySelector(".".concat(nr));null===t||void 0===t||t.querySelectorAll("video").forEach((function(t){var r;null===t||void 0===t||null===(r=t.setSinkId)||void 0===r||r.call(t,e||"")})),null===t||void 0===t||t.querySelectorAll("audio").forEach((function(t){var r;null===t||void 0===t||null===(r=t.setSinkId)||void 0===r||r.call(t,e||"")}))}},{key:"render",value:function(){var e,t,r,i,s,a,c,u,l,d,h=this,p=this.state.notificationList.length<4?0:this.state.notificationList.length-2;return(0,ct.jsx)(rn.Provider,{value:{showPinButton:!!this.props.core._config.showPinButton&&this.getShownUser().length>1,speakerId:this.state.selectSpeaker,userInfo:{userID:this.props.core._expressConfig.userID}},children:(0,ct.jsxs)("div",{className:nr,children:[((null===(e=this.props.core._config.branding)||void 0===e?void 0:e.logoURL)||this.props.core._config.roomTimerDisplayed||(null===(t=this.props.core._config.scenario)||void 0===t?void 0:t.mode)===m.LiveStreaming)&&(0,ct.jsxs)("div",{className:ir,children:[(0,ct.jsxs)("div",{className:or,children:[(null===(r=this.props.core._config.branding)||void 0===r?void 0:r.logoURL)&&(0,ct.jsx)("img",{className:sr,src:null===(i=this.props.core._config.branding)||void 0===i?void 0:i.logoURL,alt:"logo"}),(null===(s=this.props.core._config.scenario)||void 0===s?void 0:s.mode)===m.LiveStreaming&&(0===this.state.liveCountdown||1==this.state.liveStatus)&&(0,ct.jsx)("div",{className:ar,children:"Live"})]}),(null===(a=this.props.core._config.scenario)||void 0===a?void 0:a.mode)===m.LiveStreaming&&(null===(c=this.props.core._config.scenario)||void 0===c||null===(u=c.config)||void 0===u?void 0:u.role)===g.Host&&(0,ct.jsx)("button",{className:"".concat(cr,"  ").concat(0===this.state.liveCountdown?ur:""),onClick:function(){h.setLive()},children:3===this.state.liveCountdown||-1===this.state.liveCountdown?"Go Live":0===this.state.liveCountdown?"Stop broadcast":"Start stream..."}),this.props.core._config.roomTimerDisplayed&&(0,ct.jsx)($r,{})]}),(0,ct.jsxs)("div",{className:lr,children:[(0,ct.jsxs)("div",{className:dr,children:[this.getLayoutScreen(),this.getHiddenUser(),(0,ct.jsx)("div",{className:Ur,children:this.state.notificationList.slice(p).map((function(e,t){return"MSG"===e.type?(0,ct.jsxs)("div",{className:xr,children:[(0,ct.jsx)("h5",{children:e.userName}),(0,ct.jsx)("span",{children:e.content})]},t):(0,ct.jsx)("div",{className:xr,children:(0,ct.jsx)("span",{className:Br,children:e.content})},t)}))}),this.state.isNetworkPoor&&(0,ct.jsx)("div",{className:hr})]}),(0,ct.jsxs)("div",{className:gr,style:{display:"ONE_VIDEO"!==this.state.layOutStatus?"flex":"none"},children:[(0,ct.jsxs)("div",{className:mr,children:["INVITE"===this.state.layOutStatus&&"Room details","USER_LIST"===this.state.layOutStatus&&"Room members","MESSAGE"===this.state.layOutStatus&&"Room messages",(0,ct.jsx)("span",{className:_r,onClick:function(){h.setState({layOutStatus:"ONE_VIDEO"})}})]}),(0,ct.jsxs)("div",{className:vr,children:["INVITE"===this.state.layOutStatus&&(0,ct.jsx)(Ci,{core:this.props.core}),"USER_LIST"===this.state.layOutStatus&&(0,ct.jsx)(Hi,{core:this.props.core,userList:this.getShownUser(!0),selfUserID:this.props.core._expressConfig.userID,handleSetPin:this.handleSetPin.bind(this),soundLevel:this.state.soundLevel}),"MESSAGE"===this.state.layOutStatus&&(0,ct.jsx)(jn,{messageList:this.state.messageList,sendMessage:function(e){h.sendMessage(e)},selfUserID:this.props.core._expressConfig.userID})]})]})]}),this.showScreenShareBottomTip&&(0,ct.jsxs)("div",{className:Yr,children:[(0,ct.jsxs)("div",{className:Qr,children:[(0,ct.jsx)("span",{}),(0,ct.jsx)("p",{children:this.state.isScreenSharingBySelf?"You're presenting to everyone":"".concat(this.state.screenSharingUserList[0].userName," is presenting the screen")})]}),this.state.isScreenSharingBySelf&&(0,ct.jsx)("div",{className:Kr,onClick:function(){h.toggleScreenSharing()},children:"Stop Presenting"})]}),(0,ct.jsxs)("div",{className:yr,children:[(0,ct.jsxs)("div",{className:Er,children:[this.props.core._config.showMyMicrophoneToggleButton&&(0,ct.jsx)("div",{className:"".concat(Rr," ").concat(!this.state.micOpen&&Or),onClick:function(){h.toggleMic()}}),this.props.core._config.showMyCameraToggleButton&&(0,ct.jsx)("div",{className:"".concat(kr," ").concat(!this.state.cameraOpen&&Or),onClick:function(){h.toggleCamera()}}),this.props.core._config.showScreenSharingButton&&(0,ct.jsx)("div",{className:"".concat(Ir," ").concat(this.state.isScreenSharingBySelf&&Lr),onClick:function(){h.toggleScreenSharing()}}),(this.props.core._config.showAudioVideoSettingsButton||this.props.core._config.showLayoutButton)&&(0,ct.jsx)("div",{ref:this.moreRef,className:wr,onClick:function(){h.openSettings()},children:(0,ct.jsxs)("div",{className:Dr,style:{display:this.state.showSettings?"block":"none"},ref:this.settingsRef,children:[this.props.core._config.showLayoutButton&&(0,ct.jsx)("div",{onClick:function(){return h.showLayoutSettings(!0)},children:"Change layout"}),this.props.core._config.showAudioVideoSettingsButton&&this.props.core._config.showLayoutButton&&(0,ct.jsx)("span",{}),this.props.core._config.showAudioVideoSettingsButton&&(0,ct.jsx)("div",{onClick:function(){return h.handleSetting()},children:"Settings"})]})}),(0,ct.jsx)("div",{className:(null===(l=this.props.core._config.scenario)||void 0===l?void 0:l.mode)===m.LiveStreaming?br:Sr,onClick:function(){h.handleLeave()}})]}),(0,ct.jsxs)("div",{className:Tr,children:[(null===(d=this.props.core._config.preJoinViewConfig)||void 0===d?void 0:d.invitationLink)&&(0,ct.jsx)("div",{className:Cr,onClick:function(){h.toggleLayOut("INVITE")}}),this.props.core._config.showUserList&&(0,ct.jsx)("div",{className:Ar,onClick:function(){h.toggleLayOut("USER_LIST")},children:(0,ct.jsx)("span",{className:Nr,children:this.state.zegoCloudUserList.length>99?"99+":this.state.zegoCloudUserList.length+1})}),this.props.core._config.showTextChat&&(0,ct.jsx)("div",{className:"".concat(Pr," ").concat(this.state.haveUnReadMsg?Mr:""),onClick:function(){h.setState({haveUnReadMsg:!1}),h.toggleLayOut("MESSAGE")}})]})]}),(0,ct.jsxs)("div",{className:pr,style:{display:this.state.connecting?"flex":"none",backgroundColor:this.state.firstLoading?"#1C1F2E":""},children:[(0,ct.jsx)("div",{}),(0,ct.jsx)("p",{children:this.state.firstLoading?"Joining Room":"There's something wrong with your network. Trying to reconnect..."})]}),(0,ct.jsx)("div",{className:fr,style:{display:this.state.liveCountdown>0?"flex":"none"},children:(0,ct.jsx)("div",{children:this.state.liveCountdown})}),this.state.showLayoutSettingsModel&&(0,ct.jsx)("div",{className:jr,children:(0,ct.jsxs)("div",{className:Hr,children:[(0,ct.jsxs)("div",{className:Gr,children:[(0,ct.jsx)("p",{children:"Change layout"}),(0,ct.jsx)("span",{className:zr,onClick:function(){return h.showLayoutSettings(!1)}})]}),(0,ct.jsxs)("div",{className:qr,children:[(0,ct.jsx)("div",{className:Vr,onClick:function(){return h.changeLayout("Auto")},children:(0,ct.jsxs)("p",{children:[(0,ct.jsx)("span",{className:"".concat(Fr," ").concat("Auto"===this.state.layout?Zr:""," ").concat(this.state.isLayoutChanging&&"Auto"===this.state.layout?Wr:"")}),"Auto"]})}),(0,ct.jsxs)("div",{className:Vr,onClick:function(){return h.changeLayout("Grid")},children:[(0,ct.jsxs)("p",{children:[(0,ct.jsx)("span",{className:"".concat(Fr," ").concat("Grid"===this.state.layout?Zr:""," ").concat(this.state.isLayoutChanging&&"Grid"===this.state.layout?Wr:"")}),"Grid"]}),(0,ct.jsx)("img",{src:__webpack_require__(5550),alt:"grid layout"})]}),(0,ct.jsxs)("div",{className:Vr,onClick:function(){return h.changeLayout("Sidebar")},children:[(0,ct.jsxs)("p",{children:[(0,ct.jsx)("span",{className:"".concat(Fr," ").concat("Sidebar"===this.state.layout?Zr:""," ").concat(this.state.isLayoutChanging&&"Sidebar"===this.state.layout?Wr:"")}),"Sidebar"]}),(0,ct.jsx)("img",{src:__webpack_require__(1636),alt:"Sidebar layout"})]})]})]})}),this.state.showZegoSettings&&(0,ct.jsx)(ht,{core:this.props.core,theme:"black",initDevices:{mic:this.state.selectMic,cam:this.state.selectCamera,speaker:this.state.selectSpeaker,videoResolve:this.state.selectVideoResolution,showNonVideoUser:this.state.showNonVideoUser},closeCallBack:function(){h.setState({showZegoSettings:!1})},onMicChange:function(e){h.setState({selectMic:e},(function(){h.state.localStream&&h.props.core.useMicrophoneDevice(h.state.localStream,e)}))},onCameraChange:function(e){h.setState({selectCamera:e},o(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h.state.localStream){t.next=4;break}return t.next=3,h.props.core.useCameraDevice(h.state.localStream,e);case 3:h.setState({cameraOpen:!0});case 4:case"end":return t.stop()}}),t)}))))},onSpeakerChange:function(e){h.setState({selectSpeaker:e},(function(){h.setAllSinkId(e)}))},onVideoResolutionChange:function(e){h.setState({selectVideoResolution:e},(function(){if(h.state.localStream){var t=F(e),r=t.width,n=t.height,i=t.bitrate,o=t.frameRate;h.props.core.setVideoConfig(h.state.localStream,{width:r,height:n,maxBitrate:i,frameRate:o})}}))},onShowNonVideoChange:function(e){h.props.core._config.showNonVideoUser=e,h.props.core.setShowNonVideo(e),h.setState({showNonVideoUser:e})}})]})})}}]),i}(e.PureComponent),qi={ZegoRoom:"ZegoRoomMobile_ZegoRoom__TjZR2",footer:"ZegoRoomMobile_footer__feV-i",switchCamera:"ZegoRoomMobile_switchCamera__mzxYh",toggleCamera:"ZegoRoomMobile_toggleCamera__wkxCh",cameraClose:"ZegoRoomMobile_cameraClose__ZSwaP",toggleMic:"ZegoRoomMobile_toggleMic__V6lKO",micClose:"ZegoRoomMobile_micClose__dACw4",leaveRoom:"ZegoRoomMobile_leaveRoom__bVCKU",liveLeaveButton:"ZegoRoomMobile_liveLeaveButton__aYVas",goLive:"ZegoRoomMobile_goLive__7FevQ",goLiveEnabled:"ZegoRoomMobile_goLiveEnabled__-Of8a",more:"ZegoRoomMobile_more__aKMmg",popMore:"ZegoRoomMobile_popMore__fj8Mv",popMoreContent:"ZegoRoomMobile_popMoreContent__IzM05",details:"ZegoRoomMobile_details__Lr35c",member:"ZegoRoomMobile_member__Wwi60",chat:"ZegoRoomMobile_chat__Fujxi",layout:"ZegoRoomMobile_layout__Zq3AP",popMoreArray:"ZegoRoomMobile_popMoreArray__Zs4hn",notify:"ZegoRoomMobile_notify__rjei1",notifyContent:"ZegoRoomMobile_notifyContent__WWlkg",network:"ZegoRoomMobile_network__8k6tr",countDown:"ZegoRoomMobile_countDown__4o3Zq",LiveStateButton:"ZegoRoomMobile_LiveStateButton__w9zTR",LiveStateButtonNoFooter:"ZegoRoomMobile_LiveStateButtonNoFooter__o6EDR",liveNotStart:"ZegoRoomMobile_liveNotStart__kYuoy",noOneStreaming:"ZegoRoomMobile_noOneStreaming__ahBOu",screenTopBar:"ZegoRoomMobile_screenTopBar__A+C1g",mask:"ZegoRoomMobile_mask__J6zz+",host:"ZegoRoomMobile_host__i8zxZ",audience:"ZegoRoomMobile_audience__3tklO"},Vi="zegoOne2One_bigVideo__iosJd",Fi="zegoOne2One_smallVideo__pHyPQ",Zi="zegoUserVideo_container__olG1Q",Wi="zegoUserVideo_videoCommon__jMNYu",Yi="zegoUserVideo_hideVideo__++x6C",Qi="zegoUserVideo_noVideoWrapper__gg67h",Ki="zegoUserVideo_nameWrapper__1sKsv",Ji="zegoUserVideo_nameCircle__yqsm-",Xi="zegoUserVideo_gridCircle__qm2Mh",$i="zegoUserVideo_sidebarCircle__eqw3A",eo="zegoUserVideo_othersNumber__zkYay",to="zegoUserVideo_bigVideo__eIAh1",ro="zegoUserVideo_name__VAu+D",no="zegoUserVideo_micIcon__FsN6Q",io="zegoUserVideo_close__ElnXG",oo="zegoMore_more__1N8dj",so=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).context=void 0,e}return c(r,[{key:"render",value:function(){var e=this,t=this.context,r=t.show,n=t.showPinButton;return(0,ct.jsx)("div",{style:{display:n?"block":"none"},className:"".concat(oo," zegoMore_more"),onClick:function(){r&&r(e.props.user)}})}}]),r}(e.PureComponent);so.contextType=rn;var ao=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).context=void 0,e}return c(r,[{key:"render",value:function(){var e,t,r,n,i,o,s,a,c,u,l=this,d=null===(e=this.props.volume)||void 0===e?void 0:e[null===(t=this.props.user)||void 0===t||null===(r=t.streamList)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.streamID],h=void 0===d?7:Math.ceil(7*d/100),p=this.context.userInfo;return(0,ct.jsxs)("div",{className:"".concat(Zi," zegoUserVideo_click"),children:[this.props.user.streamList&&this.props.user.streamList[0]&&(this.props.user.streamList[0].media||this.props.user.streamList[0].urlsHttpsFLV)&&(0,ct.jsx)(Tn,{muted:this.props.muted,userInfo:this.props.user,classList:"".concat(Wi," zegoUserVideo_videoCommon ").concat("MUTE"===this.props.user.streamList[0].cameraStatus?Yi:""),onCanPlay:function(){l.props.onCanPlay&&l.props.onCanPlay()}}),(!this.props.user.streamList||!this.props.user.streamList[0]||"MUTE"===this.props.user.streamList[0].cameraStatus)&&(0,ct.jsx)("div",{className:"".concat(Qi,"  zegoUserVideo_click ").concat(this.props.bigVideo?to:""),children:(0,ct.jsx)("div",{className:"".concat(Ki," zegoUserVideo_click"),children:(0,ct.jsxs)("div",{className:"".concat(Ji,"  zegoUserVideo_click  ").concat("SIDEBAR"===this.props.circleSize?$i:""),style:{color:q(this.props.user.userName)},children:[Y(this.props.user.userName||""),this.props.user.avatar&&(0,ct.jsx)("img",{src:this.props.user.avatar,onError:function(e){e.target.style.display="none"},alt:""})]},this.props.user.userID)})}),!this.props.hiddenName&&(0,ct.jsx)("div",{className:ro,children:(0,ct.jsxs)("div",{children:[(0,ct.jsx)("p",{className:this.props.user.overScreenMuteVideo?"muteVideo":"unmuteVideo",children:this.props.user.userName}),p.userID===this.props.user.userID&&(0,ct.jsx)("span",{children:"\uff08You\uff09"}),!(null!==(i=this.props.user)&&void 0!==i&&null!==(o=i.streamList)&&void 0!==o&&null!==(s=o[0])&&void 0!==s&&s.urlsHttpsFLV)&&(0,ct.jsx)("span",{className:"".concat(no,"  ").concat(this.props.user.streamList[0]&&"OPEN"===this.props.user.streamList[0].micStatus?"":io),children:"OPEN"===(null===(a=this.props.user)||void 0===a||null===(c=a.streamList)||void 0===c||null===(u=c[0])||void 0===u?void 0:u.micStatus)&&(0,ct.jsx)("span",{style:{height:h+"px"}})})]})}),!this.props.hiddenMore&&(0,ct.jsx)(so,{user:this.props.user})]})}}]),r}(e.PureComponent);ao.contextType=rn;var co=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){return(0,ct.jsxs)("div",{className:"".concat(Zi," zegoUserVideo_click"),children:[this.props.user.streamList&&this.props.user.streamList[0]&&(0,ct.jsx)(ti,{muted:!1,classList:Wi,userInfo:this.props.user},this.props.user.streamList[0].streamID),(0,ct.jsxs)("div",{className:"".concat(Qi," zegoUserVideo_click"),children:[(0,ct.jsxs)("div",{className:"".concat(Ki," zegoUserVideo_click"),children:[(0,ct.jsxs)("div",{className:"".concat(Ji," zegoUserVideo_click  ").concat("SIDEBAR"===this.props.circleSize?$i:Xi),style:{color:q(this.props.user.userName)},children:[Y(this.props.user.userName||""),this.props.user.avatar&&(0,ct.jsx)("img",{src:this.props.user.avatar,onError:function(e){e.target.style.display="none"},alt:""})]},this.props.user.userID),(0,ct.jsxs)("div",{className:"".concat(Ji,"  zegoUserVideo_click ").concat("SIDEBAR"===this.props.circleSize?$i:Xi),style:{color:q(this.props.nextUser.userName)},children:[Y(this.props.nextUser.userName||""),this.props.nextUser.avatar&&(0,ct.jsx)("img",{src:this.props.nextUser.avatar,onError:function(e){e.target.style.display="none"},alt:""})]},this.props.nextUser.userID)]}),(0,ct.jsxs)("p",{className:eo,children:[this.props.othersNumber," others"]})]})]})}}]),r}(e.PureComponent),uo=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"getVideoScreen",value:function(){var e,t,r,n,i,o,s=this;return this.props.userList.length>1?(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsx)("div",{className:Vi,children:(0,ct.jsx)(ao,{muted:(null===(e=this.props)||void 0===e||null===(t=e.selfInfo)||void 0===t?void 0:t.userID)===this.props.userList[1].userID,user:this.props.userList[1],onLocalStreamPaused:function(){s.props.onLocalStreamPaused&&s.props.onLocalStreamPaused()},volume:this.props.soundLevel[this.props.userList[1].userID]||{},bigVideo:!0})}),(0,ct.jsx)("div",{className:Fi,children:(0,ct.jsx)(ao,{muted:(null===(r=this.props)||void 0===r||null===(n=r.selfInfo)||void 0===n?void 0:n.userID)===this.props.userList[0].userID,volume:this.props.soundLevel[this.props.userList[0].userID]||{},user:this.props.userList[0],onLocalStreamPaused:function(){s.props.onLocalStreamPaused&&s.props.onLocalStreamPaused()}})})]}):this.props.userList.length>0?(0,ct.jsx)("div",{className:Vi,children:(0,ct.jsx)(ao,{muted:(null===(i=this.props)||void 0===i||null===(o=i.selfInfo)||void 0===o?void 0:o.userID)===this.props.userList[0].userID,volume:this.props.soundLevel[this.props.userList[0].userID]||{},user:this.props.userList[0],onLocalStreamPaused:function(){s.props.onLocalStreamPaused&&s.props.onLocalStreamPaused()},bigVideo:!0})}):void 0}},{key:"render",value:function(){return(0,ct.jsx)(ct.Fragment,{children:this.getVideoScreen()})}}]),r}(e.PureComponent),lo="zegoMessage_msgList__-gWED",ho="zegoMessage_msgListExpend__AkVyd",po="zegoMessage_msgListHeader__XfxMB",fo="zegoMessage_msgHide__kNJAv",go="zegoMessage_msgListContent__a5Oat",mo="zegoMessage_msgContent__Djmfl",_o="zegoMessage_msgContentRight__8mdCT",vo="zegoMessage_msgContentRightHeader__N1MyT",yo="zegoMessage_msgContentRightBody__n2ysy",Eo="zegoMessage_loading__OFw72",So="zegoMessage_sendFailed__KSgZ0",bo="zegoMessage_self__OWEUv",To="zegoMessage_msgFooter__3PDjk",Co="zegoMessage_readySend__aWEka",Ro=function(t){l(n,t);var r=f(n);function n(t){var i;return s(this,n),(i=r.call(this,t)).state={message:"",isFocus:!1},i.sendTime=0,i.msgContentListRef=void 0,i.isIOS=U(),i.isFireFox=j(),i.onFocus=function(e){i.isIOS&&(i.isFireFox?setTimeout((function(){e.target.scrollIntoView({block:"start"}),window.scrollTo(0,0)}),50):i.setState({isFocus:!0},(function(){var e;null===(e=i.msgContentListRef.current)||void 0===e||e.scroll(0,i.msgContentListRef.current.scrollHeight-i.msgContentListRef.current.clientHeight)})))},i.onBlur=function(e){i.isIOS&&(i.isFireFox?setTimeout((function(){e.target.scrollIntoView(!1),window.scrollTo(0,0)}),50):i.setState({isFocus:!1}))},i.msgContentListRef=e.createRef(),i}return c(n,[{key:"componentDidMount",value:function(){var e;null===(e=this.msgContentListRef.current)||void 0===e||e.scroll(0,this.msgContentListRef.current.scrollHeight-this.msgContentListRef.current.clientHeight)}},{key:"componentDidUpdate",value:function(e){var t;e.messageList.length!==this.props.messageList.length&&(null===(t=this.msgContentListRef.current)||void 0===t||t.scroll(0,this.msgContentListRef.current.scrollHeight-this.msgContentListRef.current.clientHeight))}},{key:"messageInput",value:function(e){this.setState({message:e.target.value.substring(0,300)})}},{key:"handleSend",value:function(){if(this.state.message.length){var e=(new Date).getTime();if(this.sendTime>0&&this.sendTime+900>e)return Ft({content:"Message sent too fast, please send again later"}),!1;this.props.sendMessage(this.state.message),this.setState({message:""}),this.sendTime=e}}},{key:"render",value:function(){var e=this;return(0,ct.jsxs)("div",{className:"".concat(lo," ").concat(this.state.isFocus?ho:""),children:[(0,ct.jsxs)("div",{className:po,children:[(0,ct.jsx)("div",{className:fo,onClick:function(t){t.stopPropagation(),e.props.closeCallBac()}}),"Chat"]}),(0,ct.jsx)("div",{className:go,ref:this.msgContentListRef,children:this.props.messageList.map((function(t){var r;return(0,ct.jsxs)("div",{className:"".concat(mo," ").concat(e.props.userID===t.fromUser.userID?bo:""),children:[(0,ct.jsxs)("i",{style:{color:q(t.fromUser.userName)},children:[null===(r=t.fromUser.userName)||void 0===r?void 0:r.substring(0,1),e.props.getAvatar(t.fromUser.userID)&&(0,ct.jsx)("img",{src:e.props.getAvatar(t.fromUser.userID),onError:function(e){e.target.style.display="none"},alt:""})]}),(0,ct.jsxs)("div",{className:_o,children:[(0,ct.jsxs)("div",{className:vo,children:[(0,ct.jsx)("span",{children:t.fromUser.userName}),e.props.userID===t.fromUser.userID&&(0,ct.jsx)("a",{children:"\uff08You\uff09"}),(0,ct.jsx)("span",{children:"".concat(new Date(t.sendTime).getHours()>=12?"PM":"AM","  ").concat(G(t.sendTime,"hh:mm"))})]}),(0,ct.jsxs)("div",{className:yo,children:[t.status&&(0,ct.jsx)("i",{className:"SENDING"===t.status?Eo:"SENDED"===t.status?"":So}),(0,ct.jsx)("p",{children:t.message})]})]})]},t.messageID)}))}),(0,ct.jsxs)("div",{className:To,children:[(0,ct.jsx)("input",{value:this.state.message,onChange:function(t){e.messageInput(t)},onFocus:this.onFocus,onBlur:this.onBlur,placeholder:"Send a message to everyone",onKeyPress:function(t){"Enter"===t.key&&e.handleSend()}}),(0,ct.jsx)("button",{className:this.state.message?Co:"",onClick:function(){e.handleSend()}})]})]})}}]),n}(e.PureComponent),Oo="zegoUserList_memberList__4-4wm",ko="zegoUserList_memberListHeader__lVMSc",Io="zegoUserList_memberHide__f0peM",Lo="zegoUserList_memberListContent__Htqrg",wo="zegoUserList_member__Rbjbb",Ao="zegoUserList_memberName__lx9cD",No="zegoUserList_memberHandlers__KIiv0",Po="zegoUserList_memberCameraMute__Pe-jf",Mo="zegoUserList_memberCameraOpen__3-5mv",Do="zegoUserList_memberMicMute__ttija",Uo="zegoUserList_memberMicOpen__kOA9J",xo="zegoUserList_memberUnPin__aLCxg",Bo="zegoUserList_memberPined__wkFlp",jo=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={message:""},e.context=void 0,e}return c(r,[{key:"messageInput",value:function(e){this.setState({message:e.target.value})}},{key:"isShownPin",value:function(e){var t;return(null===(t=this.props.core._config.scenario)||void 0===t?void 0:t.mode)!==m.OneONoneCall&&(this.context.showPinButton&&(this.props.core._config.showNonVideoUser||e.streamList&&e.streamList[0]&&"OPEN"===e.streamList[0].cameraStatus||e.streamList&&e.streamList[0]&&"OPEN"===e.streamList[0].micStatus&&!!this.props.core._config.showOnlyAudioUser))}},{key:"render",value:function(){var e=this;return(0,ct.jsxs)("div",{className:Oo,children:[(0,ct.jsxs)("div",{className:ko,children:[(0,ct.jsx)("div",{className:Io,onClick:function(t){t.stopPropagation(),e.props.closeCallBack()}}),"Member"]}),(0,ct.jsx)("div",{className:Lo,children:this.props.userList.map((function(t){return(0,ct.jsxs)("div",{className:wo,onClick:function(r){r.stopPropagation(),e.isShownPin(t)&&e.props.closeCallBack(t)},children:[(0,ct.jsxs)("div",{className:Ao,children:[(0,ct.jsxs)("i",{style:{color:q(t.userName)},children:[Y(t.userName||""),t.avatar&&(0,ct.jsx)("img",{src:t.avatar,onError:function(e){e.target.style.display="none"},alt:""})]}),(0,ct.jsx)("a",{style:{maxWidth:e.props.core._expressConfig.userID===t.userID?"30vw":"45vw"},children:t.userName},t.userID),e.props.core._expressConfig.userID===t.userID&&(0,ct.jsx)("a",{children:"\uff08You\uff09"},t.userID+"_me")]}),(0,ct.jsxs)("div",{className:No,children:[(0,ct.jsx)("i",{className:t.streamList&&t.streamList[0]&&"OPEN"===t.streamList[0].micStatus?Uo:Do}),(0,ct.jsx)("i",{className:t.streamList&&t.streamList[0]&&"OPEN"===t.streamList[0].cameraStatus?Mo:Po}),e.isShownPin(t)&&(0,ct.jsx)("i",{className:t.pin?Bo:xo})]})]},t.userID)}))})]})}}]),r}(e.PureComponent);jo.contextType=rn;var Ho="zegoRoomInvite_roomDetails__7vuK-",Go="zegoRoomInvite_inviteHeader__iJ0r3",zo="zegoRoomInvite_inviteHide__kG9Dh",qo="zegoRoomInvite_inviteLinkWrapper__0nR7L",Vo="zegoRoomInvite_title__pqMui",Fo="zegoRoomInvite_inviteLink__28DZH",Zo="zegoRoomInvite_copyLinkButton__FH3Xm",Wo=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){var e,t=this;return(0,ct.jsxs)("div",{className:Ho,children:[(0,ct.jsxs)("div",{className:Go,children:[(0,ct.jsx)("div",{className:zo,onClick:function(e){e.stopPropagation(),t.props.closeCallBack()}}),"Room details"]}),null===(e=this.props.core._config.sharedLinks)||void 0===e?void 0:e.map((function(e){return(0,ct.jsxs)("div",{className:qo,children:[(0,ct.jsx)("div",{className:Vo,children:e.name}),(0,ct.jsxs)("div",{className:Fo,children:[(0,ct.jsx)("input",{placeholder:"inviteLink",readOnly:!0,value:e.url}),(0,ct.jsx)("div",{className:Zo,onClick:function(t){t.stopPropagation(),e&&e.url&&I(e.url),Ft({content:"Copy successfully",duration:3e3})}})]})]},e.name)}))]})}}]),r}(e.PureComponent),Yo="ZegoReconnect_container__K9CG5",Qo="ZegoReconnect_loading__4nt3-",Ko=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){return(0,ct.jsxs)("div",{className:Yo,children:[(0,ct.jsx)("i",{className:Qo}),(0,ct.jsx)("p",{children:this.props.content})]})}}]),r}(e.PureComponent),Jo="zegoLayout_layoutList__tOHYr",Xo="zegoLayout_layoutHeader__hgZ3M",$o="zegoLayout_layoutHide__ACwJ1",es="zegoLayout_layoutListContent__99Uok",ts="zegoLayout_layoutContent__l8WwT",rs="zegoLayout_layoutContentLeft__my1hd",ns="zegoLayout_selected__ydMBw",is="zegoLayout_default__aQr0s",os="zegoLayout_grid__--Ud5",ss="zegoLayout_sidebar__Y5KTs",as=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={selectLayout:e.props.selectLayout||"Auto"},e.checking=!1,e}return c(r,[{key:"select",value:function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.selectCallBack||this.checking){e.next=7;break}return this.checking=!0,this.setState({selectLayout:t}),e.next=5,this.props.selectCallBack(t);case 5:e.sent,this.checking=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return(0,ct.jsxs)("div",{className:Jo,children:[(0,ct.jsxs)("div",{className:Xo,children:[(0,ct.jsx)("div",{className:$o,onClick:function(t){t.stopPropagation(),e.props.closeCallBac&&e.props.closeCallBac()}}),"Layout"]}),(0,ct.jsxs)("div",{className:es,children:[(0,ct.jsxs)("div",{className:ts,onClick:function(){e.select("Auto")},children:[(0,ct.jsxs)("div",{className:rs,children:[(0,ct.jsx)("i",{className:is}),(0,ct.jsx)("span",{children:"Auto"})]}),(0,ct.jsx)("a",{className:"Auto"===this.state.selectLayout?ns:"",children:" "})]}),(0,ct.jsxs)("div",{className:ts,onClick:function(){e.select("Grid")},children:[(0,ct.jsxs)("div",{className:rs,children:[(0,ct.jsx)("i",{className:os}),(0,ct.jsx)("span",{children:"Grid"})]}),(0,ct.jsx)("a",{className:"Grid"===this.state.selectLayout?ns:"",children:" "})]}),(0,ct.jsxs)("div",{className:ts,onClick:function(){e.select("Sidebar")},children:[(0,ct.jsxs)("div",{className:rs,children:[(0,ct.jsx)("i",{className:ss}),(0,ct.jsx)("span",{children:"Sidebar"})]}),(0,ct.jsx)("a",{className:"Sidebar"===this.state.selectLayout?ns:"",children:" "})]})]})]})}}]),r}(e.PureComponent),cs="zegoManage_manageList__BMmFw",us="zegoManage_manageHeader__Sfnzo",ls="zegoManage_manageHide__A4c8e",ds="zegoManage_manageListContent__rPv+7",hs="zegoManage_manageContent__AjJYZ",ps="zegoManage_manageContentLeft__9tcXh",fs="zegoManage_selected__oDzyA",gs=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"select",value:function(){var e=o(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.selectCallBac&&this.props.selectCallBac("Pin",r);case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return(0,ct.jsxs)("div",{className:cs,children:[(0,ct.jsxs)("div",{className:us,children:[this.props.selectedUser.userName,(0,ct.jsx)("div",{className:ls,onClick:function(t){t.stopPropagation(),e.props.closeCallBac&&e.props.closeCallBac()}})]}),(0,ct.jsx)("div",{className:ds,children:(0,ct.jsxs)("div",{className:hs,onClick:function(){e.select("Pin",!e.props.selectedUser.pin)},children:[(0,ct.jsxs)("div",{className:ps,children:[(0,ct.jsx)("i",{}),(0,ct.jsx)("span",{children:"Pin"})]}),(0,ct.jsx)("a",{className:this.props.selectedUser.pin?fs:"",children:" "})]})})]})}}]),r}(e.PureComponent),ms={gridWrapper:"zegoGrid_gridWrapper__5cVum",double:"zegoGrid_double__S1uVd",three:"zegoGrid_three__pA+Ln",six:"zegoGrid_six__Obwd2"},_s=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"render",value:function(){var e,t=this,r=Xn((b(e={},ms.gridWrapper,!0),b(e,ms.double,this.props.userList.length<=2),b(e,ms.three,4===this.props.userList.length||3===this.props.userList.length),b(e,ms.six,this.props.userList.length>=5),e));return(0,ct.jsx)("div",{className:"".concat(r," zegoUserVideo_click"),children:this.props.userList.map((function(e,r,n){var i,o;if(n.length>t.props.videoShowNumber){if(r===t.props.videoShowNumber-1)return(0,ct.jsx)(co,{user:e,circleSize:"GRID",nextUser:n[r+1],othersNumber:n.length-t.props.videoShowNumber+1},r);if(r>t.props.videoShowNumber-1)return e.streamList&&e.streamList[0]&&(0,ct.jsx)(ti,{muted:!1,classList:ms.videoCommon,userInfo:e},r+"_audio_"+e.userID)}return(0,ct.jsx)(ao,{muted:(null===(i=t.props)||void 0===i||null===(o=i.selfInfo)||void 0===o?void 0:o.userID)===e.userID,volume:t.props.soundLevel[e.userID]||{},user:e},e.userID+"_video")}))})}}]),r}(e.PureComponent),vs="zegoSidebar_sidebarWrapper__BD9sG",ys="zegoSidebar_bottomWrapper__undgQ",Es="zegoSidebar_screenLoadingWrapper__Mdjxx",Ss="zegoSidebar_upWrapper__C5Pnp",bs="zegoSidebar_fullScreen__NcAhg",Ts="zegoSidebar_videoCommon__GDLyy",Cs=function(e){l(r,e);var t=f(r);function r(){return s(this,r),t.apply(this,arguments)}return c(r,[{key:"userList",get:function(){var e=this;return this.props.userList.filter((function(t){return t.userID!==e.pinUser.userID}))}},{key:"pinUser",get:function(){var e=this,t=this.props.userList.findIndex((function(e){return e.pin}));if(t>-1)return this.props.userList[t];var r=this.props.userList.filter((function(t){var r;return t.userID!==(null===(r=e.props.selfInfo)||void 0===r?void 0:r.userID)}));return r[r.length-1]}},{key:"render",value:function(){var e,t,r=this;return(0,ct.jsxs)("div",{className:vs,children:[(0,ct.jsx)("div",{className:Ss,children:this.userList.map((function(e,t,n){var i,o;if(n.length>r.props.videoShowNumber-1){if(t===r.props.videoShowNumber-2)return(0,ct.jsx)(co,{user:e,circleSize:"SIDEBAR",nextUser:n[t+1],othersNumber:r.props.userList.length-r.props.videoShowNumber+1},e.userID+"_otherVideo");if(t>r.props.videoShowNumber-2)return e.streamList&&e.streamList[0]&&(0,ct.jsx)(ti,{muted:!1,classList:Ts,userInfo:e},t+"_audio_"+e.userID)}return(0,ct.jsx)(ao,{muted:(null===(i=r.props)||void 0===i||null===(o=i.selfInfo)||void 0===o?void 0:o.userID)===e.userID,user:e,circleSize:"SIDEBAR",volume:r.props.soundLevel[e.userID]||{}},e.userID+"_video")}))}),(0,ct.jsxs)("div",{className:ys,children:[(0,ct.jsx)(ao,{muted:(null===(e=this.props)||void 0===e||null===(t=e.selfInfo)||void 0===t?void 0:t.userID)===this.pinUser.userID,user:this.pinUser,volume:this.props.soundLevel[this.pinUser.userID]||{}},this.pinUser.userID+"_video"),";"]})]})}}]),r}(e.PureComponent),Rs=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={loading:!0},e}return c(r,[{key:"onCanPlay",value:function(){this.setState({loading:!1})}},{key:"render",value:function(){var e,t,r=this;return(0,ct.jsxs)("div",{className:"".concat(vs," ").concat(0===this.props.userList.length?bs:""),children:[(0,ct.jsx)("div",{className:Ss,children:this.props.userList.map((function(e,t,n){var i,o;if(n.length>r.props.videoShowNumber-1){if(t===r.props.videoShowNumber-2)return(0,ct.jsx)(co,{user:e,circleSize:"SIDEBAR",nextUser:n[t+1],othersNumber:n.length-r.props.videoShowNumber+2},e.userID+"_otherVideo");if(t>r.props.videoShowNumber-2)return e.streamList&&e.streamList[0]&&(0,ct.jsx)(ti,{muted:!1,classList:Ts,userInfo:e},t+"_audio_"+e.userID)}return(0,ct.jsx)(ao,{muted:(null===(i=r.props)||void 0===i||null===(o=i.selfInfo)||void 0===o?void 0:o.userID)===e.userID,user:e,circleSize:"SIDEBAR",volume:r.props.soundLevel[e.userID]||{}},e.userID+"_video")}))}),(0,ct.jsxs)("div",{className:ys,children:[(0,ct.jsx)(ao,{muted:(null===(e=this.props)||void 0===e||null===(t=e.selfInfo)||void 0===t?void 0:t.userID)===this.props.screenSharingUser.userID,user:this.props.screenSharingUser,volume:{},onCanPlay:function(){r.onCanPlay()},hiddenMore:!0,hiddenName:!0},this.props.screenSharingUser.userID+"_video"),this.state.loading&&(0,ct.jsxs)("div",{className:Es,children:[(0,ct.jsx)("span",{}),(0,ct.jsx)("p",{children:this.props.screenSharingUser.userName+" is presenting the screen"})]})]})]})}}]),r}(e.PureComponent),Os=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={micOpen:!!e.props.core._config.turnOnMicrophoneWhenJoining,cameraOpen:!!e.props.core._config.turnOnCameraWhenJoining,localStream:void 0,layOutStatus:"ONE_VIDEO",userLayoutStatus:e.props.core._config.layout||"Auto",zegoCloudUserList:[],memberList:[],messageList:[],notificationList:[],showMore:!1,connecting:!1,firstLoading:!0,cameraFront:!0,showFooter:!0,isNetworkPoor:!1,soundLevel:{},liveCountdown:-1,liveStatus:0,screenSharingUserList:[]},e.micStatus=e.props.core._config.turnOnMicrophoneWhenJoining?1:0,e.cameraStatus=e.props.core._config.turnOnCameraWhenJoining?1:0,e.localUserPin=!1,e.faceModel="user"===e.props.core._config.facingMode?1:0,e.notifyTimer=null,e.footerTimer=void 0,e.cameraDevices=[],e.userUpdateCallBack=function(){},e.localStreamID="",e.safariLimitationNoticed=-1,e.iosLimitationNoticed=0,e.showNotSupported=0,e.onblur=function(t){!t.path||t.path.includes(document.querySelector("#ZegoRoomCssMobileMore"))||t.path.includes(document.querySelector("#ZegoRoomCssMobilePopMore"))||(e.setState({showMore:!1}),document.removeEventListener("click",e.onblur))},e._selectedUser=void 0,e}return c(r,[{key:"isCDNLive",get:function(){var e,t;return(null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)===m.LiveStreaming&&(null===(t=this.props.core._config.scenario.config)||void 0===t?void 0:t.role)===g.Audience&&this.props.core._config.scenario.config.liveStreamingMode===v.StandardLive}},{key:"componentDidMount",value:function(){var e=this;this.initSDK(),this.footerTimer=setTimeout((function(){e.setState({showFooter:!1})}),5e3)}},{key:"componentWillUnmount",value:function(){this.state.localStream&&this.props.core.destroyStream(this.state.localStream)}},{key:"componentDidUpdate",value:function(e,t){var r=this;(t.notificationList.length>0&&this.state.notificationList.length>0&&t.notificationList[t.notificationList.length-1].messageID!==this.state.notificationList[this.state.notificationList.length-1].messageID||0===t.notificationList.length&&this.state.notificationList.length>0)&&(this.notifyTimer&&(clearTimeout(this.notifyTimer),this.notifyTimer=null),this.notifyTimer=setTimeout((function(){r.setState({notificationList:[]})}),3e3))}},{key:"initSDK",value:function(){var e=o(n().mark((function e(){var t,r,i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.core.onNetworkStatusQuality((function(e,t){i.setState({isNetworkPoor:t>2})})),this.props.core.onNetworkStatus((function(e,t,r){"DISCONNECTED"===r?(i.setState({connecting:!1,firstLoading:!1}),i.props.core.leaveRoom(),i.props.leaveRoom&&i.props.leaveRoom()):"CONNECTING"===r?i.setState({connecting:!0}):"CONNECTED"===r&&i.setState({connecting:!1,firstLoading:!1})})),this.props.core.onRemoteUserUpdate((function(e,t,r){var n,o=[];null!==(n=i.props.core._config.lowerLeftNotification)&&void 0!==n&&n.showUserJoinAndLeave&&r.map((function(e){o.push({content:e.userName+" "+("ADD"===t?"enter":"quite")+" the room",type:"USER",userName:e.userName,messageID:M(5)})})),i.setState((function(e){return{notificationList:[].concat(k(e.notificationList),o)}}))})),this.props.core.onRoomMessageUpdate((function(e,t){i.setState((function(e){var r,n=[];return"MESSAGE"!==i.state.layOutStatus&&null!==(r=i.props.core._config.lowerLeftNotification)&&void 0!==r&&r.showTextChat&&(n=[].concat(k(e.notificationList),k(t.map((function(e){return{content:e.message,type:"MSG",userName:e.fromUser.userName,messageID:e.messageID}}))))),{messageList:[].concat(k(e.messageList),k(t)),notificationList:n}}))})),this.props.core.subscribeUserList((function(e){if(i.userUpdateCallBack(),H()&&U()||i.isCDNLive){var t=JSON.parse(JSON.stringify(e)),r=t.filter((function(e){return e.streamList.length>0&&("OPEN"===e.streamList[0].cameraStatus||"OPEN"===e.streamList[0].micStatus)})).length,n=1;if(i.isCDNLive&&!U()&&(n=i.state.screenSharingUserList.length>0?5:6),r>n){var o=0,s=t.reverse().map((function(e){return e.streamList.length>0&&("OPEN"===e.streamList[0].cameraStatus||"OPEN"===e.streamList[0].micStatus)&&(o>=n?e.streamList=[]:o++),e})),a=s.reverse();return i.setState({zegoCloudUserList:s,memberList:a},(function(){i.handleLayoutChange(i.state.userLayoutStatus)})),i.isCDNLive||-1!==i.safariLimitationNoticed||(i.safariLimitationNoticed=0,St({header:"Notice",contentText:"The current browser does not support the display of multiple video screens, we suggest you change your browser.",okText:"Okay",onOk:function(){i.safariLimitationNoticed=1}})),void(U()&&i.isCDNLive&&0===i.iosLimitationNoticed&&(i.iosLimitationNoticed=1,St({header:"Notice",contentText:"Your current mobile system does not support the display of multiple video screens during the live streaming.",okText:"Okay"})))}}i.setState({zegoCloudUserList:e,memberList:e})})),this.props.core.subscribeScreenStream((function(e){var t=!D()&&U()&&(H()||i.isCDNLive)&&i.state.zegoCloudUserList.filter((function(e){return e.streamList.length>0&&("OPEN"===e.streamList[0].micStatus||"OPEN"===e.streamList[0].cameraStatus)})).length>0;i.setState({screenSharingUserList:t?[]:e},(function(){i.handleLayoutChange(i.state.userLayoutStatus)}))})),this.props.core.onSoundLevelUpdate((function(e){var t={};e.forEach((function(e){var r=e.streamID.split("_")[1];t[r]?t[r][e.streamID]=Math.floor(e.soundLevel):t[r]=b({},e.streamID,Math.floor(e.soundLevel))})),i.setState({soundLevel:t})})),this.props.core.onRoomLiveStateUpdate((function(e){i.setState((function(t){return{liveStatus:e,liveCountdown:-1===t.liveCountdown||0==t.liveCountdown?1==e?0:-1:t.liveCountdown}}),(function(){console.error("\u3010ZEGOCLOUD\u3011 liveStatus",i.state.liveStatus)}))})),this.props.core.onCoreError((function(e,t){if(e===E.notSupportStandardLive||e===E.notSupportCDNLive){if(i.showNotSupported)return;i.showNotSupported=1,St({header:"Notice",contentText:"The service is not available, please contact the live streaming service provider to resolve.",okText:"Okay"},document.querySelector(".".concat(qi.ZegoRoom)))}})),e.next=11,this.props.core.enterRoom();case 11:if(t=e.sent,r="",0!==t){e.next=19;break}return this.createStream(),setTimeout(o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.props.core._config.showMyCameraToggleButton,!e.t0){e.next=5;break}return e.next=4,i.props.core.getCameras();case 4:i.cameraDevices=e.sent;case 5:case"end":return e.stop()}}),e)}))),4e3),e.abrupt("return");case 19:r=1002034===t?"Failed to join the room, the number of people in the room has reached the maximum.(2 people)":[1002031,1002053].includes(t)?"There's something wrong with your network. Please check it and try again.":[1102018,1102016,1102020].includes(t)?"Failed to join the room, token authentication error.":1002056===t?"You are on a call in another room, please leave that room first.":"Failed to join the room, please try again.(error code:"+t+")";case 20:St({header:"Login room Failed",contentText:r,okText:"OK"});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createStream",value:function(){var e=o(n().mark((function e(){var t,r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.core._config.turnOnCameraWhenJoining||this.props.core._config.turnOnMicrophoneWhenJoining||this.props.core._config.showMyCameraToggleButton||this.props.core._config.showMyMicrophoneToggleButton){e.next=2;break}return e.abrupt("return",!1);case 2:if(this.props.core.status.videoRefuse&&this.props.core.status.audioRefuse){e.next=34;break}return e.prev=3,t=null,e.prev=5,r=F(this.props.core._config.videoResolutionList[0]),e.next=9,this.props.core.createStream({camera:C({video:!this.props.core.status.videoRefuse,audio:!this.props.core.status.audioRefuse,videoQuality:4,facingMode:this.faceModel?"user":"environment"},r)});case 9:t=e.sent,e.next=18;break;case 12:if(e.prev=12,e.t0=e.catch(5),!JSON.stringify(e.t0).includes("constrain")){e.next=18;break}return e.next=17,this.props.core.createStream({camera:{video:!this.props.core.status.videoRefuse,audio:!this.props.core.status.audioRefuse,facingMode:this.faceModel?"user":"environment"}});case 17:t=e.sent;case 18:if(t){e.next=20;break}return e.abrupt("return",!1);case 20:return this.props.core.mutePublishStreamVideo(t,!this.props.core._config.turnOnCameraWhenJoining),this.props.core.muteMicrophone(!this.props.core._config.turnOnMicrophoneWhenJoining),this.setState({localStream:t}),!1!==(i=this.props.core.publishLocalStream(t))&&(this.localStreamID=i,this.props.core.setStreamExtraInfo(i,JSON.stringify({isCameraOn:!!this.props.core._config.turnOnCameraWhenJoining,isMicrophoneOn:this.props.core._config.turnOnMicrophoneWhenJoining,hasVideo:!this.props.core.status.videoRefuse,hasAudio:!this.props.core.status.audioRefuse}))),e.abrupt("return",!0);case 28:return e.prev=28,e.t1=e.catch(3),console.error("\u3010ZEGOCLOUD\u3011createStream or publishLocalStream failed,Reason: ",JSON.stringify(e.t1)),e.abrupt("return",!1);case 32:e.next=35;break;case 34:return e.abrupt("return",!1);case 35:case"end":return e.stop()}}),e,this,[[3,28],[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"toggleMic",value:function(){var e=o(n().mark((function e(){var t,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.core.status.audioRefuse){e.next=3;break}return Xt({title:"Equipment authorization",content:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",confirm:"Okay"}),e.abrupt("return");case 3:if(-1!==this.micStatus){e.next=5;break}return e.abrupt("return");case 5:if(this.micStatus=-1,!(this.state.localStream&&this.state.localStream.getAudioTracks().length>0)){e.next=11;break}return e.next=9,this.props.core.muteMicrophone(this.state.micOpen);case 9:t=e.sent,this.props.core.setStreamExtraInfo(this.localStreamID,JSON.stringify({isCameraOn:this.state.cameraOpen,isMicrophoneOn:!this.state.micOpen,hasVideo:!this.props.core.status.videoRefuse,hasAudio:!this.props.core.status.audioRefuse}));case 11:this.micStatus=this.state.micOpen?0:1,t&&(Ft({content:"The microphone is "+(this.micStatus?"on":"off")}),t&&this.setState({micOpen:!!this.micStatus},(function(){r.handleLayoutChange(r.state.userLayoutStatus)})));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleCamera",value:function(){var e=o(n().mark((function e(){var t,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.core.status.videoRefuse){e.next=3;break}return Xt({title:"Equipment authorization",content:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",confirm:"Okay"}),e.abrupt("return");case 3:if(-1!==this.cameraStatus){e.next=5;break}return e.abrupt("return");case 5:if(this.cameraStatus=-1,!(this.state.localStream&&this.state.localStream.getVideoTracks().length>0)){e.next=11;break}return e.next=9,this.props.core.mutePublishStreamVideo(this.state.localStream,this.state.cameraOpen);case 9:t=e.sent,this.props.core.setStreamExtraInfo(this.localStreamID,JSON.stringify({isCameraOn:!this.state.cameraOpen,isMicrophoneOn:this.state.micOpen,hasVideo:!this.props.core.status.videoRefuse,hasAudio:!this.props.core.status.audioRefuse}));case 11:this.cameraStatus=this.state.cameraOpen?0:1,t&&(Ft({content:"The camera is "+(this.cameraStatus?"on":"off")}),t&&this.setState({cameraOpen:!!this.cameraStatus},(function(){r.handleLayoutChange(r.state.userLayoutStatus)})));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"switchCamera",value:function(){var e=o(n().mark((function e(){var t,r,i,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.core.status.videoRefuse){e.next=3;break}return Xt({title:"Equipment authorization",content:"We can't detect your devices. Please check your devices and allow us access your devices in your browser's address bar. Then reload this page and try again.",confirm:"Okay"}),e.abrupt("return");case 3:if(this.state.localStream&&!(this.cameraDevices.length<2)){e.next=5;break}return e.abrupt("return");case 5:if(t=!1,-1!==this.faceModel){e.next=10;break}return e.abrupt("return");case 10:0===this.faceModel&&(t=!0);case 11:return this.faceModel=-1,this.state.localStream.getVideoTracks()[0].stop(),this.state.localStream.getAudioTracks()[0].stop(),e.prev=14,r=F(this.props.core._config.videoResolutionList[0]),e.next=18,this.props.core.createStream({camera:C({video:!this.props.core.status.videoRefuse,audio:!this.props.core.status.audioRefuse,videoQuality:4,facingMode:this.state.cameraFront?"environment":"user"},r)});case 18:return i=e.sent,o=i.getVideoTracks()[0],!this.state.cameraOpen&&(o.enabled=!1),s=i.getAudioTracks()[0],e.next=24,this.props.core.replaceTrack(this.state.localStream,o);case 24:return e.next=26,this.props.core.replaceTrack(this.state.localStream,s);case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(14),console.error("\u3010ZEGOCLOUD\u3011switch camera failed!",e.t0);case 31:this.faceModel=t?1:0,this.setState({cameraFront:t});case 33:case"end":return e.stop()}}),e,this,[[14,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"toggleLayOut",value:function(e){this.setState((function(t){return{layOutStatus:t.layOutStatus===e?"ONE_VIDEO":e,showMore:!1}}))}},{key:"sendMessage",value:function(){var e=o(n().mark((function e(t){var r,i,o=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=M(3),this.setState((function(e){return{messageList:[].concat(k(e.messageList),[{fromUser:{userID:o.props.core._expressConfig.userID,userName:o.props.core._expressConfig.userName},message:t,sendTime:Date.now(),messageID:r,status:"SENDING"}])}})),i={},e.prev=3,e.next=6,this.props.core.sendRoomMessage(t);case 6:i=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("\u3010ZEGOCLOUD\u3011sendMessage failed!",JSON.stringify(e.t0));case 12:this.setState((function(e){var t=e.messageList.map((function(e){return e.messageID===r&&(e.status=0===i.errorCode?"SENDED":"FAILED"),e}));return console.log(t),{messageList:t}}));case 13:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"openMore",value:function(){var e=this;this.setState((function(e){return{showMore:!e.showMore}}),(function(){e.state.showMore?document.addEventListener("click",e.onblur):document.removeEventListener("click",e.onblur)}))}},{key:"leaveRoom",value:function(){var e=this;Xt({title:"Leave the room",content:"Are you sure to leave the room?",cancel:"Cancel",confirm:"Confirm",closeCallBack:function(t){t&&(e.props.core._config.turnOnCameraWhenJoining=e.state.cameraOpen,e.props.core._config.turnOnMicrophoneWhenJoining=e.state.micOpen,e.state.localStream&&e.props.core.destroyStream(e.state.localStream),e.props.core.leaveRoom(),e.props.leaveRoom&&e.props.leaveRoom())}})}},{key:"getAllUser",value:function(){return[{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName,pin:this.localUserPin,avatar:this.props.core._expressConfig.avatar,streamList:[{media:this.state.localStream,fromUser:{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName},micStatus:this.state.micOpen?"OPEN":"MUTE",cameraStatus:this.state.cameraOpen?"OPEN":"MUTE",state:"PLAYING",streamID:this.localStreamID}]}].concat(k(this.state.zegoCloudUserList))}},{key:"getAllMemberList",value:function(){return[{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName,pin:this.localUserPin,avatar:this.props.core._expressConfig.avatar,streamList:[{media:this.state.localStream,fromUser:{userID:this.props.core._expressConfig.userID,userName:this.props.core._expressConfig.userName},micStatus:this.state.micOpen?"OPEN":"MUTE",cameraStatus:this.state.cameraOpen?"OPEN":"MUTE",state:"PLAYING",streamID:this.localStreamID}]}].concat(k(this.state.memberList))}},{key:"getShownUser",value:function(){var e=this,t=this.getAllUser().filter((function(t){return!!e.props.core._config.showNonVideoUser||!!(t.streamList&&t.streamList[0]&&(t.streamList[0].media||t.streamList[0].urlsHttpsFLV||t.streamList[0].urlsHttpsHLS))&&("OPEN"===t.streamList[0].cameraStatus||!(!e.props.core._config.showOnlyAudioUser||"OPEN"!==t.streamList[0].micStatus))}));return this._selectedUser&&!t.some((function(t){return t.userID===e._selectedUser.userID}))&&"MANAGE"===this.state.layOutStatus&&this.setState({layOutStatus:"ONE_VIDEO"}),t}},{key:"getHiddenUser",value:function(){var e=this,t=this.getAllUser().filter((function(t){return!(e.props.core._config.showNonVideoUser||!t.streamList||!t.streamList[0]||!(t.streamList[0].media||t.streamList[0].urlsHttpsFLV||t.streamList[0].urlsHttpsHLS)||"OPEN"===t.streamList[0].cameraStatus||e.props.core._config.showOnlyAudioUser||"OPEN"!==t.streamList[0].micStatus)}));return(0,ct.jsx)(ct.Fragment,{children:t.map((function(t){return(0,ct.jsx)(ti,{muted:t.userID===e.props.core._expressConfig.userID,userInfo:t},t.userID+"_hiddenAudio")}))})}},{key:"showSelf",get:function(){return!!this.props.core._config.showNonVideoUser||(this.props.core._config.showOnlyAudioUser?this.localStreamID&&(this.state.micOpen||this.state.cameraOpen):this.localStreamID&&this.state.cameraOpen)}},{key:"handleLayoutChange",value:function(){var e=o(n().mark((function e(t){var r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"Sidebar"!==t&&(this._selectedUser&&(this._selectedUser.pin=!1),this.localUserPin=!1,this.props.core.setPin(void 0,void 0,!0)),this.setState({userLayoutStatus:t}),e.abrupt("return",new Promise(function(){var e=o(n().mark((function e(i,o){var s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.state.screenSharingUserList.length){e.next=5;break}return e.next=3,r.props.core.setMaxScreenNum(r.showSelf?3:4,!0);case 3:case 8:e.next=12;break;case 5:if("Sidebar"===t){e.next=10;break}return e.next=8,r.props.core.setMaxScreenNum(r.showSelf?5:6,!0);case 10:return e.next=12,r.props.core.setMaxScreenNum(r.showSelf?4:5,!0);case 12:return r.userUpdateCallBack=function(){i(!0)},setTimeout((function(){i(!1)}),5e3),s=!1,"Sidebar"===t&&(s=!r.state.cameraOpen&&!r.state.micOpen||!r.localUserPin),e.next=18,r.props.core.setSidebarLayOut(!(r.state.screenSharingUserList.length>0)&&s);case 18:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getListScreen",value:function(){var e,t=this;if("INVITE"===this.state.layOutStatus?e=(0,ct.jsx)(Wo,{core:this.props.core,closeCallBack:function(){t.setState({layOutStatus:"ONE_VIDEO"})}}):"USER_LIST"===this.state.layOutStatus?e=(0,ct.jsx)(jo,{core:this.props.core,userList:this.getAllMemberList(),closeCallBack:function(e){e&&(t._selectedUser=e),t.setState({layOutStatus:e?"MANAGE":"ONE_VIDEO"})}}):"MESSAGE"===this.state.layOutStatus?e=(0,ct.jsx)(Ro,{userID:this.props.core._expressConfig.userID,messageList:this.state.messageList,sendMessage:function(e){t.sendMessage(e)},getAvatar:function(e){var r=t.getAllMemberList().find((function(t){return t.userID===e}));return(null===r||void 0===r?void 0:r.avatar)||""},closeCallBac:function(){t.setState({layOutStatus:"ONE_VIDEO"})}}):"LAYOUT"===this.state.layOutStatus?e=(0,ct.jsx)(as,{selectLayout:this.state.userLayoutStatus,closeCallBac:function(){t.setState({layOutStatus:"ONE_VIDEO"})},selectCallBack:this.handleLayoutChange.bind(this)}):"MANAGE"===this.state.layOutStatus&&(e=(0,ct.jsx)(gs,{closeCallBac:function(){t.setState({layOutStatus:"ONE_VIDEO"})},selectCallBac:function(e,r){"Pin"===e&&"undefined"!=typeof r&&(t._selectedUser.userID!==t.props.core._expressConfig.userID?(t.props.core.setPin(t._selectedUser.userID,r),t.localUserPin=!1):(t.localUserPin=r,t._selectedUser.pin=r,t.props.core.setPin()),t.setState({userLayoutStatus:"Sidebar"},(function(){t.handleLayoutChange("Sidebar")})),t.props.core.setSidebarLayOut(!(t.state.screenSharingUserList.length>0)&&!t.localUserPin))},selectedUser:this._selectedUser})),e)return(0,ct.jsx)("div",{className:"".concat(qi.mask,"  zegocloud_layout_Mask"),onClick:function(e){e.target.className.includes("zegocloud_layout_Mask")&&t.setState({layOutStatus:"ONE_VIDEO"})},children:e})}},{key:"getLayoutScreen",value:function(){var e,t,r,i,s=this;if((null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)===m.LiveStreaming&&(null===(t=this.props.core._config.scenario)||void 0===t||null===(r=t.config)||void 0===r?void 0:r.role)===g.Audience&&1!=this.state.liveStatus)return(0,ct.jsxs)("div",{className:"".concat(qi.liveNotStart," zegoUserVideo_click"),children:[(0,ct.jsx)("i",{}),(0,ct.jsx)("span",{children:"The Live has not started yet"})]});if(![].concat(k(this.getAllUser()),k(this.state.screenSharingUserList)).some((function(e){return!!e.streamList&&e.streamList.some((function(e){return"OPEN"===e.cameraStatus||"OPEN"===e.micStatus}))}))&&(null===(i=this.props.core._config.scenario)||void 0===i?void 0:i.mode)===m.LiveStreaming)return(0,ct.jsxs)("div",{className:"".concat(qi.noOneStreaming," zegoUserVideo_click"),children:[(0,ct.jsx)("i",{}),(0,ct.jsx)("span",{children:"No one has turned on the camera or microphone yet."})]});if(this.state.screenSharingUserList.length>0){var a,c=this.getAllMemberList().filter((function(e){return e.userID===s.state.screenSharingUserList[0].userID}));return(0,ct.jsxs)(ct.Fragment,{children:[(0,ct.jsxs)("div",{className:qi.screenTopBar,children:[(0,ct.jsxs)("span",{style:{color:q(this.state.screenSharingUserList[0].userName)},children:[Y(this.state.screenSharingUserList[0].userName||""),(null===c||void 0===c||null===(a=c[0])||void 0===a?void 0:a.avatar)&&(0,ct.jsx)("img",{src:c[0].avatar,onError:function(e){e.target.style.display="none"},alt:""})]}),(0,ct.jsx)("p",{children:this.state.screenSharingUserList[0].userName+" is presenting"})]}),(0,ct.jsx)(Rs,{selfInfo:{userID:this.props.core._expressConfig.userID},userList:this.getShownUser(),screenSharingUser:this.state.screenSharingUserList[0],videoShowNumber:5,soundLevel:this.state.soundLevel})]})}return"Auto"===this.state.userLayoutStatus&&this.getShownUser().length<3||this.getShownUser().length<2?(0,ct.jsx)(uo,{selfInfo:{userID:this.props.core._expressConfig.userID},userList:this.getShownUser(),soundLevel:this.state.soundLevel,onLocalStreamPaused:o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("onLocalStreamPaused"),e.next=3,s.props.core.enableVideoCaptureDevice(s.state.localStream,!s.state.cameraOpen);case 3:s.props.core.enableVideoCaptureDevice(s.state.localStream,s.state.cameraOpen);case 4:case"end":return e.stop()}}),e)})))}):"Grid"===this.state.userLayoutStatus&&this.getShownUser().length>1||"Auto"===this.state.userLayoutStatus&&this.getShownUser().length>2?(0,ct.jsx)(_s,{selfInfo:{userID:this.props.core._expressConfig.userID},userList:this.getShownUser(),videoShowNumber:6,soundLevel:this.state.soundLevel}):"Sidebar"===this.state.userLayoutStatus&&this.getShownUser().length>1?(0,ct.jsx)(Cs,{selfInfo:{userID:this.props.core._expressConfig.userID},userList:this.getShownUser(),videoShowNumber:5,soundLevel:this.state.soundLevel}):void 0}},{key:"clickVideo",value:function(e){var t=this,r=e.target.className;r.includes("zegoUserVideo_videoCommon")||r.includes("zegoMore_more")||r.includes("ZegoRoomMobile_ZegoRoom")||r.includes("zegoUserVideo_click")?(this.state.showFooter?"ONE_VIDEO"!=this.state.layOutStatus?(this.setState({layOutStatus:"ONE_VIDEO"}),clearTimeout(this.footerTimer),this.footerTimer=setTimeout((function(){t.setState({showFooter:!1,showMore:!1})}),5e3)):this.setState({showFooter:!1,showMore:!1}):this.setState({showFooter:!0}),e.stopPropagation()):(clearTimeout(this.footerTimer),this.footerTimer=setTimeout((function(){!t.state.showMore&&t.setState({showFooter:!1,showMore:!1})}),5e3))}},{key:"setLive",value:function(){var e=o(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===this.state.liveCountdown?St({header:"Stop broadcast",contentText:"Are you sure to stop broadcasting?",okText:"Stop",cancelText:"Cancel",onOk:function(){var e=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.core.setLive("stop");case 2:e.sent,t.setState({liveCountdown:-1});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}):-1===this.state.liveCountdown&&this.setState({liveCountdown:3},(function(){setTimeout((function(){t.liveCountdownTimer()}),1e3)}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"liveCountdownTimer",value:function(){var e=this;this.setState((function(e){return{liveCountdown:e.liveCountdown-1}}),o(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.state.liveCountdown){t.next=6;break}return t.next=3,e.props.core.setLive("live");case 3:t.sent,t.next=7;break;case 6:setTimeout((function(){e.liveCountdownTimer()}),1e3);case 7:case"end":return t.stop()}}),t)}))))}},{key:"render",value:function(){var e,t,r,n,i,o,s,a,c,u,l,d,h,p,f,_=this,v=this.state.notificationList.length<4?0:this.state.notificationList.length-2;return(0,ct.jsx)(rn.Provider,{value:{show:function(e){e&&(_._selectedUser=e),_.setState({layOutStatus:e?"MANAGE":"ONE_VIDEO"})},showPinButton:!!this.props.core._config.showPinButton&&this.getShownUser().length>1,userInfo:{userID:this.props.core._expressConfig.userID}},children:(0,ct.jsxs)("div",{className:"".concat(qi.ZegoRoom,"  ZegoRoomMobile_ZegoRoom ").concat((null===(e=this.props.core._config.scenario)||void 0===e?void 0:e.mode)===m.LiveStreaming&&(null===(t=this.props.core._config.scenario)||void 0===t||null===(r=t.config)||void 0===r?void 0:r.role)===g.Host?qi.host:(null===(n=this.props.core._config.scenario)||void 0===n||null===(i=n.config)||void 0===i?void 0:i.role)===g.Audience?qi.audience:""),onClick:function(e){_.clickVideo(e)},children:[this.getLayoutScreen(),this.state.isNetworkPoor&&(0,ct.jsx)("div",{className:qi.network}),!!this.state.showFooter&&(0,ct.jsxs)("div",{className:qi.footer,children:[this.props.core._config.showMyCameraToggleButton&&((null===(o=this.props.core._config.scenario)||void 0===o?void 0:o.mode)!==m.LiveStreaming||(null===(s=this.props.core._config.scenario)||void 0===s||null===(a=s.config)||void 0===a?void 0:a.role)===g.Cohost)&&(0,ct.jsx)("a",{className:"".concat(qi.switchCamera),onClick:function(){_.switchCamera()}}),this.props.core._config.showMyCameraToggleButton&&(0,ct.jsx)("a",{className:this.state.cameraOpen?qi.toggleCamera:qi.cameraClose,onClick:function(){_.toggleCamera()}}),this.props.core._config.showMyMicrophoneToggleButton&&(0,ct.jsx)("a",{className:this.state.micOpen?qi.toggleMic:qi.micClose,onClick:function(){_.toggleMic()}}),(0,ct.jsx)("a",{className:(null===(c=this.props.core._config.scenario)||void 0===c?void 0:c.mode)===m.LiveStreaming?qi.liveLeaveButton:qi.leaveRoom,onClick:function(){_.leaveRoom()}}),(this.props.core._config.showTextChat||this.props.core._config.showUserList||this.props.core._config.sharedLinks)&&(0,ct.jsxs)("a",{id:"ZegoRoomCssMobileMore",className:qi.more,onClick:function(){_.openMore()},children:[!!this.state.showMore&&(0,ct.jsx)("div",{id:"ZegoRoomCssMobilePopMore",className:"".concat(qi.popMore," ").concat(qi.popLiveMore),children:(0,ct.jsxs)("div",{className:qi.popMoreContent,children:[this.props.core._config.showMyCameraToggleButton&&(null===(u=this.props.core._config.scenario)||void 0===u?void 0:u.mode)===m.LiveStreaming&&(null===(l=this.props.core._config.scenario.config)||void 0===l?void 0:l.role)===g.Host&&(0,ct.jsxs)("div",{className:"".concat(qi.switchCamera," zegoUserVideo_click"),onClick:function(){_.switchCamera()},children:[(0,ct.jsx)("i",{className:"".concat(qi.switchCamera," zegoUserVideo_click")}),(0,ct.jsx)("span",{children:"Flip"})]}),(null===(d=this.props.core._config.preJoinViewConfig)||void 0===d?void 0:d.invitationLink)&&(0,ct.jsxs)("div",{className:qi.roomDetail,onClick:function(e){e.stopPropagation(),_.toggleLayOut("INVITE")},children:[(0,ct.jsx)("i",{className:qi.details}),(0,ct.jsx)("span",{children:"Room details"})]}),this.props.core._config.showUserList&&(0,ct.jsxs)("div",{onClick:function(e){e.stopPropagation(),_.toggleLayOut("USER_LIST")},children:[(0,ct.jsx)("i",{className:qi.member}),(0,ct.jsx)("span",{children:"Member"})]}),this.props.core._config.showTextChat&&(0,ct.jsxs)("div",{onClick:function(e){e.stopPropagation(),_.toggleLayOut("MESSAGE")},children:[(0,ct.jsx)("i",{className:qi.chat}),(0,ct.jsx)("span",{children:"Chat"})]}),this.props.core._config.showLayoutButton&&(0,ct.jsxs)("div",{onClick:function(e){e.stopPropagation(),_.toggleLayOut("LAYOUT")},children:[(0,ct.jsx)("i",{className:qi.layout}),(0,ct.jsx)("span",{children:"Layout"})]})]})}),!!this.state.showMore&&(0,ct.jsx)("div",{className:qi.popMoreArray})]}),(null===(h=this.props.core._config.scenario)||void 0===h?void 0:h.mode)===m.LiveStreaming&&(null===(p=this.props.core._config.scenario.config)||void 0===p?void 0:p.role)===g.Host&&(0,ct.jsx)("a",{className:"".concat(qi.goLive,"  ").concat(0===this.state.liveCountdown?qi.goLiveEnabled:""),onClick:function(){_.setLive()},children:3===this.state.liveCountdown||-1===this.state.liveCountdown?"Go Live":0===this.state.liveCountdown?"Stop":"Go Live"})]}),this.getListScreen(),(0,ct.jsx)(ct.Fragment,{children:this.getHiddenUser()}),(0,ct.jsx)("div",{className:qi.notify,children:this.state.notificationList.slice(v).map((function(e){return"MSG"===e.type?(0,ct.jsxs)("div",{className:qi.notifyContent,children:[(0,ct.jsx)("h5",{children:e.userName}),(0,ct.jsx)("span",{children:e.content})]},e.content):(0,ct.jsx)("div",{className:qi.notifyContent,children:(0,ct.jsx)("span",{children:e.content})},e.content)}))}),this.state.liveCountdown>0&&(0,ct.jsx)("div",{className:qi.countDown,children:(0,ct.jsx)("div",{children:this.state.liveCountdown})}),!!this.state.connecting&&(0,ct.jsx)(Ko,{content:this.state.firstLoading?"Joining Room":"Trying to reconnect..."}),(null===(f=this.props.core._config.scenario)||void 0===f?void 0:f.mode)===m.LiveStreaming&&(0===this.state.liveCountdown||1==this.state.liveStatus)&&(0,ct.jsx)("button",{className:"".concat(qi.LiveStateButton,"  ").concat(this.state.showFooter?"":qi.LiveStateButtonNoFooter),children:"Live"})]})})}}]),r}(e.PureComponent);Os.contextType=rn;var ks=function(e,t){return ks=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},ks(e,t)};function Is(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ks(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Ls=function(){return Ls=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ls.apply(this,arguments)};Object.create;function ws(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}Object.create;__webpack_require__(9053);var As=e.createContext(null),Ns=(As.Consumer,As.Provider);var Ps,Ms,Ds;function Us(e,t,r){if(void 0===r&&(r=Error),!e)throw new r(t)}function xs(e){return e.type===Ms.literal}function Bs(e){return e.type===Ms.argument}function js(e){return e.type===Ms.number}function Hs(e){return e.type===Ms.date}function Gs(e){return e.type===Ms.time}function zs(e){return e.type===Ms.select}function qs(e){return e.type===Ms.plural}function Vs(e){return e.type===Ms.pound}function Fs(e){return e.type===Ms.tag}function Zs(e){return!(!e||"object"!==typeof e||e.type!==Ds.number)}function Ws(e){return!(!e||"object"!==typeof e||e.type!==Ds.dateTime)}!function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(Ps||(Ps={})),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(Ms||(Ms={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(Ds||(Ds={}));var Ys=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,Qs=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function Ks(e){var t={};return e.replace(Qs,(function(e){var r=e.length;switch(e[0]){case"G":t.era=4===r?"long":5===r?"narrow":"short";break;case"y":t.year=2===r?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][r-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][r-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===r?"short":5===r?"narrow":"short";break;case"e":if(r<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][r-4];break;case"c":if(r<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][r-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][r-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][r-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][r-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][r-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][r-1];break;case"s":t.second=["numeric","2-digit"][r-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=r<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),t}var Js=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;var Xs=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,$s=/^(@+)?(\+|#+)?[rs]?$/g,ea=/(\*)(0+)|(#+)(0+)|(0+)/g,ta=/^(0+)$/;function ra(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace($s,(function(e,r,n){return"string"!==typeof n?(t.minimumSignificantDigits=r.length,t.maximumSignificantDigits=r.length):"+"===n?t.minimumSignificantDigits=r.length:"#"===r[0]?t.maximumSignificantDigits=r.length:(t.minimumSignificantDigits=r.length,t.maximumSignificantDigits=r.length+("string"===typeof n?n.length:0)),""})),t}function na(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function ia(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var r=e.slice(0,2);if("+!"===r?(t.signDisplay="always",e=e.slice(2)):"+?"===r&&(t.signDisplay="exceptZero",e=e.slice(2)),!ta.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function oa(e){var t=na(e);return t||{}}function sa(e){for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];switch(i.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=i.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=i.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=Ls(Ls(Ls({},t),{notation:"scientific"}),i.options.reduce((function(e,t){return Ls(Ls({},e),oa(t))}),{}));continue;case"engineering":t=Ls(Ls(Ls({},t),{notation:"engineering"}),i.options.reduce((function(e,t){return Ls(Ls({},e),oa(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(i.options[0]);continue;case"integer-width":if(i.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");i.options[0].replace(ea,(function(e,r,n,i,o,s){if(r)t.minimumIntegerDigits=n.length;else{if(i&&o)throw new Error("We currently do not support maximum integer digits");if(s)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(ta.test(i.stem))t.minimumIntegerDigits=i.stem.length;else if(Xs.test(i.stem)){if(i.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");i.stem.replace(Xs,(function(e,r,n,i,o,s){return"*"===n?t.minimumFractionDigits=r.length:i&&"#"===i[0]?t.maximumFractionDigits=i.length:o&&s?(t.minimumFractionDigits=o.length,t.maximumFractionDigits=o.length+s.length):(t.minimumFractionDigits=r.length,t.maximumFractionDigits=r.length),""}));var o=i.options[0];"w"===o?t=Ls(Ls({},t),{trailingZeroDisplay:"stripIfInteger"}):o&&(t=Ls(Ls({},t),ra(o)))}else if($s.test(i.stem))t=Ls(Ls({},t),ra(i.stem));else{var s=na(i.stem);s&&(t=Ls(Ls({},t),s));var a=ia(i.stem);a&&(t=Ls(Ls({},t),a))}}return t}var aa,ca={AX:["H"],BQ:["H"],CP:["H"],CZ:["H"],DK:["H"],FI:["H"],ID:["H"],IS:["H"],ML:["H"],NE:["H"],RU:["H"],SE:["H"],SJ:["H"],SK:["H"],AS:["h","H"],BT:["h","H"],DJ:["h","H"],ER:["h","H"],GH:["h","H"],IN:["h","H"],LS:["h","H"],PG:["h","H"],PW:["h","H"],SO:["h","H"],TO:["h","H"],VU:["h","H"],WS:["h","H"],"001":["H","h"],AL:["h","H","hB"],TD:["h","H","hB"],"ca-ES":["H","h","hB"],CF:["H","h","hB"],CM:["H","h","hB"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],LU:["H","h","hB"],NP:["H","h","hB"],PF:["H","h","hB"],SC:["H","h","hB"],SM:["H","h","hB"],SN:["H","h","hB"],TF:["H","h","hB"],VA:["H","h","hB"],CY:["h","H","hb","hB"],GR:["h","H","hb","hB"],CO:["h","H","hB","hb"],DO:["h","H","hB","hb"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],NA:["h","H","hB","hb"],PA:["h","H","hB","hb"],PR:["h","H","hB","hb"],VE:["h","H","hB","hb"],AC:["H","h","hb","hB"],AI:["H","h","hb","hB"],BW:["H","h","hb","hB"],BZ:["H","h","hb","hB"],CC:["H","h","hb","hB"],CK:["H","h","hb","hB"],CX:["H","h","hb","hB"],DG:["H","h","hb","hB"],FK:["H","h","hb","hB"],GB:["H","h","hb","hB"],GG:["H","h","hb","hB"],GI:["H","h","hb","hB"],IE:["H","h","hb","hB"],IM:["H","h","hb","hB"],IO:["H","h","hb","hB"],JE:["H","h","hb","hB"],LT:["H","h","hb","hB"],MK:["H","h","hb","hB"],MN:["H","h","hb","hB"],MS:["H","h","hb","hB"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],PN:["H","h","hb","hB"],SH:["H","h","hb","hB"],SX:["H","h","hb","hB"],TA:["H","h","hb","hB"],ZA:["H","h","hb","hB"],"af-ZA":["H","h","hB","hb"],AR:["H","h","hB","hb"],CL:["H","h","hB","hb"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],EA:["H","h","hB","hb"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],GT:["H","h","hB","hb"],HN:["H","h","hB","hb"],IC:["H","h","hB","hb"],KG:["H","h","hB","hb"],KM:["H","h","hB","hb"],LK:["H","h","hB","hb"],MA:["H","h","hB","hb"],MX:["H","h","hB","hb"],NI:["H","h","hB","hb"],PY:["H","h","hB","hb"],SV:["H","h","hB","hb"],UY:["H","h","hB","hb"],JP:["H","h","K"],AD:["H","hB"],AM:["H","hB"],AO:["H","hB"],AT:["H","hB"],AW:["H","hB"],BE:["H","hB"],BF:["H","hB"],BJ:["H","hB"],BL:["H","hB"],BR:["H","hB"],CG:["H","hB"],CI:["H","hB"],CV:["H","hB"],DE:["H","hB"],EE:["H","hB"],FR:["H","hB"],GA:["H","hB"],GF:["H","hB"],GN:["H","hB"],GP:["H","hB"],GW:["H","hB"],HR:["H","hB"],IL:["H","hB"],IT:["H","hB"],KZ:["H","hB"],MC:["H","hB"],MD:["H","hB"],MF:["H","hB"],MQ:["H","hB"],MZ:["H","hB"],NC:["H","hB"],NL:["H","hB"],PM:["H","hB"],PT:["H","hB"],RE:["H","hB"],RO:["H","hB"],SI:["H","hB"],SR:["H","hB"],ST:["H","hB"],TG:["H","hB"],TR:["H","hB"],WF:["H","hB"],YT:["H","hB"],BD:["h","hB","H"],PK:["h","hB","H"],AZ:["H","hB","h"],BA:["H","hB","h"],BG:["H","hB","h"],CH:["H","hB","h"],GE:["H","hB","h"],LI:["H","hB","h"],ME:["H","hB","h"],RS:["H","hB","h"],UA:["H","hB","h"],UZ:["H","hB","h"],XK:["H","hB","h"],AG:["h","hb","H","hB"],AU:["h","hb","H","hB"],BB:["h","hb","H","hB"],BM:["h","hb","H","hB"],BS:["h","hb","H","hB"],CA:["h","hb","H","hB"],DM:["h","hb","H","hB"],"en-001":["h","hb","H","hB"],FJ:["h","hb","H","hB"],FM:["h","hb","H","hB"],GD:["h","hb","H","hB"],GM:["h","hb","H","hB"],GU:["h","hb","H","hB"],GY:["h","hb","H","hB"],JM:["h","hb","H","hB"],KI:["h","hb","H","hB"],KN:["h","hb","H","hB"],KY:["h","hb","H","hB"],LC:["h","hb","H","hB"],LR:["h","hb","H","hB"],MH:["h","hb","H","hB"],MP:["h","hb","H","hB"],MW:["h","hb","H","hB"],NZ:["h","hb","H","hB"],SB:["h","hb","H","hB"],SG:["h","hb","H","hB"],SL:["h","hb","H","hB"],SS:["h","hb","H","hB"],SZ:["h","hb","H","hB"],TC:["h","hb","H","hB"],TT:["h","hb","H","hB"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],VC:["h","hb","H","hB"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],ZM:["h","hb","H","hB"],BO:["H","hB","h","hb"],EC:["H","hB","h","hb"],ES:["H","hB","h","hb"],GQ:["H","hB","h","hb"],PE:["H","hB","h","hb"],AE:["h","hB","hb","H"],"ar-001":["h","hB","hb","H"],BH:["h","hB","hb","H"],DZ:["h","hB","hb","H"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],HK:["h","hB","hb","H"],IQ:["h","hB","hb","H"],JO:["h","hB","hb","H"],KW:["h","hB","hb","H"],LB:["h","hB","hb","H"],LY:["h","hB","hb","H"],MO:["h","hB","hb","H"],MR:["h","hB","hb","H"],OM:["h","hB","hb","H"],PH:["h","hB","hb","H"],PS:["h","hB","hb","H"],QA:["h","hB","hb","H"],SA:["h","hB","hb","H"],SD:["h","hB","hb","H"],SY:["h","hB","hb","H"],TN:["h","hB","hb","H"],YE:["h","hB","hb","H"],AF:["H","hb","hB","h"],LA:["H","hb","hB","h"],CN:["H","hB","hb","h"],LV:["H","hB","hb","h"],TL:["H","hB","hb","h"],"zu-ZA":["H","hB","hb","h"],CD:["hB","H"],IR:["hB","H"],"hi-IN":["hB","h","H"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"te-IN":["hB","h","H"],KH:["hB","h","H","hb"],"ta-IN":["hB","h","hb","H"],BN:["hb","hB","h","H"],MY:["hb","hB","h","H"],ET:["hB","hb","h","H"],"gu-IN":["hB","hb","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],TW:["hB","hb","h","H"],KE:["hB","hb","H","h"],MM:["hB","hb","H","h"],TZ:["hB","hb","H","h"],UG:["hB","hb","H","h"]};function ua(e){var t=e.hourCycle;if(void 0===t&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var r,n=e.language;return"root"!==n&&(r=e.maximize().region),(ca[r||""]||ca[n||""]||ca["".concat(n,"-001")]||ca["001"])[0]}var la=new RegExp("^".concat(Ys.source,"*")),da=new RegExp("".concat(Ys.source,"*$"));function ha(e,t){return{start:e,end:t}}var pa=!!String.prototype.startsWith,fa=!!String.fromCodePoint,ga=!!Object.fromEntries,ma=!!String.prototype.codePointAt,_a=!!String.prototype.trimStart,va=!!String.prototype.trimEnd,ya=!!Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},Ea=!0;try{Ea="a"===(null===(aa=Ia("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===aa?void 0:aa[0])}catch(lu){Ea=!1}var Sa,ba=pa?function(e,t,r){return e.startsWith(t,r)}:function(e,t,r){return e.slice(r,r+t.length)===t},Ta=fa?String.fromCodePoint:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r,n="",i=e.length,o=0;i>o;){if((r=e[o++])>1114111)throw RangeError(r+" is not a valid code point");n+=r<65536?String.fromCharCode(r):String.fromCharCode(55296+((r-=65536)>>10),r%1024+56320)}return n},Ca=ga?Object.fromEntries:function(e){for(var t={},r=0,n=e;r<n.length;r++){var i=n[r],o=i[0],s=i[1];t[o]=s}return t},Ra=ma?function(e,t){return e.codePointAt(t)}:function(e,t){var r=e.length;if(!(t<0||t>=r)){var n,i=e.charCodeAt(t);return i<55296||i>56319||t+1===r||(n=e.charCodeAt(t+1))<56320||n>57343?i:n-56320+(i-55296<<10)+65536}},Oa=_a?function(e){return e.trimStart()}:function(e){return e.replace(la,"")},ka=va?function(e){return e.trimEnd()}:function(e){return e.replace(da,"")};function Ia(e,t){return new RegExp(e,t)}if(Ea){var La=Ia("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");Sa=function(e,t){var r;return La.lastIndex=t,null!==(r=La.exec(e)[1])&&void 0!==r?r:""}}else Sa=function(e,t){for(var r=[];;){var n=Ra(e,t);if(void 0===n||Na(n)||Pa(n))break;r.push(n),t+=n>=65536?2:1}return Ta.apply(void 0,r)};var wa=function(){function e(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.locale=t.locale,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return e.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(e,t,r){for(var n=[];!this.isEOF();){var i=this.char();if(123===i){if((o=this.parseArgument(e,r)).err)return o;n.push(o.val)}else{if(125===i&&e>0)break;if(35!==i||"plural"!==t&&"selectordinal"!==t){if(60===i&&!this.ignoreTag&&47===this.peek()){if(r)break;return this.error(Ps.UNMATCHED_CLOSING_TAG,ha(this.clonePosition(),this.clonePosition()))}if(60===i&&!this.ignoreTag&&Aa(this.peek()||0)){if((o=this.parseTag(e,t)).err)return o;n.push(o.val)}else{var o;if((o=this.parseLiteral(e,t)).err)return o;n.push(o.val)}}else{var s=this.clonePosition();this.bump(),n.push({type:Ms.pound,location:ha(s,this.clonePosition())})}}}return{val:n,err:null}},e.prototype.parseTag=function(e,t){var r=this.clonePosition();this.bump();var n=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Ms.literal,value:"<".concat(n,"/>"),location:ha(r,this.clonePosition())},err:null};if(this.bumpIf(">")){var i=this.parseMessage(e+1,t,!0);if(i.err)return i;var o=i.val,s=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!Aa(this.char()))return this.error(Ps.INVALID_TAG,ha(s,this.clonePosition()));var a=this.clonePosition();return n!==this.parseTagName()?this.error(Ps.UNMATCHED_CLOSING_TAG,ha(a,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Ms.tag,value:n,children:o,location:ha(r,this.clonePosition())},err:null}:this.error(Ps.INVALID_TAG,ha(s,this.clonePosition())))}return this.error(Ps.UNCLOSED_TAG,ha(r,this.clonePosition()))}return this.error(Ps.INVALID_TAG,ha(r,this.clonePosition()))},e.prototype.parseTagName=function(){var e,t=this.offset();for(this.bump();!this.isEOF()&&(45===(e=this.char())||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039);)this.bump();return this.message.slice(t,this.offset())},e.prototype.parseLiteral=function(e,t){for(var r=this.clonePosition(),n="";;){var i=this.tryParseQuote(t);if(i)n+=i;else{var o=this.tryParseUnquoted(e,t);if(o)n+=o;else{var s=this.tryParseLeftAngleBracket();if(!s)break;n+=s}}}var a=ha(r,this.clonePosition());return{val:{type:Ms.literal,value:n,location:a},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(Aa(e=this.peek()||0)||47===e)?null:(this.bump(),"<");var e},e.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var r=this.char();if(39===r){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(r);this.bump()}return Ta.apply(void 0,t)},e.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var r=this.char();return 60===r||123===r||35===r&&("plural"===t||"selectordinal"===t)||125===r&&e>0?null:(this.bump(),Ta(r))},e.prototype.parseArgument=function(e,t){var r=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(Ps.EXPECT_ARGUMENT_CLOSING_BRACE,ha(r,this.clonePosition()));if(125===this.char())return this.bump(),this.error(Ps.EMPTY_ARGUMENT,ha(r,this.clonePosition()));var n=this.parseIdentifierIfPossible().value;if(!n)return this.error(Ps.MALFORMED_ARGUMENT,ha(r,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(Ps.EXPECT_ARGUMENT_CLOSING_BRACE,ha(r,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Ms.argument,value:n,location:ha(r,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(Ps.EXPECT_ARGUMENT_CLOSING_BRACE,ha(r,this.clonePosition())):this.parseArgumentOptions(e,t,n,r);default:return this.error(Ps.MALFORMED_ARGUMENT,ha(r,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),r=Sa(this.message,t),n=t+r.length;return this.bumpTo(n),{value:r,location:ha(e,this.clonePosition())}},e.prototype.parseArgumentOptions=function(e,t,r,n){var i,o=this.clonePosition(),s=this.parseIdentifierIfPossible().value,a=this.clonePosition();switch(s){case"":return this.error(Ps.EXPECT_ARGUMENT_TYPE,ha(o,a));case"number":case"date":case"time":this.bumpSpace();var c=null;if(this.bumpIf(",")){this.bumpSpace();var u=this.clonePosition();if((_=this.parseSimpleArgStyleIfPossible()).err)return _;if(0===(p=ka(_.val)).length)return this.error(Ps.EXPECT_ARGUMENT_STYLE,ha(this.clonePosition(),this.clonePosition()));c={style:p,styleLocation:ha(u,this.clonePosition())}}if((v=this.tryParseArgumentClose(n)).err)return v;var l=ha(n,this.clonePosition());if(c&&ba(null===c||void 0===c?void 0:c.style,"::",0)){var d=Oa(c.style.slice(2));if("number"===s)return(_=this.parseNumberSkeletonFromString(d,c.styleLocation)).err?_:{val:{type:Ms.number,value:r,location:l,style:_.val},err:null};if(0===d.length)return this.error(Ps.EXPECT_DATE_TIME_SKELETON,l);var h=d;this.locale&&(h=function(e,t){for(var r="",n=0;n<e.length;n++){var i=e.charAt(n);if("j"===i){for(var o=0;n+1<e.length&&e.charAt(n+1)===i;)o++,n++;var s=1+(1&o),a=o<2?1:3+(o>>1),c=ua(t);for("H"!=c&&"k"!=c||(a=0);a-- >0;)r+="a";for(;s-- >0;)r=c+r}else r+="J"===i?"H":i}return r}(d,this.locale));var p={type:Ds.dateTime,pattern:h,location:c.styleLocation,parsedOptions:this.shouldParseSkeletons?Ks(h):{}};return{val:{type:"date"===s?Ms.date:Ms.time,value:r,location:l,style:p},err:null}}return{val:{type:"number"===s?Ms.number:"date"===s?Ms.date:Ms.time,value:r,location:l,style:null!==(i=null===c||void 0===c?void 0:c.style)&&void 0!==i?i:null},err:null};case"plural":case"selectordinal":case"select":var f=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(Ps.EXPECT_SELECT_ARGUMENT_OPTIONS,ha(f,Ls({},f)));this.bumpSpace();var g=this.parseIdentifierIfPossible(),m=0;if("select"!==s&&"offset"===g.value){if(!this.bumpIf(":"))return this.error(Ps.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,ha(this.clonePosition(),this.clonePosition()));var _;if(this.bumpSpace(),(_=this.tryParseDecimalInteger(Ps.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,Ps.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return _;this.bumpSpace(),g=this.parseIdentifierIfPossible(),m=_.val}var v,y=this.tryParsePluralOrSelectOptions(e,s,t,g);if(y.err)return y;if((v=this.tryParseArgumentClose(n)).err)return v;var E=ha(n,this.clonePosition());return"select"===s?{val:{type:Ms.select,value:r,options:Ca(y.val),location:E},err:null}:{val:{type:Ms.plural,value:r,options:Ca(y.val),offset:m,pluralType:"plural"===s?"cardinal":"ordinal",location:E},err:null};default:return this.error(Ps.INVALID_ARGUMENT_TYPE,ha(o,a))}},e.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(Ps.EXPECT_ARGUMENT_CLOSING_BRACE,ha(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();){switch(this.char()){case 39:this.bump();var r=this.clonePosition();if(!this.bumpUntil("'"))return this.error(Ps.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,ha(r,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}}return{val:this.message.slice(t.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(e,t){var r=[];try{r=function(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=[],r=0,n=e.split(Js).filter((function(e){return e.length>0}));r<n.length;r++){var i=n[r].split("/");if(0===i.length)throw new Error("Invalid number skeleton");for(var o=i[0],s=i.slice(1),a=0,c=s;a<c.length;a++)if(0===c[a].length)throw new Error("Invalid number skeleton");t.push({stem:o,options:s})}return t}(e)}catch(n){return this.error(Ps.INVALID_NUMBER_SKELETON,t)}return{val:{type:Ds.number,tokens:r,location:t,parsedOptions:this.shouldParseSkeletons?sa(r):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(e,t,r,n){for(var i,o=!1,s=[],a=new Set,c=n.value,u=n.location;;){if(0===c.length){var l=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var d=this.tryParseDecimalInteger(Ps.EXPECT_PLURAL_ARGUMENT_SELECTOR,Ps.INVALID_PLURAL_ARGUMENT_SELECTOR);if(d.err)return d;u=ha(l,this.clonePosition()),c=this.message.slice(l.offset,this.offset())}if(a.has(c))return this.error("select"===t?Ps.DUPLICATE_SELECT_ARGUMENT_SELECTOR:Ps.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,u);"other"===c&&(o=!0),this.bumpSpace();var h=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?Ps.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:Ps.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,ha(this.clonePosition(),this.clonePosition()));var p=this.parseMessage(e+1,t,r);if(p.err)return p;var f=this.tryParseArgumentClose(h);if(f.err)return f;s.push([c,{value:p.val,location:ha(h,this.clonePosition())}]),a.add(c),this.bumpSpace(),c=(i=this.parseIdentifierIfPossible()).value,u=i.location}return 0===s.length?this.error("select"===t?Ps.EXPECT_SELECT_ARGUMENT_SELECTOR:Ps.EXPECT_PLURAL_ARGUMENT_SELECTOR,ha(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!o?this.error(Ps.MISSING_OTHER_CLAUSE,ha(this.clonePosition(),this.clonePosition())):{val:s,err:null}},e.prototype.tryParseDecimalInteger=function(e,t){var r=1,n=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(r=-1);for(var i=!1,o=0;!this.isEOF();){var s=this.char();if(!(s>=48&&s<=57))break;i=!0,o=10*o+(s-48),this.bump()}var a=ha(n,this.clonePosition());return i?ya(o*=r)?{val:o,err:null}:this.error(t,a):this.error(e,a)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=Ra(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},e.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},e.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},e.prototype.bumpIf=function(e){if(ba(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(e){var t=this.offset(),r=this.message.indexOf(e,t);return r>=0?(this.bumpTo(r),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&Na(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),r=this.message.charCodeAt(t+(e>=65536?2:1));return null!==r&&void 0!==r?r:null},e}();function Aa(e){return e>=97&&e<=122||e>=65&&e<=90}function Na(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function Pa(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function Ma(e){e.forEach((function(e){if(delete e.location,zs(e)||qs(e))for(var t in e.options)delete e.options[t].location,Ma(e.options[t].value);else js(e)&&Zs(e.style)||(Hs(e)||Gs(e))&&Ws(e.style)?delete e.style.location:Fs(e)&&Ma(e.children)}))}function Da(e,t){void 0===t&&(t={}),t=Ls({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var r=new wa(e,t).parse();if(r.err){var n=SyntaxError(Ps[r.err.kind]);throw n.location=r.err.location,n.originalMessage=r.err.message,n}return(null===t||void 0===t?void 0:t.captureLocation)||Ma(r.val),r.val}function Ua(e,t){var r=t&&t.cache?t.cache:Va,n=t&&t.serializer?t.serializer:Ga;return(t&&t.strategy?t.strategy:Ha)(e,{cache:r,serializer:n})}function xa(e,t,r,n){var i,o=null==(i=n)||"number"===typeof i||"boolean"===typeof i?n:r(n),s=t.get(o);return"undefined"===typeof s&&(s=e.call(this,n),t.set(o,s)),s}function Ba(e,t,r){var n=Array.prototype.slice.call(arguments,3),i=r(n),o=t.get(i);return"undefined"===typeof o&&(o=e.apply(this,n),t.set(i,o)),o}function ja(e,t,r,n,i){return r.bind(t,e,n,i)}function Ha(e,t){return ja(e,this,1===e.length?xa:Ba,t.cache.create(),t.serializer)}var Ga=function(){return JSON.stringify(arguments)};function za(){this.cache=Object.create(null)}za.prototype.get=function(e){return this.cache[e]},za.prototype.set=function(e,t){this.cache[e]=t};var qa,Va={create:function(){return new za}},Fa={variadic:function(e,t){return ja(e,this,Ba,t.cache.create(),t.serializer)},monadic:function(e,t){return ja(e,this,xa,t.cache.create(),t.serializer)}};!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(qa||(qa={}));var Za,Wa=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.code=r,i.originalMessage=n,i}return Is(t,e),t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),Ya=function(e){function t(t,r,n,i){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(r,'". Options are "').concat(Object.keys(n).join('", "'),'"'),qa.INVALID_VALUE,i)||this}return Is(t,e),t}(Wa),Qa=function(e){function t(t,r,n){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(r),qa.INVALID_VALUE,n)||this}return Is(t,e),t}(Wa),Ka=function(e){function t(t,r){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(r,'"'),qa.MISSING_VALUE,r)||this}return Is(t,e),t}(Wa);function Ja(e){return"function"===typeof e}function Xa(e,t,r,n,i,o,s){if(1===e.length&&xs(e[0]))return[{type:Za.literal,value:e[0].value}];for(var a=[],c=0,u=e;c<u.length;c++){var l=u[c];if(xs(l))a.push({type:Za.literal,value:l.value});else if(Vs(l))"number"===typeof o&&a.push({type:Za.literal,value:r.getNumberFormat(t).format(o)});else{var d=l.value;if(!i||!(d in i))throw new Ka(d,s);var h=i[d];if(Bs(l))h&&"string"!==typeof h&&"number"!==typeof h||(h="string"===typeof h||"number"===typeof h?String(h):""),a.push({type:"string"===typeof h?Za.literal:Za.object,value:h});else if(Hs(l)){var p="string"===typeof l.style?n.date[l.style]:Ws(l.style)?l.style.parsedOptions:void 0;a.push({type:Za.literal,value:r.getDateTimeFormat(t,p).format(h)})}else if(Gs(l)){p="string"===typeof l.style?n.time[l.style]:Ws(l.style)?l.style.parsedOptions:n.time.medium;a.push({type:Za.literal,value:r.getDateTimeFormat(t,p).format(h)})}else if(js(l)){(p="string"===typeof l.style?n.number[l.style]:Zs(l.style)?l.style.parsedOptions:void 0)&&p.scale&&(h*=p.scale||1),a.push({type:Za.literal,value:r.getNumberFormat(t,p).format(h)})}else{if(Fs(l)){var f=l.children,g=l.value,m=i[g];if(!Ja(m))throw new Qa(g,"function",s);var _=m(Xa(f,t,r,n,i,o).map((function(e){return e.value})));Array.isArray(_)||(_=[_]),a.push.apply(a,_.map((function(e){return{type:"string"===typeof e?Za.literal:Za.object,value:e}})))}if(zs(l)){if(!(v=l.options[h]||l.options.other))throw new Ya(l.value,h,Object.keys(l.options),s);a.push.apply(a,Xa(v.value,t,r,n,i))}else if(qs(l)){var v;if(!(v=l.options["=".concat(h)])){if(!Intl.PluralRules)throw new Wa('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',qa.MISSING_INTL_API,s);var y=r.getPluralRules(t,{type:l.pluralType}).select(h-(l.offset||0));v=l.options[y]||l.options.other}if(!v)throw new Ya(l.value,h,Object.keys(l.options),s);a.push.apply(a,Xa(v.value,t,r,n,i,h-(l.offset||0)))}else;}}}return function(e){return e.length<2?e:e.reduce((function(e,t){var r=e[e.length-1];return r&&r.type===Za.literal&&t.type===Za.literal?r.value+=t.value:e.push(t),e}),[])}(a)}function $a(e,t){return t?Object.keys(e).reduce((function(r,n){var i,o;return r[n]=(i=e[n],(o=t[n])?Ls(Ls(Ls({},i||{}),o||{}),Object.keys(i).reduce((function(e,t){return e[t]=Ls(Ls({},i[t]),o[t]||{}),e}),{})):i),r}),Ls({},e)):e}function ec(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,r){e[t]=r}}}}}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(Za||(Za={}));var tc,rc=function(){function e(t,r,n,i){var o,s=this;if(void 0===r&&(r=e.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=s.formatToParts(e);if(1===t.length)return t[0].value;var r=t.reduce((function(e,t){return e.length&&t.type===Za.literal&&"string"===typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e}),[]);return r.length<=1?r[0]||"":r},this.formatToParts=function(e){return Xa(s.ast,s.locales,s.formatters,s.formats,e,void 0,s.message)},this.resolvedOptions=function(){var e;return{locale:(null===(e=s.resolvedLocale)||void 0===e?void 0:e.toString())||Intl.NumberFormat.supportedLocalesOf(s.locales)[0]}},this.getAst=function(){return s.ast},this.locales=r,this.resolvedLocale=e.resolveLocale(r),"string"===typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=e.__parse(t,{ignoreTag:null===i||void 0===i?void 0:i.ignoreTag,locale:this.resolvedLocale})}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=$a(e.formats,n),this.formatters=i&&i.formatters||(void 0===(o=this.formatterCache)&&(o={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:Ua((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.NumberFormat).bind.apply(e,ws([void 0],t,!1)))}),{cache:ec(o.number),strategy:Fa.variadic}),getDateTimeFormat:Ua((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.DateTimeFormat).bind.apply(e,ws([void 0],t,!1)))}),{cache:ec(o.dateTime),strategy:Fa.variadic}),getPluralRules:Ua((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.PluralRules).bind.apply(e,ws([void 0],t,!1)))}),{cache:ec(o.pluralRules),strategy:Fa.variadic})})}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.resolveLocale=function(e){if("undefined"!==typeof Intl.Locale){var t=Intl.NumberFormat.supportedLocalesOf(e);return t.length>0?new Intl.Locale(t[0]):new Intl.Locale("string"===typeof e?e:e[0])}},e.__parse=Da,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}();!function(e){e.FORMAT_ERROR="FORMAT_ERROR",e.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",e.INVALID_CONFIG="INVALID_CONFIG",e.MISSING_DATA="MISSING_DATA",e.MISSING_TRANSLATION="MISSING_TRANSLATION"}(tc||(tc={}));var nc=function(e){function t(r,n,i){var o=this,s=i?i instanceof Error?i:new Error(String(i)):void 0;return(o=e.call(this,"[@formatjs/intl Error ".concat(r,"] ").concat(n,"\n").concat(s?"\n".concat(s.message,"\n").concat(s.stack):""))||this).code=r,"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(o,t),o}return Is(t,e),t}(Error),ic=function(e){function t(t,r){return e.call(this,tc.UNSUPPORTED_FORMATTER,t,r)||this}return Is(t,e),t}(nc),oc=function(e){function t(t,r){return e.call(this,tc.INVALID_CONFIG,t,r)||this}return Is(t,e),t}(nc),sc=function(e){function t(t,r){return e.call(this,tc.MISSING_DATA,t,r)||this}return Is(t,e),t}(nc),ac=function(e){function t(t,r,n){return e.call(this,tc.FORMAT_ERROR,"".concat(t,"\nLocale: ").concat(r,"\n"),n)||this}return Is(t,e),t}(nc),cc=function(e){function t(t,r,n,i){var o=e.call(this,"".concat(t,"\nMessageID: ").concat(null===n||void 0===n?void 0:n.id,"\nDefault Message: ").concat(null===n||void 0===n?void 0:n.defaultMessage,"\nDescription: ").concat(null===n||void 0===n?void 0:n.description,"\n"),r,i)||this;return o.descriptor=n,o}return Is(t,e),t}(ac),uc=function(e){function t(t,r){var n=e.call(this,tc.MISSING_TRANSLATION,'Missing message: "'.concat(t.id,'" for locale "').concat(r,'", using ').concat(t.defaultMessage?"default message (".concat("string"===typeof t.defaultMessage?t.defaultMessage:t.defaultMessage.map((function(e){var t;return null!==(t=e.value)&&void 0!==t?t:JSON.stringify(e)})).join(),")"):"id"," as fallback."))||this;return n.descriptor=t,n}return Is(t,e),t}(nc);function lc(e,t,r){return void 0===r&&(r={}),t.reduce((function(t,n){return n in e?t[n]=e[n]:n in r&&(t[n]=r[n]),t}),{})}var dc={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:function(e){0},onWarn:function(e){0}};function hc(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,r){e[t]=r}}}}}function pc(e,t,r,n){var i,o=e&&e[t];if(o&&(i=o[r]),i)return i;n(new ic("No ".concat(t," format named: ").concat(r)))}var fc=Ls(Ls({},dc),{textComponent:e.Fragment});function gc(e,t){return Object.keys(e).reduce((function(r,n){return r[n]=Ls({timeZone:t},e[n]),r}),{})}function mc(e,t){return Object.keys(Ls(Ls({},e),t)).reduce((function(r,n){return r[n]=Ls(Ls({},e[n]||{}),t[n]||{}),r}),{})}function _c(e,t){if(!t)return e;var r=rc.formats;return Ls(Ls(Ls({},r),e),{date:mc(gc(r.date,t),gc(e.date||{},t)),time:mc(gc(r.time,t),gc(e.time||{},t))})}var vc=function(e,t,r,n,i){var o=e.locale,s=e.formats,a=e.messages,c=e.defaultLocale,u=e.defaultFormats,l=e.fallbackOnEmptyString,d=e.onError,h=e.timeZone,p=e.defaultRichTextElements;void 0===r&&(r={id:""});var f=r.id,g=r.defaultMessage;Us(!!f,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var m=String(f),_=a&&Object.prototype.hasOwnProperty.call(a,m)&&a[m];if(Array.isArray(_)&&1===_.length&&_[0].type===Ms.literal)return _[0].value;if(!n&&_&&"string"===typeof _&&!p)return _.replace(/'\{(.*?)\}'/gi,"{$1}");if(n=Ls(Ls({},p),n||{}),s=_c(s,h),u=_c(u,h),!_){if(!1===l&&""===_)return _;if((!g||o&&o.toLowerCase()!==c.toLowerCase())&&d(new uc(r,o)),g)try{return t.getMessageFormat(g,c,u,i).format(n)}catch(v){return d(new cc('Error formatting default message for: "'.concat(m,'", rendering default message verbatim'),o,r,v)),"string"===typeof g?g:m}return m}try{return t.getMessageFormat(_,o,s,Ls({formatters:t},i||{})).format(n)}catch(v){d(new cc('Error formatting message: "'.concat(m,'", using ').concat(g?"default message":"id"," as fallback."),o,r,v))}if(g)try{return t.getMessageFormat(g,c,u,i).format(n)}catch(v){d(new cc('Error formatting the default message for: "'.concat(m,'", rendering message verbatim'),o,r,v))}return"string"===typeof _?_:"string"===typeof g?g:m},yc=["style","currency","currencyDisplay","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem"];function Ec(e,t,r){var n=e.locale,i=e.formats,o=e.onError;void 0===r&&(r={});var s=r.format,a=s&&pc(i,"number",s,o)||{};return t(n,lc(r,yc,a))}function Sc(e,t,r,n){void 0===n&&(n={});try{return Ec(e,t,n).format(r)}catch(i){e.onError(new nc(tc.FORMAT_ERROR,"Error formatting number.",i))}return String(r)}function bc(e,t,r,n){void 0===n&&(n={});try{return Ec(e,t,n).formatToParts(r)}catch(i){e.onError(new nc(tc.FORMAT_ERROR,"Error formatting number.",i))}return[]}var Tc=["numeric","style"];function Cc(e,t,r,n,i){void 0===i&&(i={}),n||(n="second"),Intl.RelativeTimeFormat||e.onError(new Wa('Intl.RelativeTimeFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-relativetimeformat"\n',qa.MISSING_INTL_API));try{return function(e,t,r){var n=e.locale,i=e.formats,o=e.onError;void 0===r&&(r={});var s=r.format,a=!!s&&pc(i,"relative",s,o)||{};return t(n,lc(r,Tc,a))}(e,t,i).format(r,n)}catch(o){e.onError(new ac("Error formatting relative time.",e.locale,o))}return String(r)}var Rc=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function Oc(e,t,r,n){var i=e.locale,o=e.formats,s=e.onError,a=e.timeZone;void 0===n&&(n={});var c=n.format,u=Ls(Ls({},a&&{timeZone:a}),c&&pc(o,t,c,s)),l=lc(n,Rc,u);return"time"!==t||l.hour||l.minute||l.second||l.timeStyle||l.dateStyle||(l=Ls(Ls({},l),{hour:"numeric",minute:"numeric"})),r(i,l)}function kc(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r[0],o=r[1],s=void 0===o?{}:o,a="string"===typeof i?new Date(i||0):i;try{return Oc(e,"date",t,s).format(a)}catch(c){e.onError(new nc(tc.FORMAT_ERROR,"Error formatting date.",c))}return String(a)}function Ic(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r[0],o=r[1],s=void 0===o?{}:o,a="string"===typeof i?new Date(i||0):i;try{return Oc(e,"time",t,s).format(a)}catch(c){e.onError(new nc(tc.FORMAT_ERROR,"Error formatting time.",c))}return String(a)}function Lc(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r[0],o=r[1],s=r[2],a=void 0===s?{}:s,c=e.timeZone,u=e.locale,l=e.onError,d=lc(a,Rc,c?{timeZone:c}:{});try{return t(u,d).formatRange(i,o)}catch(h){l(new nc(tc.FORMAT_ERROR,"Error formatting date time range.",h))}return String(i)}function wc(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r[0],o=r[1],s=void 0===o?{}:o,a="string"===typeof i?new Date(i||0):i;try{return Oc(e,"date",t,s).formatToParts(a)}catch(c){e.onError(new nc(tc.FORMAT_ERROR,"Error formatting date.",c))}return[]}function Ac(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r[0],o=r[1],s=void 0===o?{}:o,a="string"===typeof i?new Date(i||0):i;try{return Oc(e,"time",t,s).formatToParts(a)}catch(c){e.onError(new nc(tc.FORMAT_ERROR,"Error formatting time.",c))}return[]}var Nc=["type"];function Pc(e,t,r,n){var i=e.locale,o=e.onError;void 0===n&&(n={}),Intl.PluralRules||o(new Wa('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',qa.MISSING_INTL_API));var s=lc(n,Nc);try{return t(i,s).select(r)}catch(a){o(new ac("Error formatting plural.",i,a))}return"other"}var Mc=["type","style"],Dc=Date.now();function Uc(e,t,r,n){void 0===n&&(n={});var i=xc(e,t,r,n).reduce((function(e,t){var r=t.value;return"string"!==typeof r?e.push(r):"string"===typeof e[e.length-1]?e[e.length-1]+=r:e.push(r),e}),[]);return 1===i.length?i[0]:i}function xc(e,t,r,n){var i=e.locale,o=e.onError;void 0===n&&(n={}),Intl.ListFormat||o(new Wa('Intl.ListFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-listformat"\n',qa.MISSING_INTL_API));var s=lc(n,Mc);try{var a={},c=r.map((function(e,t){if("object"===typeof e){var r=function(e){return"".concat(Dc,"_").concat(e,"_").concat(Dc)}(t);return a[r]=e,r}return String(e)}));return t(i,s).formatToParts(c).map((function(e){return"literal"===e.type?e:Ls(Ls({},e),{value:a[e.value]||e.value})}))}catch(u){o(new nc(tc.FORMAT_ERROR,"Error formatting list.",u))}return r}var Bc=["style","type","fallback"];function jc(e,t,r,n){var i=e.locale,o=e.onError;Intl.DisplayNames||o(new Wa('Intl.DisplayNames is not available in this environment.\nTry polyfilling it using "@formatjs/intl-displaynames"\n',qa.MISSING_INTL_API));var s=lc(n,Bc);try{return t(i,s).of(r)}catch(a){o(new nc(tc.FORMAT_ERROR,"Error formatting display name.",a))}}function Hc(e){var t;e.onWarn&&e.defaultRichTextElements&&"string"===typeof((t=e.messages||{})?t[Object.keys(t)[0]]:void 0)&&e.onWarn('[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. \nPlease consider using "@formatjs/cli" to pre-compile your messages for performance.\nFor more details see https://formatjs.io/docs/getting-started/message-distribution')}function Gc(e,t){var r=function(e){void 0===e&&(e={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}});var t=Intl.RelativeTimeFormat,r=Intl.ListFormat,n=Intl.DisplayNames,i=Ua((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.DateTimeFormat).bind.apply(e,ws([void 0],t,!1)))}),{cache:hc(e.dateTime),strategy:Fa.variadic}),o=Ua((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.NumberFormat).bind.apply(e,ws([void 0],t,!1)))}),{cache:hc(e.number),strategy:Fa.variadic}),s=Ua((function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new((e=Intl.PluralRules).bind.apply(e,ws([void 0],t,!1)))}),{cache:hc(e.pluralRules),strategy:Fa.variadic});return{getDateTimeFormat:i,getNumberFormat:o,getMessageFormat:Ua((function(e,t,r,n){return new rc(e,t,r,Ls({formatters:{getNumberFormat:o,getDateTimeFormat:i,getPluralRules:s}},n||{}))}),{cache:hc(e.message),strategy:Fa.variadic}),getRelativeTimeFormat:Ua((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new(t.bind.apply(t,ws([void 0],e,!1)))}),{cache:hc(e.relativeTime),strategy:Fa.variadic}),getPluralRules:s,getListFormat:Ua((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(r.bind.apply(r,ws([void 0],e,!1)))}),{cache:hc(e.list),strategy:Fa.variadic}),getDisplayNames:Ua((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(n.bind.apply(n,ws([void 0],e,!1)))}),{cache:hc(e.displayNames),strategy:Fa.variadic})}}(t),n=Ls(Ls({},dc),e),i=n.locale,o=n.defaultLocale,s=n.onError;return i?!Intl.NumberFormat.supportedLocalesOf(i).length&&s?s(new sc('Missing locale data for locale: "'.concat(i,'" in Intl.NumberFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(i).length&&s&&s(new sc('Missing locale data for locale: "'.concat(i,'" in Intl.DateTimeFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(s&&s(new oc('"locale" was not configured, using "'.concat(o,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),n.locale=n.defaultLocale||"en"),Hc(n),Ls(Ls({},n),{formatters:r,formatNumber:Sc.bind(null,n,r.getNumberFormat),formatNumberToParts:bc.bind(null,n,r.getNumberFormat),formatRelativeTime:Cc.bind(null,n,r.getRelativeTimeFormat),formatDate:kc.bind(null,n,r.getDateTimeFormat),formatDateToParts:wc.bind(null,n,r.getDateTimeFormat),formatTime:Ic.bind(null,n,r.getDateTimeFormat),formatDateTimeRange:Lc.bind(null,n,r.getDateTimeFormat),formatTimeToParts:Ac.bind(null,n,r.getDateTimeFormat),formatPlural:Pc.bind(null,n,r.getPluralRules),formatMessage:vc.bind(null,n,r),$t:vc.bind(null,n,r),formatList:Uc.bind(null,n,r.getListFormat),formatListToParts:xc.bind(null,n,r.getListFormat),formatDisplayName:jc.bind(null,n,r.getDisplayNames)})}function zc(e){return{locale:e.locale,timeZone:e.timeZone,fallbackOnEmptyString:e.fallbackOnEmptyString,formats:e.formats,textComponent:e.textComponent,messages:e.messages,defaultLocale:e.defaultLocale,defaultFormats:e.defaultFormats,onError:e.onError,onWarn:e.onWarn,wrapRichTextChunksInFragment:e.wrapRichTextChunksInFragment,defaultRichTextElements:e.defaultRichTextElements}}function qc(t){return t?Object.keys(t).reduce((function(r,n){var i,o=t[n];return r[n]=Ja(o)?(i=o,function(t){return i(e.Children.toArray(t))}):o,r}),{}):t}var Vc=function(t,r,n,i){for(var o=[],s=4;s<arguments.length;s++)o[s-4]=arguments[s];var a=qc(i),c=vc.apply(void 0,ws([t,r,n,a],o,!1));return Array.isArray(c)?e.Children.toArray(c):c},Fc=function(e,t){var r=e.defaultRichTextElements,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["defaultRichTextElements"]),i=qc(r),o=Gc(Ls(Ls(Ls({},fc),n),{defaultRichTextElements:i}),t),s={locale:o.locale,timeZone:o.timeZone,fallbackOnEmptyString:o.fallbackOnEmptyString,formats:o.formats,defaultLocale:o.defaultLocale,defaultFormats:o.defaultFormats,messages:o.messages,onError:o.onError,defaultRichTextElements:i};return Ls(Ls({},o),{formatMessage:Vc.bind(null,s,o.formatters),$t:Vc.bind(null,s,o.formatters)})},Zc=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.cache={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}},e.state={cache:e.cache,intl:Fc(zc(e.props),e.cache),prevConfig:zc(e.props)},e}return Is(r,t),r.getDerivedStateFromProps=function(e,t){var r=t.prevConfig,n=t.cache,i=zc(e);return function(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=Object.keys(e),n=Object.keys(t),i=r.length;if(n.length!==i)return!1;for(var o=0;o<i;o++){var s=r[o];if(e[s]!==t[s]||!Object.prototype.hasOwnProperty.call(t,s))return!1}return!0}(r,i)?null:{intl:Fc(i,n),prevConfig:i}},r.prototype.render=function(){return Us(this.state.intl,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry."),e.createElement(Ns,{value:this.state.intl},this.props.children)},r.displayName="IntlProvider",r.defaultProps=fc,r}(e.PureComponent),Wc=Zc,Yc="view_index__jhiYd",Qc="ZegoRejoinRoom_rejoinRoomContainer__r5Vz3",Kc="ZegoRejoinRoom_title__os+By",Jc="ZegoRejoinRoom_rejoin__JK0dd",Xc="ZegoRejoinRoom_returnHome__mh3wB",$c="ZegoRejoinRoom_isPC__O1twN",eu="ZegoRejoinRoom_joinRoomButtonLoading__tN85T",tu=D()?Bn:Ft,ru=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={isPc:D(),isJoining:!1},e}return c(r,[{key:"joinRoom",value:function(){var e=o(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.isJoining){e.next=2;break}return e.abrupt("return");case 2:this.setState({isJoining:!0},o(n().mark((function e(){var r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.next=3,t.props.core.enterRoom();case 3:0===(i=e.sent)?t.props.joinRoom&&t.props.joinRoom():1002034===i?r="Failed to join the room, the number of people in the room has reached the maximum.(2 people)":[1002031,1002053].includes(i)?r="There's something wrong with your network. Please check it and try again.":[1102018,1102016,1102020].includes(i)||(r=1002056===i?"You are on a call in another room, please leave that room first.":"Failed to join the room, please try again.(error code:"+i+")"),r&&tu({content:r}),t.setState({isJoining:!1});case 7:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"returnHome",value:function(){this.props.returnHome&&this.props.returnHome()}},{key:"render",value:function(){var e=this;return(0,ct.jsxs)("div",{className:"".concat(Qc," ").concat(this.state.isPc?$c:""),children:[(0,ct.jsx)("button",{className:Kc,children:"You have left the room."}),(0,ct.jsxs)("button",{className:Jc,onClick:function(){e.joinRoom()},children:[this.state.isJoining&&(0,ct.jsx)("span",{className:eu})," ","Rejoin"]}),this.props.core._config.showPreJoinView&&(0,ct.jsx)("button",{className:Xc,onClick:function(){e.returnHome()},children:"Return to home screen"})]})}}]),r}(e.Component),nu=function(e){l(r,e);var t=f(r);function r(){var e;s(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={step:e.props.core._config.showPreJoinView?0:1,isSupportWebRTC:!0},e}return c(r,[{key:"componentDidMount",value:function(){var e=o(n().mark((function e(){var t;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.core.checkWebRTC();case 2:t=e.sent,this.setState({isSupportWebRTC:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"nextPage",value:function(){this.setState((function(e){return{step:++e.step}}))}},{key:"render",value:function(){var e,t=this;if(this.state.isSupportWebRTC)if(0===this.state.step&&this.props.core){if("undefined"===typeof SDK_ENV){document.getElementById("root");var r=document.querySelector("#root .preView_nav"),n=document.querySelector("#root .preView_services"),i=n.previousElementSibling;r&&(r.style.display="flex"),i.style.height="auto",n.style.display="block",D()||(i.style.marginTop="")}e=D()?(0,ct.jsx)(bt,{core:this.props.core,joinRoom:function(){t.nextPage()}}):(0,ct.jsx)(rr,{core:this.props.core,joinRoom:function(){t.nextPage()}}),this.props.core.setCurrentPage("BrowserCheckPage")}else if(1===this.state.step&&this.props.core){if("undefined"===typeof SDK_ENV){document.getElementById("root");var o=document.querySelector("#root .preView_nav"),s=document.querySelector("#root .preView_services"),a=s.previousElementSibling;o&&(o.style.display="none"),a.style.height="100%",s.style.display="none",D()||(a.style.marginTop="0")}setTimeout((function(){var e;t.props.core._config.joinRoomCallback&&(null===(e=t.props.core._config)||void 0===e||e.joinRoomCallback()),t.props.core._config.onJoinRoom&&t.props.core._config.onJoinRoom()}),0),e=D()?(0,ct.jsx)(zi,{core:this.props.core,leaveRoom:function(){t.props.core._config.showLeavingView&&t.nextPage(),setTimeout((function(){t.props.core._config.leaveRoomCallback&&t.props.core._config.leaveRoomCallback(),t.props.core._config.onLeaveRoom&&t.props.core._config.onLeaveRoom()}),0)}}):(0,ct.jsx)(Os,{core:this.props.core,leaveRoom:function(){t.props.core._config.showLeavingView&&t.nextPage(),setTimeout((function(){t.props.core._config.leaveRoomCallback&&t.props.core._config.leaveRoomCallback(),t.props.core._config.onLeaveRoom&&t.props.core._config.onLeaveRoom()}),0)}}),this.props.core.setCurrentPage("Room")}else 2===this.state.step&&this.props.core&&(e=(0,ct.jsx)(ru,{core:this.props.core,joinRoom:function(){t.setState({step:1})},returnHome:function(){t.setState({step:0})}}),this.props.core.setCurrentPage("RejoinRoom"));else e=(0,ct.jsx)(Et,{header:"Browser not supported",contentText:/Firefox/.test(window.navigator.userAgent)?"Your browser version does not support the features or something wrong with your network. Please check them and try again.":"The current browser is not available for you to join the room."}),this.props.core.setCurrentPage("BrowserCheckPage");return(0,ct.jsx)(Wc,{locale:"en",children:(0,ct.jsx)("div",{className:Yc,children:e})})}}]),r}(e.Component),iu=function(){function e(){s(this,e),this.hasJoinedRoom=!1,this.root=void 0}return c(e,[{key:"joinRoom",value:function(r){if(e.core)if(this.hasJoinedRoom)console.error("\u3010ZEGOCLOUD\u3011joinRoom repeat !!");else{if(!r||!r.container){console.warn("\u3010ZEGOCLOUD\u3011joinRoom/roomConfig/container required !!");var n=document.createElement("div");n.style.position="fixed",n.style.width="100vw",n.style.height="100vh",n.style.minWidth="345px",n.style.top="0px",n.style.left="0px",n.style.zIndex="100",n.style.backgroundColor="#FFFFFF",n.style.overflow="auto",document.body.appendChild(n),r=C(C({},r),{container:n})}e.core.setConfig(r)&&(this.root=t.createRoot(r.container),this.root.render((0,ct.jsx)(nu,{core:e.core})),this.hasJoinedRoom=!0)}else console.error("\u3010ZEGOCLOUD\u3011 please call init first !!")}},{key:"destroy",value:function(){var t,r,n,i;null===(t=e.core)||void 0===t||null===(r=t.leaveRoom)||void 0===r||r.call(t),e.core=void 0,K._instance=void 0,null===(n=this.root)||void 0===n||null===(i=n.unmount)||void 0===i||i.call(n),this.root=void 0,this.hasJoinedRoom=!1}}],[{key:"generateKitTokenForTest",value:function(e,t,r,n,i,o){return function(e,t,r,n,i,o){if(!r)return console.error("\u3010ZEGOCLOUD\u3011:roomID required!!"),"";if(!n)return console.error("\u3010ZEGOCLOUD\u3011:userID required!!"),"";if(!i)return console.error("\u3010ZEGOCLOUD\u3011:userName required!!"),"";if(!e)return console.error("\u3010ZEGOCLOUD\u3011:appID required!!"),"";if("number"!=typeof e)return console.error("\u3010ZEGOCLOUD\u3011:appID must be number!!"),"";if(!t)return console.error("\u3010ZEGOCLOUD\u3011: serverSecret required!!"),"";var s=Date.now()/1e3|0,a={app_id:e,user_id:n,nonce:2147483647*Math.random()|0,ctime:s,expire:s+(o||7200)},c=P().enc.Utf8.parse(t),u=Math.random().toString().substring(2,18);u.length<16&&(u+=u.substring(0,16-u.length));var l=P().AES.encrypt(JSON.stringify(a),c,{iv:P().enc.Utf8.parse(u)}).toString(),d=Uint8Array.from(Array.from(atob(l)).map((function(e){return e.charCodeAt(0)}))),h=d.length,p=new Uint8Array(28+h);return p.set([0,0,0,0]),p.set(new Uint8Array(Int32Array.from([a.expire]).buffer).reverse(),4),p[8]=u.length>>8,p[9]=u.length-(p[8]<<8),p.set(Uint8Array.from(Array.from(u).map((function(e){return e.charCodeAt(0)}))),10),p[26]=h>>8,p[27]=h-(p[26]<<8),p.set(d,28),"04".concat(btoa(String.fromCharCode.apply(String,k(Array.from(p)))))+"#"+window.btoa(JSON.stringify({userID:n,roomID:r,userName:i,appID:e}))}(e,t,r,n,i,o)}},{key:"generateKitTokenForProduction",value:function(e,t,r,n,i){return t+"#"+window.btoa(JSON.stringify({userID:n,roomID:r,userName:i,appID:e}))}},{key:"create",value:function(t){return!e.core&&t&&(e.core=K.getInstance(t),e._instance=new e),e._instance}}]),e}();function ou(e,t,r){return fetch("https://console-api.zegocloud.com/demo/prebuilt_token",{method:"POST",body:JSON.stringify({user_id:e,room_id:t,user_name:r}),headers:{"Content-Type":"application/json"}}).then(function(){var e=o(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return r=e.sent,e.abrupt("return",{token:r.data.token});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function su(e){var t="";if(t)return t;var r,n="12345qwertyuiopasdfgh67890jklmnbvcxzMNBVCZXASDQWERTYHGFUIOLKJP",i=n.length;for(e=e||5,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*i));return t}function au(){var e=["Oliver","Jake","Noah","James","Jack","Connor","Liam","John","Harry","Callum","Mason","Robert","Jacob","Jacob","Jacob","Michael","Charlie","Kyle","William","William","Thomas","Joe","Ethan","David","George","Reece","Michael","Richard","Oscar","Rhys","Alexander","Joseph","James","Charlie","James","Charles","William","Damian","Daniel","Thomas"],t=Math.round(Math.random()*e.length);return e[t=t==e.length?t-1:t]}iu.core=void 0,iu._instance=void 0,iu.Host=g.Host,iu.Cohost=g.Cohost,iu.Audience=g.Audience,iu.OneONoneCall=m.OneONoneCall,iu.GroupCall=m.GroupCall,iu.LiveStreaming=m.LiveStreaming,iu.VideoConference=m.VideoConference,iu.VideoResolution_180P=_._180P,iu.VideoResolution_360P=_._360P,iu.VideoResolution_480P=_._480P,iu.VideoResolution_720P=_._720P,iu.LiveStreamingMode=v,function e(){var t=window.orientation,r=null;function n(){if(null===document.getElementById("preventTran")){(r=document.createElement("div")).setAttribute("id","preventTran"),r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.width="100%",r.style.height="100vh",r.style.overflow="hidden",r.style.backgroundColor="rgb(46 46 46 / 95%)",r.style.textAlign="center",r.style.display="flex",r.style.flexDirection="column",r.style.justifyContent="center",r.style.alignItems="center",document.getElementsByTagName("body")[0].appendChild(r);var e=document.createElement("img");e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABaCAYAAADkUTU1AAAI9ElEQVR4Xu1cfXBcVRU/5+Z1N8GEj2AhFQvUIigfBetYaRVbBhADU2wHVoYk3bx3k8kMcSyFPxzUf8IfOjrqIHYUXbL3vW6mKXbtINapg1ColLEUnYIj9QPGOE0VdUjjlE3tdnffO87J7GY26yZ9H5tNst37X5tzzu/87rl777v3nnMR5rhFo9HLhBDrhRC3AMBqAFgBABfmYU8CwAgAHAGAVwDgJaXUO+Vc6u7uXhkOh0/GYrGxIC5jEOVZdLG3t7fdcZyHiOgORHSL4xDRfiHEE/F4fB8AEGNIKdcS0fMA8IxpmluC+OzWEdcY0Wh0jaZp2wFgjWulMoJE9CoRbRVCEHcCIp4PAOOpVOqSZDJp+7VdMcIbNmzQVqxYMYCIXwEA4dehEj2O+GlEfF/h/xFxfTwef9mv/YoQ7u/vb06n00kA+FypIxweAHgdAJ4DgF9nMpmj4+Pj77Jca2vr0nA4fC0ArAeAO4lotYvh/22l1JfnjXAkEmluaWn5JQB8ukx09hLRgGVZb7hxUNf1m4QQjxHRxlmI/0kpxZ3kqwWNMEopfwIAkRL0fwNAn1Lq51696ujouKKxsfEwAFw6k246nV45PDzMs7vnFoiwlPIRAPhuCeqbjuPcYVnWv7x609nZ+cFwOMzL0xVn0d2qlOKJ0XPzTZjXxYaGhqMAEC5C/aOmaetisRivr55aV1fXsiVLlhxExJVnU+QlyjTNz55NrtzffROWUj4DAJuKjI4j4up4PH7MjyOGYTyNiPe70SWiDCK+XymVciNfLOOLcDQaXaVpGk9EU/qO40Qtyxry6kBB3jCMpUQUEUJsIKIbEPEqANBmsseypmn+1CueL8JSyh8AQH8BjIiOmKb5ca/gs8l3dnae39jYeJfjODxjXw8APNSn1mMiUqZp9njF9EXYMIw3EfG6IsKbTNN81iu4F/mBgQExOjq6DgA2A8AnAeC3SqmHvdhgWb+E/4mIbXkwO5VKXZxMJj1PVF6drYS8X8IPI+K3AKCBiLabprmtEs5Uw4YvwuyYrusXnjlzRtu1a1eg7Vo1SAaepavtZCXxfEe4kk5U01adcDV7ez6w6hGej16vJmY9wtXs7fnAKhvhSCTS1NTUtFQIcZ5t2xUbBYjo+7TRbecIITKZTObk8PDwf8rpTCPT0dFxUTgc/ioA8Kdjg1uQhShHRG8T0bZTp069kEwmMwUfpwgbhnEtIv4GAC5YiAT8+sTEbdu+NZFI/GNqtxSJRFqbm5v/ioiFKxC/9heq3gki+qhpmu9ORrinp+cpIupdqN5WyK+fKaU2Y19f3wW5XO4Eb/XKGHYK9zteQIlIuDhQ92KyIrKO41yNhmF0IWLZsygi6jdN88mKoM2BEcMwHkTEH7o1TUSP8EH64wBQdgNfa4QBwCrcHHyhXC/VIOE9TJiPOu+tE+bZqsZ+wwBQj/C0kV2PsNv5v0pyXpel+pAuDUytDulfAMDd59KyVCdciPYiHdJj2Wx2zdDQ0N90Xf+wEILzRS7Kc5pch2spwg4iLo3H4+OFoEkpPwAAf8/flNYc4f1KqdtL5yMpJSfKfKqwLNVShA8rpW4uJdzT0/M6Ed1Uc4Q56w8RP6OU4ohOtu7u7tuEEM/nDyRqbkgzxywRDRLRbkTsRES9KDmmJgnP9mG7h494ONz/90NnrUW6LM1OWErJidd1wvUIV2nL5wXG7/awPqQX+bf0bIMkyd/S50yEiWi4Trh4PNTaOlyIMGfB3nMunHgQUYy/tL6RrzUqxzlJRFMf4l6WjErJIiJXajXPYG8NIm50izV5mabr+i1CCN+FT27BFoJcLpe7hi/EeeI6lE+6Xgh+zZUPu5VS909mAESj0as1TePqsfPmCm0+7RLRO7Ztr0okEiemklrypLlc7sr5dG4OsF8TQtwzODjIxWPTSwA4P6ulpYWrSh5DxE/MAXi1THKqBpcHfjOVSh0qrkadMelMStmSTqdbGxsbF1W+Vi6XOyOEOGFZVrpc71Ysy65aoQuKUycctAcXun49wgs9QkH9W5QR3rJly/VNTU0jsVjsv147YFERbm9vDy9btoxvA28koveI6POWZR3wQtoP4YLO5Bsb1Wy6rm8UQhSX2T+tlHrAiw+eCRuGsQcRbwOAo1xGK4T4VSaTeXFoaOiUF2A/slJKTpHkVMnJRkRPmqY5VdbrxqYfwuX2z1kA4Az0P/DzMgCwzzTN424c8CIjpdxd/MCC4zjbLMt6wosNz4R1Xb9ZCMHbydkaX+TxmzpcZ/xjpRSXzwdqfX19S3K5HG8ACrf5IIRYOzg4+KoXw54Jc+HysWPHuH74EpdA25VSW13Kziim6zqXy3OEC20slUq1eX2mxjNhRpNSmlxR64LEHk3THojFYjzkAzUp5e8AoLjs/kdKqQe9GvVLmNON+cGS2dpzjuNsmmnX4sVRXdc7hBA7i3R4hfiYUur3XuywrC/C/CBBOBzm93RC5QCJ6MWxsbGNe/fu9fxhUGovGo1e3tDQcAQRLy78jYieNU2z+EkN17x9Ec4P6xcAgJenaY2IDk5MTNyVTCYnXHsxgyB3bCgUehkRbywim7Ft+4ZEIvGWH/u+Ceu6/pAQ4ntlQF87ffr03UFL5Xt7ey+1bXsfP4ZSjOE4zqOWZfH7A76ab8JdXV1XhUKht2cY0qOO48gdO3bs9+OVYRh3AkAcES8r0edSHM7e5yMcX8034fyw/jMAXAMAXFNYehTETvFE83Wl1F/ceNfd3X2dEOJr+Sdqpj1CRkSHJyYmbg/6UwlE2DAMPuyLZLPZezVNiyFi6ZtazJOJ8+0F54Mdymazbx0/fnwyU2758uWtoVDoI7Ztr+WTRSJaW67eiSfBTCazeefOne+56bjZZAIRzhtmG8Q7mba2tu8AwBcrWKTFnfX4yMjIowcOHMgFJcv6lSA8zQ8p5a0AwJPZqiAOEtEb/AigZVkHg9gp1a04YQaIRCINzc3N9yHil4honYeIF4b/9/Pf374np5k6aU4IF4NJKT8EAO355E5+NelyACjcBvJ7WKMAwLusV3K53L5EIsH/nrP2PzAJNfmP9znfAAAAAElFTkSuQmCC",r.appendChild(e),e.style.marginBottom="0.2rem",e.style.width="10%";var t=document.createElement("br"),n=document.createElement("p");n.style.width="100%",n.style.height="auto",n.style.fontSize="1.2rem",n.style.color="#626262",n.style.lineHeight="1.5rem",n.style.textAlign="center",n.innerHTML="For your good experience",n.appendChild(t),n.innerHTML+="Please operate your phone/tablet in portrait orientation",r.appendChild(n)}}90!=t&&-90!=t||(null==r&&null===document.getElementById("preventTran")&&n(),document.getElementById("preventTran").style.zIndex="9999"),window.onorientationchange=function(){null==r&&null==document.getElementById("preventTran")&&n(),document.getElementById("preventTran").style.zIndex="-1",e()}}();var cu=function(e){l(r,e);var t=f(r);function r(e){var i;s(this,r),(i=t.call(this,e)).myMeeting=void 0,i.state={showPreviewHeader:V().get("preHeader")||"show",docs:"https://docs.zegocloud.com/article/14922",showSettings:!1,showSettingsBtn:!1,liveStreamingMode:V().get("liveStreamingMode")||"RealTimeLive"},i.settingsEl=null;var a=V().get("UserName"),c=V().get("roomID")||su(5);V().get("roomID")||window.history.replaceState("","You have logged into room: "+c,window.location.origin+window.location.pathname+"?roomID="+c+"&role=Host");var u=V().get("role")||"Host",l="Host"===u?g.Host:"Cohost"===u?g.Cohost:g.Audience,d=[],h=V().get("showNonVideoUser")||void 0,p=m.OneONoneCall;return p=m.VideoConference,d.push({name:"Personal link",url:window.location.origin+window.location.pathname+"?roomID="+c}),i.myMeeting=function(){var e=o(n().mark((function e(t){var r,i,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(" userName || getRandomName()",a||au()),e.next=3,ou(su(5),c,a||au());case 3:r=e.sent,i=r.token,o=iu.create(i),s={container:t,preJoinViewConfig:{title:"Join Room"},maxUsers:50,leaveRoomCallback:function(){var e,t;console.log("test:leaveRoomCallback"),null===(e=window)||void 0===e||null===(t=e.parent)||void 0===t||t.postMessage("leaveRoom","*")},joinRoomCallback:function(){var e,t;null===(e=window)||void 0===e||null===(t=e.parent)||void 0===t||t.postMessage("joinRoom","*")},branding:{logoURL:"https://www.zegocloud.com/_nuxt/img/zegocloud_logo_white.ddbab9f.png"},sharedLinks:d,scenario:{mode:p,config:{role:l,liveStreamingMode:undefined}},showUserList:!0,onUserAvatarSetter:function(e){e.forEach((function(e){e.setUserAvatar&&e.setUserAvatar("https://api.multiavatar.com/".concat(e.userID,".svg?apikey=XqHm465NYsdLfb"))}))},videoResolutionList:[iu.VideoResolution_360P,iu.VideoResolution_180P,iu.VideoResolution_480P,iu.VideoResolution_720P],videoResolutionDefault:iu.VideoResolution_360P},void 0!==h&&(s.showNonVideoUser="true"===h),o.joinRoom(s);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i}return c(r,[{key:"handleSelectMode",value:function(e){var t=this;this.setState({liveStreamingMode:e},(function(){!D()&&t.handleSettingsConfirm()}))}},{key:"handleSettingsConfirm",value:function(){var e=V();e.get("liveStreamingMode")!==this.state.liveStreamingMode?(e.set("liveStreamingMode",this.state.liveStreamingMode),window.location.href=window.location.origin+window.location.pathname+"?"+e.toString()):this.setState({showSettings:!1})}},{key:"render",value:function(){var e=this;return(0,ct.jsxs)("div",{className:"".concat(S.app," ").concat(D()?"":S.mobileApp),children:["show"===this.state.showPreviewHeader&&(0,ct.jsxs)("div",{className:"".concat(S.nav," ").concat(D()?"":S.mobileNav," preView_nav"),children:[(0,ct.jsx)("div",{className:"".concat(S.LOGO," ").concat(D()?"":S.mobileLOGO),onClick:function(){window.open("https://www.zegocloud.com","_blank")}}),(0,ct.jsxs)("div",{className:"".concat(S.link," ").concat(D()?"":S.mobileLink),children:[this.state.showSettingsBtn&&(0,ct.jsxs)("a",{className:S.link_item,onClick:function(){e.setState({showSettings:!0,liveStreamingMode:V().get("liveStreamingMode")||"RealTimeLive"})},children:[(0,ct.jsx)("span",{className:S.icon_settings})," ",D()&&"Settings"]}),(0,ct.jsxs)("a",{href:this.state.docs,target:"_blank",className:S.link_item,rel:"noreferrer",children:[(0,ct.jsx)("span",{className:S.icon__doc})," ",D()&&"Documentation"]}),(0,ct.jsxs)("a",{href:"https://github.com/ZEGOCLOUD/zego_uikit_prebuilt_web/",target:"_blank",className:S.link_item,rel:"noreferrer",children:[(0,ct.jsx)("span",{className:S.icon__github}),D()&&"View demo code"]})]})]}),(0,ct.jsx)("div",{ref:this.myMeeting,className:"".concat(S.myMeeting,"  ").concat(D()?"":S.mobileMeeting)}),(0,ct.jsxs)("div",{className:"".concat(S.serviceTips,"  ").concat(D()?S.pcServiceTips:S.mobileServiceTips," preView_services"),children:['By clicking "Join", you agree to ',!D()&&(0,ct.jsx)("br",{})," our"," ",(0,ct.jsx)("a",{href:"https://www.zegocloud.com/policy?index=1",target:"_blank",rel:"noreferrer",children:"Terms of Services"})," ","and"," ",(0,ct.jsx)("a",{href:"https://www.zegocloud.com/policy?index=0",target:"_blank",rel:"noreferrer",children:"Privacy Policy"}),"."]}),this.state.showSettings&&(0,ct.jsx)("div",{className:"".concat(D()?S.pcSettingsModel:S.mobileSettingsModel),children:(0,ct.jsxs)("div",{className:S.settingsWrapper,children:[(0,ct.jsxs)("div",{className:S.settingsHeader,children:[(0,ct.jsx)("p",{children:D()?"Settings":"Live streaming mode"}),(0,ct.jsx)("span",{className:S.settingsClose,onClick:function(){e.setState({showSettings:!1})}})]}),(0,ct.jsxs)("div",{className:S.settingsBody,children:[D()&&(0,ct.jsx)("div",{className:S.settingsMode,children:"Live streaming mode"}),(0,ct.jsxs)("div",{className:S.settingsModeList,children:[(0,ct.jsxs)("div",{className:"".concat(S.settingsModeItem," ").concat("StandardLive"===this.state.liveStreamingMode?S.settingsModeItemSelected:""),onClick:function(){e.handleSelectMode("StandardLive")},children:[(0,ct.jsx)("p",{children:"Standard Live"}),(0,ct.jsx)("span",{})]}),(0,ct.jsxs)("div",{className:"".concat(S.settingsModeItem," ").concat("PremiumLive"===this.state.liveStreamingMode?S.settingsModeItemSelected:""),onClick:function(){e.handleSelectMode("PremiumLive")},children:[(0,ct.jsx)("p",{children:"Premium Live"}),(0,ct.jsx)("span",{})]}),(0,ct.jsxs)("div",{className:"".concat(S.settingsModeItem," ").concat("RealTimeLive"===this.state.liveStreamingMode?S.settingsModeItemSelected:""),onClick:function(){e.handleSelectMode("RealTimeLive")},children:[(0,ct.jsx)("p",{children:"Real-time Live"}),(0,ct.jsx)("span",{})]})]}),D()&&(0,ct.jsx)("div",{className:S.settingsBtn,onClick:function(){e.handleSettingsConfirm()},children:"Confirm"})]})]})})]})}}]),r}(e.Component),uu=function(e){e&&e instanceof Function&&__webpack_require__.e(988).then(__webpack_require__.bind(__webpack_require__,4988)).then((function(t){var r=t.getCLS,n=t.getFID,i=t.getFCP,o=t.getLCP,s=t.getTTFB;r(e),n(e),i(e),o(e),s(e)}))};t.createRoot(document.getElementById("root")).render((0,ct.jsx)(e.StrictMode,{children:(0,ct.jsx)(cu,{})})),uu()}()})();
//# sourceMappingURL=main.b2d87058.js.map