((t,i)=>{if("object"==typeof exports&&"object"==typeof module)module.exports=i(require("localforage"),require("pako/lib/deflate.js"),require("crypto-js/md5"),require("crypto-js/aes"),require("crypto-js/enc-utf8"));else if("function"==typeof define&&define.amd)define(["localforage","pako/lib/deflate.js","crypto-js/md5","crypto-js/aes","crypto-js/enc-utf8"],i);else{var n,r="object"==typeof exports?i(require("localforage"),require("pako/lib/deflate.js"),require("crypto-js/md5"),require("crypto-js/aes"),require("crypto-js/enc-utf8")):i(t.localforage,t["pako/lib/deflate.js"],t["crypto-js/md5"],t["crypto-js/aes"],t["crypto-js/enc-utf8"]);for(n in r)("object"==typeof exports?exports:t)[n]=r[n]}})("undefined"!=typeof self?self:this,function(n,r,e,s,u){return h=[function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.LinkedList=i.ListNode=i.ENUM_NETWORK_STATE=i.SOCKET_DISCONNECT=i.errorList=i.Queue=i.getSeq=i.E_CLIENT_TYPE=i.ENUM_LOG_LEVEL=i.ZEGO_BROWSER_TYPE=i.ZEGO_ENV=i.PROTO_VERSION=void 0,i.PROTO_VERSION="1.0.6",(e=i.ZEGO_ENV||(i.ZEGO_ENV={}))[e.BROWSER=0]="BROWSER",e[e.WEIXINMINI=1]="WEIXINMINI",(e=i.ZEGO_BROWSER_TYPE||(i.ZEGO_BROWSER_TYPE={}))[e.IE=0]="IE",e[e.FIREFOX=1]="FIREFOX",e[e.CHROME=2]="CHROME",e[e.SAFARI=3]="SAFARI",e[e.OPERA=4]="OPERA",e[e.WEIXIN=5]="WEIXIN",e[e.WEIXINMINI=6]="WEIXINMINI",e[e.UNKOWN=7]="UNKOWN",i.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},(e=i.E_CLIENT_TYPE||(i.E_CLIENT_TYPE={}))[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallPragram=2]="ClientType_SmallPragram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc",i.getSeq=(r=1,function(){return r++}),s.prototype.isEmpty=function(){return 0==this.items.length},s.prototype.enqueue=function(t){this.items.push(t)},s.prototype.dequeue=function(){return this.isEmpty()?"Underflow":this.items.shift()},s.prototype.front=function(){return this.isEmpty()?"No elements in Queue":this.items[0]},s.prototype.size=function(){return this.items.length},s.prototype.clear=function(){this.items=[]},s.prototype.all=function(){return this.items};var r,e=s;function s(){this.items=[],this.items=[]}i.Queue=e,i.errorList={TIMEOUT:{code:100001,msg:"network timeout"},DATAEXIST:{code:100002,msg:"data exist"},BROKEN:{code:100003,msg:"network broken"}},i.SOCKET_DISCONNECT=-1,(e=i.ENUM_NETWORK_STATE||(i.ENUM_NETWORK_STATE={}))[e.offline=0]="offline",e[e.online=1]="online",Object.defineProperty(o.prototype,"id",{get:function(){return this.h||null},set:function(t){this.h=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){return this.v},set:function(t){this.v=t},enumerable:!1,configurable:!0}),o.prototype.hasNext=function(){return this.next&&this.next.id},o.prototype.hasPrev=function(){return this.prev&&this.prev.id};var u=o;function o(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.next=null,this.prev=null,this.h=t,this.v=i}function h(){this.start=new u,this.end=new u,this.g=0,this._=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}i.ListNode=u,h.prototype.insertBefore=function(t,i){return(i=new u(this.g,i)).next=t,i.prev=t.prev,t.prev&&(t.prev.next=i),t.prev=i,++this.g,++this._,i},h.prototype.addLast=function(t){return this.insertBefore(this.end,t)},h.prototype.add=function(t){return this.addLast(t)},h.prototype.getFirst=function(){return 0===this._?null:this.start.next},h.prototype.getLast=function(){return 0===this._?null:this.end.prev},h.prototype.size=function(){return this._},h.prototype.getFromFirst=function(t){var i=0,n=this.start.next;if(0<=t)for(;i<t&&null!==n;)n=n.next,++i;else n=null;if(null===n)throw"Index out of bounds.";return n},h.prototype.get=function(t){return 0===t?this.getFirst():t===this._-1?this.getLast():this.getFromFirst(t)},h.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._,t},h.prototype.removeFirst=function(){return 0<this._&&this.start.next?this.remove(this.start.next):null},h.prototype.removeLast=function(){return 0<this._&&this.end.prev?this.remove(this.end.prev):null},h.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._=0,this.g=0},h.prototype.each=function(t){for(var i=this.start;i.hasNext();)t(i=i.next)},h.prototype.find=function(t){for(var i=this.start,n=!1,r=null;i.hasNext()&&!n;)t(i=i.next)&&(r=i,n=!0);return r},h.prototype.map=function(t){for(var i=this.start,n=[];i.hasNext();)t(i=i.next)&&n.push(i);return n},h.prototype.push=function(t){return this.addLast(t)},h.prototype.unshift=function(t){0<this._?this.insertBefore(this.start.next,t):this.insertBefore(this.end,t)},h.prototype.pop=function(){return this.removeLast()},h.prototype.shift=function(){return this.removeFirst()},i.LinkedList=h},function(t,i,n){var r=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u},u=this&&this.__spread||function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(r(arguments[i]));return t},e=(Object.defineProperty(i,"u",{value:!0}),i.ContextAPI=i.suppressInstrumentation=i.ROOT_CONTEXT=i.BaseContext=i.setSpan=i.getSpanContext=i.getSpan=i.createContextKey=void 0,n(16));function s(t){return Symbol.for(t)}var o=(i.createContextKey=s)("OpenTelemetry Context Key SUPPRESS_INSTRUMENTATION"),h=s("OpenTelemetry Context Key SPAN");function c(t){return t.getValue(h)||void 0}function f(t){this.O=t,this.S=new e.StackContextManager}i.getSpan=c,i.getSpanContext=function(t){return null==(t=c(t))?void 0:t.context()},i.setSpan=function(t,i){return t.setValue(h,i)},i.BaseContext=n=function r(t){var e=this;e.M=t?new Map(t):new Map,e.getValue=function(t){return e.M.get(t)},e.setValue=function(t,i){var n=new r(e.M);return n.M.set(t,i),n},e.deleteValue=function(t){var i=new r(e.M);return i.M.delete(t),i}},i.ROOT_CONTEXT=new n,i.suppressInstrumentation=function(t){return t.setValue(o,!0)},f.getInstance=function(t){return void 0===t&&(t="context"),this.j||(this.j=new f(t)),this.j},f.prototype.active=function(){return this.S.active()},f.prototype.with=function(t,i,n){for(var r,e=[],s=3;s<arguments.length;s++)e[s-3]=arguments[s];return(r=this.T()).with.apply(r,u([t,i,n],e))},f.prototype.T=function(){return this.S},i.ContextAPI=f},function(t,i,n){var r,e;Object.defineProperty(i,"u",{value:!0}),i.INVALID_SPAN_CONTEXT=i.INVALID_TRACEID=i.INVALID_SPANID=i.TraceFlags=i.SpanKind=i.SpanStatusCode=void 0,(r=i.SpanStatusCode||(i.SpanStatusCode={}))[r.UNSET=0]="UNSET",r[r.OK=1]="OK",r[r.ERROR=2]="ERROR",(r=i.SpanKind||(i.SpanKind={}))[r.INTERNAL=0]="INTERNAL",r[r.SERVER=1]="SERVER",r[r.CLIENT=2]="CLIENT",r[r.PRODUCER=3]="PRODUCER",r[r.CONSUMER=4]="CONSUMER",(e=r=i.TraceFlags||(i.TraceFlags={}))[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED",i.INVALID_SPANID="0000000000000000",i.INVALID_TRACEID="00000000000000000000000000000000",i.INVALID_SPAN_CONTEXT={traceId:i.INVALID_TRACEID,spanId:i.INVALID_SPANID,traceFlags:r.NONE}},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.log=i.ZegoLog=void 0,e.prototype.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join("");console.log(n)},e.prototype.debug=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join("");console.debug(n)},e.prototype.info=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join("");console.info(n)},e.prototype.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join("");console.warn(n)},e.prototype.error=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join("");console.error(n)};var r=e;function e(){}r=new(i.ZegoLog=r),i.log=r},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.FAIL_TIME=i.FAIL_MAX_COUNT=i.FAIL_COUNT=i.STORE_SIZE=i.CACHE_SIZE=i.BUCKET_CONFIG=i.DEFAULT_CONFIG=void 0,i.DEFAULT_CONFIG={importantLevel:0,reportSize:3e3,reportNum:10,bps:16e3,netTimeout:10},i.BUCKET_CONFIG={bucketSize:1e4,tokensPerInterval:1600},i.CACHE_SIZE={totalAvailCache:102400,cacheMaxSize:2e4,cacheDelPer:.2},i.STORE_SIZE={totalDBSize:2048e3,storeDelPer:.2},i.FAIL_COUNT=5,i.FAIL_MAX_COUNT=10,i.FAIL_TIME=30},function(t,i,n){var r=this&&this.__importDefault||function(t){return t&&t.u?t:{default:t}},u=(Object.defineProperty(i,"u",{value:!0}),i.uuid=i.calculateMemSize=i.analyzeKey=i.getCurrentTime=i.getCurrentEnv=i.getBrowser=void 0,n(0)),e=r(n(31)),s=(i.getBrowser=function(){var t=window.navigator.userAgent,i=null!=window.ActiveXObject&&-1!=t.indexOf("MSIE"),n=-1!=t.indexOf("Firefox"),r=null!=window.opr,e=t.indexOf("Chrome")&&window.chrome,s=-1!=t.indexOf("Safari")&&-1!=t.indexOf("Version"),t=t.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===t.toLowerCase().match(/MicroMessenger/i)[0];return i?u.ZEGO_BROWSER_TYPE.IE:n?u.ZEGO_BROWSER_TYPE.FIREFOX:r?u.ZEGO_BROWSER_TYPE.OPERA:e?u.ZEGO_BROWSER_TYPE.CHROME:s?u.ZEGO_BROWSER_TYPE.SAFARI:t?u.ZEGO_BROWSER_TYPE.WEIXIN:u.ZEGO_BROWSER_TYPE.UNKOWN},i.getCurrentEnv=function(){var i=window.navigator.userAgent;return new Promise(function(t){-1==i.indexOf("MicroMessage")?t(u.ZEGO_ENV.BROWSER):wx.miniProgram.getEnv(function(t){t.miniprogram})})},["00","01","02","03","04","05","06","07","08","09"]);i.getCurrentTime=function(){var t=new Date;return[t.getFullYear()+"/",(s[t.getMonth()+1]||t.getMonth()+1)+"/",(s[t.getDate()]||t.getDate())+" ",(s[t.getHours()]||t.getHours())+":",(s[t.getMinutes()]||t.getMinutes())+":",s[t.getSeconds()]||t.getSeconds(),"."+t.getTime()%1e3].join("")},i.analyzeKey=function(t){return t=t.split("_"),{level:Number(t[0]),timestamp:t[1],seq:t[2]}},i.calculateMemSize=function(t){return e.default(t)},i.uuid=function(t,i){var n,r,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s=[];if(i=i||e.length,t)for(n=0;n<t;n++)s[n]=e[0|Math.random()*i];else for(s[8]=s[13]=s[18]=s[23]="-",s[14]="4",n=0;n<36;n++)s[n]||(r=0|16*Math.random(),s[n]=e[19==n?3&r|8:r]);return s.join("")}},function(t,i,n){var c=this&&this.__values||function(t){var i="function"==typeof Symbol&&Symbol.iterator,n=i&&t[i],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},f=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u};function a(t){var i,n,r;if(null!=t&&Array.isArray(t))try{for(var e=c(t),s=e.next();!s.done;s=e.next()){var u=s.value;if(null!=u)if(r){if(typeof u!==r)return!1}else r=typeof u}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=e.return)&&n.call(e)}finally{if(i)throw i.error}}return!0}Object.defineProperty(i,"u",{value:!0}),i.sanitizeAttributes=i.isAttributeValue=void 0,i.isAttributeValue=a,i.sanitizeAttributes=function(t){var i,n,r={};if(null!=t&&"object"==typeof t)try{for(var e=c(Object.entries(t)),s=e.next();!s.done;s=e.next()){var u=f(s.value,2),o=u[0],h=u[1];a(h)&&(Array.isArray(h)?r[o]=h.slice():r[o]=h)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=e.return)&&n.call(e)}finally{if(i)throw i.error}}return r}},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.IdGenerator=void 0;var r=Array(32);function e(i){return function(){for(var t=0;t<2*i;t++)r[t]=Math.floor(16*Math.random())+48,58<=r[t]&&(r[t]+=39);return String.fromCharCode.apply(null,r.slice(0,2*i))}}i.IdGenerator=function(){this.generateTraceId=e(16),this.generateSpanId=e(8),this.generateEventId=e(4)}},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.Resource=i.SDK_INFO=i.SemanticResourceAttributes=void 0,i.SemanticResourceAttributes={PROCESS_RUNTIME_NAME:"process.runtime.name",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version"},i.SDK_INFO=((r={})[i.SemanticResourceAttributes.TELEMETRY_SDK_NAME]="opentelemetry",r[i.SemanticResourceAttributes.PROCESS_RUNTIME_NAME]="browser",r[i.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]="webjs",r[i.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]=i.VERSION,r),e.empty=function(){return e.EMPTY},e.createTelemetrySDKResource=function(){var t;return new e(((t={})[i.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]=i.SDK_INFO[i.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE],t[i.SemanticResourceAttributes.TELEMETRY_SDK_NAME]=i.SDK_INFO[i.SemanticResourceAttributes.TELEMETRY_SDK_NAME],t[i.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]=i.SDK_INFO[i.SemanticResourceAttributes.TELEMETRY_SDK_VERSION],t))},e.prototype.merge=function(t){return t&&Object.keys(t.attributes).length?new e(Object.assign({},this.attributes,t.attributes)):this},e.EMPTY=new e({});var r=e;function e(t){this.attributes=t}i.Resource=r},function(t,i,n){var h=this&&this.__values||function(t){var i="function"==typeof Symbol&&Symbol.iterator,n=i&&t[i],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u},r=(Object.defineProperty(i,"u",{value:!0}),i.Span=void 0,n(6)),e=n(1),f=n(2),a=n(7),s=n(17);function u(t,i,n,r,e,s,u,o){void 0===o&&(o=[]),this.attributes={},this.links=[],this.events=[],this.status={code:f.SpanStatusCode.UNSET},this.endTime=0,this.N=!1,this.A=0,this.exported=!0,this.R=t.context,this.reporter=t.reporter,this.spanProcessor=t.spanProcessor,this.parentTracer=t,this.name=n,this.level=r,this.spanContext=e,this.parentSpanId=u,this.kind=s,this.links=o,this.startTime=Date.now(),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this.k=t.getActiveTraceParams(),this.I=new a.IdGenerator}u.prototype.context=function(){return this.spanContext},u.prototype.setAttribute=function(t,i){return null==i||0===t.length||!r.isAttributeValue(i)||Object.keys(this.attributes).length>=this.k.numberOfAttributesPerSpan&&!Object.prototype.hasOwnProperty.call(this.attributes,t)||(this.attributes[t]=i),this},u.prototype.appendAttribute=function(t,i){return null==i||0===t.length||!r.isAttributeValue(i)||Object.keys(this.attributes).length>=this.k.numberOfAttributesPerSpan&&!Object.prototype.hasOwnProperty.call(this.attributes,t)||(this.attributes[t]&&Array.isArray(this.attributes[t])?this.attributes[t].push(i):this.attributes[t]=[i]),this},u.prototype.setAttributes=function(t){var i,n;try{for(var r=h(Object.entries(t)),e=r.next();!e.done;e=r.next()){var s=c(e.value,2),u=s[0],o=s[1];this.setAttribute(u,o)}}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return this},u.prototype.addEvent=function(t,i,n){this.events.length>=this.k.numberOfEventsPerSpan&&this.events.shift();var r=this.I.generateEventId();return s.isTimeInput(i)&&(void 0===n&&(n=i),i=void 0),void 0===n&&(n=s.hrTime()),this.events.push({name:t,attributes:i,time:s.timeInputToHrTime(n),event_id:r}),this},u.prototype.setStatus=function(t){return this.status=t,this},u.prototype.updateName=function(t){return this.name=t,this},u.prototype.end=function(i){var t,n=this;this.D()||(this.N=!0,this.resource=this.parentTracer.resource,this.spanProcessor.spanBeforeEnd&&this.spanProcessor.spanBeforeEnd(this),t=s.getCurrentTime(),this.setAttribute("e_time_s",t),this.endTime=Date.now(),this.A=this.endTime-this.startTime,this.R.with(e.suppressInstrumentation(this.R.active()),function(){var t=n.P(n);n.spanProcessor.spanEnd&&n.spanProcessor.spanEnd(t,n.level),t.droped||!1===i||(delete t.droped,n.reporter.report(JSON.stringify(t),n.level))}))},u.prototype.spanReport=function(){var t=this.P(this);this.reporter.report(JSON.stringify(t),this.level)},u.prototype.isRecording=function(){return!1===this.N},Object.defineProperty(u.prototype,"duration",{get:function(){return this.A},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"ended",{get:function(){return this.N},enumerable:!1,configurable:!0}),u.prototype.D=function(){return this.N,this.N},u.prototype.P=function(t){var r=[],i=(t.events.forEach(function(i){var n={};Object.keys(i).forEach(function(t){"name"===t&&(n[t]=i[t]),"time"===t&&(n.timestamp=s.hrTimeToMilliseconds(i[t])),"attributes"===t&&(n.tags=i[t])}),r.push(n)}),[]);return t.links.forEach(function(t){i.push({span_id:t.context.spanId,trace_id:t.context.traceId})}),{trace_id:t.spanContext.traceId,parent_span_id:t.parentSpanId,name:t.name,span_id:t.spanContext.spanId,kind:t.kind,start_time:t.startTime,end_time:t.endTime,duration:t.duration,logs:r,tags:t.attributes,links:i}},i.Span=u},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.ZegoSpan=void 0;var r=n(3),s=n(9);function u(t,i){this.spanId=t,this.span=i}u.prototype.setAttribute=function(t,i){var n=this;return this.span?this.span.setAttribute(t,i):this.B().then(function(){n.span&&n.span.setAttribute(t,i)}),this},u.prototype.setAttributes=function(t){var i=this;return this.span?this.span.setAttributes(t):this.B().then(function(){i.span&&i.span.setAttributes(t)}),this},u.prototype.appendAttribute=function(t,i){var n=this;return this.span?this.span.appendAttribute(t,i):this.B().then(function(){n.span&&n.span.appendAttribute(t,i)}),this},u.prototype.addEvent=function(t,i,n){var r=this;return this.span?this.span.addEvent(t,i,n):this.B().then(function(){r.span&&r.span.addEvent(t,i,n)}),this},u.prototype.setStatus=function(t){var i=this;return this.span?this.span.setStatus(t):this.B().then(function(){i.span&&i.span.setStatus(t)}),this},u.prototype.updateName=function(t){var i=this;return this.span?this.span.updateName(t):this.B().then(function(){i.span&&i.span.updateName(t)}),this},u.prototype.end=function(t){var i=this;void 0===t&&(t=!0),this.span?this.span.end(t):this.B(!0).then(function(){i.span&&i.span.end(t),i.U()})},u.prototype.setSpanActive=function(t){this.activeCallback=t},u.prototype.setSpanEnd=function(t){this.endCallback=t},u.prototype.spanReport=function(){var t;null!=(t=this.span)&&t.spanReport()},u.prototype.U=function(){this.J()||(this.L(this.spanId),this.endCallback&&this.endCallback(this.spanInfo))},u.prototype.J=function(){return"noop"===this.spanId},u.prototype.B=function(r){var e=this;return void 0===r&&(r=!1),new Promise(function(n,i){e.store.getItem(e.spanId).then(function(t){var i=new s.Span(u.tracer,u.tracer.context.active(),t.name,t.level,t.spanContext,t.kind,t.parentSpanId,t.links);i.setStatus(t.status),i.setAttributes(t.attributes),e.span=i,e.activeCallback&&e.activeCallback(e.spanId,r),n()}).catch(function(t){i(t)})})},u.prototype.L=function(i){var n=this;this.store.getItem(i).then(function(t){t&&n.store.removeItem(i).then(function(){r.log.log("remove suc")}).catch(function(t){r.log.warn("remove fail")})})},i.ZegoSpan=u},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.createZegoStore=i.ZegoWechatMiniStore=i.ZEGO_ENV=void 0;var r,e,s=n(12),u=((e=r=i.ZEGO_ENV||(i.ZEGO_ENV={}))[e.BROWSER=0]="BROWSER",e[e.WEIXINMINI=1]="WEIXINMINI",n(3)),o=(h.prototype.getItem=function(n){var r=this;return new Promise(function(t,i){try{t(wx.getStorageSync(r.keyPrefix+n))}catch(t){i(t)}})},h.prototype.setItem=function(n,r){var e=this;return new Promise(function(t,i){try{wx.setStorageSync(e.keyPrefix+n,r),t()}catch(t){i(t)}})},h.prototype.removeItem=function(n){var r=this;return new Promise(function(t,i){try{t(wx.removeStorageSync(r.keyPrefix+n))}catch(t){i(t)}})},h.prototype.clear=function(){return new Promise(function(t,i){try{wx.clearStorageSync(),t()}catch(t){i(t)}})},h.prototype.keys=function(){var e=this;return new Promise(function(t,i){try{var n=wx.getStorageInfoSync().keys,r=(u.log.warn("keys",n),[]);n.forEach(function(t){0==t.indexOf(e.keyPrefix)&&r.push(t.replace(e.keyPrefix,""))}),u.log.warn("keyArr",JSON.stringify(r)),r.sort(),t(r)}catch(t){i(t)}})},h);function h(t){this.storeName=t,this.keyPrefix=t+"/",this.storeName}i.ZegoWechatMiniStore=o,i.createZegoStore=function(t,i,n){return i===r.BROWSER?s.createInstance({name:t+":"+(n||"store")}):new o(t)}},function(t,i){t.exports=n},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.DynamicCode=i.ZegoTracer=i.ZegoSpan=void 0;var r=n(14),e=(Object.defineProperty(i,"ZegoTracer",{enumerable:!0,get:function(){return r.ZegoTracer}}),n(46)),s=(Object.defineProperty(i,"DynamicCode",{enumerable:!0,get:function(){return e.DynamicCode}}),n(10));Object.defineProperty(i,"ZegoSpan",{enumerable:!0,get:function(){return s.ZegoSpan}})},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.ZegoTracer=void 0;var r=n(15),s=n(21),u=n(10),o=n(22),h=n(3),c=n(1),e=n(8),f=n(23),a=n(39),l=n(11),v=n(44),d=n(45);function y(t){this.q=o.DEFAULT_MAX_SPAN_SIZE,this.level=0,this.log=new v.ZegoLog,this.stateCenter=new d.StateCenter(this.log),this.stateCenter.proxyCtrl=t}y.prototype.init=function(t){this.options=t,this.name=t.product,this.reporter=new f.ZegoDataReport(this.name,this.stateCenter),this.reporter.init({appID:t.appID,env:t.env||0,importantLevel:t.importantLevel,levels:t.levels,deviceID:t.deviceID,bps:t.bps,serverUrl:t.serverUrl}),this.tracer=new r.Tracer({name:this.name,version:t.version},{resource:new e.Resource(t.resources)},this.reporter,{spanStart:t.spanStart,spanBeforeEnd:t.spanBeforeEnd,spanEnd:t.spanEnd}),this.reporter.setProcessData(this.tracer.resource.attributes),this.C(this.options),this.dyStore=l.createZegoStore(t.product+"_"+t.appID+"_dy",t.env||0)},y.prototype.C=function(t){this.rootSpan=this.tracer.startSpan("root",0);var i=c.setSpan(this.tracer.context.active(),this.rootSpan);this.tracer.context.T().M=i,this.rootSpan.end()},y.prototype.createSpan=function(t,i,n){var r,e;return t<=this.level?(r=n&&n.parent?c.setSpan(this.tracer.context.active(),n.parent.span):c.setSpan(this.tracer.context.active(),this.rootSpan),e=[],n&&n.linkSpans&&(n.linkSpans.forEach(function(t){e.push({context:t.span.context()})}),delete n.linkSpans),i=this.tracer.startSpan(i,t,Object.assign({},n,{links:e}),r),t=new u.ZegoSpan(i.spanContext.spanId,i),u.ZegoSpan.tracer=this.tracer,t):(h.log.warn("createSpan level not fix"),new u.ZegoSpan(o.NOOP_SPAN_ID,new s.NoopSpan))},y.prototype.setLogger=function(t){this.stateCenter.logger=t},y.prototype.setTimeOffset=function(t){this.reporter.setTimeOffset(t)},y.prototype.setWaitNtpTimeout=function(t){this.reporter.setWaitNtpTimeout(t)},y.prototype.setLogLevel=function(t){return this.stateCenter.F.setLogLevel(t)},y.prototype.startReport=function(t){return this.reporter.startReport(t)},y.prototype.setConfig=function(t){this.reporter.setConfig(t)},y.prototype.loadJs=function(t,i,n,r,e,s){return a.loadJS(t,this.dyStore,i,n,r,e,s)},y.prototype.flush=function(t){this.reporter.flush(t)},y.prototype.setUnloadState=function(t){this.reporter.setUnloadState(t)},y.prototype.shutdown=function(){this.reporter.saveDataBeforeUnload()},y.prototype.destroy=function(){this.reporter.uninit()},y.prototype.setSampleConfig=function(t){this.level=t.level||this.level},y.prototype.setResource=function(t){this.tracer.setResource(t),this.reporter.setProcessData(this.tracer.resource.attributes)},y.prototype.setNetStateCheck=function(){this.reporter.setNetStateCheck()},i.ZegoTracer=y},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.Tracer=void 0;var a=n(6),l=n(1),v=n(2),s=n(7),u=n(8),d=n(9),y=n(18),o=n(19);function r(t,i,n,r){var e=o.mergeConfig(i),i=(this.k=e.traceParams,this.I=new s.IdGenerator,this.resource=null!=(e=i.resource)?e:u.Resource.createTelemetrySDKResource(),this.instrumentationLibrary=t,Math.random().toString(36).slice(-6));this.context=new l.ContextAPI(i),this.reporter=n,this.spanProcessor=r||{}}r.prototype.startSpan=function(t,i,n,r){var e,s,u,o=((t,i)=>{if(!t.root)return l.getSpanContext(i)})(n=void 0===n?{}:n,r=void 0===r?this.context.active():r),h=this.I.generateSpanId(),o=(o&&y.isSpanContextValid(o)?(e=o.traceId,s=o.traceState,u=o.spanId):e=this.I.generateTraceId(),null!=(o=n.kind)?o:v.SpanKind.INTERNAL),c=null!=(c=n.links)?c:[],n=a.sanitizeAttributes(n.attributes),f=v.TraceFlags.NONE;return(r=new d.Span(this,r,t,i,{traceId:e,spanId:h,traceFlags:f,traceState:s},o,u,c)).setAttributes(n),this.spanProcessor.spanStart&&this.spanProcessor.spanStart(r),r},r.prototype.setResource=function(t){this.resource=this.resource.merge(new u.Resource(t))},r.prototype.getActiveTraceParams=function(){return this.k},i.Tracer=r},function(t,i,n){var r=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u},u=this&&this.__spread||function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(r(arguments[i]));return t},o=(Object.defineProperty(i,"u",{value:!0}),i.StackContextManager=void 0,n(1));function e(){this.W=!1,this.M=o.ROOT_CONTEXT}e.prototype.X=function(r,e){function t(){for(var t=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return s.with(e,function(){return r.apply(t,i)})}void 0===e&&(e=o.ROOT_CONTEXT);var s=this;return Object.defineProperty(t,"length",{enumerable:!1,configurable:!0,writable:!1,value:r.length}),t},e.prototype.active=function(){return this.M},e.prototype.bind=function(t,i){return void 0===(i=void 0===i?o.ROOT_CONTEXT:i)&&(i=this.active()),"function"==typeof t?this.X(t,i):t},e.prototype.disable=function(){return this.M=o.ROOT_CONTEXT,this.W=!1,this},e.prototype.enable=function(){return this.W||(this.W=!0,this.M=o.ROOT_CONTEXT),this},e.prototype.with=function(t,i,n){for(var r=[],e=3;e<arguments.length;e++)r[e-3]=arguments[e];var s=this.M;this.M=t||o.ROOT_CONTEXT;try{return i.call.apply(i,u([n],r))}finally{this.M=s}},i.StackContextManager=e},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.getCurrentTime=i.isTimeInput=i.hrTimeToMilliseconds=i.hrTimeDuration=i.timeInputToHrTime=i.isTimeInputHrTime=i.hrTime=void 0;var r=9,e=Math.pow(10,r),s=["00","01","02","03","04","05","06","07","08","09"];function u(t){var t=t/1e3,i=Math.trunc(t);return[i,Number((t-i).toFixed(r))*e]}function o(){var t,i=performance.timeOrigin;return"number"!=typeof i?(t=performance).timing&&t.timing.fetchStart:i}function h(t){var i=u(o()),t=u("number"==typeof t?t:performance.now()),n=i[0]+t[0];return e<(i=i[1]+t[1])&&(i-=e,n+=1),[n,i]}function c(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}i.hrTime=h,i.isTimeInputHrTime=c,i.timeInputToHrTime=function(t){if(c(t))return t;if("number"==typeof t)return(t<o()?h:u)(t);if(t instanceof Date)return u(t.getTime());throw TypeError("Invalid input type")},i.hrTimeDuration=function(t,i){var n=i[0]-t[0];return(i=i[1]-t[1])<0&&(--n,i+=e),[n,i]},i.hrTimeToMilliseconds=function(t){return Math.round(1e3*t[0]+t[1]/1e6)},i.isTimeInput=function(t){return c(t)||"number"==typeof t||t instanceof Date},i.getCurrentTime=function(){var t=new Date;return[t.getFullYear()+"/",(s[t.getMonth()+1]||t.getMonth()+1)+"/",(s[t.getDate()]||t.getDate())+" ",(s[t.getHours()]||t.getHours())+":",(s[t.getMinutes()]||t.getMinutes())+":",s[t.getSeconds()]||t.getSeconds(),"."+t.getTime()%1e3].join("")}},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.isSpanContextValid=i.isValidSpanId=i.isValidTraceId=i.INVALID_SPAN_CONTEXT=i.INVALID_TRACEID=i.INVALID_SPANID=void 0;var n=n(2),r=/^([0-9a-f]{32})$/i,e=/^[0-9a-f]{16}$/i;function s(t){return r.test(t)&&t!==i.INVALID_TRACEID}function u(t){return e.test(t)&&t!==i.INVALID_SPANID}i.INVALID_SPANID="0000000000000000",i.INVALID_TRACEID="00000000000000000000000000000000",i.INVALID_SPAN_CONTEXT={traceId:i.INVALID_TRACEID,spanId:i.INVALID_SPANID,traceFlags:n.TraceFlags.NONE},i.isValidTraceId=s,i.isValidSpanId=u,i.isSpanContextValid=function(t){return s(t.traceId)&&u(t.spanId)}},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.mergeConfig=void 0;var r=n(20);i.mergeConfig=function(t){var i=Object.assign({},r.DEFAULT_CONFIG,t);return i.traceParams=Object.assign({},r.DEFAULT_CONFIG.traceParams,t.traceParams||{}),i}},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.DEFAULT_CONFIG=void 0,i.DEFAULT_CONFIG={traceParams:{numberOfAttributesPerSpan:128,numberOfLinksPerSpan:128,numberOfEventsPerSpan:128}}},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.NoopSpan=void 0;var r=n(2);function e(t){void 0===t&&(t=r.INVALID_SPAN_CONTEXT),this.K=t}e.prototype.context=function(){return this.K},e.prototype.setAttribute=function(t,i){return this},e.prototype.appendAttribute=function(t,i){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,i,n){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.spanReport=function(){},e.prototype.recordException=function(t,i){},i.NoopSpan=e},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.NOOP_SPAN_ID=i.SCHEDULED_DELAY_MILLIS=i.DEFAULT_MAX_SPAN_SIZE=i.readSpanKeys=void 0,i.readSpanKeys=["name","level","kind","spanContext","parentSpanId","startTime","endTime","status","attributes","links","events","duration","ended","resource","instrumentationLibrary"],i.DEFAULT_MAX_SPAN_SIZE=1e3,i.SCHEDULED_DELAY_MILLIS=3e3,i.NOOP_SPAN_ID="noop"},function(t,i,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},s=this&&this.__awaiter||function(t,u,o,h){return new(o=o||Promise)(function(n,i){function r(t){try{s(h.next(t))}catch(t){i(t)}}function e(t){try{s(h.throw(t))}catch(t){i(t)}}function s(t){var i;t.done?n(t.value):((i=t.value)instanceof o?i:new o(function(t){t(i)})).then(r,e)}s((h=h.apply(t,u||[])).next())})},a=this&&this.__generator||function(r,e){var s,u,o,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:i(0),throw:i(1),return:i(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function i(n){return function(t){var i=[n,t];if(s)throw new TypeError("Generator is already executing.");for(;h;)try{if(s=1,u&&(o=2&i[0]?u.return:i[0]?u.throw||((o=u.return)&&o.call(u),0):u.next)&&!(o=o.call(u,i[1])).done)return o;switch(u=0,(i=o?[2&i[0],o.value]:i)[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,u=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(!(o=0<(o=h.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3]))h.label=i[1];else if(6===i[0]&&h.label<o[1])h.label=o[1],o=i;else{if(!(o&&h.label<o[2])){o[2]&&h.ops.pop(),h.trys.pop();continue}h.label=o[2],h.ops.push(i)}}i=e.call(r,h)}catch(t){i=[6,t],u=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},l=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u},e=this&&this.__spread||function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(l(arguments[i]));return t},v=this&&this.__values||function(t){var i="function"==typeof Symbol&&Symbol.iterator,n=i&&t[i],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},o=(Object.defineProperty(i,"u",{value:!0}),i.ZegoDataReport=void 0,n(0)),u=n(24),h=n(30),c=n(38),d=n(5),f=n(4);function y(t,i){this.G=i,this.QUEUE_MAX=100,this.cacheMaxSize=f.CACHE_SIZE.cacheMaxSize,this.cacheDelPer=f.CACHE_SIZE.cacheDelPer,this.state="normal",this.forceDataTotalLen=0,this.reportPackagesSize=0,this.staticConfig={totalAvailCache:f.CACHE_SIZE.totalAvailCache,totalDBSize:f.STORE_SIZE.totalDBSize,bps:1600},this.dataInDb=[],this.listenerList={progressUpdate:[],forceResult:[],postFail:[],dataDroped:[]},this.tempBuffer=[],this.traceType={MEM_I_API:0,MEM_O_DONE:0,MEM_O_DUMP:0,MEM_I_LOAD:0,DB_O_DROP:0,DB_O_DONE:0,DB_I_BACKUP:0},this.isPaused=!1,this.pro="json",this.isLoadReportData=!1,this.dropCount=0,this.timeInterval=!1,this.isWaitNtpTimeout=!1,this.waitNtpTimeout=2e3,this.postDataState="",this.product=t,this.reportMap=new Map}y.prototype.init=function(i){return s(this,void 0,void 0,function(){var n=this;return a(this,function(t){switch(t.label){case 0:return this.config=r(r({},f.DEFAULT_CONFIG),i),this.config.env%2!=1&&this.H(),this.zegoService=new u.ZegoService(this.config.env||o.ZEGO_ENV.BROWSER,this.config.bps||f.DEFAULT_CONFIG.bps,this.product,this.pro,this.G),this.zegoService.setLogUrlParams({product:this.product,signature:this.config.token||"",appid:this.config.appID,id_name:this.config.userID||"",deviceid:this.config.deviceID||""}),this.config.serverUrl&&this.zegoService.setLogServer(this.config.serverUrl),this.zegoService.setPostSucCallback(this.product,this.Y.bind(this)),this.zegoService.setPostFailCallback(this.product,function(i){return s(n,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.G.logger.warn("zt.zd.i fail"),this.postDataState="fail",this.dropCount++,this.V(i),[4,this.Z(1)];case 1:return t.sent(),this.$("postFail"),[2]}})})}),this.tt(),this.storeHandler=new h.ZegoStoreHandler(this.product+"_"+this.config.appID+"_datareporter",d.uuid(6),this.config,this.traceType,this.staticConfig,this.G,this.product),this.storeHandler.setDropCallBack(function(t){n.traceType.DB_O_DROP+=d.calculateMemSize(t),n.$("dataDroped",t)}),[4,this.storeHandler.loadPendingData()];case 1:return t.sent(),this.storeHandler.init().then(function(){n.it()}).catch(function(t){console.warn(t)}),this.nt(),this.rt(),this.et(),[2]}})})},y.prototype.uninit=function(){this.isWaitNtpTimeout=!1,this.ntpTimer&&(clearTimeout(this.ntpTimer),this.ntpTimer=null),this.zegoService.destroy()},y.prototype.setConfig=function(t){"object"==typeof t&&"number"==typeof t.bps&&(this.config.bps=t.bps,this.zegoService.setBps(this.config.bps)),"object"==typeof t&&"number"==typeof t.totalDBSize&&(this.staticConfig.totalDBSize=t.totalDBSize),"object"==typeof t&&"string"==typeof t.serverUrl&&""!==t.serverUrl&&(this.config.serverUrl=t.serverUrl,this.zegoService.setLogServer(this.config.serverUrl))},y.prototype.pause=function(){this.isPaused=!0},y.prototype.resume=function(){this.isPaused=!1;var t=this.pendingQueue.getPendingDataInfo(),i=t.pendingDataSize;this.st(i,t.size)},y.prototype.startReport=function(t){var i=t.get("userID"),n=t.get("token");return!(!i||"string"!=typeof i||!n||"string"!=typeof n||(this.startCommonField=t,this.config.userID=i,this.config.token=n,this.zegoService.setLogUrlParams({product:this.product,signature:this.config.token,appid:this.config.appID,id_name:this.config.userID||"",deviceid:this.config.deviceID||""}),this.ut()&&this.ot(),(i=t.get("serverUrl"))&&(this.config.serverUrl=i,this.zegoService.setLogServer(this.config.serverUrl)),this.isConfigOK(this.config)&&(t=(n=this.pendingQueue.getPendingDataInfo()).pendingDataSize,this.st(t,n.size)),0))},y.prototype.setTimeOffset=function(t){var i=this;this.clientTimeOffset=t,this.tempBuffer.forEach(function(t){(t=t.data).tags.time_offset||(t.tags.time_offset=i.clientTimeOffset)}),this.config.userID&&this.ot()},y.prototype.setProcessData=function(t){this.G.processData=t},y.prototype.on=function(t,i){return this.ht(t,i)},y.prototype.off=function(t,i){return this.ct(t,i)},y.prototype.report=function(t,i){var n;if(15e3<t.length)return!1;try{n=JSON.parse(t)}catch(t){return!1}return this.G.F.debug(t+" "+i),(null!=n&&n.id_name||null!=(t=null==n?void 0:n.tags)&&t.id_name||this.config.userID)&&this.ut()?(null!=n&&n.id_name||null!=(t=null==n?void 0:n.tags)&&t.id_name?this.clientTimeOffset&&(n.tags.time_offset=this.clientTimeOffset):(this.clientTimeOffset&&(n.tags.time_offset=this.clientTimeOffset),n.tags.id_name=this.config.userID),this.ft(JSON.stringify(n),i)):this.tempBuffer.push({data:n,level:i}),!0},y.prototype.setUnloadState=function(t){this.unloadLevel=t,this.state="unload"},y.prototype.ft=function(t,n){var r=this,i=d.calculateMemSize(t),e=(this.traceType.MEM_I_API+=i,o.getSeq()),s=(new Date).getTime(),u={seq:e,content:t,level:n,timestamp:s};"unload"===this.state?void 0!==this.unloadLevel&&n<=this.unloadLevel?(this.storeHandler.saveDataToStorage(u),this.pendingQueue.enqueue(u,n)):this.G.F.debug("level is low"):n<=this.config.importantLevel?(u.key=n+"_"+s+"_"+e,this.dataInDb.push(u.key),this.storeHandler.storeData(u).then(function(t){r.pendingQueue.enqueue(u,n),r.traceType.DB_I_BACKUP+=i}).catch(function(t){var i=r.dataInDb.findIndex(function(t){return t===u.key});-1<i&&r.dataInDb.splice(i,1),r.pendingQueue.enqueue(u,n)})):this.pendingQueue.enqueue(u,n),"force"===this.state&&(s=d.calculateMemSize(t),this.forceDataTotalLen+=s)},y.prototype.ut=function(){return this.isWaitNtpTimeout||void 0!==this.clientTimeOffset},y.prototype.ot=function(){var t,i=this.tempBuffer.shift();i&&(t=i.data,i=i.level,t.tags.id_name=this.config.userID,this.ft(JSON.stringify(t),i),this.ot())},y.prototype.isConfigOK=function(t){return""!==t.userID&&""!==t.token&&""!==t.server},y.prototype.testSize=function(t){},y.prototype.flush=function(t){var i;"force"!==this.state&&(this.state="force",i=16e6,"object"==typeof t&&"number"==typeof t.bps&&(i=t.bps),this.zegoService.setBps(i),this.forceDataTotalLen=this.storeHandler.storeSize+this.pendingQueue.pendingDataSize+this.reportPackagesSize,0<(i=(t=this.pendingQueue.getPendingDataInfo()).pendingDataSize)?this.st(i,t.size):this.it())},y.prototype.setWaitNtpTimeout=function(t){this.waitNtpTimeout=t},y.prototype.rt=function(){var t=this;this.ntpTimer=setTimeout(function(){t.isWaitNtpTimeout=!0,t.config.userID&&t.ot()},this.waitNtpTimeout)},y.prototype.nt=function(){var t=this,i=(this.G.F.debug("startReportTimer "+new Date),this.timeInterval=!0,this.pendingQueue.getPendingDataInfo()),n=i.pendingDataSize;this.st(n,i.size),this.reportTimer=window.setTimeout(function(){t.nt()},3e4)},y.prototype.et=function(){return s(this,void 0,void 0,function(){var i,n,r=this;return a(this,function(t){switch(t.label){case 0:return n=this.pendingQueue.getPendingDataInfo(),i=n.pendingDataSize,n=n.size,i>this.config.reportSize||n>this.config.reportNum?[4,this.st(i,n)]:[3,2];case 1:return t.sent(),[3,3];case 2:this.it(),t.label=3;case 3:return this.checkDataTimer=window.setTimeout(function(){r.et()},15e3),[2]}})})},y.prototype.H=function(){var t=this,i=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i);navigator.userAgent.indexOf("Firefox"),window.addEventListener(i?"pagehide":"beforeunload",function(){window.event&&(window.event.cancelBubble=!0),t.saveDataBeforeUnload()})},y.prototype.saveDataBeforeUnload=function(){(t=this.pendingQueue.readStoreData(1)).totalLen;var t=t.storeArr,i=(this.storeHandler.resetCommonStore(),[]),t=(i.push.apply(i,e(t)),this.zegoService.readReportQueueData());i.push.apply(i,e(t)),0<i.length&&this.storeHandler.storePendingData(i)},y.prototype.setNetStateCheck=function(){"fail"===this.postDataState&&this.zegoService.handleNetConnect()},y.prototype.Y=function(o,h,t){return s(this,void 0,void 0,function(){var i,n,r,e,s,u=this;return a(this,function(t){switch(t.label){case 0:for(this.G.F.debug("post suc"),this.postDataState="suc",o.forEach(function(t){u.traceType.MEM_O_DONE+=d.calculateMemSize(t.content)}),i=function(t){var i=o[t];n.storeHandler.removeDataItem(i).then(function(t){i.key&&u.reportMap.delete(i.key)}).catch(function(t){})},n=this,r=0;r<o.length;r++)i(r);return this.reportPackagesSize-=h,s=this.pendingQueue.getPendingDataInfo(),e=s.pendingDataSize,s=s.size,e>this.config.reportSize||s>this.config.reportNum?[4,this.st(e,s)]:[3,2];case 1:return t.sent(),[3,3];case 2:this.it(),t.label=3;case 3:return"force"===this.state&&0==this.reportPackagesSize&&(e=this.reportPackagesSize+this.pendingQueue.pendingDataSize+this.storeHandler.storeSize,s=1-Number((e/this.forceDataTotalLen).toFixed(2)),this.listenerList.progressUpdate&&this.$("progressUpdate",s),0<this.storeHandler.storeSize)&&this.it(function(t){0===t&&(u.state="normal",u.zegoService.setBps(u.config.bps||f.DEFAULT_CONFIG.bps),u.listenerList.forceSuccessCallback)&&u.$("forceResult","SUCCESS")}),[2]}})})},y.prototype.st=function(u,o){return s(this,void 0,void 0,function(){var i,n,r,e,s;return a(this,function(t){switch(t.label){case 0:return u>this.config.reportSize||o>this.config.reportNum||["force","unload"].includes(this.state)||this.timeInterval?(this.timeInterval=!1,!this.isPaused&&this.config.userID&&this.config.token&&this.config.serverUrl?[3,3]:(this.G.F.debug("isPaused "+this.isPaused+" "+this.userID+" "+this.config.token+" "+this.config.serverUrl),u>=this.cacheMaxSize||this.staticConfig.totalAvailCache<=0?[4,this.Z(this.cacheDelPer)]:[3,2])):[3,7];case 1:t.sent(),t.label=2;case 2:return[2];case 3:return this.zegoService.reportAllowed()?[3,6]:(this.zegoService.resumeReport(),u>=this.cacheMaxSize||this.staticConfig.totalAvailCache<=0?[4,this.Z(this.cacheDelPer)]:[3,5]);case 4:t.sent(),t.label=5;case 5:return[2];case 6:if(r=this.pendingQueue.readReportData(this.config.reportSize),i=r.totalLen,r=r.reportDataArr,i<=0)return[2];for(r=this.lt(r),n=r.packageArr,r=r.packageLen,this.zegoService.report(n,r,this.product,"unload"===this.state),e=0;e<n.length;e++)s=n[e],this.reportMap.set(s.key,s);this.reportPackagesSize+=r,this.pendingQueue.refresh(i),t.label=7;case 7:return[2]}})})},y.prototype.tt=function(){var r=this;this.pendingQueue=new c.PendingQueue(this.config.levels,this.product,this.staticConfig,this.G),this.pendingQueue.setListener({enCallback:function(t,i,n){return s(r,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.st(n,i)];case 1:return t.sent(),[2]}})})}})},y.prototype.vt=function(){var n=this;this.storeHandler.readStoreDataItem().then(function(t){var i=d.calculateMemSize(t.content);n.traceType.MEM_I_LOAD+=i,n.pendingQueue.enqueue(t,t.level)}).catch(function(t){})},y.prototype.Z=function(f){return s(this,void 0,void 0,function(){var e,i,n,s,r,u,o,h,c;return a(this,function(t){switch(t.label){case 0:i=this.pendingQueue.readStoreData(f),e=i.totalLen,i=i.storeArr,n=function(i){var n,r;return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,s.dt(i,e)];case 1:return t.sent(),n=i.level+"_"+i.timestamp+"_"+i.seq,-1<(r=s.dataInDb.findIndex(function(t){return t===n}))&&s.dataInDb.splice(r,1),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}})},s=this,t.label=1;case 1:t.trys.push([1,6,7,8]),r=v(i),u=r.next(),t.label=2;case 2:return u.done?[3,5]:(o=u.value,[5,n(o)]);case 3:t.sent(),t.label=4;case 4:return u=r.next(),[3,2];case 5:return[3,8];case 6:return o=t.sent(),h={error:o},[3,8];case 7:try{u&&!u.done&&(c=r.return)&&c.call(r)}finally{if(h)throw h.error}return[7];case 8:return[2]}})})},y.prototype.V=function(t){var r=this;t.length&&t.forEach(function(n){r.storeHandler.storeData(n).then(function(t){var i=d.calculateMemSize(n.content);r.traceType.MEM_O_DUMP+=i}).catch(function(t){})})},y.prototype.dt=function(e,t){var i=this;return new Promise(function(n,r){return s(i,void 0,void 0,function(){var i;return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.storeHandler.storeData(e)];case 1:return t.sent(),i=d.calculateMemSize(e.content),this.traceType.MEM_O_DUMP+=i,n(),[3,3];case 2:return i=t.sent(),r(i),[3,3];case 3:return[2]}})})})},y.prototype.it=function(i){var n=this;this.storeHandler.storeSize<=0||this.isLoadReportData||(this.isLoadReportData=!0,this.storeHandler.loadDBData(this.config.reportSize,5,Math.floor(this.cacheMaxSize/3),function(t){return-1<n.dataInDb.indexOf(t)}).then(function(t){n.isLoadReportData=!1,t.datas.forEach(function(t){var i;n.reportMap.has(t.key)||n.pendingQueue.findInQueue(t)||(i=d.calculateMemSize(t.content),n.traceType.MEM_I_LOAD+=i,n.pendingQueue.enqueue(t,t.level),n.dataInDb.push(t.key))}),i&&i(t.len)}).catch(function(t){n.isLoadReportData=!1}))},y.prototype.lt=function(t){var c=this,f=0;return t.forEach(function(t){var i,n,r=JSON.parse(t.content);if(c.startCommonField)try{for(var e=v(c.startCommonField),s=e.next();!s.done;s=e.next()){var u=l(s.value,2),o=u[0],h=u[1];"userID"!==o&&"token"!==o&&"serverUrl"!==o&&(r[o]=h)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=e.return)&&n.call(e)}finally{if(i)throw i.error}}f+=d.calculateMemSize(r),t.content=JSON.stringify(r)}),{packageArr:t,packageLen:f}},y.prototype.ht=function(t,i){return!!this.listenerList[t]&&"function"==typeof i&&(-1==this.listenerList[t].indexOf(i)&&this.listenerList[t].push(i),!0)},y.prototype.ct=function(t,i){var n;return!!this.listenerList[t]&&(n=this.listenerList[t],i?n.splice(n.indexOf(i),1):this.listenerList[t]=[],!0)},y.prototype.$=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.listenerList[t]&&this.listenerList[t].forEach(function(t){try{t.apply(void 0,e(i))}catch(t){}})},i.ZegoDataReport=y},function(t,i,n){var r=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u},u=this&&this.__spread||function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(r(arguments[i]));return t},c=(Object.defineProperty(i,"u",{value:!0}),i.ZegoService=void 0,n(0)),f=n(25),e=n(29),s=n(4);function o(t,i,n,r,e){var s,u,o,h=this;this.yt=t,this.wt=n,this.bt=r,this.G=e,this.isDestroy=!1,this.packageLen=0,this.packagesDataSize=0,this.PACKAGE_MAX_LEN=5,this.msgID=0,this.logUploadTimer=null,this.logUploadInterval=1e4,this.logCacheSend=[],this.logCacheMax=100,this.gt=1e3,this.postSucCallbackList={},this.postFailCallbackList={},this.failCount=0,this.failStartTime=0,this.netWorkFail=!1,this.networkState=c.ENUM_NETWORK_STATE.online,this.state=0,this._t=(u=s=0,o=function(){u=s=0},{onOpen:function(){s=performance.now()},onClose:function(){0<s&&(performance.now()-s<100?(u++,h.G.logger.info("zt.rzs.wfsc frequently shutdown.")):o())},isOutOfMaxTimes:function(){return 10<=u}}),this.Ot={offline:function(){h.networkState=c.ENUM_NETWORK_STATE.offline},online:function(t){h.handleNetConnect()}},this.bindWindowListener(),this.networkState=c.ENUM_NETWORK_STATE.online,this.service=new f.LogService(t,n,r,e),this.service.onHbTimeout=function(){h.G.logger.warn("zt.rzs.ohbto hb timeout."),h.socketReconnect(!0,!0)},this.setBps(i),this.reportQueue=new c.Queue}o.prototype.destroy=function(){this.St(),this.logUploadTimer&&clearTimeout(this.logUploadTimer),this.reportQueue.clear(),window.removeEventListener("offline",this.Ot.offline),window.removeEventListener("online",this.Ot.online),this.isDestroy=!0},o.prototype.bindWindowListener=function(){window.addEventListener("offline",this.Ot.offline),window.addEventListener("online",this.Ot.online)},o.prototype.handleNetConnect=function(){var t;this.networkState=c.ENUM_NETWORK_STATE.online,1===this.logType?this.socketReconnect():(t=this.url,this.url="",this.setLogServer(t)),this.netWorkFail=!1},o.prototype.setLogServer=function(t){try{return t.startsWith("wss:")||t.startsWith("ws:")?(this.logType=1,this.Mt(t)):t.startsWith("https:")||t.startsWith("http:")?(this.logType=2,this.Et(t)):this.logType=0,!0}catch(t){return!1}},o.prototype.setLogUrlParams=function(t){this.logParams=t},o.prototype.Mt=function(t){var i=this;this.url!=t&&(this.url=t)&&(this.St(),this.logParams.id_name)&&(this._t.isOutOfMaxTimes()?(this.G.logger.warn("zt.rzs.owsls frequently shutdown too many times. cannot create socket anymore."),this.state=0):(this.state=1,t+="?product="+this.logParams.product+"&appid="+this.logParams.appid+"&token="+encodeURIComponent(this.logParams.signature)+"&deviceid="+this.logParams.deviceid+"&id_name="+this.logParams.id_name,this.service.createSocket(t),this.service.openHandler(function(){i.service.onPush(),i.service.startCheck(),i.G.logger.info("zt.rzs.owsls socket open"),i.openHandler(),i._t.onOpen()}),this.service.closeHandler(function(t){i.G.logger.warn("zt.rzs.owsls socket close "+JSON.stringify(t.code||t)),i.state=0,i.service.closeSocket(),i._t.onClose(),i.service.url&&i.socketReconnect(!1)}),this.service.errorHandler(function(t){i.G.logger.warn("zt.rzs.owsls socket error "+JSON.stringify(t.code||t)),i.state=0,i.service.closeSocket(),i.service.url&&i.socketReconnect(!1)})))},o.prototype.St=function(){this.service.closeSocket(!0),this.jt&&(clearTimeout(this.jt),this.jt=void 0)},o.prototype.Et=function(t){(this.url=t)&&this.Tt()},o.prototype.Tt=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},o.prototype.Nt=function(t,i,n,r){this.yt===c.ZEGO_ENV.BROWSER?this.At(t,i,n,r):this.SendHttpsLogWeChatMini(t,i,n,r)},o.prototype.At=function(t,i,n,r){var e=this,t=JSON.stringify({body:{data:t}}),s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status){if(0!=s.responseText.length)try{var t=JSON.parse(s.responseText).interval;"number"==typeof t&&e.logUploadInterval!==t&&e.Et(e.url),n&&n()}catch(t){r&&r()}}else r&&r()},s.open("POST",this.url,!0),s.send(t)},o.prototype.SendHttpsLogWeChatMini=function(t,i,n,r){var e=this,t={appid:this.logParams.appid+"",timestamp:(new Date).getTime()+"",token:this.logParams.signature,id_name:this.logParams.id_name,product:this.logParams.product,message_id:++this.msgID,req_sdk:1,s:JSON.stringify({speed_detail:t})};wx.request({url:this.url,data:JSON.stringify(t),method:"POST",success:function(t){0!=t.data.length&&("number"==typeof(t=t&&t.data&&t.data.interval)&&e.logUploadInterval!==t&&e.Et(e.url),n)&&n()},fail:function(t){r&&r()}})},o.prototype.openHandler=function(){this.state=2,this.startReport()},o.prototype.setPostSucCallback=function(t,i){this.postSucCallbackList[t]=i},o.prototype.setPostFailCallback=function(t,i){this.postFailCallbackList[t]=i},o.prototype.reportAllowed=function(){return this.packageLen<this.PACKAGE_MAX_LEN},o.prototype.report=function(t,i,n,r){this.packageLen++,this.packagesDataSize+=i,this.reportQueue.enqueue({reportDatas:t,dataLen:i,product:n}),this.netWorkFail=!1,this.failCount=0,this.failStartTime=0,this.startReport(r)},o.prototype.setBps=function(t){this.tokenBucket=new e.TokenBucket(s.BUCKET_CONFIG.bucketSize,t/8,"sec")},o.prototype.startReport=function(t){var i,n,r,e,s=this;this.isDestroy||1===this.logType&&this.socketReconnect()||0<this.reportQueue.size()&&(i=this.reportQueue.dequeue(),n=i.reportDatas,r=i.dataLen,e=i.product,new Date,t?this.sendReport(n,r,e):this.tokenBucket.removeTokens(r,function(){s.sendReport(n,r,e)}))},o.prototype.Rt=function(){if(this.failCount<=0)return!1;1==this.failCount&&(this.failStartTime=Date.now());var t=(Date.now()-this.failStartTime)/1e3;return this.failCount>=s.FAIL_COUNT&&t>s.FAIL_TIME||this.failCount>=s.FAIL_MAX_COUNT},o.prototype.sendReport=function(n,r,e){var s=this;this.reportData(n,r,e,function(){s.failCount=0,s.failStartTime=0,s.packageLen--,s.packagesDataSize-=r,s.postSucCallbackList[e]&&s.postSucCallbackList[e](n,r,e)},function(t){var i;s.reportQueue.enqueue({reportDatas:n,dataLen:r,product:e}),s.failCount++,s.Rt()?(s.netWorkFail=!0,i=s.decodeReportQueue(),Object.keys(s.postFailCallbackList).forEach(function(t){s.postFailCallbackList[e](i[t])})):s.startReport()})},o.prototype.resumeReport=function(){!0===this.netWorkFail&&this.networkState===c.ENUM_NETWORK_STATE.online&&(this.netWorkFail=!1,this.startReport())},o.prototype.reportData=function(t,i,n,r,e){var s=this,u=[];t.forEach(function(t){u.push(JSON.parse(t.content))}),1==this.logType?this.networkState===c.ENUM_NETWORK_STATE.offline?e&&e(c.errorList.BROKEN):this.service.sendMessage("report",u,r,function(t){var i;0===s.state&&t===c.SOCKET_DISCONNECT&&(i=s.url,s.url="",s.setLogServer(i)),e&&e(t)}):2==this.logType&&this.Nt(u,i,r,function(){e&&e()})},o.prototype.unsigned2signed=function(t){var i=parseInt(t,10);if(256<i)return i%256;for(var n=[];0<i;)i%2!=0?n.push(1):n.push(0),i=Number(i/2);for(n.reverse();n.length<8;)n.unshift(0);var r="";if(1==(n=n.join("")).substr(0,1)){for(var e=1;e<n.length;e++)1==n.substr(e,1)?r+=0:r+=1;return"-"+(parseInt(r,2)+1)}for(e=0;e<n.length;e++)r+=n.substr(e,1);return parseInt(r,2)},o.prototype.decodeReportQueue=function(){for(var t={},i=this.reportQueue.size(),n=0;n<i;n++){var r=this.reportQueue.dequeue(),e=r.reportDatas,s=r.dataLen;t[r=r.product]||(t[r]=[]),t[r]=u(t[r],e),this.reportQueue.enqueue({reportDatas:e,dataLen:s,product:r})}return t},o.prototype.readReportQueueData=function(){for(var t=[],i=this.reportQueue.size(),n=0;n<i;n++){var r=this.reportQueue.dequeue().reportDatas;t.push.apply(t,u(r))}return t},o.prototype.socketReconnect=function(t,i){var n=this,r=(void 0===t&&(t=!0),(i=void 0!==i&&i)||0===this.state);return this.jt&&!t||r&&(t&&this.jt&&(clearTimeout(this.jt),this.jt=void 0),this.jt||(this.jt=setTimeout(function(){var t;!n.isDestroy&&(n.jt&&(clearTimeout(n.jt),n.jt=void 0),i||0===n.state)&&(t=n.url,n.url="",n.setLogServer(t))},t?0:5e3))),r},i.ZegoService=o},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.LogService=void 0;var e=n(26),s=n(4),u=n(0);function r(t,i,n,r){this.yt=t,this.wt=i,this.bt=n,this.G=r,this.kt=new e.ZegoSocketService(this.yt,this.wt,this.bt,this.G),this.It=0,this.Dt={},this.xt=void 0,this.checkHbTimer=void 0}Object.defineProperty(r.prototype,"url",{get:function(){return this.Pt},enumerable:!1,configurable:!0}),r.prototype.Bt=function(t){var i,n,r=this,e=this.kt.sendCommandMap[t.messageId||(null==(e=null==t?void 0:t.data)?void 0:e.message_id)];null!=e&&(n=e.v,delete this.kt.sendCommandMap[t.messageId||(null==(i=null==t?void 0:t.data)?void 0:i.message_id)],this.kt.sendCommandList.remove(e),0===t.code?setTimeout(function(){n&&null!=n.success&&n.success(t,r.It)},0):setTimeout(function(){n&&null!=n.error&&n.error(t,r.It)},0))},r.prototype.onPush=function(){var i=this;this.kt.onMessage=function(t){i.xt=performance.now(),i.startHbTimer(),i.Bt(t)}},r.prototype.closeHandler=function(i){this.kt.closeHandler(function(t){i(t)})},r.prototype.openHandler=function(t){var i=this;this.kt.openHandler(function(){i.xt=performance.now(),i.startHbTimer(),t&&t()})},r.prototype.errorHandler=function(i){this.kt.errorHandler(function(t){i(t)})},r.prototype.Ut=function(t){return{Protocol:"req",cmd:t,appid:123,seq:++this.It,session_id:""}},r.prototype.startCheck=function(){this.kt.startCheck()},r.prototype.stopCheck=function(){this.kt.stopCheck()},r.prototype.isDisConnect=function(){return!this.kt||this.kt.isDisConnect()},r.prototype.createSocket=function(t){this.kt.createSocket(t),this.Dt={},this.Pt=t},r.prototype.closeSocket=function(t){void 0===t&&(t=!1),this.xt=void 0,this.clearHbTimer(),this.kt.closeSocket(),t&&(this.Pt=void 0)},r.prototype.sendMessage=function(t,i,n,r,e){return this.kt.isDisConnect()?(r&&r(u.SOCKET_DISCONNECT),0):(e=e||this.Ut(t),this.kt.sendMessage(e,i,n,r,{timeOut:1e3*s.DEFAULT_CONFIG.netTimeout}))},r.prototype.on=function(t,i){this.Dt[t]=i},r.prototype.clearHbTimer=function(){this.checkHbTimer&&(clearTimeout(this.checkHbTimer),this.checkHbTimer=void 0)},r.prototype.startHbTimer=function(){var t=this;this.clearHbTimer(),this.kt.isDisConnect()||(void 0!==this.xt&&15e3<performance.now()-this.xt?this.Pt&&this.onHbTimeout():this.checkHbTimer=setTimeout(function(){t.kt.isDisConnect()||(t.sendMessage("report",[]),t.startHbTimer())},5e3))},r.prototype.onHbTimeout=function(){},i.LogService=r},function(t,i,n){var u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},r=(Object.defineProperty(i,"u",{value:!0}),i.ZegoSocketService=void 0,n(27)),s=n(0),o=n(28);function e(t,i,n,r){this.wt=i,this.bt=n,this.G=r,this.zt=null,this.sendCommandList=new s.LinkedList,this.sendCommandMap={},this.Jt=100,this.Lt=3e4,this.qt=2e3,this.Ot={},this.ENV=t}e.prototype.createSocket=function(t){var i=this;this.zt=r.createZegoWebSocket(t,this.ENV,this.G.proxyCtrl),this.zt.onclose=function(t){i.Ot.close&&i.Ot.close(t)},this.zt.onerror=function(t){i.Ot.error&&i.Ot.error(t)},this.zt.binaryType="arraybuffer"},e.prototype.closeSocket=function(){this.zt&&(this.zt.onclose=null,this.zt.onerror=null,this.zt.close(),this.zt=null)},e.prototype.isDisConnect=function(){return!this.zt||1!==this.zt.readyState},e.prototype.sendMessage=function(t,i,n,r,e){void 0===e&&(e={timeOut:6e3});var s=u(u({},this.G.processData),{time_upload:Date.now()}),s={data:i={message_id:t.seq,product:this.wt,s:JSON.stringify({speed_detail:i,process:s})},seq:t.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeOut:e.timeOut,success:n,error:r},e=this.sendCommandList.push(s);return this.sendCommandMap[s.seq]=e,this.zt&&"pb"!==this.bt&&(this.G.F.debug("upload data",JSON.stringify(i)),n=o.deflate(JSON.stringify(i)),this.zt.send(n)),t.seq},e.prototype.Ct=function(t){for(var i=t.getFirst();null!=i;)t.remove(i),i.v&&i.v.error&&setTimeout(function(){i&&i.v&&i.v.error&&i.v.error(s.errorList.TIMEOUT,i.v.data.message_id,i.v.data.s)},0),i=t.getFirst()},e.prototype.Ft=function(t,i){for(var n=t.getFirst(),r=Date.parse(new Date+""),e=0;!(null==n||n.v&&n.v.sendTime+n.v.timeOut>r||(n.v&&delete i[n.v.data.message_id],t.remove(n),!(n.v&&null==n.v.error||n.v&&n.v.sendTime+this.Lt<r)&&n&&n.v&&n.v.error&&n.v.error(s.errorList.TIMEOUT,n.v.data.message_id,n.v.data.s),++e>=this.Jt));)n=t.getFirst()},e.prototype.startCheck=function(){var t=this;this.Ft(this.sendCommandList,this.sendCommandMap),this.Wt=setTimeout(function(){t.startCheck()},this.qt)},e.prototype.stopCheck=function(){this.Ct(this.sendCommandList),clearTimeout(this.Wt)},e.prototype.openHandler=function(i){var n=this;this.zt&&(this.zt.onopen=function(t){n.responseHandler(),i(t)})},e.prototype.responseHandler=function(){var i=this;this.zt&&(this.zt.onmessage=function(t){t="string"==typeof t.data?JSON.parse(t.data):JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t.data))),i.onMessage(t)})},e.prototype.closeHandler=function(t){this.Ot.close=t},e.prototype.errorHandler=function(t){this.Ot.error=t},e.prototype.onMessage=function(t){},i.ZegoSocketService=e},function(t,i,n){Object.defineProperty(i,"u",{value:!0}),i.createZegoWebSocket=i.ZegoWeiXinMiniWebSocket=void 0;var r=n(0),e=(s.prototype.init=function(){var i=this;this.Xt&&(this.readyState=0,this.Xt.onOpen(function(t){i.readyState=i.Xt.readyState,"function"==typeof i.onopen&&(i.onopen(t),i.Xt.onClose(function(t){i.readyState=i.Xt.readyState,"function"==typeof i.onclose&&i.onclose(t)}),i.Xt.onMessage(function(t){"function"==typeof i.onmessage&&i.onmessage(t)}))}),this.Xt.onError(function(t){i.readyState=i.Xt.readyState,"function"==typeof i.onerror&&i.onerror(t)}))},s.prototype.onopen=function(t){},s.prototype.onerror=function(t){},s.prototype.onclose=function(t){},s.prototype.onmessage=function(t){},s.prototype.send=function(t){this.Xt&&this.Xt.send({data:t})},s.prototype.close=function(){this.Xt&&this.Xt.close()},s);function s(t,i){this.url=t,this.readyState=3,this.Xt=wx.connectSocket({url:t}),this.init()}i.ZegoWeiXinMiniWebSocket=e,i.createZegoWebSocket=function(t,i,n){return i%2===r.ZEGO_ENV.BROWSER?(i=t,n?n.createSocket(i,1):new WebSocket(i)):new e(t)}},function(t,i){t.exports=r},function(t,i,n){function r(t,i,n,r){if(this.bucketSize=1,this.tokensPerInterval=1,this.interval=1e3,this.parentBucket=null,this.content=0,this.lastDrip=0,this.bucketSize=t,this.tokensPerInterval=i,"string"==typeof n)switch(n){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+n)}else this.interval=n;this.parentBucket=r,this.content=0,this.lastDrip=+new Date}Object.defineProperty(i,"u",{value:!0}),i.TokenBucket=void 0,r.prototype.removeTokens=function(n,r){var e=this;return this.bucketSize?n>this.bucketSize?(setTimeout(r.bind(null,"Requested tokens "+n+" exceeds bucket size "+this.bucketSize,null),0),!1):(this.drip(),n>this.content?s():this.parentBucket?this.parentBucket.removeTokens(n,function(t,i){return t?r(t,null):n>e.content?s():(e.content-=n,void r(null,Math.min(i,e.content)))}):(this.content-=n,setTimeout(r.bind(null,null,this.content),0),!0)):(setTimeout(r.bind(null,null,n,Number.POSITIVE_INFINITY),0),!0);function s(){var t=Math.ceil((n-e.content)*(e.interval/e.tokensPerInterval));return setTimeout(function(){e.removeTokens(n,r)},t),!1}},r.prototype.tryRemoveTokens=function(t){if(this.bucketSize){if(t>this.bucketSize)return!1;if(this.drip(),t>this.content)return!1;if(this.parentBucket&&!this.parentBucket.tryRemoveTokens(t))return!1;this.content-=t}return!0},r.prototype.drip=function(){var t,i;this.tokensPerInterval?(i=+new Date,t=Math.max(i-this.lastDrip,0),this.lastDrip=i,i=t*(this.tokensPerInterval/this.interval),this.content=Math.min(this.content+i,this.bucketSize)):this.content=this.bucketSize},i.TokenBucket=r},function(t,i,n){var b=this&&this.__awaiter||function(t,u,o,h){return new(o=o||Promise)(function(n,i){function r(t){try{s(h.next(t))}catch(t){i(t)}}function e(t){try{s(h.throw(t))}catch(t){i(t)}}function s(t){var i;t.done?n(t.value):((i=t.value)instanceof o?i:new o(function(t){t(i)})).then(r,e)}s((h=h.apply(t,u||[])).next())})},p=this&&this.__generator||function(r,e){var s,u,o,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:i(0),throw:i(1),return:i(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function i(n){return function(t){var i=[n,t];if(s)throw new TypeError("Generator is already executing.");for(;h;)try{if(s=1,u&&(o=2&i[0]?u.return:i[0]?u.throw||((o=u.return)&&o.call(u),0):u.next)&&!(o=o.call(u,i[1])).done)return o;switch(u=0,(i=o?[2&i[0],o.value]:i)[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,u=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(!(o=0<(o=h.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3]))h.label=i[1];else if(6===i[0]&&h.label<o[1])h.label=o[1],o=i;else{if(!(o&&h.label<o[2])){o[2]&&h.ops.pop(),h.trys.pop();continue}h.label=o[2],h.ops.push(i)}}i=e.call(r,h)}catch(t){i=[6,t],u=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},r=this&&this.__importDefault||function(t){return t&&t.u?t:{default:t}},v=(Object.defineProperty(i,"u",{value:!0}),i.ZegoStoreHandler=void 0,n(11)),m=n(5),o=n(4),e=r(n(12));function s(t,i,n,r,e,s,u){this.O=t,this.Kt=i,this.Gt=n,this.Ht=r,this.Yt=e,this.G=s,this.wt=u,this.storeSize=0,this.storeTime=0,this.storeDelPer=o.STORE_SIZE.storeDelPer,this.updateTimeFreq=6e4,this.storeSleepInterval=6e5,this.droping=!1,this.bufferData=[],this.updateTimer=null,this.interSymbol="#",this.drops=[],this.storesKeys="",this.transStores=[],this.store=v.createZegoStore(t,n.env,i),this.commonStore=v.createZegoStore("data_common",n.env,"reporter")}Object.defineProperty(s.prototype,"Vt",{get:function(){return"z_t_"+this.wt+"_"+this.Gt.appID},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"Zt",{get:function(){return"z_store_keys"},enumerable:!1,configurable:!0}),s.prototype.init=function(){return b(this,void 0,void 0,function(){var i,n;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,6,,7]),this.setCommonStoreState(),[4,this.transferStoreData()];case 1:return t.sent(),[4,this.commonStore.getItem(this.O+this.interSymbol+this.Kt)];case 2:return(i=t.sent())?[3,4]:(n={storeSize:this.storeSize,lock:0,pros:1},[4,this.commonStore.setItem(this.O+this.interSymbol+this.Kt,n)]);case 3:return t.sent(),[3,5];case 4:n="string"==typeof i?JSON.parse(i):i,this.storeSize=n.storeSize,t.label=5;case 5:return[3,7];case 6:return t.sent(),[3,7];case 7:return[2]}})})},s.prototype.uninit=function(){this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)},s.prototype.setCommonStoreState=function(){var i=this,t=(this.getStorage(this.Zt)||"").split(";"),t=(this.transStores=t.filter(function(t){return t.includes(i.Gt.appID+"")&&t.includes(i.wt)}),t.filter(function(t){return!t.includes(i.Gt.appID+"")||!t.includes(i.wt)}));this.storesKeys=t.join(";")},s.prototype.resetCommonStore=function(){return b(this,void 0,void 0,function(){var i;return p(this,function(t){switch(t.label){case 0:return i=0<this.storesKeys.length?";":"",this.saveStorage(this.Zt,this.storesKeys+i+this.O+this.interSymbol+this.Kt),[4,this.commonStore.setItem(this.O+this.interSymbol+this.Kt,{storeSize:this.storeSize,lock:0,pros:0})];case 1:return t.sent(),[2]}})})},s.prototype.transferStoreData=function(){return b(this,void 0,void 0,function(){var f,i,a,n,l=this;return p(this,function(t){switch(t.label){case 0:return[4,this.commonStore.keys()];case 1:f=t.sent(),i=function(i){var n,r,e,s,o,h,u,c;return p(this,function(t){switch(t.label){case 0:return(n=f[i])===a.O+a.interSymbol+a.Kt?[3,9]:[4,a.commonStore.getItem(n)];case 1:return(r="string"==typeof(r=t.sent())?JSON.parse(r):r).lock||r.pros&&!a.transStores.includes(n)?[3,9]:(s=n.split(a.interSymbol),e=s[0],s=s[1],[4,(o=v.createZegoStore(e,a.Gt.env,s)).keys()]);case 2:return 0!=(h=t.sent()).length?[3,3]:[3,8];case 3:return r.lock=1,[4,a.commonStore.setItem(n,r)];case 4:t.sent(),u=function(i){var n,r,e,s,u;return p(this,function(t){switch(t.label){case 0:return n=h[i],[4,o.getItem(n)];case 1:return r=t.sent(),-1!==n.indexOf("pending")?r&&JSON.parse(r).forEach(function(i){return b(l,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.storeData(i)];case 1:return t.sent(),[2]}})})}):(u=m.analyzeKey(n),e=u.level,s=u.timestamp,u=u.seq,a.storeData({level:e,timestamp:s,seq:u,content:r})),setTimeout(function(){return b(l,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,o.removeItem(n)];case 1:return t.sent(),[2]}})})},300),[2]}})},c=0,t.label=5;case 5:return c<h.length?[5,u(c)]:[3,8];case 6:t.sent(),t.label=7;case 7:return c++,[3,5];case 8:a.drops.push({name:e,storeName:s}),t.label=9;case 9:return[2]}})},a=this,n=0,t.label=2;case 2:return n<f.length?[5,i(n)]:[3,5];case 3:t.sent(),t.label=4;case 4:return n++,[3,2];case 5:return this.transportStorageData(),setTimeout(function(){return b(l,void 0,void 0,function(){var i,n,r;return p(this,function(t){switch(t.label){case 0:i=0,t.label=1;case 1:if(!(i<this.drops.length))return[3,7];r=this.drops[i],n=r.name,r=r.storeName,t.label=2;case 2:return t.trys.push([2,5,,6]),[4,this.dropInstance(n,r)];case 3:return t.sent(),[4,this.commonStore.removeItem(n+this.interSymbol+r)];case 4:case 5:return t.sent(),[3,6];case 6:return i++,[3,1];case 7:return[2]}})})},1e3),[2]}})})},s.prototype.dropInstance=function(n,r){return new Promise(function(t,i){e.default.dropInstance({name:n+":"+r}).then(function(){t()}).catch(function(t){i(t)})})},s.prototype.setDropCallBack=function(t){this.dropCallBack=t},s.prototype.storeData=function(o){var i=this;return new Promise(function(u,t){return b(i,void 0,void 0,function(){var i,n,r,e,s=this;return p(this,function(t){switch(t.label){case 0:i=o.level,n=o.content,r=i+"_"+o.timestamp+"_"+o.seq,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.store.getItem(r)];case 2:return t.sent()?(u(),[2]):[3,4];case 3:return t.sent(),[3,4];case 4:if(this.droping)return this.bufferData.push(o),[2];if(e=m.calculateMemSize(r)+m.calculateMemSize(n),this.Yt.totalDBSize-e<=0)return this.dropDBData(i,r,n).then(function(){s.droping=!1,s.bufferDump()}).catch(function(t){}),u(),[2];t.label=5;case 5:return t.trys.push([5,8,,9]),[4,this.store.setItem(r,n)];case 6:return t.sent(),this.storeSize+=e,this.Yt.totalDBSize-=e,[4,this.Qt()];case 7:return t.sent(),u(),[3,9];case 8:return"QuotaExceededError"===t.sent().name&&this.dropDBData(i,r,n).then(function(){s.droping=!1,s.bufferDump()}).catch(function(t){}),[3,9];case 9:return[2]}})})})},s.prototype.loadPendingData=function(){return b(this,void 0,void 0,function(){var i=this;return p(this,function(t){switch(t.label){case 0:return[4,this.store.keys()];case 1:return t.sent().forEach(function(r){return b(i,void 0,void 0,function(){var i,n=this;return p(this,function(t){switch(t.label){case 0:return-1===r.indexOf("pending")?[3,3]:[4,this.store.getItem(r)];case 1:return(i=t.sent())?(JSON.parse(i).forEach(function(i){return b(n,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.storeData(i)];case 1:return t.sent(),[2]}})})}),[4,this.store.removeItem(r)]):[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})}),[2]}})})},s.prototype.storePendingData=function(i){return b(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.store.setItem("pending"+(new Date).getTime(),JSON.stringify(i))];case 1:return t.sent(),[2]}})})},s.prototype.bufferDump=function(){return b(this,void 0,void 0,function(){var i;return p(this,function(t){switch(t.label){case 0:return(i=this.bufferData.pop())?[4,this.storeData(i)]:[3,2];case 1:t.sent(),this.bufferDump(),t.label=2;case 2:return[2]}})})},s.prototype.dropDBData=function(t,h,c){return b(this,void 0,void 0,function(){var i=this;return p(this,function(t){return this.droping=!0,[2,new Promise(function(u,o){return b(i,void 0,void 0,function(){var i,n,r,e,s;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,10,,11]),[4,this.store.keys()];case 1:(i=t.sent()).reverse(),n=Math.ceil(i.length*this.storeDelPer),r=0,t.label=2;case 2:return r<n?[4,this.store.getItem(i[r])]:[3,7];case 3:return null==(e=t.sent())?[3,6]:[4,this.store.removeItem(i[r])];case 4:return t.sent(),s=m.calculateMemSize(i[r])+m.calculateMemSize(e),this.Yt.totalDBSize+=s,this.storeSize-=s,[4,this.Qt()];case 5:t.sent(),this.dropCallBack(e),t.label=6;case 6:return r++,[3,2];case 7:return[4,this.store.setItem(h,c)];case 8:return t.sent(),this.storeSize+=m.calculateMemSize(h)+m.calculateMemSize(c),[4,this.Qt()];case 9:return t.sent(),u(),[3,11];case 10:return s=t.sent(),o(s),[3,11];case 11:return[2]}})})})]})})},s.prototype.removeDataItem=function(u){var t=this;return new Promise(function(e,s){return b(t,void 0,void 0,function(){var i,n,r;return p(this,function(t){switch(t.label){case 0:i=(i=u.level)+"_"+u.timestamp+"_"+u.seq,t.label=1;case 1:return t.trys.push([1,6,,7]),[4,this.store.getItem(i)];case 2:return(n=t.sent())?[4,this.store.removeItem(i)]:[3,5];case 3:return t.sent(),r=1==this.Gt.env?m.calculateMemSize(JSON.parse(n)):m.calculateMemSize(n),r=m.calculateMemSize(i)+r,this.storeSize-=r,this.Yt.totalDBSize+=r,this.Ht.DB_O_DONE+=r,[4,this.Qt()];case 4:t.sent(),e(),t.label=5;case 5:return[3,7];case 6:return r=t.sent(),s(r),[3,7];case 7:return[2]}})})})},s.prototype.Qt=function(){return b(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,this.commonStore.getItem(this.O+this.interSymbol+this.Kt)];case 1:return t.sent()?[4,this.commonStore.setItem(this.O+this.interSymbol+this.Kt,{storeSize:this.storeSize,lock:0,pros:1})]:[3,3];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:return t.sent(),[3,5];case 5:return[2]}})})},s.prototype.readStoreDataItem=function(){var t=this;return new Promise(function(s,u){return b(t,void 0,void 0,function(){var i,n,r,e;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.store.keys()];case 1:return i=t.sent(),[4,this.store.getItem(i[0])];case 2:return n=t.sent(),r=m.analyzeKey(i[0]),e=r.level,s({level:e,timestamp:r.timestamp,seq:r.seq,content:n}),[3,4];case 3:return e=t.sent(),u(e),[3,4];case 4:return[2]}})})})},s.prototype.loadDBData=function(v,d,y,w){var t=this;return new Promise(function(a,l){return b(t,void 0,void 0,function(){var i,n,r,e,s,u,o,h,c,f;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,6,,7]),[4,this.store.keys()];case 1:i=t.sent(),n=[],u=s=e=r=0,t.label=2;case 2:return u<i.length?w(i[u])?[3,4]:[4,this.store.getItem(i[u])]:[3,5];case 3:if(null==(o=t.sent()))return[3,4];if(h=m.analyzeKey(i[u]),c=h.level,f=h.timestamp,h=h.seq,n.push({level:c,timestamp:f,seq:h,content:o,key:i[u]}),c=m.calculateMemSize(o),e+=c,v<=(r+=c)&&(r=0,s++),d<=s&&y<=e)return[3,5];t.label=4;case 4:return u++,[3,2];case 5:return a({datas:n,len:e}),[3,7];case 6:return f=t.sent(),l(f),[3,7];case 7:return[2]}})})})},s.prototype.sortKeys=function(t,i){void 0===i&&(i=!1),t.sort(function(t,i){t=t.split("_");return+(i=i.split("_"))[0]-+t[0]||+i[1]-+t[1]||+i[2]-+t[2]}),i&&t.reverse()},s.prototype.saveStorage=function(t,i){try{localStorage.setItem(t,i)}catch(t){this.G.F.debug("storage set err")}},s.prototype.getStorage=function(t){try{return localStorage.getItem(t)}catch(t){this.G.F.debug("storage get err")}},s.prototype.saveDataToStorage=function(t){try{var i=t.level,n=t.content,r=i+"_"+t.timestamp+"_"+t.seq;this.saveStorage(this.Vt+"_"+r,n)}catch(t){this.G.F.debug("saveDataToStorage "+JSON.stringify(t))}},s.prototype.transportStorageData=function(){for(var i=[],t=0;t<localStorage.length;t++){var n,r,e,s,u=localStorage.key(t);this.G.F.debug("transportStorageData "+u),null!=u&&u.startsWith(this.Vt)&&(e=u.replace(this.Vt+"_",""),n=(e=m.analyzeKey(e)).level,r=e.timestamp,e=e.seq,"string"==typeof(s=this.getStorage(u))&&this.storeData({level:n,timestamp:r,seq:e,content:s}),i.push(u))}setTimeout(function(){for(var t=0;t<i.length;t++)localStorage.removeItem(i[t])},100)},i.ZegoStoreHandler=s},function(t,i,n){var h=n(32),c=n(33).Buffer;function f(o){return function(t){if(c.isBuffer(t))return t.length;switch(typeof t){case"string":return t.length*h.STRING;case"boolean":return h.BOOLEAN;case"number":return h.NUMBER;case"symbol":return Symbol.keyFor&&Symbol.keyFor(t)?Symbol.keyFor(t).length*h.STRING:(t.toString().length-8)*h.STRING;case"object":if(Array.isArray(t))return t.map(f(o)).reduce(function(t,i){return t+i},0);else{var i=o;var n=t;if(null==n)return 0;for(var r=0,e=(t=>{var i,n=[];for(i in t)n.push(i);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(t),Array.prototype.push.apply(n,t)),n})(n),s=0;s<e.length;s++){var u=e[s];if("object"==typeof n[u]&&null!==n[u]){if(i.has(n[u]))continue;i.add(n[u])}r+=f(i)(u);try{r+=f(i)(n[u])}catch(i){i instanceof RangeError&&(r=0)}}return r;return}default:return 0}}}t.exports=function(t){return f(new WeakSet)(t)}},function(t,i){t.exports={STRING:2,BOOLEAN:4,NUMBER:8}},function(t,k,i){!function(t){var O=i(35),s=i(36),o=i(37);function n(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function h(t,i){if(n()<i)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(i)).__proto__=a.prototype:(t=null===t?new a(i):t).length=i,t}function a(t,i,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,i,n);if("number"!=typeof t)return r(this,t,i,n);if("string"==typeof i)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}function r(t,i,n,r){if("number"==typeof i)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer){var e=t,s=i,u=n;if(s.byteLength,u<0||s.byteLength<u)throw new RangeError("'offset' is out of bounds");if(s.byteLength<u+(r||0))throw new RangeError("'length' is out of bounds");return s=void 0===u&&void 0===r?new Uint8Array(s):void 0===r?new Uint8Array(s,u):new Uint8Array(s,u,r),a.TYPED_ARRAY_SUPPORT?(e=s).__proto__=a.prototype:e=c(e,s),e}if("string"!=typeof i){if(u=t,r=i,a.isBuffer(r))return 0!==(u=h(u,s=0|f(r.length))).length&&r.copy(u,0,0,s),u;if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||(s=r.length)!=s?h(u,0):c(u,r);if("Buffer"===r.type&&o(r.data))return c(u,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}e=t;if(r=i,a.isEncoding(t="string"==typeof(t=n)&&""!==t?t:"utf8"))return i=0|l(r,t),(r=(e=h(e,i)).write(r,t))!==i?e.slice(0,r):e;throw new TypeError('"encoding" must be a valid string encoding')}function e(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,i){if(e(i),t=h(t,i<0?0:0|f(i)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<i;++n)t[n]=0;return t}function c(t,i){var n=i.length<0?0:0|f(i.length);t=h(t,n);for(var r=0;r<n;r+=1)t[r]=255&i[r];return t}function f(t){if(n()<=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|t}function l(t,i){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;var n=(t="string"!=typeof t?""+t:t).length;if(0===n)return 0;for(var r=!1;;)switch(i){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return A(t).length;default:if(r)return N(t).length;i=(""+i).toLowerCase(),r=!0}}function v(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function d(t,i,n,r,e){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,(n=(n=isNaN(n)?e?0:t.length-1:n)<0?t.length+n:n)>=t.length){if(e)return-1;n=t.length-1}else if(n<0){if(!e)return-1;n=0}if("string"==typeof i&&(i=a.from(i,r)),a.isBuffer(i))return 0===i.length?-1:y(t,i,n,r,e);if("number"==typeof i)return i&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(e?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,i,n):y(t,[i],n,r,e);throw new TypeError("val must be string, number or Buffer")}function y(t,i,n,r,e){var s=1,u=t.length,o=i.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||i.length<2)return-1;u/=s=2,o/=2,n/=2}function h(t,i){return 1===s?t[i]:t.readUInt16BE(i*s)}if(e)for(var c=-1,f=n;f<u;f++)if(h(t,f)===h(i,-1===c?0:f-c)){if(f-(c=-1===c?f:c)+1===o)return c*s}else-1!==c&&(f-=f-c),c=-1;else for(f=n=u<n+o?u-o:n;0<=f;f--){for(var a=!0,l=0;l<o;l++)if(h(t,f+l)!==h(i,l)){a=!1;break}if(a)return f}return-1}function b(t,i,n,r){return R((t=>{for(var i=[],n=0;n<t.length;++n)i.push(255&t.charCodeAt(n));return i})(i),t,n,r)}function S(t,i,n){n=Math.min(t.length,n);for(var r=[],e=i;e<n;){var s,u,o,h,c=t[e],f=null,a=239<c?4:223<c?3:191<c?2:1;if(e+a<=n)switch(a){case 1:c<128&&(f=c);break;case 2:128==(192&(s=t[e+1]))&&127<(h=(31&c)<<6|63&s)&&(f=h);break;case 3:s=t[e+1],u=t[e+2],128==(192&s)&&128==(192&u)&&2047<(h=(15&c)<<12|(63&s)<<6|63&u)&&(h<55296||57343<h)&&(f=h);break;case 4:s=t[e+1],u=t[e+2],o=t[e+3],128==(192&s)&&128==(192&u)&&128==(192&o)&&65535<(h=(15&c)<<18|(63&s)<<12|(63&u)<<6|63&o)&&h<1114112&&(f=h)}null===f?(f=65533,a=1):65535<f&&(r.push((f-=65536)>>>10&1023|55296),f=56320|1023&f),r.push(f),e+=a}var l=r,v=l.length;if(v<=w)return String.fromCharCode.apply(String,l);for(var d="",y=0;y<v;)d+=String.fromCharCode.apply(String,l.slice(y,y+=w));return d}k.Buffer=a,k.SlowBuffer=function(t){return a.alloc(+(t=+t!=t?0:t))},k.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:(()=>{try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}})(),k.kMaxLength=n(),a.poolSize=8192,a.$t=function(t){return t.__proto__=a.prototype,t},a.from=function(t,i,n){return r(null,t,i,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol)&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0}),a.alloc=function(t,i,n){return e(t),t<=0||void 0===i?h(null,t):"string"==typeof n?h(null,t).fill(i,n):h(null,t).fill(i)},a.allocUnsafe=function(t){return u(null,t)},a.allocUnsafeSlow=function(t){return u(null,t)},a.isBuffer=function(t){return!(null==t||!t.ti)},a.compare=function(t,i){if(!a.isBuffer(t)||!a.isBuffer(i))throw new TypeError("Arguments must be Buffers");if(t===i)return 0;for(var n=t.length,r=i.length,e=0,s=Math.min(n,r);e<s;++e)if(t[e]!==i[e]){n=t[e],r=i[e];break}return n<r?-1:r<n?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,i){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);if(void 0===i)for(e=i=0;e<t.length;++e)i+=t[e].length;for(var n=a.allocUnsafe(i),r=0,e=0;e<t.length;++e){var s=t[e];if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},a.byteLength=l,a.prototype.ti=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<t;i+=2)v(this,i,i+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<t;i+=4)v(this,i,i+3),v(this,i+1,i+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<t;i+=8)v(this,i,i+7),v(this,i+1,i+6),v(this,i+2,i+5),v(this,i+3,i+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?S(this,0,t):function(t,i,n){var r,e,s=!1;if((i=void 0===i||i<0?0:i)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(i>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":var u=i,o=n,h=this.length;(!o||o<0||h<o)&&(o=h);for(var c="",f=u=!u||u<0?0:u;f<o;++f)c+=(e=this[f])<16?"0"+e.toString(16):e.toString(16);return c;case"utf8":case"utf-8":return S(this,i,n);case"ascii":for(var h=i,a=n,l="",a=Math.min(this.length,a),v=h;v<a;++v)l+=String.fromCharCode(127&this[v]);return l;case"latin1":case"binary":for(var u=i,d=n,y="",d=Math.min(this.length,d),w=u;w<d;++w)y+=String.fromCharCode(this[w]);return y;case"base64":return b=this,r=n,0===(p=i)&&r===b.length?O.fromByteArray(b):O.fromByteArray(b.slice(p,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var b=i,p=n,m=this.slice(b,p),g="",_=0;_<m.length;_+=2)g+=String.fromCharCode(m[_]+256*m[_+1]);return g;default:if(s)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),s=!0}}.apply(this,arguments)},a.prototype.equals=function(t){if(a.isBuffer(t))return this===t||0===a.compare(this,t);throw new TypeError("Argument must be a Buffer")},a.prototype.inspect=function(){var t="",i=k.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i)&&(t+=" ... "),"<Buffer "+t+">"},a.prototype.compare=function(t,i,n,r,e){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===e&&(e=this.length),(i=void 0===i?0:i)<0||n>t.length||r<0||e>this.length)throw new RangeError("out of range index");if(e<=r&&n<=i)return 0;if(e<=r)return-1;if(n<=i)return 1;if(this===t)return 0;for(var s=(e>>>=0)-(r>>>=0),u=(n>>>=0)-(i>>>=0),o=Math.min(s,u),h=this.slice(r,e),c=t.slice(i,n),f=0;f<o;++f)if(h[f]!==c[f]){s=h[f],u=c[f];break}return s<u?-1:u<s?1:0},a.prototype.includes=function(t,i,n){return-1!==this.indexOf(t,i,n)},a.prototype.indexOf=function(t,i,n){return d(this,t,i,n,!0)},a.prototype.lastIndexOf=function(t,i,n){return d(this,t,i,n,!1)},a.prototype.write=function(t,i,n,r){if(void 0===i)r="utf8",n=this.length,i=0;else if(void 0===n&&"string"==typeof i)r=i,n=this.length,i=0;else{if(!isFinite(i))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");i|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var e=this.length-i;if((void 0===n||e<n)&&(n=e),0<t.length&&(n<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var s,u,o,h,c,f=!1;;)switch(r){case"hex":var a,l=t,v=n,d=(a=Number(i)||0,this.length-a);if((!v||d<(v=Number(v)))&&(v=d),(d=l.length)%2!=0)throw new TypeError("Invalid hex string");d/2<v&&(v=d/2);for(var y=0;y<v;++y){var w=parseInt(l.substr(2*y,2),16);if(isNaN(w))return y;this[a+y]=w}return y;case"utf8":case"utf-8":return d=i,u=n,R(N(t,(s=this).length-d),s,d,u);case"ascii":return b(this,t,i,n);case"latin1":case"binary":return b(this,t,i,n);case"base64":return s=this,u=i,h=n,R(A(t),s,u,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h=i,c=n,R(((t,i)=>{for(var n,r,e=[],s=0;s<t.length&&!((i-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,e.push(n%256),e.push(r);return e})(t,(o=this).length-h),o,h,c);default:if(f)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function p(t,i,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+i)throw new RangeError("Trying to access beyond buffer length")}function m(t,i,n,r,e,s){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e<i||i<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function g(t,i,n,r){i<0&&(i=65535+i+1);for(var e=0,s=Math.min(t.length-n,2);e<s;++e)t[n+e]=(i&255<<8*(r?e:1-e))>>>8*(r?e:1-e)}function _(t,i,n,r){i<0&&(i=4294967295+i+1);for(var e=0,s=Math.min(t.length-n,4);e<s;++e)t[n+e]=i>>>8*(r?e:3-e)&255}function M(t,i,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function E(t,i,n,r,e){return e||M(t,0,n,4),s.write(t,i,n,r,23,4),n+4}function j(t,i,n,r,e){return e||M(t,0,n,8),s.write(t,i,n,r,52,8),n+8}a.prototype.slice=function(t,i){var n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(i=void 0===i?n:~~i)<0?(i+=n)<0&&(i=0):n<i&&(i=n),i<t&&(i=t),a.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,i)).__proto__=a.prototype;else for(var r=i-t,e=new a(r,void 0),s=0;s<r;++s)e[s]=this[s+t];return e},a.prototype.readUIntLE=function(t,i,n){t|=0,i|=0,n||p(t,i,this.length);for(var r=this[t],e=1,s=0;++s<i&&(e*=256);)r+=this[t+s]*e;return r},a.prototype.readUIntBE=function(t,i,n){t|=0,i|=0,n||p(t,i,this.length);for(var r=this[t+--i],e=1;0<i&&(e*=256);)r+=this[t+--i]*e;return r},a.prototype.readUInt8=function(t,i){return i||p(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,i){return i||p(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,i){return i||p(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,i){return i||p(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,i){return i||p(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,i,n){t|=0,i|=0,n||p(t,i,this.length);for(var r=this[t],e=1,s=0;++s<i&&(e*=256);)r+=this[t+s]*e;return(e*=128)<=r&&(r-=Math.pow(2,8*i)),r},a.prototype.readIntBE=function(t,i,n){t|=0,i|=0,n||p(t,i,this.length);for(var r=i,e=1,s=this[t+--r];0<r&&(e*=256);)s+=this[t+--r]*e;return(e*=128)<=s&&(s-=Math.pow(2,8*i)),s},a.prototype.readInt8=function(t,i){return i||p(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,i){return i||p(t,2,this.length),32768&(i=this[t]|this[t+1]<<8)?4294901760|i:i},a.prototype.readInt16BE=function(t,i){return i||p(t,2,this.length),32768&(i=this[t+1]|this[t]<<8)?4294901760|i:i},a.prototype.readInt32LE=function(t,i){return i||p(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,i){return i||p(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,i){return i||p(t,4,this.length),s.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,i){return i||p(t,4,this.length),s.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,i){return i||p(t,8,this.length),s.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,i){return i||p(t,8,this.length),s.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,i,n,r){t=+t,i|=0,n|=0,r||m(this,t,i,n,Math.pow(2,8*n)-1,0);var e=1,s=0;for(this[i]=255&t;++s<n&&(e*=256);)this[i+s]=t/e&255;return i+n},a.prototype.writeUIntBE=function(t,i,n,r){t=+t,i|=0,n|=0,r||m(this,t,i,n,Math.pow(2,8*n)-1,0);var e=n-1,s=1;for(this[i+e]=255&t;0<=--e&&(s*=256);)this[i+e]=t/s&255;return i+n},a.prototype.writeUInt8=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[i]=255&t,i+1},a.prototype.writeUInt16LE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8):g(this,t,i,!0),i+2},a.prototype.writeUInt16BE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[i]=t>>>8,this[i+1]=255&t):g(this,t,i,!1),i+2},a.prototype.writeUInt32LE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[i+3]=t>>>24,this[i+2]=t>>>16,this[i+1]=t>>>8,this[i]=255&t):_(this,t,i,!0),i+4},a.prototype.writeUInt32BE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[i]=t>>>24,this[i+1]=t>>>16,this[i+2]=t>>>8,this[i+3]=255&t):_(this,t,i,!1),i+4},a.prototype.writeIntLE=function(t,i,n,r){t=+t,i|=0,r||m(this,t,i,n,(r=Math.pow(2,8*n-1))-1,-r);var e=0,s=1,u=0;for(this[i]=255&t;++e<n&&(s*=256);)t<0&&0===u&&0!==this[i+e-1]&&(u=1),this[i+e]=(t/s>>0)-u&255;return i+n},a.prototype.writeIntBE=function(t,i,n,r){t=+t,i|=0,r||m(this,t,i,n,(r=Math.pow(2,8*n-1))-1,-r);var e=n-1,s=1,u=0;for(this[i+e]=255&t;0<=--e&&(s*=256);)t<0&&0===u&&0!==this[i+e+1]&&(u=1),this[i+e]=(t/s>>0)-u&255;return i+n},a.prototype.writeInt8=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[i]=255&(t=t<0?255+t+1:t),i+1},a.prototype.writeInt16LE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8):g(this,t,i,!0),i+2},a.prototype.writeInt16BE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[i]=t>>>8,this[i+1]=255&t):g(this,t,i,!1),i+2},a.prototype.writeInt32LE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8,this[i+2]=t>>>16,this[i+3]=t>>>24):_(this,t,i,!0),i+4},a.prototype.writeInt32BE=function(t,i,n){return t=+t,i|=0,n||m(this,t,i,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[i]=t>>>24,this[i+1]=t>>>16,this[i+2]=t>>>8,this[i+3]=255&t):_(this,t,i,!1),i+4},a.prototype.writeFloatLE=function(t,i,n){return E(this,t,i,!0,n)},a.prototype.writeFloatBE=function(t,i,n){return E(this,t,i,!1,n)},a.prototype.writeDoubleLE=function(t,i,n){return j(this,t,i,!0,n)},a.prototype.writeDoubleBE=function(t,i,n){return j(this,t,i,!1,n)},a.prototype.copy=function(t,i,n,r){if(n=n||0,r||0===r||(r=this.length),i>=t.length&&(i=t.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===t.length||0===this.length)return 0;if((i=i||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var e,s=(r=t.length-i<r-n?t.length-i+n:r)-n;if(this===t&&n<i&&i<r)for(e=s-1;0<=e;--e)t[e+i]=this[e+n];else if(s<1e3||!a.TYPED_ARRAY_SUPPORT)for(e=0;e<s;++e)t[e+i]=this[e+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),i);return s},a.prototype.fill=function(t,i,n,r){if("string"==typeof t){var e;if("string"==typeof i?(r=i,i=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length&&(e=t.charCodeAt(0))<256&&(t=e),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(i<0||this.length<i||this.length<n)throw new RangeError("Out of range index");if(!(n<=i))if(i>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(t=t||0))for(o=i;o<n;++o)this[o]=t;else for(var s=a.isBuffer(t)?t:N(new a(t,r).toString()),u=s.length,o=0;o<n-i;++o)this[o+i]=s[o%u];return this};var T=/[^+\/0-9A-Za-z-_]/g;function N(t,i){i=i||1/0;for(var n,r=t.length,e=null,s=[],u=0;u<r;++u){if(55295<(n=t.charCodeAt(u))&&n<57344){if(!e){if(56319<n){-1<(i-=3)&&s.push(239,191,189);continue}if(u+1===r){-1<(i-=3)&&s.push(239,191,189);continue}e=n;continue}if(n<56320){-1<(i-=3)&&s.push(239,191,189),e=n;continue}n=65536+(e-55296<<10|n-56320)}else e&&-1<(i-=3)&&s.push(239,191,189);if(e=null,n<128){if(--i<0)break;s.push(n)}else if(n<2048){if((i-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((i-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((i-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function A(t){return O.toByteArray((t=>{var i;if((t=((i=t).trim?i.trim():i.replace(/^\s+|\s+$/g,"")).replace(T,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t})(t))}function R(t,i,n,r){for(var e=0;e<r&&!(e+n>=i.length||e>=t.length);++e)i[e+n]=t[e];return e}}.call(this,i(34))},function(t,i){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,i,n){i.byteLength=function(t){return 3*((t=f(t))[0]+(t=t[1]))/4-t},i.toByteArray=function(t){for(var i,n=f(t),r=n[0],e=new c(3*(r+(n=n[1]))/4-n),s=0,u=0<n?r-4:r,o=0;o<u;o+=4)i=h[t.charCodeAt(o)]<<18|h[t.charCodeAt(o+1)]<<12|h[t.charCodeAt(o+2)]<<6|h[t.charCodeAt(o+3)],e[s++]=i>>16&255,e[s++]=i>>8&255,e[s++]=255&i;return 2===n&&(i=h[t.charCodeAt(o)]<<2|h[t.charCodeAt(o+1)]>>4,e[s++]=255&i),1===n&&(i=h[t.charCodeAt(o)]<<10|h[t.charCodeAt(o+1)]<<4|h[t.charCodeAt(o+2)]>>2,e[s++]=i>>8&255,e[s++]=255&i),e},i.fromByteArray=function(t){for(var i,n=t.length,r=n%3,e=[],s=0,u=n-r;s<u;s+=16383)e.push(((t,i)=>{for(var n,r=[],e=s;e<i;e+=3)n=(t[e]<<16&16711680)+(t[e+1]<<8&65280)+(255&t[e+2]),r.push(o[n>>18&63]+o[n>>12&63]+o[n>>6&63]+o[63&n]);return r.join("")})(t,u<s+16383?u:s+16383));return 1==r?(i=t[n-1],e.push(o[i>>2]+o[i<<4&63]+"==")):2==r&&(i=(t[n-2]<<8)+t[n-1],e.push(o[i>>10]+o[i>>4&63]+o[i<<2&63]+"=")),e.join("")};for(var o=[],h=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,s=r.length;e<s;++e)o[e]=r[e],h[r.charCodeAt(e)]=e;function f(t){var i=t.length;if(0<i%4)throw new Error("Invalid string. Length must be a multiple of 4");return i=(t=-1===(t=t.indexOf("="))?i:t)===i?0:4-t%4,[t,i]}h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},function(t,i){i.read=function(t,i,n,r,e){var s,u,o=8*e-r-1,h=(1<<o)-1,c=h>>1,f=-7,a=n?e-1:0,l=n?-1:1,e=t[i+a];for(a+=l,s=e&(1<<-f)-1,e>>=-f,f+=o;0<f;s=256*s+t[i+a],a+=l,f-=8);for(u=s&(1<<-f)-1,s>>=-f,f+=r;0<f;u=256*u+t[i+a],a+=l,f-=8);if(0===s)s=1-c;else{if(s===h)return u?NaN:1/0*(e?-1:1);u+=Math.pow(2,r),s-=c}return(e?-1:1)*u*Math.pow(2,s-r)},i.write=function(t,i,n,r,e,s){var u,o,h=8*s-e-1,c=(1<<h)-1,f=c>>1,a=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,l=r?0:s-1,v=r?1:-1,s=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(o=isNaN(i)?1:0,u=c):(u=Math.floor(Math.log(i)/Math.LN2),i*(r=Math.pow(2,-u))<1&&(u--,r*=2),2<=(i+=1<=u+f?a/r:a*Math.pow(2,1-f))*r&&(u++,r/=2),c<=u+f?(o=0,u=c):1<=u+f?(o=(i*r-1)*Math.pow(2,e),u+=f):(o=i*Math.pow(2,f-1)*Math.pow(2,e),u=0));8<=e;t[n+l]=255&o,l+=v,o/=256,e-=8);for(u=u<<e|o,h+=e;0<h;t[n+l]=255&u,l+=v,u/=256,h-=8);t[n+l-v]|=128*s}},function(t,i){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,i,n){var f=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u},r=this&&this.__spread||function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(f(arguments[i]));return t},s=(Object.defineProperty(i,"u",{value:!0}),i.PendingQueue=void 0,n(0)),a=n(5);function e(t,i,n,r){var e=this;this.ii=t,this.wt=i,this.Yt=n,this.G=r,this.byteLength=0,this.size=0,this.pendingDataSize=0,this.cacheMap=new Map,t.forEach(function(t){e.cacheMap.set(t,new s.Queue)})}e.prototype.enqueue=function(i,t){(t=this.cacheMap.get(t))&&!t.all().find(function(t){return t.content==i.content})&&(t.enqueue(i),t=a.calculateMemSize(i.content),this.pendingDataSize+=t,this.size++,this.Yt.totalAvailCache-=t,this.enCallback)&&this.enCallback(this.byteLength,this.size,this.pendingDataSize)},e.prototype.dequeue=function(t){return t=null==(t=this.cacheMap.get(t))?void 0:t.dequeue(),this.size--,this.deCallback&&this.deCallback(),t},e.prototype.findInQueue=function(i){var t=null==(t=this.cacheMap.get(i.level))?void 0:t.all();return null==t?void 0:t.find(function(t){return t.key===i.key})},e.prototype.readReportData=function(t){var i=r(this.cacheMap.entries()),i=this.readData(i,t,!0);return this.reset(),{totalLen:i.totalLen,reportDataArr:i.resArr}},e.prototype.readStoreData=function(t){var t=Math.ceil(this.pendingDataSize*t),i=r(this.cacheMap.entries()).reverse(),i=this.readData(i,t,!1);return this.refresh(i.totalLen),{totalLen:i.totalLen,storeArr:i.resArr}},e.prototype.readData=function(t,i,n){var r=[],e=0;t:for(var s=0;s<t.length;s++)for(var u=f(t[s],2),o=u[0],h=u[1];h.size();){var c=this.dequeue(o);if(r.push(c),i<(e+=a.calculateMemSize(c.content)))break t}return{totalLen:e,resArr:r}},e.prototype.decodeReportData=function(t){var i=this;t.forEach(function(t){i.enqueue(t,t.level)})},e.prototype.setListener=function(t){this.enCallback=t.enCallback,this.deCallback=t.deCallback},e.prototype.getPendingDataInfo=function(){return{pendingDataSize:this.pendingDataSize,size:this.size}},e.prototype.refresh=function(t){this.pendingDataSize-=t,this.Yt.totalAvailCache+=t},e.prototype.reset=function(){this.byteLength=0},i.PendingQueue=e},function(t,i,n){var g=this&&this.__awaiter||function(t,u,o,h){return new(o=o||Promise)(function(n,i){function r(t){try{s(h.next(t))}catch(t){i(t)}}function e(t){try{s(h.throw(t))}catch(t){i(t)}}function s(t){var i;t.done?n(t.value):((i=t.value)instanceof o?i:new o(function(t){t(i)})).then(r,e)}s((h=h.apply(t,u||[])).next())})},_=this&&this.__generator||function(r,e){var s,u,o,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:i(0),throw:i(1),return:i(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function i(n){return function(t){var i=[n,t];if(s)throw new TypeError("Generator is already executing.");for(;h;)try{if(s=1,u&&(o=2&i[0]?u.return:i[0]?u.throw||((o=u.return)&&o.call(u),0):u.next)&&!(o=o.call(u,i[1])).done)return o;switch(u=0,(i=o?[2&i[0],o.value]:i)[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,u=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(!(o=0<(o=h.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3]))h.label=i[1];else if(6===i[0]&&h.label<o[1])h.label=o[1],o=i;else{if(!(o&&h.label<o[2])){o[2]&&h.ops.pop(),h.trys.pop();continue}h.label=o[2],h.ops.push(i)}}i=e.call(r,h)}catch(t){i=[6,t],u=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},r=(Object.defineProperty(i,"u",{value:!0}),i.loadJS=void 0,n(40));function O(t,i,n){return(t=r.decrypt(t,i))&&r.hashMd5(t)===n?t:""}i.loadJS=function(v,d,y,w,b,p,m){var t=this;return new Promise(function(a,l){return g(t,void 0,void 0,function(){var u,o,h,c,f;return _(this,function(t){switch(t.label){case 0:if(u="dy",v)return[3,7];t.label=1;case 1:return t.trys.push([1,5,,6]),[4,d.getItem("code")];case 2:return o=t.sent(),[4,d.getItem("key")];case 3:return h=t.sent(),[4,d.getItem("hash")];case 4:c=t.sent();var i=O(o,h,c)||p,n=u,r=m,e=document.getElementsByTagName("HEAD").item(0),s=document.createElement("script");s.language="javascript",s.type="text/javascript",s.id=n,s.param=r;try{s.appendChild(document.createTextNode(i))}catch(n){s.text=i}return e.appendChild(s),a(),[3,6];case 5:return t.sent(),l(),[3,6];case 6:return[2];case 7:if(window.ActiveXObject)try{f=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){f=new ActiveXObject("Microsoft.XMLHTTP")}else window.XMLHttpRequest&&(f=new XMLHttpRequest);return f.open("GET",y,!0),f.send(null),f.onreadystatechange=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:if(4!=f.readyState)return[3,10];if(!(200<=f.status&&f.status<300||0==f.status||304==f.status))return[3,8];t.label=1;case 1:return t.trys.push([1,6,,7]),O(f.responseText,w,b)?[4,d.setItem("code",f.responseText)]:[3,5];case 2:return t.sent(),[4,d.setItem("key",w)];case 3:return t.sent(),[4,d.setItem("hash",b)];case 4:t.sent(),t.label=5;case 5:return a(),[3,7];case 6:return t.sent(),l(),[3,7];case 7:return[2];case 8:return l(),[2];case 9:return[3,11];case 10:case 11:return[2]}})})},[2]}})})})}},function(t,i,n){var r=this&&this.__importDefault||function(t){return t&&t.u?t:{default:t}},e=(Object.defineProperty(i,"u",{value:!0}),i.hashMd5=i.decrypt=void 0,r(n(41))),s=r(n(42)),u=r(n(43));i.decrypt=function(t,i){var n="";try{n=s.default.decrypt(t,i).toString(u.default)}catch(t){}return n},i.hashMd5=function(t){return e.default(t).toString()}},function(t,i){t.exports=e},function(t,i){t.exports=s},function(t,i){t.exports=u},function(t,r,i){function n(){this.logLevel=r.ENUM_LOG_LEVEL.DISABLE}Object.defineProperty(r,"u",{value:!0}),r.ZegoLog=r.ENUM_LOG_LEVEL=void 0,r.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},n.prototype.setLogLevel=function(t){return void 0!==(t=r.ENUM_LOG_LEVEL[t])&&(this.logLevel=t,!0)},n.prototype.debug=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join(" ");this.logLevel!==r.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=r.ENUM_LOG_LEVEL.DEBUG&&console.debug(n)},n.prototype.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join(" ");this.logLevel!==r.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=r.ENUM_LOG_LEVEL.INFO&&console.log(n)},n.prototype.info=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join(" ");this.logLevel!==r.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=r.ENUM_LOG_LEVEL.INFO&&console.info(n)},n.prototype.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join(" ");this.logLevel!==r.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=r.ENUM_LOG_LEVEL.WARN&&console.warn(n)},n.prototype.error=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.join(" ");this.logLevel!==r.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=r.ENUM_LOG_LEVEL.ERROR&&console.error(n)},r.ZegoLog=n},function(t,i,n){function r(t){this.logger=t,this.F=t}Object.defineProperty(i,"u",{value:!0}),i.StateCenter=void 0,r.prototype.isLogin=function(){return!0},i.StateCenter=r},function(t,i,n){var r=this&&this.__read||function(t,i){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,e,s=n.call(t),u=[];try{for(;(void 0===i||0<i--)&&!(r=s.next()).done;)u.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return u},e=this&&this.__spread||function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(r(arguments[i]));return t},s=(Object.defineProperty(i,"u",{value:!0}),i.DynamicCode=void 0,n(3));function u(){this.init()}u.prototype.init=function(){window.dyObj={}},u.prototype.runExecution=function(t,i,n){t=new(Function.bind.apply(Function,e([void 0],t,[n])));try{t.apply(void 0,e(i))}catch(t){s.log.error(t)}},i.DynamicCode=u}],c={},o.m=h,o.c=c,o.d=function(t,i,n){o.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},o.t=function(i,t){if(1&t&&(i=o(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.u)return i;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var r in i)o.d(n,r,function(t){return i[t]}.bind(null,r));return n},o.n=function(t){var i=t&&t.u?function(){return t.default}:function(){return t};return o.d(i,"a",i),i},o.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},o.p="",o(o.s=13);function o(t){var i;return(c[t]||(i=c[t]={i:t,l:!1,exports:{}},h[t].call(i.exports,i,i.exports,o),i.l=!0,i)).exports}var h,c});